var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,c=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,r=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&c(e,n,t[n]);if(o)for(var n of o(t))i.call(t,n)&&c(e,n,t[n]);return e},a=(e,o)=>t(e,n(o)),l=(e,t,n)=>(c(e,"symbol"!=typeof t?t+"":t,n),n);import{S as u,i as d,s as p,d as h,X as m,v as g,o as f,e as $,b as w,m as y,c as b,f as k,h as E,w as M,x as T,G as _,Y as C,Z as P,_ as v,D as x,B as S,g as I,F as R,y as B,z as O,A,E as j,L,K as G,t as D,k as Y,p as N,H as U,C as K,n as q,a as V,$ as F,j as W,J as Q,M as H,N as X,W as J}from"./vendor-a26d429a.js";import{I as z,s as Z,a as ee,E as te,P as ne,b as oe,c as se,d as ie,e as ce,f as re,g as ae,h as le,i as ue,r as de,C as pe,L as he,j as me,S as ge,k as fe,l as $e,m as we,A as ye,M as be,n as ke,o as Ee,p as Me}from"./index.1725411945463.96b7844b.js";const Te="src/js/components/fixedPopupContainer.svelte";function _e(e){let t,n,o,s,i;const c=e[11].default,r=m(c,e,e[10],null),a={c:function(){t=$("div"),n=$("div"),r&&r.c(),w(n,"class","body s-3Fygar4x0EwB"),y(n,"left",e[2]+"px"),y(n,"top",e[1]+"px"),y(n,"transform","translate(-50%, "+e[3]+")"),b(n,Te,27,4,692),w(t,"class","fixedPopupContainer s-3Fygar4x0EwB"),b(t,Te,26,0,616)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,a){k(c,t,a),E(t,n),r&&r.m(n,null),o=!0,s||(i=[M(n,"click",T(e[12]),!1,!1,!0,!1),M(t,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1)],s=!0)},p:function(t,[s]){e=t,r&&r.p&&(!o||1024&s)&&C(r,c,e,e[10],o?v(c,e[10],s,null):P(e[10]),null),(!o||4&s)&&y(n,"left",e[2]+"px"),(!o||2&s)&&y(n,"top",e[1]+"px"),(!o||8&s)&&y(n,"transform","translate(-50%, "+e[3]+")")},i:function(e){o||(x(r,e),o=!0)},o:function(e){S(r,e),o=!1},d:function(e){e&&I(t),r&&r.d(e),s=!1,R(i)}};return h("SvelteRegisterBlock",{block:a,id:_e.name,type:"component",source:"",ctx:e}),a}function Ce(e,t,n){let{$$slots:o={},$$scope:s}=t;g("FixedPopupContainer",o,["default"]);const i=0;let{closeModal:c=null}=t,{handle:r=null}=t,{offsetX:a=0}=t,{offsetY:l=0}=t,{position:u=i}=t,d=0,p=0,h="0px";f((()=>{const e=r.getBoundingClientRect();n(2,p=e.left+e.width/2+a),n(1,d=e.top+l),n(3,h=1==u?`${e.height+10}px`:"calc(-100% - 10px)")}));const m=["closeModal","handle","offsetX","offsetY","position"];return Object.keys(t).forEach((e=>{~m.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<FixedPopupContainer> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,c=e.closeModal),"handle"in e&&n(6,r=e.handle),"offsetX"in e&&n(7,a=e.offsetX),"offsetY"in e&&n(8,l=e.offsetY),"position"in e&&n(9,u=e.position),"$$scope"in e&&n(10,s=e.$$scope)},e.$capture_state=()=>({onMount:f,POSITION_TOP:i,POSITION_BOTTOM:1,closeModal:c,handle:r,offsetX:a,offsetY:l,position:u,top:d,left:p,transformY:h}),e.$inject_state=e=>{"closeModal"in e&&n(0,c=e.closeModal),"handle"in e&&n(6,r=e.handle),"offsetX"in e&&n(7,a=e.offsetX),"offsetY"in e&&n(8,l=e.offsetY),"position"in e&&n(9,u=e.position),"top"in e&&n(1,d=e.top),"left"in e&&n(2,p=e.left),"transformY"in e&&n(3,h=e.transformY)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[c,d,p,h,i,1,r,a,l,u,s,o,function(t){B.call(this,e,t)}]}class Pe extends u{constructor(e){super(e),d(this,e,Ce,_e,p,{POSITION_TOP:4,POSITION_BOTTOM:5,closeModal:0,handle:6,offsetX:7,offsetY:8,position:9}),h("SvelteRegisterComponent",{component:this,tagName:"FixedPopupContainer",options:e,id:_e.name})}get POSITION_TOP(){return this.$$.ctx[4]}set POSITION_TOP(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get POSITION_BOTTOM(){return this.$$.ctx[5]}set POSITION_BOTTOM(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get closeModal(){throw new Error("<FixedPopupContainer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get handle(){throw new Error("<FixedPopupContainer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handle(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get offsetX(){throw new Error("<FixedPopupContainer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set offsetX(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get offsetY(){throw new Error("<FixedPopupContainer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set offsetY(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get position(){throw new Error("<FixedPopupContainer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set position(e){throw new Error("<FixedPopupContainer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ve="src/js/bgm/setting/volumeSlider.svelte";function xe(e){let t,n,o,s;const i={c:function(){t=$("div"),n=$("input"),w(n,"min","0"),w(n,"max","100"),w(n,"step","1"),w(n,"type","range"),w(n,"name",""),w(n,"class","s-2yTzbXljKamx"),b(n,ve,22,8,511),w(t,"class","slider s-2yTzbXljKamx"),b(t,ve,21,4,482)},m:function(i,c){k(i,t,c),E(t,n),G(n,e[2]),o||(s=[M(n,"change",e[4]),M(n,"input",e[4])],o=!0)},p:function(e,t){4&t&&G(n,e[2])},d:function(e){e&&I(t),o=!1,R(s)}};return h("SvelteRegisterBlock",{block:i,id:xe.name,type:"slot",source:"(21:0) <FixedPopupContainer {handle} offsetY={-55} {closeModal}>",ctx:e}),i}function Se(e){let t,n;t=new Pe({props:{handle:e[0],offsetY:-55,closeModal:e[1],$$slots:{default:[xe]},$$scope:{ctx:e}},$$inline:!0});const o={c:function(){O(t.$$.fragment)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){A(t,e,o),n=!0},p:function(e,[n]){const o={};1&n&&(o.handle=e[0]),2&n&&(o.closeModal=e[1]),36&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Se.name,type:"component",source:"",ctx:e}),o}function Ie(e,t,n){let{$$slots:o={},$$scope:s}=t;g("VolumeSlider",o,[]);let{handle:i=null}=t,{closeModal:c=null}=t;const r=eo.getInstance();let a=r.volume;const l=["handle","closeModal"];return Object.keys(t).forEach((e=>{~l.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<VolumeSlider> was created with unknown prop '${e}'`)})),e.$$set=e=>{"handle"in e&&n(0,i=e.handle),"closeModal"in e&&n(1,c=e.closeModal)},e.$capture_state=()=>({FixedPopupContainer:Pe,Bgm:eo,handle:i,closeModal:c,instance:r,value:a}),e.$inject_state=e=>{"handle"in e&&n(0,i=e.handle),"closeModal"in e&&n(1,c=e.closeModal),"value"in e&&n(2,a=e.value)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{12&e.$$.dirty&&(n(3,r.volume=a,r),r.currentPlayer&&r.currentPlayer.changeVolume(a))},[i,c,a,r,function(){a=L(this.value),n(2,a)}]}class Re extends u{constructor(e){super(e),d(this,e,Ie,Se,p,{handle:0,closeModal:1}),h("SvelteRegisterComponent",{component:this,tagName:"VolumeSlider",options:e,id:Se.name})}get handle(){throw new Error("<VolumeSlider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handle(e){throw new Error("<VolumeSlider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get closeModal(){throw new Error("<VolumeSlider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<VolumeSlider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Be="src/js/bgm/setting/index.svelte";function Oe(e){let t,n,o,s,i,c,r,a,l,u,d,p,m,g,f=e[0]?"开":"关";r=new z({props:{src:"https://dynamics-share.tuwan.com/activity/23a35f206d2327f3b039442e15690596.png"},$$inline:!0}),r.$on("click",e[4]),l=new z({props:{src:"https://dynamics-share.tuwan.com/activity/ed99bd59128982af9e3921a505eaf8a3.png"},$$inline:!0}),l.$on("click",e[2]),d=new z({props:{src:"https://dynamics-share.tuwan.com/activity/1ff779250dcb14daa877c5c75dbff9ea.png"},$$inline:!0}),d.$on("click",e[1]);const y={c:function(){t=$("div"),n=$("p"),o=D("原声："),s=D(f),i=Y(),c=$("div"),O(r.$$.fragment),a=Y(),O(l.$$.fragment),u=Y(),O(d.$$.fragment),w(n,"class","control s-n5OiP7gfWNHu"),b(n,Be,42,4,1035),w(c,"class","flex flex-ac"),b(c,Be,43,4,1126),w(t,"class","bgm_setting flex flex-ac s-n5OiP7gfWNHu"),b(t,Be,41,0,992)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,f){k(h,t,f),E(t,n),E(n,o),E(n,s),E(t,i),E(t,c),A(r,c,null),E(c,a),A(l,c,null),E(c,u),A(d,c,null),p=!0,m||(g=M(n,"click",T(e[3]),!1,!1,!0,!1),m=!0)},p:function(e,[t]){(!p||1&t)&&f!==(f=e[0]?"开":"关")&&N(s,f)},i:function(e){p||(x(r.$$.fragment,e),x(l.$$.fragment,e),x(d.$$.fragment,e),p=!0)},o:function(e){S(r.$$.fragment,e),S(l.$$.fragment,e),S(d.$$.fragment,e),p=!1},d:function(e){e&&I(t),j(r),j(l),j(d),m=!1,g()}};return h("SvelteRegisterBlock",{block:y,id:Oe.name,type:"component",source:"",ctx:e}),y}function Ae(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Setting",o,[]);const i=eo.getInstance();let c=i.original;function r(){i.hideQuickBgmModalComp(),i.showLibraryComp()}function a(){Z(Re,{handle:this})}function l(){const e=i.currentPlayer;e&&0==e.playing?ee("歌曲暂停期间，暂时不能切换伴奏"):(n(0,c=!c),i.original=c,i.currentPlayer&&i.currentPlayer.changeTrack())}function u(){i.showPlayingListModal(this)}const d=[];return Object.keys(t).forEach((e=>{~d.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Setting> was created with unknown prop '${e}'`)})),e.$capture_state=()=>({Img:z,showSvelteModal:Z,Bgm:eo,showTips:ee,VolumeSlider:Re,instance:i,opened:c,setClick:r,showSlider:a,changeOpened:l,playingListClick:u}),e.$inject_state=e=>{"opened"in e&&n(0,c=e.opened)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[c,r,a,l,u]}class je extends u{constructor(e){super(e),d(this,e,Ae,Oe,p,{}),h("SvelteRegisterComponent",{component:this,tagName:"Setting",options:e,id:Oe.name})}}const Le=new te,Ge="EMITTER_KEY_ADD_GROUP",De="EMITTER_KEY_ADD_SONG_TO_GROUP",Ye="EMITTER_KEY_DELETE_GROUP",Ne="EMITTER_KEY_RENAME_GROUP",Ue="EMITTER_KEY_DELETE_SONG",Ke="EMITTER_KEY_SET_WORK_SONG",qe="EMITTER_KEY_PLAY_SONG",Ve="EMITTER_KEY_PAUSE_SONG",Fe="EMITTER_KEY_RESUME_SONG",We="EMITTER_KEY_DESTROY_SONG",Qe="EMITTER_KEY_UPDATE_RECOMMEND",He="src/js/bgm/playingControl/index.svelte";function Xe(e){let t,n,o=e[1].data.singer+"";const s={c:function(){t=$("p"),n=D(o),w(t,"class","singer s-OSmOfN2xbW9w"),b(t,He,92,16,2390)},m:function(e,o){k(e,t,o),E(t,n)},p:function(e,t){2&t&&o!==(o=e[1].data.singer+"")&&N(n,o)},d:function(e){e&&I(t)}};return h("SvelteRegisterBlock",{block:s,id:Xe.name,type:"if",source:"(92:12) {#if song}",ctx:e}),s}function Je(e){let t,n;t=new z({props:{class:"playing_list",src:"https://dynamics-share.tuwan.com/activity/23a35f206d2327f3b039442e15690596.png"},$$inline:!0}),t.$on("click",e[5]);const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Je.name,type:"if",source:"(98:8) {#if showPlaying}",ctx:e}),o}function ze(e){let t,n,o,s,i,c,r,a,l,u,d,p,m,g,f,y,M,T=(e[1]?e[1].data.name:"暂无歌曲")+"";o=new z({props:{class:"logo",src:"https://dynamics-share.tuwan.com/activity/f5b61acd565c9d11a7b948a57defe23b.png"},$$inline:!0});let _=e[1]&&Xe(e),C=e[0]&&Je(e);p=new z({props:{class:"pre",src:"https://dynamics-share.tuwan.com/activity/c587af81c834316d8d7729a319d61b84.png"},$$inline:!0}),p.$on("click",e[2]),g=new z({props:{class:"play_or_pause",src:e[1]&&e[1].playing?"https://dynamics-share.tuwan.com/activity/ad8e6b31a46278dda045cfca72f4c7be.png":"https://dynamics-share.tuwan.com/activity/d7822b441212cd079464037fba5e1f5d.png"},$$inline:!0}),g.$on("click",e[3]),y=new z({props:{class:"next",src:"https://dynamics-share.tuwan.com/activity/568443023cdf42e6ac35e7018e737bbe.png"},$$inline:!0}),y.$on("click",e[4]);const P={c:function(){t=$("div"),n=$("div"),O(o.$$.fragment),s=Y(),i=$("div"),c=$("p"),r=D(T),a=Y(),_&&_.c(),l=Y(),u=$("div"),C&&C.c(),d=Y(),O(p.$$.fragment),m=Y(),O(g.$$.fragment),f=Y(),O(y.$$.fragment),w(c,"class","name s-OSmOfN2xbW9w"),b(c,He,90,12,2298),w(i,"class",""),b(i,He,89,8,2271),w(n,"class","flex flex-ac"),b(n,He,87,4,2123),w(u,"class","flex flex-ac"),b(u,He,96,4,2479),w(t,"class","playing_control flex flex-ac s-OSmOfN2xbW9w"),b(t,He,86,0,2076)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,h){k(e,t,h),E(t,n),A(o,n,null),E(n,s),E(n,i),E(i,c),E(c,r),E(i,a),_&&_.m(i,null),E(t,l),E(t,u),C&&C.m(u,null),E(u,d),A(p,u,null),E(u,m),A(g,u,null),E(u,f),A(y,u,null),M=!0},p:function(e,[t]){(!M||2&t)&&T!==(T=(e[1]?e[1].data.name:"暂无歌曲")+"")&&N(r,T),e[1]?_?_.p(e,t):(_=Xe(e),_.c(),_.m(i,null)):_&&(_.d(1),_=null),e[0]?C?(C.p(e,t),1&t&&x(C,1)):(C=Je(e),C.c(),x(C,1),C.m(u,d)):C&&(U(),S(C,1,1,(()=>{C=null})),K());const n={};2&t&&(n.src=e[1]&&e[1].playing?"https://dynamics-share.tuwan.com/activity/ad8e6b31a46278dda045cfca72f4c7be.png":"https://dynamics-share.tuwan.com/activity/d7822b441212cd079464037fba5e1f5d.png"),g.$set(n)},i:function(e){M||(x(o.$$.fragment,e),x(C),x(p.$$.fragment,e),x(g.$$.fragment,e),x(y.$$.fragment,e),M=!0)},o:function(e){S(o.$$.fragment,e),S(C),S(p.$$.fragment,e),S(g.$$.fragment,e),S(y.$$.fragment,e),M=!1},d:function(e){e&&I(t),j(o),_&&_.d(),C&&C.d(),j(p),j(g),j(y)}};return h("SvelteRegisterBlock",{block:P,id:ze.name,type:"component",source:"",ctx:e}),P}function Ze(e,t,n){let{$$slots:o={},$$scope:s}=t;function i(){n(7,a+=1)}g("PlayingControl",o,[]);let{showPlaying:c=!1}=t;const r=eo.getInstance();let a=0;f((()=>(Le.on(qe,i),()=>Le.off(qe,i)))),f((()=>(Le.on(We,i),()=>Le.off(We,i)))),f((()=>(Le.on(Fe,i),()=>Le.off(Fe,i)))),f((()=>(Le.on(Ve,i),()=>Le.off(Ve,i))));let l=r.currentPlayer;function u(){return!!r.currentPlayer}function d(){u()&&r.playWithDirection(!1,l.data,l.groupId)}function p(){u()&&(l.playing?l.pause():l.resume(),l.playing?Le.emit(Fe):Le.emit(Ve))}function h(){u()&&r.playWithDirection(!0,l.data,l.groupId)}function m(){r.showPlayingListModal(this)}const $=["showPlaying"];return Object.keys(t).forEach((e=>{~$.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<PlayingControl> was created with unknown prop '${e}'`)})),e.$$set=e=>{"showPlaying"in e&&n(0,c=e.showPlaying)},e.$capture_state=()=>({onMount:f,Img:z,EMITTER_KEY_PLAY_SONG:qe,EMITTER_KEY_DESTROY_SONG:We,EMITTER_KEY_PAUSE_SONG:Ve,EMITTER_KEY_RESUME_SONG:Fe,emitter:Le,Bgm:eo,forceUpdate:i,showPlaying:c,instance:r,forceUpdateIndex:a,song:l,checkCanClick:u,preClick:d,controlClick:p,nextClick:h,playingListClick:m}),e.$inject_state=e=>{"showPlaying"in e&&n(0,c=e.showPlaying),"forceUpdateIndex"in e&&n(7,a=e.forceUpdateIndex),"song"in e&&n(1,l=e.song)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{128&e.$$.dirty&&a&&n(1,l=r.currentPlayer)},[c,l,d,p,h,m,i,a]}class et extends u{constructor(e){super(e),d(this,e,Ze,ze,p,{forceUpdate:6,showPlaying:0}),h("SvelteRegisterComponent",{component:this,tagName:"PlayingControl",options:e,id:ze.name})}get forceUpdate(){return this.$$.ctx[6]}set forceUpdate(e){throw new Error("<PlayingControl>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showPlaying(){throw new Error("<PlayingControl>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showPlaying(e){throw new Error("<PlayingControl>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class tt{constructor(e){this._status=ne,this.statusChangeCb=null,this.playMusicTickCb=null,this.downloadTickCb=null,this.downloadMuiscErrorCb=null,this.playendCb=null,this.code=null,this.defaultGain=0,this.autoPlay=!1,this.isSeeked=!1,this.volumeValue=100,this.volumeMultiple=1,this.zcm=null,this.tickTime=20,this.originalTrack=new Audio,this.accompaniedTrack=new Audio,this.resource_id=null,this.engine=e}destroy(){console.log("44444 : "),this.status!=oe&&(console.log("55555 : "),this.onStopLocalAudioMixin())}set status(e){this.statusChangeCb&&this.statusChangeCb(e),this._status=e}get status(){return this._status}get isOriginalBgmStart(){var e;return(null==(e=null==this?void 0:this.originalTrack)?void 0:e.getCurrentTime())>0}get isAccompanyBgmStart(){var e;return(null==(e=null==this?void 0:this.accompaniedTrack)?void 0:e.getCurrentTime())>0}preloadUrl(e){this.autoPlay=!1,this.extractAudio(e)}playWithUrl(e){this.autoPlay=!0,3==se.getRoomInfo().yjx_song_switch?this.extractAudioNew():this.extractAudio(e)}async extractAudioNew(){await this.createCustomAudioTrackNew(),this.autoPlay&&this.status!=ie&&await this.startPlay()}async extractAudio(e){if(this.status=ce,(e=String(e)).indexOf(".mp3")>=0){let n=e.split("|");try{if(this.status==oe)return;this.status=re;await this.createCustomAudioTrack([n[0],n[1]]);this.autoPlay&&this.status!=ie&&await this.startPlay()}catch(t){console.log(t),this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb(t)}}else try{const t=await this.zcm.requestResource({songID:e,vendorID:2},1);if(0!==t.errorCode||0!==t.resource.code)return void(this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb());{const e=t.resource.data.resources[0].resource_id;this.resource_id=e;const{errorCode:n,urls:o}=await this.zcm.download(e);if(0!==n)return void(this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb());if(this.status==oe)return;this.status=re;await this.createCustomAudioTrack(o);this.autoPlay&&await this.startPlay()}}catch(t){this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb(t)}}async startPlay(){if(this.status!=oe){if(this.autoPlay=!0,this.status!=ae)throw new Error("startPlay失败，因为歌曲没加载好了");await this.playCustomAudioTrack(),this.status=ie,this.startReportTimer()}}async createCustomAudioTrackNew(){this.originalTrack=this.engine.originalBgmTrack,this.originalTrack.setVolume(this.volumeValue*this.volumeMultiple),this.accompaniedTrack=this.engine.accompanyBgmTrack,this.accompaniedTrack.setVolume(this.volumeValue*this.volumeMultiple),this.status=ae}async createCustomAudioTrack(e){let t=0;const n=this;return new Promise(((o,s)=>{function i(){t++,2==t&&(n.status=ae,o(1))}if(this.status==oe)return;const[c,r]=e;this.originalTrack.crossOrigin="anonymous",this.originalTrack.src=c,this.originalTrack.volume=this.volumeValue/100,this.accompaniedTrack.crossOrigin="anonymous",this.accompaniedTrack.src=r,this.accompaniedTrack.volume=this.volumeValue/100,this.originalTrack.removeEventListener("canplay",i),this.accompaniedTrack.removeEventListener("canplay",i),this.originalTrack.addEventListener("canplay",i),this.accompaniedTrack.addEventListener("canplay",i)}))}async playCustomAudioTrack(){if(3==se.getRoomInfo().yjx_song_switch){if(this.status==oe)return;if(this.status=le,1==this.defaultGain){if(this.originalTrack){let e=this.originalTrack.getCurrentTime();this.originalTrack.play(),this.originalTrack.startProcessAudioBuffer(),this.originalTrack.seekAudioBuffer(e),this._pause&&this.originalTrack.pauseProcessAudioBuffer()}}else if(this.accompaniedTrack){let e=this.accompaniedTrack.getCurrentTime();this.accompaniedTrack.play(),this.accompaniedTrack.startProcessAudioBuffer(),this.accompaniedTrack.seekAudioBuffer(e),this._pause&&this.accompaniedTrack.pauseProcessAudioBuffer()}}else{if(this.status==oe)return;this.status=le,this.originalTrack.muted=0==this.defaultGain,this.accompaniedTrack.muted=1==this.defaultGain,this.originalTrack.play(),this.accompaniedTrack.play()}}onTaggerGain(){var e,t,n,o,s,i,c,r,a,l,u,d,p,h;if(3==se.getRoomInfo().yjx_song_switch){if(this.status==oe)return;if(1==this.defaultGain){if(this.originalTrack)if(3==se.getRoomInfo().yjx_song_switch){let r=this.originalTrack.getCurrentTime(),a=this.accompaniedTrack.getCurrentTime(),l=r>a?r:a;null==(e=this.accompaniedTrack)||e.pauseProcessAudioBuffer(),this.isOriginalBgmStart?(null==(t=this.originalTrack)||t.seekAudioBuffer(l),this._pause||null==(n=this.originalTrack)||n.resumeProcessAudioBuffer()):this._pause?null==(c=this.originalTrack)||c.seekAudioBuffer(l):(null==(o=this.originalTrack)||o.startProcessAudioBuffer(),null==(s=this.originalTrack)||s.seekAudioBuffer(l),null==(i=this.originalTrack)||i.play())}else{this.accompaniedTrack.stop();let e=this.accompaniedTrack.getCurrentTime();this.accompaniedTrack.stopProcessAudioBuffer(),this._pause||this.originalTrack.play(),this.originalTrack.startProcessAudioBuffer(),this.originalTrack.seekAudioBuffer(e)}}else if(this.originalTrack)if(3==se.getRoomInfo().yjx_song_switch){let e=this.originalTrack.getCurrentTime(),t=this.accompaniedTrack.getCurrentTime(),n=e>t?e:t;null==(r=this.originalTrack)||r.pauseProcessAudioBuffer(),this.isAccompanyBgmStart?(null==(a=this.accompaniedTrack)||a.seekAudioBuffer(n),this._pause||null==(l=this.accompaniedTrack)||l.resumeProcessAudioBuffer()):this._pause?null==(h=this.accompaniedTrack)||h.seekAudioBuffer(n):(null==(u=this.accompaniedTrack)||u.startProcessAudioBuffer(),null==(d=this.accompaniedTrack)||d.seekAudioBuffer(n),null==(p=this.accompaniedTrack)||p.play())}else{this.originalTrack.stop();let e=this.originalTrack.getCurrentTime();this.originalTrack.stopProcessAudioBuffer(),this._pause||this.accompaniedTrack.play(),this.accompaniedTrack.startProcessAudioBuffer(),this.accompaniedTrack.seekAudioBuffer(e)}}else{if(this.status==oe)return;1==this.defaultGain?this.originalTrack&&(this.accompaniedTrack.muted=!0,this.originalTrack.muted=!1):this.originalTrack&&(this.accompaniedTrack.muted=!1,this.originalTrack.muted=!0)}}progressTick(e,t){this.downloadTickCb&&this.downloadTickCb(.5*e+.5*t)}seekOnce(e){if(this.status==ae&&this.originalTrack&&this.accompaniedTrack&&!this.isSeeked)return this.isSeeked=!0,this.seek(e),!0}seek(e){this.status!=oe&&this.originalTrack&&this.accompaniedTrack&&(this.originalTrack.currentTime=e,this.accompaniedTrack.currentTime=e)}pause(){this.originalTrack&&this.originalTrack.pause(),this.accompaniedTrack&&this.accompaniedTrack.pause()}resume(){this.originalTrack&&this.originalTrack.play(),this.accompaniedTrack&&this.accompaniedTrack.play()}currentTrack(){return 1==this.defaultGain?this.originalTrack:this.accompaniedTrack}startReportTimer(){const e=this.accompaniedTrack.duration;this.reportTimer=setInterval((()=>{let t=0;this.originalTrack&&1==this.defaultGain?t=this.originalTrack.currentTime:this.accompaniedTrack&&0==this.defaultGain&&(t=this.accompaniedTrack.currentTime),this.playMusicTick(t,e)}),this.tickTime)}playMusicTick(e,t){e>0&&this.playMusicTickCb&&this.playMusicTickCb(e,t),e>=t&&(this.onStopLocalAudioMixin(),this.playendCb&&this.playendCb())}changeVolume(e){this.originalTrack&&(this.originalTrack.volume=e/100),this.accompaniedTrack&&(this.accompaniedTrack.volume=e/100)}onStopLocalAudioMixin(){this.status=oe,this.clearReportTimer(),this.destoryAudioTrack()}clearReportTimer(){this.reportTimer&&(window.clearInterval(this.reportTimer),this.reportTimer=null)}destoryAudioTrack(){this.originalTrack&&(this.originalTrack.pause(),this.originalTrack=null),this.accompaniedTrack&&(this.accompaniedTrack.pause(),this.accompaniedTrack=null)}}l(tt,"_decodeAudio",null);const nt=class{constructor(e,t){this.endCb=null,this.errorCb=null,this.data=e,this.groupId=t,this.timer=null,this.playing=!0,this.original=!1,this.destroyed=!1,this.loadMuisc=null,this.publishSteam=!1,this.lyric=null,this.pitchData=null,this.bgmType=1}destroy(){this.clearTimer(),this.unpublishTracks(),this.destroyed=!0,this.loadMuisc&&this.loadMuisc.destroy()}clearTimer(){window.clearInterval(this.timer)}async play(){if(3==se.getRoomInfo().yjx_song_switch){nt.isLoadingBgm=!0,ee("正在加载歌曲...");try{if(this.destroyed)return;const e=this.data.song_code+"";await nt.engine.setUser(se.getMeid()),this.lyric=await nt.engine.getLyric(e,!0),this.pitchData=await nt.engine.getPitchData(e),nt.engine.prepare(),await nt.engine.genBgmTracks(e,!0),this.createLoadMuisc(this.data),this.loadMuisc.playWithUrl(),this.playing=!0,nt.isLoadingBgm=!1}catch(e){console.log("error---"),console.log(e),ee("网络错误,请稍后再试.."),nt.isLoadingBgm=!1}}else this.playing=!0,de.get(pe.getSongInfo(this.data.song_code,this.data.token,1)).then((e=>{if(!this.destroyed)if(0==e.error){const t=e.data.playUrl;if(!t||""==t)return void ee("歌曲链接为空，请手动切换歌曲");if(!t)return void ee("歌曲有问题，链接为空，请手动切换歌曲");let n=t.split("|");if(2!=n.length)return void ee("歌曲有问题，缺少原唱或者伴奏，请手动切换歌曲");if(n[0].indexOf(".mp3")<0||n[1].indexOf(".mp3")<0)return void ee("歌曲类型有问题，返回了不是mp3的链接，请手动切换歌曲");this.createLoadMuisc(e.data),this.loadMuisc.playWithUrl(t)}else ee(e.error_msg)})).catch((e=>{console.log("error---"),console.log(error),ee("网络错误,请稍后再试..")}))}createLoadMuisc(e){let t=se.isZegoRTC()?he:me;se.isTRTC()&&(t=tt),this.loadMuisc=new t(nt.engine),this.loadMuisc.tickTime=200,this.loadMuisc.volumeMultiple=1,this.loadMuisc.volumeValue=eo.getInstance().volume,this.loadMuisc.defaultGain=eo.getInstance().original?1:0,this.loadMuisc.code=e.song_code,this.loadMuisc.statusChangeCb=this.musicStateChange.bind(this),this.loadMuisc.playendCb=this.endCb?this.endCb.bind(this):null,this.loadMuisc.downloadMuiscErrorCb=this.errorCb?this.errorCb.bind(this):null}unpublishTracks(){console.log("player 触发 unpublishTracks"),this.loadMuisc&&this.loadMuisc.originalTrack&&this.loadMuisc.accompaniedTrack&&(se.isTRTC()?3==se.getRoomInfo().yjx_song_switch?se.globalRtcClient.unpublishCustomAudioTrack(nt.engine.originalBgmTrack,nt.engine.accompanyBgmTrack):se.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.originalTrack,this.loadMuisc.accompaniedTrack):3==se.getRoomInfo().yjx_song_switch?(se.globalRtcClient.unpublishCustomAudioTrack(nt.engine.originalBgmTrack),se.globalRtcClient.unpublishCustomAudioTrack(nt.engine.accompanyBgmTrack)):(se.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.originalTrack),se.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.accompaniedTrack)))}publishTracks(){console.log("player 触发 publishTracks"),3==se.getRoomInfo().yjx_song_switch?nt.engine&&nt.engine.originalBgmTrack&&nt.engine.accompanyBgmTrack&&(se.isTRTC()?se.globalRtcClient.publishCustomAudioTrack(nt.engine.originalBgmTrack,nt.engine.accompanyBgmTrack):(se.globalRtcClient.publishCustomAudioTrack(nt.engine.originalBgmTrack),se.globalRtcClient.publishCustomAudioTrack(nt.engine.accompanyBgmTrack))):se.globalRtcClient.localAudio&&this.loadMuisc&&this.loadMuisc.originalTrack&&this.loadMuisc.accompaniedTrack&&(se.isTRTC()?se.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.originalTrack,this.loadMuisc.accompaniedTrack):(se.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.originalTrack),se.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.accompaniedTrack)))}musicStateChange(e){console.log("触发 musicStateChange"),e==ae&&this.publishSteam&&(se.globalRtcClient.localAudio?eo.getInstance().publishTracks():this.timer=setInterval((()=>{this.clearTimer(),se.globalRtcClient.localAudio&&this.musicStateChange(ae)}),200))}resume(){this.playing=!0,this.loadMuisc&&this.loadMuisc.resume()}pause(){this.playing=!1,this.loadMuisc&&this.loadMuisc.pause()}changeTrack(){this.loadMuisc&&(this.loadMuisc.defaultGain=eo.getInstance().original?1:0,this.loadMuisc&&this.loadMuisc.onTaggerGain())}changeVolume(e){this.loadMuisc&&this.loadMuisc.changeVolume(e)}};let ot=nt;l(ot,"engine",new ue),l(ot,"isLoadingBgm",!1);const st="src/js/bgm/components/music.svelte";function it(e){let t,n;t=new z({props:{class:"dang",src:"https://dynamics-share.tuwan.com/activity/0d99c971361c9fb6ace81b5a6db492eb.png"},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:it.name,type:"if",source:"(37:12) {#if showDang}",ctx:e}),o}function ct(e){let t,n;t=new z({props:{class:"add",src:"https://dynamics-share.tuwan.com/activity/9313d29d6b6d44cc94570e72962d9124.png"},$$inline:!0}),t.$on("click",e[4]);const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:ct.name,type:"if",source:"(47:4) {#if showAdd}",ctx:e}),o}function rt(e){let t,n,o,s,i,c,r,a,l,u,d,p,m,g,f,y,_,C,P,v,R=e[0].name+"",B=e[0].singer+"",L=at(e[0].duration)+"",G=e[3]&&it(e);a=new z({props:{class:"effect",src:"https://res.tuwan.com/chatroom/images/icon_song_playing.gif"},$$inline:!0});let q=e[2]&&ct(e);const V={c:function(){t=$("div"),n=$("div"),o=$("div"),s=$("p"),i=D(R),c=Y(),G&&G.c(),r=Y(),O(a.$$.fragment),l=Y(),u=$("div"),d=$("p"),p=D(B),m=Y(),g=$("p"),f=D(L),y=Y(),q&&q.c(),w(s,"class","name s-6gqUpfJ2_tpc"),b(s,st,35,12,916),w(o,"class","flex flex-ac"),b(o,st,34,8,877),w(d,"class","singer s-6gqUpfJ2_tpc"),b(d,st,42,12,1276),w(g,"class","time s-6gqUpfJ2_tpc"),b(g,st,43,12,1324),w(u,"class","flex flex-ac"),b(u,st,41,8,1237),w(n,"class",""),b(n,st,33,4,854),w(t,"class",_="music "+e[1]+" s-6gqUpfJ2_tpc"),b(t,st,32,0,786)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,$){k(h,t,$),E(t,n),E(n,o),E(o,s),E(s,i),E(o,c),G&&G.m(o,null),E(o,r),A(a,o,null),E(n,l),E(n,u),E(u,d),E(d,p),E(u,m),E(u,g),E(g,f),E(t,y),q&&q.m(t,null),C=!0,P||(v=M(t,"click",T(e[5]),!1,!1,!0,!1),P=!0)},p:function(e,[n]){(!C||1&n)&&R!==(R=e[0].name+"")&&N(i,R),e[3]?G?8&n&&x(G,1):(G=it(e),G.c(),x(G,1),G.m(o,r)):G&&(U(),S(G,1,1,(()=>{G=null})),K()),(!C||1&n)&&B!==(B=e[0].singer+"")&&N(p,B),(!C||1&n)&&L!==(L=at(e[0].duration)+"")&&N(f,L),e[2]?q?(q.p(e,n),4&n&&x(q,1)):(q=ct(e),q.c(),x(q,1),q.m(t,null)):q&&(U(),S(q,1,1,(()=>{q=null})),K()),(!C||2&n&&_!==(_="music "+e[1]+" s-6gqUpfJ2_tpc"))&&w(t,"class",_)},i:function(e){C||(x(G),x(a.$$.fragment,e),x(q),C=!0)},o:function(e){S(G),S(a.$$.fragment,e),S(q),C=!1},d:function(e){e&&I(t),G&&G.d(),j(a),q&&q.d(),P=!1,v()}};return h("SvelteRegisterBlock",{block:V,id:rt.name,type:"component",source:"",ctx:e}),V}function at(e){return String(parseInt(String(e/60))).padStart(2,"0")+":"+String(e%60).padStart(2,"0")}function lt(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Music",o,[]);let{data:i={}}=t,{cls:c=""}=t,{bodyClick:r}=t,{addClick:a}=t,{showAdd:l=!0}=t,{showDang:u=!1}=t;function d(){a&&a(i,this)}function p(){ot.isLoadingBgm?ee("上一首歌曲正在加载中，请稍后~"):c.indexOf("playing")>=0||r&&r(i)}e.$$.on_mount.push((function(){void 0!==r||"bodyClick"in t||e.$$.bound[e.$$.props.bodyClick]||console.warn("<Music> was created without expected prop 'bodyClick'"),void 0!==a||"addClick"in t||e.$$.bound[e.$$.props.addClick]||console.warn("<Music> was created without expected prop 'addClick'")}));const h=["data","cls","bodyClick","addClick","showAdd","showDang"];return Object.keys(t).forEach((e=>{~h.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Music> was created with unknown prop '${e}'`)})),e.$$set=e=>{"data"in e&&n(0,i=e.data),"cls"in e&&n(1,c=e.cls),"bodyClick"in e&&n(6,r=e.bodyClick),"addClick"in e&&n(7,a=e.addClick),"showAdd"in e&&n(2,l=e.showAdd),"showDang"in e&&n(3,u=e.showDang)},e.$capture_state=()=>({Img:z,Player:ot,showTips:ee,data:i,cls:c,bodyClick:r,addClick:a,showAdd:l,showDang:u,formatTime:at,_addClick:d,_bodyClick:p}),e.$inject_state=e=>{"data"in e&&n(0,i=e.data),"cls"in e&&n(1,c=e.cls),"bodyClick"in e&&n(6,r=e.bodyClick),"addClick"in e&&n(7,a=e.addClick),"showAdd"in e&&n(2,l=e.showAdd),"showDang"in e&&n(3,u=e.showDang)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,l,u,d,p,r,a]}class ut extends u{constructor(e){super(e),d(this,e,lt,rt,p,{data:0,cls:1,bodyClick:6,addClick:7,showAdd:2,showDang:3}),h("SvelteRegisterComponent",{component:this,tagName:"Music",options:e,id:rt.name})}get data(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get cls(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set cls(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get bodyClick(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set bodyClick(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get addClick(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set addClick(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showAdd(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showAdd(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showDang(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showDang(e){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function dt(e,t,n){const o=e.slice();return o[7]=t[n],o}function pt(e){let t,n;t=new ut({props:{data:e[7],cls:""+(e[5]==e[7].song_code?"playing":""),showDang:e[6]==e[7].song_code,showAdd:e[4],bodyClick:e[1],addClick:e[2]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};1&n&&(o.data=e[7]),33&n&&(o.cls=""+(e[5]==e[7].song_code?"playing":"")),65&n&&(o.showDang=e[6]==e[7].song_code),16&n&&(o.showAdd=e[4]),2&n&&(o.bodyClick=e[1]),4&n&&(o.addClick=e[2]),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:pt.name,type:"each",source:"(15:4) {#each data as item}",ctx:e}),o}function ht(e){let t,n,o=e[0];V(o);let s=[];for(let r=0;r<o.length;r+=1)s[r]=pt(dt(e,o,r));const i=e=>S(s[e],1,1,(()=>{s[e]=null})),c={c:function(){for(let e=0;e<s.length;e+=1)s[e].c();t=F()},m:function(e,o){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,o);k(e,t,o),n=!0},p:function(e,n){if(119&n){let c;for(o=e[0],V(o),c=0;c<o.length;c+=1){const i=dt(e,o,c);s[c]?(s[c].p(i,n),x(s[c],1)):(s[c]=pt(i),s[c].c(),x(s[c],1),s[c].m(t.parentNode,t))}for(U(),c=o.length;c<s.length;c+=1)i(c);K()}},i:function(e){if(!n){for(let e=0;e<o.length;e+=1)x(s[e]);n=!0}},o:function(e){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)S(s[t]);n=!1},d:function(e){W(s,e),e&&I(t)}};return h("SvelteRegisterBlock",{block:c,id:ht.name,type:"slot",source:'(14:0) <ScrollView class=\\"musics\\" {scrollBottomCb}>',ctx:e}),c}function mt(e){let t,n;t=new ge({props:{class:"musics",scrollBottomCb:e[3],$$slots:{default:[ht]},$$scope:{ctx:e}},$$inline:!0});const o={c:function(){O(t.$$.fragment)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,o){A(t,e,o),n=!0},p:function(e,[n]){const o={};8&n&&(o.scrollBottomCb=e[3]),1143&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:mt.name,type:"component",source:"",ctx:e}),o}function gt(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Musics",o,[]);let{data:i}=t,{clickMuiscCb:c}=t,{addMuiscCb:r}=t,{scrollBottomCb:a}=t,{showAdd:l=!0}=t,{playingCode:u}=t,{dangCode:d}=t;e.$$.on_mount.push((function(){void 0!==i||"data"in t||e.$$.bound[e.$$.props.data]||console.warn("<Musics> was created without expected prop 'data'"),void 0!==c||"clickMuiscCb"in t||e.$$.bound[e.$$.props.clickMuiscCb]||console.warn("<Musics> was created without expected prop 'clickMuiscCb'"),void 0!==r||"addMuiscCb"in t||e.$$.bound[e.$$.props.addMuiscCb]||console.warn("<Musics> was created without expected prop 'addMuiscCb'"),void 0!==a||"scrollBottomCb"in t||e.$$.bound[e.$$.props.scrollBottomCb]||console.warn("<Musics> was created without expected prop 'scrollBottomCb'"),void 0!==u||"playingCode"in t||e.$$.bound[e.$$.props.playingCode]||console.warn("<Musics> was created without expected prop 'playingCode'"),void 0!==d||"dangCode"in t||e.$$.bound[e.$$.props.dangCode]||console.warn("<Musics> was created without expected prop 'dangCode'")}));const p=["data","clickMuiscCb","addMuiscCb","scrollBottomCb","showAdd","playingCode","dangCode"];return Object.keys(t).forEach((e=>{~p.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Musics> was created with unknown prop '${e}'`)})),e.$$set=e=>{"data"in e&&n(0,i=e.data),"clickMuiscCb"in e&&n(1,c=e.clickMuiscCb),"addMuiscCb"in e&&n(2,r=e.addMuiscCb),"scrollBottomCb"in e&&n(3,a=e.scrollBottomCb),"showAdd"in e&&n(4,l=e.showAdd),"playingCode"in e&&n(5,u=e.playingCode),"dangCode"in e&&n(6,d=e.dangCode)},e.$capture_state=()=>({Music:ut,ScrollView:ge,data:i,clickMuiscCb:c,addMuiscCb:r,scrollBottomCb:a,showAdd:l,playingCode:u,dangCode:d}),e.$inject_state=e=>{"data"in e&&n(0,i=e.data),"clickMuiscCb"in e&&n(1,c=e.clickMuiscCb),"addMuiscCb"in e&&n(2,r=e.addMuiscCb),"scrollBottomCb"in e&&n(3,a=e.scrollBottomCb),"showAdd"in e&&n(4,l=e.showAdd),"playingCode"in e&&n(5,u=e.playingCode),"dangCode"in e&&n(6,d=e.dangCode)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,r,a,l,u,d]}class ft extends u{constructor(e){super(e),d(this,e,gt,mt,p,{data:0,clickMuiscCb:1,addMuiscCb:2,scrollBottomCb:3,showAdd:4,playingCode:5,dangCode:6}),h("SvelteRegisterComponent",{component:this,tagName:"Musics",options:e,id:mt.name})}get data(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clickMuiscCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set clickMuiscCb(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get addMuiscCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set addMuiscCb(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get scrollBottomCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scrollBottomCb(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showAdd(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showAdd(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playingCode(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set playingCode(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get dangCode(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set dangCode(e){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const $t=0,wt=1,yt=3,bt="recommend",kt="mine",Et="quku",Mt="src/js/bgm/library/page.svelte";function Tt(e){let t,n,o,s,i,c,r=e[0]==$t&&_t(e),a=e[8]&&0==e[3].length&&Pt(e);const l=[It,St,xt],u=[];function d(e,t){var n,o;return null==e[7]?0:(null==(n=e[7])?void 0:n.length)>0?1:0==(null==(o=e[7])?void 0:o.length)?2:-1}~(o=d(e))&&(s=u[o]=l[o](e));const p={c:function(){r&&r.c(),t=Y(),a&&a.c(),n=Y(),s&&s.c(),i=F()},m:function(e,s){r&&r.m(e,s),k(e,t,s),a&&a.m(e,s),k(e,n,s),~o&&u[o].m(e,s),k(e,i,s),c=!0},p:function(e,c){e[0]==$t?r?(r.p(e,c),1&c[0]&&x(r,1)):(r=_t(e),r.c(),x(r,1),r.m(t.parentNode,t)):r&&(U(),S(r,1,1,(()=>{r=null})),K()),e[8]&&0==e[3].length?a?(a.p(e,c),264&c[0]&&x(a,1)):(a=Pt(e),a.c(),x(a,1),a.m(n.parentNode,n)):a&&(U(),S(a,1,1,(()=>{a=null})),K());let p=o;o=d(e),o===p?~o&&u[o].p(e,c):(s&&(U(),S(u[p],1,1,(()=>{u[p]=null})),K()),~o?(s=u[o],s?s.p(e,c):(s=u[o]=l[o](e),s.c()),x(s,1),s.m(i.parentNode,i)):s=null)},i:function(e){c||(x(r),x(a),x(s),c=!0)},o:function(e){S(r),S(a),S(s),c=!1},d:function(e){r&&r.d(e),e&&I(t),a&&a.d(e),e&&I(n),~o&&u[o].d(e),e&&I(i)}};return h("SvelteRegisterBlock",{block:p,id:Tt.name,type:"if",source:"(397:0) {#if show}",ctx:e}),p}function _t(e){let t,n,o,s,i;function c(t){e[23](t)}let r={};void 0!==e[3]&&(r.value=e[3]),n=new we({props:r,$$inline:!0}),Q.push((()=>H(n,"value",c)));let a=e[0]==$t&&Ct(e);const l={c:function(){t=$("div"),O(n.$$.fragment),s=Y(),a&&a.c(),w(t,"class","flex flex-ac"),b(t,Mt,398,8,12862)},m:function(e,o){k(e,t,o),A(n,t,null),E(t,s),a&&a.m(t,null),i=!0},p:function(e,s){const i={};!o&&8&s[0]&&(o=!0,i.value=e[3],X((()=>o=!1))),n.$set(i),e[0]==$t?a?(a.p(e,s),1&s[0]&&x(a,1)):(a=Ct(e),a.c(),x(a,1),a.m(t,null)):a&&(U(),S(a,1,1,(()=>{a=null})),K())},i:function(e){i||(x(n.$$.fragment,e),x(a),i=!0)},o:function(e){S(n.$$.fragment,e),S(a),i=!1},d:function(e){e&&I(t),j(n),a&&a.d()}};return h("SvelteRegisterBlock",{block:l,id:_t.name,type:"if",source:"(398:4) {#if menuType == MENU_TYPE_QUKU}",ctx:e}),l}function Ct(e){let t,n;t=new z({props:{class:"edit_tags_icon",src:"https://dynamics-share.tuwan.com/activity/7e1995bcdba84826a78720a64bfb0e0c.png"},$$inline:!0}),t.$on("click",e[13]);const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Ct.name,type:"if",source:"(401:12) {#if menuType == MENU_TYPE_QUKU}",ctx:e}),o}function Pt(e){let t,n,o,s;n=new fe({props:{data:e[8],selectedIndex:e[4],changeCb:e[9],logoCb:e[2]},$$inline:!0});let i=e[0]==wt&&vt(e);const c={c:function(){t=$("div"),O(n.$$.fragment),o=Y(),i&&i.c(),w(t,"class","flex flex-ac"),b(t,Mt,406,8,13232)},m:function(e,c){k(e,t,c),A(n,t,null),E(t,o),i&&i.m(t,null),s=!0},p:function(e,o){const s={};256&o[0]&&(s.data=e[8]),16&o[0]&&(s.selectedIndex=e[4]),n.$set(s),e[0]==wt?i?(i.p(e,o),1&o[0]&&x(i,1)):(i=vt(e),i.c(),x(i,1),i.m(t,null)):i&&(U(),S(i,1,1,(()=>{i=null})),K())},i:function(e){s||(x(n.$$.fragment,e),x(i),s=!0)},o:function(e){S(n.$$.fragment,e),S(i),s=!1},d:function(e){e&&I(t),j(n),i&&i.d()}};return h("SvelteRegisterBlock",{block:c,id:Pt.name,type:"if",source:"(406:4) {#if category && searchText.length == 0}",ctx:e}),c}function vt(e){let t,n;t=new z({props:{class:"edit_song_icon",src:"https://dynamics-share.tuwan.com/activity/caa60cf7f9d818f7963b3336ed8c56b0.png"},$$inline:!0}),t.$on("click",e[12]);const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:vt.name,type:"if",source:"(409:12) {#if menuType == MENU_TYPE_MINE}",ctx:e}),o}function xt(e){let t,n,o,s;const i=[Bt,Rt],c=[];function r(e,t){return e[0]==yt&&0==e[4]?0:1}t=r(e),n=c[t]=i[t](e);const a={c:function(){n.c(),o=F()},m:function(e,n){c[t].m(e,n),k(e,o,n),s=!0},p:function(e,s){let a=t;t=r(e),t===a?c[t].p(e,s):(U(),S(c[a],1,1,(()=>{c[a]=null})),K(),n=c[t],n?n.p(e,s):(n=c[t]=i[t](e),n.c()),x(n,1),n.m(o.parentNode,o))},i:function(e){s||(x(n),s=!0)},o:function(e){S(n),s=!1},d:function(e){c[t].d(e),e&&I(o)}};return h("SvelteRegisterBlock",{block:a,id:xt.name,type:"if",source:"(418:41) ",ctx:e}),a}function St(e){let t,n;t=new ft({props:{showAdd:e[0]!=yt,playingCode:e[5],dangCode:e[6],data:e[7],clickMuiscCb:e[10],addMuiscCb:e[11],scrollBottomCb:e[14]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};1&n[0]&&(o.showAdd=e[0]!=yt),32&n[0]&&(o.playingCode=e[5]),64&n[0]&&(o.dangCode=e[6]),128&n[0]&&(o.data=e[7]),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:St.name,type:"if",source:"(416:40) ",ctx:e}),o}function It(e){let t,n;t=new ft({props:{data:[]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:It.name,type:"if",source:"(414:4) {#if realMusicList == null}",ctx:e}),o}function Rt(e){let t,n;t=new $e({props:{desc:e[3]?"没有搜到该歌曲呢":"暂无歌曲内容"},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};8&n[0]&&(o.desc=e[3]?"没有搜到该歌曲呢":"暂无歌曲内容"),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Rt.name,type:"else",source:"(421:8) {:else}",ctx:e}),o}function Bt(e){let t,n;t=new $e({props:{showBtn:!0,desc:"添加歌曲",btnCb:e[15]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:q,i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Bt.name,type:"if",source:"(419:8) {#if menuType == MENU_TYPE_QUICK && categoryIndex == 0}",ctx:e}),o}function Ot(e){let t,n,o=e[1]&&Tt(e);const s={c:function(){o&&o.c(),t=F()},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,s){o&&o.m(e,s),k(e,t,s),n=!0},p:function(e,n){e[1]?o?(o.p(e,n),2&n[0]&&x(o,1)):(o=Tt(e),o.c(),x(o,1),o.m(t.parentNode,t)):o&&(U(),S(o,1,1,(()=>{o=null})),K())},i:function(e){n||(x(o),n=!0)},o:function(e){S(o),n=!1},d:function(e){o&&o.d(e),e&&I(t)}};return h("SvelteRegisterBlock",{block:s,id:Ot.name,type:"component",source:"",ctx:e}),s}function At(e){return`${e.__from}_${e.type}`}function jt(e,t,n){let o,{$$slots:s={},$$scope:i}=t;g("Page",s,[]);let{menuType:c}=t,{show:l=!1}=t;function u(){n(19,p+=1)}const d=eo.getInstance();let p=0,h={},m=null,$="",w="",y=null,b="",k=null,E=-1,M=e=>n(4,E=e);function T(){de.get(pe.getBgmSearchBgm(b)).then((e=>{0==e.error&&n(21,m=e.data.list||[])}))}function _(){c==$t&&-1!=E&&I(!0,0)}function C(){if(c==yt&&-1!=E){let e=O(0);e&&0!=e.length||I(!0,0)}}function P(e=!1){let t=[];c==yt?t=[de.get(pe.getBgmRecommendAndCustomTabs()),de.get(pe.getBgmMineGroup())]:c==$t?t=[de.get(pe.getBgmCategroy())]:c==wt&&(t=[de.get(pe.getBgmMineGroup())]),Promise.all(t).then((t=>{const o=-1!=E?k[E].id:null;c==yt?0==t[0].error&&0==t[1].error&&n(22,k=[...t[0].data.map((e=>a(r({},e),{type:e.tabId,__from:bt}))),...t[1].data.map((e=>a(r({},e),{type:e.id,__from:kt})))]):c==$t?n(22,k=t[0].data.map((e=>a(r({},e),{__from:Et})))):c==wt&&n(22,k=t[0].data.map((e=>a(r({},e),{type:e.id,__from:kt})))),e?k.findIndex((e=>e.id==o))<0&&n(4,E=0):(null==k?void 0:k.length)&&n(4,E=0)}))}function v(){c!=wt&&c!=yt||P(!0)}function x(e){if(c!=$t)for(const t in h)if(-1!=parseInt(t,10)){let o=h[t]||[];const s=o.findIndex((t=>t.song_code==e));s>=0&&(o.splice(s,1),o=[...o]),n(20,h=a(r({},h),{[t]:o}))}}function S(e,t){x(e),c!=$t&&I(!0,k.findIndex((e=>e.type==t)))}function I(e=!1,t=E){if(-1==t);else{let n=O(t);n&&n.length>0&&0==e||R(k[t])}}function R(e,t){let o="";if(c==$t)o=pe.getBgmListWithCategroyType(e.type,t,50);else if(c==wt)o=pe.getBgmListWithGroupId(e.type,t);else if(c==yt)if(e.__from==bt){if(1==e.type&&eo.getInstance().recommendList.length){const t=At(e);return n(20,h[t]=eo.getInstance().recommendList,h),void n(20,h)}o=pe.getBgmRecommendAndCustomTabSongs(se.getCid(),e.type)}else o=pe.getBgmListWithGroupId(e.type,t);de.get(o).then((t=>{if(0==t.error){const o=t.data||[],s=At(e);if(B(e.type))n(20,h[s]=o,h);else{const e=h[s]||[];n(20,h[s]=e.concat(o),h)}n(20,h),e.__from==bt&&1==e.type&&o.length&&(eo.getInstance().recommendList=o)}}))}function B(e){return c==yt||c==wt||c==$t&&-1==e}function O(e=E){let t=null;return c==$t&&b.length>0?t=m:-1!=e&&(t=h[At(k[e])]),t}function A(e){if(c==$t&&b.length)return;const t=k[E].type;ye.track3("music_play",{action:"play",song_code:e.song_code,music_name:e.name,type:t,singer:e.singer,online_songs:"yes",position:"network",cid:se.getCid()}),n(18,d.playingList=h[At(k[E])],d),n(18,d.playingGroupId=t,d),d.playMuisc(e,t)}function j(e,t){const n=t.getBoundingClientRect(),o=c===wt;d.showEditSongPopupComp({isMine:o,code:e.song_code,data:e,groupId:o?k[E].id:"",style:`left: ${n.left}px; top: ${n.top}px;`,top:n.top})}function L(){const e=this.getBoundingClientRect();d.showEditMenuPopupComp({style:`left: ${e.left}px; top: ${e.top}px; transform: translate(calc(-100% + 25px), 25px);`})}function G(){d.showTagSelectComp()}function D(){if(0==b.length){const e=k[E];if(B(e.type));else{const t=h[At(e)];R(e,t[t.length-1].id)}}}function Y(){de.get(pe.getBgmListWithCategroyType(-1,"",50,1)).then((e=>{0==e.error&&Le.emit(Qe)}))}function N(){d.hideQuickBgmModalComp(),d.showLibraryComp()}f((()=>{P()})),f((()=>(Le.on(Ye,v),()=>Le.off(Ye,v)))),f((()=>(Le.on(Ge,v),()=>Le.off(Ge,v)))),f((()=>(Le.on(Ne,v),()=>Le.off(Ne,v)))),f((()=>(Le.on(Ue,x),()=>Le.off(Ue,x)))),f((()=>(Le.on(De,S),()=>Le.off(De,S)))),f((()=>(Le.on(qe,u),()=>Le.off(qe,u)))),f((()=>(Le.on(We,u),()=>Le.off(We,u)))),f((()=>(Le.on(Ke,u),()=>Le.off(Ke,u)))),f((()=>(Le.on(Qe,_),()=>Le.off(Qe,_)))),e.$$.on_mount.push((function(){void 0!==c||"menuType"in t||e.$$.bound[e.$$.props.menuType]||console.warn("<Page> was created without expected prop 'menuType'")}));const U=["menuType","show"];return Object.keys(t).forEach((e=>{~U.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Page> was created with unknown prop '${e}'`)})),e.$$set=e=>{"menuType"in e&&n(0,c=e.menuType),"show"in e&&n(1,l=e.show)},e.$capture_state=()=>({onMount:f,ChatUrls:pe,common:se,request:de,Bgm:eo,Category:fe,Empty:$e,Musics:ft,Search:we,Img:z,Analytics:ye,MENU_TYPE_QUKU:$t,MENU_TYPE_MINE:wt,MENU_TYPE_QUICK:yt,DEFAULT_CATETORY_TYPE:-1,SUBTYPE_RECOMMEND:bt,SUBTYPE_MINE:kt,SUBTYPE_QUKU:Et,SUBTYPE_RECOMMEND_1:1,EMITTER_KEY_DELETE_GROUP:Ye,EMITTER_KEY_ADD_GROUP:Ge,EMITTER_KEY_RENAME_GROUP:Ne,EMITTER_KEY_DELETE_SONG:Ue,EMITTER_KEY_ADD_SONG_TO_GROUP:De,EMITTER_KEY_PLAY_SONG:qe,EMITTER_KEY_DESTROY_SONG:We,EMITTER_KEY_SET_WORK_SONG:Ke,EMITTER_KEY_UPDATE_RECOMMEND:Qe,emitter:Le,menuType:c,show:l,forceUpdate:u,instance:d,forceUpdateIndex:p,data:h,searchData:m,playingCode:$,dangCode:w,realMusicList:y,searchText:b,categoryData:k,categoryIndex:E,categoryChange:M,requestSearchList:T,refreshMineLike:_,refreshRecommend:C,requestCategoryData:P,reloadCategroy:v,deleteSong:x,moveToGroup:S,requestMuiscList:I,requestList:R,getSubdataKey:At,onlyOnePage:B,getMusicList:O,clickMuiscWithData:A,addMuiscWithData:j,showMenu:L,showTagSelect:G,scrollBottomCb:D,_refreshMineLike:Y,gotoLibraryModal:N,category:o}),e.$inject_state=e=>{"menuType"in e&&n(0,c=e.menuType),"show"in e&&n(1,l=e.show),"forceUpdateIndex"in e&&n(19,p=e.forceUpdateIndex),"data"in e&&n(20,h=e.data),"searchData"in e&&n(21,m=e.searchData),"playingCode"in e&&n(5,$=e.playingCode),"dangCode"in e&&n(6,w=e.dangCode),"realMusicList"in e&&n(7,y=e.realMusicList),"searchText"in e&&n(3,b=e.searchText),"categoryData"in e&&n(22,k=e.categoryData),"categoryIndex"in e&&n(4,E=e.categoryIndex),"categoryChange"in e&&n(9,M=e.categoryChange),"category"in e&&n(8,o=e.category)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{8&e.$$.dirty[0]&&b.length&&T(),16&e.$$.dirty[0]&&(-1==E||I()),3670032&e.$$.dirty[0]&&n(7,y=O()),786432&e.$$.dirty[0]&&(n(5,$=d.currentPlayer?d.currentPlayer.data.song_code:""),n(6,w=d.dangSong?d.dangSong.song_code:"")),4194305&e.$$.dirty[0]&&n(8,o=k?k.map((e=>c!=wt&&-1==e.type?{name:e.name,logo:"https://dynamics-share.tuwan.com/activity/13e48efb8b10a292839fe2216c158753.png"}:e.name)):null)},[c,l,Y,b,E,$,w,y,o,M,A,j,L,G,D,N,u,C,d,p,h,m,k,function(e){b=e,n(3,b)}]}class Lt extends u{constructor(e){super(e),d(this,e,jt,Ot,p,{menuType:0,show:1,forceUpdate:16,refreshRecommend:17,_refreshMineLike:2},null,[-1,-1]),h("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ot.name})}get menuType(){throw new Error("<Page>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set menuType(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get show(){throw new Error("<Page>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set show(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[16]}set forceUpdate(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get refreshRecommend(){return this.$$.ctx[17]}set refreshRecommend(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get _refreshMineLike(){return this.$$.ctx[2]}set _refreshMineLike(e){throw new Error("<Page>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function Gt(e){let t,n,o,s,i,c,r,a;n=new Lt({props:{menuType:yt,show:!0},$$inline:!0}),e[4](n),s=new et({$$inline:!0}),c=new je({$$inline:!0});const l={c:function(){t=$("div"),O(n.$$.fragment),o=Y(),O(s.$$.fragment),i=Y(),O(c.$$.fragment),w(t,"class",r="quick_bgm_modal "+(e[0]?"":"hide")+" s-orhUpwBvbiwO"),b(t,"src/js/bgm/quickBgmModal/index.svelte",20,0,446)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,r){k(e,t,r),A(n,t,null),E(t,o),A(s,t,null),E(t,i),A(c,t,null),a=!0},p:function(e,[o]){n.$set({}),(!a||1&o&&r!==(r="quick_bgm_modal "+(e[0]?"":"hide")+" s-orhUpwBvbiwO"))&&w(t,"class",r)},i:function(e){a||(x(n.$$.fragment,e),x(s.$$.fragment,e),x(c.$$.fragment,e),a=!0)},o:function(e){S(n.$$.fragment,e),S(s.$$.fragment,e),S(c.$$.fragment,e),a=!1},d:function(o){o&&I(t),e[4](null),j(n),j(s),j(c)}};return h("SvelteRegisterBlock",{block:l,id:Gt.name,type:"component",source:"",ctx:e}),l}function Dt(e,t,n){let{$$slots:o={},$$scope:s}=t;function i(){n(0,a=!0),r&&r.refreshRecommend()}function c(){n(0,a=!1)}g("QuickBgmModal",o,[]);let r,a=!1;const l=[];return Object.keys(t).forEach((e=>{~l.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<QuickBgmModal> was created with unknown prop '${e}'`)})),e.$capture_state=()=>({Setting:je,PlayingControl:et,Page:Lt,MENU_TYPE_QUICK:yt,show:i,hide:c,visible:a,pageRef:r}),e.$inject_state=e=>{"visible"in e&&n(0,a=e.visible),"pageRef"in e&&n(1,r=e.pageRef)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[a,r,i,c,function(e){Q[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}const Yt=class extends u{constructor(e){super(e),d(this,e,Dt,Gt,p,{show:2,hide:3}),h("SvelteRegisterComponent",{component:this,tagName:"QuickBgmModal",options:e,id:Gt.name})}get show(){return this.$$.ctx[2]}set show(e){throw new Error("<QuickBgmModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get hide(){return this.$$.ctx[3]}set hide(e){throw new Error("<QuickBgmModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}},Nt="src/js/bgm/library/index.svelte";function Ut(e){let t,n,o,s,i,c,r,a,l,u,d,p;o=new be({props:{data:e[5],selectedIndex:e[2],changeCb:e[6]},$$inline:!0}),i=new z({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),i.$on("click",(function(){_(e[0])&&e[0].apply(this,arguments)}));let m={menuType:$t,show:e[2]==$t};r=new Lt({props:m,$$inline:!0}),e[10](r);let g={menuType:wt,show:e[2]==wt};l=new Lt({props:g,$$inline:!0}),e[11](l),d=new et({props:{showPlaying:!0},$$inline:!0});const f={c:function(){t=$("div"),n=$("div"),O(o.$$.fragment),s=Y(),O(i.$$.fragment),c=Y(),O(r.$$.fragment),a=Y(),O(l.$$.fragment),u=Y(),O(d.$$.fragment),w(n,"class","body s-ujxLI4T7o6HD"),b(n,Nt,32,4,836),w(t,"class","bgm_library s-ujxLI4T7o6HD"),y(t,"display",e[1]?"flex":"none"),b(t,Nt,31,0,761)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,h){k(e,t,h),E(t,n),A(o,n,null),E(n,s),A(i,n,null),E(n,c),A(r,n,null),E(n,a),A(l,n,null),E(n,u),A(d,n,null),p=!0},p:function(n,[s]){e=n;const i={};4&s&&(i.selectedIndex=e[2]),o.$set(i);const c={};4&s&&(c.show=e[2]==$t),r.$set(c);const a={};4&s&&(a.show=e[2]==wt),l.$set(a),(!p||2&s)&&y(t,"display",e[1]?"flex":"none")},i:function(e){p||(x(o.$$.fragment,e),x(i.$$.fragment,e),x(r.$$.fragment,e),x(l.$$.fragment,e),x(d.$$.fragment,e),p=!0)},o:function(e){S(o.$$.fragment,e),S(i.$$.fragment,e),S(r.$$.fragment,e),S(l.$$.fragment,e),S(d.$$.fragment,e),p=!1},d:function(n){n&&I(t),j(o),j(i),e[10](null),j(r),e[11](null),j(l),j(d)}};return h("SvelteRegisterBlock",{block:f,id:Ut.name,type:"component",source:"",ctx:e}),f}function Kt(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Library",o,[]);let{closeModal:i}=t;function c(){n(1,d=!0)}function r(){n(1,d=!1)}function a(){l&&l._refreshMineLike()}let l,u,d=!1,p=["推荐","我的歌单"],h=0,m=e=>n(2,h=e);e.$$.on_mount.push((function(){void 0!==i||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<Library> was created without expected prop 'closeModal'")}));const f=["closeModal"];return Object.keys(t).forEach((e=>{~f.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Library> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,i=e.closeModal)},e.$capture_state=()=>({Bgm:ke,Img:z,Menus:be,PlayingControl:et,Page:Lt,MENU_TYPE_QUKU:$t,MENU_TYPE_MINE:wt,GROUP_TYPE_0:0,GROUP_TYPE_1:1,closeModal:i,show:c,hide:r,refreshMineLike:a,visible:d,menus:p,menusIndex:h,menusChange:m,qukuRef:l,mineRef:u}),e.$inject_state=e=>{"closeModal"in e&&n(0,i=e.closeModal),"visible"in e&&n(1,d=e.visible),"menus"in e&&n(5,p=e.menus),"menusIndex"in e&&n(2,h=e.menusIndex),"menusChange"in e&&n(6,m=e.menusChange),"qukuRef"in e&&n(3,l=e.qukuRef),"mineRef"in e&&n(4,u=e.mineRef)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,d,h,l,u,p,m,c,r,a,function(e){Q[e?"unshift":"push"]((()=>{l=e,n(3,l)}))},function(e){Q[e?"unshift":"push"]((()=>{u=e,n(4,u)}))}]}const qt=class extends u{constructor(e){super(e),d(this,e,Kt,Ut,p,{closeModal:0,show:7,hide:8,refreshMineLike:9}),h("SvelteRegisterComponent",{component:this,tagName:"Library",options:e,id:Ut.name})}get closeModal(){throw new Error("<Library>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<Library>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get show(){return this.$$.ctx[7]}set show(e){throw new Error("<Library>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get hide(){return this.$$.ctx[8]}set hide(e){throw new Error("<Library>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get refreshMineLike(){return this.$$.ctx[9]}set refreshMineLike(e){throw new Error("<Library>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}},Vt=0,Ft=1,Wt=4,Qt=5,Ht=7,Xt="src/js/bgm/components/editItem.svelte";function Jt(e){let t,n;t=new z({props:{src:e[3]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};8&n&&(o.src=e[3]),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Jt.name,type:"if",source:"(172:8) {#if url && url.length}",ctx:e}),o}function zt(e){let t,n,o,s,i,c,r,a,l,u=e[3]&&e[3].length&&Jt(e);const d={c:function(){t=$("div"),n=$("div"),u&&u.c(),o=Y(),s=$("p"),i=D(e[4]),w(n,"class","icon s-fBwlKO_punkf"),b(n,Xt,170,4,6795),w(s,"class","s-fBwlKO_punkf"),b(s,Xt,175,4,6904),w(t,"class",c="bgm_edit_popup-item "+(e[1]&&"selected")+" type_"+e[0]+" s-fBwlKO_punkf"),J(t,"disable",!e[2]),b(t,Xt,169,0,6661)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,d){k(c,t,d),E(t,n),u&&u.m(n,null),E(t,o),E(t,s),E(s,i),r=!0,a||(l=M(t,"click",T(e[5]),!1,!1,!0,!1),a=!0)},p:function(e,[o]){e[3]&&e[3].length?u?(u.p(e,o),8&o&&x(u,1)):(u=Jt(e),u.c(),x(u,1),u.m(n,null)):u&&(U(),S(u,1,1,(()=>{u=null})),K()),(!r||16&o)&&N(i,e[4]),(!r||3&o&&c!==(c="bgm_edit_popup-item "+(e[1]&&"selected")+" type_"+e[0]+" s-fBwlKO_punkf"))&&w(t,"class",c),(!r||7&o)&&J(t,"disable",!e[2])},i:function(e){r||(x(u),r=!0)},o:function(e){S(u),r=!1},d:function(e){e&&I(t),u&&u.d(),a=!1,l()}};return h("SvelteRegisterBlock",{block:d,id:zt.name,type:"component",source:"",ctx:e}),d}function Zt(e,t,n){let{$$slots:o={},$$scope:s}=t;g("EditItem",o,[]);let{type:i=Vt}=t,{isSelected:c=!1}=t,{title:r=""}=t,{groupId:a=""}=t,{code:l=""}=t,{callback:u}=t,{active:d=!0}=t,{data:p={}}=t;function h(){if(i==Vt)ke.getInstance().showAlert({title:"新建歌单",placeholder:"最多5个字",maxLength:5,confirmCb:e=>{e&&e.length>0?de.get(pe.getBgmAddGroup(e)).then((e=>{0==e.error?(ee("新建歌单成功"),u&&u(i),Le.emit(Ge)):ee(e.error_msg)})):ee("请填写组名称")}});else if(i==Ft){if(!d)return;de.get(pe.getBgmAddSongToGroup(a,l)).then((e=>{0==e.error?(ee("加入歌单成功"),u&&u(i),Le.emit(De,l,a)):ee(e.error_msg)}))}else if(3==i)window.$.DialogByZ.Confirm({Title:"提示",Content:"您确定要删除此歌单吗？",BtnL:"取消",BtnR:"确定",FunL(){window.$.DialogByZ.Close()},FunR(){window.$.DialogByZ.Close(),de.get(pe.getBgmDeleteGroup(a)).then((e=>{0==e.error?(ee("删除成功"),u&&u(i),Le.emit(Ye)):ee(e.error_msg)}))}});else if(2==i)ke.getInstance().showAlert({title:"重命名",placeholder:"最多5个字",maxLength:5,confirmCb:e=>{de.get(pe.getBgmRenameGroup(e,a)).then((e=>{0==e.error?(ee("修改成功"),u&&u(i),Le.emit(Ne)):ee(e.error_msg)}))}});else if(i==Wt)de.get(pe.getBgmSetWorkBgm(a,l)).then((e=>{0==e.error?(ee("设置上档歌曲成功"),u&&u(i),ke.getInstance().updateDangSong()):ee(e.error_msg)}));else if(i==Qt)de.get(pe.getBgmDeleteSongToGroup(a,l)).then((e=>{0==e.error?(ee("删除歌曲成功"),u&&u(i),Le.emit(Ue,l,a)):ee(e.error_msg)}));else if(i==Ht){const e=ke.getInstance().playingList;-1==e.findIndex((e=>e.song_code==l))&&e.push(p),u&&u(i)}else 6==i&&(ke.getInstance().showEditGroupComp(),u&&u(i))}let m="",f="";e.$$.on_mount.push((function(){void 0!==u||"callback"in t||e.$$.bound[e.$$.props.callback]||console.warn("<EditItem> was created without expected prop 'callback'")}));const $=["type","isSelected","title","groupId","code","callback","active","data"];return Object.keys(t).forEach((e=>{~$.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<EditItem> was created with unknown prop '${e}'`)})),e.$$set=e=>{"type"in e&&n(0,i=e.type),"isSelected"in e&&n(1,c=e.isSelected),"title"in e&&n(6,r=e.title),"groupId"in e&&n(7,a=e.groupId),"code"in e&&n(8,l=e.code),"callback"in e&&n(9,u=e.callback),"active"in e&&n(2,d=e.active),"data"in e&&n(10,p=e.data)},e.$capture_state=()=>({Img:z,TYPE_ADD:Vt,TYPE_GROUP:Ft,TYPE_RENAME:2,TYPE_DELETE:3,TYPE_WORK_BGM:Wt,TYPE_DELETE_SONG:Qt,TYPE_ADD_PLAYING_LIST:Ht,TYPE_EDIT_GROUP:6,Bgm:ke,ChatUrls:pe,request:de,showTips:ee,EMITTER_KEY_DELETE_GROUP:Ye,EMITTER_KEY_RENAME_GROUP:Ne,EMITTER_KEY_DELETE_SONG:Ue,EMITTER_KEY_ADD_SONG_TO_GROUP:De,EMITTER_KEY_ADD_GROUP:Ge,emitter:Le,type:i,isSelected:c,title:r,groupId:a,code:l,callback:u,active:d,data:p,click:h,url:m,name:f}),e.$inject_state=e=>{"type"in e&&n(0,i=e.type),"isSelected"in e&&n(1,c=e.isSelected),"title"in e&&n(6,r=e.title),"groupId"in e&&n(7,a=e.groupId),"code"in e&&n(8,l=e.code),"callback"in e&&n(9,u=e.callback),"active"in e&&n(2,d=e.active),"data"in e&&n(10,p=e.data),"url"in e&&n(3,m=e.url),"name"in e&&n(4,f=e.name)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{3&e.$$.dirty&&(i==Vt?n(3,m="https://dynamics-share.tuwan.com/activity/61e226a39da0983fb4fbd1dcf912e640.png"):i==Ft&&c?n(3,m="https://dynamics-share.tuwan.com/activity/964e72b762f81a6bb6255fc1292afa1e.png"):2==i?n(3,m="https://dynamics-share.tuwan.com/activity/92ab79cbef327aa6ae8535cd0e3629eb.png"):3==i?n(3,m="https://dynamics-share.tuwan.com/activity/a40ffccc94e601ef80690bc9cb84a568.png"):i==Wt?n(3,m=""):i==Qt?n(3,m="https://dynamics-share.tuwan.com/activity/a40ffccc94e601ef80690bc9cb84a568.png"):i==Ht?n(3,m="https://dynamics-share.tuwan.com/activity/1d53f9bf7e650677bdcae0c3e3072a80.png"):6==i&&n(3,m="https://dynamics-share.tuwan.com/activity/b9f801144ae7dc1193d68c209d4bdd06.png")),65&e.$$.dirty&&(i==Vt?n(4,f="新建歌单"):i==Ft?n(4,f=r):2==i?n(4,f="重命名"):3==i?n(4,f="删除歌单"):i==Wt?n(4,f="设为上档BGM"):i==Qt?n(4,f="删除歌曲"):i==Ht?n(4,f="加入播放列表"):6==i&&n(4,f="编辑歌单"))},[i,c,d,m,f,h,r,a,l,u,p]}class en extends u{constructor(e){super(e),d(this,e,Zt,zt,p,{type:0,isSelected:1,title:6,groupId:7,code:8,callback:9,active:2,data:10}),h("SvelteRegisterComponent",{component:this,tagName:"EditItem",options:e,id:zt.name})}get type(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set type(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isSelected(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isSelected(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get title(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get groupId(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set groupId(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get code(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set code(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get callback(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set callback(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get active(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set active(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<EditItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<EditItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function tn(e){let t;const n={c:function(){t=$("div"),w(t,"class","line s-5SsR67hDMT8Q"),b(t,"src/js/bgm/components/line.svelte",0,0,0)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,n){k(e,t,n)},p:q,i:q,o:q,d:function(e){e&&I(t)}};return h("SvelteRegisterBlock",{block:n,id:tn.name,type:"component",source:"",ctx:e}),n}function nn(e,t){let{$$slots:n={},$$scope:o}=t;g("Line",n,[]);const s=[];return Object.keys(t).forEach((e=>{~s.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Line> was created with unknown prop '${e}'`)})),[]}class on extends u{constructor(e){super(e),d(this,e,nn,tn,p,{}),h("SvelteRegisterComponent",{component:this,tagName:"Line",options:e,id:tn.name})}}const sn="src/js/bgm/popup/editSongPopup.svelte";function cn(e,t,n){const o=e.slice();return o[15]=t[n],o}function rn(e){let t,n,o,s,i,c,r,a,l,u,d,p,m,g,f,y;o=new en({props:{type:Vt,callback:e[10]},$$inline:!0});let C=e[1]&&an(e);c=new on({$$inline:!0});let P=e[6];V(P);let v=[];for(let h=0;h<P.length;h+=1)v[h]=ln(cn(e,P,h));const B=e=>S(v[e],1,1,(()=>{v[e]=null}));l=new on({$$inline:!0}),d=new en({props:{type:Ht,groupId:e[4],code:e[2],data:e[3],callback:e[10]},$$inline:!0});let L=e[1]&&un(e);const G={c:function(){t=$("div"),n=$("div"),O(o.$$.fragment),s=Y(),C&&C.c(),i=Y(),O(c.$$.fragment),r=Y();for(let e=0;e<v.length;e+=1)v[e].c();a=Y(),O(l.$$.fragment),u=Y(),O(d.$$.fragment),p=Y(),L&&L.c(),w(n,"class","body s-372Tg0iywYHJ"),w(n,"style",m=e[5]+" transform: translate(calc(-100% + 25px), "+e[9]+")"),b(n,sn,70,8,1913),w(t,"class","bgm_edit_popup s-372Tg0iywYHJ"),J(t,"show",e[8]),b(t,sn,69,4,1820)},m:function(h,m){k(h,t,m),E(t,n),A(o,n,null),E(n,s),C&&C.m(n,null),E(n,i),A(c,n,null),E(n,r);for(let e=0;e<v.length;e+=1)v[e]&&v[e].m(n,null);E(n,a),A(l,n,null),E(n,u),A(d,n,null),E(n,p),L&&L.m(n,null),e[13](n),g=!0,f||(y=[M(n,"click",T(e[12]),!1,!1,!0,!1),M(t,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1)],f=!0)},p:function(o,s){if((e=o)[1]?C?(C.p(e,s),2&s&&x(C,1)):(C=an(e),C.c(),x(C,1),C.m(n,i)):C&&(U(),S(C,1,1,(()=>{C=null})),K()),1092&s){let t;for(P=e[6],V(P),t=0;t<P.length;t+=1){const o=cn(e,P,t);v[t]?(v[t].p(o,s),x(v[t],1)):(v[t]=ln(o),v[t].c(),x(v[t],1),v[t].m(n,a))}for(U(),t=P.length;t<v.length;t+=1)B(t);K()}const c={};16&s&&(c.groupId=e[4]),4&s&&(c.code=e[2]),8&s&&(c.data=e[3]),d.$set(c),e[1]?L?(L.p(e,s),2&s&&x(L,1)):(L=un(e),L.c(),x(L,1),L.m(n,null)):L&&(U(),S(L,1,1,(()=>{L=null})),K()),(!g||544&s&&m!==(m=e[5]+" transform: translate(calc(-100% + 25px), "+e[9]+")"))&&w(n,"style",m),(!g||256&s)&&J(t,"show",e[8])},i:function(e){if(!g){x(o.$$.fragment,e),x(C),x(c.$$.fragment,e);for(let e=0;e<P.length;e+=1)x(v[e]);x(l.$$.fragment,e),x(d.$$.fragment,e),x(L),g=!0}},o:function(e){S(o.$$.fragment,e),S(C),S(c.$$.fragment,e),v=v.filter(Boolean);for(let t=0;t<v.length;t+=1)S(v[t]);S(l.$$.fragment,e),S(d.$$.fragment,e),S(L),g=!1},d:function(n){n&&I(t),j(o),C&&C.d(),j(c),W(v,n),j(l),j(d),L&&L.d(),e[13](null),f=!1,R(y)}};return h("SvelteRegisterBlock",{block:G,id:rn.name,type:"if",source:"(69:0) {#if groups && groups.length}",ctx:e}),G}function an(e){let t,n;t=new en({props:{type:Wt,groupId:e[4],code:e[2],callback:e[10]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};16&n&&(o.groupId=e[4]),4&n&&(o.code=e[2]),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:an.name,type:"if",source:"(73:12) {#if isMine}",ctx:e}),o}function ln(e){let t,n;t=new en({props:{active:e[15].canAdd,type:Ft,isSelected:1==e[15].isIn,title:e[15].name,groupId:e[15].id,code:e[2],callback:e[10]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};64&n&&(o.active=e[15].canAdd),64&n&&(o.isSelected=1==e[15].isIn),64&n&&(o.title=e[15].name),64&n&&(o.groupId=e[15].id),4&n&&(o.code=e[2]),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:ln.name,type:"each",source:"(77:12) {#each groups as group}",ctx:e}),o}function un(e){let t,n,o,s;t=new on({$$inline:!0}),o=new en({props:{type:Qt,groupId:e[4],code:e[2],callback:e[10]},$$inline:!0});const i={c:function(){O(t.$$.fragment),n=Y(),O(o.$$.fragment)},m:function(e,i){A(t,e,i),k(e,n,i),A(o,e,i),s=!0},p:function(e,t){const n={};16&t&&(n.groupId=e[4]),4&t&&(n.code=e[2]),o.$set(n)},i:function(e){s||(x(t.$$.fragment,e),x(o.$$.fragment,e),s=!0)},o:function(e){S(t.$$.fragment,e),S(o.$$.fragment,e),s=!1},d:function(e){j(t,e),e&&I(n),j(o,e)}};return h("SvelteRegisterBlock",{block:i,id:un.name,type:"if",source:"(82:12) {#if isMine}",ctx:e}),i}function dn(e){let t,n,o=e[6]&&e[6].length&&rn(e);const s={c:function(){o&&o.c(),t=F()},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,s){o&&o.m(e,s),k(e,t,s),n=!0},p:function(e,[n]){e[6]&&e[6].length?o?(o.p(e,n),64&n&&x(o,1)):(o=rn(e),o.c(),x(o,1),o.m(t.parentNode,t)):o&&(U(),S(o,1,1,(()=>{o=null})),K())},i:function(e){n||(x(o),n=!0)},o:function(e){S(o),n=!1},d:function(e){o&&o.d(e),e&&I(t)}};return h("SvelteRegisterBlock",{block:s,id:dn.name,type:"component",source:"",ctx:e}),s}function pn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("EditSongPopup",o,[]);let i,{closeModal:c}=t,{isMine:r=!0}=t,{code:a=""}=t,{data:l={}}=t,{groupId:u=""}=t,{style:d}=t,{top:p=0}=t,h=[],m=!1,$="25px";function w(e){e==Ft?(y(),c()):e!=Qt&&e!=Ht||c()}function y(){de.get(pe.getBgmGroups(a,se.getCid())).then((e=>{0==e.error&&(n(6,h=[]),setTimeout((()=>{n(6,h=e.data)}),0))}))}f((()=>{y()})),f((()=>(Le.on(Ge,y),()=>Le.off(Ge,y)))),e.$$.on_mount.push((function(){void 0!==c||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<EditSongPopup> was created without expected prop 'closeModal'"),void 0!==d||"style"in t||e.$$.bound[e.$$.props.style]||console.warn("<EditSongPopup> was created without expected prop 'style'")}));const b=["closeModal","isMine","code","data","groupId","style","top"];return Object.keys(t).forEach((e=>{~b.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<EditSongPopup> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,c=e.closeModal),"isMine"in e&&n(1,r=e.isMine),"code"in e&&n(2,a=e.code),"data"in e&&n(3,l=e.data),"groupId"in e&&n(4,u=e.groupId),"style"in e&&n(5,d=e.style),"top"in e&&n(11,p=e.top)},e.$capture_state=()=>({onMount:f,ChatUrls:pe,common:se,request:de,Item:en,Line:on,TYPE_ADD:Vt,TYPE_GROUP:Ft,TYPE_WORK_BGM:Wt,TYPE_DELETE_SONG:Qt,TYPE_ADD_PLAYING_LIST:Ht,EMITTER_KEY_ADD_GROUP:Ge,emitter:Le,closeModal:c,isMine:r,code:a,data:l,groupId:u,style:d,top:p,groups:h,bodyRef:i,show:m,transformY:$,itemCallback:w,loadData:y}),e.$inject_state=e=>{"closeModal"in e&&n(0,c=e.closeModal),"isMine"in e&&n(1,r=e.isMine),"code"in e&&n(2,a=e.code),"data"in e&&n(3,l=e.data),"groupId"in e&&n(4,u=e.groupId),"style"in e&&n(5,d=e.style),"top"in e&&n(11,p=e.top),"groups"in e&&n(6,h=e.groups),"bodyRef"in e&&n(7,i=e.bodyRef),"show"in e&&n(8,m=e.show),"transformY"in e&&n(9,$=e.transformY)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{2240&e.$$.dirty&&h&&h.length&&i&&(document.documentElement.clientHeight-(p+25+10)<window.$(i).height()&&n(9,$="-100%"),n(8,m=!0))},[c,r,a,l,u,d,h,i,m,$,w,p,function(t){B.call(this,e,t)},function(e){Q[e?"unshift":"push"]((()=>{i=e,n(7,i)}))}]}const hn=class extends u{constructor(e){super(e),d(this,e,pn,dn,p,{closeModal:0,isMine:1,code:2,data:3,groupId:4,style:5,top:11}),h("SvelteRegisterComponent",{component:this,tagName:"EditSongPopup",options:e,id:dn.name})}get closeModal(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isMine(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isMine(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get code(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set code(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get groupId(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set groupId(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get style(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set style(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get top(){throw new Error("<EditSongPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set top(e){throw new Error("<EditSongPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};function mn(e){let t,n,o,s,i;n=new en({props:{type:2,groupId:e[0]},$$inline:!0}),s=new en({props:{type:3,groupId:e[0]},$$inline:!0});const c={c:function(){t=$("div"),O(n.$$.fragment),o=Y(),O(s.$$.fragment),w(t,"class","bgm_edit_group_popup s-g3GvaiDYsgZq"),b(t,"src/js/bgm/popup/editGroupPopup.svelte",8,0,148)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(e,c){k(e,t,c),A(n,t,null),E(t,o),A(s,t,null),i=!0},p:function(e,[t]){const o={};1&t&&(o.groupId=e[0]),n.$set(o);const i={};1&t&&(i.groupId=e[0]),s.$set(i)},i:function(e){i||(x(n.$$.fragment,e),x(s.$$.fragment,e),i=!0)},o:function(e){S(n.$$.fragment,e),S(s.$$.fragment,e),i=!1},d:function(e){e&&I(t),j(n),j(s)}};return h("SvelteRegisterBlock",{block:c,id:mn.name,type:"component",source:"",ctx:e}),c}function gn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("EditGroupPopup",o,[]);let{id:i}=t;e.$$.on_mount.push((function(){void 0!==i||"id"in t||e.$$.bound[e.$$.props.id]||console.warn("<EditGroupPopup> was created without expected prop 'id'")}));const c=["id"];return Object.keys(t).forEach((e=>{~c.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<EditGroupPopup> was created with unknown prop '${e}'`)})),e.$$set=e=>{"id"in e&&n(0,i=e.id)},e.$capture_state=()=>({Item:en,TYPE_RENAME:2,TYPE_DELETE:3,id:i}),e.$inject_state=e=>{"id"in e&&n(0,i=e.id)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i]}class fn extends u{constructor(e){super(e),d(this,e,gn,mn,p,{id:0}),h("SvelteRegisterComponent",{component:this,tagName:"EditGroupPopup",options:e,id:mn.name})}get id(){throw new Error("<EditGroupPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set id(e){throw new Error("<EditGroupPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const $n="src/js/bgm/editGroupModal/item.svelte";function wn(e){let t,n;t=new fn({props:{id:e[0].id},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};1&n&&(o.id=e[0].id),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:wn.name,type:"if",source:"(16:8) {#if editVisible}",ctx:e}),o}function yn(e){let t,n;t=new z({props:{class:"edit",src:"https://dynamics-share.tuwan.com/activity/defac4fe92a2b277a79018f61937f90c.png"},$$inline:!0}),t.$on("click",(function(){_(e[2].bind(null,e[0]))&&e[2].bind(null,e[0]).apply(this,arguments)}));const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(t,n){e=t},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:yn.name,type:"if",source:"(19:8) {#if data.default == 0}",ctx:e}),o}function bn(e){let t,n,o,s,i,c,r,a,l,u,d,p,m,g,f=e[0].name+"",y=e[0].count+"",C=e[1]&&wn(e),P=0==e[0].default&&yn(e);const v={c:function(){t=$("div"),n=$("div"),o=$("p"),s=D(f),i=Y(),c=$("p"),r=D(y),a=D("首歌曲"),l=Y(),u=$("div"),C&&C.c(),d=Y(),P&&P.c(),w(o,"class","name s-Gy16Cn2vj8j4"),b(o,$n,11,8,267),w(c,"class","count s-Gy16Cn2vj8j4"),b(c,$n,12,8,307),b(n,$n,10,4,253),w(u,"class","edit_con s-Gy16Cn2vj8j4"),b(u,$n,14,4,359),w(t,"class","edit_song_item s-Gy16Cn2vj8j4"),b(t,$n,9,0,220)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,f){k(h,t,f),E(t,n),E(n,o),E(o,s),E(n,i),E(n,c),E(c,r),E(c,a),E(t,l),E(t,u),C&&C.m(u,null),E(u,d),P&&P.m(u,null),p=!0,m||(g=M(u,"click",T((function(){_(e[2].bind(null,e[0]))&&e[2].bind(null,e[0]).apply(this,arguments)})),!1,!1,!0,!1),m=!0)},p:function(t,[n]){e=t,(!p||1&n)&&f!==(f=e[0].name+"")&&N(s,f),(!p||1&n)&&y!==(y=e[0].count+"")&&N(r,y),e[1]?C?(C.p(e,n),2&n&&x(C,1)):(C=wn(e),C.c(),x(C,1),C.m(u,d)):C&&(U(),S(C,1,1,(()=>{C=null})),K()),0==e[0].default?P?(P.p(e,n),1&n&&x(P,1)):(P=yn(e),P.c(),x(P,1),P.m(u,null)):P&&(U(),S(P,1,1,(()=>{P=null})),K())},i:function(e){p||(x(C),x(P),p=!0)},o:function(e){S(C),S(P),p=!1},d:function(e){e&&I(t),C&&C.d(),P&&P.d(),m=!1,g()}};return h("SvelteRegisterBlock",{block:v,id:bn.name,type:"component",source:"",ctx:e}),v}function kn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Item",o,[]);let{data:i={}}=t,{editVisible:c=!1}=t,{editClick:r}=t;e.$$.on_mount.push((function(){void 0!==r||"editClick"in t||e.$$.bound[e.$$.props.editClick]||console.warn("<Item> was created without expected prop 'editClick'")}));const a=["data","editVisible","editClick"];return Object.keys(t).forEach((e=>{~a.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Item> was created with unknown prop '${e}'`)})),e.$$set=e=>{"data"in e&&n(0,i=e.data),"editVisible"in e&&n(1,c=e.editVisible),"editClick"in e&&n(2,r=e.editClick)},e.$capture_state=()=>({Img:z,EditGroupPopup:fn,data:i,editVisible:c,editClick:r}),e.$inject_state=e=>{"data"in e&&n(0,i=e.data),"editVisible"in e&&n(1,c=e.editVisible),"editClick"in e&&n(2,r=e.editClick)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,r]}let En=class extends u{constructor(e){super(e),d(this,e,kn,bn,p,{data:0,editVisible:1,editClick:2}),h("SvelteRegisterComponent",{component:this,tagName:"Item",options:e,id:bn.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get editVisible(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set editVisible(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get editClick(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set editClick(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const Mn="src/js/bgm/editGroupModal/index.svelte";function Tn(e,t,n){const o=e.slice();return o[6]=t[n],o}function _n(e){let t,n;t=new En({props:{data:e[6],editVisible:e[2]==e[6].id,editClick:e[4]},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};2&n&&(o.data=e[6]),6&n&&(o.editVisible=e[2]==e[6].id),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:_n.name,type:"each",source:"(58:8) {#each list as item}",ctx:e}),o}function Cn(e){let t,n,o,s,i,c,r,a,l;o=new z({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),o.$on("click",(function(){_(e[0])&&e[0].apply(this,arguments)}));let u=e[1];V(u);let d=[];for(let h=0;h<u.length;h+=1)d[h]=_n(Tn(e,u,h));const p=e=>S(d[e],1,1,(()=>{d[e]=null})),m={c:function(){t=$("div"),n=$("div"),O(o.$$.fragment),s=Y(),i=$("p"),i.textContent="编辑歌单",c=Y();for(let e=0;e<d.length;e+=1)d[e].c();w(i,"class","title s-yfMzhol67Tl5"),b(i,Mn,56,8,1448),w(n,"class","body s-yfMzhol67Tl5"),b(n,Mn,54,4,1268),w(t,"class","bgm_edit_group_modal flex flex-ac s-yfMzhol67Tl5"),b(t,Mn,53,0,1178)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(u,p){k(u,t,p),E(t,n),A(o,n,null),E(n,s),E(n,i),E(n,c);for(let e=0;e<d.length;e+=1)d[e]&&d[e].m(n,null);r=!0,a||(l=[M(n,"click",T(e[3]),!1,!1,!0,!1),M(t,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1)],a=!0)},p:function(t,[o]){if(e=t,22&o){let t;for(u=e[1],V(u),t=0;t<u.length;t+=1){const s=Tn(e,u,t);d[t]?(d[t].p(s,o),x(d[t],1)):(d[t]=_n(s),d[t].c(),x(d[t],1),d[t].m(n,null))}for(U(),t=u.length;t<d.length;t+=1)p(t);K()}},i:function(e){if(!r){x(o.$$.fragment,e);for(let e=0;e<u.length;e+=1)x(d[e]);r=!0}},o:function(e){S(o.$$.fragment,e),d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)S(d[t]);r=!1},d:function(e){e&&I(t),j(o),W(d,e),a=!1,R(l)}};return h("SvelteRegisterBlock",{block:m,id:Cn.name,type:"component",source:"",ctx:e}),m}function Pn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("EditGroupModal",o,[]);let{closeModal:i}=t,c=[],r="";function a(){de.get(pe.getBgmMineGroup()).then((e=>{0==e.error&&n(1,c=e.data)}))}function l(){n(2,r="")}function u(e){e.id==r?n(2,r=""):n(2,r=e.id)}f((()=>{a()})),f((()=>(Le.on(Ye,a),()=>Le.off(Ye,a)))),f((()=>(Le.on(Ne,a),()=>Le.off(Ne,a)))),e.$$.on_mount.push((function(){void 0!==i||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<EditGroupModal> was created without expected prop 'closeModal'")}));const d=["closeModal"];return Object.keys(t).forEach((e=>{~d.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<EditGroupModal> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,i=e.closeModal)},e.$capture_state=()=>({onMount:f,Img:z,Item:En,ChatUrls:pe,request:de,EMITTER_KEY_DELETE_GROUP:Ye,EMITTER_KEY_RENAME_GROUP:Ne,emitter:Le,closeModal:i,list:c,showEditId:r,loadData:a,bodyClick:l,editClick:u}),e.$inject_state=e=>{"closeModal"in e&&n(0,i=e.closeModal),"list"in e&&n(1,c=e.list),"showEditId"in e&&n(2,r=e.showEditId)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,r,l,u]}const vn=class extends u{constructor(e){super(e),d(this,e,Pn,Cn,p,{closeModal:0}),h("SvelteRegisterComponent",{component:this,tagName:"EditGroupModal",options:e,id:Cn.name})}get closeModal(){throw new Error("<EditGroupModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<EditGroupModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}},xn="src/js/bgm/popup/editMenuPopup.svelte";function Sn(e){let t,n,o,s,i,c,r,a;o=new en({props:{type:Vt,callback:e[2]},$$inline:!0}),i=new en({props:{type:6,callback:e[2]},$$inline:!0});const l={c:function(){t=$("div"),n=$("div"),O(o.$$.fragment),s=Y(),O(i.$$.fragment),w(n,"class","body s-7LC7huTkakdt"),w(n,"style",e[1]),b(n,xn,20,4,513),w(t,"class","bgm_edit_menu_modal s-7LC7huTkakdt"),b(t,xn,19,0,437)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(l,u){k(l,t,u),E(t,n),A(o,n,null),E(n,s),A(i,n,null),c=!0,r||(a=[M(n,"click",T(e[3]),!1,!1,!0,!1),M(t,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1)],r=!0)},p:function(t,[o]){e=t,(!c||2&o)&&w(n,"style",e[1])},i:function(e){c||(x(o.$$.fragment,e),x(i.$$.fragment,e),c=!0)},o:function(e){S(o.$$.fragment,e),S(i.$$.fragment,e),c=!1},d:function(e){e&&I(t),j(o),j(i),r=!1,R(a)}};return h("SvelteRegisterBlock",{block:l,id:Sn.name,type:"component",source:"",ctx:e}),l}function In(e,t,n){let{$$slots:o={},$$scope:s}=t;g("EditMenuPopup",o,[]);let{closeModal:i}=t,{style:c}=t;function r(e){e==Vt?i&&i():6==e&&i&&i()}e.$$.on_mount.push((function(){void 0!==i||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<EditMenuPopup> was created without expected prop 'closeModal'"),void 0!==c||"style"in t||e.$$.bound[e.$$.props.style]||console.warn("<EditMenuPopup> was created without expected prop 'style'")}));const a=["closeModal","style"];return Object.keys(t).forEach((e=>{~a.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<EditMenuPopup> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,i=e.closeModal),"style"in e&&n(1,c=e.style)},e.$capture_state=()=>({Item:en,TYPE_ADD:Vt,TYPE_EDIT_GROUP:6,closeModal:i,style:c,itemCallback:r}),e.$inject_state=e=>{"closeModal"in e&&n(0,i=e.closeModal),"style"in e&&n(1,c=e.style)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,r,function(t){B.call(this,e,t)}]}const Rn=class extends u{constructor(e){super(e),d(this,e,In,Sn,p,{closeModal:0,style:1}),h("SvelteRegisterComponent",{component:this,tagName:"EditMenuPopup",options:e,id:Sn.name})}get closeModal(){throw new Error("<EditMenuPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<EditMenuPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get style(){throw new Error("<EditMenuPopup>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set style(e){throw new Error("<EditMenuPopup>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}},Bn="src/js/components/tagSelect.svelte";function On(e,t,n){const o=e.slice();return o[10]=t[n],o[12]=n,o}function An(e,t,n){const o=e.slice();return o[13]=t[n],o[15]=n,o}function jn(e){let t,n,o,s,i=e[13].tagName+"";const c={c:function(){t=$("p"),n=D(i),w(t,"class","s-asAnGqHPn1r5"),J(t,"seleced",e[13].selected),b(t,Bn,82,28,2178)},m:function(i,c){k(i,t,c),E(t,n),o||(s=M(t,"click",e[2].bind(null,e[12],e[15]),!1,!1,!1,!1),o=!0)},p:function(o,s){e=o,2&s&&i!==(i=e[13].tagName+"")&&N(n,i),2&s&&J(t,"seleced",e[13].selected)},d:function(e){e&&I(t),o=!1,s()}};return h("SvelteRegisterBlock",{block:c,id:jn.name,type:"each",source:"(82:24) {#each group.list as item, index}",ctx:e}),c}function Ln(e){let t,n,o,s,i,c,r=e[10].tagCategoryName+"",a=e[10].list;V(a);let l=[];for(let d=0;d<a.length;d+=1)l[d]=jn(An(e,a,d));const u={c:function(){t=$("div"),n=$("p"),o=D(r),s=Y(),i=$("div");for(let e=0;e<l.length;e+=1)l[e].c();c=Y(),w(n,"class","group_title s-asAnGqHPn1r5"),b(n,Bn,79,20,1995),w(i,"class","group_items s-asAnGqHPn1r5"),b(i,Bn,80,20,2066),w(t,"class","group s-asAnGqHPn1r5"),b(t,Bn,78,16,1955)},m:function(e,r){k(e,t,r),E(t,n),E(n,o),E(t,s),E(t,i);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(i,null);E(t,c)},p:function(e,t){if(2&t&&r!==(r=e[10].tagCategoryName+"")&&N(o,r),6&t){let n;for(a=e[10].list,V(a),n=0;n<a.length;n+=1){const o=An(e,a,n);l[n]?l[n].p(o,t):(l[n]=jn(o),l[n].c(),l[n].m(i,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=a.length}},d:function(e){e&&I(t),W(l,e)}};return h("SvelteRegisterBlock",{block:u,id:Ln.name,type:"each",source:"(78:12) {#each renderData as group, groupIndex}",ctx:e}),u}function Gn(e){let t,n=e[1];V(n);let o=[];for(let i=0;i<n.length;i+=1)o[i]=Ln(On(e,n,i));const s={c:function(){for(let e=0;e<o.length;e+=1)o[e].c();t=F()},m:function(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);k(e,t,n)},p:function(e,s){if(6&s){let i;for(n=e[1],V(n),i=0;i<n.length;i+=1){const c=On(e,n,i);o[i]?o[i].p(c,s):(o[i]=Ln(c),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d:function(e){W(o,e),e&&I(t)}};return h("SvelteRegisterBlock",{block:s,id:Gn.name,type:"slot",source:'(77:8) <ScrollView class=\\"tags\\">',ctx:e}),s}function Dn(e){let t,n,o,s,i,c,r,a,l,u,d,p;r=new ge({props:{class:"tags",$$slots:{default:[Gn]},$$scope:{ctx:e}},$$inline:!0});const m={c:function(){t=$("div"),n=$("div"),o=$("p"),o.textContent="选择标签",s=Y(),i=$("p"),i.textContent="跳过",c=Y(),O(r.$$.fragment),a=Y(),l=$("p"),l.textContent="确定",w(o,"class","title s-asAnGqHPn1r5"),b(o,Bn,74,8,1757),w(i,"class","close s-asAnGqHPn1r5"),b(i,Bn,75,8,1791),w(l,"class","btn s-asAnGqHPn1r5"),b(l,Bn,88,8,2412),w(n,"class","body s-asAnGqHPn1r5"),b(n,Bn,73,4,1730),w(t,"class","tag_select s-asAnGqHPn1r5"),b(t,Bn,72,0,1701)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,m){k(h,t,m),E(t,n),E(n,o),E(n,s),E(n,i),E(n,c),A(r,n,null),E(n,a),E(n,l),u=!0,d||(p=[M(i,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1),M(l,"click",T(e[3]),!1,!1,!0,!1)],d=!0)},p:function(t,[n]){e=t;const o={};65538&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i:function(e){u||(x(r.$$.fragment,e),u=!0)},o:function(e){S(r.$$.fragment,e),u=!1},d:function(e){e&&I(t),j(r),d=!1,R(p)}};return h("SvelteRegisterBlock",{block:m,id:Dn.name,type:"component",source:"",ctx:e}),m}function Yn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("TagSelect",o,[]);let{closeModal:i}=t,{max:c=3}=t,{multiple:r=!0}=t,{cb:a}=t,{data:l=[]}=t;function u(e,t){let o=0,s=0;if(h.forEach(((n,i)=>{n.list.forEach(((n,c)=>{!n.selected||e==i&&c==t||o++,e==i&&n.selected&&c!=t&&s++}))})),!r&&s>=1)return void ee("同一个分类只能选择一个标签");if(o>=c)return void ee(`已经超过最大选择数量${c}个`);const i=h[e].list[t];i.selected=!i.selected,n(1,h)}function d(){const e=p();m.join(",")==e.join(",")||a&&a(e),i&&i()}function p(){let e=[];return h.forEach((t=>t.list.forEach((t=>{t.selected&&e.push(t)})))),e}let h=l,m=p();e.$$.on_mount.push((function(){void 0!==i||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<TagSelect> was created without expected prop 'closeModal'"),void 0!==a||"cb"in t||e.$$.bound[e.$$.props.cb]||console.warn("<TagSelect> was created without expected prop 'cb'")}));const f=["closeModal","max","multiple","cb","data"];return Object.keys(t).forEach((e=>{~f.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<TagSelect> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,i=e.closeModal),"max"in e&&n(4,c=e.max),"multiple"in e&&n(5,r=e.multiple),"cb"in e&&n(6,a=e.cb),"data"in e&&n(7,l=e.data)},e.$capture_state=()=>({ScrollView:ge,showTips:ee,closeModal:i,max:c,multiple:r,cb:a,data:l,tagClick:u,confirmClick:d,getSelects:p,renderData:h,initSelects:m}),e.$inject_state=e=>{"closeModal"in e&&n(0,i=e.closeModal),"max"in e&&n(4,c=e.max),"multiple"in e&&n(5,r=e.multiple),"cb"in e&&n(6,a=e.cb),"data"in e&&n(7,l=e.data),"renderData"in e&&n(1,h=e.renderData),"initSelects"in e&&(m=e.initSelects)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,h,u,d,c,r,a,l]}const Nn=class extends u{constructor(e){super(e),d(this,e,Yn,Dn,p,{closeModal:0,max:4,multiple:5,cb:6,data:7}),h("SvelteRegisterComponent",{component:this,tagName:"TagSelect",options:e,id:Dn.name})}get closeModal(){throw new Error("<TagSelect>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<TagSelect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get max(){throw new Error("<TagSelect>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set max(e){throw new Error("<TagSelect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get multiple(){throw new Error("<TagSelect>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set multiple(e){throw new Error("<TagSelect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get cb(){throw new Error("<TagSelect>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set cb(e){throw new Error("<TagSelect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<TagSelect>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<TagSelect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}},Un="src/js/bgm/playingListModal/item.svelte";function Kn(e){let t,n,o,s,i,c,r,a,l,u=e[0].name+"";i=new z({props:{class:"effect",src:"https://res.tuwan.com/chatroom/images/icon_song_playing.gif"},$$inline:!0});const d={c:function(){t=$("div"),n=$("p"),o=D(u),s=Y(),O(i.$$.fragment),w(n,"class","name s-FGFhX4EqwJiU"),b(n,Un,16,4,361),w(t,"class",c="playing_music "+e[1]+" s-FGFhX4EqwJiU"),b(t,Un,15,0,285)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,u){k(c,t,u),E(t,n),E(n,o),E(t,s),A(i,t,null),r=!0,a||(l=M(t,"click",T(e[2]),!1,!1,!0,!1),a=!0)},p:function(e,[n]){(!r||1&n)&&u!==(u=e[0].name+"")&&N(o,u),(!r||2&n&&c!==(c="playing_music "+e[1]+" s-FGFhX4EqwJiU"))&&w(t,"class",c)},i:function(e){r||(x(i.$$.fragment,e),r=!0)},o:function(e){S(i.$$.fragment,e),r=!1},d:function(e){e&&I(t),j(i),a=!1,l()}};return h("SvelteRegisterBlock",{block:d,id:Kn.name,type:"component",source:"",ctx:e}),d}function qn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("Item",o,[]);let{data:i={}}=t,{cls:c=""}=t,{bodyClick:r}=t;function a(){c.indexOf("playing")>=0||r&&r(i)}e.$$.on_mount.push((function(){void 0!==r||"bodyClick"in t||e.$$.bound[e.$$.props.bodyClick]||console.warn("<Item> was created without expected prop 'bodyClick'")}));const l=["data","cls","bodyClick"];return Object.keys(t).forEach((e=>{~l.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<Item> was created with unknown prop '${e}'`)})),e.$$set=e=>{"data"in e&&n(0,i=e.data),"cls"in e&&n(1,c=e.cls),"bodyClick"in e&&n(3,r=e.bodyClick)},e.$capture_state=()=>({Img:z,data:i,cls:c,bodyClick:r,_bodyClick:a}),e.$inject_state=e=>{"data"in e&&n(0,i=e.data),"cls"in e&&n(1,c=e.cls),"bodyClick"in e&&n(3,r=e.bodyClick)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),[i,c,a,r]}class Vn extends u{constructor(e){super(e),d(this,e,qn,Kn,p,{data:0,cls:1,bodyClick:3}),h("SvelteRegisterComponent",{component:this,tagName:"Item",options:e,id:Kn.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get cls(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set cls(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get bodyClick(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set bodyClick(e){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Fn="src/js/bgm/playingListModal/index.svelte";function Wn(e,t,n){const o=e.slice();return o[9]=t[n],o}function Qn(e){let t,n;t=new Vn({props:{data:e[9],bodyClick:e[4],cls:""+(e[2]==e[9].song_code?"playing":"")},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},p:function(e,n){const o={};4&n&&(o.cls=""+(e[2]==e[9].song_code?"playing":"")),t.$set(o)},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Qn.name,type:"each",source:"(54:12) {#each list as item}",ctx:e}),o}function Hn(e){let t,n;t=new $e({props:{desc:"暂无播放歌曲"},$$inline:!0});const o={c:function(){O(t.$$.fragment)},m:function(e,o){A(t,e,o),n=!0},i:function(e){n||(x(t.$$.fragment,e),n=!0)},o:function(e){S(t.$$.fragment,e),n=!1},d:function(e){j(t,e)}};return h("SvelteRegisterBlock",{block:o,id:Hn.name,type:"if",source:"(57:12) {#if list.length == 0}",ctx:e}),o}function Xn(e){let t,n,o,s=e[3];V(s);let i=[];for(let l=0;l<s.length;l+=1)i[l]=Qn(Wn(e,s,l));const c=e=>S(i[e],1,1,(()=>{i[e]=null}));let r=0==e[3].length&&Hn(e);const a={c:function(){for(let e=0;e<i.length;e+=1)i[e].c();t=Y(),r&&r.c(),n=F()},m:function(e,s){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,s);k(e,t,s),r&&r.m(e,s),k(e,n,s),o=!0},p:function(e,n){if(28&n){let o;for(s=e[3],V(s),o=0;o<s.length;o+=1){const c=Wn(e,s,o);i[o]?(i[o].p(c,n),x(i[o],1)):(i[o]=Qn(c),i[o].c(),x(i[o],1),i[o].m(t.parentNode,t))}for(U(),o=s.length;o<i.length;o+=1)c(o);K()}},i:function(e){if(!o){for(let e=0;e<s.length;e+=1)x(i[e]);x(r),o=!0}},o:function(e){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)S(i[t]);S(r),o=!1},d:function(e){W(i,e),e&&I(t),r&&r.d(e),e&&I(n)}};return h("SvelteRegisterBlock",{block:a,id:Xn.name,type:"slot",source:"(53:8) <ScrollView>",ctx:e}),a}function Jn(e){let t,n,o,s,i,c,r,a,l,u;r=new ge({props:{$$slots:{default:[Xn]},$$scope:{ctx:e}},$$inline:!0});const d={c:function(){t=$("div"),n=$("div"),o=$("p"),s=D("播放列表"),i=$("span"),i.textContent=`(${e[3].length}首歌)`,c=Y(),O(r.$$.fragment),w(i,"class","s-e_03fI1W9_PL"),b(i,Fn,51,29,1736),w(o,"class","title s-e_03fI1W9_PL"),b(o,Fn,51,8,1715),w(n,"class","body s-e_03fI1W9_PL"),w(n,"style",e[1]),b(n,Fn,50,4,1647),w(t,"class","playing_list_modal s-e_03fI1W9_PL"),b(t,Fn,49,0,1572)},l:function(e){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(d,p){k(d,t,p),E(t,n),E(n,o),E(o,s),E(o,i),E(n,c),A(r,n,null),a=!0,l||(u=[M(n,"click",T(e[7]),!1,!1,!0,!1),M(t,"click",T((function(){_(e[0])&&e[0].apply(this,arguments)})),!1,!1,!0,!1)],l=!0)},p:function(t,[o]){e=t;const s={};4100&o&&(s.$$scope={dirty:o,ctx:e}),r.$set(s),(!a||2&o)&&w(n,"style",e[1])},i:function(e){a||(x(r.$$.fragment,e),a=!0)},o:function(e){S(r.$$.fragment,e),a=!1},d:function(e){e&&I(t),j(r),l=!1,R(u)}};return h("SvelteRegisterBlock",{block:d,id:Jn.name,type:"component",source:"",ctx:e}),d}function zn(e,t,n){let{$$slots:o={},$$scope:s}=t;g("PlayingListModal",o,[]);let{closeModal:i}=t,{style:c}=t;function r(){n(6,a+=1)}let a=0;f((()=>(Le.on(qe,r),()=>Le.off(qe,r)))),f((()=>(Le.on(We,r),()=>Le.off(We,r))));const l=eo.getInstance();let u=l.playingList,d=l.currentPlayer?l.currentPlayer.data.song_code:"";function p(e){ye.track3("music_play",{action:"play",song_code:e.song_code,music_name:e.name,type:l.playingGroupId,singer:e.singer,online_songs:"yes",position:"network",cid:se.getCid()}),l.playMuisc(e,l.playingGroupId)}e.$$.on_mount.push((function(){void 0!==i||"closeModal"in t||e.$$.bound[e.$$.props.closeModal]||console.warn("<PlayingListModal> was created without expected prop 'closeModal'"),void 0!==c||"style"in t||e.$$.bound[e.$$.props.style]||console.warn("<PlayingListModal> was created without expected prop 'style'")}));const h=["closeModal","style"];return Object.keys(t).forEach((e=>{~h.indexOf(e)||"$$"===e.slice(0,2)||"slot"===e||console.warn(`<PlayingListModal> was created with unknown prop '${e}'`)})),e.$$set=e=>{"closeModal"in e&&n(0,i=e.closeModal),"style"in e&&n(1,c=e.style)},e.$capture_state=()=>({onMount:f,Item:Vn,Bgm:eo,ScrollView:ge,Empty:$e,Analytics:ye,common:se,EMITTER_KEY_PLAY_SONG:qe,EMITTER_KEY_DESTROY_SONG:We,EMITTER_KEY_PAUSE_SONG:Ve,EMITTER_KEY_RESUME_SONG:Fe,emitter:Le,closeModal:i,style:c,forceUpdate:r,forceUpdateIndex:a,instance:l,list:u,playingCode:d,muiscClick:p}),e.$inject_state=e=>{"closeModal"in e&&n(0,i=e.closeModal),"style"in e&&n(1,c=e.style),"forceUpdateIndex"in e&&n(6,a=e.forceUpdateIndex),"list"in e&&n(3,u=e.list),"playingCode"in e&&n(2,d=e.playingCode)},t&&"$$inject"in t&&e.$inject_state(t.$$inject),e.$$.update=()=>{64&e.$$.dirty&&a&&n(2,d=l.currentPlayer?l.currentPlayer.data.song_code:"")},[i,c,d,u,p,r,a,function(t){B.call(this,e,t)}]}const Zn=class extends u{constructor(e){super(e),d(this,e,zn,Jn,p,{closeModal:0,style:1,forceUpdate:5}),h("SvelteRegisterComponent",{component:this,tagName:"PlayingListModal",options:e,id:Jn.name})}get closeModal(){throw new Error("<PlayingListModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(e){throw new Error("<PlayingListModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get style(){throw new Error("<PlayingListModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set style(e){throw new Error("<PlayingListModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[5]}set forceUpdate(e){throw new Error("<PlayingListModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};class eo{constructor(){this.bgmDom=window.$(".chat-function-bgm"),this.quickBgmModalComp=null,this.libraryModalComp=null,this.currentPlayer=null,this.dangSong=null,this.isAnchor=!1,this.original=!1,this.volume=100,this.playingList=[],this.playingGroupId="",this.recommendList=[]}static getInstance(){return this.instance||(this.instance=new eo,this.instance.registEvents()),this.instance}onReset(){this.quickBgmModalComp&&(this.quickBgmModalComp.$destroy(),this.quickBgmModalComp=null),this.libraryModalComp&&(this.libraryModalComp.$destroy(),this.libraryModalComp=null),this.destroyMusic(),this.playingList=[],this.playingGroupId="",this.dangSong=null,this.recommendList=[]}registEvents(){const e=this;this.bgmDom.on("click",(function(t){t.stopPropagation(),Ee.getInstance().getBgmFirstShow()?e.showCuickBgmModalComp():(e.loadQuickBgmModalComp(),e.showLibraryComp(),e.showTagSelectComp(),Ee.getInstance().setBgmFirstShow())}))}ablePlayBgm(){return se.getRoomInfo().bgm_switch&&!(se.isSpecialSongRoom()&&0!=se.getRoomInfo().voice_type)}checkShowBgm(){this.ablePlayBgm()&&se.isAnchor(se.getMeid())&&!se.isChorusRoom()?this.bgmDom.show():(this.destroyMusic(),this.bgmDom.hide())}updateSeats(){se.getAnchorKengUser(se.getMeid())?(0==this.isAnchor&&(se.getAnchoringUserId()==se.getMeid()?this.currentPlayer?this.publishTracks():this.updateDangSong().then((()=>{this.dangSong&&this.ablePlayBgm()&&(this.playMuisc(this.dangSong,this.dangSong.playlistId,!0),this.recommendList.length?this.playingList=this.recommendList:de.get(pe.getBgmRecommendAndCustomTabSongs(se.getCid(),1)).then((e=>{if(0==e.error){const t=e.data||[];this.recommendList=t,this.playingList=t}})))})):this.publishTracks()),this.isAnchor=!0):(this.currentPlayer&&this.isAnchor&&this.destroyMusic(),this.isAnchor=!1)}publishTracks(e=!1){!e&&window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin")||this.currentPlayer&&this.currentPlayer.publishTracks()}unpublishTracks(){this.currentPlayer&&this.currentPlayer.unpublishTracks()}async updateDangSong(){return new Promise(((e,t)=>{de.get(pe.getBgmGetWorkBgm()).then((t=>{0==t.error&&(this.dangSong=t.data,Le.emit(Ke),e())}))}))}destroyMusic(){this.currentPlayer&&(this.currentPlayer.destroy(),this.currentPlayer=null,Le.emit(We))}playWithDirection(e=!0,t,n){if(ot.isLoadingBgm)return void ee("上一首歌曲正在加载中，请稍后~");let o;this.destroyMusic(),o=e?this.findNext.bind(this):this.findPre.bind(this);let s=o(t.song_code);s?this.playMuisc(s,n,!1,!0):this.playingList.length?this.playMuisc(this.playingList[0],n,!1,!0):console.log("没有可循环的歌曲")}playMuisc(e,t,n=!1,o=!1){o&&ye.track3("music_play",{action:"auto_play",music_name:e.name,type:t,singer:e.singer,online_songs:"yes",position:"network",cid:se.getCid()}),!n&&se.getAnchorKengUser(se.getMeid())&&(n=!0),this.destroyMusic(),this.currentPlayer=new ot(e,t),this.currentPlayer.publishSteam=!!n,this.currentPlayer.endCb=()=>{this.playWithDirection(!0,e,t)},this.currentPlayer.errorCb=()=>{ee("歌曲加载失败，请手动切换歌曲"),this.destroyMusic()},this.currentPlayer.play(),Le.emit(qe)}findNext(e){return this.findMusic(!0,e)}findPre(e){return this.findMusic(!1,e)}findMusic(e,t){const n=this.playingList;if(n){let o=n.findIndex((e=>e.song_code==t));if(o>=0)return e?o+1>=n.length?o=0:o+=1:0==o?o=n.length-1:o-=1,n[o]}return null}loadQuickBgmModalComp(){this.updateDangSong(),this.quickBgmModalComp||(this.quickBgmModalComp=new Yt({target:this.bgmDom[0]}))}showCuickBgmModalComp(){this.loadQuickBgmModalComp(),this.quickBgmModalComp.show()}hideQuickBgmModalComp(){this.quickBgmModalComp&&this.quickBgmModalComp.hide()}showLibraryComp(){this.libraryModalComp||(this.libraryModalComp=new qt({target:document.body,props:{closeModal:()=>{this.libraryModalComp.hide()}}})),this.libraryModalComp.show()}showTagSelectComp(){de.get(pe.getBgmTags()).then((e=>{0==e.error&&e.data&&e.data.length>0&&(this.tagSelectComp||(this.tagSelectComp=new Nn({target:document.body,props:{closeModal:()=>{this.tagSelectComp.$destroy(),this.tagSelectComp=null},data:e.data,cb:e=>{de.get(pe.setBgmTags(e.map((e=>e.tagId)))).then((e=>{0==e.error?this.libraryModalComp&&this.libraryModalComp.refreshMineLike():ee(e.error_msg)}))}}})))}))}showPlayingListModal(e){const t=e.getBoundingClientRect();Z(Zn,{style:`left: ${t.left+10}px; top: ${t.top-10}px;`})}showEditSongPopupComp(e){Z(hn,e)}showEditMenuPopupComp(e){Z(Rn,e)}showAlert(e){Z(Me,e)}showEditGroupComp(){Z(vn)}}export{eo as default};
//# sourceMappingURL=main-08e2031d.js.map
