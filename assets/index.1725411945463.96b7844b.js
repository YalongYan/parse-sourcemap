var t,e=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,c=(t,e)=>{for(var n in e||(e={}))s.call(e,n)&&r(t,n,e[n]);if(o)for(var n of o(e))a.call(e,n)&&r(t,n,e[n]);return t},l=(t,e)=>n(t,i(e)),d=(t,e)=>{var n={};for(var i in t)s.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&o)for(var i of o(t))e.indexOf(i)<0&&a.call(t,i)&&(n[i]=t[i]);return n},m=(t,e,n)=>(r(t,"symbol"!=typeof e?e+"":e,n),n);import{S as h,i as u,d as p,s as g,v as f,o as w,a as v,e as _,b as y,c as x,f as b,n as k,g as C,h as I,j as S,k as T,l as R,t as M,m as A,p as P,q as j,r as D,u as L,w as E,x as B,y as F,z as U,A as z,B as O,C as N,D as q,E as G,F as V,G as H,H as W,I as K,J as Y,K as J,L as Q,M as X,N as Z,O as tt,P as et,Q as nt,R as it,T as ot,U as st,V as at,W as rt,X as ct,Y as lt,Z as dt,_ as mt,$ as ht,a0 as ut,a1 as pt,a2 as gt,a3 as ft,a4 as wt,a5 as vt,a6 as _t,a7 as yt}from"./vendor-a26d429a.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class xt{constructor(t){this.session=window.sessionStorage,this.localsession=window.localStorage,this.instance=null,this.storeKeys={recchannel:"RecChannelInfo",channels:"channels",users:"users",paidanAnchors:"paidanAnchors",selfuser:"selfuser",voiceLog:"voiceLog",historyTag:"historyTag",mainVolume:"mainVolume",upSeatSwitch:"upSeatSwitch"}}static getInstance(){return this.instance||(this.instance=new xt(window.sessionStorage)),this.instance}valueType(t){return Object.prototype.toString.call(t)}setItem(t,e){const n=this.valueType(e);let i="";"[object Array]"===n?i="array":"[object Object]"===n?i="object":"[object String]"===n?i="string":"[object Map]"===n?i="map":"[object Boolean]"===n&&(i="bool");const o={type:i,value:e},s=JSON.stringify(o);if(this.session.setItem(t,s),""==i)return null}getItem(t){const e=this.session.getItem(t);if(e){return JSON.parse(e).value}return null}getMainVolume(){const t=this.localsession.getItem(this.storeKeys.mainVolume);return null==t?100:Number(t)}setMainVolume(t){this.localsession.setItem(this.storeKeys.mainVolume,t)}getUpSeatSwitch(){return this.session.getItem(this.storeKeys.upSeatSwitch)}setUpSeatSwitch(t){this.session.setItem(this.storeKeys.upSeatSwitch,t)}getHistoryTag(){return JSON.parse(this.localsession.getItem(this.storeKeys.historyTag))}setHistoryTag(t){this.localsession.setItem(this.storeKeys.historyTag,JSON.stringify(t))}removeHistoryTag(){this.localsession.removeItem(this.storeKeys.historyTag)}setPaidanAnchors(t){this.setItem(this.storeKeys.paidanAnchors,t)}getPaidanAnchors(){return this.getItem(this.storeKeys.paidanAnchors)}addArrayItem(t,e,n){let i=this.getItem(t);i.push(n),this.setItem(t,i)}addObjectItem(t,e,n,i){let o=this.getItem(t)||{};o[n]=i,this.setItem(t,o)}async addUserInfo(t){const e=1*t.uid;let n=this.getItem(this.storeKeys.users)||{};n[e]?n[e]=Object.assign(n[e],t):n[e]=t,this.setItem(this.storeKeys.users,n)}async addUsersInfo(t){let e=this.getItem(this.storeKeys.users)||{};for(let n=0;n<t.length;n++){const i=t[n],o=1*i.uid;e[o]?e[o]=Object.assign(e[o],i):e[o]=i}this.setItem(this.storeKeys.users,e)}getUserInfo(t){const e=this.getItem(this.storeKeys.users);return null==e?null:e[1*t]}getChannelInfo(t){return this.getChannels()[t]}getRecChannel(){return this.getItem(this.storeKeys.recchannel)}setRecChannel(t){this.setItem(this.storeKeys.recchannel,t)}setChannels(t){this.setItem(this.storeKeys.channels,t)}getChannels(){return this.getItem(this.storeKeys.channels)}setSelfUser(t){this.setItem(this.storeKeys.selfuser,t)}getSelfUser(){return this.getItem(this.storeKeys.selfuser)}addVoiceLog(t){let e=[];const n=this.localsession.getItem(this.storeKeys.voiceLog);n&&(e=JSON.parse(n)),e.push(t);const i=JSON.stringify(e);this.localsession.setItem(this.storeKeys.voiceLog,i)}getVoiceLog(){const t=this.localsession.getItem(this.storeKeys.voiceLog);if(t){return JSON.parse(t)}return null}removeVoiceLog(){this.localsession.removeItem(this.storeKeys.voiceLog)}setBaseUrl(t){const e=JSON.stringify(t);this.localsession.setItem("base-url",e)}getBaseUrl(){const t=this.localsession.getItem("base-url");return JSON.parse(t)}getSongOrderList(){const t=this.localsession.getItem("songOrderList");return JSON.parse(t)}setSongOrderList(t){this.localsession.setItem("songOrderList",JSON.stringify(t))}getGiftEffectSwithState(){return"true"===this.localsession.getItem("giftEffectSwith")}setGiftEffectSwithState(t){this.localsession.setItem("giftEffectSwith",t)}getBgmFirstShow(){return this.localsession.getItem("bgmFirstShow")}setBgmFirstShow(){this.localsession.setItem("bgmFirstShow","1")}setGoldMagicAnimIgnore(t){this.localsession.setItem("goldMagicAnimIgnore",t)}getGoldMagicAnimIgnore(){return this.localsession.getItem("goldMagicAnimIgnore")}}const bt=xt.getInstance(),$t=new Set,kt=new Map;class Ct{static getHashString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.hash.substr(1).match(e);return null!=n?unescape(n[2]):null}static changeDianDianKaiHeiToTuYan(t){let e=t;return window.location.href.indexOf("https://www.diandiankaihei.com")>-1&&e.indexOf("langren")>-1&&(e.indexOf("y-test.tuwan.com")>-1?e=e.replace(/y-test.tuwan.com/,"www.diandiankaihei.com"):e.indexOf("y.tuwan.com")>-1&&(e=e.replace(/y.tuwan.com/,"www.diandiankaihei.com"))),e}static getQueryString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null}static checkChromeFor360(){let t=navigator.userAgent.split(" "),e=!1;if(-1==t[t.length-1].indexOf("Safari"))return e;for(let n in navigator.plugins)if("np-mswmp.dll"==navigator.plugins[n].filename)return!0;return e}static is360Browser(){var t=navigator.userAgent.toLocaleLowerCase();return null!=t.match(/metasr/)?"sougou":null!=t.match(/chrome/)?navigator.mimeTypes["application/vnd.chromium.remoting-viewer"]||navigator.mimeTypes["application/360softmgrplugin"]||Ct.checkChromeFor360()?"360":"chrome":null!=t.match(/safari/)?"safari":"other"}static browserDevice(){var t=navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Adr")>-1,iPhone:t.indexOf("iPhone")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:t.indexOf("MicroMessenger")>-1,qq:" qq"==t.match(/\sQQ/i)}}static nrTobr(t){let e=t.replace(/\r\n/g,"<br>");return e=e.replace(/\n/g,"<br>"),e}static loadImage(t,e){let n=new Image;n.src=t,n.complete?e&&e(n):n.onload=function(){e&&e(n)}}static uploadImage(t,e){let n=null;if(!window.FileReader)return void alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");n=new FileReader;const i=t.files[0];/^image\//.test(i.type)?(n.onload=function(t){const n=t.target.result;e(n)},n.readAsDataURL(i)):alert("请选择图片！")}static uploadImageWithVerify(t,e,n,i,o){if(void 0!==n&&t.files[0].size>1e3*n)return void alert(`图片大小限制为${n}kb`);this.uploadImage(t,(t=>{if(void 0!==i&&void 0!==o){var n=new Image;return n.onload=function(){var s=n.width,a=n.height;i!=s||o!=a?alert(`图片尺寸限制[${i}*${o}]`):e&&e(t)},void(n.src=t)}e&&e(t)}))}static uploadGameFile(t,e){if(!window.FileReader)return void alert("您的设备不支持上传功能，如需该功能请升级您的设备！");new FileReader;const n=t.files[0],i=n.name.toLowerCase(),o=i.substring(i.lastIndexOf(".")+1,i.length);let s=!1;[{type:["zip"],core:"fbneo"},{type:["nes","fds","unif","unf"],core:"fceumm"},{type:["sfc","smc","swc","fig","bs","st"],core:"snes9x"},{type:["gen","bin","smd","mdx","md","cue","iso","sms","gg","sg","68k","chd"],core:"genesis-plus-gx"},{type:["gb","gba","gbc"],core:"vbam"}].map((({core:t,type:e},n)=>{e.includes(o)&&(s=!0)})),s?n.size>104857600?alert("游戏ROM最大支持100MB！"):e(n):alert("请选择正确的游戏ROM格式！")}static onlineImageTobase64(t){return new Promise(((e,n)=>{const i=new Image;i.crossOrigin="*",i.src=t,i.onload=function(){const t=Ct.imageTobase64(i);e(t)},i.onerror=function(){n()}}))}static imageTobase64(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;e.getContext("2d").drawImage(t,0,0,t.width,t.height);return e.toDataURL("image/png")}static check(t){return(t=t.toString()).length<2&&(t="0"+t),t}static dateFormat(t,e){var n={};return n.M=t.getMonth()+1,n.H=t.getHours(),n.s=t.getSeconds(),n.m=t.getMinutes(),n.Y=t.getFullYear(),n.D=t.getDate(),n.d=t.getDay(),n.d=Ct.check(n.d),n.H=Ct.check(n.H),n.M=Ct.check(n.M),n.D=Ct.check(n.D),n.s=Ct.check(n.s),n.m=Ct.check(n.m),e.indexOf("-")>-1?n.Y+"-"+n.M+"-"+n.D+" "+n.H+":"+n.m+":"+n.s:e.indexOf(":")>-1?(n.Y=n.Y.toString().substr(2,2),n.Y+"/"+n.M+"/"+n.D+" "+n.H+":"+n.m+":"+n.s):e.indexOf("/")>-1?n.Y+"/"+n.M+"/"+n.D+" "+n.H+"/"+n.m+"/"+n.s:e.indexOf("text")>-1?n.M+"月"+n.D+"日"+n.H+"点":void 0}static dateFormatA(t,e){var n={};return n.M=t.getMonth()+1,n.H=t.getHours(),n.s=t.getSeconds(),n.m=t.getMinutes(),n.Y=t.getFullYear(),n.D=t.getDate(),n.d=t.getDay(),e.indexOf(".")>-1?n.Y+"."+n.M+"."+n.D:e.indexOf("-")>-1?n.Y+"-"+n.M+"-"+n.D:e.indexOf(":")>-1?(n.Y=n.Y.toString().substr(2,2),n.Y+":"+n.M+":"+n.D):e.indexOf("/")>-1?n.Y+"/"+n.M+"/"+n.D:void 0}static dateFormatB(t){let e="0"+t.getMinutes(),n="0"+t.getHours();return n.substring(n.length-2,n.length)+":"+e.substring(e.length-2,e.length)}static formNumberToHourMinute(t){if(!t)return"";let e=parseInt(t),n=Math.floor(e/60),i=e-60*n;return n=n<10?"0"+n:n,i=i<10?"0"+i:i,`${n}:${i}`}static getSessionId(t){return"sessionid_"+t+"_"+(new Date).getTime()+"_"+Ct.getUUID()}static getUUID(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()}static setCookie(t,e,n=30,i=".tuwan.com"){let o=new Date;new Date((new Date).setHours(0,0,0,0)+864e5-1),o.setTime(o.getTime()+24*n*60*60*1e3),document.cookie=t+"="+escape(e)+";path=/;domain="+i+";expires="+o.toGMTString()}static setCookie1(t,e){var n=new Date;n.setTime(n.setHours(0,0,0,0)+864e5-1),document.cookie=t+"="+escape(e)+";path=/;expires="+n.toGMTString()}static readCookie(t){var e,n=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(n))?unescape(e[2]):null}static delCookie(t){null!=Ct.readCookie(t)&&(document.cookie=t+"=;path=/;expires="+new Date(0).toGMTString())}static delCookieChannel(t){null!=Ct.readCookie(t)&&(document.cookie=t+"=;path=/;domain=y.tuwan.com;expires="+new Date(0).toGMTString())}static replaceGuanSp_R(t){let e=[];if(t.split("♚").length>1)return t;if(t.split("♕").length>1)e=t.split("♕");else if(t.split("♔").length>1)e=t.split("♔");else{if(!(t.split("☬").length>1))return t;e=t.split("☬")}return e[e.length-1]}static replaceGuan(t){let e=[];if(t.split("♚").length>1)e=t.split("♚");else if(t.split("♕").length>1)e=t.split("♕");else if(t.split("♔").length>1)e=t.split("♔");else{if(!(t.split("☬").length>1))return t;e=t.split("☬")}return e[e.length-1]}static getExtension(t){return t.split(".").pop()}static UUID(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static UUIDNOCA(){return"xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static Alert(t,e,n=""){if(!t)return;let i=t,o=200001;"string"!=typeof t&&(o=t.zIndex||200001,i=t.msg),window.$.DialogByZ.Alert({Title:n||"提示",Content:i,BtnL:"确定",FunL:function(){window.$.DialogByZ.Close(),e&&e()}}),200001!=o&&setTimeout((()=>{$(".zbox-popup.zbox-popup-in").css("z-index",o)}),100)}static Confirm(t,e,n,i){n=n||"确定",i=i||"",window.$.DialogByZ.Confirm({Title:i,Content:t,BtnL:"取消",BtnR:n,FunL:function(){window.$.DialogByZ.Close()},FunR:function(){e(),window.$.DialogByZ.Close()}})}static diffArray(t,e){const n=new Set(e),i=new Set(t);return Array.from([...n,...i]).filter((t=>!n.has(t)||!i.has(t)))}static diffObjectIsChanged(t,e){return t.position!=e.position||(t.online!=e.online||(t.live_rec!=e.live_rec||(t.owner!=e.owner||t.heads!=e.heads)))}static diffArrayForKey(t,e,n="uid"){let i=new Map,o=new Map,s=new Map,a=new Map;t.forEach((t=>{s.set(t[n],t),i.set(t[n],t)})),e.forEach((t=>{o.set(t[n],t),i.set(t[n],t)}));for(let[r,c]of i)if(o.has(r)&&s.has(r)){const t=s.get(r),e=o.get(r);this.diffObjectIsChanged(e,t)&&a.set(r,e)}else a.set(r,c);return{nowMap:o,preMap:s,diffMap:a}}static diffArrayForKeyWithTake(t,e,n="uid"){let i=new Map,o=new Map,s=new Map,a=new Map;t.forEach((t=>{s.set(t[n],t),i.set(t[n],t)})),e.forEach((t=>{o.set(t[n],t),i.set(t[n],t)}));for(let[r,c]of i)if(o.has(r)&&s.has(r)){const t=s.get(r),e=o.get(r);(e.sound!=t.sound||e.face!=t.face||e.light!=t.light)&&a.set(r,e)}else a.set(r,c);return{nowMap:o,preMap:s,diffMap:a}}static preventQuickClick(t){var e=null;return function(n){e||(n(),e=setTimeout((function(){e=null}),t))}}static createIframe(t){return new Promise(((e,n)=>{let i="diandiankaihei.com"==window.MAIN_DOMAIN?t.url.replace("y.tuwan.com","www.diandiankaihei.com"):t.url,o=(new Date).getTime(),s=-1!=t.url.indexOf("?")?"&":"?",a=`iframe_${o}`,r=`close_${o}`;if(!t.url)return;let c=document.createElement("div");c.style.width=t.iframeWidth,c.style.height=t.iframeHeight,c.id=a;let l=document.createElement("iframe");if(l.style.width=t.iframeWidth,l.style.height=t.iframeHeight,l.style.border="none",l.src=i+s+`eleId=${a}`,t.closeIcon){let e=document.createElement("img");e.src=t.closeIcon,e.id=r,e.style.position="absolute",e.style.top=t.closeTop,e.style.left=t.closeLeft,e.style.cursor="pointer",c.appendChild(e)}c.appendChild(l),window.$(".common_iframe").append(c),window.$(".common_iframe").css("display","flex"),t.closeIcon&&window.$(".common_iframe").on("click",`#${r}`,(()=>{window.$(".common_iframe").off("click",`#${r}`),Ct.destroyIframe(a)})),e(a)}))}static iframeState(t,e){0==e?window.$(`#${t}`).show():window.$(`#${t}`).hide(),window.$(".common_iframe").css("display",0==e?"flex":"none")}static destroyIframe(t){let e=window.$(".common_iframe>div").length;window.$(`#${t}`).attr("src","about:blank"),window.$(`#${t}`).remove(),1==e&&window.$(".common_iframe").css("display","none")}static byteToString(t){if("string"==typeof t)return t;for(var e="",n=t,i=0;i<n.length;i++){var o=n[i].toString(2),s=o.match(/^1+?(?=0)/);if(s&&8==o.length){for(var a=s[0].length,r=n[i].toString(2).slice(7-a),c=1;c<a;c++)r+=n[c+i].toString(2).slice(2);e+=String.fromCharCode(parseInt(r,2)),i+=a-1}else e+=String.fromCharCode(n[i])}return e}static loadScript(t,e=0){return new Promise(((n,i)=>{setTimeout((()=>{if($t.has(t))n();else{if(kt.get(t))return void kt.get(t).push(n);kt.set(t,[n]);const e=()=>{$t.add(t),kt.get(t).forEach((t=>t())),kt.set(t,[])};let o=null;-1!=t.indexOf(".css")?(o=document.createElement("link"),o.type="text/css",o.rel="stylesheet",o.href=t):(o=document.createElement("script"),o.setAttribute("charset","utf-8"),o.setAttribute("type","text/javascript"),o.setAttribute("src",t)),o.onload=e,o.onerror=i,document.head.appendChild(o)}}),e)}))}static throttle(t,e=200){let n=null;return function(){n||(n=setTimeout((()=>{t.apply(this,arguments),n=null}),e))}}static dragComp(t){let e=document.getElementById(t);e.onmousedown=t=>{let n=document.getElementById("move_modal");n.classList.add("move_modal");let i=t.clientX,o=t.clientY,s=e.offsetLeft,a=e.offsetTop;window.onselectstart=()=>!1,n.onmousemove=t=>{let n=t.clientX,r=t.clientY,c=s-(i-n),l=a-(o-r);l=l<=0?0:l,e.style.left=`${c}px`,e.style.top=`${l}px`},document.onmouseup=()=>{n.classList.remove("move_modal"),n.onmousemove=null,document.onmouseup=null,window.onselectstart=null}}}static captureAudioVolume(t,e){let n=null,i=0,o=!1;const s=window.AudioContext||window.webkitAudioContext;let a=new s;return{start:function(r){o=!0,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}}).then((r=>{if(!o)return;n=setInterval((function(){e&&e(i),i=0}),1e3),a=new s;let c=a.createMediaStreamSource(r),l=a.createScriptProcessor(2048,1,1);c.connect(l),l.connect(a.destination),l.onaudioprocess=Ct.throttle((function(e){for(var n=e.inputBuffer.getChannelData(0),o=0,s=0;s<n.length;s++)o<n[s]&&(o=n[s]);const a=Math.round(100*o);i=Math.max(a,i),t&&t(a)}),50)})).catch((()=>{r&&r(2)})):r&&r(1)},stop:function(){o=!1,n&&clearInterval(n),i=0,"closed"!==a.state&&a.close()}}}static webpImgFormat(t){return-1!=t.indexOf("x-oss-process=")?-1!=t.indexOf("x-oss-process=image/resize,m_fill,h_120,w_120")?t.replace("x-oss-process=image/resize,m_fill,h_120,w_120","x-oss-process=image/resize,m_fill,h_120,w_120/format,webp/ignore-error,1"):t.replace("x-oss-process=","")+"&x-oss-process=image/resize,m_fill,h_120,w_120/format,webp/ignore-error,1":t+=(-1!=t.indexOf("?")?"&":"?")+"x-oss-process=image/resize,m_fill,h_120,w_120/format,webp/ignore-error,1"}static webpCoverImgFormat(t){if(-1!=t.indexOf("img6.tuwandata.com")){if(-1!=t.indexOf("x-oss-process="))return-1!=t.indexOf("x-oss-process=image/resize,m_fill,h_120,w_120")?t.replace("x-oss-process=image/resize,m_fill,h_120,w_120","x-oss-process=image/resize,m_fill,h_120,w_120/format,webp/ignore-error,1"):t.replace("x-oss-process=","")+"&x-oss-process=image/format,webp/ignore-error,1";t+=(-1!=t.indexOf("?")?"&":"?")+"x-oss-process=image/format,webp/ignore-error,1"}return t}static getFormatMoney(t,e=0){if(0==e)return t>=1e4?(t/1e4).toFixed(2)+"w":parseInt(t+"");if(t>=1e4)return(t/1e4).toFixed(2)+"w";return 4==((1*t).toFixed(2)+"").indexOf(".")?parseInt(t):(1*t).toFixed(2)}}let It=!1,St=!1;const Tt=Ct.getQueryString("env"),Rt=Ct.getQueryString("client");if(1==Tt){let t=window.location.host;"y-slt-test.tuwan.com"!==t&&"y-test.tuwan.com"!==t&&"y-dev.tuwan.com"!==t||(It=!0)}else 3!=Tt&&"y-pre.tuwan.com"!==window.location.host||(St=!0);const Mt={appid:It?"a73424976c8642f09324dfeafb28bc60":"eabb3d230d1a4f20bed7b17602283a93",IRTCAppid:It?"630880f423bd92018cc674dd":"6308738a2bf0e6018591d5f3",zegoAppid:It?79363342:2075239002,TRTCAppid:It?1600016174:1600023991,maxUID:8e8,emptyPng:"https://res.tuwan.com/templet/play/chat/v2/images/empty.png",defaultHead:"https://uc.tuwan.com/images/noavatar_1.jpg",testHat:"",textColor:"#333",isUpScroll:!1,urlapi:"chatroom",domain:It?"https://y-test.tuwan.com":window.location.origin,xuanyanDefaultText:"点击这里可以填写队长宣言哦~",uidPrefix:"cli_",rose:"https://img3.tuwandata.com/uploads/play/1898151532696070.png",YSD_PID:It?"203321":"203319",YSD_APP_KEY:It?"4059144a3ace4a23a351ca3f96e6693d":"6166c2e4e9404ab8826db07406de1fde"};let At="",Pt="",jt="",Dt="",Lt="",Et="",Bt="",Ft="",Ut="",zt="";It?(At="https://papi-test."+window.MAIN_DOMAIN,Pt="https://yapi-test."+window.MAIN_DOMAIN,jt="https://yapi-report-test."+window.MAIN_DOMAIN,Dt="https://activity-test."+window.MAIN_DOMAIN,Lt="https://api-test."+window.MAIN_DOMAIN,Et="https://u-test."+window.MAIN_DOMAIN,Bt="https://user-test."+window.MAIN_DOMAIN,Ft="https://wk-api-test."+window.MAIN_DOMAIN,Ut="https://center-werewolves2-test."+window.MAIN_DOMAIN,zt="https://activity-api-test."+window.MAIN_DOMAIN):St?(At="https://papi-pre."+window.MAIN_DOMAIN,Pt="https://yapi-pre."+window.MAIN_DOMAIN,jt="https://yapi-report-pre."+window.MAIN_DOMAIN,Dt="https://activity-pre."+window.MAIN_DOMAIN,Lt="https://api-pre."+window.MAIN_DOMAIN,Et="https://u-pre."+window.MAIN_DOMAIN,Bt="https://user."+window.MAIN_DOMAIN,Ft="https://game-api."+window.MAIN_DOMAIN,Ut="https://center-werewolves2."+window.MAIN_DOMAIN,zt="https://activity-api-pre."+window.MAIN_DOMAIN):(At="https://papi."+window.MAIN_DOMAIN,Pt="https://yapi."+window.MAIN_DOMAIN,jt="https://yapi-report."+window.MAIN_DOMAIN,Dt="https://activity."+window.MAIN_DOMAIN,Lt="https://api."+window.MAIN_DOMAIN,Et="https://u."+window.MAIN_DOMAIN,Bt="https://user."+window.MAIN_DOMAIN,Ft="https://game-api."+window.MAIN_DOMAIN,Ut="https://center-werewolves2."+window.MAIN_DOMAIN,zt="https://activity-api."+window.MAIN_DOMAIN);let Ot={getRoomList:function(t){return Pt+"/Chatroom/getList?ver=10&from="+t},getChannelUserNum:function(t){return Pt+"/Chatroom/getChannelUserNum?ver=9&cid="+t},getSearchCid:function(t){return Pt+"/Chatroom/searchCid?cid="+t},getOrderRoomList:function(){return Pt+"/Chatroom/getOrderRoom"},gameSourceRunGame:function(t,e){return Pt+"/gamesource/runGame?fid="+t+"&cid="+e},getKingTeamTab:function(t,e=""){return Pt+"/v1.wartask/gettab?cid="+t+"&gametype="+e},getWebInfo:function(t){return At+"/Agora/webinfo?apiver=5&channel="+t},ChartRoomMatch:function(t){return At+"/Chatroom/match?cid="+t},PeaceTeamMatch:function(t){return At+"/warband/teamup?cid="+t},PeaceTeamGetwheat:function(t){return At+"/warband/getwheat?cid="+t},ChartRoomStartGame:function(t){return At+"/Chatroom/startgame?cid="+t},ChartRoomUnMatch:function(t){return At+"/Chatroom/unmatch?cid="+t},PeaceTeamPrepare:function(t){return At+"/warband/prepare?cid="+t},PeaceTeamLeaveTeam:function(t){return At+"/warband/leaveteam?cid="+t},getUsersInfo:function(t){return At+"/Chatroom/getuserinfo?avatar=1&uids="+t},getUid:function(){return Pt+"/User/getUid"},getUsersInfoFrom:function(t,e){return At+"/Chatroom/getuserinfo?requestfrom="+t+"&uids="+e},getUserScoreInfo:function(t){return Pt+"/v1.Captaingame/getUserScoreInfo?uid="+t},setUserScoreInfo:function({uid:t,score:e,dtid:n,tag:i,remark:o,cid:s="",is_self:a}){return Pt+"/v1.Captaingame/setUserScoreInfo?uid="+t+`&score=${e}&dtid=${n}&tag=${i}&remark=${o}&cid=${s}&is_self=${a}`},getChatroomInfo:function({uid:t,cid:e=""}){return Pt+"/v1.Captaingame/getChatroomInfo?uid="+t+`&cid=${e}`},getYsfUserInfo:function(){return Pt+"/qykefu/userinfo?format=jsonp"},getChatList:function(){return At+"/Chatroom/getListV6?ver=13"},getChatList2:function(t={navid:0,cid:0}){return At+"/Chatroom/getPcListV4?ver=14&format=jsonp&navid="+t.navid+"&cid="+t.cid},getPcInfo:t=>At+"/Chatroom/getPcInfo?cid="+t+"&format=jsonp",uploadImage:function(){return Pt+"/User/uploadImage"},kicking:function(t,e){return Et+"/Agora/kicking?channel="+t+"&uid="+e},kickingForever:function(t,e){return Et+"/Agora/forever?channel="+t+"&uid="+e},getSelfUserInfo:function(){return Lt+"/playteach/?data=getuserinfo&format=jsonp"},payDiamond:function(t){return At+"/Diamond/giftMore?"+t},payBaobox:function(t){return At+"/Treasure/buy?format=jsonp&"+t},giveGift:t=>At+"/Teacher/giveGift?"+t,miaoJie:function(){return Pt+"/Lists/getChatQuickList"},loveTuijian:function(){return Pt+"/Chatroom/giftRec"},biaoBai:function(){return Lt+"/playteach/?data=getconfession&format=jsonp"},songVote:function(t,e){return At+"/diamond/songVote?cid="+t+"&uid="+e},leaveChannel:function(){return Et+"/Agora/leave"},search:function(t){return Lt+"/playteach/?type=play&data=search&format=jsonp&kw="+t},addordelmaixu:function(t,e,n){return Et+"/Agora/putMCDescList?roomid="+t+"&uid="+e+"&type="+n},getmaixu:function(t){return Et+"/Agora/getMCDescList?roomid="+t},getGiftRank:function(){return Pt+"/Chatroom/getGiftRank?typeid=2&stime=1537977600&etime=1538928000"},getMoney:function(){return At+"/Teacher/getMoney"},kaiheiLive:function(t){return Pt+"/Live/stream?cid="+t+"&platform=1"},getProgram:function(t,e){return Pt+"/Chatroom/getProgram?cid="+t+"&uids="+e},getBossRoomList:function(){return Pt+"/Chatroom/getBossRoomList"},runFleet:function(t,e,n){return At+"/Chatroom/runFleet?cid="+t+"&fid="+e+"&port="+n},getFleetUsers:function(t,e,n){return At+"/Chatroom/getFleetUsers?cid="+t+"&typeid="+e+"&ftype="+n},dismissFleet:function(t,e,n=0,i=0){return At+"/Chatroom/dismiss?cid="+t+"&port="+e+"&type="+n+"&welcome_sure="+i},giftCidRank:function(t,e,n,i,o){return Pt+"/Chatroom/giftCidRank?giftid="+t+"&cid="+e+"&day="+n+"&limit="+(i=i||10)+(""!=o?o:"")},giftCidRank2:function(t,e,n,i,o){return Pt+"/Chatroom/giftCidRank?giftid="+t+"&cid="+e+"&day="+n+"&limit="+(i=i||10)+"&type="+o},getGiftLists:(t,e)=>At+"/Teacher/giftLists?format=jsonp&platform=0&cid="+t+"&navid="+e+"&apiver=3",getHaveGift:(t,e)=>At+"/Teacher/haveGift?mode=2&cid="+t+"&navid="+e+"&format=jsonp",getFleetReward:t=>At+"/Chatroom/fleetReward?format=jsonp&cid="+t,getPublishInfo:(t,e)=>At+"/Chatroom/getPublishInfo?patform=0&format=jsonp&cid="+t+"&sports="+(e?1:0),getPublishInfoV3:(t,e)=>At+"/Chatroom/getPublishInfoV3?patform=0&format=jsonp&cid="+t+"&sports="+(e?1:0),getPublishInfoV4:(t,e)=>At+"/Chatroom/getPublishInfoV4?patform=0&format=jsonp&cid="+t+"&sports="+(e?1:0),checkPublish:t=>At+"/Chatroom/checkPublish?patform=0&cid="+t,uploadVoiceLog:(t,e,n,i,o="")=>jt+"/Voicesendlog/addVoicelog?cid="+t+"&uid="+e+"&time="+n+"&timesamp="+i+"&platform=1&value="+o,getTeacherList:t=>Pt+"/Lists/getTeacherList?cid="+t+"&format=jsonp",inviteShareInfo:()=>Pt+"/Activity/inviteShareInfo?format=jsonp",openGoldBox:t=>At+"/Treasurev3/gold?cid="+t+"&platform=0&format=jsonp",goldBoxInfo:()=>At+"/Treasurev3/getGoldProcess?format=jsonp",getGoldMagicInfo:t=>At+"/TreasureV3/getInfo?giftid="+t+"&apiver=1",openGoldGift:(t,e,n=1,i=0)=>At+"/TreasureV3/gold?giftid="+t+"&cid="+e+"&num="+n+"&pay_confirm=1&pay_sure="+i,openMagicGift:(t,e,n=1,i=0)=>At+"/TreasureV3/buy?giftid="+t+"&cid="+e+"&num="+n+"&pay_confirm=1&pay_sure="+i,useBaBa:(t,e)=>Pt+"/Nobility/babapay?cid="+t+"&uid="+e+"&platform=0&format=jsonp",baBaBoxInfo:t=>Pt+"/Nobility/baba?uid="+t+"&platform=0",powerPackInfo:t=>Pt+"/Nobility/pack?uid="+t+"&platform=0",buyPowerPack:t=>Pt+"/Nobility/packpay?uid="+t+"&platform=0",channelNaming:(t,e,n)=>Pt+`/Nobility/naming?uid=${t}&cid=${e}&content=${n}&platform=0`,songAll:t=>Pt+"/song/all?format=jsonp&form=1&cid="+t,songOrder:(t,e,n)=>Pt+"/song/order?from=1&song_id="+t+"&cid="+e+"&singer_uid="+n,searchChatUser:(t,e)=>Pt+"/Search/chatUser?kw="+t+"&cid="+e,bless:t=>Pt+"/chatroom/bless?cid="+t,getBlessProgress:t=>Pt+"/chatroom/getBlessProgress?cid=3710",giveWeddingAward:t=>Pt+"/chatroom/giveWeddingAward?token="+t,getBaseUrl:()=>At+"/Api/getBaseUrl?format=jsonp",getTempChannelTime:t=>Pt+"/Chatroom/getChannelTime?cid="+t+"&format=jsonp",clientInfo:()=>Pt+"/User/clientInfo",getTrueQues:()=>At+"/diamond/getQuestionList",sendTrueQue:(t,e,n)=>At+`/diamond/truewordsSend?ruid=${t}&question=${e}&open=${n}`,ansTrueQue:(t,e,n)=>At+`/diamond/trueWordsWriteBack?suid=${t}&answer=${e}&giftuserid=${n}`,getWelcomeFleetPayInfo:t=>At+`/chatroom/getWelcomeFleetPayInfo?format=jsonp&mode=${t}`,deduct:(t,e,n)=>Pt+"/Captain/deductV2?format=jsonp&uid="+e+"&cid="+t+"&typeid="+n,userZpack:t=>Pt+"/usernew/getuserZPack?format=jsonp&id="+t,takeUserZpack:t=>Pt+"/usernew/useropenZPack?format=jsonp&id="+t,checkIsNewUser:t=>Pt+"/api/getRoomTipsV2?format=jsonp&platform=0&cid="+t,payNewUserGift:t=>Pt+"/usernew/receivePack?format=jsonp&id="+t,newUserGiftDoit:t=>Pt+"/usernew/reportPack?format=jsonp&id="+t,takeGradeReward:t=>Pt+"/usernew/receiveGradeReward?format=jsonp&playvip="+t,checkGrade:t=>Pt+"/usernew/checkUserGrade?format=jsonp&playvip="+t,getReportTag:()=>Pt+"/Compliant/getTags",reportMsg:(t,e,n,i,o)=>Pt+`/Compliant/report?content=${t}&tagid=${e}&typeid=${n}&vid=${o}&images=${i}`,getRoomUsers:t=>Pt+"/Chatroom/getRoomUsers?cid="+t+"&format=jsonp",auctionStart:t=>Pt+"/Auction/start?cid="+t+"&format=jsonp",auctionEnd:t=>Pt+"/Auction/end?cid="+t+"&format=jsonp",checkTrainer:t=>Pt+"/Captain/checkTrainer?cid="+t+"&format=jsonp",auctionUpdate:(t,e,n)=>Pt+"/Auction/update?id="+t+"&cid="+e+"&content="+n+"&format=jsonp",getPackageNum:t=>At+"/Teacher/getPackageNum?format=jsonp&cid="+t,liveRoomInfo:t=>"https://tv.tuwan.com/api/roominfo?roomid="+t,getChatroomActivityList:t=>At+"/chatroom/getChatroomActivityList&cid="+t,getGameState:t=>Pt+"/video/getGameState?cid="+t+"&format=jsonp",getLiveState:t=>Pt+"/live/getLiveState?cid="+t+"&format=jsonp",updateLive:(t,e)=>Pt+"/live/updateLive?cid="+t+"&status="+e+"&format=jsonp",getGameList:t=>Pt+"/video/getGameList?cid="+t+"&format=jsonp",getMyGuesslist:()=>Pt+"/video/myGuesslist?format=jsonp",getTvRoomInfo:t=>Pt+"/live/tvRoomInfo?format=jsonp&cid="+t,getTeamInfo:t=>Pt+"/video/getTeamInfo?id="+t+"&format=jsonp",onEditgame:(t,e,n="")=>Pt+"/video/editgame?id="+t+"&format=jsonp&state="+e+"&result="+n,getGuessList:(t,e)=>Pt+"/video/getGuessList?id="+t+"&game_id="+e+"&format=jsonp",getResultList:(t,e)=>Pt+"/video/getResultList?id="+t+"&game_id="+e+"&format=jsonp",getRecommend:()=>Pt+"/search/recommend",getSearchkw(t){const e=encodeURIComponent(t.trim());return Pt+"/search/search?kw="+e},getCpImg:t=>Pt+`/Auction/getCpImg?format=jsonp&id=${t.id}&boss_uid=${t.boss_uid}&host_uid=${t.host_uid}&boss_name=${encodeURIComponent(t.boss_name)}&host_name=${encodeURIComponent(t.host_name)}&content=${encodeURIComponent(t.content)}&msg=${encodeURIComponent(t.msg)}&date=${encodeURIComponent(t.dates)}`,getGuardGifts:()=>Pt+"/Chatroom/getGuardGifts",getGuardRank:(t,e,n)=>Pt+"/Chatroom/getGuardRank?hostuid="+t+"&cid="+e+"&page="+n+"&format=jsonp",getGuardNum:(t,e)=>Pt+"/Chatroom/getGuardNum?format=jsonp&hostuid="+t+"&cid="+e,regUserinfo:()=>Bt+"/api/method/userinfo",runGameLive:(t,e,n,i,o)=>At+"/Chatroom/runGameLive?format=jsonp&cid="+t+"&areaid="+e+"&tagid="+n+"&bgid="+i+"&desc="+o,getCaptainGear:t=>Pt+"/usernew/getCaptainGear?format=jsonp&uid="+t,getDeductType:(t,e)=>Pt+"/Captain/getDeductType?uid="+t+"&cid="+e,getImg:t=>Pt+`/activity2021/getImg?type=${t}`,onStarDrawGame:(t,e)=>At+"/drawsomething/startGame?format=jsonp&type="+e+"&cid="+t,onSetDrawGameOut:(t,e,n,i)=>At+"/drawsomething/setOutGame?format=jsonp&cid="+t+"&uid="+e+"&type="+n+"&tryAgain="+i,onWordSelection:(t,e)=>At+"/drawsomething/wordSelection?format=jsonp&cid="+t+"&wordIndex="+e,onRefresnWords:(t,e,n)=>At+"/drawsomething/refresnWords?format=jsonp&cid="+t+"&wordIndex="+e+"&uid="+n,onDrawLike:(t,e)=>At+"/Drawsomething/like?format=jsonp&cid="+t+"&likeUid="+e,getLikeStatus:(t,e)=>At+"/Drawsomething/likeStatus?format=jsonp&cid="+t+"&likeUid="+e,endGameClient:t=>At+"/Drawsomething/endGameClient?format=jsonp&cid="+t,checkTipsQueue:(t,e)=>Pt+"/api/checkTipsQueue?format=jsonp&id="+t+"&typeid="+e,addTipsQueue:(t,e)=>Pt+"/api/addTipsQueue?format=jsonp&id="+t+"&typeid="+e,backFleet:t=>At+"/Chatroom/backFleet?format=jsonp&cid="+t,imClick:t=>Pt+"/Check/imClick?format=jsonp&uid="+t,imAccept:t=>Pt+"/Check/imAccept?format=jsonp&uid="+t,getInviteUserList:(t,e,n=3)=>Pt+"/userinvite/getUserList?format=jsonp&fid="+t+"&cid="+e+"&position="+n,sendInvite:(t,e,n,i=3)=>Pt+"/userinvite/sendInvite?format=jsonp&fid="+t+"&cid="+e+"&position="+i+"&uid="+n,isVipFleet:t=>Pt+"/userinvite/isVipFleet?format=jsonp&cid="+t,getQuickFidV2:t=>Pt+"/gamesource/getQuickFidV2?format=jsonp&cid="+t,getPublishBombCatInfo:t=>At+"/Chatroom/getPublishBombCatInfo?format=jsonp&cid="+t,getSongList:t=>At+"/Agora/getSongListYjx?format=jsonp&page="+t,getSongListYinSuDa:t=>Pt+"/yinsuda/getSongList?format=jsonp&page="+t,getSongInfo:(t,e,n)=>At+"/Agora/getSongInfoYjx?format=jsonp&song_code="+t+"&token="+e+"&lyric_type="+n,setSongPlay:t=>At+"/Agora/setSongPlayYjx?format=jsonp&cid="+t,setSongPlayYinSuDa:(t,e)=>At+"/Agora/setSongPlay?format=jsonp&cid="+t+"&song_code="+e,getSongTypeList:t=>zt+"/chorus/songTypeList?format=jsonp&cid="+t,getSongListWithType:(t,e,n,i=1,o=20)=>zt+"/chorus/songList?format=jsonp&cid="+t+"&type="+e+"&sub_type="+n+"&page="+i+"&limit="+o,getSearchSongChorus:(t,e="")=>At+"/Agora/searchSongChorus?format=jsonp&cid="+t+"&kw="+e,getSearchZegoSongChorus:(t,e="")=>zt+"/chorus/searchSong?format=jsonp&cid="+t+"&kw="+e,getSongFleetInfoNew:t=>Pt+"/chatroom/getSongFleetInfo?format=jsonp&cid="+t,getSongFleetInfo:()=>Pt+"/Chatroom/getSongFleetInfo?format=jsonp",setSongFleetInfo:()=>Pt+"/Chatroom/setSongFleetInfo",checkSongRoom:(t,e)=>At+"/Chatroom/checkSongRoom?format=jsonp&cid="+t+"&tcid="+e,onSearchSong:t=>At+"/Agora/searchSongYjx?format=jsonp&kw="+t,onSearchSongYinSuDa:t=>Pt+"/yinsuda/searchSong?format=jsonp&kw="+t,checkClockIn:t=>At+"/Chatroom/checkClockIn?format=jsonp&cid="+t,uploadSongRecord:(t,e)=>Pt+"/Chatroom/uploadSongRecord?format=jsonp&cid="+t+"&file="+e,onClockIn:t=>At+"/Chatroom/clockIn?format=jsonp&cid="+t,runFleetAgain:t=>At+"/Chatroom/runFleetAgain?format=jsonp&cid="+t,setAuth:(t,e)=>At+"/Card/set?format=jsonp&name="+t+"&idcard="+e,setTruthPrepare:t=>At+"/truth/prepare?format=jsonp&cid="+t,setTruthCancelPrepare:t=>At+"/truth/cancelPrepare?format=jsonp&cid="+t,setTruthSelectGame:(t,e)=>At+"/truth/selectGame?format=jsonp&cid="+t+"&game_id="+e,setTruthStartGame:t=>At+"/truth/startGame?format=jsonp&cid="+t,setTruthGiveRedPackage:t=>At+"/truth/giveRedPacket?format=jsonp&cid="+t,setTruthFailUser:(t,e)=>At+"/truth/setFailUser?format=jsonp&cid="+t+"&uid="+e,setTruthGameEnd:t=>At+"/truth/gameEnd?format=jsonp&cid="+t,setTruthShowNumber:t=>At+"/truth/showNumber?format=jsonp&cid="+t,setTruthCountdown:t=>At+"/truth/countdown?format=jsonp&cid="+t,setTruthPunishStatus:(t,e)=>At+"/truth/setPunishStatus?format=jsonp&cid="+t+"&status="+e,getSoloRank:t=>Pt+"/chatroom/soloRank?format=jsonp&cid="+t,getUserGameAllList:()=>Pt+"/usernew/getUserGameAllList?format=jsonp",sendUserGame:(t,e,n)=>Pt+"/usernew/sendUserGame?format=jsonp&token="+t+"&id="+e+"&cid="+n,werewolfInvite:(t,e)=>At+"/Game/werewolfInvite?format=jsonp&cid="+t+"&uid="+e,groupOperating:(t,e,n)=>At+"/Game/groupOperating?format=jsonp&cid="+t+"&invite_uid="+e+"&invite_type="+n,getGameTypeList:()=>At+"/Game/getGameTypeList?format=jsonp",meteRoomByTeam:(t="",e="",n,i)=>At+"/Game/meteRoomByTeam?format=jsonp&room_type="+t+"&room_id="+e+"&cap_uid="+n+"&uid="+i,getKillList:t=>Pt+"/Chatroom/getKillList?format=jsonp&cid="+t+"&token=2eb4c612c465eb7eefa8523db1c8dbf6",getUcList:t=>Pt+"/Chatroom/getucList?format=jsonp&cid="+t+"&token=2eb4c612c465eb7eefa8523db1c8dbf6",getGameStatus:t=>At+"/Game/getGameStatus?format=jsonp&cid="+t,getSongPkButton:t=>At+"/songpk/button?format=jsonp&cid="+t,getSongPkKingButton:t=>At+"/songking/button?format=jsonp&cid="+t,getCreateSelfWolfRoomInfo:()=>Ft+"/buildRoom/getInfoV2",postCreateSelfWolfRoom:()=>Ft+"/buildRoom/buildV2",getCreateSpyRoomInfo:(t="")=>Pt+"/gamesource/getInfo?cid="+t,getCreateSpyRoomInfoV2:(t="")=>Pt+"/gamesource/getInfoV2?cid="+t,postCreateSpyRoom:(t="")=>Pt+"/gamesource/build?cid="+t,getReportKillInvite:(t,e)=>Pt+"/userinvite/reportKillInvite?format=jsonp&fid="+t+"&type="+e,getWolfSignInData:()=>Ut+"/sign_in/gift_list",getWolfSignInGiftGive:()=>Ut+"/sign_in/gift_give",getSendWheatInvite:(t,e)=>Pt+"/userinvite/sendWheatInvite?format=jsonp&cid="+t+"&uid="+e,getSquidJoinGame:t=>At+"/nationalgame/join?format=jsonp&cid="+t,getSquidCancelJoinGame:t=>At+"/nationalgame/canceljoin?format=jsonp&cid="+t,getSquidAnswer:(t,e,n,i)=>At+"/nationalgame/commitAnswer?format=jsonp&cid="+t+"&base_id="+e+"&number="+n+"&answer="+i,getSquidGuess:(t,e,n,i)=>At+"/nationalgame/guess?format=jsonp&cid="+t+"&base_id="+e+"&number="+n+"&guess_type="+i,getSquidReward:(t,e,n,i)=>At+"/nationalgame/getAward?format=jsonp&cid="+t+"&base_id="+e+"&game_id="+n+"&is_final="+i,getSquidSupportTeam:(t,e)=>At+"/diamond/supportTeam?format=jsonp&cid="+t+"&team_id="+e,getSquidButton:t=>At+"/nationalgame/button?format=jsonp&cid="+t,getSquidReportVolume:(t,e,n,i)=>At+"/nationalgame/reportVolume?format=jsonp&cid="+t+"&base_id="+e+"&team_id="+n+"&volume="+i,getCommitElementPosition:(t,e,n)=>At+"/nationalgame/commitElementPosition?format=jsonp&cid="+t+"&position_x="+e+"&position_y="+n,getPublishUcInfo:t=>At+"/Chatroom/getPublishUcInfo?format=jsonp&cid="+t,getShoutResult:t=>Pt+"/bridge/getShoutResult?format=jsonp&cid="+t,getBridgeReportVolume:(t,e)=>`${zt}/activity/bridgeReportVolume?format=jsonp&cid=${t}&volume=${e}`,getQueqiaoMaidian:(t,e,n="")=>`${zt}/activity/bridgeDotReport?format=jsonp&cid=${t}&is_h5=2&type=${e}&content=${n}`,getBridgeRank:(t,e=100)=>Pt+"/bridge/bridgeRank?format=jsonp&cid="+t+"&limit="+e,getUserAwardData:t=>Pt+"/bridge/userAwardData?format=jsonp&cid="+t,canJoinroom:(t,e,n,i,o=0)=>Ft+`/chat/canJoinroom?cid=${t}&gameTypeId=${e}&roomId=${n}&userId=${i}&joinType=${o}`,getBackPack:()=>Pt+"/Usernew/getBackPack?format=jsonp",giveBackPack:()=>Pt+"/Usernew/giveBackPack?format=jsonp",getDayPack:()=>Pt+"/Usernew/getDayPack?format=jsonp",giveDayPack:()=>Pt+"/Usernew/giveDayPack?format=jsonp",getReportVolume:(t,e)=>Pt+"/Report/voiceCheck?format=jsonp&cid="+t+"&typeid="+e,getReportVolumeLog:(t,e)=>Pt+"/Report/voiceLog?format=jsonp&cid="+t+"&volume="+e,getReportMineVolume:(t,e,n)=>"https://vol-report.tuwan.com/vol-report.gif?format=jsonp&cid="+t+"&uid="+e+"&volume="+n,getReportVolumeV2:(t,e,n)=>"https://vol-report.tuwan.com/vol-report-v2.gif?format=jsonp&cid="+t+"&uid="+e+"&volume="+n,buyFrozen:()=>Pt+"/Usernew/buyFrozen?format=jsonp",getGameFleetList:t=>At+"/Game/getFleetList?format=jsonp&cid="+t,getGameUserList:t=>Pt+"/gamesource/getUcInfo?format=jsonp&fid="+t,getGameRaceBaseData:t=>Dt+"/speed/baseData?format=jsonp&cid="+t,getGameRaceRankList:(t,e=100)=>Dt+"/speed/getRankList?format=jsonp&cid="+t+"&limit="+e,getGameRaceGiveGift:(t,e,n)=>Dt+"/speed/initiateTeam?format=jsonp&cid="+t+"&cp_uid="+e+"&type="+n,getGameRaceRecommendList:t=>Dt+"/speed/recommendList?format=jsonp&cid="+t,getGameRaceSearch:(t,e)=>Dt+"/speed/searchUser?format=jsonp&cid="+t+"&kw="+e,getGameRaceGetAward:t=>Dt+"/speed/getAward?format=jsonp&cid="+t,getGameRaceReportVolume:(t,e)=>Dt+"/speed/reportVolume?format=jsonp&cid="+t+"&volume="+e,getGameRaceUserList:t=>Dt+"/speed/teamUserList?format=jsonp&cid="+t,getGameRaceReportWord:(t,e)=>Dt+"/speed/reportWord?format=jsonp&cid="+t+"&word="+e,getGameRaceTeamOperate:(t,e)=>Dt+"/speed/teamOperate?format=jsonp&id="+t+"&operate="+e,getFaceAfterSend:(t,e,n)=>Pt+"/playface/afterSend?format=jsonp&img_id="+t+"&cid="+e+"&type_id="+n,getChorusBaseData:t=>zt+"/chorus/baseData?format=jsonp&cid="+t,getChorusPickSong:(t,e)=>zt+"/chorus/orderSong?format=jsonp&cid="+t+"&song_code="+e,getChorusChangeSong:(t,e)=>zt+"/chorus/changeSong?format=jsonp&cid="+t+"&song_code="+e,getChorusDownload:(t,e)=>zt+"/chorus/reportDownload?format=jsonp&cid="+t+"&song_code="+e,getChorusChoirList:(t,e)=>zt+"/chorus/choirList?format=jsonp&cid="+t+"&song_code="+e,getChorusPlaySongList:t=>zt+"/chorus/playSongList?format=jsonp&cid="+t,getChorusSongRank:(t,e)=>zt+"/chorus/songRank?format=jsonp&cid="+t+"&song_code="+e,getChorusEndRank:t=>zt+"/chorus/endRank?format=jsonp&cid="+t,getChorusReportVolume:(t,e,n)=>zt+"/chorus/reportVolume?format=jsonp&cid="+t+"&song_code="+n+"&volume="+e,getChorusJoin:(t,e)=>zt+"/chorus/join?format=jsonp&cid="+t+"&song_code="+e,getChorusQuit:(t,e)=>zt+"/chorus/quit?format=jsonp&cid="+t+"&song_code="+e,getChorusReportHandClap:(t,e)=>zt+"/chorus/reportHandClap?format=jsonp&cid="+t+"&song_code="+e,getChorusMusicProgress:(t,e)=>zt+"/chorus/songProgress?format=jsonp&cid="+t+"&song_code="+e,getChorusTotalRank:t=>zt+"/chorus/totalRank?format=jsonp&cid="+t,getChorusReportScore:(t,e,n,i)=>zt+"/chorus/reportScore?format=jsonp&cid="+t+"&song_code="+e+"&sentence_id="+n+"&score="+i,joinMeeting:(t,e)=>Pt+"/Meeting/joinMeeting?format=jsonp&group_id="+e+"&id="+t,getBgmCategroy:()=>Pt+"/bgm/getSongTypeList?format=jsonp",getBgmListWithCategroyType:(t,e="",n=20,i=0)=>Pt+"/bgm/getSongListByType?format=jsonp&type="+t+"&id="+e+"&refresh="+i+"&limit="+n,getBgmMineGroup:()=>Pt+"/bgm/getPlaylist?format=jsonp",getBgmListWithGroupId:(t,e="")=>Pt+"/bgm/getPlaylistDetail?format=jsonp&playlistId="+t+"&id="+e+"&limit=200",getBgmGroups:(t="",e)=>Pt+"/bgm/getPlaylist?format=jsonp&songCode="+t+"&cid="+e,getBgmAddSongToGroup:(t,e="")=>Pt+"/bgm/addSongToPlaylist?format=jsonp&songCode="+e+"&playlistId="+t,getBgmAddGroup:t=>Pt+"/bgm/createPlaylist?format=jsonp&name="+t,getBgmRenameGroup:(t,e)=>Pt+"/bgm/renamePlaylist?format=jsonp&name="+t+"&playlistId="+e,getBgmDeleteGroup:t=>Pt+"/bgm/delPlaylist?format=jsonp&id="+t,getBgmDeleteSongToGroup:(t,e="")=>Pt+"/bgm/delSongInPlaylist?format=jsonp&songCode="+e+"&playlistId="+t,getBgmSetWorkBgm:(t,e="")=>Pt+"/bgm/setWorkBgm?format=jsonp&songCode="+e+"&playlistId="+t,getBgmGetWorkBgm:()=>Pt+"/bgm/getWorkBgm?format=jsonp",getBgmSearchBgm:t=>Pt+"/bgm/search?format=jsonp&keyword="+t,getBgmTags:()=>Pt+"/bgm/getSongTags?format=jsonp",setBgmTags:t=>Pt+"/bgm/setSongTagsUser?format=jsonp&tagIds="+t.join(","),getBgmRecommendAndCustomTabs:()=>Pt+"/bgm/getRecommendAndCustomTabs?format=jsonp",getBgmRecommendAndCustomTabSongs:(t,e)=>Pt+"/bgm/getRecommendAndCustomTabSongs?format=jsonp&cid="+t+"&tabId="+e,getAllFaces:t=>Pt+"/chatroom/getAllWheatEmojiList?format=jsonp&cid="+t,sendAllFaces:(t,e)=>Pt+"/chatroom/doAllWheatEmoji?format=jsonp&emojiId="+t+"&cid="+e,getCanSearchCidList:()=>Pt+"/activity.chatroom/getSearchList?format=jsonp",getCheckHomepage:t=>Pt+"/User/checkHomepage?format=jsonp&uid="+t,getKtvSongTypeList:t=>At+"/ktv/songTypeList?format=jsonp&cid="+t,getKtvSongListWithType:(t,e,n,i=1,o=20)=>At+"/ktv/songList?format=jsonp&cid="+t+"&type="+e+"&sub_type="+n+"&page="+i+"&limit="+o,getKtvOrderList:t=>At+"/ktv/orderList?format=jsonp&cid="+t,getKtvSearchSongChorus:(t,e="")=>At+"/agora/searchSongYjx?format=jsonp&cid="+t+"&kw="+e,getKtvPickSong:(t,e)=>At+"/ktv/order?format=jsonp&cid="+t+"&song_code="+e,getKtvDeleteSong:(t,e)=>At+"/ktv/del?format=jsonp&cid="+t+"&order_id="+e,getKtvChangeSong:(t,e)=>At+"/ktv/change?format=jsonp&cid="+t+"&order_id="+e,getKtvBaseData:t=>At+"/ktv/baseData?format=jsonp&cid="+t,getKtvReportProgress:(t,e,n)=>zt+"/ktv/reportProgress?format=jsonp&cid="+t+"&order_id="+e+"&progress="+n,getKtvPlayEnd:(t,e)=>At+"/ktv/end?format=jsonp&cid="+t+"&order_id="+e,getKtvDownload:(t,e)=>At+"/ktv/download?format=jsonp&cid="+t+"&song_code="+e,getKtvSetOriginalSwitch:(t,e)=>At+"/ktv/setOriginalSwitch?format=jsonp&cid="+t+"&switch="+e,getKtvSetScoreSwitch:(t,e)=>At+"/ktv/setScoreSwitch?format=jsonp&cid="+t+"&switch="+e,getKtvYesterdaySongRank:t=>At+"/ktv/yesterdaySongRank?format=jsonp&cid="+t,getKtvTodaySongRank:t=>At+"/ktv/todaySongRank?format=jsonp&cid="+t,getKtvGodSongRank:t=>At+"/ktv/totalSongRank?format=jsonp&cid="+t,getKtvMineSongRank:t=>At+"/ktv/mySongRank?format=jsonp&cid="+t,getKtvSingSongRank:(t,e)=>At+"/ktv/singleSongRank?format=jsonp&cid="+t+"&song_code="+e,getKtvReportWheat:(t,e)=>zt+"/ktv/reportWheat?format=jsonp&cid="+t+"&switch="+e,getKtvReportVolume:(t,e)=>zt+"/ktv/reportVolume?format=jsonp&cid="+t+"&volume="+e,getKtvSoundConsole:t=>At+"/ktv/soundConsole?format=jsonp&cid="+t,getKtvReportScore:(t,e,n,i)=>zt+"/ktv/reportScore?format=jsonp&cid="+t+"&order_id="+e+"&sentence_id="+n+"&score="+i,getRechargeUrl:()=>Pt+"/activityapi/recharge",getBuyEmoji:t=>Pt+"/playface/buyEmoji?format=jsonp&emojiId="+t,getBuyAllSetEmoji:t=>Pt+"/playface/buyAllSetEmoji?format=jsonp&typeid="+t,getShopCoinsList:()=>Pt+"/shop/coinsList?format=jsonp",getShopBuyCoins:(t,e)=>Pt+"/shop/buyCoins?format=jsonp&money="+t+"&price="+e,getSearchUser:(t,e)=>Pt+"/Chatroom/searchUser?format=jsonp&cid="+t+"&kw="+e,handleReconnect:t=>Pt+"/gamesource/reconnect?format=jsonp&cid="+t,getTreasureRecord:(t,e,n=10)=>At+"/TreasureV3/getRecord?format=jsonp&giftid="+t+"&page="+e+"&step="+n,getTreasureInfo:t=>At+"/TreasureV3/getInfo?format=jsonp&giftid="+t+"&apiver=1",getAllBalance:(t,e)=>Pt+"/trumpet/getAllBalance?format=jsonp&Tuwan_Passport="+t+"&cid="+e,getPayType:(t,e)=>Pt+"/trumpet/getPayType?format=jsonp&Tuwan_Passport="+t+"&trumpetType="+e,buyTrumpetAndPostMessage:(t="",e="",n="",i="")=>Pt+"/trumpet/buyTrumpetAndPostMessage?format=jsonp&trumpetType="+t+"&payType="+e+"&content="+encodeURIComponent(n)+"&cid="+i,yinsudaGetUserToken:()=>Pt+"/yinsuda/getUserToken?format=jsonp",goldenStart:t=>At+`/golden/teamup?format=jsonp&cid=${t}`,goldenLeave:t=>At+`/golden/leaveteam?format=jsonp&cid=${t}`,goldenPrepare:t=>At+`/golden/prepare?format=jsonp&cid=${t}`,goldenGetWheat:t=>At+`/golden/getwheat?format=jsonp&cid=${t}`};class Nt{constructor(t){this.instance=null,this.$=window.jQuery,this.session=t}static getInstance(t){return this.instance||(this.instance=new Nt(t)),this.instance}get(t,e="jsonp"){return new Promise(((n,i)=>{const o={url:t,type:"get",dataType:e,success:t=>{n(t)},timeout:3e4,error:(t,e,i)=>{n({error:-99})}};"json"===e&&(o.xhrFields={withCredentials:!0}),this.$.ajax(o)}))}post(t,e,n){return new Promise(((i,o)=>{const s={url:-1!=t.indexOf("?")?t+"&format=json":t+"?format=json",type:"POST",data:e,dataType:"json",xhrFields:{withCredentials:!0},success:function(t){i(t)}};n&&(s.contentType=n),this.$.ajax(s)}))}getBinary(t){return new Promise(((e,n)=>{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(t){var n=i.response,o=new Uint8Array(n);e(o)},i.onerror=function(t){e({error:-99})},i.send()}))}getUserInfo(t,e="self",n){return new Promise(((i,o)=>{let s=this.session.getUserInfo(t);s&&s.age&&!n?i(s):t>8e8?i(this.getYoukeInfo(t)):this.get(Ot.getUsersInfoFrom(e,t)).then((t=>{if(0==t.error){const e=t.data;if(e.length>0){if(s=e[0],n){const e=t.mobile;s.mobile=e,this.session.setSelfUser(s)}this.session.addUserInfo(s),i(s)}}}))}))}getUsersInfo(t,e=""){return new Promise(((n,i)=>{this.get(Ot.getUsersInfoFrom(e,t)).then((t=>{if(0==t.error){const e=t.data;e.length>0&&this.session.addUsersInfo(e),n(e)}}))}))}getYoukeInfo(t){return{uid:t,nickname:"游客"+t,avatar:"https://uc.tuwan.com/images/noavatar_1.jpg",medal:"",hat:"",teacher:0,vip:0,score:5,viplevel:0,vipuid:0,vipicon:"",ordernum:0,car:{},sex:1,age:20,services:[],tag:"",color:"#666",pendant:"",guard:[]}}}const qt=Nt.getInstance(bt);let Gt=null;function Vt(t){if(t&&t.length){window.clearTimeout(Gt);var e=window.$("#chat-tips");e.html(t),e.show(),e.animate({opacity:1},300,(function(){Gt=setTimeout((function(){e.animate({opacity:0},300,(function(){e.hide()}))}),3e3)}))}}class Ht{on(t,e){return this._eventCollection=this._eventCollection||{},this._eventCollection[t]=this._eventCollection[t]||[],this._eventCollection[t].push(e),this}once(t,e){const n=this;function i(){n.off(t,i),e.apply(this,arguments)}return i.listener=e,this.on(t,i),this}off(t,e){let n;return this._eventCollection&&(n=this._eventCollection[t])?(n.forEach(((t,i)=>{t!==e&&t.listener!==e||n.splice(i,1)})),0===n.length&&delete this._eventCollection[t],this):this}emit(t,...e){let n;return this._eventCollection&&(n=this._eventCollection[t])?(n=n.slice(0),n.forEach((t=>t.apply(this,e))),this):this}removeAllListener(t){if(!this._eventCollection)return this;this._eventCollection[t]=[]}}class Wt{constructor(){this.queuePlayMax=10,this.waitQueue=[],this.playingQueue=[]}static getInstance(){return this.instance||(this.instance=new Wt),this.instance}onReset(){this.waitQueue=[],this.playingQueue=[]}inQueue(t){this.waitQueue.push(t),this.shiftQueue()}dequeue(t){const e=this.playingQueue.findIndex((e=>e==t));e>=0&&this.playingQueue.splice(e,1),this.shiftQueue()}shiftQueue(){for(let t=0;t<this.queuePlayMax-this.playingQueue.length;t++){const t=this.waitQueue.shift();if(!t)break;this.playingQueue.push(t),t.handle()}}}class Kt{constructor(t=(()=>{})){this.handle=t}}class Yt{constructor(){this.emitter=new Ht}static isSvgaGift(t){return!t}static play(t,e,n,i,o,s,a,r,c,l,d,m){this.isSvgaGift(i)?this.playSvgaAni(t,e,n,1e3,null,null,a,r,c,l,d,m):0==o?this.playVideoGift(t,i,e,n,s):1==o&&this.playAlphaVdieo(t,i,e,n,s)}static playAlphaVdieo(t,e,n,i,o){const s=Ct.UUIDNOCA(),a=this,r=this.getTeacherEle(n),c=window.$(`<canvas class="video_canvas" id="videoAlphaGift_${s}"></canvas>`);window.$(".video_gift").append(c),t&&this.playSvgaAni(t,n,i,1002,c,o),Zt.getInstance().playAlphaVideo({canvas:document.getElementById(`videoAlphaGift_${s}`),url:e,loop:!1},o).then((()=>{1==o&&a.emitter.emit("volumeFade",1),this.flyToTeacher(c,r)}),(()=>{console.log("播放失败")}))}static playVideoGift(t,e,n,i,o){const s=Ct.UUIDNOCA();this.getTeacherEle(n);const a=window.$(`<video class="videoGift" id="videoGift_${s}"></video>`);window.$("body").append(a);const r=document.getElementById(`videoGift_${s}`);this.playSvgaAni(t,n,i,1002,a,o),Zt.getInstance().playBigVideo(r,e,o)}static playSvgaAniToTeacherEle(t,e,n,i,o,s,a,r=0,c=0,l,d,m,h){const u=Ct.UUIDNOCA(),p=this,g=window.$(`<div id="svga${u}" style="z-index:999999" class="canvassvga-fullscreen" data-giftname="${i}" data-iskeng="${n.length>0?"yes":"no"}"></div>`);window.$("body").append(g),Zt.getInstance().loadParser("#svga"+u,t,1,!1).then((t=>{const{videoItem:e,player:i}=t;this.playVideoItem(e,i,g,n,s,a,l,d,m,h)}),(t=>{h&&Wt.getInstance().dequeue(h),r&&c&&p.emitter.emit("onloadfail",{giftid:r,uid:c,teacherid:e},t)}))}static playSvgaAni(t,e,n,i,o,s,a=0,r=0,c,l,d,m){let h=[];if(Array.isArray(e))for(const u of e){const t=this.getTeacherEle(u);t.length>0&&h.push(t)}else h=this.getTeacherEle(e);this.playSvgaAniToTeacherEle(t,e,h,n,i,o,s,0,0,c,l,d,m)}static playVideoItem(t,e,n,i,o,s,a=!0,r=0,c,l){let d=this;e.setVideoItem(t),e.startAnimation(),e.onFinished((function(){a?d.flyToTeacher(n,i,e):n.snabbt({fromOpacity:1,opacity:0,complete:()=>{n.remove()}}),o&&(1==s&&d.emitter.emit("volumeFade",1),d.flyToTeacher(o,i)),l&&Wt.getInstance().dequeue(l)})),r>0&&e.onFrame((t=>{c&&r<=t&&!c.isExced&&(c.isExced=!0,c&&c())}))}static flyToTeacher(t,e,n){if(0==e.length)t.snabbt({fromOpacity:1,opacity:0,complete:()=>{t.remove()}});else{Array.isArray(e)||(e=[e]);const i=t.find("canvas")[0],o=e.map(((e,n)=>{let o;if(0==n)o=t;else{o=t.clone();o.find("canvas")[0].getContext("2d").drawImage(i,0,0),window.$("body").append(o)}return o}));for(let t=0;t<e.length;t++){const i=e[t],s=i.width(),a=i.height(),r=i.offset().left+s/2,c=i.offset().top+a/2,l=r-window.$(window).width()/2,d=c-window.$(window).height()/2;o[t].snabbt({position:[l,d,0],scale:[.1,.1],complete:()=>{}}).snabbt({scale:[0,0],delay:1200,complete:()=>{o[t].remove(),n&&n.clear()}})}}}static getTeacherEle(t){if(null==t||0==t)return[];return window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+t+"']")}}let Jt=new Yt;class Qt{constructor(){this.videoObj={},this.resHandle={},this.playing={},this.glObj={},this.instance=null}static getInstance(){return this.instance||(this.instance=new Qt),this.instance}initVideo(t){return new Promise(((e,n)=>{const{canvas:i,url:o,loop:s}=t,a=`alpha_${Ct.UUIDNOCA()}`;this.initWebgl(i,a);const r=document.createElement("video");r.autoplay=!1,r.volume=1,r.src=o,r.loop=s,r.id=a,r.muted=!0,r.setAttribute("x-webkit-airplay","true"),r.setAttribute("webkit-playsinline","true"),r.setAttribute("playsinline","true"),r.style.display="none",r.crossOrigin="anonymous",this.videoObj[a]=r,r.addEventListener("canplay",this.videoCanPlay(a)),r.addEventListener("play",this.videoPlay(a)),r.addEventListener("ended",(()=>{const t=this.videoObj[a];t.removeEventListener("canplay",this.videoCanPlay(a)),t.removeEventListener("play",this.videoPlay(a)),t.remove(),delete this.videoObj[a],delete this.playing[a],delete this.glObj[a],cancelAnimationFrame(this.resHandle[a]),e()})),r.addEventListener("error",(t=>{n(t.type+" resource 404 or file read error")})),document.body.appendChild(r),r.play()}))}videoCanPlay(t){this.playing[t]=!0}videoPlay(t){this.resHandle[t]=window.requestAnimationFrame((()=>{this.drawFrame(t)}))}drawFrame(t){this.playing[t]&&this.drawWebglFrame(t),this.resHandle[t]=window.requestAnimationFrame((()=>{this.drawFrame(t)}))}drawWebglFrame(t){const e=this.glObj[t];e.texImage2D(e.TEXTURE_2D,0,e.RGB,e.RGB,e.UNSIGNED_BYTE,this.videoObj[t]),e.drawArrays(e.TRIANGLE_STRIP,0,4)}initWebgl(t,e){this.canvas=t,this.canvas.width=1920,this.canvas.height=938;const n=this.canvas.getContext("webgl");n.viewport(0,0,1920,938);const i=this._initShaderProgram(n);n.linkProgram(i),n.useProgram(i);const o=this._initBuffer(n);n.bindBuffer(n.ARRAY_BUFFER,o.position);const s=n.getAttribLocation(i,"a_position");n.enableVertexAttribArray(s),n.vertexAttribPointer(s,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,o.texture);const a=n.getAttribLocation(i,"a_texCoord");n.enableVertexAttribArray(a),n.vertexAttribPointer(a,2,n.FLOAT,!1,0,0);const r=this._initTexture(n);n.bindTexture(n.TEXTURE_2D,r);const c=n.getUniformLocation(i,"u_scale");n.uniform2fv(c,[1,1]),this.glObj[e]=n}_createShader(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(i)),i}_initShaderProgram(t){const e=this._createShader(t,t.VERTEX_SHADER,"\n        attribute vec2 a_position;\n        attribute vec2 a_texCoord;\n        varying vec2 v_texCoord;\n        uniform vec2 u_scale;\n\n        void main(void) {\n            gl_Position = vec4(a_position, 0.0, 1.0);\n            v_texCoord = a_texCoord;\n        }\n        "),n=this._createShader(t,t.FRAGMENT_SHADER,"\n        precision lowp float;\n        varying vec2 v_texCoord;\n        uniform sampler2D u_sampler;\n\n        void main(void) {\n            gl_FragColor = vec4(texture2D(u_sampler, v_texCoord).rgb, texture2D(u_sampler, v_texCoord+vec2(-0.5, 0)).r);\n        }\n        "),i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),i}_initBuffer(t){const e=new Float32Array([-1,1,1,1,-1,-1,1,-1]),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);const i=t.createBuffer(),o=new Float32Array([.5,1,1,1,.5,0,1,0]);return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,o,t.STATIC_DRAW),{position:n,texture:i}}_initTexture(t){const e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e}}class Xt{constructor(){}play(t){return new Promise(((e,n)=>{const{ele:i,url:o,config:s,attrs:a,loop:r}=t;if(!s)return void n();let c={type:1};if(a&&a.length){c={type:2};for(const t of a)t.skey&&t.skey.length>=3&&(1==t.typeid?c[t.skey]=t.data.pic:2==t.typeid&&(c[t.skey]=t.data.title))}this.getConfigBySrc(s).then((t=>{const a=t.info.w,l=t.info.h;let d=0,m=0;d=i.clientHeight/l*a,m=i.clientHeight,this.vap=(new window.Vap.default).play(Object.assign({},{container:i,src:o,config:s,width:d,height:m,loop:r||!1,beginPoint:0,accurate:!0,onLoadError:()=>{n()}},c)).on("playing",(()=>{console.log("playing")})).on("ended",(()=>{e(),console.log("play ended")})).on("frame",((t,e)=>{})),this.vap.play()})).catch(n)}))}getConfigBySrc(t){return new Promise(((e,n)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="json",i.onload=function(){if(200===i.status||304===i.status&&i.response){const t=i.response;t?e(t):n(new Error("JSON数据解析有问题"))}else n(new Error("http response invalid"+i.status))},i.onerror=function(t){n(t)},i.send()}))}destory(){this.vap&&(this.vap.destroy(),this.vap=null)}}class Zt{constructor(){this.instance=null,this.comeinPlaying=!1,this.items=[],this.emitter=new Ht,this.videoItemMap=new Map,this.playersMap=new Map,this.clearVideoItemTask()}static getInstance(){return this.instance||(this.instance=new Zt),this.instance}clearVideoItemTask(){setTimeout((()=>{this.videoItemMap.clear(),this.clearVideoItemTask()}),36e5)}clearPlayer(t){const e=this.playersMap.get(t);e&&(e.stopAnimation(),e.clear(),this.playersMap.delete(t))}clearAllPlayer(){for(let t of this.playersMap.values())t.stopAnimation(),t.clear();this.playersMap.clear()}playEver(t,e,n){this.loadParser(t,e,0,!1).then((t=>{const{videoItem:e,player:i}=t;i.setVideoItem(e),i.startAnimation(),this.playersMap.set(n,i)}),(t=>{}))}preload(t){if(!this.videoItemMap.get(t)){(new window.SVGA.Parser).load(t,(e=>{this.videoItemMap.set(t,e)}),(t=>{}))}}loadParser(t,e,n=1,i=!0,o="Forward",s=!0){return new Promise(((a,r)=>{const c=new window.SVGA.Player(t),l=new window.SVGA.Parser(t);c.clearsAfterStop=i,c.fillMode=o,c.loops=n;const d=this.videoItemMap.get(e);d?a({player:c,videoItem:d}):l.load(e,(t=>{s&&(c.setVideoItem(t),c.startAnimation()),this.videoItemMap.set(e,t),a({player:c,videoItem:t})}),(t=>{r(t)}))}))}playBigVideo(t,e,n){return new Promise(((i,o)=>{t.src=e,t.play(),1==n&&Jt.emitter.emit("volumeFade",0),t.addEventListener("ended",(()=>{i()}))}))}playAlphaVideo(t,e){return new Promise(((n,i)=>{1==e&&Jt.emitter.emit("volumeFade",0),Qt.getInstance().initVideo(t).then((()=>{n()})).catch((t=>{i(t)}))}))}playVap(t,e){return new Promise(((n,i)=>{1==e&&Jt.emitter.emit("volumeFade",0);const o=t,{vap_pc_url:s,vapele:a,vap_pc_config:r}=o,l=d(o,["vap_pc_url","vapele","vap_pc_config"]),m=new Xt;m.play(c({url:t.vap_pc_url,ele:t.vapele,config:t.vap_pc_config},l)).then((()=>{n()})).catch((t=>{i(t)})),t.vapPlayer=m}))}async addComin(t){this.items.push(t),this.comeinPlaying||(this.comeinPlaying=!0,this.playCominItem())}playCominItem(){if(this.items.length>0){const t=this.items.shift();this.play(t).then((t=>{t.clearsAfterStop?t.svgaele.remove():this.emitter.emit("onplayfinished",t),this.playCominItem()})).catch((e=>{this.playCominItem(),this.emitter.emit("onloadfail",t,e)}))}else this.comeinPlaying=!1}play(t){const e=t.svgaele,n=t.videoele,i=t.path,o=t.clearsAfterStop||!1,s=t.fillMode||"Forward",a=t.attrs||[],r=t.loops||1,c=t.video_pc_url||"",l=t.video_sound||0,d=t.vap_pc_url;return new Promise(((m,h)=>{d?this.playVap(t,l).then((()=>{m(t)})).catch((t=>{h(t)})):(c&&this.playAlphaVideo({canvas:n,url:c,loop:!1},l).then((()=>{m(t)})).catch((t=>{h(t)})),this.loadParser(e,i,r,o,s).then((e=>{const{videoItem:n,player:i}=e;for(let t=0;t<a.length;t++){const e=a[t],n=e.typeid,o=e.skey;if(1==n){const t=e.data.pic;i.setImage(t,o)}else if(2==n){const t=e.data.title,n=e.data.size+"px",s=e.data.color;i.setText({text:t,size:n,color:s,family:"Microsoft YaHei"},o)}}i.setVideoItem(n),i.startAnimation(),i.onFinished((()=>{c||m(t)}))}),(e=>{this.comeinPlaying=!1,this.playCominItem(),this.emitter.emit("onloadfail",t,e)})))}))}playLoop(t,e){const n=t.ele,i=t.path,o=t.clearsAfterStop||!1,s=t.fillMode||"Forward",a=t.attrs||[];this.loadParser(n,i,0,o,s).then((t=>{const{videoItem:n,player:i}=t;for(let e=0;e<a.length;e++){const t=a[e],n=t.typeid,o=t.skey;if(1==n){const e=t.data.pic;i.setImage(e,o)}else if(2==n){const e=t.data.title,n=t.data.size+"px",s=t.data.color;i.setText({text:e,size:n,color:s,family:"Microsoft YaHei"},o)}}i.setVideoItem(n),i.startAnimation(),this.playersMap.set(e,i)}),(t=>{}))}}const te="src/js/components/LyricsView/index.svelte";function ee(t,e,n){const i=t.slice();return i[7]=e[n],i[9]=n,i}function ne(t,e,n){const i=t.slice();return i[10]=e[n],i[12]=n,i}function ie(t){let e,n,i,o=t[2].content;v(o);let s=[];for(let r=0;r<o.length;r+=1)s[r]=se(ee(t,o,r));const a={c:function(){e=_("div"),n=_("div");for(let t=0;t<s.length;t+=1)s[t].c();y(n,"class","scroll-box s-qfdO6mI6IoW_"),y(n,"id","scroll-box"),y(n,"style",i=`transform: translate3d(0, ${t[3]}px, 0)`),x(n,te,35,12,879),y(e,"class","scroll-wrapper s-qfdO6mI6IoW_"),x(e,te,34,8,838)},m:function(t,i){b(t,e,i),I(e,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p:function(t,e){if(7&e){let i;for(o=t[2].content,v(o),i=0;i<o.length;i+=1){const a=ee(t,o,i);s[i]?s[i].p(a,e):(s[i]=se(a),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=o.length}8&e&&i!==(i=`transform: translate3d(0, ${t[3]}px, 0)`)&&y(n,"style",i)},d:function(t){t&&C(e),S(s,t)}};return p("SvelteRegisterBlock",{block:a,id:ie.name,type:"if",source:"(34:4) {#if lyric && lyric.content}",ctx:t}),a}function oe(t){let e,n,i,o,s,a,r,c,l=t[7].start+t[10].start+t[10].duration+"",d=t[10].content+"";const m={c:function(){e=_("div"),n=M(t[0]),i=T(),o=M(l),s=T(),a=_("div"),r=M(d),A(e,"display","none"),x(e,te,39,28,1199),y(a,"class",c=R("word "+(t[0]>t[7].start+t[10].start+t[10].duration?"light":"white"))+" s-qfdO6mI6IoW_"),x(a,te,43,28,1407)},m:function(t,c){b(t,e,c),I(e,n),I(e,i),I(e,o),b(t,s,c),b(t,a,c),I(a,r)},p:function(t,e){1&e&&P(n,t[0]),4&e&&l!==(l=t[7].start+t[10].start+t[10].duration+"")&&P(o,l),4&e&&d!==(d=t[10].content+"")&&P(r,d),5&e&&c!==(c=R("word "+(t[0]>t[7].start+t[10].start+t[10].duration?"light":"white"))+" s-qfdO6mI6IoW_")&&y(a,"class",c)},d:function(t){t&&C(e),t&&C(s),t&&C(a)}};return p("SvelteRegisterBlock",{block:m,id:oe.name,type:"each",source:"(39:24) {#each item.content as tone, j}",ctx:t}),m}function se(t){let e,n,i,o=t[7].content;v(o);let s=[];for(let r=0;r<o.length;r+=1)s[r]=oe(ne(t,o,r));const a={c:function(){e=_("div");for(let t=0;t<s.length;t+=1)s[t].c();n=T(),y(e,"class",i=R("sentence "+(t[9]===t[1]+1?"big":"normal"))+" s-qfdO6mI6IoW_"),x(e,te,37,20,1046)},m:function(t,i){b(t,e,i);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null);I(e,n)},p:function(t,a){if(5&a){let i;for(o=t[7].content,v(o),i=0;i<o.length;i+=1){const r=ne(t,o,i);s[i]?s[i].p(r,a):(s[i]=oe(r),s[i].c(),s[i].m(e,n))}for(;i<s.length;i+=1)s[i].d(1);s.length=o.length}2&a&&i!==(i=R("sentence "+(t[9]===t[1]+1?"big":"normal"))+" s-qfdO6mI6IoW_")&&y(e,"class",i)},d:function(t){t&&C(e),S(s,t)}};return p("SvelteRegisterBlock",{block:a,id:se.name,type:"each",source:"(37:16) {#each lyric.content as item, i}",ctx:t}),a}function ae(t){let e,n=t[2]&&t[2].content&&ie(t);const i={c:function(){e=_("div"),n&&n.c(),y(e,"class","lyric s-qfdO6mI6IoW_"),x(e,te,32,0,777)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){b(t,e,i),n&&n.m(e,null)},p:function(t,[i]){t[2]&&t[2].content?n?n.p(t,i):(n=ie(t),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){t&&C(e),n&&n.d()}};return p("SvelteRegisterBlock",{block:i,id:ae.name,type:"component",source:"",ctx:t}),i}function re(t,e,n){let{$$slots:i={},$$scope:o}=e;f("LyricsView",i,[]);let s,a=0,r=0,c=0,l=0;const d=t=>{n(2,s=t),c=0},m=(t,e)=>{if(s&&s.content){let e=t+500;const i=s.content;for(let t=0;t<i.length;t++)if(e<=i[t].start)return n(1,r=t-2),n(0,a=e),void n(3,l=32*-r)}},h=[];return Object.keys(e).forEach((t=>{~h.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<LyricsView> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({onMount:w,currentTime:a,currentLine:r,lyric:s,startLineIndex:c,translateY:l,setLyricFn:d,setOffSets:m}),t.$inject_state=t=>{"currentTime"in t&&n(0,a=t.currentTime),"currentLine"in t&&n(1,r=t.currentLine),"lyric"in t&&n(2,s=t.lyric),"startLineIndex"in t&&(c=t.startLineIndex),"translateY"in t&&n(3,l=t.translateY)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,r,s,l,d,m]}class ce extends h{constructor(t){super(t),u(this,t,re,ae,g,{setLyricFn:4,setOffSets:5}),p("SvelteRegisterComponent",{component:this,tagName:"LyricsView",options:t,id:ae.name})}get setLyricFn(){return this.$$.ctx[4]}set setLyricFn(t){throw new Error("<LyricsView>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get setOffSets(){return this.$$.ctx[5]}set setOffSets(t){throw new Error("<LyricsView>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class le{constructor(){this.instance=null,this._wssocket=null,this.lyricsPlayer=null,this.currrentSingerId=0}static getInstance(){return this.instance||(this.instance=new le,this.instance.onEventListener()),this.instance}bindSocket(t){this._wssocket=t}onUpdateIdentity(){const t=uu.getAnchorKengUser(uu.getMeid());uu.isAnchoringUser(uu.getMeid())?window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0] .song-head-option").removeClass("hide"):null!=t&&1==t.live_rec?window.$(".chat-center-main").find(".seat-item-empty[data-uid="+t.uid+"] .song-head-option").removeClass("hide"):window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0] .song-head-option").addClass("hide");null!=uu.getAnchorKengUser(uu.getMeid())?window.$(".song-but-catgory").removeClass("hide"):window.$(".song-but-catgory").addClass("hide")}onCheckRecommendSeat(){let t="https://asset.tuwan.com/chatroom/images/icon_logo.png",e="";const n=uu.getAnchorKengUsers(),i=window.$(".song-seat-songer-wrapper"),o=window.$(".song-seat-songer-wrapper").find(".seat-svga");let s=0;for(let a of n.values())if(1==a.live_rec){s=a.uid,t=a.avatar,e=a.nickname,i.attr("data-uid",a.uid),""!=a.heads?(Zt.getInstance().videoItemMap.delete(a.heads),Zt.getInstance().loadParser(o[0],a.heads,0,!1)):o.html("");break}""==e&&(o.html(""),i.removeAttr("data-uid"),uu.isAnchoringUser(uu.getMeid())&&le.getInstance().onRecommendSeat(uu.getMeid())),s!=this.currrentSingerId&&null!=this.lyricsPlayer&&(this.currrentSingerId==uu.getMeid()?Cd.getInstance().onStopLocalAudioMixin():this.onSongFinishHandle()),this.currrentSingerId=s,window.$(".songer-head-img").attr("src",t),window.$(".song-songer-info-wrapper .seat-user-name").text(e),null==uu.getAnchorKengUser(uu.getMeid())||(1==uu.getAnchorKengUser(uu.getMeid()).live_rec?(window.$(".song-play-wrapper").removeClass("hide"),window.$(".song-order-resource-list").css("height","390px")):(window.$(".song-play-wrapper").addClass("hide"),window.$(".song-order-resource-list").css("height","440px")))}onRecommendSeat(t){let e=1;1==uu.getAnchorKengUser(t).live_rec&&(e=0),this._wssocket&&this._wssocket.send("setLiveRec",{cid:uu.getCid(),uid:t,typeid:uu.roomInfo.typeid,state:e})}setLyrics(t){const e=this,{song_code:n,url:i,singer_uid:o,play:s}=t;if(o!=this.currrentSingerId&&(this.currrentSingerId==uu.getMeid()?Cd.getInstance().onStopLocalAudioMixin():this.onSongFinishHandle()),null!=this.lyricsPlayer&&(this.lyricsPlayer=null),1==s){const t=$("#song-lyric")[0];this.lyricsPlayer=null,$("#song-lyric").empty(),this.lyricsPlayer=new ce({target:t}),Cd.getInstance().justDownLoadLyric(n).then((t=>{this.lyricsPlayer.setLyricFn(Cd.getInstance().lyric)}))}else e.onSongFinishHandle()}onSongFinishHandle(){window.$(".song-lyric-empty").removeClass("hide"),window.$(".song-lyric-wrapper").addClass("hide"),null!=this.lyricsPlayer&&(this.lyricsPlayer=null)}onInterruptSinging(){this.currrentSingerId==uu.getMeid()&&Cd.getInstance().onStopLocalAudioMixin()}_onStopLocalAudioMixin(){null!=this.lyricsPlayer&&(this.lyricsPlayer=null),window.$(".song-lyric-empty").removeClass("hide"),window.$(".song-lyric-wrapper").addClass("hide")}onListenerLyricsOffSets(t){let e=!1;null!=this.lyricsPlayer&&(this.lyricsPlayer.isPause&&(this.lyricsPlayer.setIsPause(!1),e=!0),this.lyricsPlayer.setOffSets(parseInt(t.time),e),window.$(".song-lyric-empty").addClass("hide"),window.$(".song-lyric-wrapper").removeClass("hide"))}setLyricsOffSets(t){let e=!1;null!=this.lyricsPlayer&&(this.lyricsPlayer.isPause&&(this.lyricsPlayer.setIsPause(!1),e=!0),this.lyricsPlayer.setOffSets(1e3*t,e),window.$(".song-lyric-empty").addClass("hide"),window.$(".song-lyric-wrapper").removeClass("hide"))}onEventListener(){const t=this;window.$(".chat-center-main").on("click",".song-head-option",(function(){const t=window.$(this).parents(".seat-item-empty");if(t.length>0){const e=t.get(0).dataset.uid;le.getInstance().onRecommendSeat(e)}})),window.$(".chat-center-main").on("click",".song-but-catgory",(function(t){t.stopPropagation(),Cd.getInstance().showQukuModal()})),window.$(".chat-center-main").on("click",".song-but-accompany",(function(e){const n=e.target.dataset.type,i=Cd.getInstance();0!=n&&1!=n||(0==n?(i.defaultGain=1,i.onTaggerGain(),i.onShowPlayingSongFlag(t.song_code,0)):(i.defaultGain=0,i.onTaggerGain(),i.onShowPlayingSongFlag(t.song_code,1)))}))}onReset(){0!=Cd.getInstance().currentSongCode&&this.currrentSingerId==uu.getMeid()&&Cd.getInstance().onStopLocalAudioMixin(),this.currrentSingerId=0}onShowPlayingSongFlag(t,e){window.$(".song-but-accompany").removeClass("hide"),0==e?(window.$(".song-but-accompany").attr("data-type",1),window.$(".song-but-accompany").text("原唱:开")):1==e?(window.$(".song-but-accompany").attr("data-type",0),window.$(".song-but-accompany").text("原唱:关")):2==e?(window.$(".song-but-accompany").attr("data-type",2),window.$(".song-but-accompany").text("伴奏:无")):3==e&&(window.$(".song-but-accompany").attr("data-type",3),window.$(".song-but-accompany").text("原唱:无"))}}class de{constructor(){this.instance=null,this.choiceStatus=!1}static getInstance(){return this.instance||(this.instance=new de),this.instance}show(t="",e="",n=!0,i="取消",o="关闭",s=null,a=null,r=null){this.choiceStatus=!1,window.$(".room_confirm_cancel").off("click"),window.$(".room_confirm_affirm").off("click"),window.$(".room_confirm_close").off("click"),window.$(".room_confirm_choice").off("click"),window.$(".room_confirm_modal").remove();let c="",l="",d="";null!=r&&("center"==r.desAlign&&(c="text-align: center;"),"show"==r.choice&&(l="display:flex",d=r.choiceText)),window.$("body").append('\n            <div class="room_confirm_modal" style="z-index: 9999999">\n                    <div class="room_confirm_content">\n                        '+(n?'<div class="room_confirm_close"></div>':"")+'\n                        <div class="room_confirm_title">'+t+`</div>\n                        <div class="room_confirm_info" style="${c}">\n                        </div>\n                        <div class="flex">\n                            `+(""==i?"":'<div class="room_confirm_cancel">'+i+"</div>")+"\n                            "+(""==o?"":'<div class="room_confirm_affirm">'+o+"</div>")+`\n                        </div>\n                        <div class='flex room_confirm_choice' style='${l}'> <i></i> ${d}</div>\n                    </div>\n            </div>`),$(".room_confirm_info").html(e),$(".room_confirm_modal").on("click",(function(t){t.stopPropagation()})),window.$(".room_confirm_modal").css("display","flex"),window.$(".room_confirm_affirm").on("click",(()=>{s?(s(),window.$(".room_confirm_modal").css("display","none")):window.$(".room_confirm_modal").css("display","none")})),window.$(".room_confirm_cancel").on("click",(()=>{a?(a(),window.$(".room_confirm_modal").css("display","none")):window.$(".room_confirm_modal").css("display","none")})),window.$(".room_confirm_choice").on("click",(()=>{$(".room_confirm_choice").hasClass("actived")?($(".room_confirm_choice").removeClass("actived"),this.choiceStatus=!1):($(".room_confirm_choice").addClass("actived"),this.choiceStatus=!0)})),window.$(".room_confirm_close").on("click",(()=>{window.$(".room_confirm_modal").css("display","none")}))}hide(){window.$(".room_confirm_modal").css("display","none")}}class me{constructor(){this.instance=null,this.emitter=new Ht,this.currentType="rec",this.session=bt,this.changeRoomStatus=!1,this.tabs=[],this.swiper=null}static getInstance(){return this.instance||(this.instance=new me),this.instance}init(t){this.parent=window.$("."+t),this._initEvent();let e=uu.getUrlCidParam();this._requestRoomList(0,e).then((t=>{const e=t.nav,n=t.cid,i=t.data;this.tabs=[...e];const{html:o,index:s}=this._getTabsHtml(e),a=this._getRoomsBox(e);1==Rt?this.parent.html(a):this.parent.html(o+a),this._setRoomsList(this.currentType,i),this.requestConfig(),this.requestRoomInfo(n);const r=this;this.swiper=new window.Swiper(".lefttabs-swiper-container",{threshold:5,slidesPerView:"auto",spaceBetween:0,centeredSlides:!1,on:{init(){},click:function(){r.navscroll(this,this.clickedIndex)}}}),1!=Rt&&this.navscroll(this.swiper,s,this.snapGrid),this.emitter.emit("loadedRoomList",[],null,n)}),(t=>{}))}preloadNoticeSvgaFn(){Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/sao_jin.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/star_jin.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/sao_yin.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/star_yin.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_1.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_2.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_3.svga")}navscroll(t,e){e<3?t.slideTo(0,300):e<5?t.slideTo(1,300):e<7?t.slideTo(2,300):7==e?t.slideTo(4,300):t.slideTo(5,300)}requestConfig(){qt.get(Ot.getImg(5)).then((t=>{t.data.background_img&&window.$(".chat-head").css("background",`url(${t.data.background_img}) no-repeat 0 0 #f58`)}))}changeRoomReSetSomething(t){const e=8==t.game_info.gameid||9==t.game_info.gameid;setTimeout((()=>{e?($("#partyGameSwitchBtn").show(),$(".squidActive_wrapper .squidActive_seats").css("margin-left",0)):($("#partyGameSwitchBtn").hide(),$(".squidActive_wrapper .squidActive_seats").css("margin-left",""))}),0)}requestRoomInfo(t){const e=Ct.getQueryString("version"),n=e&&e.length?"&platfrom=0&c_version="+e+"&ver="+e:"";qt.get(Ot.getWebInfo(t)+n).then((t=>{console.log("getWebInfo====",t);if(0==t.error){const e=t.data;if(this.emitter.emit("previousClearData"),uu.setRoomInfo(e),uu.setAnchors(e.anchor_ids),uu.setWaiters(e.waiter_ids),uu.setManagers(e.manage_user),this.emitter.emit("loadedRoomInfo",e),this.changeMenuStatus(e),[7,30,32,39].indexOf(e.typeid)>-1&&e.trumpet.show_trumpet_entry){window.sessionStorage.setItem("showNotice","1"),$(".publishNoticeIcon").show(),this.preloadNoticeSvgaFn();const t=e.trumpet.trumpet_queue;this.emitter.emit("handleSetGlobalNoticeArr",t||[])}else window.sessionStorage.setItem("showNotice","0"),$(".publishNoticeIcon").hide()}else this.emitter.emit("loadedRoomInfoError",t)}))}calculateLiveNum(t){let e=0;return t.map((t=>e+=Math.ceil((1*t.vip+1)/3))),e}updateLiveNum(t,e=0){let n=e;n+=this.calculateLiveNum(t),this.updateChannelUsersCountAPI("x",0,uu.getRoomInfo().channel,n)}addChannelUsers(t,e,n=[],i=[],o){let s=[],a=[];for(let r=0;r<t.length;r++){const e=t[r];e>Mt.maxUID?a.push(qt.getYoukeInfo(e)):s.push(e)}qt.getUsersInfo(s.join(","),"addChannelUsers").then((s=>{this.updateLiveNum(s,t.filter((t=>t>Mt.maxUID)).length);let r=[],c=[],l=[],d=[],m=[];const h=e,u=this.parent.find("div.room-item[channel='"+h+"']").find(".room-item-perons"),p="lazyload_"+(new Date).getTime();if(s.length>0){let t=[],a=[];t=n.map((t=>1*t)),a=i.map((t=>1*t));let m=[],h=[],g=[],f=[];for(let e=0;e<s.length;e++){const n=s[e],i=1*n.uid,u=n.teacher;t.includes(i)?(r.push(this._setUserInfo(n,"主持",p)),h.push(n)):a.includes(i)?(c.push(this._setUserInfo(n,o,p)),g.push(n)):1==u?(d.push(this._setUserInfo(n,"队长",p)),m.push(n)):0==u&&(l.push(this._setUserInfo(n,"老板",p)),f.push(n))}u.find(".persons-anchor").html(r.join("")),u.find(".persons-paidan").html(c.join("")),u.find(".persons-boss").html(l.join("")),u.find(".persons-teachers").html(d.join("")),window.$(`.room-item[channel='${e}']`).find(".person-svga").each((function(){this.dataset.hat&&Zt.getInstance(window.SVGA).playLoop({ele:this,path:this.dataset.hat})})),window.lazyload(window.$("."+p))}for(let t=0;t<a.length;t++)m.push(this._setUserInfo(a[t],"游客","youke-nolazy"));u.find(".persons-youke").html(m.join("")),window.____roomScrolled||(window.____roomScrolled=!0,h==uu.getChannel()&&setTimeout((()=>{const t=this.parent.find(".room-item-name[data-channel='"+h+"']");if(t.length)try{window.$(".chat-rooms-all").animate({scrollTop:t.offset().top-window.$(".chat-rooms-all").height()/2+"px"},500)}catch(e){}}),200))}))}addChannelUser(t,e,n,i){const o=1*e.uid,s=e.teacher,a=this.parent.find("div.room-item[channel='"+t+"']").find(".room-item-perons");if(a.find(".person-item[data-uid='"+o+"']").length>0)return;const r="lazyload_"+(new Date).getTime();if(uu.isAnchors2(o)){const t=this._setUserInfo(e,"主持",r);a.find(".persons-anchor").append(t)}else if(uu.isPaidan2(o)){const t=this._setUserInfo(e,i,r);a.find(".persons-paidan").append(t)}else if(1==s){const t=this._setUserInfo(e,"队长",r);a.find(".persons-teachers").append(t)}else if(o>8e8){const t=this._setUserInfo(e,"游客","youke-nolazy");a.find(".persons-youke").append(t)}else if(0==s){const t=this._setUserInfo(e,"老板",r);a.find(".persons-boss").append(t)}n&&this._updateChannelUsersCount("+",e.vip,t,0),window.lazyload(window.$("."+r))}async updateChannelUserInfo(t,e,n){const i=window.$(".rooms").find('.room-item[channel="'+t+'"]').find(".room-item-perons").find(".person-item[data-uid='"+e+"']"),o=i.parents(".person-area"),s=uu.getRoomUserIdentity(e,n.teacher),a="lazyload_"+(new Date).getTime(),r=this._setUserInfo(n,s,a);i.remove(),o.append(r),n.hat&&Zt.getInstance(window.SVGA).playLoop({ele:o.find(`.person-item[data-uid="${e}"] .person-svga`)[0],path:n.hat}),window.lazyload(window.$("."+a))}async removeChannelUser(t,e){const n=window.$(".room-item[channel='"+t+"']").find(".room-item-perons .person-item[data-uid='"+e+"']");if(n.length>0){const e=n.get(0).dataset.vip;n.remove(),this._updateChannelUsersCount("-",e,t,0)}}ocRoomUsers(t){const e=this._getRoomItemForChannelEle(t),n=e.find(".room-item-perons"),i=e.find(".room-item-roal[data-channel='"+t+"']");n.hasClass("hide")?(n.removeClass("hide"),i.find("img").removeClass("room-route")):(n.addClass("hide"),i.find("img").addClass("room-route"))}updateChannelUsersCountAPI(t,e,n,i){this._updateChannelUsersCount(t,e,n,i)}changeMenuStatus(t){const e=t.vipid||t.cid;if(5==t.typeid)return;this.parent.find(".room-item-name").removeClass("current"),this.parent.find(".room-item-perons").addClass("hide"),this.parent.find(".room-item-zhuan-kuang img").addClass("room-route");const n=this.parent.find(".room-item-name[data-cid='"+e+"']");n.addClass("current"),n.parent().find(".room-item-perons").removeClass("hide"),n.find(".room-item-zhuan-kuang img").removeClass("room-route")}async setLeftSearchInput(t){}async setLeftSearchInputCurrentCid(t){const e=this.parent.find(`.left-search-person[data-channel="${uu.getChannel()}"]`);t?e&&e.css("display","flex"):e&&e.css("display","none")}async _reUpdateChannelUsersCount(t){qt.get(Pt+"/Chatroom/getChannelUserNum?ver=9",(e=>{if(0==e.error){const n=e.data;if(n&&n.length>0)for(let e=0;e<n.length;e++){const i=n[e].channel,o=n[e].number;if(t==i){this.parent.find(".room-item-name[data-channel='"+i+"']").find(".room-item-name-num font").text(o);break}}}}))}_getRoomItemForChannelEle(t){return window.$(".room-item[channel='"+t+"']")}_updateChannelUsersCount(t,e,n,i){const o=Math.ceil((1*e+1)/3),s=this.parent.find(".room-item-name[data-channel='"+n+"']");let a=null;if(s.length>0&&(a=s.eq(0)),!a)return;const r=1*a.find(".room-item-name-num font").text();i=i||0;let c=0;if("+"==t)c=1*r+1*o+i;else if("-"==t){const t=[];window.$(`.room-item[channel='${n}'] .room-item-perons .person-area .person-item`).each(((e,n)=>{t.push({vip:1*n.dataset.vip})})),t.length&&(c=this.calculateLiveNum(t)),c<0&&(c=0)}else"x"==t&&(c=i);s.find(".room-item-name-num font").text(c)}_requestRoomList(t,e){return new Promise(((n,i)=>{qt.get(Ot.getChatList2({navid:t,cid:e})).then((t=>{0==t.error?n(t):i(t.error_msg)}))}))}_setRoomsList(t,e){let n="";if(1==t){const t=e.filter((t=>0==t.attent)),i=e.filter((t=>1==t.attent));n='<div class="attent-rec">'+this._roomsHtml(t,!0)+'</div><div class="user-attent">'+this._roomsHtml(i,!1)+'</div><div style="padding-left:10px;font-size:14px;color:#666;margin-top:20px;">热门大厅</div><div class="attent-hot"></div>',qt.get(At+"/Chatroom/getHotRank?format=jsonp").then((t=>{if(0==t.error){const e=this._roomsHtml(t.data,!1);window.$(".chat-room-list .attent-hot").html(e)}}))}else n=e.length>0?this._roomsHtml(e):'<div style="font-size:12px; text-align:center; color:#999;">暂无数据</div>';const i=this.parent.find(".chat-room-list ul li[data-type='"+t+"']");i.find(".rooms").html(n),this.currentType==t&&i.removeClass("hide")}_getAttentList(){qt.get(Pt+"/Chatroom/getListV5?ver=11").then((t=>{if(0==t.error){const e=t.data.attent,n=this._roomsHtml(e,!1);window.$(".chat-room-list .user-attent").html(n)}}))}async _otherRoosList(t,e){for(let n of this.tabs.keys()){if(n==t)continue;const i=e[n];"attent"==n?this._setRoomsList(n,i,e.rec):this._setRoomsList(n,i)}}_roomsHtml(t,e){let n=[];for(let i=0;i<t.length;i++){const o=t[i];n.push(this._getRoomItem(o,e))}return n.join("")}_initEvent(){const t=this,e=this.parent;e.on("click","li.left-tab-item",(function(){const n=this.dataset.type;if(t.currentType==n)return;window.$(this).parent().find("li[data-type='"+t.currentType+"']").removeClass("current"),t.currentType=n,window.$(this).parent().find("li[data-type='"+n+"']").addClass("current");const i=e.find("div.chat-room-list ul");i.find("li").addClass("hide");const o=i.find("li[data-type='"+n+"']");o.removeClass("hide"),this.dataset.index,o.find("div.rooms>div").length,t._requestRoomList(n,0).then((e=>{const i=e.data;t._setRoomsList(n,i);const s=uu.getUrlCidParam();if(i.filter((t=>t.cid==s)).length>0){const e=o.find(".room-item-name[data-cid='"+s+"']");e.addClass("current"),o.find(".room-item-perons").removeClass("hide"),e.find(".room-item-zhuan-kuang img").removeClass("room-route"),t.emitter.emit("loadroomusers",s)}}))})),e.on("click",".room-item-name",(function(){if(1==Rt)return;if(window.$(this).hasClass("current")&&!uu.isTempCarteamRoom())return;if(this.changeRoomStatus)return;this.changeRoomStatus=!0,setTimeout((()=>{this.changeRoomStatus=!1}),500);const e=this.dataset.cid,n=this.dataset.typeid;t.emitter.emit("changeRoom",e,n)})),e.on("click",".room-item-roal",(function(e){e.stopPropagation();const n=this.dataset.channel,i=this.dataset.cid,o=t._getRoomItemForChannelEle(n).find(".room-item-perons");o.hasClass("hide")?t.emitter.emit("ocRoomUsers",n,i):(o.addClass("hide"),t._getRoomItemForChannelEle(n).find(".room-item-roal[data-channel='"+n+"']").find("img").addClass("room-route"))})),e.on("mouseenter",".person-item",(function(){const e=this.dataset.uid,n=window.$(this).parents(".room-item").attr("channel");t.emitter.emit("mouseoverPerson",e,n,this)})),e.on("mouseleave",".person-item",(function(){const e=this.dataset.uid;window.$("#user_"+e).hide(),t.emitter.emit("mouseLeavePerson","","",this)})),e.on("keyup",".left-search-person input[type='text']",(function(){const e=window.$(this).parents(".room-item-perons"),n=window.$(this).val();if(""==n)e.find(".persons-anchor").css("display","flex"),e.find(".persons-paidan").css("display","flex"),e.find(".persons-boss").css("display","flex"),e.find(".persons-teachers").css("display","flex"),e.find(".persons-youke").css("display","flex"),e.find(".persons-searchs").html("");else{if(n.length<=2)return;e.find(".persons-anchor").css("display","none"),e.find(".persons-paidan").css("display","none"),e.find(".persons-boss").css("display","none"),e.find(".persons-teachers").css("display","none"),e.find(".persons-youke").css("display","none");const i=uu.roomInfo.anchor_ids,o=uu.roomInfo.waiter_ids,s=uu.roomInfo.cap_role,a="lazyload_"+(new Date).getTime();let r=[],c=[];r=i.map((t=>1*t)),c=o.map((t=>1*t)),qt.get(Ot.getSearchUser(uu.getCid(),n)).then((n=>{if(0==n.error){const i=n.data||[];let o=[],l=[],d=[],m=[];for(let e=0;e<i.length;e++){const n=i[e],h=1*n.uid,u=n.teacher;r.includes(h)?o.push(t._setUserInfo(n,"主持",a)):c.includes(h)?l.push(t._setUserInfo(n,s,a)):1==u?m.push(t._setUserInfo(n,"队长",a)):0==u&&d.push(t._setUserInfo(n,"老板",a))}e.find(".persons-searchs").html(o.join("")+l.join("")+m.join("")+d.join("")),window.lazyload(window.$("."+a))}}))}})),e.on("click",".room-item-attenticon",(function(e){e.stopPropagation();const n=this.dataset.cid,i=this.dataset.channel;qt.get(Pt+"/Chatroom/addCollect?cid="+n).then((e=>{const o=e.error;if(0==o){window.$(this).hide(),window.$(this).parent().find(".room-item-name-num").show();const e=t.parent.find(".attent-rec").find(".room-item[channel='"+i+"']"),o=e.prop("outerHTML");t.parent.find(".user-attent").append(o),e.remove(),t.emitter.emit("addattent",i,n)}else-1==o&&t.emitter.emit("nologin")}))}))}addAttent(t){const e=window.$(".chat-room-list .attent-rec").find(".room-item[channel='"+t+"']");if(e.length>0)e.find(".room-item-name-num").show(),e.find(".room-item-attenticon").hide();else{const e=window.$(".attent-rec").find(".room-item[data-channel='"+t+"']").prop("outerHTML");window.$(".chat-room-list .user-attent").append(e)}}_getChannelUsers(t){return new Promise(((e,n)=>{const i=Pt+"/Chatroom/getChatUserList?cid="+t+"&format=jsonp&uid=0";qt.get(i).then((t=>{e(t)}),(t=>{n(t)}))}))}removeAttent(t){window.$(".chat-room-list .user-attent").find(".room-item[channel='"+t+"']").remove();const e=window.$(".chat-room-list .attent-rec").find(".room-item[channel='"+t+"']");e.length>0&&(e.find(".room-item-name-num").hide(),e.find(".room-item-attenticon").show())}_getTabsHtml(t){let e=[];e.push('<div class="chatroom-left-tabs-p"><div class="chatroom-left-tabs lefttabs-swiper-container"><ul class="flex chat-left-catorage swiper-wrapper">');let n=0;for(let i=0;i<t.length;i++){const o=t[i],s=o.id,a=o.title,r=o.rec;"派单"!=a&&(1==r&&(this.currentType=s,n=i),e.push('<li data-index="'+i+'" data-type="'+s+'" class="left-tab-item '+(1==r?"current":"")+' swiper-slide">'+a+"<span></span></li>"))}e.push("</ul></div></div>");return{html:e.join(""),index:n}}_getLineHtml(){return""}_getRoomsBox(t){let e=[];e.push('<div class="scroll chat-rooms-all"><div class="chat-room-list"><ul>');for(let n=0;n<t.length;n++)e.push('<li data-type="'+t[n].id+'" class="hide">\n\t\t\t\t\t\t\t<div class="rooms">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t   </li>');return e.push("</ul></div></div>"),e.join("")}_getRoomItem(t,e){const n=t.channel,i=this._getRoomInfo(t,e);let o=this._getSearchHtml(n);return'<div class="room-item '+(1==Rt?"hide":"")+'" channel="'+n+'">\n\t\t\t\t\t'+i+'\n\t\t\t\t\t<div class="room-item-perons hide" data-cid="'+t.cid+'" data-channel="'+n+'">\n                        '+o+'\n\t\t\t\t\t\t<div class="person-area persons-anchor"></div>\n\t\t\t\t\t\t<div class="person-area persons-paidan"></div>\n\t\t\t\t\t\t<div class="person-area persons-boss"></div>\n\t\t\t\t\t\t<div class="person-area persons-teachers"></div>\n\t\t\t\t\t\t<div class="person-area persons-youke"></div>\n                        <div class="person-area persons-searchs"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'}_getSearchHtml(t){return'\n            <div class="flex flex-ac left-search-person" data-channel="'+t+'">\n                <img style="margin-left: 10px; width: 20px;" src="https://dynamics-share.tuwan.com/activity/99bb305fbec09d9b8d0699473f243428.png"/>\n                <input type="text"  placeholder="请输入uid" />\n            </div>\n        '}_getRoomInfo(t,e){const n=t.title,i=t.naming,o=t.cid,s=t.channel,a=t.color,r=t.icon,c=t.typeid,l=t.attent,d=t.hat,m=t.active_name,h=t.active_color,u=t.usernum;let p="";p=m?`<span style="color:${h};border:1px solid ${h};border-radius:4px;padding:0 2px;display:inline-block;margin-right:4px">${m}</span>${i}`:i;return'<div class="flex room-item-name" data-cid="'+o+'" data-channel="'+s+'" data-typeid="'+c+'">\n\t\t\t\t\t<div class="flex room-item-roal" data-channel="'+s+'" data-cid="'+o+'">\n\t\t\t\t\t\t<div class="flex room-item-zhuan-kuang">\n\t\t\t\t\t\t\t<img class="room-route" src="https://res.tuwan.com/templet/play/chat/images/sanjiaoicon.png?v=1">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="room-item-name-icon">\n\t\t\t\t\t\t<img class="room-item-img" src="'+Ct.webpCoverImgFormat(r)+'">\n\t\t\t\t\t\t<img class="room-item-hat" src="'+d+`" style="display:${d?"block":"none"}">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="room-item-name-info">\n\t\t\t\t\t\t<p class="room-item-name-roomname" style="color:`+a+'" title="'+n+'"><span style="display:'+(e?"inline":"none")+'" class="span-jian">荐</span>'+n+'</p>\n\t\t\t\t\t\t<p class="room-item-name-roomtitle">'+p+'</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style="display:'+(e&&0==l?"none":"block")+'" class="room-item-name-num">（<font>'+u+'</font>）</div>\n\t\t\t\t\t<div data-cid="'+o+'" data-channel="'+s+'" style="display:'+(e&&0==l?"block":"none")+'" class="room-item-attenticon"></div>\n\t\t\t\t</div>'}_setUserInfo(t,e,n){let i=1*t.uid,o=t.avatar,s=t.teacher,a=t.nickname,r=t.vip,c=t.vipicon,l=t.hat,d=t.medal||"https://res.tuwan.com/templet/play/chat/v2/images/empty.png",m=t.color||"#666";const h=uu.nameFormat(a+"",85,i);let u="",p="";if(i<8e8){let t="";t="老板"==e?'<img src="https://res.tuwan.com/templet/play/chat/images/laobanicon.png" />':'<i class="chat-room-peiwan-tag">'+e+"</i>",u='<p class="flex person-honor">\n\t\t\t\t\t\t<span>'+t+'</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<img src="'+c+'">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<img'+" "+'src="'+d+'">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</p>'}return"#ffe14c"==m?(m="",p="ygb_title"):"#b460da"==m&&(m="",p="ygb_pink"),o=Ct.webpImgFormat(o),'<div style="order:'+(100-r)+'" data-color="'+m+'" data-vip="'+r+'" class="flex person-item" data-nickname="'+a+'" data-uid="'+i+'" data-teacher="'+s+'" data-vipicon="'+c+'">\n\t\t\t\t\t<div class="person-thumb">\n\t\t\t\t\t\t<img data-src="'+o+'" class="'+n+`" src="https://uc.tuwan.com/images/noavatar_1.jpg" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n\t\t\t\t\t\t<div class="person-svga" data-hat="${l}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="person-info">\n\t\t\t\t\t\t`+u+'\n\t\t\t\t\t\t<p class="person-name '+p+'" style="color:'+m+'">'+h+"</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>"}}const he=me.getInstance(),ue=new Map([[34,{diamond:10,icon:"https://img3.tuwandata.com/uploads/play/1898151532696070.png",id:34}],[57,{diamond:52,icon:"https://img3.tuwandata.com/uploads/play/2049781539250469.png",id:57}],[106,{diamond:520,icon:"https://img3.tuwandata.com/uploads/play/2275621548733308.png",id:106}]]);window.jQuery.fn.selection=function(){var t,e,n;if(null==this[0].selectionStart){var i=document.selection;if("textarea"!=this[0].tagName.toLowerCase()){var o,s=this.val();(o=i.createRange().duplicate()).moveEnd("character",s.length),t=""==o.text?s.length:s.lastIndexOf(o.text),(o=i.createRange().duplicate()).moveStart("character",-s.length),e=o.text.length}else(n=(o=i.createRange()).duplicate()).moveToElementText(this[0]),n.setEndPoint("EndToEnd",o),e=(t=n.text.length-o.text.length)+o.text.length}else t=this[0].selectionStart,e=this[0].selectionEnd;return{start:t,end:e,text:this[0].value.substring(t,e)}};const pe=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio>0&&(window.$(t.target).removeAttr("at"),pe.unobserve(t.target),fe.getInstance().onAtTipStatus())}))})),ge=/^@.+$/;class fe{constructor(){this.instance=null,this.emitter=new Ht,this.roomUser=[],this.atUser=[],this.atMeUser=[],this.joinUser=[],this.obs=new Map}static getInstance(){return this.instance||(this.instance=new fe),this.instance}initRoomUsers(t){let e=[],n=[];return t&&t.map((t=>{uu.isAnchors2(t.uid)?(t.type=3,e.push(t)):(t.type=4,n.push(t))})),e.concat(n)}initComponent(){this.roomUser=[],this.atUser=[],this.onHide(),qt.get(Ot.getRoomUsers(uu.getCid())).then((t=>{const e=window.$("#at-user-container"),n=[];0==t.error&&(this.roomUser=this.initRoomUsers(t.data),this.roomUser.map((t=>{t.uid&&n.push(this.setAtUser(t))})),n.length?(window.$(".at-user-empty").remove(),e.html(n.join(""))):e.html('<div class="at-user-empty">\n                                    暂无成员\n                                </div>'))}));const t=this;window.$("#at-user-container").unbind("keyup"),window.$("#at-user-container").bind("keyup",(function(e){window.$("#at-user-container").is(":focus")&&("38"==e.keyCode?t.onUp():"40"==e.keyCode?t.onDown():"13"==e.keyCode&&t.onEntry())})),this.onEventListener()}setAtUser(t){let e=1*t.uid,n=t.avatar,i=t.type,o=t.name,s="";return uu.isAnchors2(e)&&(s='<i class="at-user-tag">主持</i>'),uu.inInAllCar(e)&&(s='<i class="at-user-tag">小队</i>'),'<div class="at-user-item" data-uid="'+e+'" data-name="'+o+'" data-type="'+i+'" data-avatar="'+n+'">\n                               <img src="'+n+'" class="at-user-avatar"  onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'">  \n                               <div class="at-user-name">'+o+"</div>  "+s+"\n                            </div>"}updateAtUserList(t){const e=[...window.$(".at-user-item")];if("@"!=t){const n=t.substring(1,t.length).toLowerCase();n&&e.forEach((t=>{-1!=t.dataset.name.toLowerCase().indexOf(n)?window.$(t).show():window.$(t).hide()}))}else e.forEach((t=>{window.$(t).show()}))}getAtUser(){let t=window.$(".chat-input-text textarea").val();const e=[],n=t.match(/@(.+?)\s/g);return n&&n.forEach((t=>{const n=t.substring(1,t.length).trim(),i=this.atUser.find((t=>t.nickName==n));i&&e.push(i)})),e}addAtUser(t){t&&this.roomUser.find((e=>{if(e.uid==t)return this.atUser.push({nickName:e.name,userId:e.uid})}))}clearAtUser(){this.atUser=[]}onEntry(){const t=window.$(".chat-input-text textarea"),e=t.selection().start;let n=t.val();const i=n.lastIndexOf("@",e),o=n.indexOf(" ",e),s=window.$(".at-user-item.selected").length?window.$(".at-user-item.selected")[0]:window.$(".at-user-item:visible")[0],a=s?s.dataset.name:null,r=s?s.dataset.uid:null;if(!a)return window.$("#at-user-container").hide(),void window.$(".chat-input-text textarea").focus();if(-1==o)window.$(".chat-input-text textarea").val(n.substring(0,i)+"@"+a+" ");else{const t=n.substring(0,i)+"@"+a+" "+n.substring(o,n.length);window.$(".chat-input-text textarea").val(t)}this.addAtUser(r),window.$("#at-user-container").hide(),window.$(".chat-input-text textarea").focus()}onUp(){const t=window.$(".at-user-item.selected").length?window.$(".at-user-item.selected")[0]:window.$(".at-user-item:visible")[0];0!=window.$(".at-user-item.selected").length?window.$(t).prevAll(":visible").length&&(window.$(".at-user-item.selected").removeClass("selected"),window.$(t).prevAll(":visible").first().addClass("selected")):window.$(t).addClass("selected")}onDown(){const t=window.$(".at-user-item.selected").length?window.$(".at-user-item.selected")[0]:window.$(".at-user-item:visible")[0];0!=window.$(".at-user-item.selected").length?window.$(t).nextAll(":visible").length&&(window.$(".at-user-item.selected").removeClass("selected"),window.$(t).nextAll(":visible").first().addClass("selected")):window.$(t).addClass("selected")}onHide(){window.$("#at-user-container").hide()}onEventListener(){window.$("#chatAtmessage").click((()=>{let t=window.$(".chat-text-content[at]").eq(0),e=window.$(".chat-center-window-main");window.$(".chat-center-window-main").scrollTop(t.offset().top-e.offset().top+e.scrollTop()),window.$(t).removeAttr("at"),this.onAtTipStatus()})),window.$("#at-user-container").click(".at-user-item",(t=>{window.$(".at-user-item.selected").removeClass("selected"),window.$(".at-user-item:hover").addClass("selected"),this.onEntry()})),window.$(".chat-huiyuan-at-btn").click((()=>{this.onEntry()}))}onPushObserve(t){this.obs.set(t,t)}onObserve(){this.obs.forEach((t=>{pe.observe(window.$("[at='"+t+"']")[0]),this.obs.delete(t)})),fe.getInstance().onAtTipStatus()}isWindowHidden(){return"function"!=typeof document.hasFocus?document.hidden:!document.hasFocus()}onAtTipStatus(){const t=window.$(".chat-center-window-main"),e=t.scrollTop(),n=window.$(".chat-text-content[at]");if(n&&0!=n.length){e>=n.offset().top-t.offset().top+t.scrollTop()?window.$("#chatAtmessage").addClass("down"):window.$("#chatAtmessage").removeClass("down"),window.$("#chatAtmessage").show()}else window.$("#chatAtmessage").hide()}onInputLinster(t,e){const n=window.$(".chat-input-text textarea").selection().start,i=this,o=e.lastIndexOf("@",n),s=e.indexOf(" ",n);e.lastIndexOf("@",o-1);const a=e.lastIndexOf(" ",n);if(window.$("#at-user-container").is(":visible"))if("38"==t.keyCode)i.onUp(),window.$("#at-user-container").focus(),window.$(".chat-input-text textarea").blur();else if("40"==t.keyCode)i.onDown(),window.$("#at-user-container").focus(),window.$(".chat-input-text textarea").blur();else if("13"==t.keyCode)i.onEntry();else{if("8"==t.keyCode){if(window.$(".at-user-item.selected").removeClass("selected"),-1!=o&&-1!=s||window.$("#at-user-container").hide(),n>o&&n<s){const t=e.substring(0,o)+e.substring(s,e.length);return window.$(".chat-input-text textarea").val(t),void window.$("#at-user-container").hide()}return}"32"==t.keyCode?-1!=o&&(i.onEntry(),e=window.$(".chat-input-text textarea").val()):window.$(".at-user-item.selected").removeClass("selected")}else if("8"==t.keyCode){if(window.$(".at-user-item.selected").removeClass("selected"),-1!=o&&-1!=s||window.$("#at-user-container").hide(),n>o&&n<s){const t=e.substring(0,o)+e.substring(s,e.length);return window.$(".chat-input-text textarea").val(t),void window.$("#at-user-container").hide()}return}if(o==a+1){const t=null!=e?e.substring(o,e.length):"";if(-1!=t.indexOf("@")||"@"==t){window.$("#at-user-container").is(":hidden")&&(window.$("#at-user-container").show(),"@"==t&&window.$("#at-user-container").scrollTop(0));const e=t.match(ge);this.updateAtUserList(e?e[0]:"@")}else window.$("#at-user-container").hide()}}isAtMe(t){if(t){return null!=[...t].find((t=>t.userId==uu.getSelfInfo().uid))}return!1}addAtTag(){this.isWindowHidden()&&this.onShowTips()}onShowTips(){window.$("#chatAtmessage").addClass("down"),window.$("#chatAtmessage").show()}makeTeamData(t){let e=[],n=[];for(let i=0;i<t.length;i++)if(t[i]&&t[i].uids&&t[i].uids.find((t=>t==uu.getSelfInfo().uid))){n=t[i].uids;break}return[...n].forEach((t=>{let n=window.$(".at-user-item[data-uid="+t+"]")[0];n&&e.push({uid:n.dataset.uid,name:n.dataset.name,avatar:n.dataset.avatar})})),e}onActionAt2Me(){}onActionTeamUpdate(){let t=window.$(".at-user-item[data-type=2]"),e=new Map;[...t].forEach((t=>{t&&t.dataset&&e.set(t.dataset.uid,{uid:t.dataset.uid,avatar:t.dataset.avatar,name:t.dataset.name})})),window.$(".at-user-item[data-type=2]").remove();const n=window.$("#at-user-container"),i=window.$(".at-user-item[data-type=1]");if(uu.getInAllCar().forEach((t=>{if(uu.getSelfInfo().uid==t.uid)return;const o=window.$(".at-user-item[data-uid="+t.uid+"]")[0];if(e.delete(t.uid),o)if(3==o.dataset.type||4==o.dataset.type)o.remove();else if(1==o.dataset.type)return;i.length?(t.type=2,i.after(this.setAtUser(t))):(t.type=2,n.prepend(this.setAtUser(t)))})),e.size){t=window.$(".at-user-item[data-type=2]");for(let[o,s]of e){window.$(".at-user-item[data-uid="+s.uid+"]")[0]||(uu.isAnchors2(s.uid)?(s.type=3,t.length?t.after(this.setAtUser(s)):i.length?i.after(this.setAtUser(s)):n.prepend(this.setAtUser(s))):(s.type=4,n.append(this.setAtUser(s))))}}}onActionJoin(){const t=window.$("#at-user-container"),e=window.$(".at-user-item[data-type=1]"),n=window.$(".at-user-item[data-type=2]");this.joinUser.forEach((i=>{if(uu.getSelfInfo().uid==i.uid)return;window.$(".at-user-empty").remove();window.$(".at-user-item[data-uid="+i.uid+"]").length||(uu.isAnchors2(i.uid)?n.length?(i.type=3,n.after(this.setAtUser(i))):e.length?(i.type=3,e.after(this.setAtUser(i))):(i.type=3,t.prepend(this.setAtUser(i))):(i.type=4,t.append(this.setAtUser(i))),this.roomUser.push(i))})),this.joinUser=[]}}function we(t,e,n=document.body){let i=new t({target:n,props:c({closeModal:o},e)});function o(){null==i||i.$destroy(),i=null}return{modal:i,closeModal:o}}function ve(t){let e,n,i,o;const s={c:function(){e=_("img"),y(e,"alt",""),y(e,"class",t[2]),y(e,"style",t[1]),L(e.src,n=t[0])||y(e,"src",n),x(e,"src/js/components/img.svelte",9,0,124)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(n,s){b(n,e,s),i||(o=E(e,"click",B(t[3]),!1,!1,!0,!1),i=!0)},p:function(t,[i]){2&i&&y(e,"style",t[1]),1&i&&!L(e.src,n=t[0])&&y(e,"src",n)},i:k,o:k,d:function(t){t&&C(e),i=!1,o()}};return p("SvelteRegisterBlock",{block:s,id:ve.name,type:"component",source:"",ctx:t}),s}function _e(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Img",i,[]);let{src:s}=e,{style:a=""}=e;const{class:r}=e;return t.$$.on_mount.push((function(){void 0!==s||"src"in e||t.$$.bound[t.$$.props.src]||console.warn("<Img> was created without expected prop 'src'")})),t.$$set=t=>{n(4,e=j(j({},e),D(t))),"src"in t&&n(0,s=t.src),"style"in t&&n(1,a=t.style)},t.$capture_state=()=>({src:s,style:a,className:r}),t.$inject_state=t=>{n(4,e=j(j({},e),t)),"src"in e&&n(0,s=t.src),"style"in e&&n(1,a=t.style)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),e=D(e),[s,a,r,function(e){F.call(this,t,e)}]}class ye extends h{constructor(t){super(t),u(this,t,_e,ve,g,{src:0,style:1}),p("SvelteRegisterComponent",{component:this,tagName:"Img",options:t,id:ve.name})}get src(){throw new Error("<Img>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set src(t){throw new Error("<Img>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get style(){throw new Error("<Img>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set style(t){throw new Error("<Img>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class xe{static showModal(){const t=this.initStyle(),e=window.$('\n            <div class="diamond_2_gold_modal">\n                <div class="body">\n                    <img class="closeBtn" src="https://dynamics-share.tuwan.com/activity/61e984620fa223ffa8feedd55a55c7b5.png"/>\n                    <p class="title">金币充值</p>\n                    <div class="items flex flex-warp">\n                    </div>\n                    <p class="buyBtn">购买</p>\n                </div>\n            </div>\n        ');$(document.body).append(e),qt.get(Ot.getShopCoinsList()).then((t=>{if(0==t.error){const n=t.data.list.map(((t,e)=>`\n                    <div class="item flex flex-dir-col flex-ac ${0==e?"selected":""}" data-money="${t.money}" data-price="${t.price}">\n                        <img class="gold_icon" style="height: 90px;" src="${t.icon}"/>\n                        <p class="gold_num">${t.moneyTitle}金币</p>\n                        <div class="diamond_num flex flex-ac" style="margin-top: 20px;">\n                            <img src="https://dynamics-share.tuwan.com/activity/d61b0e6d95dfbc95bab887c0595b334f.png"/>\n                            <p>${t.price}</p>\n                        </div>\n                    </div>\n                `)).join("");e.find(".items").append(n),e.find(".item").on("click",(function(t){t.stopPropagation(),e.find(".item").removeClass("selected"),window.$(this).addClass("selected")}))}})),e.find(".closeBtn").on("click",(function(n){n.stopPropagation(),t.remove(),e.remove()}));const n=Ct.preventQuickClick(2e3);e.find(".buyBtn").on("click",(function(t){t.stopPropagation(),n((()=>{const t=e.find(".item.selected").data();qt.get(Ot.getShopBuyCoins(t.money,t.price)).then((t=>{0==t.error?Vt("兑换成功"):-2==t.error?window.open(Ot.getRechargeUrl()):Vt(t.error_msg)}))}))}))}static initStyle(){const t=$("\n            <style>\n                .diamond_2_gold_modal {\n                    position: fixed;\n                    left: 0;\n                    top: 0;\n                    width: 100%;\n                    height: 100%;\n                    background-color: rgba(0, 0, 0, 0.6);\n                    z-index: 9999;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .diamond_2_gold_modal .body {\n                    position: relative;\n                    width: 420px;\n                    padding: 20px 0;\n                    min-height: 300px;\n                    background: white;\n                    border-radius: 10px;\n                    overflow: hidden;\n                }\n\n                .diamond_2_gold_modal .body .closeBtn {\n                    position: absolute;\n                    right: 20px;\n                    top: 26px;\n                    width: 20px;\n                    cursor: pointer;\n                }\n\n                .diamond_2_gold_modal .body .title {\n                    font-size: 24px;\n                    font-weight: 500;\n                    color: #333333;\n                    text-align: center;\n                    margin-bottom: 20px;\n                }\n\n                .diamond_2_gold_modal .body .items {\n                    margin-left: 20px;\n                    min-height: 374px;\n                }\n\n                .diamond_2_gold_modal .body .items .item {\n                    background-image: repeating-linear-gradient(to bottom, #F8F9FD, #F8F9FD 75%, #ffffff 75%, #ffffff 100%);\n                    width: 120px;\n                    margin-right: 10px;\n                    margin-bottom: 15px;\n                    border-radius: 6px;\n                    padding-top: 5px;\n                    padding-bottom: 10px;\n                    border: 1px solid #F0EFF5;\n                    cursor: pointer;\n                }\n\n                .diamond_2_gold_modal .body .items .item.selected {\n                    background-image: repeating-linear-gradient(to bottom, #FFE1E9, #FFE1E9 75%, #ffffff 75%, #ffffff 100%);\n                    border: 1px solid #FF6691;\n                }\n\n                .diamond_2_gold_modal .body .items .item .gold_num {\n                    font-size: 14px;\n                    font-weight: bold;\n                    color: #999999;\n                }\n\n                .diamond_2_gold_modal .body .items .item .diamond_num img {\n                    width: 20px;\n                }\n\n                .diamond_2_gold_modal .body .items .item .diamond_num p {\n                    font-size: 18px;\n                    font-weight: 500;\n                    color: #333333;\n                }\n\n                .buyBtn {\n                    margin: 0 30px;\n                    line-height: 50px;\n                    background: #FF6691;\n                    border-radius: 50px;\n                    font-size: 20px;\n                    font-weight: 500;\n                    color: #FFFFFF;\n                    text-align: center;\n                    margin-top: 20px;\n                    cursor: pointer;\n                }\n            </style>\n        ");return window.$("head").append(t),t}}const be="src/js/emojiPackage/modal.svelte";function $e(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A=t[1].fee+"",j=t[1].allSetFee+"";a=new ye({props:{src:t[1].charge==Se?"https://dynamics-share.tuwan.com/activity/e56b10e9564627f897025992cd6d84db.png":"https://dynamics-share.tuwan.com/activity/fe7b7db7fe3bd62880e3a1872ff9da1d.png"},$$inline:!0}),f=new ye({props:{src:t[1].charge==Se?"https://dynamics-share.tuwan.com/activity/e56b10e9564627f897025992cd6d84db.png":"https://dynamics-share.tuwan.com/activity/fe7b7db7fe3bd62880e3a1872ff9da1d.png"},$$inline:!0});const D={c:function(){e=_("div"),n=_("div"),i=_("p"),i.textContent="一个",o=T(),s=_("div"),U(a.$$.fragment),r=T(),c=_("p"),l=M(A),d=T(),m=_("div"),h=_("p"),h.textContent="一套",u=T(),g=_("div"),U(f.$$.fragment),w=T(),v=_("p"),$=M(j),y(i,"class","btn blue s-HyQBUmpPPC1L"),x(i,be,73,20,2317),y(c,"class","s-HyQBUmpPPC1L"),x(c,be,76,24,2690),y(s,"class","price flex flex-ac flex-jc s-HyQBUmpPPC1L"),x(s,be,74,20,2398),y(n,"class","buy_type"),x(n,be,72,16,2274),y(h,"class","btn s-HyQBUmpPPC1L"),x(h,be,80,20,2817),y(v,"class","s-HyQBUmpPPC1L"),x(v,be,83,24,3185),y(g,"class","price flex flex-ac flex-jc s-HyQBUmpPPC1L"),x(g,be,81,20,2893),y(m,"class","buy_type"),x(m,be,79,16,2774),y(e,"class","btns flex flex-ac flex-between margin-40 s-HyQBUmpPPC1L"),x(e,be,71,12,2203)},m:function(p,_){b(p,e,_),I(e,n),I(n,i),I(n,o),I(n,s),z(a,s,null),I(s,r),I(s,c),I(c,l),I(e,d),I(e,m),I(m,h),I(m,u),I(m,g),z(f,g,null),I(g,w),I(g,v),I(v,$),k=!0,S||(R=[E(i,"click",B(t[3]),!1,!1,!0,!1),E(h,"click",B(t[4]),!1,!1,!0,!1)],S=!0)},p:function(t,e){const n={};2&e&&(n.src=t[1].charge==Se?"https://dynamics-share.tuwan.com/activity/e56b10e9564627f897025992cd6d84db.png":"https://dynamics-share.tuwan.com/activity/fe7b7db7fe3bd62880e3a1872ff9da1d.png"),a.$set(n),(!k||2&e)&&A!==(A=t[1].fee+"")&&P(l,A);const i={};2&e&&(i.src=t[1].charge==Se?"https://dynamics-share.tuwan.com/activity/e56b10e9564627f897025992cd6d84db.png":"https://dynamics-share.tuwan.com/activity/fe7b7db7fe3bd62880e3a1872ff9da1d.png"),f.$set(i),(!k||2&e)&&j!==(j=t[1].allSetFee+"")&&P($,j)},i:function(t){k||(q(a.$$.fragment,t),q(f.$$.fragment,t),k=!0)},o:function(t){O(a.$$.fragment,t),O(f.$$.fragment,t),k=!1},d:function(t){t&&C(e),G(a),G(f),S=!1,V(R)}};return p("SvelteRegisterBlock",{block:D,id:$e.name,type:"else",source:"(71:8) {:else}",ctx:t}),D}function ke(t){let e,n,i,o,s;const a={c:function(){e=_("p"),e.textContent="升级爵位",n=T(),i=_("p"),i.textContent="升级后解锁整套表情",y(e,"class","btn margin-40 s-HyQBUmpPPC1L"),A(e,"width","280px"),x(e,be,68,12,2032),y(i,"class","upgrade_desc s-HyQBUmpPPC1L"),x(i,be,69,12,2137)},m:function(a,r){b(a,e,r),b(a,n,r),b(a,i,r),o||(s=E(e,"click",B((function(){H(t[2])&&t[2].apply(this,arguments)})),!1,!1,!0,!1),o=!0)},p:function(e,n){t=e},i:k,o:k,d:function(t){t&&C(e),t&&C(n),t&&C(i),o=!1,s()}};return p("SvelteRegisterBlock",{block:a,id:ke.name,type:"if",source:"(68:8) {#if data.charge == TYPE_1}",ctx:t}),a}function Ce(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w=t[1].title+"",v=t[1].desc+"";i=new ye({props:{class:"logo",src:t[1].url},$$inline:!0});const $=[ke,$e],k=[];function S(t,e){return t[1].charge==Ie?0:1}m=S(t),h=k[m]=$[m](t);const R={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),a=M(w),r=T(),c=_("p"),l=M(v),d=T(),h.c(),y(s,"class","name s-HyQBUmpPPC1L"),x(s,be,65,8,1911),y(c,"class","desc s-HyQBUmpPPC1L"),x(c,be,66,8,1952),y(n,"class","body flex flex-dir-col flex-ac s-HyQBUmpPPC1L"),x(n,be,63,4,1788),y(e,"class","emoji_buy_modal s-HyQBUmpPPC1L"),x(e,be,62,0,1716)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,p){b(h,e,p),I(e,n),z(i,n,null),I(n,o),I(n,s),I(s,a),I(n,r),I(n,c),I(c,l),I(n,d),k[m].m(n,null),u=!0,g||(f=[E(n,"click",B(t[7]),!1,!1,!0,!1),E(e,"click",B((function(){H(t[0])&&t[0].apply(this,arguments)})),!1,!1,!0,!1)],g=!0)},p:function(e,[o]){t=e;const s={};2&o&&(s.src=t[1].url),i.$set(s),(!u||2&o)&&w!==(w=t[1].title+"")&&P(a,w),(!u||2&o)&&v!==(v=t[1].desc+"")&&P(l,v);let r=m;m=S(t),m===r?k[m].p(t,o):(W(),O(k[r],1,1,(()=>{k[r]=null})),N(),h=k[m],h?h.p(t,o):(h=k[m]=$[m](t),h.c()),q(h,1),h.m(n,null))},i:function(t){u||(q(i.$$.fragment,t),q(h),u=!0)},o:function(t){O(i.$$.fragment,t),O(h),u=!1},d:function(t){t&&C(e),G(i),k[m].d(),g=!1,V(f)}};return p("SvelteRegisterBlock",{block:R,id:Ce.name,type:"component",source:"",ctx:t}),R}const Ie=1,Se=2;function Te(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Modal",i,[]);let{closeModal:s}=e,{data:a}=e,{typeid:r=""}=e,{showLoginWindow:c}=e,{upgradeCb:l}=e;function d(){return!(uu.getMeid()>Mt.maxUID)||(c&&c(),!1)}const m=Ct.preventQuickClick(2e3);function h(t){d()&&m((()=>{qt.get(t).then((t=>{0==t.error?(s&&s(),Ae.getInstance().updateOfficialEmojiList(r)):-2==t.error?3==a.charge?xe.showModal():window.open(Ot.getRechargeUrl()):Vt(t.error_msg)}))}))}function u(){h(Ot.getBuyEmoji(a.id))}function p(){h(Ot.getBuyAllSetEmoji(r))}t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<Modal> was created without expected prop 'closeModal'"),void 0!==a||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Modal> was created without expected prop 'data'"),void 0!==c||"showLoginWindow"in e||t.$$.bound[t.$$.props.showLoginWindow]||console.warn("<Modal> was created without expected prop 'showLoginWindow'"),void 0!==l||"upgradeCb"in e||t.$$.bound[t.$$.props.upgradeCb]||console.warn("<Modal> was created without expected prop 'upgradeCb'")}));const g=["closeModal","data","typeid","showLoginWindow","upgradeCb"];return Object.keys(e).forEach((t=>{~g.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Modal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"data"in t&&n(1,a=t.data),"typeid"in t&&n(5,r=t.typeid),"showLoginWindow"in t&&n(6,c=t.showLoginWindow),"upgradeCb"in t&&n(2,l=t.upgradeCb)},t.$capture_state=()=>({Img:ye,common:uu,request:qt,ChatUrls:Ot,ChatConfig:Mt,showTips:Vt,ChatEmoji:Ae,Diamond2gold:xe,Utils:Ct,closeModal:s,data:a,typeid:r,showLoginWindow:c,upgradeCb:l,TYPE_1:Ie,TYPE_2:Se,TYPE_3:3,loginVerity:d,fn_nbb:m,buy:h,buyOne:u,buyAll:p}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"data"in t&&n(1,a=t.data),"typeid"in t&&n(5,r=t.typeid),"showLoginWindow"in t&&n(6,c=t.showLoginWindow),"upgradeCb"in t&&n(2,l=t.upgradeCb)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,l,u,p,r,c,function(e){F.call(this,t,e)}]}class Re extends h{constructor(t){super(t),u(this,t,Te,Ce,g,{closeModal:0,data:1,typeid:5,showLoginWindow:6,upgradeCb:2}),p("SvelteRegisterComponent",{component:this,tagName:"Modal",options:t,id:Ce.name})}get closeModal(){throw new Error("<Modal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<Modal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<Modal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Modal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get typeid(){throw new Error("<Modal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set typeid(t){throw new Error("<Modal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showLoginWindow(){throw new Error("<Modal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showLoginWindow(t){throw new Error("<Modal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get upgradeCb(){throw new Error("<Modal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set upgradeCb(t){throw new Error("<Modal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class Me{constructor(){this.showLoginWindow=null,this.showLevelModal=null}static getInstance(){return this.instance||(this.instance=new Me),this.instance}showModal(t,e){we(Re,{data:t,typeid:e,showLoginWindow:this.showLoginWindow,upgradeCb:this.showLevelModal})}}class Ae{constructor(){this.instance=null,this.emitter=new Ht,this.emojiIcon=[],this.currentEmojiId=null,this.page=1,this.isLoading=!1,this.loadMore=!0,this.initialized=!1}static getInstance(){return this.instance||(this.instance=new Ae),this.instance}buildEmoji(t){const e=t.match(/\[([^\]\[]*)\]/g)||[],n=this.getEmojiList();for(let i=0,o=e.length;i<o;i++)n[e[i]]&&(t=t.replace(e[i],'<img style="width:24px;" class="emoji" src="https://res.tuwan.com/templet/play/chat/images/emoji/'+n[e[i]].file+'" />'));return t}getEmojiList(){return{"[爱心]":{file:"emoji0@2x.png"},"[笑脸]":{file:"emoji1@2x.png"},"[露齿笑]":{file:"emoji2@2x.png"},"[破涕为笑]":{file:"emoji3@2x.png"},"[笑]":{file:"emoji4@2x.png"},"[开心]":{file:"emoji5@2x.png"},"[冷汗]":{file:"emoji6@2x.png"},"[狂笑]":{file:"emoji7@2x.png"},"[眨眼]":{file:"emoji8@2x.png"},"[愉快]":{file:"emoji9@2x.png"},"[吐舌头]":{file:"emoji10@2x.png"},"[酷]":{file:"emoji11@2x.png"},"[色]":{file:"emoji12@2x.png"},"[接吻]":{file:"emoji13@2x.png"},"[噘嘴]":{file:"emoji14@2x.png"},"[亲亲]":{file:"emoji15@2x.png"},"[害羞]":{file:"emoji16@2x.png"},"[大笑]":{file:"emoji17@2x.png"},"[微笑]":{file:"emoji18@2x.png"},"[抱抱]":{file:"emoji19@2x.png"},"[天使]":{file:"emoji20@2x.png"},"[疑惑]":{file:"emoji21@2x.png"},"[呵呵]":{file:"emoji22@2x.png"},"[无奈]":{file:"emoji23@2x.png"},"[面无表情]":{file:"emoji24@2x.png"},"[白眼]":{file:"emoji25@2x.png"},"[得意]":{file:"emoji26@2x.png"},"[委屈]":{file:"emoji27@2x.png"},"[焦虑]":{file:"emoji28@2x.png"},"[哦]":{file:"emoji29@2x.png"},"[闭嘴]":{file:"emoji30@2x.png"},"[哦哦]":{file:"emoji31@2x.png"},"[打哈欠]":{file:"emoji32@2x.png"},"[愁]":{file:"emoji33@2x.png"},"[睡觉]":{file:"emoji34@2x.png"},"[悠闲]":{file:"emoji35@2x.png"},"[文学]":{file:"emoji36@2x.png"},"[俏皮]":{file:"emoji37@2x.png"},"[捣蛋]":{file:"emoji38@2x.png"},"[调皮]":{file:"emoji39@2x.png"},"[悔恨]":{file:"emoji40@2x.png"},"[紧张]":{file:"emoji41@2x.png"},"[无语]":{file:"emoji42@2x.png"},"[汗]":{file:"emoji43@2x.png"},"[不开心]":{file:"emoji44@2x.png"},"[呸]":{file:"emoji45@2x.png"},"[苦恼]":{file:"emoji46@2x.png"},"[倒脸]":{file:"emoji47@2x.png"},"[生病]":{file:"emoji48@2x.png"},"[发烧]":{file:"emoji49@2x.png"},"[抗揍]":{file:"emoji50@2x.png"},"[爱钱]":{file:"emoji51@2x.png"},"[吃惊]":{file:"emoji52@2x.png"},"[失望]":{file:"emoji53@2x.png"},"[撇嘴]":{file:"emoji54@2x.png"},"[生气]":{file:"emoji55@2x.png"},"[眼泪]":{file:"emoji56@2x.png"},"[流泪]":{file:"emoji57@2x.png"},"[困惑]":{file:"emoji58@2x.png"},"[震惊]":{file:"emoji59@2x.png"},"[发呆]":{file:"emoji60@2x.png"},"[忧愁]":{file:"emoji61@2x.png"},"[呲牙]":{file:"emoji62@2x.png"},"[尴尬]":{file:"emoji63@2x.png"},"[惊恐]":{file:"emoji64@2x.png"},"[红脸]":{file:"emoji65@2x.png"},"[晕]":{file:"emoji66@2x.png"},"[发怒]":{file:"emoji67@2x.png"},"[心烦]":{file:"emoji68@2x.png"},"[恶魔]":{file:"emoji69@2x.png"},"[鬼魂]":{file:"emoji70@2x.png"},"[红唇]":{file:"wenhen@2x.png"},"[信封]":{file:"xinfeng@2x.png"},"[睡觉声]":{file:"zzz@2x.png"}}}initEmojiHtml(){if(this.initialized)return void this.updateDefaultList();this.initialized=!0;window.$(".chat-emoji-list").html('<div class="emoji_list_menu">\n                        <div class="set_top_custom">置顶</div>\n                        <div class="delete_custom">删除</div>\n                    </div>\n                    <div class="emoji_nav_content"></div>'),this.initEmojiEvent(),this.getOfficialEmojiNav().then((t=>{window.$(".emoji_list_menu").before(t),this.updateDefaultList()}))}updateDefaultList(){let t=bt.getItem("chat_emoji_id")||this.emojiIcon[0].id;0==window.$(`.common_emoji_list_item[data-type="${t}"]`).length&&(t=this.emojiIcon[0].id,bt.setItem("chat_emoji_id",null)),this.renderEmojiData(t)}renderEmojiData(t){if("default"==t);else if("custom"==t)this.getCustomEmoji(1,1);else{const e=window.$(`.common_emoji_list_item[data-type="${t}"]`);(0==e.find("div.official_emoji_item").length||e.data().charge>0)&&this.updateOfficialEmojiList(t)}window.$(".common_emoji_list_item").hide(),window.$(".emoji_nav_content").html(this.renderEmojiNav(t)),window.$(`.common_emoji_list_item[data-type="${t}"]`).css("display","flex")}updateOfficialEmojiList(t){this.getOfficialEmoji(t).then((e=>{window.$(`.common_emoji_list_item[data-type="${t}"]`).html(e)}))}getOfficialEmojiNav(){return new Promise(((t,e)=>{qt.get(Pt+"/playface/showmenu?newVersion=2").then((e=>{if(0==e.error){let n=e.data,i="";n.forEach((t=>{3==t.type_id?t.type_id="default":4==t.type_id&&(t.type_id="custom");const e={id:t.type_id,img:t.img,imgs:t.select_img};this.emojiIcon.push(e),"default"==t.type_id?i+=`<div class="default_emoji_list common_emoji_list_item" data-type="default">${this.renderDefaultEmoji()}</div>`:"custom"==t.type_id?(i+='<div class="custom_emoji_list common_big_emoji_list common_emoji_list_item" data-type="custom"></div>',setTimeout((()=>{this.registerScrollEvent()}),100)):i+=`<div class="Official_emoji_list common_big_emoji_list common_emoji_list_item" data-type="${t.type_id}" data-charge="${t.charge}" ></div>`})),t(i)}}))}))}getOfficialEmoji(t){return new Promise(((e,n)=>{qt.get(Pt+`/playface/getlistbytype?type_id=${t}`).then((n=>{if(0==n.error){let i=[],o=n.data;if(o.length>0)for(let e=0,n=o.length;e<n;e++){const n=1==o[e].locked;let s=o[e].url;n&&s.indexOf(".gif")>=0&&(s.indexOf("?")<0?s+="?":s+="&",s+="x-oss-process=image/format,png/ignore-error,1"),i.push(`\n                                <div class="flex official_emoji_item" data-ratio="${o[e].ratio}" data-url="${o[e].url}" data-id="${o[e].id}" data-is_wheat="${o[e].is_wheat}" data-jsondata="${encodeURIComponent(JSON.stringify(o[e]))}" data-typeid="${t}">\n                                    <img class="logo ${n?"lock":""}" src="${s}">\n                                    ${n?'<img class="icon_lock" src="https://dynamics-share.tuwan.com/activity/b11b5c772d984663abd5eab234480508.png"/>':""}\n                                </div>\n                            `)}e(i.join(""))}}))}))}getCustomEmoji(t,e){qt.get(Pt+`/playface/getlist?page=${t}`).then((t=>{let n=[];if(0==t.error){let i=t.data;if(1==e&&n.push('<div class="flex add_emoji_item">\n                                        <form action="#" id="uploadEmojiForm">\n                                            <input id="uploadCustomEmoji" type="file" name="">\n                                        </form>\n                                        <img src="https://asset.tuwan.com/chatroom/images/add_emoji.png">\n                                    </div>'),i.length>0){for(let t=0,e=i.length;t<e;t++)n.push(`<div class="flex custom_emoji_item" data-ratio="${i[t].ratio}" data-url="${i[t].url}" data-id="${i[t].id}">\n                                            <img class="logo" src="${i[t].url}">\n                                        </div>`);window.$(".empty_emoji").remove()}else this.loadMore=!1,1==e&&n.push('<img class="empty_emoji" src="https://res.tuwan.com/templet/play/chat/chatv2/images/emptyEmoji.png">');1==e?(this.page=1,this.loadMore=!0,window.$(".custom_emoji_list").html(n.join(""))):window.$(".custom_emoji_list").append(n.join(""))}else this.loadMore=!1,1==e&&window.$(".custom_emoji_list").html('<img class="empty_emoji" src="https://res.tuwan.com/templet/play/chat/chatv2/images/emptyEmoji.png">');this.isLoading=!1}))}renderEmojiNav(t){let e=[];for(let n=0,i=this.emojiIcon.length;n<i;n++){const i=this.emojiIcon[n];e.push(`<div class="${i.id==t?"actived":""} emoji_nav_item" data-type="${i.id}">\n                            <img style="width: 26px;" src="${i.id==t?i.imgs:i.img}">\n                        </div>`)}return e.join("")}addToCustom(t){qt.get(Pt+`/playface/add?url=${t}`).then((t=>{this.getCustomEmoji(1,1),Vt(t.error_msg)}))}renderDefaultEmoji(){const t=this.getEmojiList();let e=[];for(var n of Object.keys(t))e.push('<div class="flex chat-emoji-item" title="'+n+'" text="'+n+'" val="'+t[n].file+'">\n                                <img src="https://res.tuwan.com/templet/play/chat/images/emoji/'+t[n].file+'">\n                            </div>');return e.join("")}initEmojiEvent(){const t=this,e=window.$(".chat-emoji-list");e.on("click",".chat-emoji-item",(function(t){const e=window.$(this).attr("text");if("[骰子]"==e)return void qt.get(Pt+"/Game/dice?cid="+uu.getCid()+"&format=jsonp").then((t=>{0!=t.error&&Ct.Alert(t.error_msg)}));const n=window.$(".chat-input-text textarea").val();window.$(".chat-input-text textarea").val(n+e)})),e.on("click",".add_emoji_item",(function(e){e.stopPropagation(),uu.getMeid()>Mt.maxUID&&t.emitter.emit("showLoginWindow")})),e.on("change","input[type='file']",(function(){Ct.uploadImage(document.getElementById("uploadCustomEmoji"),(function(e){qt.post(Ot.uploadImage(),{img:e}).then((e=>{if(0==e.error){const{thumb:n,image:i,ratio:o}=e.data;t.addToCustom(n)}else Ct.Alert(e.msg);window.$("#uploadEmojiForm").get(0).reset()}))}))})),e.on("click",".emoji_nav_item",(function(e){e.stopPropagation();const n=this.dataset.type;bt.setItem("chat_emoji_id",n),t.renderEmojiData(n)})),e.bind("contextmenu",(function(t){return!1})),e.on("mousedown",".custom_emoji_item",(function(e){if(2==e.button){window.$(".emoji_list_menu").hide();const n=e.clientX,i=e.clientY;window.$(".emoji_list_menu").css({display:"block",top:`${i+5}px`,left:`${n+10}px`}),t.currentEmojiId=this.dataset.id}})),e.on("click",".custom_emoji_item,.official_emoji_item",(function(){if(1==this.dataset.is_wheat&&window.$(".seat-item-empty[data-uid="+uu.getMeid()+"]").length>0)return;let e=!1;if(this.dataset.jsondata){const t=JSON.parse(decodeURIComponent(this.dataset.jsondata));if(e=t.charge>0,1==t.locked)return}t.emitter.emit("sendCustomEmoji",this.dataset.url,this.dataset.url,this.dataset.ratio,e)})),e.on("click",".official_emoji_item",(function(t){const e=JSON.parse(decodeURIComponent(this.dataset.jsondata));if(e.charge>0&&1==e.locked)return t.stopPropagation(),void Me.getInstance().showModal(e,this.dataset.typeid);qt.get(Ot.getFaceAfterSend(this.dataset.id,uu.getCid(),window.$(this).parent().data().type))})),e.on("click",".set_top_custom",(function(e){e.stopPropagation(),qt.get(Pt+`/playface/top?id=${t.currentEmojiId}`).then((e=>{t.getCustomEmoji(1,1),window.$(".emoji_list_menu").hide()}))})),e.on("click",".delete_custom",(function(e){e.stopPropagation(),qt.get(Pt+`/playface/del?id=${t.currentEmojiId}`).then((e=>{t.getCustomEmoji(1,1),window.$(".emoji_list_menu").hide()}))}))}registerScrollEvent(){const t=this;window.$(".custom_emoji_list").scroll((function(){const e=window.$(this).get(0).scrollHeight;window.$(this).scrollTop()+window.$(this).height()>=e-10&&!t.isLoading&&t.loadMore&&(t.isLoading=!0,t.page++,t.getCustomEmoji(t.page,0))}))}}const Pe=Ae.getInstance(),je={"#000000":[0,0,0],"#FFFFFF":[255,255,255],"#D0001B":[208,0,27],"#FF7A1A":[255,122,26],"#FFDD2A":[255,221,42],"#0B8C02":[11,140,2],"#2872FE":[40,114,254],"#2996CB":[41,150,203],"#6200D5":[98,0,213],"#774317":[119,67,23],"#B7B5B8":[183,181,184],"#FF88BA":[255,136,186]},De=[0,4,6,10,15,20];class Le{constructor(){this.instance=null,this.whiteWebSdk=null,this.whiteRoom=null,this.leaveRoomFn=null,this.emitter=new Ht,this.actionTab=1,this.drawColor16="#000000",this.drawColor=[0,0,0],this.eraserSize=1,this.drawSize=1,this.currSignal=1e3,this.time=0,this.timer=null,this.reflashWord=!1,this.drawUid=0,this.drawUserName=""}static getInstance(){return Le.instance||(this.instance=new Le),this.instance}onDrawFinsh(t){(uu.isDrawRoom()||uu.isDrawTempRoom())&&(window.$(".seat-user-alert").empty(),si.show(".draw_game_modal"),window.$(".whiteboard-action-like").removeClass("like"),window.$(".whiteboard-action-like span").text(""),window.$(".draw_game_title").text("答案:"+t.drawWord),window.$(".draw_game_user_info_avatar").html('<img src="'+t.userHeadImg+'"/>'),window.$(".draw_game_user_info_detail").html(" <div>"+t.userName+"</div><span>"+t.content+"</span>"),window.$(".draw_game_resource").html('<div class="draw_game_loading flex flex-dir-col flex-ac"><img src="https://asset.tuwan.com/chatroom/images/draw_loading.gif"/><span> 作品生成中… </span></div>'),this.drawUid=t.userId,this.drawUserName=t.userName,qt.get(Ot.getLikeStatus(uu.getCid(),this.drawUid)).then((t=>{0==t.error&&(1==t.likeStatus&&window.$(".whiteboard-action-like").addClass("like"),t.likeCount&&window.$(".whiteboard-action-like span").text("+"+t.likeCount))})).catch((t=>{Vt("网络错误请稍后再试..")})))}onResultTop(t){(uu.isDrawRoom()||uu.isDrawTempRoom())&&(window.$(".seat-user-alert").empty(),si.hide(".draw_game_modal"),si.show(".draw_result_modal"),window.$(".draw_result_list").empty(),t.users.map(((t,e)=>{const n=uu.getMeid()==t.userId?"current":"";window.$(".draw_result_list").append('<div class="draw_result_item flex flex-ac '+n+'">\n                    <div class="flex flex-1 flex-ac">\n                        <div class="draw_result_order">'+(e+1)+'</div>\n                        <div class="flex draw_result_user flex-ac">\n                            <div class="draw_result_user_avatar">\n                                <img src="'+t.userHeadImg+'" />\n                            </div>\n                            '+t.userName+'\n                        </div>\n                    </div>\n                    <div class="draw_result_num">\n                        得分：'+t.totalScore+"\n                    </div>\n                </div>")})),this.whiteRoom&&uu.getMeid()==this.drawUid&&this.whiteRoom.cleanCurrentScene(!0))}onCountDown(){window.$(".whiteboard-countdown").removeClass("hide");const t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{t.time>0&&(t.time--,window.$(".whiteboard-countdown span").text(t.time),t.onCountDown())}),1e3)}onShowScore(t,e){1002==t&&(window.$(".seat-item-empty .seat-status").addClass("hide"),si.hide(".draw_game_modal"));(uu.isDrawRoom()?e.data.filter((t=>2!=t.position)):e.data).map((t=>{window.$('.seat-item-empty[data-uid="'+t.uid+'"] .seat-user-name').addClass("hide"),window.$('.seat-item-empty[data-uid="'+t.uid+'"] .seat-user-score-container').removeClass("hide"),window.$('.seat-item-empty[data-uid="'+t.uid+'"] .seat-user-score-container .seat-user-score').text(t.totalScore)})),this.clearPlayingSeat()}clearPlayingSeat(){window.$(".seat-item-empty .seat-close").css("display","none"),window.$(".seat-item-empty .seat-number").css("display","none"),window.$('.seat-item-empty[data-uid="0"] .seat-user-name').text(""),uu.isDrawRoom()?window.$(".seat-item-empty[data-aposition!=2] .seat-svga").addClass("hide"):uu.isDrawTempRoom()&&window.$(".seat-item-empty .seat-svga").addClass("hide")}onGamingResult(t,e){this.onShowScore(t,e),e.data.map((t=>{if(2==t.roleId){const e=window.$('.seat-item-empty[data-uid="'+t.uid+'"]');0==t.guessed||(1==t.guessed?(e.find(".seat-status").removeClass("correct").addClass("wrong").removeClass("hide"),e.find(".seat-user-alert").html('<div class="seat-user-alert-blue">错误</div>')):2==t.guessed&&(e.find(".seat-status").removeClass("wrong").addClass("correct").removeClass("hide"),e.find(".seat-user-alert").html('<div class="seat-user-alert-pink">+'+t.score+"</div>")))}}))}onPrepareing(t,e){window.$(".whiteboard-countdown").addClass("hide"),window.$(".whiteboard-status-title").text("准备阶段"),this.time=parseInt(e.cd);const n=e.data;window.$(".whiteboard-prepare-container").removeClass("hide"),window.$(".whiteboard-word-container").addClass("hide"),window.$(".whiteboard-draw-container").addClass("hide");let i=n.find((t=>2==t.position));if(uu.isNewDrawTempRoom()&&(i=n.find((t=>1==t.owner))),null!=i){if(window.$(".whiteboard-prepare-anchor-header").attr("src",i.avatar),window.$(".whiteboard-prepare-anchor-name").text(i.nickname),""!=uu.roomInfo.cap_role){const t=uu.isNewDrawTempRoom()?"房主":uu.roomInfo.cap_role;window.$(".whiteboard-prepare-anchor-id").text(t).removeClass("hide")}}else window.$(".whiteboard-prepare-anchor-id").addClass("hide"),window.$(".whiteboard-prepare-anchor-header").attr("src","https://res.tuwan.com/templet/play/chat/chatv2/images/addicon.png"),window.$(".whiteboard-prepare-anchor-name").text("虚位以待");if(window.$(".whiteboard-prepare-button").removeClass("hide"),window.$(".whiteboard-prepare-alert").addClass("hide"),null!=i&&i.uid==uu.getSelfInfo().uid)window.$(".whiteboard-prepare-button").text("开始"),window.$(".seat-item-empty[data-uid!=0] .seat-close").css("display","block"),window.$(".whiteboard-prepare-button").removeClass("cancel"),0==e.isAllPrepared?window.$(".whiteboard-prepare-button").addClass("unstart"):window.$(".whiteboard-prepare-button").removeClass("unstart");else{window.$(".whiteboard-prepare-button").removeClass("unstart");const t=n.find((t=>t.uid==uu.getMeid()));null!=t?0==t.setout?(window.$(".whiteboard-prepare-button").removeClass("cancel"),window.$(".whiteboard-prepare-button").text("准备")):1==t.setout&&(window.$(".whiteboard-prepare-button").text("取消"),window.$(".whiteboard-prepare-button").addClass("cancel")):(window.$(".whiteboard-prepare-button").addClass("hide"),window.$(".whiteboard-prepare-alert").removeClass("hide"))}e.data.map((t=>{1==t.setout?window.$('.seat-item-empty[data-uid="'+t.uid+'"] .seat-status').addClass("correct").removeClass("hide"):window.$('.seat-item-empty[data-uid="'+t.uid+'"] .seat-status').removeClass("correct").removeClass("wrong").addClass("hide")})),window.$(".seat-user-alert").empty(),window.$(".seat-user-score-container").addClass("hide"),window.$(".seat-user-name.haveuser").removeClass("hide"),window.$(".seat-svga.hide").removeClass("hide"),uu.isDrawRoom()?window.$(".seat-item-empty[data-aposition!=2] .seat-number").css("display","block"):window.$(".seat-item-empty .seat-number").css("display","block"),window.$('.seat-item-empty[data-uid="0"] .seat-user-name').text("虚位以待"),uu.isAnchoringUser(uu.getMeid())?window.$(".seat-item-empty[data-uid!=0] .seat-close").css("display","block"):(uu.isNewDrawTempRoom()&&window.$(".seat-item-empty[data-uid] .seat-close").css("display","none"),window.$('.seat-item-empty[data-uid="'+uu.getMeid()+'"] .seat-close').css("display","block")),this.onSelectAction()}onInfillWord(t){t.map((t=>{window.$(".whiteboard-word-items").append('<div class="flex flex-jc whiteboard-word-item-wrapper" ><div class="whiteboard-word-item" data-index="'+t.index+'">'+t.word+"</div></div>")}))}onChoiceWord(t){window.$(".whiteboard-status-title").text("选词阶段"),window.$(".whiteboard-prepare-container").addClass("hide"),window.$(".whiteboard-word-container").removeClass("hide"),window.$(".whiteboard-draw-container").addClass("hide"),window.$(".whiteboard-word-items").empty(),this.onInfillWord(t.words),0==t.price?window.$(".whiteboard-word-button span").html("免费"):window.$(".whiteboard-word-button span").html('<img src="https://res.tuwan.com/templet/play/public/images/zuanshi.png">'+t.price+"钻"),this.time=parseInt(t.cd),this.onCountDown(),this.drawColor16="#000000",this.drawColor=[0,0,0],this.eraserSize=1,this.drawSize=1,this.whiteRoom&&(this.whiteRoom.cleanCurrentScene(!0),this.setMemberState({strokeWidth:De[this.drawSize],strokeColor:this.drawColor})),window.$(".whiteboard-result-color").css("background",this.drawColor16),window.$(".whiteboard-result-size").text(this.drawSize),window.$(".whiteboard-result-eraser").text(this.eraserSize),this.onSelectAction()}onChoiceWording(t){t.drawerUserId!=uu.getMeid()&&(this.drawUid=t.drawerUserId,this.drawUserName=t.userName,window.$(".whiteboard-status-title").text("选词中"),window.$(".whiteboard-prepare-container").addClass("hide"),window.$(".whiteboard-word-container").addClass("hide"),window.$(".whiteboard-draw-container").removeClass("hide"),window.$(".whiteboard-choice-word-container").removeClass("hide"),window.$(".whiteboard-choice-word-avatar").html('<img src="'+t.userHeadImg+'"/>'),window.$(".whiteboard-choice-word-title").html("<span>"+t.userName+"</span>正在选词中.."),this.time=parseInt(t.cd),this.onCountDown(),window.$(".seat-item-empty .seat-user-alert").empty(),window.$('.seat-item-empty[data-uid="'+t.drawerUserId+'"] .seat-user-alert').html('<div class="seat-user-alert-pink">选词中</div>'),window.$(".whiteboard-tools-action").addClass("hide"),window.$(".whiteboard-tools-thumbs-up").removeClass("hide")),window.$('.seat-item-empty[data-uid="'+t.drawerUserId+'"] .seat-user-alert').html('<div class="seat-user-alert-pink">选词中</div>')}onCheck(t,e){if(this.currSignal=t,1e3==t||0==t?this.onPrepareing(t,e):1002==t?(this.clearPlayingSeat(),this.onShowScore(t,e)):1004==t?(this.clearPlayingSeat(),this.onGamingResult(t,e)):null==t&&(window.$(".whiteboard-prepare-button").addClass("hide"),window.$(".whiteboard-prepare-alert").removeClass("hide")),uu.isNewDrawTempRoom()){window.$(".whiteboard-anchor-site .seat-item-empty .seat-role-tag").css("display","none");const t=e.data.find((t=>1==t.owner));null!=t&&window.$(".whiteboard-anchor-site .seat-item-empty[data-uid='"+t.uid+"'] .seat-role-tag").text("房主").css("display","flex")}}onStartDraw(t){this.drawUid=t.drawerUserId,this.drawUserName=t.drawerUserName,window.$(".whiteboard-prepare-container").addClass("hide"),window.$(".whiteboard-word-container").addClass("hide"),window.$(".whiteboard-draw-container").removeClass("hide"),window.$("#whiteboard").removeClass("hide"),window.$(".whiteboard-choice-word-container").addClass("hide"),t.drawerUserId==uu.getMeid()?(this.whiteRoom&&(this.whiteRoom.disableDeviceInputs=!1),window.$(".whiteboard-tools-action").removeClass("hide"),window.$(".whiteboard-tools-thumbs-up").addClass("hide")):(this.whiteRoom&&(this.whiteRoom.disableDeviceInputs=!0),window.$(".whiteboard-tools-action").addClass("hide"),window.$(".whiteboard-tools-thumbs-up").removeClass("hide")),this.setViewMode()}setViewMode(){this.whiteRoom&&(this.drawUid==uu.getMeid()?this.whiteRoom.setViewMode("broadcaster"):this.whiteRoom.setViewMode("follower"))}onGameMessage(t){const e=t.data,n=t.data.type;this.currSignal=n,1002==n?(this.clearPlayingSeat(),this.onChoiceWording(e)):1003==n?(e.drawerUserId!=uu.getMeid()&&window.$(".whiteboard-status-title").text(e.msg),this.clearPlayingSeat()):1004==n?(window.$('.seat-item-empty[data-uid="'+e.drawerUserId+'"] .seat-user-alert').html('<div class="seat-user-alert-pink">绘画中</div>'),this.onStartDraw(e),this.time=parseInt(e.cd),this.clearPlayingSeat(),this.onCountDown()):1006==n?(this.clearPlayingSeat(),this.onDrawFinsh(e),window.$(".whiteboard-tools-detail").addClass("hide")):1007==n?(this.clearPlayingSeat(),this.onResultTop(e),window.$(".whiteboard-tools-detail").addClass("hide")):1009==n?(this.clearPlayingSeat(),this.time=parseInt(e.cd),this.onCountDown()):1010==n?(window.$(".draw_game_resource").html("<img src="+e.userDrawResult+" />"),this.whiteRoom&&(uu.getMeid()==this.drawUid&&this.whiteRoom.cleanCurrentScene(!0),this.whiteRoom.disableDeviceInputs=!0)):1099==n||(2001==n?this.onChoiceWord(e):2002==n?(e.drawerUserId==uu.getMeid()&&window.$(".whiteboard-status-title").text(e.msg),this.clearPlayingSeat()):2003==n&&e.likeCount&&window.$(".whiteboard-action-like span").text("+"+e.likeCount))}onSelectAction(){window.$(".whiteboard-tool-action-wrapper").removeClass("current"),0==this.actionTab?window.$(".whiteboard-tool-action-wrapper").eq(1).addClass("current"):1==this.actionTab?window.$(".whiteboard-tool-action-wrapper").eq(0).addClass("current"):2==this.actionTab&&window.$(".whiteboard-tool-action-wrapper").eq(2).addClass("current")}setWhiteBoardColors(t){this.actionTab=t,window.$(".whiteboard-size").addClass("hide"),window.$(".whiteboard-tools-detail").removeClass("hide"),window.$(".whiteboard-colors").empty();for(let e in je){let t=je[e];window.$(".whiteboard-colors").append('<div class="whiteboard-color-item-wrapper flex flex-jc flex-ac" data-color="'+e+'" data-value="'+t+'">\n                     <div style="width:26px;height:26px;border-radius:100%;background:'+e+' "></div>\n            </div>')}window.$(".whiteboard-color-item-wrapper[data-color='#FFFFFF'] div").css("border","1px solid #979797"),window.$('.whiteboard-color-item-wrapper[data-color="'+this.drawColor16+'"]').addClass("current"),window.$(".whiteboard-colors").removeClass("hide"),this.onSelectAction(),this.setMemberState({strokeWidth:De[this.drawSize],strokeColor:this.drawColor})}initTemplate(){const t=uu.isDrawTempRoom()?"":"draw-biggger",e=uu.isDrawRoom()?'\n            <div class="draw-biggger-container">\n                <div class="seat-draw-main-seat flex flex-jc"></div>\n                <div class="whiteboard-status-container flex flex-dir-col flex-ac">\n                    <span class="whiteboard-status-title">准备阶段</span>\n                    <div class="whiteboard-countdown flex flex-ac "><span>0</span>s</div>\n                </div>\n            </div>\n        ':"";let n="background: url(http://asset.tuwan.com/chatroom/images/draw_bg.png) no-repeat;";uu.isDrawTempRoom()&&""!=uu.roomInfo.img_wheat_pc&&(n="background: url("+uu.roomInfo.img_wheat_pc+") no-repeat;");const i='<div class="whiteboard-container flex flex-jc '+t+'">\n                    <div style="position: absolute; left: 10px;top:12px;">\n                        <div class="song-but song-but-setting flex flex-jc flex-ac hide">设置</div>\n                        <div class="song-but song-but-clockin flex flex-jc flex-ac hide">打卡</div>\n                    </div>\n                    '+e+'\n                    <div class="whiteboard-wrapper flex flex-dir-col flex-ac" style="'+n+'">\n                        <div class="whiteboard-status-container flex flex-ac"><span class="whiteboard-status-title">准备阶段</span><div class="whiteboard-countdown flex flex-ac hide"><span>0</span>s</div></div>\n                        <div class="whiteboard-work-container">\n                            <div class="whiteboard-prepare-container flex flex-ac flex-dir-col hide">\n                                    <div class="whiteboard-prepare-title"></div>\n                                    <div class="whiteboard-prepare-anchor">\n                                         <img class="whiteboard-prepare-anchor-header" src="https://res.tuwan.com/templet/play/chat/chatv2/images/addicon.png">\n                                         <div class="whiteboard-prepare-anchor-id hide"></div>\n                                         <div class="whiteboard-prepare-anchor-name">虚位以待</div>\n                                    </div>\n                                    <div class="whiteboard-prepare-button">准备</div>\n                                    <div class="whiteboard-prepare-alert hide">游戏即将开始</div>\n                            </div>\n                            <div class="whiteboard-word-container flex flex-ac flex-dir-col hide">\n                                   <div class="whiteboard-word-title-wrapper">\n                                       <div class="whiteboard-word-title">选词绘画</div>\n                                       <div class="whiteboard-word-des">请选择你要绘画的词语</div>\n                                   </div>\n\n                                   <div class="whiteboard-word-items">\n\n                                   </div>\n                                   <div class="whiteboard-word-button">\n                                        换一批（<span><img src="https://res.tuwan.com/templet/play/public/images/zuanshi.png"/>10钻</span>）\n                                   </div>\n                            </div>\n                            <div class="whiteboard-draw-container hide">\n                                <div class="whiteboard-tools whiteboard-tools-wrapper flex flex-ac">\n                                    <div class="whiteboard-tools-detail flex flex-ac hide">\n                                        <div class="whiteboard-colors hide">\n\n                                        </div>\n                                        <div class="whiteboard-size flex flex-jb flex-1 hide">\n                                            <div class="flex flex-1 flex-ac">\n                                                <div class="whiteboard-size-item select" data-size="1" style=" height: 4px;width: 4px; "> </div>\n                                                <div class="whiteboard-size-item" data-size="2" style=" height: 6px;width: 6px; "> </div>\n                                                <div class="whiteboard-size-item" data-size="3" style=" height: 10px;width: 10px; "> </div>\n                                                <div class="whiteboard-size-item" data-size="4" style=" height: 15px;width: 15px; "> </div>\n                                                <div class="whiteboard-size-item" data-size="5" style=" height: 20px;width: 20px; "> </div>\n                                            </div>\n                                            <div class="whiteboard-size-clear flex flex-ac hide">清屏</div>\n                                        </div>\n                                    </div>\n                                    <div class="whiteboard-tools-action flex flex-1 flex-between hide">\n                                        <div class="flex whiteboard-draw-tools">\n                                            <div class="whiteboard-tool-action-wrapper">\n                                                <div class="whiteboard-tool-action" data-alt="size">\n                                                  <div class="whiteboard-result whiteboard-result-size">1</div>\n                                                </div>\n                                            </div>\n                                             <div class="whiteboard-tool-action-wrapper">\n                                                <div class="whiteboard-tool-action" data-alt="color">\n                                                   <div class="whiteboard-result whiteboard-result-color"></div>\n                                                </div>\n                                            </div>\n                                             <div class="whiteboard-tool-action-wrapper">\n                                                 <div class="whiteboard-tool-action" data-alt="eraser">\n                                                    <div class="whiteboard-result whiteboard-result-eraser">1</div>\n                                                </div>\n                                            </div>\n\n                                         </div>\n                                        <div class="flex flex-ac whiteboard-do-tools">\n                                            <div class="whiteboard-tool-action" data-alt="undo"></div>\n                                            <div class="whiteboard-tool-action" data-alt="redo"></div>\n                                        </div>\n                                    </div>\n                                    <div class="whiteboard-tools-thumbs-up flex flex-1">\n\n\n\n                                           <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                              <div class="whiteboard-tool-action" data-alt="egg"></div>\n                                              <span>10钻</span>\n                                           </div>\n\n                                           <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                              <div class="whiteboard-tool-action" data-alt="flower"></div>\n                                              <span>10钻</span>\n                                           </div>\n\n                                       <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                              <div class="whiteboard-tool-action" data-alt="transition"></div>\n                                              <span>520钻</span>\n                                           </div>\n\n                                    </div>\n                                </div>\n                                <div id="whiteboard" class="hide"></div>\n                                <div class="whiteboard-choice-word-container hide flex flex-ac flex-dir-col">\n                                    <div class="whiteboard-choice-word-avatar">\n\n                                    </div>\n                                    <div class="whiteboard-choice-word-title"></div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="whiteboard-anchor-site"></div>\n                    </div>\n\n                </div>';uu.isDrawRoom(),window.$(".room-seats-main").html(i),this.onEventListener(),Ct.loadScript("https://asset2.tuwan.com/chatroom/script/white-web-sdk_2.15.13.js").then((()=>{this.whiteWebSdk=new window.WhiteWebSdk({appIdentifier:"Yg_D8GFJEey6jBv0gFWYgQ/5yh4FRZ7PshG5Q"}),this.initSdkRoom()}))}sendWheatListSocket(){uu.globalDDSocket.send("wheatlist",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.roomInfo.typeid,subType:1})}setRoomSeats(t){window.$(".whiteboard-anchor-site").empty(),window.$(".whiteboard-anchor-site").html(t)}setCallBackFn(t){this.leaveRoomFn=t}onReset(){window.$(".whiteboard-work-container>div").addClass("hide"),window.$(".whiteboard-choice-word-container").addClass("hide"),window.$(".whiteboard-tools .whiteboard-tool-action").off("click"),null!=this.whiteRoom&&"connected"==this.whiteRoom.phase&&this.whiteRoom.disconnect()}onEventListener(){const t=this;window.$(document).on("click",".whiteboard-tools .whiteboard-tool-action",(function(e){switch(e.currentTarget.dataset.alt){case"color":t.setWhiteBoardColors(0);break;case"size":t.setWhiteBoardSize(1);break;case"eraser":t.setWhiteBoardSize(2);break;case"undo":t.undo();break;case"redo":t.redo();break;case"egg":t.egg();break;case"flower":t.flower();break;case"transition":t.transition()}})),window.$(".whiteboard-prepare-button").on("click",(function(e){const n=e.currentTarget.textContent;if("开始"==n)if(0==window.$(".whiteboard-prepare-button.unstart").length){const t=uu.isDrawRoom()?1:0;qt.get(Ot.onStarDrawGame(uu.getCid(),t)).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}else Vt("所有人都准备好才能开始哦..");else"准备"==n?t.onSetGameOut(1):"取消"==n&&t.onSetGameOut(2)})),window.$(".whiteboard-word-items").on("click",".whiteboard-word-item",(t=>{const e=t.currentTarget.dataset.index;qt.get(Ot.onWordSelection(uu.getCid(),e)).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))})),window.$(".whiteboard-word-button").on("click",(e=>{t.reflashWord||(t.reflashWord=!0,qt.get(Ot.onRefresnWords(uu.getCid(),1,uu.getMeid())).then((e=>{0==e.error?t.onInfillWord(e.data):Vt(e.error_msg),t.reflashWord=!1})).catch((e=>{Vt("网络错误请稍后再试.."),t.reflashWord=!1})))})),window.$(".whiteboard-size-item").on("click",(e=>{const n=e.currentTarget.dataset.size;1==t.actionTab?(t.drawSize=n,window.$(".whiteboard-result-size").text(t.drawSize),t.setMemberState({strokeWidth:De[this.drawSize],strokeColor:t.drawColor})):2==t.actionTab&&(t.eraserSize=n,window.$(".whiteboard-result-eraser").text(t.eraserSize),t.setMemberState({strokeWidth:De[this.eraserSize],strokeColor:[255,255,255]})),window.$(".whiteboard-tools-detail").addClass("hide")})),window.$(".whiteboard-size-clear").on("click",(()=>{window.$(".whiteboard-tools-detail").addClass("hide"),this.setMemberState({strokeWidth:De[this.drawSize],strokeColor:this.drawColor}),t.clear()})),window.$(".whiteboard-colors").on("click",".whiteboard-color-item-wrapper",(e=>{window.$(".whiteboard-result-color").css("background",e.currentTarget.dataset.color),t.drawColor16=e.currentTarget.dataset.color,window.$(".whiteboard-tools-detail").addClass("hide"),t.drawColor=e.currentTarget.dataset.value.split(","),t.setMemberState({strokeWidth:De[this.drawSize],strokeColor:t.drawColor}),0==t.actionTab&&(window.$(".whiteboard-tool-action-wrapper").removeClass("current"),window.$(".whiteboard-tool-action-wrapper").eq(0).addClass("current"))})),window.$("#whiteboard").on("mousedown",(()=>{0==window.$(".whiteboard-tools-detail.hide").length&&window.$(".whiteboard-tools-detail").addClass("hide"),0==t.actionTab&&(window.$(".whiteboard-tool-action-wrapper").removeClass("current"),window.$(".whiteboard-tool-action-wrapper").eq(0).addClass("current"))}))}onSetGameOut(t,e=0){null!=uu.getAnchorKengUser(uu.getMeid())&&1!=uu.getAnchorKengUser(uu.getMeid()).position&&qt.get(Ot.onSetDrawGameOut(uu.getCid(),uu.getMeid(),t,e)).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}initSdkRoom(){let t={uuid:uu.roomInfo.wb_uuid,roomToken:uu.roomInfo.wb_token,uid:uu.getMeid()+""};const e=this;this.whiteWebSdk.joinRoom(t).then((function(t){t.bindHtmlElement(document.getElementById("whiteboard")),e.whiteRoom=t,t.isWritable&&(t.disableSerialization=!1),t.disableDeviceInputs=!0,t.disableCameraTransform=!0,e.setMemberState({strokeColor:e.drawColor,strokeWidth:De[e.drawSize]}),e.setViewMode()})).catch((function(t){console.error(t)}))}joinRoom(t){const e=t.cid,n=uu.getChannel();Ct.setCookie("preCarteamChannel",n),this.leaveRoomFn(e),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),window.$(".yaoqing-float").css("display","none")}clear(){this.whiteRoom&&this.whiteRoom.cleanCurrentScene(),window.$(".whiteboard-tool-action-wrapper").removeClass("current"),window.$(".whiteboard-tool-action-wrapper").eq(0).addClass("current")}undo(){this.whiteRoom&&this.whiteRoom.canUndoSteps&&this.whiteRoom.undo()}redo(){this.whiteRoom&&this.whiteRoom.canRedoSteps&&this.whiteRoom.redo()}flower(){this.sendGift(34,this.drawUid,this.drawUserName)}egg(){this.sendGift(119,this.drawUid,this.drawUserName)}transition(){this.sendGift(253,this.drawUid,this.drawUserName)}like(){qt.get(Ot.onDrawLike(uu.getCid(),this.drawUid)).then((t=>{0==t.error?window.$(".whiteboard-action-like").addClass("like"):Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}async sendGift(t,e,n,i=1){const o=(await qt.get(Pt+`/Teacher/getGift?id=${t}`)).data;this.emitter.emit("sendGift",o,e,n,i,(t=>{}))}showLeaveRoomConfirmModal(t,e,n){de.getInstance().show("温馨提示",e,!0,"取消",n,(()=>{t.call()}))}setWhiteBoardSize(t){window.$(".whiteboard-tools-detail").removeClass("hide"),window.$(".whiteboard-size-item").removeClass("select"),window.$(".whiteboard-size-current").remove(),window.$(".whiteboard-size").removeClass("hide"),window.$(".whiteboard-size-clear").addClass("hide"),window.$(".whiteboard-colors").addClass("hide");let e=1,n=1;1==t?(e=De[this.drawSize],n=this.drawSize,this.actionTab=t,this.setMemberState({strokeWidth:e,strokeColor:this.drawColor})):2==t&&(e=De[this.eraserSize],n=this.eraserSize,this.actionTab=t,this.setMemberState({strokeWidth:e,strokeColor:[255,255,255]}),window.$(".whiteboard-size-clear").removeClass("hide")),window.$(".whiteboard-size-item").removeClass("select"),window.$(".whiteboard-size-item[data-size="+n+"]").addClass("select"),this.onSelectAction()}setMemberState(t){this.whiteRoom&&this.whiteRoom.setMemberState(t)}}class Ee{static create(){const t=window.$('\n            <div class="draw_game_modal">\n                <div class="draw_game_content">\n                    <div class="draw_game_close"></div>\n                    <div class="draw_game_title"></div>\n                    <div class="draw_game_user_info">\n                        <div class="draw_game_user_info_avatar">\n                        </div>\n                        <div class="draw_game_user_info_detail">\n                        </div>\n                    </div>\n                    <div class="draw_game_resource">\n                    </div>\n                    <div class="flex whiteboard-tools" style="justify-content: space-between;margin-top: 10px;">\n                        <div class="whiteboard-action-like flex flex-ac">\n                            <span></span>\n                        </div>\n                        <div class="flex">\n                            <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                <div class="whiteboard-tool-action" data-alt="egg"></div>\n                                <span>10钻</span>\n                            </div>\n                            <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                <div class="whiteboard-tool-action" data-alt="flower"></div>\n                                <span>10钻</span>\n                            </div>\n                            <div class="whiteboard-tools-thumbs-up-wrapper flex flex-dir-col flex-ac">\n                                <div class="whiteboard-tool-action" data-alt="transition"></div>\n                                <span>520钻</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ');return t.on("click",(function(t){t.stopPropagation()})),t.find(".draw_game_close").on("click",(t=>{t.stopPropagation(),si.hide(".draw_game_modal")})),t.find(".whiteboard-action-like").on("click",(t=>{t.stopPropagation();Le.getInstance().like()})),t}}class Be{static create(){const t=window.$('\n            <div class="draw_result_modal">\n                <div class="draw_result_content">\n                    <div class="draw_result_close"></div>\n                    <div class="draw_result_title">游戏结束</div>\n                    <div class="draw_result_list">\n                    </div>\n                    <div class="draw_result_alaso">再来一局</div>\n                </div>\n            </div>\n        ');return t.on("click",(function(t){t.stopPropagation()})),t.find(".draw_result_close").on("click",(t=>{t.stopPropagation(),si.hide(".draw_result_modal")})),t.find(".draw_result_alaso").on("click",(t=>{t.stopPropagation(),si.hide(".draw_result_modal");Le.getInstance().onSetGameOut(1,1)})),t}}class Fe{static create(){const t=window.$('\n            <div class="pop_up_bg div-biaobai" >\n                <div class="pop_up_content">\n                    <div class="close_btn fr" id="closeBiaobai">\n                        <img src="https://res.tuwan.com/templet/play/teacher/images/close.png">\n                    </div>\n\n                    <div class="express_popup_box express_popup_box1">\n                        <div class="express_top_title">对<span class="span-biaobai-name"></span>进行表白</div>\n                        <p class="biaobai-desc"></p>\n                        <div class="express_content">\n                            <span class="content_icon fl"><img src="https://res.tuwan.com/templet/play/teacher/images/express_content.png"><span>表白内容</span></span>\n                            <textarea id="textareabiaobai" class="content_text fl" placeholder="不超过40个字..." maxlength="40"></textarea>\n                            <div class="content_text_wran">0/40</div>\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="express_content" id="biaobai_time">\n                            <span class="content_icon fl">\n                                <img src="https://res.tuwan.com/templet/play/teacher/images/express_time.png"><span>表白时间</span></span>\n                            <div class="fl">\n                                <div class="ta_date" id="div_date1">\n                                    <input id="inputBiaobaiDate" class="form_datetime2 date_title" type="text" value="" readonly="" placeholder="" style="width: 120px;background:#eaeaea;">\n                                </div>\n                            </div>\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="fl no_express" id="divCloseBiaobai">放弃表白</div>\n                        <div class="fl sure_express" id="divSureBiaobai">确认表白</div>\n                        <div class="clearfix"></div>\n                        <div class="express_warn">*确认表白后将无法修改，表白成功后系统会发送您一条消息提醒。<br>\n                            *放弃表白则示为放弃礼物的表白特权，再次表白需重新赠送礼物。</div>\n                    </div>\n                </div>\n            </div>\n        ');return Promise.all([Ct.loadScript("https://res1.tuwan.com/templet/play/laydate/theme/default/laydate.css?d=201805101730&v=5.0.9"),Ct.loadScript("https://res1.tuwan.com/templet/play/laydate/laydate.js?v=201805101730")]).then((()=>{window.laydate.render({elem:t.find("#inputBiaobaiDate")[0],min:0,max:4,showBottom:!1,done:function(t,e,n){}});const e=Ct.dateFormatA(new Date,"-");window.$("#inputBiaobaiDate").val(e)})),t.find("#closeBiaobai, #divCloseBiaobai").on("click",(function(){si.hide(".div-biaobai"),window.$(".div-biaobai").attr("z-index","100001");const e=t.find(".span-biaobai-name").attr("account");qt.get(Pt+"/Teacher/cancelConfessionV1?ids="+e+"&format=jsonp").then((t=>{}))})),t.find("#textareabiaobai").on("keyup",(function(){const t=window.$("#textareabiaobai").val();let e=0;t.length>=40?(window.$("#textareabiaobai").val(t.substr(0,40)),e=40):e=t.length,window.$(".express_popup_box1 .content_text_wran").html(e+"/40")})),t.find("#divSureBiaobai").on("click",(function(){const e=window.$(this).attr("texiao_biaobai"),n=window.$(this).attr("biaobai_uid");if("yes"==e){if(""==(i=window.$.trim(window.$("#textareabiaobai").val())))return void Ct.Alert(Ue("请输入表白内容"));const t=Pt+"/Hd/confession?teacherid="+n+"&content="+i;qt.get(t).then((t=>{-1==t.error?Vt(t.error_msg):0==t.error?(si.hide(".div-biaobai"),window.$(".div-biaobai").attr("z-index","100001"),Ct.Alert(Ue("表白成功"))):-3==t.error&&Ct.Alert(Ue("表白失败，内容非法"))}))}else{var i;if(""==(i=window.$.trim(window.$("#textareabiaobai").val())))return void Ct.Alert(Ue("请输入表白内容"));var o=window.$.trim(window.$("#inputBiaobaiDate").val());if(""==o)return void Ct.Alert(Ue("请选择表白时间"));const e=t.find(".span-biaobai-name").attr("account1"),n=Pt+"/Teacher/setMoreConfessionV1?teacherids="+e+"&content="+i+"&time="+o+"&format=jsonp";qt.get(n).then((t=>{0==t.error?(si.hide(".div-biaobai"),window.$(".div-biaobai").attr("z-index","100001"),Vt("表白成功")):Vt(t.error_msg)}))}})),t}}function Ue(t){return"9999998"==$(".div-biaobai").css("z-index")?{msg:t,zIndex:9999998}:t}let ze=class{static create(){const t=window.$('\n            <div class="room_rule_modal">\n                <div class="room_rule_content">\n                    <div class="room_rule_close"></div>\n                    <div class="room_rule_title"></div>\n                    <div class="room_rule_info">\n\n                    </div>\n                    <div class="room_rule_alaso">知道了</div>\n                </div>\n            </div>\n        ');return t.find(".room_rule_alaso,.room_rule_close").on("click",(function(){si.hide(".room_rule_modal")})),t}static show({title:t="玩法介绍",desc:e="",infoStyle:n}){si.show(".room_rule_modal"),window.$(".room_rule_title").text(t),window.$(".room_rule_info").html(e),n&&window.$(".room_rule_info").attr("style",n)}};class Oe{static create(){const t=window.$('\n            <div class="pop_up_bg channel-guanming">\n                <div class="pop_up_content">\n                    <div class="close_btn fr" id="closeChannelGuanming">\n                        <img src="https://res.tuwan.com/templet/play/teacher/images/close.png">\n                    </div>\n                    <div class="express_popup_box express_popup_box2">\n                        <div class="express_top_title">对<span class="span-channel-guanming-name"></span>进行冠名</div>\n                        <div class="express_content">\n                            <span class="content_icon fl"><img src="https://res.tuwan.com/templet/play/teacher/images/express_content.png"><span>冠名内容</span></span>\n                            <input class="fl content_input" style="width:170px;" id="inputChannelGuanming" placeholder="不超过12个字">\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="fl no_express" id="divCloseChannelGuanming">放弃冠名</div>\n                        <div class="fl sure_express" id="divSureChannelGuanming">确认冠名</div>\n                        <div class="clearfix"></div>\n                        <div class="express_warn" style="text-align: left;">*确定冠名后立即生效且不可修改<br>\n                            *放弃冠名则示为放弃爸爸卡的冠名特权，再次冠名需重新使用爸爸卡。</div>\n                    </div>\n                </div>\n            </div>\n        ');return t.find("#closeChannelGuanming,#divCloseChannelGuanming").on("click",(()=>{si.hide(".channel-guanming")})),t.find("#divSureChannelGuanming").on("click",(function(){const t=window.$.trim(window.$("#inputChannelGuanming").val());""!=t?t.length>12?Ct.Alert("冠名内容限12个字"):qt.get(Ot.channelNaming(uu.getMeid(),uu.getCid(),t)).then((t=>{0==t.error?(si.hide(".channel-guanming"),Ct.Alert(`给${uu.getRoomInfo().title}冠名成功`)):Ct.Alert(t.error_msg)})):Ct.Alert("请输入冠名内容")})),t}}let Ne=null;class qe{static create(){const t=window.$('\n            <div class="pop_up_bg div-guanming" >\n                <div class="pop_up_content">\n                    <div class="close_btn fr" id="closeGuanming" data-type="close">\n                        <img src="https://res.tuwan.com/templet/play/teacher/images/close.png">\n                    </div>\n                    <div class="express_popup_box express_popup_box2">\n                        <div class="express_top_title">对<span class="span-guanming-name"></span>进行冠名</div>\n                        <div class="express_content">\n                            <span class="content_icon fl"><img src="https://res.tuwan.com/templet/play/teacher/images/express_content.png"><span>冠名内容</span></span>\n                            <input class="fl content_input" id="inputGuanming" placeholder="不超过4个字">\n                            <div class="fl content_input_eg">*例：(冠名内容)♚小可爱</div>\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="express_content pt20">\n                            <span class="content_icon fl"><img src="https://res.tuwan.com/templet/play/teacher/images/express_time.png"><span>冠名时间</span></span>\n                            <div class="fl">\n                                <div class="ta_date" id="div_date1">\n                                    <input id="inputGuanmingDate" class="form_datetime3 date_title" type="text" value="" readonly="" placeholder="" style="width: 120px;background:#eaeaea;">\n                                </div>\n                            </div>\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="fl no_express" id="divCloseGuanming">放弃冠名</div>\n                        <div class="fl sure_express" id="divSureGuanming">确认冠名</div>\n                        <div class="clearfix"></div>\n                        <div class="express_warn" style="text-align: left; padding-left: 60px; line-height: 20px;">*放弃冠名则示放弃冠名特权，再次冠名需重新赠送礼物；<br/>\n                            *认冠名后将无法修改，可在个性装扮中更换冠名；</div>\n                    </div>\n                </div>\n            </div>\n        ');return t.find("#closeGuanming, #divCloseGuanming").on("click",(function(){if("close"==this.dataset.type)t();else{const e=this.dataset.giftuserid,n=Pt+"/Teacher/cancelNamingV1?ids="+e+"&format=jsonp";qt.get(n).then((e=>{0!=e.error&&Ct.Alert(Ve(e.error_msg)),t()}))}function t(){Ne&&Ne.splice(0,1),window.$(".div-guanming").attr("z-index","100001"),si.hide(".div-guanming"),Ge()}})),t.find("#divSureGuanming").on("click",(function(){const t=window.$.trim(window.$("#inputGuanming").val());if(""==t)return void Ct.Alert(Ve("请输入冠名内容"));if(""==window.$.trim(window.$("#inputGuanmingDate").val()))return void Ct.Alert(Ve("请输入冠名日期"));if(t.length>4)return void Ct.Alert(Ve("冠名内容限4个字"));const e=this.dataset.nickname,n=this.dataset.giftuserid,i=Pt+"/Teacher/setNamingV1?ids="+n+"&content="+encodeURIComponent(t)+"&format=jsonp";qt.get(i).then((t=>{-1==t.error?Ct.Alert(Ve("请登录后冠名")):0==t.error?(window.$(".div-guanming").attr("z-index","100001"),Ne.splice(0,1),Ct.Alert(Ve("给"+e+"冠名成功"),(function(){Ge()})),si.hide(".div-guanming")):-3==t.error?Ct.Alert(Ve("冠名失败，内容非法")):Ct.Alert(Ve(t.error_msg))}))})),t}static addGuanmingData(t,e,n=""){if(t.length>0){Ne||(Ne=[]);let i=[];for(let e=0;e<t.length;e++)i.push(t[e].userid);t.length>1?(Ne.push(t.map((t=>t.userid))),setTimeout((function(){Ge(n)}),e)):qt.getUsersInfo(t[0].userid,"sendCommondMessagesss").then((t=>{const i=t[0],o=i.uid,s=i.nickname;Ne.push({uid:o,nickname:s}),setTimeout((function(){Ge(n)}),e)}))}}}function Ge(t=""){if(Ne&&Ne.length>0){const e=Ne[0],n=Array.isArray(e),i=n?e.join(","):e.uid,o=Pt+"/Teacher/checkNamingV1?teacher_id="+i+"&format=jsonp";qt.get(o).then((i=>{if(window.$(".div-guanming").length>0)return;if(0==i.error){const o=i.data,s=n?"全麦":e.nickname;si.show(".div-guanming","block"),t&&$(".div-guanming").css("z-index",t),window.$("#inputGuanmingDate").val(o.day+"天"),window.$(".span-guanming-name").text("“"+s+"”");const a=document.querySelector("#divSureGuanming");a.dataset.giftuserid=o.ids,a.dataset.nickname=s;document.querySelector("#divCloseGuanming").dataset.giftuserid=o.ids}else Ne.splice(0,1),Ge(t)}))}else Ne=null,window.$(".div-guanming").attr("z-index","100001"),si.hide(".div-guanming")}function Ve(t){return"9999998"==$(".div-guanming").css("z-index")?{msg:t,zIndex:9999998}:t}class He{static create(){const t=window.$('\n            <div class="carteam-xuanyan-mask">\n                <div class="carteam-xuanyan-mask-content">\n                    <span class="carteam-xuanyan-close"></span>\n                    <p style="font-size: 16px; color: #666;text-align: center;">队长宣言</p>\n                    <div>\n                        <textarea placeholder="最多输入15个文字" maxlength="15"></textarea>\n                    </div>\n                    <div>\n                        <button>确定</button>\n                    </div>\n                </div>\n            </div>\n        ');return t.find(".carteam-xuanyan-close").on("click",(()=>{si.hide(".carteam-xuanyan-mask")})),t.find("button").on("click",(function(){const t=uu.getMeid();let e=uu.getMycarData().fid;let n=window.$(".carteam-xuanyan-mask .carteam-xuanyan-mask-content").find("textarea").val().replace(/\r/g,"");n=n.replace(/\n/g,""),""!=window.$.trim(n)?(Ct.setCookie("user_xuanyan_"+t,n),He.sendMessage&&He.sendMessage(e,n),si.hide(".carteam-xuanyan-mask")):Ct.Alert("队长宣言不能为空")})),t}}class We{static create(){const t=window.$('\n            <div class="temp-autocar-shang-mask">\n                <div class="temp-autocar-shang-content">\n                    <h4>悬赏</h4>\n                    <p class="shang-tips">勾选后悬赏礼物赠送给队友，取消勾选返回余额</p>\n                    <ul>\n                    </ul>\n                    <div style="text-align: center;">\n                        <button>赏</button>\n                    </div>\n                    <div class="temp-close"></div>\n                </div>\n            </div>\n        ');return t.find(".temp-close").on("click",(()=>{si.hide(".temp-autocar-shang-mask")})),t.find("li").on("click",(()=>{window.$(this).hasClass("selected")?window.$(this).removeClass("selected"):window.$(this).addClass("selected")})),t.find("button").on("click",(()=>{const t=window.$(this).attr("fid");let e=[];window.$(".temp-autocar-shang-content ul").find("li.selected").each((function(){e.push(window.$(this).attr("account"))})),qt.get(Pt+"/Chatroom/sendPublishReward?format=jsonp&fid="+t+"&uids="+e.join(",")).then((t=>{We.disposeResponse&&We.disposeResponse(t)}))})),t}}class Ke{static create(){const t=window.$('\n            \x3c!-- 实名认证 --\x3e\n            <div class="authentication-mask">\n                <div class="authentication-content">\n                    <p class="authentication-title">实名认证</p>\n                    <div class="authentication-content-item__container">\n                        <p class="authentication-content-desc">应国家法律法规要求，进行该操作需要进行账号实名，保障账号安全，防止账号被非法盗用及违规使用。</p>\n                        <div class="flex authentication-item " data-mode="choice" style="background: #f0f0f0;border-radius: 8px;">\n                            <div class="create-xtitle">姓名</div>\n                            <div style="flex: 1; ">\n                                <input class="authentication-input-title authentication-name" maxlength="32" placeholder="请输入您的真实姓名">\n                            </div>\n                        </div>\n                        <div class="flex authentication-item " data-mode="choice" style="background: #f0f0f0;border-radius: 8px;">\n                            <div class="create-xtitle">身份证号</div>\n                            <div style="flex: 1; ">\n                                <input class="authentication-input-title authentication-id" maxlength="18" placeholder="请输入身份证号">\n                            </div>\n                        </div>\n                        <p class="authentication-content-tips">注：认证信息一经认证,不可修改,请如实填写</p>\n                        <div class="flex flex-jc authentication-item authentication-sure" data-mode="choice" style="">\n                            <button>提交资料</button>\n                        </div>\n                        <div class="authentication-agreement"><a href="https://y.tuwan.com/childbaohu" target="_blank">《点点开黑未成年人保护计划》</a></div>\n                    </div>\n                </div>\n            </div>\n        ');return t.find("button").on("click",(()=>{const t=window.$(".authentication-input-title.authentication-name").val()+"".trim(),e=window.$(".authentication-input-title.authentication-id").val()+"".trim();""!=t&&""!=e?e.length<18?Vt("身份证长度错误"):qt.get(Ot.setAuth(t,e)).then((t=>{Vt(t.error_msg),0==t.error&&setTimeout((()=>{window.location.reload()}),2e3)})).catch((t=>{Vt("网络错误,请稍后再试")})):Vt("姓名或者身份证信息不能为空")})),t}}class Ye{static create(){const t=window.$('\n            \x3c!-- 创建弹弹猫 --\x3e\n            <div class="catgame-create-mask">\n                <div class="catgame-create-content">\n                    <p class="catgame-create-title">新建游戏桌</p>\n                    <div class="carauto-create-content-item__container">\n        \n                        <div class="flex catgame-create-item catgame-create-gamemode" data-mode="choice" style="">\n                            <div class="create-xtitle">模式</div>\n                            <div style="flex: 1; margin-left: 16px;" class="flex flex-col-dir catgame-choice-mode-container">\n                            </div>\n                        </div>\n                        <div class="flex catgame-create-item catgame-create-gold" data-mode="choice" style="">\n                            <div class="create-xtitle">场次</div>·\n                            <div style="flex: 1; margin-left: 16px;" class="flex flex-col-dir catgame-choice-gold-container">\n                            </div>\n                        </div>\n                        <div class="flex catgame-create-item " data-mode="choice" style="">\n                            <div class="create-xtitle">名称</div>\n                            <div style="flex: 1; margin-left: 16px;">\n                                <input class="catgame-create-input-title" maxlength="8" placeholder="请输入队伍名称">\n                            </div>\n                        </div>\n                        <div class="flex flex-jc catgame-create-item catgame-create-sure" data-mode="choice" style="">\n                            <button>确定</button>\n                        </div>\n                    </div>\n                    <div class="catgame-create-close"></div>\n                </div>\n            </div>\n        ');return t.find(".catgame-create-gamemode").on("click",".catgame-choice-item",(t=>{window.$(".catgame-create-gamemode .catgame-choice-item").removeClass("current"),window.$(t.currentTarget).addClass("current")})),t.find(".catgame-create-gold").on("click",".catgame-choice-item",(t=>{window.$(".catgame-create-gold .catgame-choice-item").removeClass("current"),window.$(t.currentTarget).addClass("current")})),t.find(".catgame-create-sure").on("click",(()=>{const t=window.$(".catgame-create-input-title").val();if(0==t.trim().length)return void Vt("请填写要求");const e=window.$(".catgame-create-gamemode .catgame-choice-item.current")[0].dataset.mode,n=window.$(".catgame-create-gold .catgame-choice-item.current")[0].dataset.gold;Ye.publishBombCat&&Ye.publishBombCat(uu.getCid(),e,n,t),si.hide(".catgame-create-mask")})),t.find(".catgame-create-close").on("click",(()=>{si.hide(".catgame-create-mask")})),t}}class Je{static create(){const t=window.$('\n            <div class="lolqu-mask">\n                <div class="lolqu-content">\n                    <div class="flex">\n                        <span style="font-size: 18px;color: #333;">选择大区</span>\n                        <p class="flex lolqu-channel">\n                        </p>\n                    </div>\n                    <ul class="flex lolqu-list">\n                    </ul>\n                    <div class="lolqu-div-btn" style="text-align: center;">\n                        <span class="lolqu-btn sure">确认</span>\n                        <span class="lolqu-btn cancle">取消</span>\n                    </div>\n                    <div class="lolqu-content-close"></div>\n                </div>\n            </div>\n        ');return t.find(".lolqu-content-close").on("click",(()=>{si.hide(".lolqu-mask")})),t.find(".lolqu-list li").on("click",(()=>{window.$(".lolqu-mask .lolqu-list li").removeClass("current"),window.$(this).addClass("current")})),t.find(".lolqu-channel span").on("click",(()=>{const t=window.$(this).attr("channelid");window.$(".lolqu-list li").hide(),window.$(".lolqu-list").find("li.current").removeClass("current"),window.$(".lolqu-list li[channelid='"+t+"']").show(),window.$(".lolqu-list li[channelid='"+t+"']").eq(0).addClass("current"),window.$(".lolqu-channel span").removeClass("current"),window.$(this).addClass("current")})),t.find(".lolqu-btn.sure").on("click",Je.disposeNickname),t.find(".lolqu-btn.cancle").on("click",(()=>{si.hide(".lolqu-mask")})),t}}function Qe({img:t,retryNum:e=1,randomNum:n=!1}){t&&window.$(t).on("error",(function(t){if("error"==t.type){const i=window.$(t.target),o=i.data("retry_num")||0;let s=i.attr("src");if(s&&s.length){if(o>=e)return;i.data("retry_num",o+1),n&&(s.indexOf("?")<0&&(s+="?"),s=s+"&____random="+Math.random()),window.$(t.target).attr("src",s)}}}))}function Xe(t,e=!1,n=3){let i=[],o=!1;if(t.length>0){for(let h=0;h<t.length;h++){var s=t[h],a=1*s.id,r=s.pic,c=s.gold_pic,l=s.intro,d=s.box_num,m=s.uids[0].num;let u=[];for(let t in s)u.push("data-"+t+'="'+s[t]+'"');if(1==d){o=!0;tn(a,"<div"+(" "==l?"":' title="'+Ct.nrTobr(l)+'" ')+u.join(" ")+' data-num="'+m+'" class="flex openbox-sigle-self">\n                                    <div class="openbox-gift-item">\n                                        <img src="'+r+'">\n                                        <span>x'+m+"</span>\n                                    </div>\n                                </div>",e,n);break}i.push('<li class="flex">\n                        <div '+u.join("")+' data-num="'+m+'" class="openbox-gift-item">\n                            <img src="'+c+'">\n                            <span>x'+m+"</span>\n                        </div>\n                    </li>")}if(!o){const t=0==window.$(".openbox-mask").length;si.show(".openbox-mask","block");const e=window.$(".openbox-mask .openbox-gifts ul");if(e.html(i.join("")),e.find("img").each((function(){Qe({img:this,retryNum:1,randomNum:!0})})),t){const t=window.$(".openbox-mask .openbox-gifts ul li"),e=Ze(window.$(".openbox-mask .openbox-button"));t.css("opacity",0),t.each((function(t,n){const i=window.$(n),o=Ze(i),s=e.x-o.x,a=e.y-o.y;i.snabbt({fromOpacity:0,opacity:1,fromPosition:[s,a,0],duration:200,delay:200*t,easing:"easeOut"})}))}}}}function Ze(t){const e=t.width(),n=t.height();return{x:t.offset().left+e/2,y:t.offset().top+n/2,width:e,height:n}}function tn(t,e,n=!1,i=3){const o=window.$(e);window.$("body").append(o),Qe({img:o.find("img"),retryNum:1,randomNum:!0}),o.snabbt({fromScale:[1,1],scale:[1.6,1.6],duration:200,complete:function(){new Promise(((t,e)=>{setTimeout(t,1e3)})).then((()=>{!function(t,e,n=!1,i=3){const o=window.$(".chat-center-gift-list").find(`.chat-center-gift-list-single[data-id='${i}']`),s=o.find(".chat-center-gift-item[data-id='"+t+"']");let a="",r=!1;s.length>0?(a=s,r=!0):(r=!1,a=en(t,e[0]),o.append(a),window.$(".chat-center-gift-item").tooltip({align:"top",html:!0}));nn(e,a,r,1,n).then((()=>{}))}(t,o,n,i)}))}})}function en(t,e,n){const i=e.dataset;let o=[];for(let s in i)o.push("data-"+s+'="'+i[s]+'"');if(null!=i.intro){const t=Ct.nrTobr(i.intro);o.push('original-title="'+t+'"')}return window.$("<div "+o.join(" ")+' class="chat-center-gift-item"></div>')}function nn(t,e,n,i,o=!1){return new Promise(((i,s)=>{!async function(t,e,n,i=!1){const o=t.width(),s=t.height(),a=t.offset(),r=a.left+o/2,c=a.top+s/2,l=e.width(),d=e.height(),m=e.offset(),h=m.left+l/2,u=m.top+d/2;t.snabbt({position:[h-r,u-c,0],fromScale:[1,1],scale:[0,0],duration:300,complete:function(){!function(t,e,n,i=!1){const o=t.get(0).dataset,s=o.pic,a=o.title,r=o.num;let c=r;if(n&&0==i){c=1*e.get(0).dataset.num+1*r,e.get(0).dataset.num=c}const l=function(t,e,n){return'<div class="baoguo-in">\n                <div>\n                    <img src="'+t+'">\n                </div>\n                <div>'+e+'</div>\n                <div class="baoguo-num" num="'+n+'" style="font-size:12px;color:#666">x'+n+"</div>\n            </div>"}(s,a,c);e.html(l),e.find(".baoguo-in").snabbt({fromScale:[0,0],scale:[1,1],duration:300,easing:"spring",springConstant:1.9,springDeceleration:.6})}(t,e,n,i),t.remove()}})}(t,e,n,o),setTimeout((()=>{i()}),100)}))}class on{static create(){const t=window.$('\n            <div class="openbox-mask">\n                <div class="openbox-mask-1"></div>\n                <div class="openbox-content">\n                    <div class="openbox-hh">\n                        <img src="https://asset.tuwan.com/chatroom/images/open_box_title.png" style="height: 80px;">\n                    </div>\n                    <div class="flex openbox-gifts">\n                        <ul class="flex">\n                        </ul>\n                    </div>\n                    <div class="openbox-button">\n                        <button>领取</button>\n                    </div>\n                </div>\n            </div>\n        ');return t.find("button").on("click",(t=>{t.stopPropagation(),window.$(".openbox-mask-1,.openbox-hh,.openbox-button").snabbt({fromOpacity:1,opacity:0,complete:()=>{si.hide(".openbox-mask")}}),async function(){const t=$(".chat-center-gift-tab div.gift-selected")[0].dataset.id||3,e=window.$(".openbox-content ul").find(".openbox-gift-item"),n=window.$(".chat-center-gift-list").find(`.chat-center-gift-list-single[data-id='${t}']`);for(let i=0;i<e.length;i++){const t=e[i],o=t.dataset.id,s=n.find(".chat-center-gift-item[data-id='"+o+"']");let a="",r=!1;s.length>0?(a=s,r=!0):(r=!1,a=en(0,t),"383"==o?n.find('.chat-center-gift-item[data-id="156"]').after(a):n.append(a)),await nn(window.$(t),a,r).then((()=>{}))}}()})),t}}class sn{static create(){const t=window.$('\n            <div class="room_invite_modal">\n                <div class="room_invite_content">\n                    <div class="room_invite_close"></div>\n                    <div class="room_invite_title">邀你一起开黑</div>\n                    <div class="room_invite_userinfo_content flex ">\n                        <div class="room_invite_userinfo_avatar"></div>\n                        <div class="room_invite_detail">\n                            <div class="room_invite_userinfo_nickname"></div>\n                            <div class="room_invite_game flex flex-ac"><div class="room_invite_game_icon"></div> <span></span></div>\n                            <div class="room_invite_action flex flex-ac">\n                                <div class="room_invite_action_accept">接受邀请</div>\n                                <div class="room_invite_action_im"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ');return t.find(".room_invite_close").on("click",sn.closeClick),t.find(".room_invite_action_accept").on("click",sn.acceptClick),t.find(".room_invite_action_im").on("click",sn.imClick),t}}class an{constructor(){this.instance=null,this.currentRtc=null}static getInstance(){return this.instance||(this.instance=new an,this.instance.initEvent()),this.instance}initEvent(){const t=this;window.$(".chat-center").on("click",".chat-dd-device",(()=>{an.getInstance().show(),uu.isTRTC()&&($(".device-modal-item.echoSettingCtn").hide(),$(".device-modal-container").css("height","120px"))})),rn.onChange=e=>{const n=window.$(".device-modal-group").find("option:selected").val();null!=n&&(window.localStorage.setItem("device-id",n),t.currentRtc.setAudioDevice(n))}}bindRctClient(t){this.currentRtc=t}show(){si.show(".device-setting-modal","block")}hide(){si.hide(".device-setting-modal")}}class rn{static create(){const t=window.$('\n            <div class="device-setting-modal">\n                <div class="device-modal-container">\n                    <div class="device-modal-item echoSettingCtn">\n                        <h3 class="device-modal-item-title">回声消除设置（使用外接声卡戴耳机时，关闭此选项可获得更优音质。设置后，重新进聊天室生效）</h3>\n                        <div class="device-modal-item-container"> \n                            <div class="device-modal-3a close"></div>\n                        </div>\n                    </div>\n                    <div class="device-modal-item">\n                        <h3 class="device-modal-item-title">默认麦克风选择</h3>\n                        <div class="device-modal-item-container">\n                        <select class="device-modal-group">\n                            </select>\n                        </div>\n                    </div>\n                    <div class="device-modal-close"></div>\n                </div>\n            </div>\n        ');return 1==window.localStorage.getItem("device-3a")&&t.find(".device-modal-3a").addClass("open"),t.find(".device-modal-close").on("click",(()=>{an.getInstance().hide()})),t.find(".device-modal-3a").on("click",(()=>{if(uu.isSpecialSongRoom())return void Vt("合唱模板已为您设置好最的3A配置，请合唱模板结束之后再进行操作！");1==window.localStorage.getItem("device-3a")?(window.localStorage.setItem("device-3a",0),window.$(".device-modal-3a").removeClass("open")):(window.localStorage.setItem("device-3a",1),window.$(".device-modal-3a").addClass("open"))})),t.find(".device-modal-group").on("change",rn.onChange),window.AgoraRTC.getMicrophones().then((e=>{if(e.length>0){const n=window.localStorage.getItem("device-id");let i="";if(null!=e.find((t=>t.deviceId==n)))i=n;else for(let t=0;t<e.length;t++){const n=e[t].kind,o=e[t].deviceId;e[t].groupId,"audioinput"==n&&""==i&&(i=o)}0!=e.length&&e.map((e=>{t.find(".device-modal-group").append('<option value="'+e.deviceId+'">'+e.label+"</option>"),i==e.deviceId&&t.find(".device-modal-group").val(e.deviceId)}))}})).catch((t=>{})),t}}const cn=1,ln=2,dn=3;class mn{constructor(){this.instance=null,this.isShow=!1,this.currentType=1,this.jumpFn=null}static getInstance(){return this.instance||(this.instance=new mn,this.instance.initEvent()),this.instance}onCheck(t){if(""!=window.location.hash){const e=window.location.hash;if(e){const n=e.substr(e.indexOf("=")+1,e.length),i=JSON.parse(decodeURIComponent(n)),o=i.code;-1008==o?(mn.getInstance().show(1,i.data.tel),this.jumpFn=t):-1009==o?(mn.getInstance().show(2),this.jumpFn=t):-1010==o&&(mn.getInstance().show(3),this.jumpFn=t)}}}initEvent(){}show(t=1,e=""){switch(si.show("#verify_pup_box","block"),this.isShow=!0,window.$("#ctl00_mainContent_txt_phone_3").attr("disabled",!1),this.currentType=t,window.$("#ctl00_mainContent_txt_phone_3").val(e),t){case cn:window.$(".verify_title").text("手机号安全验证"),window.$("#ctl00_mainContent_txt_phone_3").attr("disabled",!0),window.$("#button_verify").text("登录");break;case ln:case dn:window.$(".verify_title").text("手机号绑定"),window.$("#button_verify").text("绑定")}}hide(){this.isShow=!1,si.hide("#verify_pup_box")}verify(t,e){this.currentType==cn?t():e()}}class hn{constructor(){this.instance=null,this.timer=null,this.fisrtLoaded=!1}static getInstance(){return this.instance||(this.instance=new hn),this.instance}setSrc(t=!1){const e=this;0!=this.fisrtLoaded||t?(this.timer&&(clearTimeout(this.timer),this.timer=null),this.fisrtLoaded=!0,this.loadHtml()):this.timer||(this.timer=setTimeout((()=>{this.loadHtml(),e.fisrtLoaded=!0}),2e3))}loadHtml(){window.$("#iframeim").attr("src",("y-dev.tuwan.com"===window.location.host?1==Tt?"https://y-test.tuwan.com":"https://y.tuwan.com":Mt.domain)+"/imddnew")}}function un(t){this.mode=gn.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(let e=0,n=this.data.length;e<n;e++){let t=[],n=this.data.charCodeAt(e);n>65536?(t[0]=240|(1835008&n)>>>18,t[1]=128|(258048&n)>>>12,t[2]=128|(4032&n)>>>6,t[3]=128|63&n):n>2048?(t[0]=224|(61440&n)>>>12,t[1]=128|(4032&n)>>>6,t[2]=128|63&n):n>128?(t[0]=192|(1984&n)>>>6,t[1]=128|63&n):t[0]=n,this.parsedData.push(t)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function pn(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}un.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(let e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},pn.prototype={addData:function(t){let e=new un(t);this.dataList.push(e),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(let n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(let t=0;t<this.moduleCount;t++)this.modules[n][t]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=pn.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(let n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(let i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){let t=0,e=0;for(let n=0;n<8;n++){this.makeImpl(!0,n);let i=Cn.getLostPoint(this);(0==n||t>i)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){let i=t.createEmptyMovieClip(e,n);this.make();for(let o=0;o<this.modules.length;o++){let t=1*o;for(let e=0;e<this.modules[o].length;e++){let n=1*e;this.modules[o][e]&&(i.beginFill(0,100),i.moveTo(n,t),i.lineTo(n+1,t),i.lineTo(n+1,t+1),i.lineTo(n,t+1),i.endFill())}}return i},setupTimingPattern:function(){for(let t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(let t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){let t=Cn.getPatternPosition(this.typeNumber);for(let e=0;e<t.length;e++)for(let n=0;n<t.length;n++){let i=t[e],o=t[n];if(null==this.modules[i][o])for(let t=-2;t<=2;t++)for(let e=-2;e<=2;e++)this.modules[i+t][o+e]=-2==t||2==t||-2==e||2==e||0==t&&0==e}},setupTypeNumber:function(t){let e=Cn.getBCHTypeNumber(this.typeNumber);for(let n=0;n<18;n++){let i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(let n=0;n<18;n++){let i=!t&&1==(e>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(t,e){let n=this.errorCorrectLevel<<3|e,i=Cn.getBCHTypeInfo(n);for(let o=0;o<15;o++){let e=!t&&1==(i>>o&1);o<6?this.modules[o][8]=e:o<8?this.modules[o+1][8]=e:this.modules[this.moduleCount-15+o][8]=e}for(let o=0;o<15;o++){let e=!t&&1==(i>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=e:o<9?this.modules[8][15-o-1+1]=e:this.modules[8][15-o-1]=e}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){let n=-1,i=this.moduleCount-1,o=7,s=0;for(let a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(let n=0;n<2;n++)if(null==this.modules[i][a-n]){let r=!1;s<t.length&&(r=1==(t[s]>>>o&1)),Cn.getMask(e,i,a-n)&&(r=!r),this.modules[i][a-n]=r,o--,-1==o&&(s++,o=7)}if(i+=n,i<0||this.moduleCount<=i){i-=n,n=-n;break}}}},pn.PAD0=236,pn.PAD1=17,pn.createData=function(t,e,n){let i=Tn.getRSBlocks(t,e),o=new Rn;for(let a=0;a<n.length;a++){let e=n[a];o.put(e.mode,4),o.put(e.getLength(),Cn.getLengthInBits(e.mode,t)),e.write(o)}let s=0;for(let a=0;a<i.length;a++)s+=i[a].dataCount;if(o.getLengthInBits()>8*s)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*s+")");for(o.getLengthInBits()+4<=8*s&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*s||(o.put(pn.PAD0,8),o.getLengthInBits()>=8*s));)o.put(pn.PAD1,8);return pn.createBytes(o,i)},pn.createBytes=function(t,e){let n=0,i=0,o=0,s=new Array(e.length),a=new Array(e.length);for(let d=0;d<e.length;d++){let r=e[d].dataCount,c=e[d].totalCount-r;i=Math.max(i,r),o=Math.max(o,c),s[d]=new Array(r);for(let e=0;e<s[d].length;e++)s[d][e]=255&t.buffer[e+n];n+=r;let l=Cn.getErrorCorrectPolynomial(c),m=new Sn(s[d],l.getLength()-1).mod(l);a[d]=new Array(l.getLength()-1);for(let t=0;t<a[d].length;t++){let e=t+m.getLength()-a[d].length;a[d][t]=e>=0?m.get(e):0}}let r=0;for(let d=0;d<e.length;d++)r+=e[d].totalCount;let c=new Array(r),l=0;for(let d=0;d<i;d++)for(let t=0;t<e.length;t++)d<s[t].length&&(c[l++]=s[t][d]);for(let d=0;d<o;d++)for(let t=0;t<e.length;t++)d<a[t].length&&(c[l++]=a[t][d]);return c};let gn={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},fn={L:1,M:0,Q:3,H:2},wn=0,vn=1,_n=2,yn=3,xn=4,bn=5,$n=6,kn=7,Cn={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){let e=t<<10;for(;Cn.getBCHDigit(e)-Cn.getBCHDigit(Cn.G15)>=0;)e^=Cn.G15<<Cn.getBCHDigit(e)-Cn.getBCHDigit(Cn.G15);return(t<<10|e)^Cn.G15_MASK},getBCHTypeNumber:function(t){let e=t<<12;for(;Cn.getBCHDigit(e)-Cn.getBCHDigit(Cn.G18)>=0;)e^=Cn.G18<<Cn.getBCHDigit(e)-Cn.getBCHDigit(Cn.G18);return t<<12|e},getBCHDigit:function(t){let e=0;for(;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return Cn.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case wn:return(e+n)%2==0;case vn:return e%2==0;case _n:return n%3==0;case yn:return(e+n)%3==0;case xn:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case bn:return e*n%2+e*n%3==0;case $n:return(e*n%2+e*n%3)%2==0;case kn:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){let e=new Sn([1],0);for(let n=0;n<t;n++)e=e.multiply(new Sn([1,In.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case gn.MODE_NUMBER:return 10;case gn.MODE_ALPHA_NUM:return 9;case gn.MODE_8BIT_BYTE:case gn.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case gn.MODE_NUMBER:return 12;case gn.MODE_ALPHA_NUM:return 11;case gn.MODE_8BIT_BYTE:return 16;case gn.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case gn.MODE_NUMBER:return 14;case gn.MODE_ALPHA_NUM:return 13;case gn.MODE_8BIT_BYTE:return 16;case gn.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){let e=t.getModuleCount(),n=0;for(let o=0;o<e;o++)for(let i=0;i<e;i++){let s=0,a=t.isDark(o,i);for(let n=-1;n<=1;n++)if(!(o+n<0||e<=o+n))for(let r=-1;r<=1;r++)i+r<0||e<=i+r||0==n&&0==r||a==t.isDark(o+n,i+r)&&s++;s>5&&(n+=3+s-5)}for(let o=0;o<e-1;o++)for(let i=0;i<e-1;i++){let e=0;t.isDark(o,i)&&e++,t.isDark(o+1,i)&&e++,t.isDark(o,i+1)&&e++,t.isDark(o+1,i+1)&&e++,0!=e&&4!=e||(n+=3)}for(let o=0;o<e;o++)for(let i=0;i<e-6;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(n+=40);for(let o=0;o<e;o++)for(let i=0;i<e-6;i++)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);let i=0;for(let o=0;o<e;o++)for(let n=0;n<e;n++)t.isDark(n,o)&&i++;return n+=10*(Math.abs(100*i/e/e-50)/5),n}},In={glog:function(t){if(t<1)throw new Error("glog("+t+")");return In.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return In.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(let $=0;$<8;$++)In.EXP_TABLE[$]=1<<$;for(let $=8;$<256;$++)In.EXP_TABLE[$]=In.EXP_TABLE[$-4]^In.EXP_TABLE[$-5]^In.EXP_TABLE[$-6]^In.EXP_TABLE[$-8];for(let $=0;$<255;$++)In.LOG_TABLE[In.EXP_TABLE[$]]=$;function Sn(t,e){if(null==t.length)throw new Error(t.length+"/"+e);let n=0;for(;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(let i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function Tn(t,e){this.totalCount=t,this.dataCount=e}function Rn(){this.buffer=[],this.length=0}Sn.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){let e=new Array(this.getLength()+t.getLength()-1);for(let n=0;n<this.getLength();n++)for(let i=0;i<t.getLength();i++)e[n+i]^=In.gexp(In.glog(this.get(n))+In.glog(t.get(i)));return new Sn(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;let e=In.glog(this.get(0))-In.glog(t.get(0)),n=new Array(this.getLength());for(let i=0;i<this.getLength();i++)n[i]=this.get(i);for(let i=0;i<t.getLength();i++)n[i]^=In.gexp(In.glog(t.get(i))+e);return new Sn(n,0).mod(t)}},Tn.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],Tn.getRSBlocks=function(t,e){let n=Tn.getRsBlockTable(t,e);if(null==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);let i=n.length/3,o=[];for(let s=0;s<i;s++){let t=n[3*s+0],e=n[3*s+1],i=n[3*s+2];for(let n=0;n<t;n++)o.push(new Tn(e,i))}return o},Tn.getRsBlockTable=function(t,e){switch(e){case fn.L:return Tn.RS_BLOCK_TABLE[4*(t-1)+0];case fn.M:return Tn.RS_BLOCK_TABLE[4*(t-1)+1];case fn.Q:return Tn.RS_BLOCK_TABLE[4*(t-1)+2];case fn.H:return Tn.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},Rn.prototype={get:function(t){let e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){let e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};let Mn=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function An(){let t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;let n=e.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(t=parseFloat(n[1]))}return t}let Pn=function(){let t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){let e=this._htOption,n=this._el,i=t.getModuleCount();function o(t,e){let n=document.createElementNS("http://www.w3.org/2000/svg",t);for(let i in e)e.hasOwnProperty(i)&&n.setAttribute(i,e[i]);return n}Math.floor(e.width/i),Math.floor(e.height/i),this.clear();let s=o("svg",{viewBox:"0 0 "+String(i)+" "+String(i),width:"100%",height:"100%",fill:e.colorLight});s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(s),s.appendChild(o("rect",{fill:e.colorLight,width:"100%",height:"100%"})),s.appendChild(o("rect",{fill:e.colorDark,width:"1",height:"1",id:"template"}));for(let a=0;a<i;a++)for(let e=0;e<i;e++)if(t.isDark(a,e)){let t=o("use",{x:String(a),y:String(e)});t.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),s.appendChild(t)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),jn="svg"===document.documentElement.tagName.toLowerCase()?Pn:"undefined"==typeof CanvasRenderingContext2D?function(){let t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){let e=this._htOption,n=this._el,i=t.getModuleCount(),o=Math.floor(e.width/i),s=Math.floor(e.height/i),a=['<table style="border:0;border-collapse:collapse;">'];for(let d=0;d<i;d++){a.push("<tr>");for(let n=0;n<i;n++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+o+"px;height:"+s+"px;background-color:"+(t.isDark(d,n)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");let r=n.childNodes[0],c=(e.width-r.offsetWidth)/2,l=(e.height-r.offsetHeight)/2;c>0&&l>0&&(r.style.margin=l+"px "+c+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}():function(){let t=An();function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(t&&t<=2.1){let t=1/window.devicePixelRatio,e=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(n,i,o,s,a,r,c,l,d){if("nodeName"in n&&/img/i.test(n.nodeName))for(let e=arguments.length-1;e>=1;e--)arguments[e]=arguments[e]*t;else void 0===l&&(arguments[1]*=t,arguments[2]*=t,arguments[3]*=t,arguments[4]*=t);e.apply(this,arguments)}}function n(t,e){let n=this;if(n._fFail=e,n._fSuccess=t,null===n._bSupportDataURI){let t=document.createElement("img"),e=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)},i=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};return t.onabort=e,t.onerror=e,t.onload=i,void(t.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}let i=function(t,e){this._bIsPainted=!1,this._android=An(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(t){let e=this._elImage,n=this._oContext,i=this._htOption,o=t.getModuleCount(),s=i.width/o,a=i.height/o,r=Math.round(s),c=Math.round(a);e.style.display="none",this.clear();for(let l=0;l<o;l++)for(let e=0;e<o;e++){let o=t.isDark(l,e),d=e*s,m=l*a;n.strokeStyle=o?i.colorDark:i.colorLight,n.lineWidth=1,n.fillStyle=o?i.colorDark:i.colorLight,n.fillRect(d,m,s,a),n.strokeRect(Math.floor(d)+.5,Math.floor(m)+.5,r,c),n.strokeRect(Math.ceil(d)-.5,Math.ceil(m)-.5,r,c)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&n.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},i}();function Dn(t,e){let n=1,i=function(t){let e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}(t);for(let o=0,s=Mn.length;o<=s;o++){let t=0;switch(e){case fn.L:t=Mn[o][0];break;case fn.M:t=Mn[o][1];break;case fn.Q:t=Mn[o][2];break;case fn.H:t=Mn[o][3]}if(i<=t)break;n++}if(n>Mn.length)throw new Error("Too long data");return n}const Ln=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:fn.H},"string"==typeof e&&(e={text:e}),e)for(let n in e)this._htOption[n]=e[n];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(jn=Pn),this._android=An(),this._el=t,this._oQRCode=null,this._oDrawing=new jn(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)};function En(t,e){t.each((function(t,n){n.addEventListener("keydown",(function(t){13===t.keyCode&&(e.click(),n.blur())}))}))}Ln.prototype.makeCode=function(t){this._oQRCode=new pn(Dn(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},Ln.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},Ln.prototype.clear=function(){this._oDrawing.clear()},Ln.CorrectLevel=fn;const Bn={loginSuccessCB:function(){},registSuccessCB:function(){},tempCallback:null,openLoginWindow:function(t){Ct.setCookie("u_source","dd",1,"."+window.MAIN_DOMAIN),si.show("#index_pup_box","block"),"diandiankaihei.com"==window.MAIN_DOMAIN&&window.$("#login-forget-container").addClass("hide"),window.$(".QQ").attr("href",`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/url.ashx?app=qq&redirect_uri="+encodeURIComponent(Zn())),window.$(".Wechat").attr("href",`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/url.ashx?app=weixin&redirect_uri="+encodeURIComponent(Zn())),this.tempCallback=t},closeLoginWindow:function(){si.hide("#index_pup_box")},loginSuccess:function(){this.loginSuccessCB(),this.tempCallback&&this.tempCallback()},registSuccess:function(){this.registSuccessCB()}},Fn=[{key:"mobile",text:"短信验证码登录"},{key:"password",text:"用户名密码登录"},{key:"qrcode",text:"扫码登录"}];let Un="mobile";class zn{static create(){const t=window.$(`\n            <div id="index_pup_box">\n                <div class="entry_pop_box">\n                    <div class="entry_pop_content">\n                        <div class="layer-cell-close"></div>\n                        <div class="enroll_box">\n                            <div class="fl">\n                                <div class="fl enroll enroll_add">登录</div>\n                                <div class="fl enroll">注册</div>\n        \n                            </div>\n                            <div class="clearfix"></div>\n                        </div>\n                        <div class="fl" style="width:430px;">\n                            <div class="hide">\n                                <input type="text" placeholder="">\n                                <input type="password">\n                            </div>\n                            <div class="enroll_content" data-type="password" style="display: none;">\n                                <div class="register_box">\n                                    <div class="register">\n                                        <label> 账号</label>\n                                        <input type="text" placeholder="请输入用户名/手机号" id="username" required>\n                                        <div class="dislocation dislocation_02 usernameMsg"></div>\n                                    </div>\n                                    <div class="register">\n                                        <label>密码</label>\n                                        <input type="password" id="pwd" placeholder="请输入密码" required>\n                                        <div class="dislocation dislocation_02 passwordMsg"></div>\n                                    </div>\n                                    \x3c!--<div class="register">\n                                        <label>验证码</label>\n                                        <input type="text" placeholder="验证码" required id="txtLoginYzm" class="yanzheng identifying" required autocomplete="false">\n                                        <div class="dislocation dislocation_04 codeMsg"></div>\n                                        <a style="padding-left: 20px" href="javascript:;" onclick="window.loadcode('code', 82, 30);"><img id="code" src=""></a>\n                                    </div>--\x3e\n                                </div>\n        \n                                <div class="voluntarily_box">\n                                    <input type="checkbox" checked class="fl voluntarily01"><span></span>\n                                    <div class="fl voluntarily02">下次自动登录</div>\n                                    <a href="javascript:;" id="forgetpwd" target="_blank" title="忘记密码？">\n                                        <div class="fr voluntarily03" id="login-forget-container">忘记密码?</div>\n                                    </a>\n                                </div>\n                                <button class="identif_go mt35" id="button_login">登录</button>\n                            </div>\n                            <div class="enroll_content"  data-type="mobile" >\n                                <div class="register_box">\n                                    <div class="register" id="dd_sms_sigup">\n                                        <label> 手机</label>\n                                        <input type="number" placeholder="请输入手机号" required id="ctl00_mainContent_txt_phone_2" style="line-height: 1px;">\n                                        <div class="dislocation dislocation_01 phone_tishi" ></div>\n                                    </div>\n                                    <div class="register">\n                                        <label>验证码</label>\n                                        <input type="text"  placeholder="验证码" class="identifying yanzheng" required id="phonecode2" autocomplete="false">\n                                        <div class="dislocation dislocation_0aa dislocation_04 codeMsg2"></div>\n                                        <button class="identif yanzheng_02 dd_get_code" id="getcode2">获取验证码</button>\n                                    </div>\n                                </div>\n                                <div class="voluntarily_box">\n                                    <input type="checkbox" checked class="fl voluntarily01"><span></span>\n                                    <div class="fl voluntarily02">下次自动登录</div>\n                                </div>\n                                <button class="identif_go mt35" id="button_login2">登录</button>\n                            </div>\n                            <div class="enroll_content qrcodelogin" style="display: none;" data-type="qrcode" >\n                                <div id="qrcode">\n    \n                                </div>\n                                <div class="qrcode-notice">\n                                <img src="https://asset.tuwan.com/images/logo64.png" > 点点开黑APP扫码登录\n                                </div>\n                            </div>\n\n\n                            <div class="enroll_content" data-type="register" style="display: none;">\n                                <div class="register_box">\n                                    <div class="register">\n                                        <label> 手机</label>\n                                        <input type="text" placeholder="请输入手机号" required id="ctl00_mainContent_txt_phone">\n                                        <div class="dislocation dislocation_01" id="phone_tishi"></div>\n                                    </div>\n                                    <div class="register">\n                                        <label>用户名</label>\n                                        <input type="text" placeholder="请输入用户名" required id="user_name">\n                                        <div class="dislocation dislocation_02" id="username_tishi"></div>\n                                    </div>\n                                    <div class="register">\n                                        <label>密码</label>\n                                        <input type="password" placeholder="请输入密码" required id="userpwd">\n                                        <div class="dislocation dislocation_03" id="userpwd_tishi"></div>\n                                    </div>\n                                    <div class="register">\n                                        <label>验证码</label>\n                                        <input type="text" placeholder="验证码" class="identifying yanzheng" required id="phonecode" autocomplete="false">\n                                        <div class="dislocation dislocation_0aa dislocation_04"></div>\n                                        <button class="identif yanzheng_02 dd_get_code" id="getcode">获取验证码</button>\n                                    </div>\n                                </div>\n                                <input type="radio" class="fl radio_01" checked="checked" required>\n                                <a class="radio_box fl" href="https://${window.location.host}/events/userpoolpc" target="_blank"><span>已阅读并同意</span>《点点开黑用户使用协议》</a>\n                                <div class="clearfix"></div>\n                                <button class="identif_go mt35" id="button_post1">注册</button>\n                            </div>\n                        </div>\n                        <div class="fr entry_wbox mt50">\n                            <div class="entry_01">第三方账号登录</div>\n                            <a class="Wechat" data-ddlog='{"eventid":"10002","field1":"2"}' href="javascript:;">\n                                <div class="entry_w"><img src="https://res.tuwan.com/templet/teach/index/images/entry_w.png">&nbsp;微信账号登录</div>\n                            </a>\n                            <a class="QQ" data-ddlog='{"eventid":"10002","field1":"3"}' href="javascript:;">\n                                <div class="entry_qq"><img src="https://res.tuwan.com/templet/teach/index/images/entry_qq.png">&nbsp;QQ账号登录</div>\n                            </a>\n                            <div class="entry_01" style="margin-top: 40px">其他登录方式</div>\n\n                            <div class="login_list" >\n                                <div class="entry_mobile" data-logintype="password" >用户名密码登录</div>\n                                <div class="entry_mobile" data-logintype="qrcode" >扫码登录</div>\n                            </div>\n\n                        </div>\n                        <div class="clearfix"></div>\n                    </div>\n                </div>\n            </div>\n        `);return t.find("#code").attr("src",`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/action.ashx?t=verification&w=82&h=30&rand="+Math.random()),t.find("#forgetpwd").attr("href",`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/resetpwd/"),t.find(".dd_get_code").click((function(){window.$(".dd_get_code").unbind(),qn()})),t.find("#button_login").click((function(){window.$("#button_login").unbind(),qn()})),t.find("#button_post1").click((function(){Gn((function(){var t=window.$("#ctl00_mainContent_txt_phone").val(),e=window.$("#user_name").val(),n=window.$("#userpwd").val(),i=window.$("#phonecode").val(),o=new Object;o.n=e,o.p=n,o.t=t,o.c=i,window.packSendData_general(o),window.sreg(e,n,t,i,(function(t){"0"==t.code?window.location.href=Zn():window.$(".dislocation_0aa").html(t.msg)}))}))})),t.find("#button_login2").on("click",(function(){!function(){var t=window.$("#ctl00_mainContent_txt_phone_2").val(),e=window.$("#phonecode2").val();if(""==e)return void window.$(".codeMsg2").text("请输入验证码");var n=new Object;n.c=e,n.t=t;var i=window.packSendData_general(n);window.$.ajax({type:"post",url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/smslogin",dataType:"jsonp",jsonp:"callback",data:{data:i},success:function(t){t.code,0==1*t.code?(window.$(".enroll_content input").val(""),Wn=0,Bn.loginSuccess(),hn.getInstance().setSrc()):window.$(".codeMsg2").html(t.msg)}})}()})),t.find(".enroll").click((function(){if(window.$(".enroll").removeClass("enroll_add"),window.$(this).addClass("enroll_add"),window.$(this).index(),window.$(".enroll_content").hide(),"注册"==window.$(this).text())window.$(".enroll_content[data-type=register]").show();else{let t=[...window.$(".entry_mobile").map(((t,e)=>e.dataset.logintype))],e=Fn.find((e=>!t.includes(e.key)));window.$(`.enroll_content[data-type=${e.key}]`).show()}})),t.find(".entry_mobile").click((function(){window.$(".enroll").removeClass("enroll_add"),window.$(".enroll").eq(0).addClass("enroll_add");const t=this.dataset.logintype,e=window.$(this).siblings()[0].dataset.logintype;Un=t;let n=Fn.find((n=>n.key!=t&&n.key!=e));window.$(this).attr("data-logintype",n.key),window.$(this).html(n.text),clearTimeout(ni),"qrcode"==t&&ii(),window.$(`.enroll_content[data-type=${t}]`).show().siblings().hide()})),t.find("#ctl00_mainContent_txt_phone").blur((function(){Vn()})),t.find("#user_name").blur((function(){window.$(".dislocation_box").eq(0).css("display","none"),Hn()})),t.find(".layer-cell-close").on("click",(function(t){t.stopPropagation(),si.hide("#index_pup_box")})),t.find("#ctl00_mainContent_txt_phone_2").on("input",(function(t){let e=`${t.target.value}`;e.length>11&&(e=e.substring(0,11),$("#ctl00_mainContent_txt_phone_2").val(e))})),setTimeout((()=>{Jn()}),0),En(t.find(".enroll_content[data-type='password'] input"),t.find("#button_login")),En(t.find(".enroll_content[data-type='mobile'] input"),t.find("#button_login2")),En(t.find(".enroll_content[data-type='register'] input"),t.find("#button_post1")),t}}class On{static create(){const t=window.$('\n            <div id="verify_pup_box">\n                <div class="entry_pop_box">\n                    <div class="entry_pop_content">\n                        <div class="verify_pup_close"></div>\n                        <div class="enroll_box"><div class="verify_title"></div></div>\n                        <div>\n                            <div class="register_box">\n                                <div class="register" id="dd_sms_verify">\n                                    <label> 手机</label>\n                                    <input id="ctl00_mainContent_txt_phone_3" type="text" placeholder="请输入手机号" required="" >\n                                    <div class="dislocation dislocation_01 phone_tishi"></div>\n                                </div>\n\n                                <div class="register">\n                                    <label>验证码</label>\n                                    <input type="text" placeholder="验证码" class="identifying yanzheng" required="" id="phonecode3" autocomplete="false">\n                                    <div class="dislocation dislocation_0aa dislocation_04 codeMsg3"></div>\n                                    <button class="identif yanzheng_02 dd_get_code" id="getcode3">获取验证码</button>\n                                </div>\n                            </div>\n\n                            <button class="identif_go mt35" id="button_verify">登录</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ');return t.find(".verify_pup_close").click((()=>{mn.getInstance().hide()})),t.find("#button_verify").on("click",(function(){!function(){var t=window.$("#ctl00_mainContent_txt_phone_3").val(),e=window.$("#phonecode3").val();if(""==e)return void window.$(".codeMsg3").text("请输入验证码");var n=new Object;mn.getInstance().currentType!=cn&&(n.tel=t);n.code=e;var i=window.packSendData_general(n);window.$.ajax({type:"post",url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/smsverify",dataType:"jsonp",jsonp:"callback",data:{data:i},success:function(t){t.code,0==1*t.code?(Wn=0,window.$("#phonecode3").val(""),mn.getInstance().currentType!=dn&&(mn.getInstance().jumpFn?mn.getInstance().jumpFn():Bn.loginSuccess(),hn.getInstance().setSrc()),mn.getInstance().hide()):window.$(".codeMsg3").html(t.msg)}})}()})),t.find(".dd_get_code").click((function(){window.$(".dd_get_code").unbind(),qn()})),En(t.find("input"),t.find("#button_verify")),setTimeout((()=>{Jn()}),0),t}}var Nn=!1;function qn(){Nn||(Nn=!0,window.$.ajax({url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/getSlider.ashx?t="+(new Date).getTime(),type:"get",dataType:"jsonp",success:function(t){window.initGeetest({gt:t.gt,challenge:t.challenge,product:"bind",offline:!t.success,new_captcha:t.new_captcha},Qn)}}))}function Gn(t){Vn((function(){Hn((function(){!function(t){if(""==window.$("#userpwd").val())return void window.$("#userpwd_tishi").html("密码不能为空");if(window.$("#userpwd").val().length>20||window.$("#userpwd").val().length<6)return void window.$("#userpwd_tishi").html("密码不符合要求");if(window.$("#userpwd").val()==window.$("#user_name").val())return void window.$("#userpwd_tishi").html("密码不能和用户名相同");if(window.$("#userpwd").val()==window.$("#ctl00_mainContent_txt_phone").val())return void window.$("#userpwd_tishi").html("密码不能和手机号相同");window.$("#userpwd_tishi").html('<img src="//res.tuwan.com/templet/teach/index/images/ture.png"/>'),t&&t()}(t)}))}))}function Vn(t){var e=window.$("#ctl00_mainContent_txt_phone").val();if(!/^1\d{10}$/.test(e))return window.$("#phone_tishi").text("手机号必须为11位数字"),void window.$("#checkall_phone").val(0);var n=new Object;n.username=e,n.platform="mobile";var i=window.packSendData_general(n);window.$.ajax({type:"post",url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/chkuser",dataType:"jsonp",data:{data:i},success:function(e){if(0!=e.code)return window.publicKey=e.data,void window.$("#phone_tishi").text(e.msg);window.$("#phone_tishi").html('<img src="//res.tuwan.com/templet/teach/index/images/ture.png"/>'),t&&t()}})}function Hn(t){var e=window.$("#user_name").val(),n=new RegExp("[%--`~!#@$^&*()\\s=|{}':;',\\[\\].<>/?~！@￥……&*（）——|{}【】‘；：”“'。，、？\"]"),i=new RegExp("[0-9]+");if(e.length>15||e.length<3)window.$("#username_tishi").html("用户名格式不符合要求");else if(null==e.match(n))if(e.match(i)!=e){var o=new Object;o.username=e,o.platform="pc";var s=window.packSendData_general(o);window.$.ajax({type:"post",url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/chkuser",dataType:"jsonp",data:{data:s},success:function(e){if(0!=e.code)return window.publicKey=e.data,void window.$("#username_tishi").text(e.msg);window.$("#username_tishi").html('<img src="//res.tuwan.com/templet/teach/index/images/ture.png"/>'),t&&t()}})}else window.$("#username_tishi").html("用户名不能为纯数字");else window.$("#username_tishi").html("用户名包含敏感字符")}var Wn=60,Kn=null;function Yn(t){if(Wn<=0)return t.removeAttr("disabled"),t.html("获取验证码"),void(Wn=60);t.attr("disabled","disabled"),t.html("重新发送("+Wn+")"),Wn--,Kn=setTimeout((function(){Yn(t)}),1e3)}function Jn(){if(Kn&&(window.clearTimeout(Kn),Kn=null),Wn<60){let t="登录"==window.$(".enroll.enroll_add").text()?window.$("#getcode2"):window.$("#getcode");mn.getInstance().isShow&&(t=window.$("#getcode3")),Yn(t)}}var Qn=function(t){function e(){mn.getInstance().isShow?mn.getInstance().verify((()=>t.verify()),(()=>Xn(window.$("#ctl00_mainContent_txt_phone_3").val(),(function(){t.verify()}),window.$("#dd_sms_verify")))):"登录"==window.$(".enroll.enroll_add").text()?"password"==Un?t.verify():Xn(window.$("#ctl00_mainContent_txt_phone_2").val(),(function(){t.verify()}),window.$("#dd_sms_sigup")):Gn((function(){t.verify()}))}window.$(document).on("click",".dd_get_code",(function(t){e()})),window.$(document).on("click","#button_login",(function(t){e()})),t.onReady((function(){e()})).onSuccess((function(){var e=t.getValidate();if(!e)return;var n=new Object;n.c=e.geetest_challenge,n.v=e.geetest_validate,n.s=e.geetest_seccode;let i="登录"==window.$(".enroll.enroll_add").text()?window.$("#getcode2"):window.$("#getcode");if("登录"!=window.$(".enroll.enroll_add").text()||"password"!=Un||mn.getInstance().isShow){mn.getInstance().isShow?(mn.getInstance().currentType==cn?n.t="verify":n.t=window.$("#ctl00_mainContent_txt_phone_3").val(),i=window.$("#getcode3")):(n.g="登录"==window.$(".enroll.enroll_add").text()?"sms_login":"",n.t="登录"==window.$(".enroll.enroll_add").text()?window.$("#ctl00_mainContent_txt_phone_2").val():window.$("#ctl00_mainContent_txt_phone").val());var o=window.packSendData_general(n);window.$.ajax({url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/requestCode.ashx?t="+(new Date).getTime(),dataType:"jsonp",jsonp:"callback",data:{data:o},success:function(t){0==t.code?Yn(i):t&&t.msg&&Vt(t.msg)}})}else!function(t){var e=window.$("#username").val(),n=window.$("#pwd").val(),i=new Object;i.u=e,i.p=n,i.c=t.geetest_challenge,i.v=t.geetest_validate,i.s=t.geetest_seccode;var o=window.packSendData_general(i);window.$.ajax({type:"post",url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/loginv2",dataType:"jsonp",jsonp:"callback",data:{data:o},success:function(t){t.code;var e=1*t.code;0==e?(window.$(".enroll_content input").val(""),Bn.loginSuccess(),hn.getInstance().setSrc()):-1003==e||-1004==e?window.$(".passwordMsg").html(t.msg):-1005==e?window.$(".codeMsg").html(t.msg):-1007==e||-1037==e?window.$(".passwordMsg").html("您未设置密码，请点‘忘记密码’重置密码"):-1008==e?mn.getInstance().show(1,t.data.tel):-1009==e?mn.getInstance().show(2):-1010==e&&(Bn.loginSuccess(),hn.getInstance().setSrc(),mn.getInstance().show(3))}})}(e)}))};function Xn(t,e,n){/^1\d{10}$/.test(t)?e&&e():n.find(".phone_tishi").text("手机号必须为11位数字")}function Zn(){let t=window.location.search?window.location.search+"&from=chatroom":"?from=chatroom";return window.location.origin+window.location.pathname+t}let ti="",ei=null,ni=0;function ii(){const t={c:ti},e=window.packSendData_general(t);window.$.ajax({url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/qrcode",dataType:"jsonp",jsonp:"callback",data:{data:e},success:t=>{1037!=t.code&&(0!=t.code&&-1001!=t.code?(ti=t.data,null==ei?ei=new Ln("qrcode",{text:ti,width:200,height:200,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Ln.CorrectLevel.H}):(ei.clear(),ei.makeCode(ti))):0==t.code&&window.location.reload()),ni=setTimeout((()=>{ii()}),2e3)}})}const oi=new Map;class si{static factoryClassWithType(t){switch(t){case".draw_game_modal":return Ee;case".draw_result_modal":return Be;case".div-biaobai":return Fe;case".room_rule_modal":return ze;case"#index_pup_box":return zn;case"#verify_pup_box":return On;case".channel-guanming":return Oe;case".div-guanming":return qe;case".carteam-xuanyan-mask":return He;case".temp-autocar-shang-mask":return We;case".authentication-mask":return Ke;case".catgame-create-mask":return Ye;case".lolqu-mask":return Je;case".openbox-mask":return on;case".shouhu-mask":return ai;case".shouhu-help-mask":return ri;case".room_invite_modal":return sn;case".device-setting-modal":return rn;default:return null}}static show(t,e="flex"){let n=oi.get(t);if(!n){const e=this.factoryClassWithType(t);if(!e)return void console.error(`类型：${t}，未找到对应的工厂类`);const i=e.create();if(!i)return;n="string"==typeof i?window.$(i):i,window.$("body").append(n),oi.set(t,n)}return n.css("display",e),n}static hide(t){const e=oi.get(t);e&&(oi.delete(t),e.remove())}}class ai{static create(){const t=window.$('\n            \x3c!-- 守护浮层 --\x3e\n            <div class="shouhu-mask">\n                <div class="shouhu-main">\n                    <ul class="flex shouhu-tabs">\n                    </ul>\n                    <div class="shouhu-content">\n                        <div class="shouhu-header-wrapper">\n                            <h3></h3>\n                            <span></span>\n                        </div>\n                        <div class="shouhu-subheader-wrapper"><span></span></div>\n                        <div class="shouhu-content-wrapper flex  flex-ac flex-jc">\n                        </div>\n                        <div class="shouhu-btn-wrapper">\n                            <div class="shouhu-btn"></div>\n                        </div>\n                    </div>\n                    <div class="shouhu-close"></div>\n                </div>\n            </div>\n        ');return t.find("ul").on("click","li",ai.shouhuLiClick),t.find(".shouhu-btn").on("click",ai.shouhuBtnClick),t.find(".shouhu-close").on("click",(t=>{si.hide(".shouhu-mask")})),t}}class ri{static create(){const t=window.$('\n            <div class="shouhu-help-mask">\n                <div class="shouhu-help-main">\n                    <div>\n                        <p style="color: #333333; font-size: 22px;">守护特权</p>\n                        <div class="shouhu-help-content">\n                            <ol>\n                                <li>昵称前显示专属守护图标；</li>\n                                <li>可获得对应守护麦位上麦权限；</li>\n                                <li>送礼物可进入专属守护排行榜；</li>\n                            </ol>\n                            <div style="text-indent: 20px">其他：</div>\n                            <ol>\n                                <li>加入守护即可获得7天守护时间；</li>\n                                <li>每次续费延长7天守护时间；</li>\n                            </ol>\n                        </div>\n                        <div class="shouhu-help-btn">\n                            <span>关闭</span>\n                        </div>\n                    </div>\n                    <div class="shouhu-close"></div>\n                </div>\n            </div>\n        ');return t.find(".shouhu-close, .shouhu-help-btn").on("click",(t=>{si.hide(".shouhu-help-mask")})),t}}const ci=new class{constructor(){this.timing=null,this.countDownTiming=null,this.parentEle=window.$(".room-buttons"),this.sec=29,this.countDownSec=0,this.type={shangmai:{tag:"shangmai",text:"上麦",style:{background:"#f58"}},xiamai:{tag:"xiamai",text:"下麦"},zhaoren:{tag:"zhaoren",text:"找人"},zhandui:{tag:"zhandui",text:"战队"},pipei:{tag:"pipei",text:"匹配"},shiyin:{tag:"shiyin",text:"试音",style:{background:"#f58"}},diandan:{tag:"diandan",text:"点单"},ktvdiandan:{tag:"ktvdiandan",text:""},ktvdiandannum:{tag:"ktvdiandannum",text:""},paidan:{tag:"paidan",text:"派单",style:{background:"#bf38dc"}},paidanover:{tag:"paidanover",text:"完成派单",style:{background:"#bf38dc"}},creatteam:{tag:"creatteam",text:"创建车队"},yaoqing:{tag:"yaoqing",text:"邀请队友"},startteam:{tag:"startteam",text:"发车"},musiclist:{tag:"musiclist",text:"点歌"},myteam:{tag:"myteam",text:"我的车队"},jiesanteam:{tag:"jiesanteam",text:"解散车队",style:{background:"#b3b3b3"}},exitteam:{tag:"exitteam",text:"退出车队",style:{background:"#b3b3b3"}},werewolfMatch:{tag:"werewolfMatch",text:"匹配",style:{background:"#3347ec"}},exittempteam:{tag:"exittempteam",text:"退出车队"},closeteam:{tag:"closeteam",text:"关闭车队"},wolfSignIn:{tag:"wolfSignIn",text:"签到"},baodang:{tag:"baodang",text:"VIP"},countdown:{tag:"countdown",text:"00:00"},paidankefu:{tag:"paidankefu",text:0,style:{background:"#bf38dc"}},diandanself:{tag:"diandanself",text:0},diandananchor:{tag:"diandananchor",text:0},daotime:{tag:"daotime",text:30},heart:{tag:"heart",text:""},jingpai:{tag:"jingpai",text:"竞拍"},startjingpai:{tag:"startjingpai",text:"开始竞拍"},endjingpai:{tag:"endjingpai",text:"结束竞拍"},newCarModeBack:{tag:"newCarModeBack",text:"返回",style:{background:"#3347ec"}},newCarModeLeave:{tag:"newCarModeLeave",text:"离开"},newCarModeGo:{tag:"newCarModeGo",text:"Go"},inviteByChatRoom:{tag:"inviteByChatRoom",text:"邀请"},startLive:{tag:"startLive",text:"开始比赛"},endLive:{tag:"endLive",text:"结束比赛"},shouhu:{tag:"shouhu",text:"上麦",style:{width:"64px",height:"64px","border-radius":"100%","justify-content":"center","align-items":"center",background:"#f58",margin:"0 5px",padding:"0 10px","font-size":"16px",color:"#fff","line-height":"1","z-index":10,"box-sizing":"border-box","text-align":"center",cursor:"pointer","background-size":"64px"}},inshouhunum:{tag:"inshouhunum",text:"0",style:{width:"64px",height:"64px",background:"url(https://asset.tuwan.com/images/ktvdiandannum3.png?a) center center","font-size":"24px","font-weight":"bold",color:"#fff","padding-bottom":"20px","background-size":"64px"}},takeme:{tag:"takeme",text:"麦序",style:{width:"64px",height:"64px","border-radius":"100%","justify-content":"center","align-items":"center",background:"#f58",margin:"0 5px",padding:"0 10px","font-size":"16px",color:"#fff","line-height":"1","z-index":10,"box-sizing":"border-box","text-align":"center",cursor:"pointer","background-size":"64px"}},takemeOrder:{tag:"takemeOrder",text:"麦序",style:{width:"64px",height:"64px","border-radius":"100%","justify-content":"center","align-items":"center",background:"#f58",margin:"0 5px",padding:"0 10px","font-size":"16px",color:"#fff","line-height":"1","z-index":10,"box-sizing":"border-box","text-align":"center",cursor:"pointer","background-size":"64px"}},queueListManager:{tag:"queueListManager",text:"麦序",style:{width:"64px",height:"64px","border-radius":"100%","justify-content":"center","align-items":"center",background:"#f58",margin:"0 5px",padding:"0 10px","font-size":"16px",color:"#fff","line-height":"1","z-index":10,"box-sizing":"border-box","text-align":"center",cursor:"pointer","background-size":"64px"}},takemenum:{tag:"takemenum",text:"0",style:{width:"64px",height:"64px",background:"url(https://asset.tuwan.com/images/ktvdiandannum3.png?a) center center","font-size":"24px","font-weight":"bold",color:"#fff","padding-bottom":"20px","background-size":"64px"}},drawForceQuit:{tag:"drawForceQuit",text:"结束游戏"},catGameCreate:{tag:"catGameCreate",text:"创建"},queueList:{tag:"queueList",text:"列队"},songLeave:{tag:"songLeave",text:"离开"},smallKtvLeave:{tag:"smallKtvLeave",text:"离开"},leaveConfirm:{tag:"leaveConfirm",text:"离开"},marryBtn:{tag:"marryBtn",text:"",style:{width:"76px",height:"76px","border-radius":"unset",background:"url(https://asset.tuwan.com/activity/marry/btn.png) center center"}},sendGameRole:{tag:"sendGameRole",text:"游戏"},changeTemplate:{tag:"changeTemplate",text:"切换模板"},createSelfWolfRoom:{tag:"createSelfWolfRoom",text:"创建"},createSpyRoom:{tag:"createSpyRoom",text:"创建"},matchCodeImg:{tag:"matchCodeImg",text:"对局"},peaceTeamBtn:{tag:"peaceTeamBtn",text:"战队"},jinchanchan:{tag:"jinchanchan",text:"匹配"}}}hide(t=0){0==t?this.parentEle.find("div").removeClass("show"):this.parentEle.find("div[data-num='"+t+"']").removeClass("show"),this.countDownTiming&&2==t&&uu.isTempCarteamRoom()&&clearInterval(this.countDownTiming)}getNumButton(t){return this.parentEle.find("div[data-num='"+t+"']")}getButtons(t){return this.parentEle.find("div").get(t-1).dataset.type}show(t,e,n){if("paidan"==e.tag||"paidanover"==e.tag||"diandan"==e.tag||"ktvdiandan"==e.tag)return;const i=this.parentEle.find("div[data-num='"+t+"']"),o=n||e.text,s=e.style||{},a={};for(let r in s)a[r]=s[r];if(i.attr("data-type",e.tag),i.addClass("show"),"daotime"==e.tag&&this.daoTime(i),"countdown"==e.tag)return i.text(e.text),i.css(a),void this.countDown(i,n);5==t||(i.text(o),i.css(a))}shows(t,e){t.forEach(((t,n)=>{const i=e[n].tag;"startteam"==i?this.show(t,e[n],"开车"):uu.isShengyouFreeRoom()&&"exitteam"==i?uu.isCanChoiceCreateCarTempRoom()?0==uu.roomInfo.game_type?this.show(t,e[n],"退出车队"):this.show(t,e[n],"退出歌房"):this.show(t,e[n],"退出"+uu.getCarButtonStr()):uu.isShengyouFreeRoom()&&"jiesanteam"==i?uu.isCanChoiceCreateCarTempRoom()?0==uu.roomInfo.game_type?this.show(t,e[n],"解散车队"):this.show(t,e[n],"解散歌房"):this.show(t,e[n],"解散"+uu.getCarButtonStr()):this.show(t,e[n])}))}daoTime(t){this.timing=setInterval((()=>{if(this.sec<=0)return clearInterval(this.timing),this.timing=null,this.sec=29,void this.show(1,this.type.shangmai);t.text(this.sec--+"秒")}),1e3)}countDown(t,e){clearInterval(this.countDownTiming),this.countDownSec=e,this.countDownTiming=setInterval((()=>{if(this.countDownSec<=0)return clearInterval(this.countDownTiming),this.countDownSec=null,this.countDownSec=0,void this.hide(2);let e="0"+Math.floor(this.countDownSec/60),n="0"+this.countDownSec%60,i=e.substring(e.length-2,e.length),o=n.substring(n.length-2,n.length);t.text(i+":"+o),this.countDownSec--}),1e3)}clearTime(){this.timing&&(clearInterval(this.timing),this.timing=null)}clearCountDownTime(){this.countDownTiming&&(clearInterval(this.countDownTiming),this.countDownTiming=null)}clear(){window.$(".room-buttons > div").removeAttr("style"),window.$(".room-buttons > div").removeClass("show")}};class li{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new li,this.instance.giftInfo=null,this.instance.onEventListener(),this.instance.gloabShouhuPayType=-1,this.instance.cb1=null,this.instance.cb2=null,this.instance.cb3=null,this.instance.cb4=null,this.instance.cb5=null),this.instance}setCallBackFn(t,e,n,i,o){this.cb1=t,this.cb2=e,this.cb3=n,this.cb4=i,this.cb5=o}onEventListener(){const t=this;ai.shouhuLiClick=function(e){const n=e.currentTarget.dataset.index;t.showGuardDialog(n)},ai.shouhuBtnClick=function(e){if(-1==e.currentTarget.dataset.type)return void si.hide(".shouhu-mask");const n=uu.getCid(),i=t.getAnchoringInfo();i?(t.payShouHu(i.uid,i.nickname,n,e.currentTarget.dataset),si.hide(".shouhu-mask")):Vt("当前主持不在线.")},window.$(".right-bang-self-fixed").on("click",".guard-rejoin-but",(function(){const e=this.dataset.typeid;t.getGuardGiftsInfo().then((n=>{t.showGuardDialog(e)})).catch((t=>{Vt(t)}))})),window.$(".right-bang-join-fixed").on("click","button",(function(){uu.getMeid()>Mt.maxUID?t.cb5&&t.cb5.call():t.getGuardGiftsInfo().then((e=>{t.showGuardDialog(1)})).catch((t=>{Vt(t)}))})),window.$(document).on("click",".shouhu-help-icon",(function(){si.show(".shouhu-help-mask","block")}))}onSeat(t,e,n){if(t.uid>0)return;const i=uu.getMeid();uu.getCid();const o=uu.getAnchoringUserId(),s=1*t.aposition,a=t.level;if(2==s)uu.isAnchors2(i)?e.call(this,i,uu.getCid()):Ct.Alert("非主播请上守护位");else{if(0==o)return void Ct.Alert("现无主持，请主持上座后再上守护位");if(i!=o){this.isGuard(o,a)?(n.call(this,i),this.cb4(i)):this.getGuardGiftsInfo().then((t=>{this.showGuardDialog(a)})).catch((t=>{Vt(t)}))}else Vt("主持自己就不要守护自己啦..")}}getUserColor(t){let e="#666";const n=bt.getUserInfo(1*t);return n&&(e=n.color||"#666"),e}payShouHu(t,e,n,i){const o=i.giftid,s="id="+o+"&platform=0&&num=1&uids="+t+"&anonymous=0&actid=100&cid="+n,a=Ot.payDiamond(s),r=uu.getMeid(),c=this;let l=this.getUserColor(t);const d={count:1,currentGiftTime:Ct.dateFormat(new Date,"-"),from:r,giftid:o,platforms:1,giftname:i.giftname,gifttype:i.gifttype,pathpic:i.pathpic,lovetypeid:i.lovetypeid,pathsvga:i.pathsvga,guardpic:i.guardpic,guardtital:i.guardtital,showtype:i.showtype,gifsrc:i.gifsrc,tipstype:i.tipstype,boxname:"",boxnum:0,type:101,guardranking:0,isshouhu:1,days:7,guardtype:this.gloabShouhuPayType,touserinfo:[{lastGiftNum:0,lastGiftTime:"",userid:t,username:e,color:l}]},m=10*i.diamond;qt.get(a).then((e=>{const n=e.error;0==n?(c.cb1(101,d),c.hideGuardDialog()):-2==n?(c.cb2(t,1,o,m,d),c.hideGuardDialog()):Ct.Alert(e.error_msg)}))}getAnchoringInfo(){let t=null;for(let e of uu.anchorUsers.values())if(2==e.position){t=e;break}return t}renderGuardInfo(t=1){const e=this.giftInfo[t-1],{seat_pic:n,seat_title:i,trea_pic:o,trea_title:s}=e;window.$(".shouhu-content-wrapper").empty(),window.$(".shouhu-content-wrapper").append('<div class="shouhu-content-info flex flex-dir-col flex-ac flex-jc">\n            <div class="shouhu-content-info-pic flex flex-ac flex-jc">\n                <img src="'+n+'"/>\n            </div>\n            <span lass="shouhu-content-info-title">'+i+"</span>\n        </div>"),window.$(".shouhu-content-wrapper").append('<div class="shouhu-content-info  flex flex-dir-col flex-ac flex-jc">\n            <div class="shouhu-content-info-pic flex flex-ac flex-jc">\n                <img src="'+o+'"/>\n            </div>\n            <span lass="shouhu-content-info-title">'+s+"</span>\n        </div>")}setShouHuButAttr(t=1){if(-1==t)return void window.$(".shouhu-btn").attr({"data-type":t});const e=this.giftInfo[t-1];window.$(".shouhu-btn").attr({"data-type":t,"data-lovetypeid":e.typeid,"data-pathpic":e.giftPic,"data-tipstype":e.tipstype,"data-pathsvga":e.svga_app,"data-gifttype":e.giftType,"data-gifsrc":e.svga_pc,"data-giftname":e.giftTitle,"data-showtype":e.showType,"data-giftId":e.giftid,"data-guardpic":e.trea_pic,"data-guardtital":e.title,"data-diamond":e.diamond})}showBeBeGuardDialog(t){si.show(".shouhu-mask","block"),window.$(".shouhu-tabs").addClass("hide"),window.$(".shouhu-btn").removeClass("blue"),window.$(".shouhu-subheader-wrapper").removeClass("hide"),window.$(".shouhu-header-wrapper span").text(""),window.$(".shouhu-content-info-pic").addClass("not");let e="您已获得"+t.giftname+"资格";window.$(".shouhu-header-wrapper h3").text(e);const n=this.giftInfo.find((e=>e.giftid==t.giftid));n&&(this.renderGuardInfo(n.typeid),window.$(".shouhu-subheader-wrapper span").text(t.giftname+"特权")),window.$(".shouhu-btn").text("确定"),this.setShouHuButAttr(-1)}showGuardDialog(t=1){si.show(".shouhu-mask","block"),window.$(".shouhu-tabs").removeClass("hide");let e="";1==t?e="黄金守护专属特权":2==t?e="白银守护专属特权":3==t&&(e="青铜守护专属特权");let n=window.$(".shouhu-main ul").find("li");0==n.length&&(this.giftInfo.map(((t,e)=>{window.$(".shouhu-main ul").append('<li data-index="'+(e+1)+'"><span>'+t.giftTitle+"</span></li>")})),n=window.$(".shouhu-main ul").find("li")),n.removeClass("current"),n.eq(t-1).addClass("current"),window.$(".shouhu-header-wrapper h3").text(e),this.renderGuardInfo(t);const i=this.giftInfo[t-1];if(window.$(".shouhu-subheader-wrapper").addClass("hide"),window.$(".shouhu-btn").removeClass("blue"),window.$(".shouhu-header-wrapper span").text(""),window.$(".shouhu-content-info-pic").removeClass("not"),this.isGuard(uu.getAnchoringUserId(),t)){let e="";const n=uu.getSelfInfo().guard;for(let i=0;i<n.length;i++){n[i].hostuid,n[i].cid;const o=n[i].typeids;for(let n=0;n<o.length;n++){const i=o[n];t==i.typeid&&(e=i.eday)}}window.$(".shouhu-header-wrapper span").text("守护剩余:"+e),window.$(".shouhu-btn").text("续费").addClass("blue")}else window.$(".shouhu-content-info-pic").addClass("not"),window.$(".shouhu-btn").text(i.diamond+"钻/"+i.day+"天 开通守护");this.setShouHuButAttr(t)}hideGuardDialog(){si.hide(".shouhu-mask")}getGuardGiftsInfo(){return new Promise(((t,e)=>{null!=this.giftInfo&&t(this.giftInfo),qt.get(Ot.getGuardGifts()).then((n=>{0==n.error?(this.giftInfo=Array.from(n.data),t(this.giftInfo)):e(n.err_msg)})).catch((t=>e("网络错误,请稍后再试")))}))}isGuard(t,e=-1){const n=uu.getSelfInfo().guard;let i=!1;for(let o=0;o<n.length;o++){const s=n[o],a=s.hostuid,r=s.cid;if(a==t&&r==uu.getCid()){const t=s.typeids;if(-1==e)i=!0;else if(t.length>0)for(let n=0;n<t.length;n++){t[n].typeid==e&&(i=!0)}}}return i}joinTalk(){const t=uu.getAnchoringUserId();0!=t?this.isGuard(t,-1)?this.cb3&&this.cb3("setorder",0,uu.getMeid()):this.getGuardGiftsInfo().then((t=>{this.showGuardDialog()})).catch((t=>{Vt(t)})):Ct.Alert("现无主持，请主持上座后再上守护位")}getGuardComp(t){const e=this,n=uu.getAnchoringUserId();n&&qt.get(Ot.getGuardNum(n,uu.getCid())).then((i=>{if(0==i.error)if(window.$(".guard-header-num span").text(i.data),e.isGuard(n)){window.$(".guard-footer-info-level").text(t.treaname+"剩余:"),window.$(".right-bang-self-fixed .guard-footer-info-num span").text(t.score_total),window.$(".right-bang-self-fixed .guard-footer-header img").attr("src",t.avatar),window.$(".right-bang-self-fixed .guard-footer-info-lasttime").text(t.eday),window.$(".right-bang-self-fixed .guard-footer-info-top").text(t.rank);let e=3;"黄金守护"==t.treaname?e=1:"白银守护"==t.treaname&&(e=2),window.$(".right-bang-self-fixed .guard-rejoin-but").attr("data-typeid",e),window.$(".right-bang-self-fixed").show()}else window.$(".right-bang-join-text").html('主播已有<span style="color: #ff4c82">'+i.data+"名守护</span>,快来加入吧!"),window.$(".right-bang-join-fixed").show()})).catch((t=>{}))}onResetButton(){uu.getAnchoringUserId()!=uu.getMeid()?uu.isInAnchors(uu.getMeid())?ci.hide(2,ci.type.shouhu):ci.show(2,ci.type.shouhu):ci.getButtons(2)!=ci.type.inshouhunum.tag&&ci.show(2,ci.type.inshouhunum)}onReset(){this.gloabShouhuPayType=-1,window.$(".right-bang-join-fixed").hide(),window.$(".right-bang-self-fixed").hide(),this.onResetButton()}}const di={msg:"",fontSize:32,fontColor:"#E5E5E5",fontMode:"roll",fontArea:"full",fontAreaPercent:.25,rollTime:0,rolledDistance:0,top:0};let mi;const hi=window.WebKitCSSMatrix||window.DOMMatrix||window.MSCSSMatrix;let ui,pi;mi=window.getComputedStyle&&hi?t=>{const e=window.getComputedStyle(t,null).getPropertyValue("transform");return Number(new hi(e).m41)}:t=>{const e=window.getComputedStyle(t,null).getPropertyValue("transform");return Number(e.match(/[+-]?\d+/g)[4])},void 0!==document.hidden?(ui="hidden",pi="visibilitychange"):void 0!==document.msHidden?(ui="msHidden",pi="msvisibilitychange"):void 0!==document.webkitHidden&&(ui="webkitHidden",pi="webkitvisibilitychange");class gi{constructor(t){this._container=t.container,this._totalWidth=null,this._totalHeight=null,this._trackSize=100,this._renderInterval=parseInt(t.renderInterval)||150,this._renderTimer=null,this._queue=[],this._tracks=null,this._autoId=0,this.resize(),this._resetTracks(),this._onVisibilityChange=()=>{document[ui]?this.pause():this._resumeTimer=setTimeout((()=>{this.resume()}),200)},document.addEventListener(pi,this._onVisibilityChange,!1)}resize(){this._totalWidth=window.screen.width+200,this._totalHeight=this._container.offsetHeight,this.clearScreen()}pause(){this._resumeTimer&&clearTimeout(this._resumeTimer),this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._paused||(this._paused=!0,this._eachDanmakuNode(((t,e,n)=>{const i=this._findData(e,n);i&&(i.rolledDistance=-mi(t),t.style.transition="",t.style.transform=`translateX(-${i.rolledDistance}px)`)})))}resume(){this._paused&&(this._eachDanmakuNode(((t,e,n)=>{const i=this._findData(e,n);i&&(i.startTime=Date.now(),i.rollTime=(i.totalDistance-i.rolledDistance)/i.rollSpeed,t.style.transition=`transform ${i.rollTime}s linear`,t.style.transform=`translateX(-${i.totalDistance}px)`)})),this._paused=!1,this._renderTimer||this._render())}clearScreen(){this._clearDanmakuNodes(),this._resetTracks()}_resetTracks(){const t=Math.floor(this._totalHeight/this._trackSize);this._tracks=new Array(t);for(let e=0;e<t;e++)this._tracks[e]=[];this._maxAmountPerRender=Math.floor(t/3)}_eachDanmakuNode(t){let e,n,i=this._container.firstChild;for(;i;)1===i.nodeType&&(n=i.getAttribute("data-y"),e=i.getAttribute("data-id"),n&&e&&t(i,Number(n),Number(e))),i=i.nextSibling}_clearDanmakuNodes(){const t=[];this._eachDanmakuNode((e=>{t.push(e)})),t.forEach((t=>{this._container.removeChild(t)}))}_parseData(t){return Object.assign({autoId:++this._autoId},di,t)}add(t){this._queue.push(this._parseData(t)),this._renderTimer||this._render()}_addToTrack(t){let e,n,i,o=[];const s=Date.now();for(let a=0;a<this._tracks.length;a++)if(e=this._tracks[a],e.length?(n=e[e.length-1],i=n.rolledDistance+n.rollSpeed*(s-n.startTime)/1e3,i>n.width&&(t.rollSpeed<=n.rollSpeed||(i-n.width)/(t.rollSpeed-n.rollSpeed)>(this._totalWidth+n.width-i)/n.rollSpeed)?o.push(a):o=[]):o.push(a),o.length&&o.length>=t.useTracks){t.y=o,o.forEach((e=>{this._tracks[e].push(t)}));break}}_removeFromTrack(t,e){t.forEach((t=>{const n=this._tracks[t];for(let i=0;i<n.length;i++)if(n[i].autoId===e){n.splice(i,1);break}}))}_findData(t,e){const n=this._tracks[t];for(let i=0;i<n.length;i++)if(n[i].autoId===e)return n[i]}_render(){if(!this._paused)try{this._renderToDOM()}finally{this._renderEnd()}}_renderToDOM(){let t=this._maxAmountPerRender,e=0;for(;t&&e<this._queue.length;){const n=this._queue[e];let i=n.node;if(!i){if(n.node=i=document.createElement("div"),i.innerHTML=n.msg,i.style.position="absolute",i.style.left="100%",i.style.whiteSpace="nowrap",i.style.color=n.fontColor,i.style.fontSize=n.fontSize+"px",i.style.willChange="transform",this._container.appendChild(i),n.useTracks=Math.ceil(i.offsetHeight/this._trackSize),n.useTracks>this._tracks.length){this._queue.splice(e,1),this._container.removeChild(i);continue}n.width=i.offsetWidth,n.totalDistance=n.width+this._totalWidth,n.rollTime=n.rollTime||Math.floor(.0058*n.totalDistance),n.rollSpeed=n.totalDistance/n.rollTime}this._addToTrack(n),n.y?(this._queue.splice(e,1),i.setAttribute("data-id",n.autoId),i.setAttribute("data-y",n.y[0]),i.style.top=n.y[0]*this._trackSize+"px",i.style.transition=`transform ${n.rollTime}s linear`,i.style.transform=`translateX(-${n.totalDistance}px)`,i.addEventListener("transitionstart",(()=>{n.startTime=Date.now()}),!1),i.addEventListener("transitionend",(()=>{i.style.transition&&(this._removeFromTrack(n.y,n.autoId),this._container.removeChild(i))}),!1),n.startTime=Date.now()+80):e++,t--}}_renderEnd(){this._queue.length>0?this._renderTimer=setTimeout((()=>{this._render()}),this._renderInterval):this._renderTimer=null}}function fi(t,e,n){var i;return function(){var o=this,s=arguments,a=n&&!i;clearTimeout(i),i=setTimeout((function(){i=null,n||t.apply(o,s)}),e),a&&t.apply(o,s)}}function wi(t,e,n){return void 0===n&&(n=2),parseFloat(Math.min(t+Math.random()*(e-t),e).toFixed(n))}let vi,_i={width:window.innerWidth,height:window.innerHeight};class yi{constructor(t,e,n){this.DOM={},this.options={shapeTypes:["circle","rect","polygon"],shapeColors:["#e07272","#0805b5","#49c6ff","#8bc34a","#1e1e21","#e24e81","#e0cd24"],shapeFill:!0,shapeStrokeWidth:1},Object.assign(this.options,n),this.type=t||this.options.shapeTypes[0],("random"===this.type||this.options.types.includes(this.type))&&("random"===this.type&&(this.type=this.options.shapeTypes[wi(0,this.options.shapeTypes.length-1,0)]),this.letterRect=e,this.init())}init(){this.DOM.el=document.createElementNS("http://www.w3.org/2000/svg",this.type),this.DOM.el.style.opacity=0,this.configureShapeType(),this.options.shapeFill?this.DOM.el.setAttribute("fill",this.options.shapeColors[wi(0,this.options.shapeColors.length-1,0)]):(this.DOM.el.setAttribute("fill","none"),this.DOM.el.setAttribute("stroke-width",this.options.shapeStrokeWidth),this.DOM.el.setAttribute("stroke",this.options.shapeColors[wi(0,this.options.shapeColors.length-1,0)]))}configureShapeType(){if(this.DOM.el.style.transformOrigin=`${this.letterRect.left+this.letterRect.width/2}px ${this.letterRect.top+this.letterRect.height/2}px`,"circle"===this.type){const t=.5*this.letterRect.width;this.DOM.el.setAttribute("r",t),this.DOM.el.setAttribute("cx",this.letterRect.left+this.letterRect.width/2),this.DOM.el.setAttribute("cy",this.letterRect.top+this.letterRect.height/2)}else if("rect"===this.type){const t=wi(.05,.5,3)*this.letterRect.width,e=wi(.05,.5,3)*this.letterRect.height;this.DOM.el.setAttribute("width",t),this.DOM.el.setAttribute("height",e),this.DOM.el.setAttribute("x",this.letterRect.left+(this.letterRect.width-t)/2),this.DOM.el.setAttribute("y",this.letterRect.top+(this.letterRect.height-e)/2)}else"polygon"===this.type&&this.DOM.el.setAttribute("points",`${this.letterRect.left} ${this.letterRect.top+this.letterRect.height}, ${this.letterRect.left+this.letterRect.width/2} ${this.letterRect.bottom-this.letterRect.width}, ${this.letterRect.left+this.letterRect.width} ${this.letterRect.top+this.letterRect.height}`)}onResize(t){this.letterRect=t,this.configureShapeType()}}class xi{constructor(t,e,n){this.DOM={},this.DOM.el=t,this.DOM.svg=e,this.options={totalShapes:10},Object.assign(this.options,n),this.rect=this.DOM.el.getBoundingClientRect(),this.totalShapes=this.options.totalShapes,this.init(),this.initEvents()}init(){this.shapes=[];for(let t=0;t<=this.totalShapes-1;++t){const t=new yi("random",this.rect,this.options);this.shapes.push(t),this.DOM.svg.appendChild(t.DOM.el)}}initEvents(){window.addEventListener("resize",fi((()=>{this.rect=this.DOM.el.getBoundingClientRect();for(let t=0;t<=this.totalShapes-1;++t){this.shapes[t].onResize(this.rect)}}),20))}}class bi{constructor(t,e){this.DOM={},this.DOM.el=t,this.options={shapesOnTop:!1},Object.assign(this.options,e),this.init(),this.initEvents()}init(){this.createSVG(),K(this.DOM.el),this.letters=[],Array.from(this.DOM.el.querySelectorAll("span")).forEach((t=>this.letters.push(new xi(t,this.DOM.svg,this.options))))}initEvents(){window.addEventListener("resize",fi((()=>{_i={width:window.innerWidth,height:window.innerHeight},this.DOM.svg.setAttribute("width",`${_i.width}px`),this.DOM.svg.setAttribute("height",`${_i.width}px`),this.DOM.svg.setAttribute("viewbox",`0 0 ${_i.width} ${_i.height}`)}),20))}createSVG(){this.DOM.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.DOM.svg.setAttribute("class","shapes"),this.DOM.svg.setAttribute("width",`${_i.width}px`),this.DOM.svg.setAttribute("height",`${_i.width}px`),this.DOM.svg.setAttribute("viewbox",`0 0 ${_i.width} ${_i.height}`),this.options.shapesOnTop?this.DOM.el.parentNode.insertBefore(this.DOM.svg,this.DOM.el.nextSibling):this.DOM.el.parentNode.insertBefore(this.DOM.svg,this.DOM.el)}show(t){return this.toggle("show",t)}hide(t){return this.toggle("hide",t)}toggle(t="show",e){return new Promise(((n,i)=>{const o=()=>{for(let e=0,n=this.letters.length;e<=n-1;++e)this.letters[e].DOM.el.style.opacity="show"===t?1:0;n()};if(e&&0!==Object.keys(e).length){if(e.shapesAnimationOpts)for(let t=0,n=this.letters.length;t<=n-1;++t){const n=this.letters[t];setTimeout(function(t){return()=>{e.shapesAnimationOpts.targets=t.shapes.map((t=>t.DOM.el)),window.anime.remove(e.shapesAnimationOpts.targets),window.anime(e.shapesAnimationOpts)}}(n),e.lettersAnimationOpts&&e.lettersAnimationOpts.delay?e.lettersAnimationOpts.delay(n.DOM.el,t):0)}e.lettersAnimationOpts?(e.lettersAnimationOpts.targets=this.letters.map((t=>t.DOM.el)),e.lettersAnimationOpts.complete=()=>{if("hide"===t)for(let t=0,n=e.lettersAnimationOpts.targets.length;t<=n-1;++t)e.lettersAnimationOpts.targets[t].style.transform="none";n()},window.anime(e.lettersAnimationOpts)):o()}else o()}))}}class $i{constructor(){this.emitter=new Ht,this.player=null,this.parentId=null}static getAliplayerFlashComponent(){if(!$i.AliplayerFlashComponent){var t=window.Aliplayer.Component({init:function(){},created:function(t){this.player=t},createEl:function(t){const e=this;window.$(t).find(".prism-controlbar").append("<div class='prism-flash-button'></div>"),window.$(t).on("click",".prism-controlbar .prism-flash-button",(()=>{console.log(e.player),null!=e.player&&(window.$(".prism-flash-button").css("animation","turn 1s linear infinite"),e.player.loadByUrl(e.player._originalUrl))}))},play:function(t,e){setTimeout((()=>{window.$(".prism-flash-button").css("animation","none")}),1e3)}});$i.AliplayerFlashComponent=t}return $i.AliplayerFlashComponent}async play(t){await Ct.loadScript("https://asset1.tuwan.com/officialsite/css/aliplayer-min.css"),await Ct.loadScript("https://asset1.tuwan.com/officialsite/script/aliplayer-min.js"),this.parentId=t.ele;const e=new window.Aliplayer({id:t.ele,source:t.flvurl,autoplay:!0,isLive:!0,rePlay:!1,playsinline:!0,preload:!0,hlsFrameChasing:!0,flvFrameChasing:!0,enableStashBufferForFlv:!0,stashInitialSizeForFlv:32,controlBarVisibility:t.controlBarVisibility||"hover",useH5Prism:!0,width:"100%",height:"100%",components:[{name:"flashComponent",type:$i.getAliplayerFlashComponent()}],skinLayout:[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"infoDisplay"},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"liveDisplay",align:"tlabs",x:15,y:6},{name:"fullScreenButton",align:"tr",x:10,y:10},{name:"volume",align:"tr",x:5,y:10}]}]});"chrome"==Ct.is360Browser()&&e.setVolume(0),uu.isBattleRoom()&&"safari"==Ct.is360Browser()&&e.setVolume(0),e.on("ready",(t=>{this.emitter.emit("ready",t)})),e.on("play",(t=>{this.emitter.emit("play",t)})),e.on("pause",(t=>{this.emitter.emit("pause",t)})),e.on("error",(t=>{this.emitter.emit("error",t)})),e.on("liveStreamStop",(t=>{this.emitter.emit("liveStreamStop",t)})),this.player=e}setVolume(t){this.player&&this.player.setVolume(t)}getVolume(){return this.player?this.player.getVolume():0}pause(){this.player&&this.player.pause()}replay(t){this.player&&this.player.loadByUrl(t)}destroy(){this.player&&(this.player.pause(),this.player.dispose(),this.player=null,document.querySelector("#"+this.parentId).innerHTML="")}isPlaying(){if(this.player){const t=this.player.getStatus();return"play"==t||"playing"==t||"waiting"==t||"play"==t||"ready"==t||"loading"==t}return!1}}function ki(t){qt.get(Ot.getCheckHomepage(t)).then((e=>{1==e.data.home_view&&window.open(Mt.domain+`/play/${t}/`,"_blank")}))}const Ci="600px";let Ii=0;class Si{constructor(){this.instance=null,this.context=null,this.isFullScreen=!1,this.startDanmu=!1,this.danmaku=null,this.danmuSwitch=!0,this.narratorUid=0,this.narratorColor="",this.narratorName="",this.controllerBarMouseIn=!1,this.beforVolume=0,this.steamList=null,this.currentSteam="url_fhd"}static getInstance(){return this.instance||(this.instance=new Si,this.instance.onEventListener(),this.instance.initDanmu()),this.instance}initDanmu(){const t=document.getElementById("danmu");this.danmaku=new gi({container:t})}_getWinnerHtml(t,e,n,i,o){if(1==e){let e=n.find((e=>e.id==t));return e?'<p class="battle-confirm-select" data-id='+t+" data-typeid="+o+" > "+e.team+" </p>":'<p class="battle-confirm-select" data-typeid='+o+"> </p>"}{let e=i.find((e=>e.uid==t));return e?'<p class="battle-confirm-select" data-id='+t+" data-typeid="+o+"> "+e.name+" </p>":'<p class="battle-confirm-select" data-typeid='+o+"> </p>"}}_getResultListHtml(t,e){const n=this,{result:i,team:o}=t;window.$(".battle-confirm-mask").remove();const s=window.$('<div class="mask battle-confirm-mask flex flex-ac flex-jc">\n                    <div class="battle-confirm-container">\n                       <div class="battle-confirm-title">最终结果确认</div>\n                       <div class="battle-confirm-warpper flex flex-ac flex-dir-col">\n                            <div class="battle-confirm-info">\n\n                            </div>\n                            <div class="battle-confirm-but" data-gid="'+e+'">确认结束</div>\n                       </div>\n                       <div class="mask-close"></div>\n                    </div>\n\n            </div>');window.$("body").append(s);let a=[];o.map((t=>{a=a.concat(t.userlist)}));let r=window.$("<ul></ul>");a.map((t=>{const{uid:e,name:n}=t;r.append("<li data-id="+e+">"+n+"</li>")}));let c=window.$("<ul></ul>");o.map((t=>{const{team:e,id:n}=t;c.append("<li data-id="+n+">"+e+"</li>")}));const l=window.$(".battle-confirm-info");i.map((t=>{const{typeid:e,title:i,guess_typeid:s,winer:d}=t,m=1==s?c:r,h=n._getWinnerHtml(d,s,o,a,e);l.append('<div class="battle-confirm-item flex flex-jc flex-ac">\n                                       <div class="battle-confirm-item-question">'+i+'</div>\n                                       <div class="battle-confirm-select-warpper">\n                                            '+h+'\n                                            <div class="battle-confirm-option" style="display: none">\n                                            <ul>'+m.html()+"</ul>\n                                            </div>\n                                       </div>\n                                   </div>")}));const d=s.find(".mask-close");d.on("click",(function t(){d.off("click",t),s.remove()}))}onConfirmRes(t,e){const n=this;qt.get(Ot.getResultList(t,e)).then((t=>{0==t.error?n._getResultListHtml(t.data,e):Ct.Alert(t.error_msg)})).catch((t=>{console.log(t),Ct.Alert("网络错误,请稍后再试..")}))}onHideControllBar(){const t=this;t.controllerBarMouseIn=!1,setTimeout((()=>{if(!t.controllerBarMouseIn){if(t.isFullScreen&&"none"!=window.$(".chat-center-gift-content").css("display"))return;window.$("#new-video-controller").animate({bottom:"-50px"})}}),2e3)}checkDbClick(){(new Date).getTime()-Ii<500&&(this.isFullScreen?this.closeFullScreen():this.setFullScreen(),fe.getInstance().onHide()),Ii=(new Date).getTime(),this.onHideControllBar()}onEventListener(){const t=window.$(".chat-center"),e=window.$(".new-video-container"),n=this;let i={start:window.$(".new-video-slide").offset().left,end:window.$(".new-video-slide").offset().left+90},o=!1,s=0,a=!1,r=0;t.on("mouseenter",".army_item_wrapper",(function(t){const e=t.currentTarget.dataset.id;r!=e&&n.getTeamInfo(e);const i=window.$(".army_item_wrapper[data-id="+t.currentTarget.dataset.id+"]").offset();n.setShowTeamInfo(i.left,i.top),r=e})),t.on("mouseenter",".army_info_container",(function(t){a=!0})),e.on("mouseenter",".new-video-controller-wrapper",(function(t){n.controllerBarMouseIn=!0,window.$("#new-video-controller").animate({bottom:"0px"})})),e.on("mouseleave",".new-video-controller-wrapper",(function(t){window.$.contains(t.target,window.$(".new-video-controller-wrapper"))||n.onHideControllBar()})),window.$(document).on("click",".prism-big-play-btn.pause",(function(){n.resetVolume()})),window.$(document).on("click",".battle-question-item",(function(t){if(1==t.currentTarget.dataset.guess)return void Vt("当前题目已经竞猜过了~");window.$(".battle-guess-mask").remove();const e=t.currentTarget.dataset.gameid,n=t.currentTarget.dataset.id;document.getElementById("div-inner-guess-content").style.display="block",window.$("#iframeguess").attr("src",Mt.domain+"/betting#/pages/guess/mobile?id="+n+"&gameid="+e)})),window.$(document).on("click",".battle-confirm-select",(function(t){t.stopPropagation(),window.$(t.currentTarget).next().show()})),window.$(document).on("click",".battle-confirm-container",(function(t){window.$(".battle-confirm-option").hide()})),window.$(document).on("click",".battle-confirm-option ul li",(function(t){t.stopPropagation();const e=window.$(t.currentTarget).parent().parent(),n=e.prev();n.text(window.$(t.currentTarget).html()),n.attr("data-id",t.currentTarget.dataset.id),e.hide()})),window.$(document).on("click",".battle-confirm-but",(function(t){if(window.$(".battle-confirm-select[data-id]").length<5||0!=[...window.$(".battle-confirm-select[data-id]")].filter((t=>0==t.dataset.id)).length)return void Ct.Alert("当前还有没有选择的项目哦..");let e=[];[...window.$(".battle-confirm-select[data-id]")].map((t=>{e.push({typeid:t.dataset.typeid,id:t.dataset.id})})),window.$(".battle-confirm-mask").remove(),qt.get(Ot.onEditgame(t.currentTarget.dataset.gid,3,JSON.stringify(e))).then((t=>{0==t.error?n.getGameList():Ct.Alert(t.error_msg)})).catch((t=>{Ct.Alert("网络错误,请稍后再试..")}))})),t.on("mouseenter",".army_info_hide_move",(function(){n.setHideTeamInfo(),a=!1})),t.on("mouseleave",".army_info_container",(function(t){a&&(n.setHideTeamInfo(),a=!1)})),e.on("click","#new-video-player",(function(t){n.checkDbClick()})),e.on("click",".danmu-container",(function(t){n.checkDbClick()})),t.on("click",".army_info_item_action",(function(t){a=!1,n.setHideTeamInfo();ki(t.currentTarget.dataset.uid)})),e.on("click",".new-video-full",(function(){n.isFullScreen?n.closeFullScreen():n.setFullScreen(),fe.getInstance().onHide()})),e.on("click",".new-video-sound,.video-match-volume",(function(){if(vi){if(0==vi.getVolume()){const t=0!=n.beforVolume?n.beforVolume:.5,e=90*t;n.setVolume(t),window.$(".new-video-slide .slide").css("left",e+"px"),window.$(".new-video-slide .progress").css("width",e+"px")}else n.setVolume(0),window.$(".new-video-slide .slide").css("left","0px"),window.$(".new-video-slide .progress").css("width","0px");window.$(".video-match-volume-wrapper").remove()}})),e.on("click",".new-video-danmu",(function(){n.danmuSwitch?(n.danmaku._clearDanmakuNodes(),n.danmaku._queue=[],n.danmuSwitch=!1,window.$(".new-video-danmu").addClass("danmu-close")):(n.danmuSwitch=!0,window.$(".new-video-danmu").removeClass("danmu-close"))})),e.on("click",".new-video-screen-warpper",(function(){window.$(".new-video-screen-flash img").css("animation","turn 1s linear infinite"),window.$(".new-video-flash").css("animation","turn 1s linear infinite"),n.loadTvRoomInfo()})),e.on("click",".new-video-flash",(function(){window.$(".new-video-flash").css("animation","turn 1s linear infinite"),n.loadTvRoomInfo()})),t.on("click",".army_title_wrapper span",(function(){window.$(".battle_container").removeClass("hide"),window.$(".army_container").addClass("hide")})),t.on("click",".battle_title_wrapper span",(function(){window.$(".army_container").removeClass("hide"),window.$(".battle_container").addClass("hide")})),t.on("click",".battle_schedule_record_vote",(function(t){const e=t.currentTarget.dataset,{type:i,gid:o}=e;if("guess"==i)qt.get(Ot.getGuessList(e.mid,o)).then((t=>{if(0==t.error){if(0==t.data.length)return;n.openGuessMask(o,t.data)}})).catch((t=>{}));else{if(2==e.can&&"open"==i)return void Ct.Alert("当前比赛不能开启..");"open"==i?qt.get(Ot.onEditgame(e.gid,2)).then((t=>{0==t.error?n.getGameList():Ct.Alert(t.error_msg)})).catch((t=>{Ct.Alert("网络错误,请稍后再试..")})):"close"==i&&n.onConfirmRes(e.mid,e.gid)}})),e.on("mousemove",".new-video-slide",(function(t){o&&(s=t.clientX-i.start,s<0?(window.$(".new-video-slide .slide").css("left","0px"),window.$(".new-video-slide .progress").css("width","0px")):s<=90?(window.$(".new-video-slide .slide").css("left",s+"px"),window.$(".new-video-slide .progress").css("width",s+"px")):(window.$(".new-video-slide .slide").css("left","90px"),window.$(".new-video-slide .progress").css("width","90px")))})),e.on("mousedown",".new-video-slide",(function(t){i={start:window.$(".new-video-slide").offset().left,end:window.$(".new-video-slide").offset().left+90},null!=vi&&vi.isPlaying()&&(o=!0)})),e.on("mouseup",".new-video-slide",(function(t){o&&(o=!1,n.setVolume(s/90))})),e.on("mouseleave",".new-video-slide",(function(t){o&&(o=!1,n.setVolume(s/90))})),e.on("click",".new-video-quality-menu span",(function(t){window.$(".new-video-screen-flash img").css("animation","turn 1s linear infinite"),window.$(".new-video-flash").css("animation","turn 1s linear infinite");const e=t.currentTarget.dataset.mode;n.onSwitchQuality(e),n.playVideo(n.steamList[e])})),window.addEventListener("resize",fi((()=>{if(n.isFullScreen)window.$(".new-video-container").css({width:"100%",height:"100%"});else{const t=window.$(".battle-room-bg").width();window.$(".new-video-container").css({width:t,height:Ci})}}),20))}_isFullscreenFn(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||!1}openGuessMask(t,e){let n="";e.forEach((e=>{n+='<div data-id="'+e.id+'" data-guess="'+e.is_guess+'" data-gameid="'+t+'" class="battle-question-item flex flex-ac flex-jb"><div>'+e.title+"</div><span >去竞猜></span></div>"}));const i=window.$('<div class="mask battle-guess-mask flex flex-ac flex-jc">\n                    <div class="battle-guess-container">\n                       <div class="battle-guess-title">赛事竞猜</div>\n                       <div class="battle-question-container">\n                           '+n+'\n                       </div>\n                        <div class="mask-close"></div>\n                    </div>\n\n            </div>');window.$("body").append(i);const o=i.find(".mask-close");o.on("click",(function t(){o.off("click",t),i.remove()}))}getFullScreenStatus(){return this.isFullScreen&&uu.isBattleRoom()}setBrowserFullScreen(){const t=this;let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),window.$(window).unbind("resize"),window.$(window).bind("resize",(function(){0==t._isFullscreenFn()&&t.isFullScreen&&t.closeFullScreen()}))}closeBrowserFullScreen(){this._isFullscreenFn()&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}setFullScreen(){this.isFullScreen=!0,window.$(".chat-center-left").css("position",""),window.$("#at-user-container").css("left","90px"),window.$(".new-video-options").removeClass("hide"),window.$(".new-video-battle").addClass("full"),window.$(".new-video-container .full-input-text").append('<textarea maxlength="80"></textarea>'),window.$(".new-video-container").css("border-radius","0"),window.$(".chatroom-guanzhu").hide(),window.$(".new-video-container .new-video-full").addClass("small"),this.setBrowserFullScreen()}closeFullScreen(){this.isFullScreen=!1,window.$("#at-user-container").css("left","0"),window.$(".chat-center-left").css("position","relative"),window.$(".new-video-options").addClass("hide"),window.$(".new-video-battle").removeClass("full"),window.$(".full-input-text").empty(),window.$(".new-video-container").css("border-radius","8px"),window.$(".chatroom-guanzhu").css("display","flex"),window.$(".new-video-container .new-video-full").removeClass("small"),this.closeBrowserFullScreen()}setVolume(t){this.beforVolume=vi.getVolume(),t<=0?(vi.setVolume(0),window.$(".new-video-sound").removeClass("sound")):t>1?(vi.setVolume(1),window.$(".new-video-sound").addClass("sound")):(vi.setVolume(t),window.$(".new-video-sound").addClass("sound"))}resetVolume(){if(vi){const t=vi.getVolume();if(0!=t&&"0px"==window.$(".new-video-slide .slide").css("left")){const e=90*t;window.$(".new-video-slide .slide").css("left",e+"px"),window.$(".new-video-slide .progress").css("width",e+"px")}}}onReset(){window.$(".new-video-container").addClass("hide"),window.$(".chat-center-left").css("position","relative"),window.$(".new-video-container").css("height",Ci),window.$(window).unbind("resize"),vi&&(vi.destroy(),vi=null)}getTeamInfo(t){const e=window.$(".army_info_items_wrapper");window.$(".army_info_header_wrapper").empty(),e.empty(),qt.get(Ot.getTeamInfo(t)).then((t=>{if(window.$(".army_info_header_wrapper").empty(),e.empty(),0==t.error){const{id:n,team:i,icon:o,desc:s,game_num:a,game_win:r,game_lose:c,is_loss:l,rate:d,userlist:m,sid:h}=t.data,u='<div class="army_info_header">\n                                    <div class="army_info_icon"><img src="'+o+'"/>\n                                    </div>\n                                    '+(2==l?'<div class="army_info_status flex flex-ac flex-jc"><span>已出局</span></div>':"")+'\n                                </div>\n                                <div class="army_info_detail_wrapper">\n                                    <div class="army_info_name">'+i+'</div>\n                                    <div class="army_info_detail">战绩：<span>'+a+"</span>局 <span>"+r+"</span>胜 <span>"+r+"</span>负 </div>\n                                </div>";window.$(".army_info_header_wrapper").append(u),m.forEach((t=>{const n=1==t.is_captain?"队长：":"";e.append('<div class="army_info_item_wrapper flex flex-ac flex-jb">\n                                <div class="army_info_item_name_wrapper flex flex-ac flex-jc">\n                                    <div class="army_info_item_name_icon">\n                                        <img class="layzload-army-team-info"  src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png" data-src="'+t.avatar+'"/>\n                                    </div>\n                                    <div class="army_info_item-info">\n                                        <div class="army_info_item_name">'+n+t.name+'</div>\n                                        <div class="army_info_item_detail">战绩：'+t.game_num+"局 "+t.game_win+"胜 "+t.game_lose+"负</div>\n                                    </div>\n                                </div>\n                                \n                            </div>")})),window.lazyload(window.$(".layzload-army-team-info"))}})).catch((t=>{}))}getGameList(){if(1==uu.roomInfo.is_match){const t=this;qt.get(Ot.getGameList(uu.getCid())).then((e=>{0==e.error&&t._renderGameList(e.data)})).catch((t=>{}))}}checkHasSound(){"chrome"!=Ct.is360Browser()&&"safari"!=Ct.is360Browser()||0!=vi.getVolume()||window.$(".new-video-container.match-video-main").append('\n            \t\t<div class="video-match-volume-wrapper" style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:100%; background:rgba(0,0,0,0.3); z-index:100">\n            \t\t\t<div class="video-match-volume" style="">如果没声音，点击播放声音</div>\n            \t\t</div>\n            \t')}initTemplate(t){const e=this,n=1==uu.roomInfo.is_match?Ot.getGameState(uu.getCid()):Ot.getLiveState(uu.getCid());qt.get(n).then((n=>{if(0==n.error){const{typeid:i,defult:o,game:s,teamlist:a}=n.data;e._renderBg(o),1==i||3==i?(window.$(".army_container").removeClass("hide"),window.$(".battle_container").empty(),window.$(".new-video-container").addClass("hide")):2==i&&(e._renderGame(s),e.loadTvRoomInfo()),e._renderTeamBodyHtml(a,i),e._setNarrator(o,i,t),e._setNowBattle(o),e.getGameList()}else Vt(n.error_msg),e._renderBg({icon:"https://asset.tuwan.com/chatroom/images/battle_def_bg.png"})})).catch((t=>{}))}onSwitchQuality(t){switch(window.$(".new-video-quality-menu span").removeClass("select"),t){case"url_fhd":default:window.$(".new-video-quality-current").text("蓝光"),window.$(".new-video-quality-menu span").eq(0).addClass("select");break;case"url_hd":window.$(".new-video-quality-current").text("高清"),window.$(".new-video-quality-menu span").eq(1).addClass("select");break;case"url_sd":window.$(".new-video-quality-current").text("流畅"),window.$(".new-video-quality-menu span").eq(2).addClass("select")}this.currentSteam=t}loadTvRoomInfo(){const t=this;qt.get(Ot.getTvRoomInfo(uu.getCid())).then((e=>{if(0==e.error){const n=e.data.stream;t.steamList=n,t.playVideo(n[t.currentSteam]),t.onSwitchQuality(t.currentSteam)}})).catch((t=>{}))}_setNowBattle(t){1==uu.roomInfo.is_match?(window.$(".new-video-battle").removeClass("hide"),window.$(".new-video-title .new-video-title-span").text(t.sub_title)):window.$(".new-video-battle").addClass("hide")}_setNarrator(t,e,n){if(uu.isBattleMainSeatNotPromise()){const t=1==uu.roomInfo.is_match?Ot.getGameState(uu.getCid()):Ot.getLiveState(uu.getCid());qt.get(t).then((t=>{if(0==t.error){const{typeid:e,defult:n,game:i,teamlist:o}=t.data;uu.isAnchoringUser(uu.getMeid())?1==e||3==e?ci.show(2,ci.type.startLive):ci.show(2,ci.type.endLive):ci.hide(2)}}))}else{const{narrator_uid:i,narrator_name:o,narrator_color:s}=t;this.narratorUid=i,this.narratorName=o,this.narratorColor=s,uu.getMeid()==this.narratorUid&&0==uu.roomInfo.is_match?1==e||3==e?ci.show(0,ci.type.startLive):ci.show(0,ci.type.endLive):ci.hide(0),n.call(this,i,o,s)}}updateLive(t){qt.get(Ot.updateLive(uu.getCid(),t)).then((t=>{0!=t.error&&Ct.Alert(t.error_msg)})).catch((t=>{Ct.Alert("网络错误,请稍后再试..")}))}_renderBg(t){const e=window.$(".battle-room-content .battle-room-bg");e.empty(),e.append('<img src="'+t.icon+'"/>'),window.$(".new-video-container").css("background","url("+t.icon+")").css("background-size","cover").css("background-repeat","no-repeat").css("background-position","center")}_renderTeamBodyHtml(t,e){if(1!=uu.roomInfo.is_match)return;const n=window.$(".army_container");let i="";2==e&&(n.addClass("hide"),i="<span>对战中></span>"),n.empty(),n.append('<div class="army_title_wrapper flex flex-jb flex-ac"">\n                    <h3>参赛战队</h3>\n                    '+i+'\n                </div>\n                <div class="army_items_wrapper">\n\n                </div>'),this._renderTeamList(t)}_renderGameListItem(t,e,n){const i=this;e.forEach((e=>{const{guess:o,state:s,id:a,time:r,team:c,can_start:l,narrator_uid:d}=e,m={1:"未开始",2:"进行中",3:"已结束",4:"已取消"},h=new Date(1e3*r),u=Ct.dateFormatA(h,"."),p=Ct.dateFormatB(h);let g="";if(i.narratorUid==uu.getMeid()&&d==uu.getMeid()){if(1==s||2==s){0==window.$(".battle_schedule_record_vote[data-action=1]").length&&(1==s?g='<div data-action="1" data-type="open" data-can="'+l+'" data-mid='+n+' data-gid="'+a+'" class="battle_schedule_record_vote flex flex-ac flex-jc"><span>开启赛程</span></div>':2==s&&(g='<div data-action="1" data-type="close" data-mid='+n+' data-gid="'+a+'" class="battle_schedule_record_vote flex flex-ac flex-jc"><span>结束赛程</span></div>'))}}else d!=uu.getMeid()&&(g=1==o?'<div data-type="guess" data-mid='+n+' data-gid="'+a+'" class="battle_schedule_record_vote flex flex-ac flex-jc"><span>参与竞猜</span></div>':"");if(0!=c.length&&c.length>=2){const e=c[0],n=c[1],i='<div class="battle_schedule_item_detail_wrapper flex flex-ac">\n                        <div class="battle_schedule_item_date_wrapper flex flex-ac flex-dir-col">\n                            <div class="battle_schedule_item_date">'+u+'</div>\n                            <div class="battle_schedule_item_time">'+p+'</div>\n                        </div>\n                        <div class="battle_schedule_item_team_wrapper  flex flex-ac flex-jc flex-dir-col">\n                            <div class="battle_schedule_item_team_icon"><img src="'+e.icon+'"/></div>\n                            <div class="battle_schedule_item_team_title">'+(e.team||"")+'</div>\n                        </div>\n                        <div class="battle_schedule_record_wrapper flex flex-ac flex-dir-col">\n                            <div class="battle_schedule_record flex flex-ac flex-jc">\n                                <span>'+(e.score||0)+"</span>\n                                <span>:</span>\n                                <span>"+(n.score||0)+"</span>\n                            </div>\n                            "+g+'\n                        </div>\n                        <div class="battle_schedule_item_team_wrapper flex flex-ac flex-jc flex-dir-col">\n                            <div class="battle_schedule_item_team_icon"><img src="'+n.icon+'"/></div>\n                            <div class="battle_schedule_item_team_title">'+(n.team||"")+'</div>\n                        </div>\n                        <div class="battle_schedule_item_status" state="state'+s+'">\n                            '+m[s]+"\n                        </div>\n                    </div>";t.append(i)}}))}_renderGameList(t){const e=window.$(".battle_schedule_container"),n=this;e.empty(),e.append('<div class="battle_schedule_wrapper flex flex-jb flex-ac">\n                <h3>赛程</h3>\n            </div><div class="battle_schedule_items_wrapper"></div>\n        ');const i=window.$(".battle_schedule_items_wrapper");t.forEach(((t,e)=>{const o='<div class="battle_schedule_item_wrapper" data-index="'+e+'">\n                    <div class="battle_schedule_item_title_wrapper  flex flex-ac flex-jb"><div class="battle_schedule_item_title">'+t.title+'</div> <div class="battle_schedule_item_type">'+t.sub_title+"</div></div>\n                </div>";i.append(o);const s=window.$(".battle_schedule_item_wrapper[data-index="+e+"]");n._renderGameListItem(s,t.game,t.id)}))}_renderTeamList(t){window.$(".army_items_wrapper").empty(),[...t].forEach((t=>{const e=2==t.is_loss?"fail":"",n=2==t.is_loss?'<div class="army_status flex flex-ac flex-jc"><span>已出局</span></div>':"",i='<div class="army_item_wrapper '+e+' flex flex-ac flex-jc" data-id="'+t.id+'" data-type="dialog">\n                    <div class="army_icon"><img class="layzload-army-icon" src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png" data-src="'+t.icon+'"/></div>\n                    '+n+"\n                </div>";window.$(".army_items_wrapper").append(i)})),window.lazyload(window.$(".layzload-army-icon"))}_renderTeamMember(t,e){e.forEach((e=>{const n=1==e.is_captain?' <div class="battle_team_info_identity flex flex-ac flex-jc"><span>队长</span></div>':"";t.append(' <div class="battle_team_item flex flex-ac flex-dir-col flex-1">\n                            <div class="battle_team_info">\n                                <div class="battle_team_info_icon"><img class="layzload-team_info_icon" src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png" data-src="'+e.avatar+'"/></div>\n                                '+n+'\n                            </div>\n                            <div class="battle_team_info_name">'+e.name+"</div>\n                        </div>")})),window.lazyload(window.$(".layzload-team_info_icon"))}_renderGame(t){if(1!=uu.roomInfo.is_match)return;window.$(".battle_container").empty(),window.$(".battle_container").append('\n            <div class="battle_title_wrapper flex flex-jb flex-ac">\n                <h3 style="color: #FF6691;">对战中</h3>\n                <span>全部战队></span>\n            </div>\n            <div class="battle_info_container"></div>\n        ');const e=this,n=window.$(".battle_info_container");[...t].forEach(((t,i)=>{n.append('<div class="battle_info_wrapper">\n                    <div class="battle_team_title flex flex-jc flex-ac">'+t.team+'</div>\n                    <div class="battle_teams_wrapper flex flex-jc flex-ac" data-id="'+t.id+'">\n\n                    </div>\n                </div>');const o=window.$(".battle_teams_wrapper[data-id="+t.id+"]");e._renderTeamMember(o,t.userlist),window.$(".new-video-battle-name").eq(i).text(t.team),0==i&&n.append(' <div class="battle_info_vs_wrapper flex flex-jc">\n                    <div class="battle_info_vs">\n                        <img src="https://res.tuwan.com/chatroom/images/icon_vs.png"/>\n                    </div>\n                </div>')}))}playVideo(t){const e=this.isFullScreen?"100%":window.$(".battle-room-bg").width(),n=this.isFullScreen?"100%":window.$(".battle-room-bg").height();window.$(".new-video-container").css({width:e,height:n}),window.$(".new-video-container").removeClass("hide"),this.play(t),this.danmaku._totalHeight||this.danmaku.resize()}destroyPlayer(){vi&&(vi.destroy(),vi=null)}resumePlayer(){this._flvurl&&this.play(this._flvurl)}play(t){if(this._flvurl=t,!t)return;if(vi)return void vi.replay(t);vi=new $i;const e=vi.emitter,n=this;e.on("ready",(function(t){uu.isBattleRoom()&&(window.$(".new-video-flash").removeAttr("style"),window.$("#new-video-player").css("background","#000"),n.checkHasSound())})),e.on("play",(function(t){uu.isBattleRoom()&&(window.$(".new-video-screen-warpper").addClass("hide"),window.$(".new-video-flash").removeAttr("style"),window.$(".new-video-screen-flash img").removeAttr("style"))})),e.on("error",(function(t){uu.isBattleRoom()&&(console.error("play-error",t),window.$(".new-video-flash").removeAttr("style"),window.$(".new-video-screen-flash img").removeAttr("style"))})),e.on("liveStreamStop",(function(t){uu.isBattleRoom()&&(window.$(".new-video-screen-warpper").removeClass("hide"),console.error("liveStreamStop",t))})),vi.play({flvurl:t,ele:"new-video-player",controlBarVisibility:"never"})}sendDanmu(t){uu.isBattleRoom()&&null!=this.danmaku&&this.danmuSwitch&&this.danmaku.add({msg:t})}setShowTeamInfo(t,e){window.$(".army_info_container").removeClass("hide"),window.$(".army_info_container").css("left",t-232),window.$(".army_info_container").css("top",e)}setHideTeamInfo(){window.$(".army_info_container").addClass("hide")}}class Ti{constructor(){this.isFullScreen=!1,this.startDanmu=!1,this.danmaku=null,this.danmuSwitch=!0,this.beforVolume=0,this.controllerBarMouseIn=!1,this.dbClickTimes=0,this.playerAli=null,this.leaveRoomFn=null,this.setPeipeiWheatFn=null,this.gloabDDChatui=null,this.playerAli=null,this.livePushState=-1}static getInstance(){return this.instance||(this.instance=new Ti,this.instance.onEventListener()),this.instance}initTemplate(){this.setShowTemplate(),this.initDanmu(),this.loadTvRoomInfo(),this.getCaptainGear()}setShowTemplate(){window.$(".new-video-temp-container").hasClass("hide")&&window.$(".new-video-temp-container").removeClass("hide")}setHideTemplate(){window.$(".new-video-temp-container").addClass("hide")}getFullScreenStatus(){return this.isFullScreen&&uu.isVideoTempRoom()}onEventListener(){const t=window.$(".new-video-temp-container"),e=this;let n={start:window.$(".new-video-temp-container .new-video-slide").offset().left,end:window.$(".new-video-temp-container .new-video-slide").offset().left+90},i=!1,o=0;t.on("click",".danmu-container",(function(t){e.checkDbClick()})),t.on("click",".new-video-full",(function(){e.isFullScreen?e.closeFullScreen():e.setFullScreen(),fe.getInstance().onHide()})),t.on("click",".danmu-container",(function(t){e.checkDbClick()})),t.on("click",".new-video-sound,.video-match-volume",(function(){if(e.playerAli){if(0==e.playerAli.getVolume()){const t=0!=e.beforVolume?e.beforVolume:.5,n=90*t;e.setVolume(t),window.$(".new-video-slide .slide").css("left",n+"px"),window.$(".new-video-slide .progress").css("width",n+"px")}else e.setVolume(0),window.$(".new-video-slide .slide").css("left","0px"),window.$(".new-video-slide .progress").css("width","0px");window.$(".video-match-volume-wrapper").remove()}})),t.on("mouseenter",".new-video-controller-wrapper",(function(t){e.controllerBarMouseIn=!0,window.$("#new-video-temp-controller").animate({bottom:"0px"})})),t.on("mouseleave",".new-video-controller-wrapper",(function(t){window.$.contains(t.target,window.$(".new-video-controller-wrapper"))||e.onHideControllBar()})),t.on("click",".new-video-sound,.video-match-volume",(function(){if(vi){if(0==vi.getVolume()){const t=0!=e.beforVolume?e.beforVolume:.5,n=90*t;e.setVolume(t),window.$(".new-video-slide .slide").css("left",n+"px"),window.$(".new-video-slide .progress").css("width",n+"px")}else e.setVolume(0),window.$(".new-video-slide .slide").css("left","0px"),window.$(".new-video-slide .progress").css("width","0px");window.$(".video-match-volume-wrapper").remove()}})),t.on("click",".new-video-danmu",(function(){e.danmuSwitch?(e.danmaku._clearDanmakuNodes(),e.danmaku._queue=[],e.danmuSwitch=!1,window.$(".new-video-danmu").addClass("danmu-close")):(e.danmuSwitch=!0,window.$(".new-video-danmu").removeClass("danmu-close"))})),t.on("mousemove",".new-video-slide",(function(t){i&&(o=t.clientX-n.start,o<0?(window.$(".new-video-slide .slide").css("left","0px"),window.$(".new-video-slide .progress").css("width","0px")):o<=90?(window.$(".new-video-slide .slide").css("left",o+"px"),window.$(".new-video-slide .progress").css("width",o+"px")):(window.$(".new-video-slide .slide").css("left","90px"),window.$(".new-video-slide .progress").css("width","90px")))})),t.on("click",".new-video-screen-warpper",(function(){window.$(".new-video-screen-flash img").css("animation","turn 1s linear infinite"),window.$(".new-video-flash").css("animation","turn 1s linear infinite"),e.loadTvRoomInfo()})),t.on("click",".new-video-flash",(function(){window.$(".new-video-flash").css("animation","turn 1s linear infinite"),e.loadTvRoomInfo()})),t.on("mousedown",".new-video-slide",(function(t){n={start:window.$(".new-video-temp-container .new-video-slide").offset().left,end:window.$(".new-video-temp-container .new-video-slide").offset().left+90},null!=e.playerAli&&e.playerAli.isPlaying()&&(i=!0)})),t.on("mouseup",".new-video-slide",(function(t){i&&(i=!1,e.setVolume(o/90))})),t.on("mouseleave",".new-video-slide",(function(t){i&&(i=!1,e.setVolume(o/90))}))}checkDbClick(){(new Date).getTime()-this.dbClickTimes<500&&(this.isFullScreen?this.closeFullScreen():this.setFullScreen(),fe.getInstance().onHide()),this.dbClickTimes=(new Date).getTime()}initDanmu(){const t=window.$(".new-video-temp-container .danmu-container")[0];this.danmaku=new gi({container:t})}setFullScreen(){this.isFullScreen=!0,window.$(".chat-center-left").css("position",""),window.$("#at-user-container").css("left","90px"),window.$(".new-video-temp-container .new-video-temp-user-container").hide(),window.$(".chat-center-main .new-video-temp-container").css({width:"100%",position:"absolute",height:"100%","border-radius":0}),window.$(".new-video-temp-container .full-input-text").append('<textarea maxlength="80"></textarea>'),window.$(".chatroom-guanzhu").hide(),window.$(".new-video-options").removeClass("hide"),window.$(".new-video-temp-container .new-video-full").addClass("small"),this.setBrowserFullScreen()}closeFullScreen(){this.isFullScreen=!1,window.$("#at-user-container").css("left","0"),window.$(".chat-center-left").css("position","relative"),window.$(".new-video-temp-container .new-video-temp-user-container").show(),window.$(".chat-center-main .new-video-temp-container").css({width:"100%",position:"relative",height:"540px","border-radius":"10px"}),window.$(".full-input-text").empty(),window.$(".chatroom-guanzhu").css("display","flex"),window.$(".new-video-options").addClass("hide"),window.$(".new-video-temp-container .new-video-full").removeClass("small"),this.closeBrowserFullScreen()}_isFullscreenFn(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||!1}setBrowserFullScreen(){const t=this;let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),window.$(window).unbind("resize"),window.$(window).bind("resize",(function(){0==t._isFullscreenFn()&&t.isFullScreen&&t.closeFullScreen()}))}closeBrowserFullScreen(){this._isFullscreenFn()&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}sendDanmu(t){uu.isVideoTempRoom()&&(0==this.danmaku._maxAmountPerRender&&(this.danmaku.resize(),this.danmaku._resetTracks()),null!=this.danmaku&&this.danmuSwitch&&this.danmaku.add({msg:t}))}onWillPlayVideo(){window.$(".danmu-container").removeClass("hide"),window.$("#new-game-video-player").removeClass("hide"),window.$(".new-video-temp-container .new-video-controller-wrapper").removeClass("hide")}playVideo(t){this.play(t),this.danmaku._totalHeight||this.danmaku.resize()}onWillCloseLive(){uu.isVideoTempRoom()&&(window.$(".danmu-container").addClass("hide"),window.$("#new-game-video-player").addClass("hide"),window.$(".new-video-temp-container .new-video-controller-wrapper").addClass("hide"))}closeLive(){this.onWillCloseLive(),this.playerAli&&(this.playerAli.destroy(),this.playerAli=null)}play(t){if(!t)return;if(this.playerAli)return void this.playerAli.replay(t);this.playerAli=new $i;const e=this.playerAli.emitter,n=this;e.on("ready",(function(t){uu.isVideoTempRoom()&&(n.checkHasSound(),window.$(".new-video-flash").removeAttr("style"),window.$("#new-video-player").css("background","#000"))})),e.on("play",(function(t){uu.isVideoTempRoom()&&(n.onWillPlayVideo(),window.$(".new-video-screen-warpper").addClass("hide"),window.$(".new-video-flash").removeAttr("style"),window.$(".new-video-screen-flash img").removeAttr("style"),n.resetVolume())})),e.on("error",(function(t){uu.isVideoTempRoom()&&(console.error("play-error",t),window.$(".new-video-flash").removeAttr("style"),window.$(".new-video-screen-flash img").removeAttr("style"))})),e.on("liveStreamStop",(function(t){uu.isVideoTempRoom()&&(console.error("play-error",t),console.error("liveStreamStop",t))})),this.playerAli.play({flvurl:t,ele:"new-game-video-player",controlBarVisibility:"never"})}onHideControllBar(){const t=this;t.controllerBarMouseIn=!1,setTimeout((()=>{if(!t.controllerBarMouseIn){if(t.isFullScreen&&"none"!=window.$(".chat-center-gift-content").css("display"))return;window.$("#new-video-temp-controller").animate({bottom:"-50px"})}}),2e3)}setVolume(t){const e=this;this.beforVolume=e.playerAli.getVolume(),t<=0?(e.playerAli.setVolume(0),window.$(".new-video-sound").removeClass("sound")):t>1?(e.playerAli.setVolume(1),window.$(".new-video-sound").addClass("sound")):(e.playerAli.setVolume(t),window.$(".new-video-sound").addClass("sound"))}resetVolume(){if(this.playerAli){const t=this.playerAli.getVolume();if(0!=t&&"0px"==window.$(".new-video-slide .slide").css("left")){const e=90*t;window.$(".new-video-slide .slide").css("left",e+"px"),window.$(".new-video-slide .progress").css("width",e+"px")}}}checkHasSound(){"chrome"!=Ct.is360Browser()&&"safari"!=Ct.is360Browser()||0!=this.playerAli.getVolume()||window.$(".new-video-temp-container .new-video-temp-live-container").append('\n            \t\t<div class="video-match-volume-wrapper" style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:100%; background:rgba(0,0,0,0.3); z-index:100">\n            \t\t\t<div class="video-match-volume" style="">如果没声音，点击播放声音</div>\n            \t\t</div>\n            \t')}setCallBackFn(t,e,n){this.leaveRoomFn=t,this.setPeipeiWheatFn=e,this.gloabDDChatui=n}joinRoom(t){const e=t.cid,n=uu.getChannel();Ct.setCookie("preCarteamChannel",n),this.leaveRoomFn(e),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),window.$(".yaoqing-float").css("display","none")}loadTvRoomInfo(){const t=this;qt.get(Ot.getTvRoomInfo(uu.getCid())).then((e=>{if(0==e.error)if(1==e.data.State){t.livePushState=1;const n=e.data.stream;t.playVideo(n.url_recommend)}else t.livePushState=-1,t.closeLive();else Vt(e.error_msg)})).catch((t=>{}))}getCaptainGear(){const t=uu.roomInfo.anchor_ids.length>0?uu.roomInfo.anchor_ids[0]:0;qt.get(Ot.getCaptainGear(t)).then((t=>{if(window.$(".new-video-temp-pay__content").empty(),0==t.error){const e=t.data;e.length>0?e.map((t=>{window.$(".new-video-temp-pay__content").append("<span>"+t+"</span><br />")})):window.$(".new-video-temp-pay__content").html("<p>暂无开车信息</p>")}else window.$(".new-video-temp-pay__content").html("<p>暂无开车信息</p>")})).catch((t=>{window.$(".new-video-temp-pay__content").html("<p>暂无开车信息</p>")})),window.$(".new-video-temp-info__title").text(uu.roomInfo.title),window.$(".new-video-temp-info__des").text(uu.roomInfo.desc),window.$(".new-video-temp-info__ptitle").text(uu.roomInfo.ptitle),null!=uu.getAnchoringUser()&&(window.$(".new-video-temp-info__container").removeClass("hide"),window.$(".new-video-temp-info__avatar img").attr("src",uu.getAnchoringUser().avatar),window.$(".new-video-temp-info__user .new-video-temp-info__name").text(uu.getAnchoringUser().nickname),window.$(".new-video-temp-pay__button").attr("uid",uu.getAnchoringUser().uid))}onReset(){this.onWillCloseLive(),window.$(".new-video-temp-info__container").addClass("hide"),this.closeFullScreen(),this.playerAli&&(this.playerAli.destroy(),this.playerAli=null),this.setHideTemplate()}}let Ri=0;class Mi{constructor(){this.instance=null,this.agoraClient=null,this._wssocket=null,this.mobileStillVideo=new Map,this.max="100%",this.normalWithd="624px",this.normalHeight="356px",this.dbClickTimes=0,this.isFullScreen=!1,this.danmuSwitch=!0,this.videoUser=new Map}static getInstance(){return this.instance||(this.instance=new Mi,this.instance.onEventListener()),this.instance}bindAgoraClient(t){this.agoraClient=t}bindSocket(t){this._wssocket=t}onEventListener(){const t=this,e=window.$(".chat-center-main"),n=window.$(".new-live-container");window.$(".chat-function-camera").on("click",(function(e){if(e.target.dataset&&null!=e.target.dataset.deviceid)return;if(!uu.isPaidanAnchor(uu.getMeid())&&!uu.isAnchoringUser(uu.getMeid())&&!uu.isAnchor(uu.getMeid()))return void Vt("只有本厅队长才能开启摄像头..");if((new Date).getTime()-Ri<1500)return void Vt("不要频繁操作哦..");Ri=(new Date).getTime();0==uu.getAnchorKengUser(uu.getMeid()).live?t.agoraClient.publishVideo():t.agoraClient.unpublishVideo(1)})),e.on("click",".live-video-management .live-action-camera",(function(e){const n=window.$(e.currentTarget).parent();if(n.length>0){const e=n[0].dataset.uid;1==uu.getAnchorKengUser(e).live?t.setLive(e,0):t.setLive(e,1)}})),e.on("click",".live-video-management .live-action-set",(function(e){const n=window.$(e.currentTarget).parent();if(n.length>0){const e=n[0].dataset.uid;1==uu.getAnchorKengUser(e).live_rec?t.setLiveRec(e,0):t.setLiveRec(e,1)}})),n.on("click",".danmu-container",(function(e){t.checkDbClick()})),n.on("click",".new-video-full",(function(){t.isFullScreen?t.closeFullScreen():t.setFullScreen(),fe.getInstance().onHide()})),n.on("click",".danmu-container",(function(e){t.checkDbClick()})),n.on("mouseenter",".new-video-controller-wrapper",(function(e){t.controllerBarMouseIn=!0,window.$("#new-live-controller").animate({bottom:"0px"})})),n.on("mouseleave",".new-video-controller-wrapper",(function(e){window.$.contains(e.target,window.$(".new-video-controller-wrapper"))||t.onHideControllBar()})),n.on("click",".new-video-danmu",(function(){t.danmuSwitch?(t.danmaku._clearDanmakuNodes(),t.danmaku._queue=[],t.danmuSwitch=!1,window.$(".new-video-danmu").addClass("danmu-close")):(t.danmuSwitch=!0,window.$(".new-video-danmu").removeClass("danmu-close"))}))}onReset(){uu.isLiveTempRoom()&&(this.onWillClose(),this.closeFullScreen()),window.$(".new-live-container").addClass("hide"),window.$(".chat-function-camera").addClass("hide"),window.$(".self-live-user-container").remove(),window.$(".new-video-temp-anchor").empty(),null!=this.agoraClient.localVideo&&(this.agoraClient.unpublish(this.agoraClient.localVideo),this.agoraClient.localVideo.close(),this.agoraClient.localVideo.stop(),this.agoraClient.localVideo=null)}getTemplate(t,e){const n=uu.isLiveRoom()?"":"self",i=this.getAnchorView(t,n),o=this.getUserView(e,n),s=this.getShowView();if(n){window.$(".new-live-container-wrapper").html(i),window.$(".new-live-container").removeClass("hide");const t="style = 'background:url("+uu.roomInfo.skin+"),no-repeat 0 0;background-size:100% 100%'";return this.initDanmu(),'<div class="self-live-container flex flex-jc flex-dir-col" '+t+'>\n                        <div class="self-live-show-container flex flex-jc flex-ac">\n                        </div>\n                        <div class="self-live-users-container flex flex-jc ">\n                            <div class="flex flex-col-dir" style="width: 853px;justify-content: flex-end">'+o.join("")+"</div>\n                        </div>\n                    </div>"}return'<div class="live-container flex">\n                           '+s+"\n                           "+i+"\n                           "+o.join("")+"\n                    </div>"}checkVideoUser(t){const e=uu.getAnchorKengUser(t.uid);null!=e&&(1==e.live_rec?this.setRemoteVideoStreamType(t.uid,0):this.setRemoteVideoStreamType(t.uid,1))}setRemoteVideoStreamType(t,e){null==this.agoraClient||uu.isLiveTempRoom()||this.agoraClient.setRemoteVideoConfig(t,e)}showVideo(t){const e=t.uid,n=window.$(".chat-center-main").find(".seat-item-empty[data-uid="+e+"]");if(0==uu.getAnchorKengUser(e).live){const i=n.next()[0];return window.$(i).empty(),window.$(i).append('<div id="agora-live-comp'+e+'" style="height: 100%"> </div>'),void this.mobileStillVideo.set(e,t)}if(0!=n.length){const i=n.next()[0];window.$(i).removeClass("hide"),window.$(i).empty(),window.$(i).append('<div id="agora-live-comp'+e+'" style="height: 100%"> </div>'),t&&t.videoTrack&&t.videoTrack.play("agora-live-comp"+e),this.onWillPlay()}}bindViewAttr(t){const e=t.uid,n=window.$(".chat-center-main").find(".seat-item-empty[data-uid="+e+"]");if(0!=n.length){const t=n.nextAll()[0],i=n.nextAll()[1],o=n.nextAll()[2];window.$(t).attr("data-uid",e),window.$(i).attr("data-uid",e),window.$(o).attr("data-uid",e)}}clearViewAttr(t){const e=window.$(".live-user-container[data-position="+t+"]");e.find(".live-video-management").addClass("hide"),e.find(".live-video-management").removeAttr("data-uid"),e.find(".live-video").removeAttr("data-uid"),e.find(".live-video-info").removeAttr("data-uid")}showManagementBar(){window.$(".chat-center-main").find(".live-video-management[data-uid]").removeClass("hide")}hideManagementBar(){window.$(".chat-center-main").find(".live-video-management").addClass("hide")}getVideoDomId(t){return"agora-live-comp"+t}showLocalVideo(t,e){const n=window.$(".chat-center-main").find(".seat-item-empty[data-uid="+t+"]");if(0!=n.length){const i=n.next()[0];window.$(i).removeClass("hide"),window.$(i).empty(),window.$(i).append('<div id="agora-live-comp'+t+'" style="height: 100%"> </div>'),e&&e.play(this.getVideoDomId(t));window.$(".chat-function-camera").find(".chat-huatong").removeClass("chat-huatong-jin")}this.onWillPlay()}hideLocalVideo(t){const e=window.$(".chat-center-main").find(".seat-item-empty[data-uid="+t+"]");if(0!=e.length){const t=e.next()[0];window.$(t).addClass("hide"),window.$(t).empty();window.$(".chat-function-camera").find(".chat-huatong").removeClass("chat-huatong-jin")}this.onWillClose()}getShowView(){return'<div class="live-user-container  flex flex-jc flex-ac" data-position="1">\n                       <div class="live-status-default-container flex flex-1 flex-jc flex-ac flex-dir-col">\n                            <img src="https://asset.tuwan.com/chatroom/images/icon_logo.png" />\n                            <span>点点开黑</span>\n                       </div>\n                </div>'}getSimulationView(t,e){return'<div class="live-user-container live-user-simulation-container  flex flex-jc flex-ac">\n                '+window.$(t).prop("outerHTML").replace("seat-wave","seat-wave-none")+"\n                "+window.$(".live-video-management[data-uid="+e+"]").prop("outerHTML")+"\n        </div>"}getUserView(t,e){let n=[],i="";return""==e&&(i=' <div class="live-video hide"></div>\n                        <div class="live-video-management flex hide">\n                            <div class="live-action-camera"></div>\n                            <div class="live-action-set upset"></div>\n                        </div>\n                        <div class="live-video-info flex  hide">\n                            <div class="live-video-info-wrapper flex flex-ac">\n                                 <div class="live-video-user-name"></div>\n                                 <div class="live-video-user-img">\n                                    <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png"/>\n                                </div>\n\n                            </div>\n                            <div class="live-video-info-block"><div class="seat-user-name"></div></div>\n                        </div>'),t.map(((t,o)=>{n.push(`<div class="${e?e+"-":""}live-user-container flex flex-jc flex-ac" data-position="`+(o+3)+'">\n                        '+t+"\n                        "+i+"\n                     </div>")})),n}getAnchorView(t,e){return`<div class="${e?e+"-":""}live-user-container flex flex-jc flex-ac" data-position="2">\n                    `+t+`\n                     <div class="${e?e+"-":""}live-video hide"></div>\n                     <div class="live-video-management flex hide">\n                          <div class="live-action-camera"></div>\n                          <div class="live-action-set upset"></div>\n                     </div>\n                     <div class="live-video-info  hide">\n                            <div class="live-video-info-wrapper flex flex-ac">\n                                 <div class="live-video-user-name"></div>\n                                 <div class="live-video-user-img">\n                                    <img onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png"/>\n                                </div>\n\n                            </div>\n                            <div class="live-video-info-block"><div class="seat-user-name"></div></div>\n                        </div>\n                </div>`}clearAnchorSeat(t){this.clearViewAttr(t),window.$(".chat-function-camera").addClass("hide"),window.$(".live-video").addClass("hide"),window.$(".live-video-info").addClass("hide")}onReflashSeat(){const t=window.$(".live-user-container:eq(0)");1!=t[0].dataset.position&&(t.before(this.getShowView()),window.$(".live-user-simulation-container").after(t),window.$(".live-user-simulation-container").remove())}onChangeSeat(t){const e=t.uid,n=window.$(".chat-center-main"),i=window.$(".live-user-container:eq(0)");if(i.length>0){const t=i[0].dataset.position,o=n.find(".seat-item-empty[data-uid="+e+"]"),s=o.parent()[0],a=window.$(s).index();i.before(s),1==t?i.remove():(window.$(".live-user-simulation-container").before(i),window.$(".live-user-simulation-container").remove()),window.$(".live-user-container:eq("+a+")").before(this.getSimulationView(o,e))}}setLiveRec(t,e=0){this._wssocket&&this._wssocket.send("setLiveRec",{cid:uu.getCid(),uid:t,typeid:uu.roomInfo.typeid,state:e})}setLive(t,e=0){this._wssocket&&this._wssocket.send("setLive",{cid:uu.getCid(),uid:t,typeid:uu.roomInfo.typeid,state:e})}checkSeat(t){const e=this;if(uu.isLiveRoom()){const n=t.find((t=>1==t.live_rec));t.forEach((t=>{const n=t.uid,i=t.nickname,o=t.avatar,s=window.$(".live-video-management[data-uid="+n+"]");if(1==t.live){const t=window.$(".live-video-info[data-uid="+n+"]");if(t.find(".live-video-user-name").text(i),t.find(".live-video-user-img img").attr("src",o),t.removeClass("hide"),s.find(".live-action-camera").addClass("camear-close"),window.$(".live-video[data-uid="+n+"]").removeClass("hide"),window.$(".live-video-info[data-uid="+n+"]").removeClass("hide"),0!=e.mobileStillVideo.size&&e.mobileStillVideo.has(n)){const t=e.mobileStillVideo.get(n);t&&t.videoTrack&&t.videoTrack.play("agora-live-comp"+n),e.mobileStillVideo.delete(n)}}else window.$(".live-video[data-uid="+n+"]").addClass("hide"),window.$(".live-video-info[data-uid="+n+"]").addClass("hide"),s.find(".live-action-camera").removeClass("camear-close"),this.onWillClose();1==t.live_rec?s.find(".live-action-set").removeClass("upset").addClass("downset"):s.find(".live-action-set").removeClass("downset").addClass("upset"),t.uid==uu.getMeid()&&(window.$(".chat-function-camera").removeClass("hide"),0==t.live?(e.agoraClient.unpublishVideo(0),window.$(".chat-function-camera .chat-camera").removeClass("chat-camera-ban")):window.$(".chat-function-camera .chat-camera").addClass("chat-camera-ban"))})),n?t.forEach((t=>{1==t.live_rec?(0!=window.$(".live-user-container:eq(0)").find(".seat-item-empty").length&&window.$(".live-user-container:eq(0)").find(".seat-item-empty")[0].dataset.uid==t.uid||e.onChangeSeat(t),this.setRemoteVideoStreamType(t.uid,0)):this.setRemoteVideoStreamType(t.uid,1)})):(t.forEach((t=>{this.setRemoteVideoStreamType(t.uid,1)})),e.onReflashSeat())}else if(uu.isLiveTempRoom()){const n=uu.getAnchoringUserId();if(n!=uu.getSelfInfo().uid)t.forEach((t=>{const i=t.uid,o=t.live;if(i==n)if(1==o){const n=e.mobileStillVideo.get(i),o=window.$(".live-video-info[data-uid="+i+"]");o.find(".live-video-user-name").text(t.nickname),o.find(".live-video-user-img img").attr("src",t.avatar),o.removeClass("hide"),n&&n.videoTrack&&(e.onWillPlay(),n.videoTrack.play("agora-live-comp"+i))}else{window.$(".live-video-info[data-uid="+i+"]").addClass("hide"),e.onWillClose(),e.closeFullScreen()}}));else{const i=t.find((t=>t.uid==n));if(i)if(1==i.live){0!=window.$("#agora-live-comp"+i.uid).length&&0!=window.$("#agora-live-comp"+i.uid).children().length||e.agoraClient.publishVideo();const t=window.$(".live-video-info[data-uid="+i.uid+"]");t.find(".live-video-user-name").text(i.nickname),t.find(".live-video-user-img img").attr("src",i.avatar),t.removeClass("hide"),window.$(".chat-function-camera .chat-camera").addClass("chat-camera-ban")}else{window.$(".chat-function-camera .chat-camera").removeClass("chat-camera-ban");window.$(".live-video-info[data-uid="+i.uid+"]").addClass("hide")}}}}checkCameraStatus(){const t=uu.getAnchorKengUser(uu.getMeid());t&&(window.$(".chat-function-camera").removeClass("hide"),1==t.live?window.$(".chat-function-camera .chat-camera").addClass("chat-camera-ban"):window.$(".chat-function-camera .chat-camera").removeClass("chat-camera-ban"))}checkDbClick(){(new Date).getTime()-this.dbClickTimes<500&&(this.isFullScreen?this.closeFullScreen():this.setFullScreen(),fe.getInstance().onHide()),this.dbClickTimes=(new Date).getTime()}_isFullscreenFn(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||!1}setFullScreen(){this.danmaku._trackSize=100,this.danmaku.resize(),this.danmaku._resetTracks(),this.isFullScreen=!0,window.$(".chat-center-left").css("position",""),window.$(".new-live-container").css({width:"100%",height:"100%",left:0,transform:"none"}),window.$(".new-live-container .full-input-text").append('<textarea maxlength="80"></textarea>'),window.$(".new-video-options").removeClass("hide"),window.$(".new-video-full").addClass("small"),this.setBrowserFullScreen()}closeFullScreen(){this.isFullScreen=!1,this.danmaku&&(this.danmaku._clearDanmakuNodes(),this.danmaku._trackSize=60,this.danmaku.resize(),this.danmaku._resetTracks()),window.$(".chat-center-left").css("position","relative"),window.$(".new-live-container").css({width:"853px",height:"480px",left:"50%",transform:"translateX(-50%)"}),window.$(".full-input-text").empty(),window.$(".new-video-options").addClass("hide"),window.$(".new-video-full").removeClass("small"),this.closeBrowserFullScreen()}setBrowserFullScreen(){const t=this;let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),window.$(window).unbind("resize"),window.$(window).bind("resize",(function(){0==t._isFullscreenFn()&&t.isFullScreen&&t.closeFullScreen()}))}closeBrowserFullScreen(){this._isFullscreenFn()&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}initDanmu(){const t=window.$(".new-live-container .danmu-container")[0];this.danmaku=new gi({container:t,trackSize:60})}sendDanmu(t){uu.isLiveTempRoom()&&(0==this.danmaku._maxAmountPerRender&&(this.danmaku.resize(),this.danmaku._resetTracks()),null!=this.danmaku&&this.danmuSwitch&&this.danmaku.add({msg:t}))}getFullScreenStatus(){return this.isFullScreen&&uu.isLiveTempRoom()}onWillPlay(){uu.isLiveTempRoom()&&(window.$(".danmu-container").removeClass("hide"),window.$(".new-video-controller-wrapper").removeClass("hide"),window.$(".self-live-video").css("background","#000000"),window.$(".self-live-video").removeClass("hide"))}onWillClose(){uu.isLiveTempRoom()&&(window.$(".danmu-container").addClass("hide"),window.$(".new-video-controller-wrapper").addClass("hide"),window.$(".self-live-video").css("background","transparent"),window.$(".self-live-video").addClass("hide"))}onHideControllBar(){const t=this;t.controllerBarMouseIn=!1,setTimeout((()=>{if(!t.controllerBarMouseIn){if(t.isFullScreen&&"none"!=window.$(".chat-center-gift-content").css("display"))return;window.$("#new-live-controller").animate({bottom:"-50px"})}}),2e3)}}class Ai{constructor(){this.instance=null,this.level=0,this.context=null,this.giftCb=null,this.seats=[],this.mixinSound=!0,this.time=0,this.timer=null}static getInstance(){return this.instance||(this.instance=new Ai,this.instance.onEventListener()),this.instance}setContext(t){this.context=t}setSendGiftCb(t){this.giftCb=t}initTemplate(t){window.$(".takeme-room-content").append('<div class="takeme-container flex">\n        <div id="takeme-svgaBg" style="position: absolute; width: 100%; height: 100% top:0;z-index: -1"></div>\n        <div class="takeme-anchor__container flex flex-ac flex-jc flex-dir-col">\n            <div class="takeme-anchor__wrapper"></div>\n            <div class="takeme-anchor-option flex flex-jc flex-ac">\n                <div class="takeme-anchor-button flex flex-ac flex-jc" data-stage="1">才艺展示</div>\n                <i class="takeme-anchor-step"></i>\n                <div class="takeme-anchor-button flex flex-ac flex-jc" data-stage="2">心动初选</div>\n                <i class="takeme-anchor-step"></i>\n                <div class="takeme-anchor-button flex flex-ac flex-jc" data-stage="3">双向终选</div>\n                <i class="takeme-anchor-question">?</i>\n            </div>\n            <div class="takeme-desc"></div>\n        </div>\n        <div class="takeme-content__container">\n            <div class="takeme-content-shadow takeme-shadow hide" ></div>\n            <div class="takeme-content-main">\n                <div class="takeme-content-main__circle"></div>\n                <div class="takeme-content-main__wrapper"></div>\n            </div>\n            <div class="takeme-sound  hide" data-seat="1" ></div>\n            <div class="takeme-sound  hide" data-seat="3"></div>\n            <div class="takeme-sound  hide" data-seat="4"></div>\n            <div class="takeme-sound  hide" data-seat="5"></div>\n            <div class="takeme-sound  hide" data-seat="6"></div>\n            <div class="takeme-sound  hide" data-seat="7"></div>\n            <div class="takeme-sound  hide" data-seat="8"></div>\n            <div class="takeme_anim">心动初选</div>\n        </div> \n        \n        <div class="takeme-action__container flex flex-jc flex-1">\n            <div class="takeme-action__wrapper flex flex-jc flex-ac flex-dir-col ">\n                \x3c!-- 主持 --\x3e\n                <div class="takeme-action-button hide" data-type="next">下一步</div>\n                <div class="takeme-action-button hide" data-type="done">结束</div>\n                \x3c!-- 嘉宾 --\x3e\n\x3c!--                <div class="takeme-action-button hide" data-type="light">亮灯</div>--\x3e\n                <div class="takeme-action-button hide" data-type="close-light">灭灯</div>\n\x3c!--                <div class="takeme-action-button hide" data-type="bomb">爆灯</div>--\x3e\n                <div class="takeme-action-button hide" data-type="face">揭面</div>\n                 \x3c!-- 变声器 开关 --\x3e \n\x3c!--                 <div class="takeme-action-button hide " data-type="mixin-open">变声器开</div>--\x3e\n\x3c!--                 <div class="takeme-action-button hide " data-type="mixin-close">变声器关</div>--\x3e\n            </div>\n            <audio class="takeme_sound" data-type="1" src="https://asset.tuwan.com/chatroom/sound/sound_123.mp3?v1"></audio>\n\x3c!--            <audio class="takeme_sound" data-type="4" src="https://asset.tuwan.com/chatroom/sound/sound_4.mp3?v1"></audio>--\x3e\n\x3c!--            <audio class="takeme_sound" data-type="5" src="https://asset.tuwan.com/chatroom/sound/sound_5.mp3?v1"></audio>--\x3e\n            <audio class="takeme_sound" data-type="6" src="https://asset.tuwan.com/chatroom/sound/sound_6.mp3?v1"></audio>\n            <audio class="takeme_sound" data-type="7" src="https://asset.tuwan.com/chatroom/sound/sound_7.mp3?v1"></audio>\n            <audio class="takeme_sound" data-type="8" src="https://asset.tuwan.com/chatroom/sound/sound_8.mp3?v1"></audio>\n            <audio class="takeme_sound" data-type="10" src="https://asset.tuwan.com/chatroom/sound/sound_10.mp3?v1"></audio>\n            \n            </div>\n        </div>');let e=""!=t.skin?t.skin:""!=t.skin_active?t.skin_active:"";if(""!=e)if(-1!=e.indexOf(".svga")){const t=Zt.getInstance();t.loadParser("#takeme-svgaBg",e,0,!1).then((e=>{const{videoItem:n,player:i}=e;i.setVideoItem(n),i.startAnimation(),i.setContentMode("AspectFill"),t.playersMap.set("takeme-svgaBg",i)}),(t=>{}))}else window.$(".takeme-container").css("background",'rgba(0, 0, 0, 0) url("'+e+'") no-repeat scroll 50% 50% / 100% 100% padding-box border-box')}infillSeat(t,e,n){window.$(".takeme-anchor__wrapper").html(t),window.$(".takeme-sound:eq(0)").before('\n                    <div class="takeme-content-item flex flex-dir-col" data-seat="1">\n                        <div class="takeme-content-item-user">'+e+'</div>\n\x3c!--                        <div class="takeme-content-item-option  flex flex-ac  ">--\x3e\n\x3c!--                            <div class="takeme-item-button hide light" data-type="show" data-seat="1">揭面</div>--\x3e\n\x3c!--                        </div>--\x3e\n                    </div>\n        '),n.map(((t,e)=>{e<3?window.$(".takeme-sound:eq(0)").before('\n                    <div class="takeme-content-item flex flex-dir-col" data-seat="'+(e+3)+'">\n                        <div class="takeme-content-item-user">'+t+'</div>\n                        <div class="takeme-content-item-option  flex flex-ac ">\n                            \x3c!-- 主持 --\x3e\n                            <div class="takeme-item-button hide light" data-type="sound" data-seat="'+(e+3)+'">顶光</div>\n                            <div class="takeme-item-button hide light" data-type="close-sound" data-seat="'+(e+3)+'">关顶光</div>\n                            <div class="takeme-item-button hide light" data-type="show" data-seat="'+(e+3)+'">揭面</div>\n                            <div class="takeme-item-button hide light" data-type="bomb" data-seat="'+(e+3)+'">爆灯</div>\n                            <div class="takeme-item-button hide close" data-type="light" data-seat="'+(e+3)+'">灭灯</div>\n                            \n                        </div>\n                    </div>\n                '):e<6&&window.$(".takeme-sound:eq(0)").after('\n                    <div class="takeme-content-item flex flex-dir-col" data-seat="'+(e+3)+'">\n                        <div class="takeme-content-item-user">'+t+'</div>\n                        <div class="takeme-content-item-option  flex flex-ac ">\n                            \x3c!-- 主持 --\x3e\n                            <div class="takeme-item-button hide light" data-type="sound" data-seat="'+(e+3)+'">顶光</div>\n                            <div class="takeme-item-button hide light" data-type="close-sound" data-seat="'+(e+3)+'">关顶光</div>\n                            <div class="takeme-item-button hide light" data-type="show" data-seat="'+(e+3)+'">揭面</div>\n                            <div class="takeme-item-button hide light" data-type="bomb" data-seat="'+(e+3)+'">爆灯</div>\n                            <div class="takeme-item-button hide close" data-type="light" data-seat="'+(e+3)+'">灭灯</div>\n                        </div>\n                    </div>\n                ')}))}onEventListener(){const t=window.$(".chat-center-main"),e=this;t.on("click",".takeme-queue-tab",(function(t){window.$(".takeme-queue-tab").removeClass("active"),window.$(".takeme-common-orderlist").addClass("hide"),window.$(".takeme-common-queuelist").addClass("hide");const e=t.currentTarget.dataset.tab;1==e?(window.$(".takeme-queue-tab[data-tab='1']").addClass("active"),window.$(".takeme-common-queuelist").removeClass("hide")):2==e&&(window.$(".takeme-queue-tab[data-tab='2']").addClass("active"),window.$(".takeme-common-orderlist").removeClass("hide"))})),t.on("click",".takeme-item-button",(function(t){const{type:n,seat:i}=t.currentTarget.dataset;if("sound"==n){const t=window.$(".seat-item-empty[data-aposition="+i+"]")[0].dataset.uid;e.setBlindSound(t,1)}else if("close-sound"==n){const t=window.$(".seat-item-empty[data-aposition="+i+"]")[0].dataset.uid;e.setBlindSound(t,0)}else if("light"==n){const t=window.$(".seat-item-empty[data-aposition="+i+"]")[0].dataset.uid;e.setBlindLight(0,t)}else if("show"==n){const t=window.$(".seat-item-empty[data-aposition="+i+"]")[0],n=t.dataset.uid,o=t.dataset.color,s=t.dataset.nickname;null!=e.giftCb&&e.giftCb(n,s,o,13140)}else if("bomb"==n){const t=window.$(".seat-item-empty[data-aposition="+i+"]")[0],n=t.dataset.uid,o=t.dataset.color,s=t.dataset.nickname;null!=e.giftCb&&e.giftCb(n,s,o,5200)}})),t.on("click",".takeme-action-button",(function(t){const{type:n}=t.currentTarget.dataset;(new Date).getTime()<e.time+2e3||(e.time=(new Date).getTime(),"light"==n?e.setBlindLight(1,uu.getMeid()):"next"==n||"done"==n?e.setChangeLevel():"close-light"==n?e.setBlindLight(0,uu.getMeid()):"face"==n&&e.setBlindFace(uu.getMeid()))})),t.on("click",".takeme-anchor-question",(function(t){ze.show({desc:uu.roomInfo.rule_desc.replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")})}))}onReset(){window.$(".takeme-room-content").empty()}onOpenSound(t){window.$(".takeme-shadow").removeClass("hide"),window.$(".takeme-sound").addClass("hide").removeClass("show"),window.$(".takeme-content-item").removeClass("show"),window.$(".takeme-sound[data-seat=1]").addClass("show").removeClass("hide"),window.$(".takeme-content-item[data-seat=1]").addClass("show"),window.$(".takeme-sound[data-seat="+t+"]").addClass("show").removeClass("hide"),window.$(".takeme-content-item[data-seat="+t+"]").addClass("show"),window.$(".takeme-anchor__container").addClass("takeme-shadow"),window.$(".takeme-action__container").addClass("takeme-shadow")}onCloseSound(){window.$(".takeme-content-shadow.takeme-shadow").addClass("hide"),window.$(".takeme-sound").removeClass("show").addClass("hide"),window.$(".takeme-content-item").removeClass("show"),window.$(".takeme-anchor__container").removeClass("takeme-shadow"),window.$(".takeme-action__container").removeClass("takeme-shadow")}onChangeLevel(t){if(uu.isAnchoringUser(uu.getMeid()))0==t.stage?(window.$(".takeme-item-button[data-type='sound']").addClass("hide"),window.$(".takeme-item-button[data-type='close-sound']").addClass("hide"),window.$(".takeme-action-button[data-type='done']").addClass("hide"),window.$(".takeme-action-button[data-type='next']").text("开始"),window.$(".takeme-action-button[data-type='next']").removeClass("hide")):1==t.stage?(window.$(".takeme-item-button[data-type='sound']").addClass("hide"),window.$(".takeme-item-button[data-type='close-sound']").addClass("hide"),window.$(".takeme-action-button[data-type='next']").text("下一步"),window.$(".takeme-action-button[data-type='next']").removeClass("hide")):3==t.stage?(window.$(".takeme-action-button[data-type='next']").addClass("hide"),window.$(".takeme-action-button[data-type='done']").removeClass("hide"),this.onFixSound(t.stage)):(window.$(".takeme-action-button[data-type='next']").text("下一步"),window.$(".takeme-action-button[data-type='next']").removeClass("hide"),this.onFixSound(t.stage));else if(uu.isInAnchors(uu.getMeid())){const t=this.seats.find((t=>t.uid==uu.getMeid()));t?1==t.position?1==t.face?window.$(".takeme-action-button[data-type='face']").removeClass("hide"):window.$(".takeme-action-button").addClass("hide"):0==t.light||(1==t.light?(uu.isSpecialTakeMeRoom()&&1==t.face&&window.$(".takeme-action-button[data-type='face']").removeClass("hide"),window.$(".takeme-action-button[data-type='close-light']").removeClass("hide")):-1!=t.light&&2!=t.light||window.$(".takeme-action-button").addClass("hide")):window.$(".takeme-action-button").addClass("hide")}if(window.$(".seat-item-empty[data-uid=0]").parent().next().find(".takeme-item-button").addClass("hide"),t.stage!=this.level){this.level=t.stage,window.$(".takeme-anchor-button").removeClass("now");for(let t=1;t<=this.level;t++)window.$(".takeme-anchor-button[data-stage="+t+"]").addClass("now");0!=t.stage&&this.onSetpAnim(t.msg)}}onFixSound(){const t=this;window.$(".seat-item-empty").map(((e,n)=>{const i=n.dataset.uid,o=t.seats.find((t=>t.uid==i));null!=o&&1!=o.sound&&-1!=o.light&&window.$(".takeme-content-item[data-seat="+o.position+"]").find(".takeme-item-button[data-type='sound']").removeClass("hide")}))}onSetpAnim(t){window.$(".takeme_anim").removeClass("play"),window.$(".takeme_anim").text(t),setTimeout((()=>{window.$(".takeme_anim").addClass("play")}),10)}setChangeLevel(){uu.globalDDSocket.send("setBlindStage",{cid:uu.getCid()})}setBlindSound(t,e){uu.globalDDSocket.send("setBlindSound",{cid:uu.getCid(),uid:t,state:e})}setBlindLight(t,e){uu.globalDDSocket.send("setBlindLight",{cid:uu.getCid(),uid:e,state:t})}setBlindFace(t){uu.globalDDSocket.send("setBlindFace",{cid:uu.getCid(),uid:t})}onSound(t){1==t||2==t||3==t?(window.$(".takeme_sound[data-type='1']")[0].pause(),window.$(".takeme_sound[data-type='1']")[0].currentTime=0,window.$(".takeme_sound[data-type='1']")[0].volume=xt.getInstance().getMainVolume()/100,window.$(".takeme_sound[data-type='1']")[0].play()):4==t||5==t||(window.$(".takeme_sound[data-type='"+t+"']")[0].pause(),window.$(".takeme_sound[data-type='"+t+"']")[0].currentTime=0,window.$(".takeme_sound[data-type='"+t+"']")[0].volume=xt.getInstance().getMainVolume()/100,window.$(".takeme_sound[data-type='"+t+"']")[0].play())}onNotify(t,e){0==t.error?(window.$(".takeme-svga").removeClass("hide"),Zt.getInstance().loadParser(window.$(".takeme-svga")[0],t.info.svga_pc,1,!1).then((e=>{const{videoItem:n,player:i}=e,o=t.info.attr;i.setImage(o[0].data.pic,o[0].skey),i.setImage(o[1].data.pic,o[1].skey),i.setText({text:o[2].data.title,color:o[2].data.color,size:o[2].data.size+"px",family:"Microsoft YaHei"},o[2].skey),i.setText({text:o[3].data.title,color:o[3].data.color,size:o[3].data.size+"px",family:"Microsoft YaHei"},o[3].skey),i.setVideoItem(n),i.startAnimation(),i.onFinished((()=>{window.$(".takeme-svga").addClass("hide")}))}),(t=>{})),this.timer=setTimeout((()=>{if(null!=t.info.fleetUids&&0!=t.info.fleetUids.length&&t.info.fleetUids.find((t=>uu.getMeid()==t))){window.$(".takeme-svga").addClass("hide");const n=uu.getChannel();Ct.setCookie("preCarteamChannel",n),e(t.info.cid)}}),t.info.svga_time)):1==t.error&&(window.$(".takeme-svga").removeClass("hide"),Zt.getInstance().loadParser(window.$(".takeme-svga")[0],t.info.svga_pc,1,!1).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation(),n.onFinished((()=>{window.$(".takeme-svga").addClass("hide")}))}),(t=>{})))}onShowSvagHeader(){const t=window.$(".takeme-content-item[data-seat=1]").find(".seat-svga");t.html("");const e=uu.getBossInfo();null!=e&&""!=e.heads&&Zt.getInstance().playLoop({ele:t[0],path:e.heads},"svga_header_team_"+e.position)}onCheckState(t,e,n){const{nowMap:i,preMap:o,diffMap:s}=Ct.diffArrayForKeyWithTake(this.seats,t),a=this;if(window.$(".takeme-desc").text(n),s.forEach((t=>{if(i.has(t.uid)){if(1!=t.position&&2!=t.position&&(1==t.sound?a.onOpenSound(t.position):a.onCloseSound()),0==t.light?window.$(".takeme-content-item[data-seat="+t.position+"] .seat-user-head").removeClass("closeLight"):-1==t.light&&window.$(".takeme-content-item[data-seat="+t.position+"] .seat-user-head").addClass("closeLight"),1==t.light||2==t.light){window.$(".takeme-content-item[data-seat="+t.position+"] .seat-user-head").removeClass("closeLight");const e=window.$(".takeme-content-item[data-seat="+t.position+"]").find(".seat-svga");e.html(""),Zt.getInstance().playLoop({ele:e[0],path:t.heads},"svga_header_team_"+t.position)}else if(0==t.face&&1==t.position);else{const e=window.$(".takeme-content-item[data-seat="+t.position+"]").find(".seat-svga");e.html(""),Zt.getInstance().playLoop({ele:e[0],path:t.heads},"svga_header_team_"+t.position)}if(1==t.face);else{window.$(".takeme-content-item[data-seat="+t.position+"]").find(".takeme-item-button[data-type='show']").addClass("hide"),window.$(".seat-item-empty[data-aposition="+t.position+"]").attr("data-face",0);const e=window.$(".seat-item-empty[data-aposition="+t.position+"]")[0].dataset.uid,n=uu.getAnchorKengUser(e);if(0!=o.size&&null!=o.get(parseInt(e))&&o.get(parseInt(e)).face!=n.face){const e=window.$(".takeme-content-item[data-seat="+n.position+"]").find(".takeme-show-svga");e.html(""),Zt.getInstance().loadParser(e[0],"https://asset.tuwan.com/chatroom/images/takeme_show.svga?v3",1,!1).then((e=>{const{videoItem:i,player:o}=e;o.setVideoItem(i),o.startAnimation(),o.onFrame((e=>{30==e&&(window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-user-name").text(n.nickname),window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-head-img").attr("src",n.avatar))})),o.onFinished((()=>{window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-user-name").text(n.nickname),window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-head-img").attr("src",n.avatar),a.onShowSvagHeader()}))}),(e=>{window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-user-name").text(n.nickname),window.$(".seat-item-empty[data-aposition="+t.position+"]").find(".seat-head-img").attr("src",n.avatar)}))}}}else a.onCloseSound()})),uu.isAnchoringUser(uu.getMeid())){window.$(".takeme-item-button").parents(".takeme-content-item").find(".seat-item-empty").map(((t,e)=>{const n=e.dataset.aposition;if(0!=e.dataset.uid){const t=i.get(parseInt(e.dataset.uid));1==t.sound?(window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button[data-type='sound']").addClass("hide"),window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button[data-type='close-sound']").removeClass("hide")):window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button[data-type='close-sound']").addClass("hide"),1==t.light||2==t.light?window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button[data-type='light']").removeClass("hide"):window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button[data-type='light']").addClass("hide")}else window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button").addClass("hide")})),window.$(".takeme-action-button").addClass("hide")}else if(uu.isInAnchors(uu.getMeid()))if(uu.getBossInfo()&&uu.getBossInfo().uid==uu.getMeid()){if(0!=e){window.$(".takeme-item-button").parents(".takeme-content-item").find(".seat-item-empty").map(((t,e)=>{const n=e.dataset.aposition;if(0!=e.dataset.uid){window.$(".takeme-content-item[data-seat="+n+"]").find(".takeme-item-button").addClass("hide");const t=i.get(parseInt(e.dataset.uid));t.uid==uu.getMeid()||(-1==t.light||2==t.light?(window.$(".takeme-content-item[data-seat="+t.position+"]").find(".takeme-item-button").addClass("hide"),-1==t.light&&1==t.face&&window.$(".takeme-content-item[data-seat="+t.position+"]").find(".takeme-item-button[data-type='show']").removeClass("hide")):1==t.light&&window.$(".takeme-content-item[data-seat="+t.position+"]").find(".takeme-item-button[data-type='bomb']").removeClass("hide"))}}))}}else{const t=i.get(parseInt(uu.getMeid()));window.$(".takeme-action-button").addClass("hide"),0!=this.level&&(0==t.light?(window.$(".takeme-action-button[data-type='bomb']").removeClass("hide"),window.$(".takeme-action-button[data-type='light']").removeClass("hide")):1==t.light?(window.$(".takeme-action-button[data-type='bomb']").removeClass("hide"),window.$(".takeme-action-button[data-type='close-light']").removeClass("hide")):-1==t.light&&window.$(".takeme-action-button").addClass("hide"))}else window.$(".takeme-action-button").addClass("hide"),window.$(".takeme-item-button").addClass("hide");window.$(".takeme-item-button").parents(".takeme-content-item").find(".seat-item-empty").map(((t,e)=>{const n=e.dataset.aposition,o=i.get(parseInt(e.dataset.uid));null!=o&&1==o.sound&&-1!=window.$(".takeme-sound[data-seat="+n+"]").attr("class").indexOf("hide")&&a.onOpenSound(n)})),this.seats=t}onInterrupt(){null!=this.timer&&(clearTimeout(this.timer),this.timer=null)}}class Pi{constructor(){this.map=new Map}static getInstance(){return this.instance||(this.instance=new Pi),this.instance}onReset(){this.map.clear()}addData(t){const e=t.uid;if(window.$(".seat-item-empty[data-uid="+e+"]").length>0)if("wheat_pendant"==t.type){this.map.get(Number(e))||this.map.set(Number(e),this.createQueue());const n=0==this.map.get(Number(e)).getQueue().length;this.map.get(Number(e)).enQueue(t),n&&this.playPendant(e)}else this.playFace(t)}playPendant(t){const e=this.map.get(Number(t)),n=e.getTop(),i=window.$(`.seat-item-empty[data-uid=${t}] .seat-pendant-svga`);if(i.length){const o=`svga_pendant_uid_${t}`;Zt.getInstance().loadParser(i[0],n.pic,n.times).then((({player:n,videoItem:i})=>{n.setVideoItem(i),n.startAnimation(),n.onFinished((()=>{Zt.getInstance().clearPlayer(o),e.deQueue(),e.getQueue().length>0&&this.playPendant(t)})),Zt.getInstance().playersMap.set(o,n)}),(t=>{}))}else e.clearQueue()}playFace(t){const e=t.uid;window.$(`.seat-item-empty[data-uid=${e}] .seat-face-svga`).each((function(){const n=`svga_face_uid_${e}`;Zt.getInstance().clearPlayer(n),Zt.getInstance().loadParser(this,t.pic,t.times).then((({player:t,videoItem:e})=>{t.setVideoItem(e),t.startAnimation(),Zt.getInstance().playersMap.set(n,t)}),(t=>{}))}))}clearSvgaWithUid(t){Zt.getInstance().clearPlayer(`svga_pendant_uid_${t}`),Zt.getInstance().clearPlayer(`svga_face_uid_${t}`),this.map.get(Number(t))&&this.map.get(Number(t)).clearQueue()}createQueue(){let t=[];return{enQueue:e=>{null!=e&&t.push(e)},deQueue:()=>{if(0===t.length)return;return t.shift()},getQueue:()=>Array.from(t),getTop:()=>t[0],clearQueue:()=>t.splice(0,t.length)}}}class ji{constructor(){this.instance=null,this.hide=!0}static getInstance(){return this.instance||(this.instance=new ji,this.instance.onEventListener()),this.instance}onEventListener(){window.$(document).on("click",".temp-talk-container  .chat-message-image",(function(){const t=window.$(this).attr("image");ji.getInstance().showBigImage(t)})),window.$(document).on("click",".autoroom-teams-action",(function(){uu.isShengyouFreeRoom()||(ji.getInstance()._setShow(),window.$(".temp-talk-context").scrollTop(999999))}))}checkShow(){this.hide||window.$(".autoroom-teams-tabs div").removeClass("current")}clickTab(){this._setHide()}isShow(){return!this.hide}_setShow(){this.hide=!1,window.$(".autoroom-teams-pages").addClass("hide"),window.$(".autoroom-teams-tabs div").removeClass("current"),window.$(".autoroom-teams-action div[data-id=1000000]").length?window.$(".autoroom-teams-action div").addClass("current"):window.$(".autoroom-teams-action").append('<div class="current" data-id="1000000">车队消息</div>'),window.$(".temp-talk").removeClass("hide"),window.$(".autoroom-allteams").addClass("hide")}_setHide(){window.$(".temp-talk").addClass("hide"),window.$(".autoroom-allteams").removeClass("hide"),window.$(".autoroom-teams-pages").removeClass("hide"),window.$(".autoroom-teams-action div[data-id=1000000]").removeClass("current"),0==window.$(".autoroom-teams-tabs div.current").length&&window.$(".autoroom-teams-tabs div").eq(0).addClass("current")}setHide(){this._setHide(),this.hide=!0,window.$(".temp-talk-context").empty(),window.$(".autoroom-teams-action div[data-id=1000000]").remove()}setShow(t){const e=window.$(".temp-talk .temp-talk-container");if(t.length>0)if(0==e.length){const e=this.getTemplate(t[0]);window.$(".temp-talk").append(e),window.$(".temp-talk-context").append('<div class="temp-talk-title">欢迎您加入<span>'+t[0].nickname+"</span>的车队，如要提前开车请联系队长哦~</div>"),this._setShow()}else window.$(".temp-talk-context").empty(),window.$(".temp-talk-context").append('<div class="temp-talk-title">欢迎您加入<span>'+t[0].nickname+"</span>的车队，如要提前开车请联系队长哦~</div>"),this._setShow()}getTemplate(t){if(uu.isCanCreateTeam())return' \n                <div class="temp-talk-container">\n                    <div class="temp-talk-context"></div>\n            </div>'}appendMessage(t,e){if(ji.getInstance().isShow()){if(uu.getMycarData()&&uu.getMycarData().persons.get(parseInt(t))){let t=window.$(e).find(".chat-center-talktext").length>0?window.$(e).find(".chat-center-talktext")[0].id+"_temp":(new Date).getTime()+"-"+Math.floor(1e5*Math.random()),n=window.$(e).find(".chat-center-talktext").attr("id",t).removeAttr("at");window.$(".temp-talk-context").append(n.parents(".chat-text-content"))}let n=window.$(".temp-talk-context .chat-message-in-nickname font").last();"rgb(102, 102, 102)"!=n.css("color")&&"#666"!=n.css("color")||n.css("color","#fff");let i=window.$(e).find(".chat-message-image");if(i.length){window.$(".temp-talk-context .chat-message-image").last().css("margin-top","8px");let t=i[0].src;Ct.loadImage(t,(()=>{window.$(".temp-talk-context").scrollTop(999999)}))}else window.$(".temp-talk-context").scrollTop(999999)}}onRevocationMessage(t,e){e.call(this,t)}showBigImage(t){window.$.fancybox.open([{src:t}],{loop:!1,toolbar:"auto",buttons:["close"],image:{preload:!0},defaultType:"fade",type:"image"})}}class Di{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new Di),this.instance}getTemplate(t){return`<div class="love_room_container" style="background:url(${uu.roomInfo.skin}),no-repeat 0 0;background-size:100% 100%">\n                    <div class="love_room_title">${uu.roomInfo.title}</div>\n                    <div class="love_room_content ygb_f_c">\n                        ${t[0]}\n                        <img src="https://asset.tuwan.com/chatroom/images/love_room_heart.png">\n                        ${t[1]}\n                    </div>\n                </div>`}}class Li{constructor(){this.instance=null,this.times=0}static getInstance(){return this.instance||(this.instance=new Li),this.instance}show(t){const e=t.find(".newuser-show-svga");let n=0;if(!uu.isTempCarteamRoom()){const t=uu.getMycarData();if(n=t.fid,window.$('.newuser-show-svga div[data-fid="'+n+'"]').length>0&&0!=n)return}new Promise((()=>{const t="show-"+uu.getMeid()+"-"+(new Date).getTime();e.html('<div id="'+t+'" style="  width: 32px;height: 32px;" data-fid="'+n+'"></div>');const i=window.$("#"+t),o="https://asset.tuwan.com/chatroom/images/icon_mine2.svga?v1&date="+(new Date).getTime();Zt.getInstance().loadParser(i[0],o,1,!0,"Forward").then((t=>{const{videoItem:e,player:n}=t;n.onFinished((()=>{n.stopAnimation(),n.clear()}))}))}))}}class Ei{constructor(){this.seatsElements=window.$(".chat-center-main"),this.playerMap=new Map,this.myCarteamData=null}static getInstance(){return this.instance||(this.instance=new Ei),this.instance}onReset(){this.myCarteamData=null,this.clearAllPlayer()}clearAllPlayer(){for(let t of this.playerMap.values())for(const e of t)e.stopAnimation(),e.clear();this.playerMap.clear()}setMyCarteamData(t){this.myCarteamData=t}checkPlaying(t){const e=this.playerMap.get(t);return e&&e.length>0}addWaveSvga(t,e,n=0){const i=this.getWaveSvgaUrl(t),o=Zt.getInstance(),s=this;i&&!this.checkPlaying(`seat-wave-svga-${n}-`+t)&&setTimeout((()=>{this.seatsElements.find((0==n?".seat-item-empty":".song-seat-songer-wrapper")+"[data-uid='"+t+"']").find(".seat-wave-svga").each((function(a,r){o.loadParser(r,i,0,!1,"Forward",!1).then((i=>{if(e&&e()){const{videoItem:e,player:o}=i;o.setVideoItem(e),o.startAnimation(),s.setPlayerMap(`seat-wave-svga-${n}-`+t,o)}}),(t=>{}))}))}),0)}setPlayerMap(t,e){let n=this.playerMap.get(t);n||(n=[]),n.push(e),this.playerMap.set(t,n)}removePlayerMap(t){let e=this.playerMap.get(t);if(e)for(const n of e)n.stopAnimation(),n.clear();this.playerMap.set(t,[])}removeWaveSvga(t){this.removePlayerMap("seat-wave-svga-0-"+t),this.removePlayerMap("seat-wave-svga-1-"+t)}removeWaveSvgaByDom(t){t.length&&this.removeWaveSvga(t.get(0).dataset.uid)}getWaveSvgaUrl(t){let e=uu.getAnchorKengUsers().get(t);return e||this.myCarteamData&&(e=this.myCarteamData.find((e=>e.uid==t))),e?e.voices:null}}let Bi={},Fi=(m(t=class{static initMainSeats(e){const n=uu.isSpyRoom()?8:e.seats-1,i=e.cap_role;let o="",s=150,a=600,r="";if(uu.isShengyouRoom()){if(uu.isLiveRoom()?o=t._getMainAnchorSeatHtml(158,158,100,"主持"):(o=t._getMainAnchorSeatHtml(214,"auto",120,"主持"),a=n/2*s),uu.isShengyouFreeRoom()){let t="房间";uu.isShengyouFreeRoom()&&(t=uu.isPListType2()?"歌房":"车队"),(uu.isKillerFreeRoom()||uu.isSpyRoom())&&(t="房间");r='<div class="free-team-slider flex flex-ac flex-jc"><span>'+t+`</span> <div class="${window.$(".free-team-content.hide").length?"open":"close"}"></div></div>`}}else uu.isHuodongRoom()?(o=t._getMainAnchorSeatHtml(214,300,120,"主持"),a=n/2*s):uu.isTempCarteamRoom()?(o=t._getMainAnchorSeatHtml(214,230,120,i),s=136,a=960):uu.isTakeMeRoom()&&(o=t._getMainAnchorSeatHtml(158,158,100,"主持"));const c=uu.isShengyouRoom(),l=!1;let d=n;e.wheat_bgs;let m=[];if(uu.isLiveRoom()){for(let e=0;e<d;e++){const n=t._getOtherAnchorSeatHtml({position:3+e,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:l,shouhutype:1,headsvga:"",role:"嘉宾",index:0,pwidth:s,pheight:158,width:100,height:100,isrightline:!1,isshowmeili:!1});m.push(n)}return"<div class=\"flex chat-center-banner-main\" style='position:relative;'>\n                     "+Mi.getInstance().getTemplate(o,m)+"\n                    "+r+"\n                </div>"}if(uu.isTakeMeRoom()){for(let n=0;n<d;n++){const e=t._getOtherAnchorSeatHtml({position:3+n,defaultbg:"waitershafa",userinfo:null,iscar:!1,isshouhu:!1,shouhutype:1,headsvga:"",role:"",index:n+1||1,pwidth:94,pheight:108,width:80,height:80,isrightline:!1,isshowmeili:!0});m.push(e)}const e=this._getOtherAnchorSeatHtml({position:1,defaultbg:"boss",pwidth:94,pheight:118,width:90,height:90,isrightline:!1,defaultname:"虚位以待",isboss:!1,role:"主嘉宾"});Ai.getInstance().infillSeat(o,e,m)}else for(let h=0;h<d;h++){const e=t._getOtherAnchorSeatHtml({position:3+h,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:l,shouhutype:1,headsvga:"",role:"",index:h+1||1,pwidth:s,pheight:158,width:100,height:100,isrightline:!1,isshowmeili:c});m.push(e)}return'<div class="flex chat-center-banner-main" style=\'position:relative;\'>\n                    <div class="main-zhuci" style="z-index:840">\n                        '+o+'\n                      \n                    </div>\n                   \n                    <div class="flex main-kengwei flex-ac" style="flex-wrap:wrap;width:'+a+'px">\n                        '+m.join("")+"\n                    </div>\n                    "+r+"\n                </div>\n"}static initPaidanSeats(e,n){const i=this._getOtherAnchorSeatHtml({position:1,defaultbg:"boss",pwidth:240,pheight:n||300,width:126,height:126,isrightline:!0,defaultname:"虚位以待",isboss:!0});let o=[];const s=e.seats-1,a=124*s/2;for(let r=0;r<s;r++)o.push(t._getOtherAnchorSeatHtml({index:r+1,position:r+2,defaultbg:"add",role:0==r?"主持":"",pwidth:124,pheight:124,width:88,height:88,iscar:!1,userinfo:null,defaultname:"虚位以待"}));return'<div class="flex chat-center-banner-main">\n                    <div class="main-zhuci">\n                        '+i+'\n                    </div>\n                    <div class="flex main-kengwei flex-ac" style="flex-wrap:wrap;width:'+a+'px; margin-left:20px">\n                        '+o.join("")+"\n                    </div>\n                </div>"}static initCarTeamSeats(e){const n=t._getAnchorHtmlForCar();let i="";return uu.isAutoRoom()&&(i=t._getAutoroomSeatsRightHtml(e)),'<div class="flex new-kaihei-content">\n                    '+n+'\n                    <div class="flex flex-1 flex-dir-col flex-jc new-kaihei-teams">\n                        '+i+"\n                    </div>\n                </div>"}static initGameRoomSeats(e){const n=t._getAnchorHtmlForCar();let i="";return uu.isGameRoom()&&(i=t._getGameroomSeatsRightHtml(e)),'<div class="flex new-kaihei-content">\n                    '+n+'\n                     <div class="flex flex-1 flex-dir-col flex-jc new-kaihei-teams">\n                        '+i+"\n                    </div>\n\n                </div>"}static initJiamianRoomSeats(e){return t._createAnchorAndKingHtml(e.img_head)+t._createJiabinHtml(e.seats-2)}static initHunLiRoomSeats(e){return t._createNewLangAndNewNiangHtml(e.img_head)+t._createHunliJiabin(e.seats-2)}static initLOLmatchRoomSeats(e){return'<div class="inithide kengkengkeng chat-center-match">\n                        <div class="flex chat-center-match-have">\n                            <div class="flex">'+t._creatLOLSeatsHtml("left")+t._lolMatchVideoHtml()+t._creatLOLSeatsHtml("right")+"</div>\n                        </div>\n                    </div>"}static initBattleRoomSeats(e){return'<div class="battle-room-content flex" >\n                         <div class="battle-room-seat  flex flex-jc">'+t._getOtherAnchorSeatHtml({position:2,defaultbg:"mic",role:"解说",pwidth:150,pheight:160,width:100,height:100,isrightline:!1})+' </div>\n                         <div style="width: 100%;height: 100%;position: relative;">\n                             <iframe id="battle-resize-frame" style="position: absolute;z-index: -1;left: 0;top: 0;width: 100%;height: 100%;" frameborder="0" ></iframe>\n                             <div class="battle-room-bg"></div>\n                         </div>\n\n                         <div class="battle-room-seat flex flex-jc">'+t._getOtherAnchorSeatHtml({position:3,defaultbg:"mic",role:"解说",pwidth:150,pheight:160,width:100,height:100,isrightline:!1})+" </div>\n                </div>"}static initTakeMeRoomSeats(t){return'<div class="takeme-room-content">\n\n                </div>'}static initJingPaiRoomSeats(e){const n=t._getOtherAnchorSeatHtml({index:0,position:2,defaultbg:"mic",role:"主持",pwidth:124,pheight:124,width:88,height:88,iscar:!1,userinfo:null,defaultname:"虚位以待"}),i=t._getOtherAnchorSeatHtml({index:0,position:0,defaultbg:"mic",role:"嘉宾",pwidth:124,pheight:124,width:88,height:88,iscar:!1,userinfo:null,defaultname:"虚位以待"}),o=[];for(let r=0;r<3;r++)o.push(t._getOtherAnchorSeatHtml({index:0,position:r+3,defaultbg:"waitershafa",pwidth:164,pheight:134,width:0==r?100:80,height:0==r?100:80,iscar:!1,userinfo:null,defaultname:"empty",hatwidth:0==r?113:89,hatheight:0==r?133:1==r?103:97,hatpath:0==r?"https://asset.tuwan.com/chatroom/images/jingpai_1.png":1==r?"https://asset.tuwan.com/chatroom/images/jingpai_2.png":"https://asset.tuwan.com/chatroom/images/jingpai_3.png",hattop:0==r?-26:1==r?-18:-12,hatleft:0==r?-7:-4,hatorder:0==r?2:1==r?1:3,isshowmeili:!0,meilitype:2,zindex:6}));const s=t._getOtherAnchorSeatHtml({index:0,position:1,defaultbg:"empty",role:"",pwidth:150,pheight:190,width:110,height:110,iscar:!1,userinfo:null,defaultname:"empty",hatwidth:170,hatheight:170,hatpath:"https://asset.tuwan.com/chatroom/images/icon_auction_bg.png?v1",hattop:-30,hatleft:-30,hatorder:0,zindex:0,hattext:"敬请期待"}),a=[];for(let r=0;r<4;r++)a.push(t._getOtherAnchorSeatHtml({index:r+1,position:-1,defaultbg:"waitershafa",role:"嘉宾",pwidth:80,pheight:124,width:66,height:66,iscar:!1,userinfo:null,defaultname:"empty",xutype:1}));return'<div class="flex flex-ac inithide chat-center-jingpai">\n                        <div class="flex flex-dir-col flex-ac">\n                            <div class="flex  flex-ac">'+n+i+'</div>\n                            <div class="flex flex-ac jingpai-waiters">\n                                '+a.join("")+'\n                                <div class="flex flex-jc flex-ac jingpai-yugao">心动预告</div>\n                            </div>\n\n                        </div>\n                        <div class="flex flex-dir-col flex-ac flex-jc jiangpai-mai-boss">\n                            <div class="flex flex-jc">'+s+'</div>\n                            <div class="flex jingpai-mai-users" style="margin-bottom:30px">'+o.join("")+'</div>\n                        </div>\n                        <div class="jingpai-content" style="">\n\n                        </div>\n\n\n                    </div>'}static setJingpaiWaiters(e){const n=window.$(".jingpai-waiters").find(">div");for(let i=0;i<4;i++){const o=e[i];o?t._setWaiterItem(n.eq(i),o):t._clearWaiterItem(n.eq(i))}}static _setWaiterItem(t,e){const{nickname:n,name:i,avatar:o,color:s,heads:a,uid:r}=e;t.get(0).dataset.uid=r;const c=t.find(".seat-head-img"),l=t.find(".seat-user-name"),d=t.find(".seat-svga");c.attr("src",o),l.text(i).addClass("haveuser"),d.html(""),a&&Zt.getInstance().playLoop({ele:d.get(0),path:a},"svga_header_jingpai_"+r)}static _clearWaiterItem(t){const e=t.find(".seat-head-img"),n=t.find(".seat-user-name"),i=t.find(".seat-svga");t.find(".seat-close").hide();t.get(0).dataset.uid=0,e.attr("src",Mt.emptyPng),n.text("").removeClass("haveuser"),i.html("")}static _creatLOLSeatsHtml(e){return`<div class="lol_match_person_item_${e}" style="width:240px;margin-top:30px" class="lol_match_seat_content">\n                    <div class="chat_center_match_host_info">${t._getHeadItem({position:"left"==e?2:3,defaultbg:"add",role:"left"==e?"解说":"裁判",pwidth:240,pheight:169,width:110,height:110,isrightline:!1,svgaWidth:"140%",svgaHeight:"140%"})}</div>\n                    <div class="flex" style="flex-wrap:wrap">\n                        <div class="chat-center-match-teamname">战队名称</div>\n                        <div class="chat_center_match_list flex"></div>\n                    </div>\n                </div>`}static _lolMatchHostInfo(e){e.forEach(((e,n)=>{let i=e.position||(0==n?2:3),o=t._getHeadItem({position:i,defaultbg:"add",role:2==i?"解说":"裁判",pwidth:240,pheight:169,width:110,height:110,isrightline:!1,headsvga:e.headsvga,svgaWidth:"140%",svgaHeight:"140%",userinfo:e});window.$(`.lol_match_person_item_${2==i?"left":"right"} .chat_center_match_host_info`).html(o)}))}static _lolMatchTeamInfo(e){e.forEach(((e,n)=>{Array(5).fill(null),window.$(`.lol_match_person_item_${0==n?"left":"right"} .chat-center-match-teamname`).html(e.title||"战队名称"),window.$(`.lol_match_person_item_${0==n?"left":"right"} .chat_center_match_list`).attr("data-fid",e.fid),t._lolMatchTeamItem(e.data,e.fid)}))}static _lolMatchTeamItem(e,n){let i=[];const o=Array(5).fill(null);e.forEach((t=>{const i=t.position,s=t.uid;o[i-1]=t,s==uu.getMeid()&&uu.setMycarData(n,e)}));for(let s=0;s<o.length;s++)i.push(t._getHeadItem({position:o[s]?o[s].position:s+1,defaultbg:"add",role:0==s?"队长":"",pwidth:80,pheight:100,width:55,height:55,headsvga:o[s]?o[s].headSvga:"",isrightline:!1,iscar:!0,svgaWidth:"140%",svgaHeight:"140%",userinfo:o[s]||null}));window.$(`.chat_center_match_list[data-fid=${n}]`).html(i.join(""))}static _lolMatchVideoHtml(){return'<div class="chat-center-match-video">\n\t\t\t\t\t<div class="chat-center-match-video-main" id="J_prismPlayer" style="height:538px; border-radius:6px; overflow:hidden;">\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>'}static initMusicTempSeats(e){const n=e.seats-1;let i=156,o=e.fleetnum,s=[],a=n;10==o&&(i=188,a-=1);for(let c=0;c<a;c++){const e=t._getOtherAnchorSeatHtml({position:3+c,defaultbg:"mic",userinfo:null,iscar:!1,headsvga:"",role:"",index:c+1||1,pwidth:i,pheight:158,width:100,height:100,isrightline:!1});s.push(e)}if(10==o){const e={defaultbg:"lock",pwidth:i,pheight:158,width:100,height:100,defaultname:"empty"},n=t._getHeadItem(e);s.push(n)}let r=t._initSeatData(2,214,180,120,120,"队长",!1);return 10==o?'<div class="music-temp-container">\n                        <div class="play-again-conatiner hide">再来一局</div>\n                        <div class="music-temp heightAuto">\n                        <div>'+r+'</div>\n                        <div class="flex flex-wrap">\n                            '+s.join("")+"\n                        </div>\n                    </div>\n            </div>":'<div class="music-temp-container">\n                    <div class="play-again-conatiner hide">再来一局</div>\n                    <div class="music-temp">\n                    <div>'+r+'</div>\n                    <div class="flex">\n                        '+s.join("")+"\n                    </div>\n                </div>\n        </div>"}static initGameTempSeats(e){const n=e.seats-1;let i=e.cap_role,o=[];for(let s=0;s<n;s++){const e=t._getOtherAnchorSeatHtml({position:3+s,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"",index:s+1||1,pwidth:156,pheight:158,width:100,height:100,isrightline:!1});o.push(e)}return'<div class="game-temp flex flex-ac">\n                   '+t._initSeatData(2,214,180,120,120,i,!0)+o.join("")+'\n                       <div class="play-again-conatiner hide">再来一局</div>\n                </div>'}static initVideoTempSeats(){let e=t._initSeatData(2,214,180,120,120);return window.$(".new-video-temp-anchor").html(e),"<div class=\"flex chat-center-temp-main\" style='position:relative;'>\n                </div>"}static init1vs7TempSeats(e){const n=e.fleetnum,i=e.seats-1,o=e.cap_role;let s="",a=[],r=i;const c=uu.isShengyouRoom();s=t._getMainAnchorSeatHtml(214,158,105,o,!1),0==uu.roomInfo.game_type&&r--;for(let l=0;l<r;l++){const e=t._getOtherAnchorSeatHtml({position:3+l,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:false,headsvga:"",role:"",index:l+1||1,pwidth:150,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:c});a.push(e)}if(0==uu.roomInfo.game_type){const e={defaultbg:"lock",pwidth:150,pheight:144,width:100,height:100,defaultname:"empty"},n=t._getHeadItem(e);a.push(n)}return 10==n?'<div class="flex flex-jc chat-center-banner-main" style=\'position:relative;\'>\n                <div class="troom1v7-container">\n                    <div class="troom1v7-anchor-container flex flex-jc">'+s+'</div>\n                    <div class="troom1v7-guest-container flex flex-jc"> <div class="troom1v7-guest-wrapper autoWidth flex">'+a.join("")+'</div> </div>\n                </div>\n                <div class="play-again-conatiner hide" style="top: 25px;right: 15px;">再来一局</div>\n            </div>':'<div class="flex flex-jc chat-center-banner-main" style=\'position:relative;\'>\n                <div class="troom1v7-container">\n                    <div class="troom1v7-anchor-container flex flex-jc">'+s+'</div>\n                    <div class="troom1v7-guest-container flex flex-jc"> <div class="troom1v7-guest-wrapper flex">'+a.join("")+'</div> </div>\n                </div>\n                <div class="play-again-conatiner hide" style="top: 25px;right: 15px;">再来一局</div>\n            </div>'}static initKingTeamVsTempSeats(e){e.cap_role;let n="",i="",o=150,s=[],a=[];const r=uu.isShengyouRoom(),c=!1;n=t._getOtherAnchorSeatHtml({position:2,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:c,headsvga:"",role:"",index:1,pwidth:o,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:r}),i=t._getOtherAnchorSeatHtml({position:10,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:c,headsvga:"",role:"",index:6,pwidth:o,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:r}),uu.roomInfo.game_type;for(let l=0;l<4;l++){const e=t._getOtherAnchorSeatHtml({position:3+l,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:c,headsvga:"",role:"",index:l+2||1,pwidth:o,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:r});s.push(e)}for(let l=7;l<11;l++){const e=t._getOtherAnchorSeatHtml({position:l+4,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:c,headsvga:"",role:"",index:l,pwidth:o,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:r});a.push(e)}return'<div class="flex flex-jc chat-center-banner-main" style=\'position:relative;\'>\n            <div class="troom5v5-container">\n                <div class="troom5v5-guest-container flex flex-jc">\n                    <div class="troom5v5-guest-wrapper flex">\n                        <div class="subCtn leftCtn">\n                            <div class="headCtn">'+n+'</div>\n                            <div class="bodyCtn">'+s.join("")+`</div>\n                        </div>\n                        <div class="subCtn rightCtn">\n                            <div style="display:${2==uu.roomInfo.team_stage?"none":"block"}">\n                                <div class="headCtn">`+i+'</div>\n                                <div class="bodyCtn">'+a.join("")+'</div>\n                            </div>\n                            <div class="findingTeamCtn">匹配中...</div>\n                        </div>\n                    </div>\n                </div>\n                <div class="kingTeamVsLogoCtn_static_img"></div>\n                <div id="kingTeamVsLogoCtn" class="kingTeamVsLogoCtn hide"></div>\n                <div class="kingTeamWaitToStartTimerCtn hide">\n                    <div class="title">取消匹配</div>\n                    <div class="timerCtn"></div>\n                </div>\n                <div class="kingTeamWaitToStartTimerCtnFlexCtn hide">\n                    <div class="leaveBtn">离开</div>\n                    <div class="startBtn">\n                        <div class="title">取消匹配</div>\n                        <div class="timerCtn"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="play-again-conatiner hide">再来一局</div>\n        </div>'}static initPeaceTeamVsTempSeats(e,n,i){let o=e.list;if(!o||o&&0==o.length)return;e.team_countdown,e.team_stage;let s=0,a=1==o[0].is_pre,r="",c=[];const l=uu.isShengyouRoom(),d=!1,m=[];for(let h=0;h<o.length;h++){let e=o[h],n=e.team_name,i=e.title,a=e.star_level,u=e.is_pre;const p=`\n                <div class="subHeadCtn">\n                    <div class="leftTitleCtn">${n}</div>\n                    <div class="centerTitleCtn">${i}</div>\n                    <img alt="" src="https://asset.tuwan.com/squadron/images/icon_level${a}.png"  class="rightIconImg"/>\n                </div>\n            `;1==e.is_pre&&s++,r=t._getOtherAnchorSeatHtml({position:2,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:d,headsvga:"",role:"领队",index:1,pwidth:150,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:l});for(let o=0;o<3;o++){const e=t._getOtherAnchorSeatHtml({position:3+o,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:d,headsvga:"",role:"队员",index:o+2||1,pwidth:150,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:l});c.push(e)}const g=`\n                    <div class="peaceListItem ${1==u?"active":""}" data-index=${h}>\n                        ${p}\n                        <div class="subContainer flex">\n                            <div class="indexCtn">${h+1}</div>\n                            <div class="headCtn">`+r+'</div>\n                            <div class="bodyCtn flex">'+c.join("")+"</div>\n                        </div>\n                    </div>";m.push(g)}o[0].data[0].uid==uu.getMeid()&&(ci.show(-6,ci.type.matchCodeImg),$('.opbutton.show[data-type="matchCodeImg"]').addClass("disable")),1==o[0].is_pre&&o[0].data[0].uid==uu.getMeid()&&s>=uu.getRoomInfo().min_member&&($('.opbutton.show[data-type="matchCodeImg"]').removeClass("disable"),setTimeout((()=>{$('.opbutton[data-type="matchCodeImg"]').trigger("click")}),10));return`<div class="flex flex-jc chat-center-banner-main" style='position:relative;'>\n            <div class="peaceTeam-main-container">\n                <div class=" flex flex-jc onlyPositinCtn" style="flex-direction: column;align-items: center;">\n                    <div class="peaceTeamListCtn scroll">\n                        ${m.join("")}\n                    </div>\n                </div>\n                <div class="peaceTeamMatchBottomCtn">\n                    <div class="topCtn">\n                        <span class="pt_leftCtn">队伍：${o.length}支</span>\n                        <span class="pt_centerCtn white"><span class="timeSum">等待倒计时：</span><span class="timerCtn"></span></span>\n                        <span class="pt_rightCtn">模式：${n}</span>\n                        <span class="altCtn">已准备(<span class="subReadyNumsCtn">${s}</span>/${i})</span>\n                    </div>\n                    <div class="flagCtn hide">\n                        <div class="bottomCtn">\n                            ${a?'<div class="leftBtn btn opt5"><div class="bgCtn"></div></div>':'<div class="leftBtn btn leaveBtn"><div class="bgCtn"></div></div>'}\n                            ${a?'<div class="rightBtn opt5 btn"><div class="bgCtn"></div></div>':'<div class="rightBtn readyStatusBtn btn"><div class="bgCtn"></div> </div>'}\n                        </div>\n                        <div class="readyNumCtn hide">\n                            <div class="readyCtn" id="peaceIsReadyNums">已准备(<span class="subReadyNumsCtn">${s}</span>/${i})</div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="kingTeamVsLogoCtn_static_img peaceImg hide">比赛倒计时 10s</div>\n                <div id="kingTeamVsLogoCtn" class="kingTeamVsLogoCtn peaceTeamVsCtn hide"></div>\n            </div>\n        </div>`}static onlyPositionInitPeaceTeamVsTempSeats(e){let n=e.list;if(!n||n&&0==n.length)return;e.team_countdown,e.team_stage;let i=0,o="",s=[];const a=uu.isShengyouRoom(),r=!1,c=[];for(let l=0;l<n.length;l++){let e=n[l],d=e.team_name,m=e.title,h=e.star_level,u=e.is_pre;const p=`\n                <div class="subHeadCtn">\n                    <div class="leftTitleCtn">${d}</div>\n                    <div class="centerTitleCtn">${m}</div>\n                    <img alt="" src="https://asset.tuwan.com/squadron/images/icon_level${h}.png"  class="rightIconImg"/>\n                </div>\n            `;1==e.is_pre&&i++,o=t._getOtherAnchorSeatHtml({position:2,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:r,headsvga:"",role:"领队",index:1,pwidth:150,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:a}),s=[];for(let n=0;n<3;n++){const e=t._getOtherAnchorSeatHtml({position:3+n,defaultbg:"mic",userinfo:null,iscar:!1,isshouhu:r,headsvga:"",role:"队员",index:n+2||1,pwidth:150,pheight:144,width:100,height:100,isrightline:!1,isshowmeili:a});s.push(e)}const g=`\n                    <div class="peaceListItem ${1==u?"active":""}" data-index=${l}>\n                        ${p}\n                        <div class="subContainer flex">\n                            <div class="indexCtn">${l+1}</div>\n                            <div class="headCtn">`+o+'</div>\n                            <div class="bodyCtn flex">'+s.join("")+`</div>\n                        </div>\n                    </div>\n                    <div class="peaceListItem hide">\n                        ${p}\n                            <div class="subContainer flex">\n                            <div class="indexCtn">2</div>\n                            <div class="headCtn">`+o+'</div>\n                            <div class="bodyCtn flex">'+s.join("")+"</div>\n                        </div>\n                    </div>";c.push(g)}return n[0].data[0].uid==uu.getMeid()&&(ci.show(-6,ci.type.matchCodeImg),$('.opbutton.show[data-type="matchCodeImg"]').addClass("disable")),1==n[0].is_pre&&n[0].data[0].uid==uu.getMeid()&&i>=uu.getRoomInfo().min_member&&($('.opbutton.show[data-type="matchCodeImg"]').removeClass("disable"),setTimeout((()=>{$('.opbutton[data-type="matchCodeImg"]').trigger("click")}),10)),`\n            <div class="peaceTeamListCtn scroll">\n                ${c.join("")}\n            </div>\n        `}static initSelfLiveSeats(e){const n=e.seats-1;let i=[];for(let s=0;s<n;s++){const e=t._getOtherAnchorSeatHtml({position:3+s,defaultbg:"mic",userinfo:null,iscar:!1,headsvga:"",role:"",index:s+1||1,pwidth:72,pheight:100,width:48,height:48,isrightline:!1});i.push(e)}let o=t._initSeatData(2,214,180,120,120);return"<div class=\"flex chat-center-banner-main\" style='position:relative;'>\n                 "+Mi.getInstance().getTemplate(o,i)+"\n            </div>"}static initSongTempRoomSeats(e){e.seats;let n=[];for(let i=0;i<8;i++){const e=t._getOtherAnchorSeatHtml({position:2+i,defaultbg:"mic",userinfo:null,iscar:!1,headsvga:"",role:"嘉宾",index:i+1||1,pwidth:134,pheight:142,width:90,height:90,isrightline:!1});n.push(e)}return'<div class="flex flex-dir-col chat-center-banner-main" style=\'position:relative;padding: 29px 29px 0px 29px\'>\n\n                    <div class="song-seats-wrapper flex flex-ac ">\n                         <div class="flex flex-dir-col song-but-wrapper" >\n                           <div class="song-but song-but-catgory flex flex-jc flex-ac hide"> 曲库</div>\n                           <div class="song-but song-but-setting flex flex-jc flex-ac hide">设置</div>\n                           <div class="song-but song-but-clockin flex flex-jc flex-ac hide">打卡</div>\n                           <div class="song-but song-but-accompany flex flex-jc flex-ac hide" >原唱:关</div>\n                         </div>\n                        <div class="song-seat-songer-wrapper flex flex-ac flex-dir-col">\n                                <div class="song-songer-info-wrapper flex flex-ac flex-dir-col">\n                                    <div class="seat-head">\n                                        <div class="seat-wave"></div>\n                                        <div class="seat-wave-svga"></div>\n                                        <div style="width:120px;height: 120px"></div>\n                                        <div class="songer-user-head">\n                                           <img class="songer-head-img" src="https://asset.tuwan.com/chatroom/images/icon_logo.png"\n                                            onerror="this.src=\'https://asset.tuwan.com/chatroom/images/icon_logo.png\'">\n                                         </div>\n                                         <div class="seat-svga" ></div>\n                                         <span class="seat-role-tag">歌手</span>\n                                    </div>\n                                    <p class="seat-user-name haveuser"></p>\n                                </div>\n                                <div class="song-lyric-empty flex flex-ac flex-dir-col ">\n                                     <div>欢迎来听歌</div>\n                                     <div class="flex flex-jc "><i class="song-note song-note-left"/>唱歌请带耳机避免回音 <i class="song-note song-note-right"/></div>\n                                </div>\n                                <div class="song-lyric-wrapper hide">\n                                    <div id="song-lyric"></div>\n                                </div>\n                        </div>\n                        <div class="flex song-seats-container">  '+n.join("")+"</div>\n                    </div>\n\n            </div>"}static initSoloTempRoomSeats(e){e.seats;let n=[];for(let i=0;i<2;i++){const e=t._getOtherAnchorSeatHtml({position:2+i,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"",index:i+1||1,pwidth:156,pheight:158,width:100,height:100,isrightline:!1});n.push(e)}return"<div class=\"flex chat-center-banner-main\" style='position:relative;'>\n                 "+`<div class="solo_room_container flex flex-jc">\n                    <div class="solo_room_content flex flex-ac">\n                        ${n[0]}\n                        <img style="margin: 0 50px" src="https://asset.tuwan.com/chatroom/images/icon_solo_battle.png">\n                        ${n[1]}\n                    </div>\n                    <div class="solo-car-tips" style="position: absolute;right: 10px;top: 10px;">Solo车队说明</div>\n                </div>`+"\n            </div>"}static initSelfLoveRoomSeats(e){e.seats;let n=[];for(let i=0;i<2;i++){const e=t._getOtherAnchorSeatHtml({position:3+i,defaultbg:"mic",userinfo:null,iscar:!1,headsvga:"",role:"",index:i+1||1,pwidth:156,pheight:158,width:100,height:100,isrightline:!1});n.push(e)}return"<div class=\"flex chat-center-banner-main\" style='position:relative;'>\n                 "+Di.getInstance().getTemplate(n)+"\n            </div>"}static initTruthRoomSeats(t){}static initDrawRoomSeats(e){const n=e.seats-1;e.cap_role;let i="",o=[],s=n;i=t._getHeadItem({position:2,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"主持",pwidth:100,pheight:160,width:100,height:100,isrightline:!1}),window.$(".seat-draw-main-seat").html(i);for(let a=0;a<s;a++){const e=t._getOtherAnchorSeatHtml({position:3+a,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"",index:a+1,pwidth:92,pheight:80,width:48,height:48,isrightline:!1});o.push(e)}return"<div class=\"flex flex-jc\" style='position:relative;'>\n            "+o.join("")+"\n        </div>"}static initDrawTempRoomSeats(e){const n=e.seats-1;e.cap_role;let i="",o=[],s=n;i=t._getHeadItem({position:2,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"",index:1,pwidth:92,pheight:80,width:48,height:48,isrightline:!1});for(let a=0;a<s;a++){const e=t._getOtherAnchorSeatHtml({position:3+a,defaultbg:"add",userinfo:null,iscar:!1,headsvga:"",role:"",index:a+2,pwidth:92,pheight:80,width:48,height:48,isrightline:!1});o.push(e)}return"<div class=\"flex flex-jc\" style='position:relative;'>\n            "+i+o.join("")+"\n        </div>"}static _createAnchorAndKingHtml(e){return'<div class="flex jiamian-king-anchor">\n                            <div class="flex jianmian-harf jianmian-main-seats">\n                                \x3c!-- 主持座 --\x3e\n                                <div class="flex jiamian-anchor">\n                                '+t._getOtherAnchorSeatHtml({position:2,defaultbg:"mic",role:"主持",pwidth:120,pheight:120,width:84,height:84,isrightline:!1,isglodborder:!0})+'\n                                </div>\n\n                                \x3c!-- 老板座 --\x3e\n                                <div class="flex jiamian-king">\n                                '+t._getJiamianHeadItem({position:1,defaultbg:"shafa",pwidth:200,pheight:200,width:164,height:164,headsvga:e})+'\n                                </div>\n\n                            </div>\n                            <div class="jianmian-harf">\n                            </div>\n                        </div>'}static _createJiabinHtml(e){let n=[];for(let i=0;i<e;i++)n.push(t._getOtherAnchorSeatHtml({position:i+3,defaultbg:"mic",role:"嘉宾",pwidth:160,pheight:109,width:60,height:60,isrightline:!1,index:i+1}));return'<div class="flex jiamian-jiabins-main">\n                        <div class="flex jiamian-jiabins" style="width:'+160*(e/2)+'px">\n                            '+n.join("")+"\n                        </div>\n                    </div>"}static _createNewLangAndNewNiangHtml(e){return'<div class="flex flex-jc hunli-lang-niang" style="margin-top: 30px">\n                            \x3c!-- 主持座 --\x3e\n                            <div class="flex hunli-lang">\n                            '+t._getHeadItem({position:0,defaultbg:"add",role:"新郎",pwidth:120,pheight:120,width:80,height:80,isrightline:!1,headsvga:e,svgaWidth:"140%",svgaHeight:"140%"})+'\n                            </div>\n\n                            \x3c!-- 老板座 --\x3e\n                            <div class="flex hunli-niang">\n                            '+t._getHeadItem({defaultbg:"add",role:"新娘",pwidth:120,pheight:120,width:80,height:80,headsvga:e,svgaWidth:"140%",svgaHeight:"140%",position:1})+"\n                            </div>\n                        </div>"}static _createHunliJiabin(e){let n=[];for(let i=0;i<e;i++)n.push(t._getHeadItem({position:i+2,defaultbg:"mic",role:0==i?"司仪":"",pwidth:96,pheight:100,width:66,height:66,isrightline:!1,index:i+1}));return'<div class="flex flex-jc hunli-jiabins-main">\n                        <div class="flex hunli-jiabins" style="width:464px; flex-wrap:wrap">\n                            '+n.join("")+"\n                        </div>\n                    </div>"}static initMarryRoomSeatHtml(e){let n=["新娘","新郎","司仪"],i=[],o=[],s=[];for(let a=0;a<3;a++)i.push(t._getHeadItem({position:a,defaultbg:2==a?"mic":"waitershafa",role:n[a],pwidth:120,pheight:120,width:90,height:90,isrightline:!1,headsvga:2==a?"":0==a?e.img_head:e.img_head2,svgaWidth:"140%",svgaHeight:"140%"}));for(let a=0;a<4;a++)s.push(t._getHeadItem({position:a+3,defaultbg:"mic",role:"伴娘",pwidth:120,pheight:120,width:90,height:90,isrightline:!1,index:a+1})),o.push(t._getHeadItem({position:a+7,defaultbg:"mic",role:"伴郎",pwidth:120,pheight:120,width:90,height:90,isrightline:!1,index:a+5}));return`<div class="marry_main">\n                        <div class="couple_seats flex flex-jc">\n                            <div class="host_seats_content">\n                                <div class="marry_host_btn flex-dir-col">\n                                    <div class="marry_host_btn_item marry_operate flex flex-jc flex-ac"></div>\n                                    <div class="marry_host_btn_item marry_next_stage flex-jc flex-ac">下一关</div>\n                                    <div class="marry_host_btn_item marry_reset flex flex-jc flex-ac"></div>\n                                </div>\n                                <div class="host_seats">${i[2]}</div>\n                            </div>\n                            ${i[0]}\n                            <img class="couple_heart" src="https://asset.tuwan.com/activity/marry/heart.png">\n                            ${i[1]}\n                        </div>\n                        <div class="marry_common_seats_content flex flex-jc">\n                            <div class="bridesmaid_seats marry_common_seats flex flex-jc">\n                            ${s.join("")}\n                            </div>\n                            <div class="marry_que">\n                                <div class="marry_title"></div>\n                                <div class="marry_desc"></div>\n                                <div class="marry_extra">\n                                    <div class="marry_extra_item marry_guess_lips"></div>\n                                    <div class="marry_extra_item marry_guess_word flex-jb">\n                                        <div class="marry_guess_word_info"></div>\n                                        <div class="marry_guess_word_time"></div>\n                                    </div>\n                                    <div class="marry_extra_item marry_bless flex-jb flex-ac">\n                                        <div class="marry_bless_num">已收集<span>0</span>人祝福</div>\n                                        <div class="marry_bless_btn"></div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="groomsman_seats marry_common_seats flex flex-jc">\n                            ${o.join("")}\n                            </div>\n                        </div>\n                    </div>`}static setKaiheiTeams(e,n){let i=[];const o=uu.getRoomInfo(),s=o.fleetnum,a=o.cap_role;let r=["#c2a4ff","#becfff","#ffc6cb"];for(let c=0;c<e.length&&!(c>=3);c++)i.push(t._kaihei3Item(s,a,e[c],n,r[c],c));window.$(".new-kaihei-teams").html(i.join(""))}static setGameTeams(e,n,i=!1){let o=[];const s=uu.isSpyRoom()||24==uu.roomInfo.pgameid&&uu.isWerewolfTeamRoom();for(let a=0;a<e.length;a++){const n=e[a];let{desc:r,num:c=0,pic:l,fid:d,type:m,total:h=0,coinsRoom:u,needCoins:p,area:g,gameMode:f,gold:w,nickname:v,vipicon:_,roomDesc:y,subTitle:x,areaNum:b,startTime:$,endTime:k,etime:C,roomType:I,live:S,cid:T}=n;s&&(g=n.roomTypeDesc);const R=`allHourShowTimeCtn_${a}_${d}`,M=1==u?`${p} <img style="margin-left: 4px; width: 16px;" src="${uu.isLeyuanshaRoom()?"https://asset.tuwan.com/chatroom/images/icon_leyuansha_gold.png":"https://asset.tuwan.com/chatroom/images/icon_game_glod.png"}" />`:y;let A='<div class="swiper-slide" style="padding:0 5px; height:114px; box-sizing: border-box;">\n                <div class="flex flex-ac seats-game-caritem" data-fid="'+d+'" data-type="'+m+`" data-roomtype=${I}>\n\n                    <div class="team-item-header margintop6">\n                        <div class="seats-game-caritem-pic">\n                            <img src="`+l+'" />\n                        </div>\n                        <div class="room_status"></div>\n                    </div>\n\n                    <div class="flex-1" style="margin-left:10px;height: 88px">\n                        <p>'+r+'</p>\n                        <p style="margin:3px 0;" class="flex flex-ac" > <span class="flex flex-ac" style="border:solid 1px rgba(255,85,136,.9);border-radius:4px;padding:0 5px;">'+M+"</span></p>\n                        <p>"+g+'</p>\n                        <p class="flex flex-jb" style="width:100%"><span><font class="font-num">'+c+"</font>/"+h+`</span>\n                        <span style="border-radius: 6px;background: rgba(255, 85, 136, ${i?1:.5});width: 64px; height: 22px;font-size: 12px;\n                                color: #fff;text-align: center;line-height: 22px;z-index: 1;">加入</span></p>\n                    </div>\n                </div>\n            </div>`;"hour_match"==n.deskType||"style1"==n.deskType||"room"==n.destType?(A='<div class="swiper-slide" style="padding:0 5px; height:114px; box-sizing: border-box;">\n                    <div class="flex flex-ac seats-game-caritem" data-fid="'+d+'"  data-live="'+S+'"  data-cid="'+T+'"  data-type="'+m+`" data-roomtype=${I}>\n\n                        <div class="team-item-header margintop6">\n                            <div class="seats-game-caritem-pic">\n                                <img src="`+l+'" />\n                            </div>\n                            <div class="room_status"></div>\n                        </div>\n\n                        <div class="flex-1" style="margin-left:10px;height: 88px">\n                            <p style="position: relative;width: 203px;">'+r+` <span class="subTtitle" style="font-size: 12px; transform: scale(0.9); display: inline-block;margin-left: -7px;">${x?`(${x})`:""}</span></p>\n                            <p style="margin:3px 0;" class="flex flex-ac" > <span>`+g+'</span></p>\n                            <p class="flex flex-jb" style="width:100%"> <span class="flex flex-ac" style="">'+M+`</span>\n                            <span style="border-radius: 6px;background: rgba(255, 85, 136, ${i?1:.5});width: 64px; height: 22px;font-size: 12px;\n                                    color: #fff;text-align: center;line-height: 22px;z-index: 1; position: absolute; right: 14px; bottom: 13px;">加入</span></p>\n                            <p style="font-size: 12px; margin-top: 3px; opacity: 0.7; display: none" class="${R}"><span class="timeTitle">剩余时间:</span> <span class="timeCtn">00:00</span></p>\n                            <div class="peopleNumCtn" style="position: absolute; right: 30px; bottom: 60px; font-size: 12px;align-items: center; display: ${b?"flex":"none"}">\n                                <span class="spBg" style="display: inline-block;margin-top: -3px;background: url(&quot;https://asset.tuwan.com/chartRoom/currentPeopleNums.png&quot;);background-size: cover;width: 9px;height: 12px;margin-right: 3px;margin-bottom: -2px; margin-bottom: -2px"></span>\n                                ${b}\n                            </div>\n                        </div>\n                    </div>\n                </div>`,t.initIntervalTime($,C||k,R)):"quick_join"==n.deskType&&(A='<div class="swiper-slide" style="padding:0 5px; height:114px; box-sizing: border-box;">\n                    <div class="flex flex-ac seats-game-caritem" data-fid="'+d+'" data-type="'+m+`" data-roomtype=${I}>\n                    <span class="allDayOpen" style="position: absolute; right: 5px; top: 0px; background: #60BB48; font-size: 12px; padding: 4px 10px; border-top-right-radius: 7px; border-bottom-left-radius: 7px;">全天开放</span>\n                        <div class="team-item-header margintop6">\n                            <div class="seats-game-caritem-pic">\n                                <img src="`+l+'" />\n                            </div>\n                            <div class="room_status"></div>\n                        </div>\n\n                        <div class="flex-1" style="margin-left:10px;height: 88px">\n                            <p style="position: relative;width: 203px;">'+r+` <span class="subTtitle" style="font-size: 12px; transform: scale(0.9); display: inline-block;margin-left: -7px;">${x?`(${x})`:""}</span></p>\n                            <p style="margin:3px 0;" class="flex flex-ac" > <span>`+g+'</span></p>\n                            <p class="flex flex-jb" style="width:100%"> <span class="flex flex-ac" style="">'+M+`</span>\n                            <span style="border-radius: 6px;background: rgba(255, 85, 136, ${i?1:.5});width: 64px; height: 22px;font-size: 12px;\n                                    color: #fff;text-align: center;line-height: 22px;z-index: 1; position: absolute; right: 14px; bottom: 13px;">加入</span></p>\n                            <p style="font-size: 12px; margin-top: 3px; opacity: 0.7; display: none" class="${R}"><span class="timeTitle">剩余时间:</span> <span class="timeCtn">00:00</span></p>\n                            <div class="peopleNumCtn" style="position: absolute; right: 30px; bottom: 60px; font-size: 12px;align-items: center; display: ${b?"flex":"none"}">\n                                <span class="spBg" style="display: inline-block;margin-top: -3px;background: url(&quot;https://asset.tuwan.com/chartRoom/currentPeopleNums.png&quot;);background-size: cover;width: 9px;height: 12px;margin-right: 3px;margin-bottom: -2px; margin-bottom: -2px"></span>\n                                ${b}\n                            </div>\n                        </div>\n                    </div>\n                </div>`),o.push(A)}if(i)return o.join("");window.$(".autoroom-teamlist").html(o.join(""))}static initIntervalTime(t,e,n){let i,o;t&&1e3*t>+new Date?(i=!0,setTimeout((()=>{$(`.${n} .timeTitle`).html("即将开始")}),1e3)):e&&1e3*e>+new Date?(i=!1,setTimeout((()=>{$(`.${n} .timeTitle`).html("剩余时间")}),1e3)):$(`.${n}`).hide(),o=i?1e3*t-+new Date:1e3*e-+new Date,o/=1e3,o>0&&(Bi[n]&&clearInterval(Bi[n]),o--,Bi[n]=setInterval((()=>{o=Math.floor(o);let t=Math.floor(o/60),s=o-60*t;t=t<10?"0"+t:t,s=s<10?"0"+s:s;let a=`${t}:${s}`;if("none"==$(`.${n}`).css("display")&&$(`.${n}`).show(),$(`.${n} .timeCtn`).html(a),o--,o<0)if(i){i=!1,o=1e3*e-+new Date,o/=1e3,o=Math.floor(o);let t=Math.floor(o/60),s=o-60*t;t=t<10?"0"+t:t,s=s<10?"0"+s:s;let a=`${t}:${s}`;$(`.${n} .timeCtn`).html(a),$(`.${n} .timeTitle`).html("剩余时间")}else clearInterval(Bi[n]),Bi[n]="",$(`.${n}`).hide()}),1e3))}static updateGameRoomKaiheiItemData(e,n,i){const o=uu.getRoomInfo().fleetnum,s=window.$(".new-kaihei-teams").find(".kaihei-team-item[data-fid='"+e+"']"),a=Array(o).fill(null);let r=null;for(let t=0;t<n.length;t++){const o=n[t],s=o.position,c=o.uid;a[s-1]=o,c==i&&(uu.setMycarData(e,n),r=o)}for(let c=0;c<a.length;c++){const e=a[c];e?t._setGameTeamSeatKeng(s,e,i):t._clearGameTeamSeatKeng(s,c+1)}return r}static updateKaiheiItemData(e,n,i){const o=uu.getRoomInfo().fleetnum,s=window.$(".new-kaihei-teams").find(".kaihei-team-item[data-fid='"+e+"']"),a=Array(o).fill(null);let r=null;for(let t=0;t<n.length;t++){const o=n[t],s=o.position,c=o.uid;a[s-1]=o,c==i&&(uu.setMycarData(e,n),r=o)}const c=a.find((t=>null!=t&&1==t.position)),l=null!=c?c.uid:0;for(let d=0;d<a.length;d++){const e=a[d];e?(t._setTeamSeatKeng(s,e,i),1!=e.isnew||i!=e.uid&&l!=i||0!=s.find(".seat-item-empty[data-uid="+e.uid+"]").length&&1!=s.find(".seat-item-empty[data-uid="+e.uid+"]")[0].dataset.speak&&(24!=uu.roomInfo.typeid&&27!=uu.roomInfo.typeid&&30!=uu.roomInfo.typeid&&31!=uu.roomInfo.typeid&&(5!=uu.roomInfo.typeid||24!=uu.roomInfo.ptype&&27!=uu.roomInfo.ptype&&30!=uu.roomInfo.ptype&&31!=uu.roomInfo.ptype)||(s.find(".seat-item-empty[data-uid="+e.uid+"]").addClass("newUser"),i==e.uid&&Li.getInstance().show(s.find(".seat-item-empty[data-uid="+i+"]"))))):t._clearTeamSeatKeng(s,d+1)}return r}static setGameroomTuijianData(e,n){const i=e.fid,o=e.data,s=e.title;window.$(".new-kaihei-teams").find(".new-team-name").text(s),t.updateGameRoomKaiheiItemData(i,o,n)}static setAutoroomTuijianData(e,n){const i=e.fid,o=e.data,s=e.title,a=e.desc,r=e.giftid,c=e.giftnum,l=window.$(".new-kaihei-teams"),d=l.find(".kaihei-team-item");d.attr("data-fid",i),d.find(".new-team-name").text(),l.find(".kaihei-team-item").attr("data-fid",i),l.find(".new-team-name").text(s);let m="";if(r>0&&c>0){m='<div>【赏 <img src="'+ue.get(r).icon+'" style="width:18px;height:18px;" /> X '+c+"】</div>"}l.find(".autoroom-tuijian-desc").html(m+"<div>"+a+"</div>"),t.updateKaiheiItemData(i,o,n)}static clearAutoroomTuijianSeats(){const t=window.$(".new-kaihei-teams");t.find(".kaihei-team-item").attr("data-fid",0),t.find(".new-team-name").text(uu.getRoomInfo().fleet_name),t.find(".autoroom-tuijian-desc").html("")}static updateAutoroomTeamInNum(t,e,n){const i=window.$(".autoroom-allteams").find(".autoroom-team-item[data-fid='"+t+"']");if(e&&i.find("font").text(e),null!==n){n?i.find(".carauto-item-btn").addClass("joined"):i.find(".carauto-item-btn").removeClass("joined");const t=uu.isShengyouFreeRoom()?"加入":"加入车队";i.find(".carauto-item-btn").text(n?"已加入":t)}}static updateGameroomTeamInNum(t,e=0,n="",i){const o=window.$(".autoroom-allteams").find(".seats-game-caritem[data-fid='"+t+"']");1==i?o.find("font.font-num").text(e):2==i&&o.find(".seats-game-caritem-pic img").attr("src",n)}static updateKillerBattleTeamInNum(t,e=0,n="",i){const o=window.$("#new-right-team-content").find(".seats-game-caritem[data-fid='"+t+"']");1==i?o.find("font.font-num").text(e):2==i&&o.find(".seats-game-caritem-pic img").attr("src",n)}static updateBattleroomTeamInNum(t,e=0,n=""){const i=window.$("#right-new-team").find(".autoroom-team-item[data-fid='"+t+"']"),o=window.$("#right-new-team").find(".newcar-team-item[data-fid='"+t+"']");i.find(".carauto-team-list-intro-2 font").text(e),o.find("font").text(e)}static setAutoRoomTeamList(e,n,i){let o=[];for(let s=0;s<e.length;s++)o.push(t._setAutoRoomTeamItem(e[s],n,i));return o.join("")}static setSongRoomTeamList(e,n){let i=[];for(let o=0;o<e.length;o++)i.push(t._setSongRoomTeamItem(e[o],n));return i.join("")}static setAutoRoomEmptyTeam(){const t=uu.getCarButtonStr();return'<div class="swiper-slide autoroom-team-item" data-tcid="0" data-areaid="0" data-uid="0" data-state="-1" data-uids="">\n                    <div class="autoroom-team-item-content">\n\n                        <div class="">\n                            <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="https://res.tuwan.com/templet/play/chat/images/defaulthead.png">\n                        </div>\n                        <div class="carauto-team-info">\n                            <div class="flex carauto-team-list-intro">\n                                <p style="text-indent:7px">暂无'+t+'，自己创建一个吧</p>\n                            </div>\n                            <p class="flex carauto-team-create">\n                                创建'+t+"\n                            </p>\n                        </div>\n                    </div>\n                </div>"}static setGameRoomEmptyTeam(t="暂无游戏桌"){return'<div class="swiper-slide autoroom-team-item" data-state="-1">\n                    <div class="autoroom-team-item-content">\n                        <div class="">\n                            <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="https://res.tuwan.com/templet/play/chat/images/defaulthead.png">\n                        </div>\n                        <div class="carauto-team-info">\n                            <div class="flex carauto-team-list-intro">\n                                <p style="text-indent:7px">'+t+"</p>\n                            </div>\n                            \n                        </div>\n                    </div>\n                </div>"}static setAutoTeamTabs(t,e){if(null==t)return;let n=[];t.forEach(((t,i)=>{const o=t.id;n.push('<div class="'+(o==e?"current":"")+'" data-id="'+o+'">'+t.value+"</div>")})),window.$(".autoroom-teams-tabs").html(n.join("")),ji.getInstance().checkShow()}static _setSongRoomTeamItem(e,n){const i=e.cid,o=e.live,s=e.state,a=e.vip;e.channel_name,e.number_name;const r=e.avatar,c=e.num,l=e.desc,d=e.room_desc,m=e.area,h=e.tag,u=e.fid,p=e.game_type_tmp,g=e.areaid,f=e.subTitle,w=e.areaNum,v=e.startTime,_=e.endTime,y=e.etime;e.typeid;let x="加入",b="";1==a&&(x="VIP",b="vip");const $=[];m&&$.push(m),h&&$.push(h);const k=`allHourShowTimeCtn_${uu.getCid()}_${u}`;return 17==o||18==o?(t.initIntervalTime(v,y||_,k),'\n                <div class="swiper-slide autoroom-team-item " data-live="'+o+'" data-tcid="'+i+'" data-vip="'+a+'" data-state="'+s+'" data-gametypetmp="'+p+'" data-fid="'+u+'" data-areaid="'+g+'">\n                    <div class="clicked autoroom-team-item-content">\n                        <div class="team-item-header">\n                            <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+r+'">\n                        </div>\n\n                    <div class="flex-1 song-team-item" style="margin-left:10px;height: 88px">\n                            <p style="position: relative;width: 203px;">'+l+` <span class="subTtitle" style="font-size: 12px; transform: scale(0.9); display: inline-block;margin-left: -7px;">${f?`(${f})`:""}</span></p>\n                            <p style="margin:3px 0;" class="flex flex-ac" > <span>`+m+`</span></p>\n                            <span style="border-radius: 6px;background: rgba(255, 85, 136, 0.5);width: 64px; height: 22px;font-size: 12px;\n                                    color: #fff;text-align: center;line-height: 22px;z-index: 1; position: absolute; right: 14px; bottom: 13px;">加入</span></p>\n                            <p style="margin-top: 20px; font-size: 12px; opacity: 0.7; display: none" class="${k}"><span class="timeTitle">剩余时间:</span> <span class="timeCtn">00:00</span></p>\n                            <div class="peopleNumCtn" style="position: absolute; right: 30px; bottom: 53px; color: white; font-size: 12px;align-items: center; display: ${w?"flex":"none"}">\n                                <span class="spBg" style="display: inline-block;margin-top: -3px;background: url(&quot;https://asset.tuwan.com/chartRoom/currentPeopleNums.png&quot;);background-size: cover;width: 9px;height: 12px;margin-right: 3px;margin-bottom: -2px; margin-bottom: -2px"></span>\n                                ${w}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `):'<div class="swiper-slide autoroom-team-item " data-live="'+o+'" data-tcid="'+i+'" data-vip="'+a+'" data-state="'+s+'" data-gametypetmp="'+p+'" data-fid="'+u+'" data-areaid="'+g+'">\n                <div class="clicked autoroom-team-item-content">\n                    <div class="team-item-header">\n                        <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+r+'">\n                        <div class="room_status '+b+'"></div>\n                    </div>\n\n                    <div class="flex-1 song-team-item" style="margin-left:10px;overflow: hidden">\n                                    <div style="overflow: hidden; height: 20px;"> <p>'+l+`</p></div>\n                                    <p style="margin:3px 0">${$.map((t=>`<span style="border:solid 1px #ff5588;border-radius:4px;padding:0 5px;margin-right: 5px;">${t}</span>`)).join("")}</p>\n                                    <p>`+d+'</p>\n                                    <p class="flex flex-jb" style="width:100%">\n                                    <span style="display: flex;justify-content: center;align-items: center;">\n                                        <img src="http://asset.tuwan.com/chatroom/images/icon_person.png"/>\n                                        <font class="font-num">'+c+'</font></span>\n                                    <span style="border-radius: 6px;\n                                        background: rgba(255, 85, 136, 0.5);\n                                        width: 64px;\n                                        height: 22px;\n                                        font-size: 12px;\n                                        color: #fff;\n                                        text-align: center;\n                                        line-height: 22px;\n                                        font-weight: 100;\n                                        z-index: 1;">'+x+"</span></p>\n                        </div>\n                </div>\n            </div>"}static setRightTeamList(t,e){}static _setAutoRoomTeamItem(e,n,i){var o,s,a,r;const c=e.fid,l=e.uid,d=e.areaid,m=e.area,h=e.avatar,u=e.desc,p=e.giftid,g=e.gifticon,f=e.giftnum,w=e.level,v=e.nickname,_=e.rec,y=e.num,x=e.tag,b=e.total,$=e.state,k=e.tcid,C=e.vip,I=e.vipicon,S=e.live,T=e.subTitle,R=e.areaNum,M=e.game_type_tmp,A=e.startTime,P=e.endTime,j=e.etime,D=e.cid,L=e.deskType,E=e.game_type,B=e.user_list;null==(o=e.roomLevelInfo)||o.imageurl,null==(s=e.roomLevelInfo)||s.is_team;const F=(null==(a=e.roomLevelInfo)?void 0:a.h5imageurl)||"",U=null==(r=e.roomLevelInfo)?void 0:r.roomLevel,z=e.entrance_open,O=e.mode,N=e.uids;let q="加入车队",G="",V="",H="",W="";const K=0==$&&N.includes(n);1==$?(q="已开车",G="joined"):K&&(q="已加入",G="joined");const Y=`allHourShowTimeCtn_${uu.getCid()}_${c}`;(uu.isShengyouFreeRoom()||uu.isPListType2()||uu.isBattleRoom())&&!K?(y!=b&&(q="加入",G=""),y==b&&(q=1!=$||uu.isPListType2()?"加入":"满房",G=""),1==C&&(q="VIP",G="vip"),30!=uu.roomInfo.typeid&&29!=uu.roomInfo.typeid||uu.isPListType2()||0!=E||"加入"!=q&&"满房"!=q||1!=$||z||(q="已开车",G="joined")):uu.isSameMusicRoom()&&1==C&&(q="VIP",G="vip"),(uu.isSameMusicRoom()||uu.isShengyouFreeRoom())&&(1!=$||1==C||uu.isSameMusicRoom()||2==S?1==C&&(V="vip",W="margintop6"):(V="songing",H="roomsonging",W="margintop6",30!=uu.roomInfo.typeid||uu.isPListType2()||uu.isCanChoiceCreateCar()||(V="gaming"),uu.isCanChoiceCreateCar()&&(0==E?(V="gaming",1==$&&"已开车"!=q&&(q="加入",G="")):1==E&&(V="songing",1==$&&(q="加入",G="")))));let J="",Q=" - <font> "+y+"</font>/"+b+"人";1==S?J="<div class='autoroom-content-live-status flex flex-jc flex-ac'>视频直播</div>":2==S?(J="<div class='autoroom-content-live-status flex flex-jc flex-ac'>游戏直播</div>",q="加入",G="",Q=""):9==S?J="<div class='autoroom-content-live-status flex flex-jc flex-ac'>Solo</div>":7==S&&(V="smallgameing"),2==E&&7!=S&&(V="drawing",q="加入",G="");let X="";p>0&&f>0&&(X='<div class="carauto-item-shang">赏</div>');let Z="";if(Z=F?`\n            <div style="border: 1px solid;border-image-width: 12px;border-image-source: url(${F});border-image-slice: 22;border-image-repeat: stretch;position: absolute;left: -1px;top: 3px;bottom: 4px;right: -1px; z-index:2"></div>\n            <div class="kingTeamOuterCtn">\n                <div class="clicked autoroom-team-item-content">\n                    <div class="kingTeamStarsGroupCtn" style="display:${U>0?"block":"none"};">\n                        <img class="subImg" src="https://asset.tuwan.com/squadron/images/icon_level${U}.png">\n                    </div>\n                    <div class="team-item-header `+W+'">\n                        <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+h+'">\n                        <div class="room_status '+V+'"></div>\n                        <div class="'+H+'"></div>\n                    </div>\n                    <div class="carauto-team-info">\n                        <div class="flex carauto-team-list-intro">\n                            <p class="flex flex-ac" style="text-indent:'+(""==X?"0":"7px")+'" title="'+u+'">'+(""==X?"":'【赏<img src="'+g+'" style="width:15px; height:15px;" />x'+f+"】")+u+'</p>\n                        </div>\n                        <p class="carauto-team-list-intro-2">★'+m+"★ - "+(uu.isShengyouFreeRoom()?x||"正太音":w)+Q+'</p>\n                        <p class="flex carauto-team-list-intro-3">\n                            <img src="'+I+'">\n                            <span>'+v+'</span>\n                        </p>\n                    </div>\n                    <div class="carauto-item-btn join '+G+'">'+q+"</div>\n                    "+X+'\n                    <div class="carauto-item-option-wrapper">\n                        <div class="autocarteam-li-close"></div>\n                        <div data-rec="'+_+'" class="autocarteam-li-top '+(1==_?" clicked":"")+'"></div>\n                        '+J+"\n                    </div>\n                </div>\n            </div>\n        ":'\n            <div class="clicked autoroom-team-item-content">\n                <div class="team-item-header '+W+'">\n                    <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+h+'">\n                    <div class="room_status '+V+'"></div>\n                    <div class="'+H+'"></div>\n                </div>\n                <div class="carauto-team-info">\n                    <div class="flex carauto-team-list-intro">\n                        <p class="flex flex-ac" style="text-indent:'+(""==X?"0":"7px")+'" title="'+u+'">'+(""==X?"":'【赏<img src="'+g+'" style="width:15px; height:15px;" />x'+f+"】")+u+'</p>\n                    </div>\n                    <p class="carauto-team-list-intro-2">★'+m+"★ - "+(uu.isShengyouFreeRoom()?x||"正太音":w)+Q+'</p>\n                    <p class="flex carauto-team-list-intro-3">\n                        <img src="'+I+'">\n                        <span>'+v+'</span>\n                    </p>\n                </div>\n                <div class="carauto-item-btn join '+G+'">'+q+"</div>\n                "+X+'\n                <div class="carauto-item-option-wrapper">\n                    <div class="autocarteam-li-close"></div>\n                    <div data-rec="'+_+'" class="autocarteam-li-top '+(1==_?" clicked":"")+'"></div>\n                    '+J+"\n                </div>\n            </div>\n        ",9==S){const t='<div class="flex flex-jc flex-ac flex-dir-col solo-captain-seat">\n                                     <div class="team-item-header">\n                                                     <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+B[0].avatar+'">\n                                                </div>\n                                                <div style="color: #FFFFFF;height: 20px;text-align: center">'+B[0].nickname+"</div>\n                                            </div>",e='<div class="flex flex-jc flex-ac flex-dir-col solo-captain-seat">\n                                                <div class="team-item-header">\n                                                     <img class="carauto-list-duizhang-header" onerror="this.src=\'https://res.tuwan.com/templet/play/chat/chatv2/images/addicon.png\'" src="'+(B.length>1?B[1].avatar:"https://res.tuwan.com/templet/play/chat/chatv2/images/addicon.png")+'">\n                                                </div>\n                                                <div style="color: #FFFFFF;height: 20px;text-align: center">'+(B.length>1?B[1].nickname:"虚位以待")+"</div>\n                                            </div>";Z='<div class="clicked autoroom-team-item-content solo-team-content  flex flex-dir-col" style="align-items: flex-start">\n                                     <div class="flex carauto-team-list-intro">\n                                          <p class="flex flex-ac" style="color: #FFFFFF" title="'+u+'">'+u+'</p>\n                                     </div>\n                                     <div style="width: 100%">\n                                            <div class="carauto-team-info flex flex-ac flex-jb" style="margin-top: 5px">\n                                            '+t+'\n                                            <div style="font-size: 16px">'+(B.length>1?"VS":"Solo")+"</div>\n                                            "+e+'\n                                         </div>\n                                    </div>\n\n                                    <div class="carauto-item-btn join '+G+'">'+q+'</div>\n                                    <div class="carauto-item-option-wrapper">\n                                       <div class="autocarteam-li-close"></div>\n                                       <div data-rec="'+_+'" class="autocarteam-li-top '+(1==_?" clicked":"")+'"></div>\n                                       '+J+"\n                                    </div>\n                         </div>"}return 17!=S&&18!=S&&"style1"!=L||(t.initIntervalTime(A,j||P,Y),Z='\n                <div class="swiper-slide autoroom-team-item " data-live="'+S+'" data-tcid="'+D+'" data-vip="'+C+'" data-state="'+$+'" data-gametypetmp="'+M+'" data-fid="'+c+'" data-areaid="'+d+'"\n                 style="height: 112px;  margin-top: -3px; width: auto;"\n                >\n                    <div class="clicked autoroom-team-item-content">\n                        <div class="team-item-header">\n                            <img class="carauto-list-duizhang-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+h+'">\n                        </div>\n\n                    <div class="flex-1 song-team-item" style="margin-left:10px;height: 88px">\n                            <p style="position: relative;width: 203px;">'+u+` <span class="subTtitle" style="font-size: 12px; transform: scale(0.9); display: inline-block;margin-left: -7px;">${T?`(${T})`:""}</span></p>\n                            <p style="margin:3px 0;" class="flex flex-ac" > <span>`+m+`</span></p>\n                            <span style="border-radius: 6px;background: rgba(255, 85, 136, 0.5);width: 64px; height: 22px;font-size: 12px;\n                                    color: #fff;text-align: center;line-height: 22px;z-index: 1; position: absolute; right: 14px; bottom: 13px;">加入</span></p>\n                            <p style="margin-top: 18px; font-size: 12px; opacity: 0.7; display: none" class="${Y}"><span class="timeTitle">剩余时间:</span> <span class="timeCtn">00:00</span></p>\n                            <div class="peopleNumCtn" style="position: absolute; right: 30px; bottom: 53px; color: white; font-size: 12px;align-items: center; display: ${R?"flex":"none"}">\n                                <span class="spBg" style="display: inline-block;margin-top: -3px;background: url(&quot;https://asset.tuwan.com/chartRoom/currentPeopleNums.png&quot;);background-size: cover;width: 9px;height: 12px;margin-right: 3px;margin-bottom: -2px; margin-bottom: -2px"></span>\n                                ${R}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `),'<div class="swiper-slide autoroom-team-item '+(F?" kingTeam":"")+"  "+(K?" clicked":"")+'"data-vip="'+C+'"data-cid="'+D+'"data-live='+S+' data-fid="'+c+'" data-tcid="'+k+'" data-areaid="'+d+'" data-uid="'+l+'" data-state="'+$+'" data-uids="'+N.join(",")+'" style="display:'+(0==i||i==d?"block":"none")+`">\n                    <img class="${O>0?"":"hide"}" alt='' src="https://asset.tuwan.com/chatroom/images/welcomeTeamIcon_x2.png" style="width: 50px; position: absolute;left: 20px;top: 10px;"/>\n                    `+Z+"\n                </div>"}static _getGameroomSeatsRightHtml(e){return t._getGameroomTuijianSeatsHtml(e)+t._getGameroomTeamsHtml()}static _getAutoroomSeatsRightHtml(e){return t._getAutoroomTuijianSeatsHtml(e)+t._getAutoroomTeamsHtml()}static _getGameroomTuijianSeatsHtml(e){e.cap_role;const n=e.fleet_name;let i=[];for(let o=0;o<5;o++)i.push(t._getOtherAnchorSeatHtml({position:o+1,defaultbg:"add",role:"",pwidth:100,pheight:112,width:76,height:76,iscar:!0,userinfo:null,defaultname:"加入游戏"}));return'<div style="height:134px" class="flex flex-ac kaihei-team-item" data-fid="0" data-archannel="" data-carkey="" data-cartoken="">\n                            <div class="new-team-name" style="color:#c2a4ff">'+n+'</div>\n                            <div class="flex">\n                                '+i.join("")+'\n                            </div>\n                            <div class="autoroom-tuijian-desc"></div>\n                    </div>'}static _getAutoroomTuijianSeatsHtml(e,n={pwidth:0,pheight:0,width:0,height:0}){const i=e.fleetnum,o=e.cap_role,s=e.fleet_name;let a=[];for(let r=0;r<i;r++)a.push(t._getOtherAnchorSeatHtml({position:r+1,defaultbg:"add",role:0==r?o:"",pwidth:n.pwidth||100,pheight:n.pheight||112,width:n.width||76,height:n.height||76,iscar:!0,userinfo:null,defaultname:"点击上车"}));return'<div style="height:134px" class="flex flex-ac kaihei-team-item" data-fid="0" data-archannel="" data-carkey="" data-cartoken="">\n                            <div class="welcomeTeamTipCtn" style="display: none">迎新</div>\n                            <div class="new-team-name" style="color:#c2a4ff">'+s+'</div>\n                            <div class="flex new-team-content">\n                                '+a.join("")+'\n                            </div>\n                            <div class="autoroom-tuijian-desc"></div>\n                    </div>'}static _getAutoroomSoloSeatsHtml(e){e.fleetnum;const n=e.cap_role,i=e.fleet_name;let o=[];for(let s=0;s<2;s++)o.push(t._getOtherAnchorSeatHtml({position:s+1,defaultbg:"add",role:0==s?n:"",pwidth:100,pheight:112,width:76,height:76,iscar:!0,userinfo:null,defaultname:"点击上车"}));return'<div style="height:134px" class="flex flex-ac kaihei-team-item" data-fid="0" data-archannel="" data-carkey="" data-cartoken="">\n                            <div class="new-team-name" style="color:#c2a4ff">'+i+'</div>\n                            <div class="flex" style="margin-left: 30px">\n                                '+o[0]+'<div class="new-team-solo-vs flex flex-jc flex-ac">VS</div>'+o[1]+'\n                            </div>\n                            <div class="autoroom-tuijian-desc"></div>\n                            <div class="flex flex-jb new-team-solo-container">\n                                <div class="new-team-solo-alert">solo车队</div>\n                                <div class="solo-car-tips" style="position: absolute;right: 10px;top: 10px;">Solo车队说明</div>\n                            </div>\n                    </div>'}static _getGameroomTeamsHtml(){return'<div class="flex flex-dir-col flex-1 autoroom-teams">\n                            <div class="flex flex-jb">\n                                \x3c!-- Tab部分 --\x3e\n                                <div class="flex flex-1 autoroom-teams-tabs">\n                                </div>\n                                \x3c!-- 分页部分 --\x3e\n                                <div class="flex flex-ac autoroom-teams-pages">\n                                    <div class="carauto-button carauto-button-prev"></div>\n                                    <div class="flex-1 carauto-pagination-caraudo">\n\n                                    </div>\n                                    <div class="carauto-button carauto-button-next"></div>\n                                </div>\n                            </div>\n                            <div class="flex flex-1 autoroom-swiper-container autoroom-allteams">\n                                <div class="swiper-wrapper autoroom-teamlist">\n                                </div>\n                            </div>\n                    </div>'}static _getAutoroomTeamsHtml(){return'<div class="flex flex-dir-col flex-1 autoroom-teams">\n                            <div class="flex flex-jb" style="position: relative">\n                                \x3c!-- Tab部分 --\x3e\n                                <div class="flex flex-1 autoroom-teams-tabs-wrapper">\n                                    <div class="flex autoroom-teams-action"> </div>\n                                     <div class="flex  autoroom-teams-tabs"></div>\n                                </div>\n                                \x3c!-- 分页部分 --\x3e\n                                <div class="flex flex-ac autoroom-teams-pages">\n                                    <div class="carauto-button carauto-button-prev"></div>\n                                    <div class="flex-1 carauto-pagination-caraudo">\n\n                                    </div>\n                                    <div class="carauto-button carauto-button-next"></div>\n                                </div>\n                            </div>\n                            <div class="flex flex-1 autoroom-swiper-container autoroom-allteams">\n                                <div class="swiper-wrapper autoroom-teamlist"></div>\n                            </div>\n                            <div class="flex flex-dir-col flex-1 temp-talk hide"></div>\n                    </div>'}static _getTeamsHtml(){return'<div class="flex flex-dir-col flex-1 autoroom-teams">\n                            <div class="flex flex-jb" style="position: relative">\n                                \x3c!-- Tab部分 --\x3e\n                                <div class="flex flex-1 autoroom-teams-tabs-wrapper">\n                                    <div class="flex  autoroom-teams-tabs"></div>\n                                </div>\n                                \x3c!-- 分页部分 --\x3e\n                                <div class="flex flex-ac autoroom-teams-pages">\n                                    <div class="solo-car-tips hide">Solo车队说明</div>\n                                    <div class="carauto-button carauto-button-prev"></div>\n                                    <div class="flex-1 carauto-pagination-caraudo">\n                                    </div>\n                                    <div class="carauto-button carauto-button-next"></div>\n                                </div>\n                            </div>\n                            <div class="flex flex-1 autoroom-swiper-container autoroom-allteams">\n                                <div class="swiper-wrapper autoroom-teamlist"></div>\n                            </div>\n                    </div>'}static _getAnchorHtmlForCar(){let e=t._getOtherAnchorSeatHtml({position:2,defaultbg:"add",role:"主持",pwidth:271,pheight:150,width:120,height:120,isrightline:!1,zindex:200}),n=[];for(let i=0;i<3;i++)n.push(t._getOtherAnchorSeatHtml({position:i+3,defaultbg:"add",role:"嘉宾",pwidth:82,pheight:102,width:64,height:64,isrightline:!1,index:i+1}));return'<div class="flex flex-dir-col flex-jc flex-ac" style=\'position:relative;\'>\n                    <div style="z-index:840">\n                        '+e+'\n                    </div>\n                    <div class="flex" style="margin-top:10px">\n                        '+n.join("")+"\n                    </div>\n                </div>"}static _setGameTeamSeatKeng(t,e,n){const i=e.position,o=t.find(".seat-item-empty[data-tposition='"+i+"']");if(o.addClass("seats-game-caritem"),o.addClass("seats-game-killer"),o.length>0){const t=e.nickname,s=e.avatar,a=e.color,r=e.heads,c=e.uid,l=e.fid,d=o.get(0);d.dataset.nickname=t,d.dataset.color=a,d.dataset.uid=c,d.dataset.fid=l,d.dataset.type=1;const m=o.find(".seat-head-img"),h=o.find(".seat-user-name"),u=o.find(".seat-close"),p=o.find(".seat-svga");m.attr("src",s),h.text(t).addClass("haveuser"),c==n&&u.show(),p.html(""),r&&window.$(`.seat-item[data-uid='${c}']`).find(".seat-svga").each((function(){Zt.getInstance().playLoop({ele:this,path:r},"svga_header_team_"+i)}))}}static _setTeamSeatKeng(t,e,n){const i=e.position,o=t.find(".seat-item-empty[data-tposition='"+i+"']");if(o.length>0){const t=e.nickname,s=e.avatar,a=e.color,r=e.heads,c=e.uid,l=o.get(0);l.dataset.nickname=t,l.dataset.color=a,l.dataset.uid=c;const d=o.find(".seat-head-img"),m=o.find(".seat-user-name"),h=o.find(".seat-close"),u=o.find(".seat-svga");d.attr("src",s),m.text(t).addClass("haveuser"),c==n&&h.show(),u.html(""),r&&window.$(`.seat-item[data-uid='${c}']`).find(".seat-svga").each((function(){Zt.getInstance().playLoop({ele:this,path:r},"svga_header_team_"+i)}))}}static _clearGameTeamSeatKeng(t,e){const n=t.find(".seat-item-empty[data-tposition='"+e+"']");if(n.length>0){Ei.getInstance().removeWaveSvgaByDom(n),n.removeClass("speaking");const t=n.get(0);t.dataset.nickname="",t.dataset.color="#666",t.dataset.uid=0;const i=n.find(".seat-head-img"),o=n.find(".seat-user-name"),s=n.find(".seat-close"),a=n.find(".seat-svga");i.attr("src","https://res.tuwan.com/templet/play/chat/v2/images/empty.png"),o.text("加入游戏").removeClass("haveuser"),s.hide(),Zt.getInstance().clearPlayer("svga_header_team_"+e),a.html("")}}static _clearTeamSeatKeng(t,e){const n=t.find(".seat-item-empty[data-tposition='"+e+"']");if(n.length>0){Ei.getInstance().removeWaveSvgaByDom(n),n.removeClass("speaking");const t=n.get(0);t.dataset.nickname="",t.dataset.color="#666",t.dataset.uid=0;const i=n.find(".seat-head"),o=n.find(".seat-head-img"),s=n.find(".seat-user-name"),a=n.find(".seat-close"),r=n.find(".seat-svga");n.find(".newuser-show-svga").empty(),n.removeClass("newUser"),i.attr("data-speak",0),o.attr("src","https://res.tuwan.com/templet/play/chat/v2/images/empty.png"),s.text("点击上车").removeClass("haveuser"),a.hide(),Zt.getInstance().clearPlayer("svga_header_team_"+e),r.html("")}}static _kaihei3Item(e,n,i,o,s,a){const r=i.channel,c=i.data,l=i.dynamicKey,d=i.fid,m=i.title,h=i.token,u=Array(e).fill(null);for(let t=0;t<c.length;t++){const e=c[t],n=e.position,i=e.uid;u[n-1]=e,i==o&&uu.setMycarData(d,c)}let p=[];const g=u.length;for(let f=0;f<u.length;f++)p.push(t._getOtherAnchorSeatHtml({position:f+1,defaultbg:f==g-1?"car":"add",role:0==f?n:"",pwidth:0==f?120:106,pheight:0==f?124:110,width:0==f?92:76,height:0==f?92:76,iscar:!0,userinfo:u[f],defaultname:"点击上车"}));return'<div class="flex flex-1 flex-ac kaihei-team-item" data-fid="'+d+'" data-carchannel="'+r+'" data-carkey="'+l+'" data-cartoken="'+h+'">\n                    <div class="new-team-name" style="color:'+s+'">'+m+'</div>\n                    <div class="flex" style="align-items:center">\n                        '+p.join("")+'\n                    </div>\n                    <div class="flex-1 new-xuanyan" style="color:'+s+'">\n                        <div>队长宣言：</div>\n                        <div class="new-xuanyan-edit new-xuanyan-edit-'+a+'"><span>点击这里可以填写队长宣言哦~</span><em class="editicon-'+a+'"></em></div>\n                    </div>\n                </div>'}static getEleForFid(t){return window.$(".new-kaihei-teams").find(".kaihei-team-item[data-fid='"+t+"']")}static showXuanyanText(e,n){const i=t.getEleForFid(e);i.find(".new-xuanyan-edit span").text(n),i.find(".new-xuanyan-edit em").css("display","inline-block"),i.find(".new-xuanyan").show()}static showXuanyanText_all(e,n){const i=t.getEleForFid(e);i.find(".new-xuanyan-edit span").text(n),i.find(".new-xuanyan").show()}static hideXuanyanText(e){const n=t.getEleForFid(e);n.find(".new-xuanyan").hide(),n.find(".new-xuanyan-edit em").hide()}static _getMainAnchorSeatHtml(e,n,i,o,s=!0){return t._initSeatData(2,e,n,i,i,o,s)}static _getOtherAnchorSeatHtml(e){return t._getHeadItem(e)}static setAnchorsSeat(e,n,i){let o=2;const s=uu.isJingPaiRoom();uu.isKtvRoom()||uu.isJiamianRoom()||uu.isTakeMeRoom()?o=1:s&&(o=0);let a=Array(e).fill(null),r=uu.isShengyouRoom(),c=uu.isHunLiRoom();c&&(o=0);for(let t=0;t<i.length;t++){const e=i[t];a[e.position-o]=e}for(let l=0;l<a.length;l++){const e=a[l];e?t.setAnchorSeat(e,n,r,c,s):t.clearAnchorSeat(l+o,r,c,s)}}static setAnchorSeat(t,e,n=!1,i=!1,o=!1,s="",a=""){const r=t.position;let c=window.$(".chat-center-main").find(".seat-item-empty[data-aposition="+r+"]");if(""!=s&&(c=window.$(".chat-center-main .peaceListItem[data-index= "+s+"]").find(".seat-item-empty[data-aposition="+r+"]")),c.length>0){const s=t.nickname,l=t.avatar,d=t.color,m=t.heads,h=t.uid,u=t.isnew;t.online,t.owner;const p=t.sex,g=c.get(0);g.dataset.nickname=s,g.dataset.color=d,g.dataset.uid=h;const f=c.find(".seat-head-img");c.find(".seat-head"),1!=u||1!=uu.roomInfo.fleet_type||uu.getMeid()!=h&&!uu.isAnchoringUser(uu.getMeid())||5!=uu.roomInfo.typeid||24!=uu.roomInfo.ptype&&27!=uu.roomInfo.ptype&&30!=uu.roomInfo.ptype&&31!=uu.roomInfo.ptype||(c.addClass("newUser"),h==e&&Li.getInstance().show(c));const w=c.find(".seat-user-name"),v=c.find(".seat-close"),_=c.find(".seat-role-tag"),y=c.find(".song-head-option");if(n||o||uu.isTruthRoom()){const e=t.charm;r>2&&c.find(".seat-meili-num").text(e).removeClass("hide")}else i&&r>2&&_.text(1==p?"伴郎":"伴娘").show();if(uu.isTakeMeRoom()){const e=t.charm;r>2&&c.find(".seat-meili-num").text(e).removeClass("hide")}if(uu.isSongTempRoom()&&(1==t.owner?(1==t.live_rec&&(window.$(".song-head-option").removeClass("downstairs"),y.addClass("downstairs")),_.text("房主").show()):1==t.live_rec?(window.$(".song-head-option").removeClass("downstairs"),y.addClass("downstairs"),_.text("演唱").show()):(y.removeClass("downstairs"),_.text("嘉宾").show())),o&&1==r?w.text(s).addClass("haveuser").css("font-size","18px"):w.text(s).addClass("haveuser"),uu.isSpecialTakeMeRoom()&&h==uu.getMeid()&&h!=uu.getBossUid()&&1==t.face&&w.text(s+":"+uu.getSelfInfo().nickname),f.attr("src",l),h==e&&v.show(),(uu.isLiveRoom()||uu.isLiveTempRoom())&&Mi.getInstance().bindViewAttr(t),2==r&&uu.getRoomInfo().hat)return;if((0==r||1==r)&&uu.isMarryRoom()){let t=window.$(`#position_${r}`)[0].dataset.svga;return void Zt.getInstance().playEver(`#position_${r}`,t,"svga_marry")}const x="svga_header_main_"+r,b=Zt.getInstance();b.clearPlayer(x),m&&window.$(`.seat-item[data-uid='${h}']`).find(".seat-svga").each((function(){t.head_play&&2==t.head_play?b.loadParser(`.seat-item[data-uid='${h}'] #position_${r}.seat-svga`,m,1,!1).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation(),b.playersMap.set(x,n)}),(t=>{})):t.head_play&&3==t.head_play?b.loadParser(`.seat-item[data-uid='${h}'] #position_${r}.seat-svga`,m,1,!1,"Forward",!1).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.stepToPercentage(1,!1),b.playersMap.set(x,n)}),(t=>{})):b.playLoop({ele:this,path:m},x)})),uu.isMusicTempRoom()&&!uu.isSongTempRoom()&&(uu.isSonger(h)?_.text("歌手"):_.text(uu.roomInfo.cap_role)),a&&_.text(a),2!=uu.roomInfo.team_stage&&3!=uu.roomInfo.team_stage||$(v[0]).addClass("hide")}}static clearAnchorSeat(t,e=!1,n=!1,i=!1){const o=window.$(".chat-center-main").find(".seat-item-empty[data-aposition="+t+"]");if(o.length>0){Ei.getInstance().removeWaveSvgaByDom(o),o.removeClass("speaking");const s=o.get(0),a=s.dataset.uid;s.dataset.nickname="",s.dataset.color="#666",s.dataset.uid=0;const r=o.find(".seat-head-img"),c=o.find(".seat-user-head");o.find(".seat-head");const l=o.find(".seat-user-name"),d=o.find(".seat-svga"),m=o.find(".seat-pendant-svga"),h=o.find(".seat-face-svga"),u=o.find(".takeme-item-button"),p=o.find(".song-head-option"),g=o.find(".truth-game-ball");u.addClass("hide"),p.addClass("hide"),o.removeClass("newUser");const f=o.find(".seat-close");e?o.find(".seat-meili-num").text(0):(n&&t>2||uu.isNewDrawTempRoom())&&o.find(".seat-role-tag").hide(),uu.isSongTempRoom()&&o.find(".seat-role-tag").text("嘉宾"),c.removeClass("closeLight"),r.attr("src","https://res.tuwan.com/templet/play/chat/v2/images/empty.png");let w="虚位以待";if(i&&(w="",o.find(".seat-meili-num").text(0).addClass("hide")),(uu.isTakeMeRoom()||uu.isTruthRoom())&&o.find(".seat-meili-num").text(0),o.find(".seat-user-alert").html(""),o.find(".seat-status").addClass("hide"),o.find(".seat-user-score-container").addClass("hide"),g.empty(),m.empty(),h.empty(),Pi.getInstance().clearSvgaWithUid(a),l.text(w).removeClass("haveuser"),f.hide(),2==t&&uu.isLiveRoom()&&Mi.getInstance().hideManagementBar(),2==t&&uu.getRoomInfo().hat)return;n&&t<2||(Zt.getInstance().clearPlayer("svga_header_main_"+t),d.html(""))}}static _initSeatData(e,n,i,o,s,a="",r=!1,c=!1,l="mic",d=0,m=!1,h=null,u="",p="",g=1){const f={position:e,defaultbg:l,userinfo:h,iscar:c,ishouhu:p,shouhutype:g,headsvga:u,role:a,index:d,pwidth:n,pheight:i,width:o,height:s,isrightline:r,isshowmeili:m,defaultname:"虚位以待"};return t._getHeadItem(f)}static _getHeadItem(t){const e="empty"==t.defaultname?"":"虚位以待",n=t.userinfo,i=n?n.avatar:"https://res.tuwan.com/templet/play/chat/v2/images/empty.png",o=n?n.color:"#666",s=n?n.uid:0,a=i,r=n?n.nickname:e,c=o,l=s,d=t.position,m=t.defaultbg||"mic",h=t.iscar||!1,u=t.isshouhu||!1,p=t.shouhutype||1,g=t.headsvga||"",f=t.index||0,w=t.role||"",v=t.pwidth,_=t.pheight,y=t.width,x=t.height,b=t.isrightline,$=t.isshowmeili,k=t.zindex||0,C=t.isboss||!1,I=t.isglodborder||!1,S=t.svgaWidth||"130%",T=t.svgaHeight||"130%",R=t.hatwidth||0,M=t.hatheight||0,A=t.hatpath||"",P=t.hattop||"",j=t.hatleft||"",D=t.hatorder||0,L=t.meilitype||1,E=t.hattext||"",B=t.xutype||1,F=t.closeHide||!1,U=t.forbidFloat||!1;let z="";if(u){z='<div class="seat-shouhu-tag '+(1==p?"jin":2==p?"yin":"tong")+'">'+(1==p?"黄金守护":2==p?"白银守护":"青铜守护")+"</div>"}let O="";$&&(1==L?O='<div class="seat-meili-num">0</div>':2==L&&(O='<div class="seat-meili-num meilitype-2 hide">0</div>'));let N="",q="";C&&(N='<div class="boss-back-light"></div>',q='<img src="https://res.tuwan.com/templet/play/chat/v3/images/bosstag.png" style="width:46px;height:35px; position:absolute;z-index:4;bottom:-6px; left:50%;margin-left:-23px;" />');let G="";1==B?G='<div class="seat-number" style="display:'+(0==f?"none":"block")+'">'+f+"</div>":2==B&&(G='<div class="seat-number-2" style="display:'+(0==f?"none":"block")+'">'+f+"</div>");const V='<div id="position_'+d+'" style="width:'+S+";height:"+T+'" class="seat-svga" data-svga="'+g+'" svgapath="'+g+'"></div>',H='<div id="position_takeme_'+d+'" style="width:'+S+";height:"+T+'" class="takeme-show-svga" ></div>',W='<div class="flex flex-ac flex-jc seat-hat" id="position_'+d+'" style="width:'+R+"px;height:"+M+"px;background:url("+A+") no-repeat; top:"+P+"px;left:"+j+"px; z-index:"+k+'">\n                            '+E+"\n                        </div>";let K="";uu.isSongTempRoom()&&(K='<div class="song-head-option hide"></div>');let Y='<div class="seat-close"></div>';F&&(Y="");return'<div class="seat-item-empty seat-item '+(U?"forbidFloat":"")+(b?"rightline":"")+'" style="width:'+v+"px;height:"+("auto"==_?"auto":`${_}px`)+";order:"+D+'" data-uid="'+l+'" data-color="'+c+'" data-'+(h?"tposition":"aposition")+'="'+d+'" data-nickname="" data-level="'+p+'">\n                    <div class="seat-user-alert"></div>\n                    <div class="seat-head" style="width:'+y+"px; height:"+x+'px">\n                        \x3c!-- 背光 --\x3e\n                        '+N+'\n                        \x3c!-- 声纹 --\x3e\n                        <div class="seat-wave"></div>\n                        <div class="seat-wave-svga"></div>\n                        '+V+"\n                        "+H+"\n                        "+W+'\n                        <div class="newuser-show-svga" ></div>\n                        <div class="seat-face-svga"></div>\n                        <div class="seat-pendant-svga"></div>\n                        <div class="truth-game-ball" ></div>\n                        \x3c!-- 头像 --\x3e\n                        <div class="seat-user-head '+m+(I?" glod":"")+'">\n                               <img class="seat-head-img" src="'+a+'" onerror="this.src=\'https://asset.tuwan.com/chatroom/images/default_avator.jpg\'"/>\n                               <div class="seat-status flex flex-jc flex-ac hide"><div></div></div>\n                        </div>\n                        '+K+"\n                        \x3c!-- 老板牌子 --\x3e\n                        "+q+'\n                        \x3c!-- 角色 --\x3e\n                        <span class="seat-role-tag" style="display:'+(""==w?"none":"block")+'">'+w+"</span>\n                        \x3c!-- 序号 --\x3e\n                        "+G+"\n                        \x3c!-- 声优厅魅力值 --\x3e\n                        "+O+"\n                        \x3c!-- 关闭 --\x3e\n                        "+Y+'\n                        \x3c!-- 全麦表情 --\x3e\n                        \n            <div class="all_faces flex flex-jc flex-ac hide">\n            </div>\n        \n                    </div>\n                    <p class="seat-user-name'+(r!=e?" haveuser":"")+'">'+r+"</p>\n                    "+z+'\n                    <div class="seat-user-score-container flex flex-ac hide"><div class="seat-user-score">0</div></div>\n                    <div class="cpContainer" style=\'offset-path: path("M0,0 q0 0 0,0")\'>\n                        <img class="cpImg" src="https://asset.tuwan.com/cphead/room_cp_heart_icon_1226.png" />\n                    </div>\n                </div>'}static _getJiamianHeadItem(t){const e=t.defaultname||"虚位以待",n=t.userinfo,i=n?n.avatar:"https://res.tuwan.com/templet/play/chat/v2/images/empty.png",o=n?n.color:"#666",s=n?n.uid:0,a=i,r=n?n.nickname:e,c=o,l=s,d=t.position||2,m=t.defaultbg||"mic",h=t.iscar||!1,u=t.isshouhu||!1,p=t.shouhutype||1,g=t.headsvga||"",f=t.index||0,w=t.role||"",v=t.pwidth,_=t.pheight,y=t.width,x=t.height,b=t.isrightline;let $="";if(u){$='<div class="seat-shouhu-tag '+(1==p?"jin":2==p?"yin":"tong")+'">'+(1==p?"黄金守护":2==p?"白银守护":"青铜守护")+"</div>"}let k="";t.isshowmeili&&(k='<div class="seat-meili-num">0</div>');let C="";return(t.isboss||!1)&&(C='<img src="https://res.tuwan.com/templet/play/chat/v3/images/bosstag.png" style="width:46px;height:35px; position:absolute;z-index:4;bottom:-6px; left:50%;margin-left:-23px;" />'),'<div class="seat-item-empty seat-item '+(b?"rightline":"")+'" style="width:'+v+"px;height:"+_+'px;" data-uid="'+l+'" data-color="'+c+'" data-'+(h?"tposition":"aposition")+'="'+d+'" data-nickname="" data-level="'+p+'">\n                    <div class="seat-head" style="width:'+y+"px; height:"+x+'px">\n                        <div class="boss-svga-background" id="bossSvgaBackground"></div>\n                        <div style="width:116px; height:116px; position:absolute;top:50%; left:50%; margin-left:-58px; margin-top:-58px;">\n                            \x3c!-- 声纹 --\x3e\n                            <div class="seat-wave"></div>\n                            <div class="seat-svga" data-svga="'+g+'" svgapath="'+g+'"></div>\n                            <div class="seat-face-svga"></div>\n                            \x3c!-- 头像 --\x3e\n                            <div class="seat-user-head '+m+(t.isglodborder||!1?" glod":"")+'">\n                               <img class="seat-head-img" src="'+a+'" onerror="this.src=\'https://asset.tuwan.com/chatroom/images/default_avator.jpg\'"/>\n                            </div>\n                            \x3c!-- 老板牌子 --\x3e\n                            '+C+'\n                            \x3c!-- 角色 --\x3e\n                            <span class="seat-role-tag" style="display:'+(""==w?"none":"block")+'">'+w+'</span>\n                            \x3c!-- 序号 --\x3e\n                            <div class="seat-number" style="display:'+(0==f?"none":"block")+'">'+f+"</div>\n                            \x3c!-- 声优厅魅力值 --\x3e\n                            "+k+'\n                            \x3c!-- 关闭 --\x3e\n                            <div class="seat-close"></div>\n                        </div>\n\n                    </div>\n                    <p class="seat-user-name'+(r!=e?" haveuser":"")+'" style="font-size:18px; margin-top:-20px">'+r+"</p>\n                    "+$+"\n                </div>"}static _getSeatData(t){const e=t.position,n=t.defaultbg||"mic",i=t.userinfo,o=t.iscar||!1,s=t.ishouhu||!1,a=t.shouhutype||0,r=t.headsvga||"",c=t.index||0,l=t.role||"",d=i?i.avatar:"https://res.tuwan.com/templet/play/chat/v2/images/empty.png",m=i?i.color:"#666",h=i?i.uid:0;return{avatar:d,nickname:i?i.nickname:"虚位以待",color:m,uid:h,position:e||2,defaultbg:n,iscar:o,isshouhu:s,shouhutype:a,headsvga:r,role:l,index:c}}static _getVideoSeatItem(t){const e=t.defaultname||"虚位以待",n=t.userinfo;!n||n.avatar;const i=n?n.color:"#666",o=n?n.uid:0,s=n?n.nickname:e,a=i,r=o,c=t.position||2;t.defaultbg;const l=t.headsvga||"",d=t.index||0,m=t.role||"",h=t.pwidth,u=t.pheight,p=t.width,g=t.height,f=t.isrightline;let w="";return t.isshowmeili&&(w='<div class="seat-meili-num">0</div>'),'<div class="seat-item-empty seat-item '+(f?"rightline":"")+'" style="width:'+h+"px;height:"+u+'px;" data-uid="'+r+'" data-color="'+a+'" data-aposition="'+c+'" data-nickname="">\n                    <div class="seat-head video-'+(2==c?"mainanchor":"jiabin")+'" style="width:'+p+"px; height:"+g+'px;">\n\n                        \x3c!-- 声纹 --\x3e\n                        <div class="seat-wave"></div>\n                        <div class="seat-svga" data-svga="'+l+'" svgapath="'+l+'"></div>\n                        \x3c!-- 头像 --\x3e\n                        <div class="seat-user-head" id="seatvideo_'+c+'">\n\n                        </div>\n                        \x3c!-- 角色 --\x3e\n                        <span class="seat-role-tag" style="display:'+(""==m?"none":"block")+'">'+m+'</span>\n                        \x3c!-- 序号 --\x3e\n                        <div class="seat-number" style="display:'+(0==d?"none":"block")+'">'+d+"</div>\n                        \x3c!-- 声优厅魅力值 --\x3e\n                        "+w+'\n                        \x3c!-- 关闭 --\x3e\n                        <div class="seat-close"></div>\n                    </div>\n                    <p class="seat-user-name'+(s!=e?" haveuser":"")+'" style="font-size:18px; margin-top:6px">'+s+"</p>\n\n                </div>"}static updateAnchorSpecialSeat(e=[],n=2){for(var i=0;i<n;i++){const n=e.find((t=>t.position==i));n?t.setAnchorSeat(n,uu.getMeid(),!1,!1,!1):t.clearAnchorSeat(i,!1,!1,!1)}}},"showPeaceTeamPositionFn",(e=>{let n=e.list;for(let i=0;i<n.length;i++){let e=n[i].data;for(let n=0;n<e.length;n++){let o=e[n];t.setAnchorSeat(o,uu.getMeid(),!1,!1,!1,i,0==n?"领队":"队员")}}})),t);class Ui{constructor(t){this.param=t,this.parentEleId="",this.flyToPosition=null,this.currentIndex=0,this.clearTimeoutNumber=null,this.init(this.currentIndex)}init(t){const e=this.param.teachersPosition,n=this.param.avatars;t>=e.length||(this.flyToPosition=e[t],this.createElement(n[t]))}async createElement(t){const e="giftquanquan"+Math.ceil(1e7*Math.random());this.parentEleId=e;const n=window.$('<div class="giftquanquan" id="'+e+'"></div>');let i=[];for(let s=0;s<10;s++)i.push('<div class="quanquan-item" data-index="'+s+'"></div>');n.append(i.join(""));const o=window.$('<img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\';" class="quanquan-img" src="'+t+'">');n.append(o),window.$("body").append(n),this.playHeader(o.get(0)),this.clearTimeoutNumber=setTimeout((()=>{n.remove()}),1e4)}playHeader(t){window.snabbt(t,{fromScale:[1,1],scale:[20,20],easing:"ease",duration:200,complete:()=>{this.giftStartAnimate10()}})}giftStartAnimate10(){const t=document.querySelector("#"+this.parentEleId).querySelectorAll(".quanquan-item");let e=[];for(let n=0;n<t.length;n++)e.push(this.playSvga(t[n]));Promise.all(e).then(((e,n)=>{this.giftAnimateFenshan(t)}))}giftAnimateFenshan(t){let e=new Map;window.snabbt(t,{position:(t,n)=>{const i=this.getPoint(200,0,0,t);return e.set(t,i),[i.x,-i.y,0]},duration:300,allDone:()=>{const n=this.param.isSeat;let i=[];for(let o=0;o<t.length;o++)n?i.push(this.zhuanQuanQuan(t[o],o,e)):i.push(this.noSeatZhuan(t[o],o,e));Promise.all(i).then((t=>{if(document.querySelector("#"+this.parentEleId).remove(),clearTimeout(this.clearTimeoutNumber),this.clearTimeoutNumber=null,n){if(this.currentIndex==this.param.avatars.length-1)return;this.init(++this.currentIndex)}})).catch((t=>{}))}})}async zhuanQuanQuan(t,e,n){return new Promise(((i,o)=>{const s=n.get(e),a=1e3+100*e;window.snabbt(t,{rotation:[0,0,2*Math.PI+e*Math.PI/5],transformOrigin:[-s.x,s.y,0],duration:a,delay:1e3,complete:()=>{this.flyToHeader(t,e).then((()=>{i()}))},allDone:function(){}})}))}async noSeatZhuan(t,e,n){return new Promise(((i,o)=>{const s=n.get(e);window.snabbt(t,{rotation:[0,0,2*Math.PI],transformOrigin:[-s.x,s.y,0],duration:1e3,delay:1e3,complete:()=>{this.noFlyHeader().then((()=>{i()}))},allDone:function(){}})}))}async noFlyHeader(){return new Promise(((t,e)=>{const n=document.querySelector("#"+this.parentEleId),i=n.querySelectorAll(".quanquan-item"),o=n.querySelector(".quanquan-img");window.snabbt(i,{position:[0,0,0],duration:300,scale:[0,0],delay:1e3,complete:()=>{t()}}),window.snabbt(o,{position:[0,0,0],duration:300,delay:1e3,scale:[0,0]})}))}async flyToHeader(t){return new Promise(((e,n)=>{window.snabbt(t,{fromPosition:[0,-200,0],position:[this.flyToPosition.x,this.flyToPosition.y,0],fromScale:[1,1],scale:[.2,.2],easing:"ease"}).snabbt({scale:[0,0],delay:300,duration:300,complete:()=>{e()}});const i=document.querySelector("#"+this.parentEleId).querySelector(".quanquan-img");window.snabbt(i,{position:[0,0,0],duration:300,scale:[0,0],complete:()=>{}})}))}async playSvga(t){return new Promise(((e,n)=>{Zt.getInstance().loadParser(t,this.param.svgaPath,0,!0).then((t=>{const{videoItem:n,player:i}=t;i.setVideoItem(n),i.startAnimation(),i.onFinished((function(){})),e()}),(t=>{}))}))}getPoint(t,e,n,i){const o=Math.PI/180*Math.round(36);return{x:e+t*Math.sin(o*i),y:n+t*Math.cos(o*i)}}}const zi=1,Oi=2,Ni=[2,1,3],qi="选被惩罚者";class Gi{constructor(){this.initStyled=!1,this.emitter=new Ht,this.init()}static getInstance(){return this.instance||(this.instance=new Gi),this.instance}init(){this.showed=!1,this.stageData=null,this.seatsData=null,this.countdownTimer=null,this.state_2_1_isInited=!1}onReset(){this.clearCountdownTimer(),this.clearFlyTimer(),window.$(".truth-room-content").remove(),this.init()}initTemplate(t){this.initStyled||(this.initStyle(),this.initStyled=!0),this.showed||(this.initHtml(t),this.initEvents(),this.showed=!0),uu.isTruthSmallRoom()&&uu.isRoomManage(uu.getMeid())&&window.$(".truth-room-content .song-but-setting").removeClass("hide")}async sendGift(t,e,n,i=1,o){const s=(await qt.get(Pt+`/Teacher/getGift?id=${t}`)).data;this.emitter.emit("sendGift",s,e,n,i,(t=>{}),o)}clearCountdownTimer(){this.countdownTimer&&(window.clearInterval(this.countdownTimer),this.countdownTimer=null)}clearFlyTimer(){this.flyTimer&&(window.clearInterval(this.flyTimer),this.flyTimer=null)}updateStatus(t){if(t instanceof Array)this.seatsData=t,this.clearCountdownTimer();else{const e="2_1";(`${t.stage}_${t.sub_stage}`!=e||this.stageData&&`${this.stageData.stage}_${this.stageData.sub_stage}`!=e)&&this.clearCountdownTimer(),this.stageData&&this.stageData.stage==t.stage&&this.stageData.sub_stage==t.sub_stage&&(t.countdown=this.stageData.countdown),this.stageData=t}if(this.stageData)switch(this.updateStage(this.stageData),this.stageData.stage){case 0:this.setPrepareStageHtml(this.stageData),this.updateUserPrepareStatus(),this.setPunishStatus(!1),this.state_2_1_isInited=!1;break;case 1:switch(this.stageData.sub_stage){case zi:case Oi:switch(this.removeUserPrepareStatus(),this.stageData.game_id){case 1:this.setRobRedPkgGameHtml(this.stageData);break;case 2:this.setCompareNumberGameHtml(this.stageData);break;case 3:this.setNumberBombGameHtml(this.stageData);break;case 4:this.setGuessStringGameHtml(this.stageData)}break;case 3:this.clearFlyTimer(),this.setPunishStatus(!1),this.setPunishedPublishStageHtml(this.stageData)}break;case 2:if(1===this.stageData.sub_stage)this.setRobPunishedHtml(this.stageData);break;case 3:if(1===this.stageData.sub_stage)this.state_2_1_isInited=!1,this.setPunisherAskHtml(this.stageData,t)}}setPunishStatus(t){if(t)window.$(".truth-content-item .seat-item-empty").each(((t,e)=>{e.dataset.uid>0&&window.$(e).find(".seat-status").addClass("punish").removeClass("hide")}));else{let t=window.$(".truth-content-item .seat-item-empty .seat-status");t.hasClass("punish")&&t.removeClass("punish").addClass("hide")}}removeUserPrepareStatus(){window.$(".truth-content-item .seat-item-empty .seat-status").removeClass("correct").addClass("hide")}updateUserPrepareStatus(){uu.getAnchorKengUsers().forEach(((t,e)=>{const n=window.$(`.truth-content-item .seat-item-empty[data-uid="${e}"]`);1==t.is_prepare?n.find(".seat-status").addClass("correct").removeClass("hide"):n.find(".seat-status").removeClass("correct").addClass("hide")}))}getPrepare0_2_Content(t,e){return`\n            <img class="singleLogo" src="${t.game_icon}"/>\n            <p class="common-title">${t.game_name}</p>\n            <p class="common-desc">${e||t.game_desc}</p>\n        `}_setPrepareStageHtml(t,e,n){const i=`\n            <div class="prepare sub_stage_${n}">\n                ${t}\n                ${e}\n            </div>\n        `;window.$("#truth-content-center_game .body").html(i)}setPrepareStageHtml(t){function e(){let e="",n=!1,i=0;const o=uu.isAnchoringUser(uu.getMeid()),s=uu.getAnchorKengUser(uu.getMeid());return o?2==t.sub_stage&&(e="开始游戏",n=!0):uu.isInAnchors(uu.getMeid())&&(i=s?s.is_prepare:0,e=i?"取消":"准备",n=!0),{title:e,show:n,isPrepare:i}}if(window.$(".truth-game-ball").empty(),window.$(`#truth-content-center_game .body .prepare.sub_stage_${t.sub_stage}`).length){const t=e(),n=window.$("#truth-content-center_game .body .prepare .prepareBtn");n.text(t.title);return uu.isAnchoringUser(uu.getMeid())?(n.removeClass("blue"),n.data("is_prepare",0)):(1===t.isPrepare?n.addClass("blue"):n.removeClass("blue"),n[0].dataset.is_prepare=t.isPrepare),void(t.show?n.show():n.hide())}let n="",i="";n=1==t.sub_stage?t.game_list.map((t=>`<img class="gameLogo" data-game_id="${t.game_id}" src="${t.icon}"/>`)).join(""):this.getPrepare0_2_Content(t);const o=e();i=((t="",e=0,n=!1)=>this.getCommonBtn({className:"prepareBtn "+(1==e?"blue":""),title:t,style:n?"display: block;":"display: none;",dataset:{is_prepare:e}}))(o.title,o.isPrepare,o.show),this._setPrepareStageHtml(n,i,t.sub_stage)}setRobRedPkgGameHtml(t){if(t.sub_stage==Oi){const e=uu.isAnchoringUser(uu.getMeid());this._setPrepareStageHtml(this.getPrepare0_2_Content(t,"未产生运气王"),e?this.getCommonBtn({className:"end-game-handle",title:"重新开始",style:"margin-top: 20px;"}):"")}else{const e=`\n                <div class="rob-red-package">\n                    ${`\n                <img class="singleLogo" src="${t.game_icon}" style="cursor: pointer;"/>\n                <p class="countdown">${t.countdown}</p>\n                <p class="desc">抢红包中</p>\n            `}\n                </div>\n            `;window.$("#truth-content-center_game .body").html(e),this.startCountdown({seconds:t.countdown,dom:window.$("#truth-content-center_game .rob-red-package .countdown")})}}updateRobRedPkgStatus(t){if([zi,Oi].includes(this.stageData.sub_stage)&&1==this.stageData.game_id){const e=window.$("#truth-content-center_game .rob-red-package");e.find(".singleLogo").attr("src",t.game_icon),e.find(".desc").text(`领取了${t.diamond}`),e.find(".singleLogo").data("is_received",1)}}getEleCenter(t){const e=t.width(),n=t.height();return{x:t.offset().left+e/2,y:t.offset().top+n/2,width:e,height:n}}onFlyAnim(t,e,n){const i=this,o=[].shift.call(e);if(null!=o){const s=window.$(".seat-item-empty[data-uid="+o.dataset.uid+"]")[0];if(Zt.getInstance().playLoop({ele:window.$(o)[0],path:"https://asset.tuwan.com/chatroom/images/icon_ball.svga"}),s){const a=i.getEleCenter(window.$(s)),r=i.getEleCenter(window.$(o)),c=a.x-r.x+(s.dataset.aposition>=8?-20:20),l=a.y-r.y+3;window.$(o).snabbt({position:[c,l,0],scale:[.25,.25],duration:n.is_halfway&&n.countdown-n.wait_countdown<n.wait_countdown?0:400,start:()=>{setTimeout((()=>i.onFlyAnim(t,e,n)),200)},complete:()=>{}})}}}setCompareNumberGameHtml(t){const e=t.number_list.map((t=>`<div class="fly-ball" data-uid="${t.uid}" style="position: absolute;\n                    left: 0; top: 0; width: 100%; height: 100%; z-index: 11;" data-src="${t.pic}"  ></div>`)).join(""),n=`\n            <div class="compare_number">\n                ${`\n            <div style="margin-top: 25px; position: relative; display: inline-block;">\n                 <img src="${t.game_icon}" style="position: absolute; width: 120px; height: 120px; z-index: 10; left: 50%;transform: translateX(-50%);" />\n                 <div class="truth-content-main-ball" style="position: relative; width: 120px; height: 120px; z-index: 10;overflow: hidden"></div>\n                 ${e}\n            </div>\n            <p class="common-title">比大小游戏</p>\n            <p class="common-desc">拿到最小数者将被惩罚</p>\n        `}\n            </div>\n        `;if(t.number_list.some((t=>window.$(".seat-item-empty[data-uid="+t.uid+"]").length>0))){const e=this;if(this.flyTimer)return;window.$("#truth-content-center_game .body").html(n),this.flyTimer=setTimeout((()=>{Zt.getInstance().loadParser(window.$("#truth-content-center_game .truth-content-main-ball")[0],"https://asset.tuwan.com/chatroom/images/icon_ball.svga?t="+(new Date).getTime(),0,!0).then((n=>{const i=window.$("#truth-content-center_game .compare_number .fly-ball");if(i.length){const n=window.$(i[0]).offset();e.onFlyAnim(n,i,t)}t.countdown-t.wait_countdown>0&&setTimeout((()=>{window.$("#truth-content-center_game .truth-content-main-ball").empty();window.$("#truth-content-center_game .compare_number .fly-ball").each(((t,e)=>{const n=e.dataset;window.$(e).empty(),window.$('.seat-item-empty[data-uid="'+n.uid+'"]').find(".truth-game-ball").html(`<img style="width: 100%; height: 100%; z-index: 11;" src="${n.src}"  />`)})),e.clearFlyTimer()}),1e3*(t.countdown-t.wait_countdown))}),(t=>{}))}),0)}}setNumberBombGameHtml(t){let e=(()=>{if(uu.isAnchoringUser(uu.getMeid())){return`\n                    <div class="flex" style="position: relative; margin-top: 20px;">\n                        ${t.sub_stage===zi?this.getCommonBtn({className:"number-bomb-btn",style:"width: 90px;",title:"亮数字",dataset:{type:1}}):this.getCommonBtn({className:"number-bomb-btn",style:"width: 120px;",title:qi,dataset:{type:2}})}\n                    </div>\n                `}return""})();const n=t.sub_stage===zi?uu.isAnchoringUser(uu.getMeid())?t.game_value:"?":t.sub_stage===Oi?t.game_value:"",i=`\n            <div class="number_bomb flex flex-dir-col flex-ac">\n                ${`\n            ${"?"==n?`<img class="singleLogo" src="${t.game_icon}"/>`:`<div class="flex flex-ac flex-jc" style="margin-bottom: 22px; margin-top: 28px; width: 132px; height: 132px; border-radius: 100%; background-color: rgba(255, 255, 255, 0.3);">\n                    <p style="font-size: 40px; font-weight: bold; color: #FFFFFF; text-shadow: 0px 2px 4px rgba(148, 68, 249, 0.93);">\n                        ${n}\n                    <p>\n                </div>`}\n            <p class="common-title">数字炸弹游戏</p>\n            <p class="common-desc">猜中炸弹数字者将受惩罚</p>\n            ${e}\n        `}\n            </div>\n        `;window.$("#truth-content-center_game .body").html(i)}setGuessStringGameHtml(t){let e=this.getPunishBtn("margin-top: 60px; width: 120px;");const n=`\n            <div class="guess-string">\n                ${`\n            <p style="text-align: left; margin-top: 49px; font-size: 16px; color: rgba(255, 255, 255, 0.6);">第一个成语：</p>\n            <p style="margin-top: 40px; font-size: 30px; font-weight: bold; line-height: 40px;">${t.game_value}</p>\n            <p class="common-desc" style="margin-top: 40px; color: rgba(255, 255, 255, 0.6); font-size: 16px;">从${t.start_wheat}号麦开始，依次接龙</p>\n            ${e}\n        `}\n            </div>\n        `;window.$("#truth-content-center_game .body").html(n)}setPunishedPublishStageHtml(t){const e=t.fail_user;let n=1===t.game_id?"获得了运气王":2===t.game_id?"数字最小":3===t.game_id?"猜中了数字":4===t.game_id?"回答错误":"";const i=`\n            <div class="punished-publish flex flex-dir-col flex-ac">\n                ${this.getSeatHead({avatar:e.avatar,width:100,uid:e.uid,heads:e.heads,forbidFloat:"forbidFloat"})}\n                <p class="desc">${e.wheat_number}号麦 <span>${e.nickname}</span> ${n}</p>\n                <p class="countdown">${t.countdown}</p>\n            </div>\n        `;window.$("#truth-content-center_game .body").html(i),this.startCountdown({seconds:t.countdown,dom:window.$("#truth-content-center_game .punished-publish .countdown")})}setRobPunishedHtml(t,e){const n=this,i=t=>0===t?74:56;if(this.state_2_1_isInited&&!(e instanceof Array)){const e=window.$("#truth-content-center_game .rob-punished .users");for(var o=0;o<t.rank_list.length;o++){const n=t.rank_list[o],s=e.find(`.rank-seat[data-order=${Ni[o]}]`);s.get(0).dataset.uid==n.uid?s.find(".flower-num").text(n.num):s.replaceWith(this.getRankSeat(l(c({},n),{width:i(o),pwidth:74,uid:n.uid,svgaShowed:!1}),o))}return void(t.countdown>0&&!this.countdownTimer&&m())}this.state_2_1_isInited=!0;const s=t.fail_user,a=(()=>new Array(3).fill(0).map(((e,n)=>{const o=t.rank_list[n];return o?this.getRankSeat(l(c({},o),{width:i(n),pwidth:70,uid:o.uid,svgaShowed:!1}),n):this.getRankSeat({avatar:"",nickname:"虚位以待",width:i(n),pwidth:70,uid:"",svgaShowed:!1},n)})).join(""))(),r=uu.isAnchoringUser(uu.getMeid())||s.uid==uu.getMeid()?" disable":"";window.$(".truth-game-ball").empty();const d=`\n            <div class="rob-punished flex flex-dir-col flex-ac">\n                ${this.getSeatHead({avatar:s.avatar,nickname:s.nickname,width:73,pwidth:100,uid:s.uid,heads:s.heads,className:"fail"})}\n                <div class="users flex flex-jb flex-ac">${a}</div>\n                <div style="position: relative; margin-top: 5px;">\n                    ${this.getCommonBtn({title:"抢惩罚权",className:"rob-punished-btn"+r})}\n                    <p class="countdown">${t.countdown}s</p>\n                </div>\n                <p style="margin-top: 10px; font-size: 12px; color: #FFFFFF; line-height: 14px;">送一朵玫瑰花</p>\n            </div>\n        `;function m(){n.startCountdown({seconds:t.countdown,dom:window.$("#truth-content-center_game .rob-punished .countdown"),showS:!0,cb:()=>{window.$("#truth-content-center_game .rob-punished .rob-punished-btn").addClass("disable"),n.gotoNext()}})}window.$("#truth-content-center_game .body").html(d),m()}interceptDisposeAnimate(t,e,n,i,o,s,a,r){const c=this.stageData;if(uu.isTruthRoom()&&"34"==a&&c&&2==c.stage&&1==c.sub_stage&&1==e.length&&e[0]==c.fail_user.uid){const l=window.$(".truth-room-content").find(".rob-punished .seat-item-empty[data-uid='"+c.fail_user.uid+"']");return 1==l.length&&(Yt.playSvgaAniToTeacherEle(t,e[0],l,n,i,o,s,a,r),!0)}return!1}setPunisherAskHtml(t,e){const n=()=>{if(this.seatsData){const t=this.seatsData.find((t=>0==t.position));t&&t.uid==uu.getMeid()?window.$("#truth-content-center_game .punisher-ask .btns").show():window.$("#truth-content-center_game .punisher-ask .btns").hide()}};if(e instanceof Array)return void n();const i=t=>Fi._getOtherAnchorSeatHtml({position:t,userinfo:null,iscar:!1,isshouhu:!1,defaultbg:"add",shouhutype:1,headsvga:"",role:"",index:0,pwidth:80,pheight:100,width:70,height:70,isrightline:!1,isshowmeili:!1});const o=`\n            <div class="punisher-ask flex flex-dir-col flex-ac">\n                ${`\n            <div class="flex flex-ac" style="margin-top: 35px;">\n                <div style="position: relative;">\n                    ${i(0)}\n                    <p style="position: absolute; line-height: 16px; text-align: center; border-radius: 16px; color: #fff; font-size: 12px; top: 58px; left: 50%; transform: translateX(-50%); background: #f858a2; padding: 0 5px; z-index: 5; white-space: nowrap;">惩罚位</p>\n                </div>\n                <img style="width: 49px; height: 53px; margin: 0px 13px;" src="https://asset.tuwan.com/chatroom/images/icon_truth_hammer.png"/>\n                ${i(1)}\n            </div>\n        `}\n                <p class="common-title" style="margin-top: 36px;">惩罚者开始提问</p>\n                ${(()=>`\n                <div class="btns flex" style="position: relative; margin-top: 39px; display: none;">\n                    ${this.getCommonBtn({className:"satisfaction-btn blue",style:"margin-right: 20px;",title:"不满意",dataset:{satisfaction:2}})}\n                    ${this.getCommonBtn({className:"satisfaction-btn",title:"满意",dataset:{satisfaction:1}})}\n                </div>\n            `)()}\n            </div>\n        `;window.$("#truth-content-center_game .body").html(o),this.seatsData&&Fi.updateAnchorSpecialSeat(this.seatsData.filter((t=>t.position<2))),uu.isAnchoringUser(uu.getMeid())&&window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show(),n()}getRankSeat(t,e){let n="",i="";return t.uid?i=`\n                <div class="flex flex-ac flex-jc" style="position: absolute; left: 50%; top: ${t.width-10}px; height: 15.5px; border-radius: 15.5px; z-index: 10; transform: translateX(-50%); padding: 0 5px; background-color: #6A00ED;">\n                    <img src="https://asset.tuwan.com/chatroom/images/icon_truth_meigui.png" style="width: 10px; height: 9.5px;"/>\n                    <p class="flower-num" style="font-size: 10px; color: white;">${t.num}</p>\n                </div>\n            `:n='\n                <div class="flex flex-jc flex-ac" style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(255, 255, 255, 0.2); border-radius: 100%;">\n                    <img style="width: 15.5px; height: 13px;" src="https://asset.tuwan.com/chatroom/images/icon_truth_null_seat.png"/>\n                </div>\n            ',`\n            <div class="rank-seat" data-uid="${t.uid}" data-order="${Ni[e]}" style="position: relative; order: ${Ni[e]}">\n                <p style="position: absolute; width: 16px; background: #FF6691; border: 0.5px solid #FFFFFF; line-height: 16px; text-align: center; border-radius: 100%; color: white; font-size: 12px; right: 0px; top: 0px; z-index: 5;">${e+1}</p>\n                ${this.getSeatHead(l(c({},t),{nickname:t.nickname||"",customAvatar:n,forbidFloat:"forbidFloat"}))}\n                ${i}\n            </div>\n        `}getSeatHead({nickname:t="",avatar:e="",heads:n,customAvatar:i,uid:o,width:s,pwidth:a,svgaWidth:r="130%",className:c="",svgaShowed:l=!0,forbidFloat:d=""}){return t&&(t=`<p class="seat-user-name haveuser">${t}</p>`),l&&n&&setTimeout((()=>{Zt.getInstance().playLoop({ele:window.$("#truth-content-center_game .seat-item-empty[data-uid='"+o+"'] .seat-svga")[0],path:n})}),0),`\n            <div class="seat-item-empty seat-item ${d} ${c}" data-uid="${o}" style="width: ${a||s}px;">\n                <div class="seat-head" style="width:${s}px; height:${s}px;">\n                    <div class="seat-wave"></div>\n                    <div class="seat-svga" style="width: ${r}; height: ${r};"/>\n                    <div class="seat-user-head ">\n                        ${i||`<img class="seat-head-img" src="${e}" onerror="this.src='https://asset.tuwan.com/chatroom/images/default_avator.jpg'">`}\n                    </div>\n                </div>\n                ${t}\n            </div>\n        `}getCommonBtn({title:t="",className:e="",style:n="",dataset:i={}}){let o="";for(var s in i)o+="data-"+s+"="+i[s]+" ";return`<p class="common-btn ${e}" style="${n}" ${o}>${t}</p>`}getPunishBtn(t){let e="";return uu.isAnchoringUser(uu.getMeid())&&(e=this.getCommonBtn({className:"punish-btn",style:t,title:qi})),e}gotoNext(){uu.getCid(),uu.isAnchoringUser(uu.getMeid())&&qt.get(Ot.setTruthCountdown(uu.getCid())).then((t=>{}))}startCountdown({seconds:t,dom:e,showS:n=!1,cb:i}){let o=this;function s(){i?i():o.gotoNext()}t>0?(this.clearCountdownTimer(),this.countdownTimer=setInterval((()=>{e&&e.html(String(--t)+(n?"s":"")),this.stageData.countdown=t,t<=0&&(o.clearCountdownTimer(),s())}),1e3)):s()}interceptSeatCheck(){return!!(this.stageData&&this.stageData.stage>0)&&(Vt("游戏开始之后不允许上麦！"),!0)}checkIsTruthRoomZeroSeat(t){if(uu.isTruthRoom()){const e=window.$(".chat-center-main").find(".seat-item-empty[data-aposition=0]");if(e.length&&e[0].dataset.uid==(t||uu.getMeid()))return!0}return!1}initEvents(){const t=uu.getCid();function e(t){return t.then((t=>(0!=t.error&&t.error_msg&&Vt(t.error_msg),t)))}const n=500,i=Ct.preventQuickClick(n);let o=this;window.$("#truth-content-center_game").on("click",".prepareBtn",(function(n){const o=uu.getMeid();if(uu.isAnchoringUser(o))i((()=>{e(qt.get(Ot.setTruthStartGame(t))).then((t=>{}))}));else if(uu.isInAnchors(o)){const e=this.dataset.is_prepare;i((()=>{1==e?qt.get(Ot.setTruthCancelPrepare(t)).then((t=>{})):qt.get(Ot.setTruthPrepare(t)).then((t=>{}))}))}else Vt("游客不能参与游戏")}));const s=Ct.preventQuickClick(n);window.$("#truth-content-center_game").on("click",".prepare .gameLogo",(function(){uu.isAnchoringUser(uu.getMeid())&&s((()=>{e(qt.get(Ot.setTruthSelectGame(t,this.dataset.game_id))).then((t=>{}))}))}));const a="您不能参与抢红包！",r=Ct.preventQuickClick(n);function c(t){const e=t.hasClass("selected");t.hide(),o.setPunishStatus(!e)}window.$("#truth-content-center_game").on("click",".rob-red-package .singleLogo",(function(){const n=uu.getMeid();uu.isAnchoringUser(n)?Vt(a):uu.isInAnchors(n)?1!=window.$(this).data("is_received")&&r((()=>{e(qt.get(Ot.setTruthGiveRedPackage(t))).then((t=>{0==t.error&&o.updateRobRedPkgStatus(t.data)}))})):Vt(a)}));const l=Ct.preventQuickClick(n);window.$("#truth-content-center_game").on("click",".number-bomb-btn",(function(n){n.stopPropagation(),1==this.dataset.type?l((()=>{e(qt.get(Ot.setTruthShowNumber(t))).then((t=>{}))})):2==this.dataset.type&&c(window.$(this))})),window.$("#truth-content-center_game").on("click",".punish-btn",(function(t){t.stopPropagation(),c(window.$(this)),window.$(this).toggleClass("blue")}));const d=Ct.preventQuickClick(n);window.$(document).on("click",".seat-item-empty .punish",(function(n){n.stopPropagation();const i=window.$(this).parents(".seat-item-empty").get(0);i.dataset.uid&&d((()=>{e(qt.get(Ot.setTruthFailUser(t,i.dataset.uid))).then((t=>{}))}))})),window.$("#truth-content-center_game").on("click",".rob-punished-btn",(function(t){if(t.stopPropagation(),!window.$(this).hasClass("disable")){const t=o.stageData.fail_user;t&&(uu.isAnchoringUser(uu.getMeid())||t.uid==uu.getMeid()||o.sendGift("34",t.uid,t.nickname,1,{cid:uu.getCid(),truth_gift:1}))}}));const m=Ct.preventQuickClick(n);window.$("#truth-content-center_game").on("click",".satisfaction-btn",(function(e){e.stopPropagation(),window.$("#truth-content-center_game .punisher-ask .btns p").addClass("disable"),m((()=>{qt.get(Ot.setTruthPunishStatus(t,this.dataset.satisfaction)).then((t=>{}))}))}));const h=Ct.preventQuickClick(n);window.$(".truth-room-content").on("click",".end-game-handle",(function(n){n.stopPropagation(),h((()=>{e(qt.get(Ot.setTruthGameEnd(t))).then((t=>{}))}))})),window.$(".truth-room-content").on("click",".truth-rule",(function(t){t.stopPropagation(),ze.show({desc:uu.roomInfo.rule_desc.replace(/\/r\/n/g,"<br />").replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")})}))}updateStage(t){window.$(".truth-content-center_stage p").removeClass("current");for(var e=1;e<=t.stage;e++)window.$(`.truth-content-center_stage p[data-stage="${e}"]`).addClass("current");window.$(".truth-content-center_stage_desc").text(t.desc),0==t.stage&&1==t.sub_stage&&uu.isAnchoringUser(uu.getMeid())?window.$(".truth-room-content .select-game-desc").show():window.$(".truth-room-content .select-game-desc").hide(),0==t.stage&&1==t.sub_stage||!uu.isAnchoringUser(uu.getMeid())?window.$(".truth-room-content .end-game-btn").hide():window.$(".truth-room-content .end-game-btn").show()}initHtml(t){const e=`\n            <div class="truth-room-anchor-container">\n                ${Fi._initSeatData(2,158,135,90,90,uu.isTruthSmallRoom()?"房主":"主持",!1,!1,"add")}\n                <p class="select-game-desc" style="display: none; line-height: 19px; font-size: 14px; text-align: center; color: rgba(255, 255, 255, 0.6);">请至少选择一个游戏</p>\n            </div>\n        `,n=new Array(10).fill(0).map(((t,e)=>Fi._getOtherAnchorSeatHtml({position:3+e,userinfo:null,iscar:!1,isshouhu:!1,defaultbg:"add",shouhutype:1,headsvga:"",role:uu.isTruthSmallRoom()?"嘉宾":"",index:e+1||1,pwidth:80,pheight:98,width:64,height:64,isrightline:!1,isshowmeili:!uu.isTruthSmallRoom()}))).map(((t,e)=>`\n            <div class="truth-content-item" data-seat="${e+3}">\n                ${t}\n            </div>\n        `));let i=`\n            <div class="truth-room-content flex" style="justify-content: center;">\n                <div id="truth-room-svgaBg" style="position: absolute; width: 100%; height: 100%; top:0;z-index: -1"></div>\n                <div class="truth-room__wrapper flex flex-1" style="justify-content: center; margin-left: -100px;">\n                    <div class="truth-anchor__container">\n                        <div class="truth-anchor__wrapper flex">\n                            ${e}\n                        </div>\n                        <p class="end-game-btn end-game-handle common-btn" style="display: none; margin-top: 20px; margin-left: 30px;">结束游戏</p>\n                    </div>\n                    <div class="truth-content__container flex flex-jb">\n                        ${`\n            <div class="truth-content-left">${n.slice(0,5).join("")}</div>\n        `}\n                        \n            <div class="truth-content-center">\n                <div class="truth-content-center_stage flex flex-jb">\n                    <p data-stage="1">游戏环节</p>\n                    <p data-stage="2">抢惩罚权</p>\n                    <p data-stage="3">惩罚环节</p>\n                </div>\n                <p class="truth-content-center_stage_desc"></p>\n                <div id="truth-content-center_game" class="truth-content-center_game">\n                    <img class="logo" src="https://asset.tuwan.com/chatroom/images/icon_truth_logo.png"/>\n                    <div class="body"></div>\n                </div>\n            </div>\n        \n                        ${`\n            <div class="truth-content-right">${n.slice(5,10).join("")}</div>\n        `}\n                    </div>\n                    <div class="truth-menus" style="position: absolute; left: 30px; top: 35px;">\n                        <div class="truth-rule song-but song-but-setting flex flex-jc flex-ac">玩法</div>\n                        <div class="song-but song-but-setting flex flex-jc flex-ac hide">设置</div>\n                        <div class="song-but song-but-clockin flex flex-jc flex-ac hide">打卡</div>\n                    </div>\n                </div>\n            </div>\n        `;window.$(".room-seats-main").html(i);let o=""!=t.skin?t.skin:""!=t.skin_active?t.skin_active:"";if(""!=o)if(-1!=o.indexOf(".svga")){const t=Zt.getInstance();t.loadParser("#truth-room-svgaBg",o,0,!1).then((e=>{const{videoItem:n,player:i}=e;i.setVideoItem(n),i.startAnimation(),i.setContentMode("AspectFill"),t.playersMap.set("truth-room-svgaBg",i)}),(t=>{}))}else window.$(".truth-room-content").css("background",'rgba(0, 0, 0, 0) url("'+o+'") no-repeat scroll 50% 50% / 100% 100% padding-box border-box')}initStyle(){window.$("head").append('\n            <style>\n                /* 公共功能 */\n                .truth-room-content {\n                    position: relative;\n                    height: 540px;\n                }\n                .truth-room__wrapper {\n                    padding-top: 30px;\n                }\n                .truth-anchor__wrapper {\n                    margin-top: 130px;\n                    width: 255px;\n                }\n                .truth-content__container {\n                    width: 560px;\n                }\n                .truth-content-center_stage p {\n                    position: relative;\n                    width: 84px;\n                    line-height: 30px;\n                    text-align: center;\n                    border-radius: 30px;\n                    background-color: rgba(255, 255, 255, 0.2);\n                    color: rgba(255, 255, 255, 0.6);\n                    font-size: 16px;\n                }\n                .truth-content-center_stage p:nth-child(1)::after, .truth-content-center_stage p:nth-child(2)::after {\n                    content: "";\n                    height: 6px;\n                    width: 6px;\n                    top: 10px;\n                    right: -14px;\n                    border-width: 2px 2px 0 0;\n                    border-color: rgba(255, 255, 255, 0.6);\n                    border-style: solid;\n                    transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);\n                    position: absolute;\n                }\n                .truth-content-center_stage p.current:nth-child(1)::after, .truth-content-center_stage p.current:nth-child(2)::after {\n                    border-color: white;\n                }\n                .truth-content-center_stage p.current {\n                    background-color: rgba(255, 255, 255, 0.5);\n                    color: white;\n                }\n                .truth-content-center_stage_desc {\n                    font-size: 16px;\n                    color: rgba(255, 255, 255, 0.6);\n                    text-align: center;\n                    margin-top: 15px;\n                    height: 22px;\n                }\n                .truth-content-center_game {\n                    width: 300px;\n                    height: 400px;\n                    background: #A257FF;\n                    border-radius: 10px;\n                    margin: auto;\n                    margin-top: 15px;\n                    text-align: center;\n                    border: 1px solid rgba(255, 255, 255, 0.2);\n                }\n                .truth-content-center_game .logo {\n                    margin-top: 30px;\n                    height: 39px;\n                }\n                .truth-room-content .seat-item p.seat-user-name {\n                    font-size: 12px;\n                }\n                .truth-room-content .truth-room-anchor-container .seat-item p.seat-user-name {\n                    font-size: 16px;\n                }\n\n                /* 样式覆盖 */\n                .truth-content-center_game .seat-item {\n                    height: auto;\n                }\n\n                /* 公共样式 */\n                .truth-room-content .common-btn {\n                    margin: auto;\n                    width: 100px;\n                    line-height: 35px;\n                    border-radius: 35px;\n                    color: rgba(255, 255, 255, 1);\n                    font-size: 16px;\n                    text-align: center;\n                    font-weight: bold;\n                    border: 1px solid #F3A4C0;\n                    cursor: pointer;\n                    background: linear-gradient(to bottom,#FB789D, #E85B83);\n                    cursor: pointer;\n                    user-select: none;\n                }\n                .truth-room-content .common-btn.disable {\n                    opacity: 0.6;\n                }\n                .truth-room-content .common-btn.blue {\n                    background: linear-gradient(to bottom,#6676FF, #4B32DF);\n                    border: 1px solid #939DFE;\n                }\n                .truth-content-center_game .body .common-title {\n                    margin-top: 8px;\n                    font-size: 18px;\n                    color: #FFFFFF;\n                    font-weight: bold;\n                    line-height: 24px;\n                }\n                .truth-content-center_game .body .common-desc {\n                    margin-top: 18px;\n                    font-size: 12px;\n                    color: rgba(255, 255, 255, 0.6);\n                    line-height: 16px;\n                }\n                .truth-content-center_game .body .singleLogo {\n                    width: 167px;\n                    height: 167px;\n                    margin-top: 16px;\n                }\n\n                /* 准备阶段 */\n                .truth-content-center_game .body .prepare {\n                    width: 260px;\n                    margin: auto;\n                }\n                .truth-content-center_game .body .prepare .gameLogo {\n                    width: 90px;\n                    height: 90px;\n                    margin-top: 30px;\n                    cursor: pointer;\n                }\n                .truth-content-center_game .body .prepare .gameLogo:nth-child(odd) {\n                    margin-right: 36px;\n                }\n                .truth-content-center_game .body .prepare .prepareBtn {\n                    margin-top: 21px;\n                }\n\n                /* 抢红包游戏 */\n                .truth-content-center_game .body .rob-red-package .countdown {\n                    margin-top: 2px;\n                    font-size: 50px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    line-height: 66px;\n                }\n                .truth-content-center_game .body .rob-red-package .desc {\n                    margin-top: 12px;\n                    font-size: 18px;\n                    color: rgba(255, 255, 255, 0.8);\n                    line-height: 22px;\n                }\n\n                /* 比大小游戏 */\n                .truth-content-center_game .body .compare_number p {\n                    color: white;\n                }\n\n                /* 猜成语游戏 */\n                .truth-content-center_game .body .guess-string {\n                    width: 200px;\n                    margin: auto;\n                }\n                .truth-content-center_game .body .guess-string p {\n                    color: white;\n                }\n\n                /* 被惩罚人公布的样式展示 */\n                .truth-content-center_game .body .punished-publish .seat-item {\n                    margin-top: 30px;\n                }\n                .truth-content-center_game .body .punished-publish .desc {\n                    margin-top: 28px;\n                    line-height: 20px;\n                    font-size: 14px;\n                    color: rgba(255, 255, 255, 0.6);\n                }\n                .truth-content-center_game .body .punished-publish .desc span {\n                    color: rgba(255, 255, 255);\n                }\n                .truth-content-center_game .body .punished-publish .countdown {\n                    margin-top: 29px;\n                    font-size: 50px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    line-height: 66px;\n                }\n\n                /* 抢惩罚位置 */\n                .truth-content-center_game .body .rob-punished .fail {\n                    margin-top: 30px;\n                }\n                .truth-content-center_game .body .rob-punished .users {\n                    margin-top: 10px;\n                    width: 266px;\n                }\n                .truth-content-center_game .body .rob-punished .countdown {\n                    position: absolute;\n                    top: 8px;\n                    right: -50px;\n                    width: 50px;\n                    text-align: right;\n                    font-size: 18px;\n                    color: #FFFFFF;\n                    font-weight: bold;\n                }\n                .truth-room-content .rob-punished .seat-item p.seat-user-name {\n                    font-size: 14px;\n                }\n\n                /* 问答环节 */\n                .truth-room-content .punisher-ask .seat-item p.seat-user-name {\n                    font-size: 14px;\n                }\n    \t\t</style>\n        ')}}class Vi{constructor(){this.instance=null,this.initCss(),this.initHtml()}static getInstance(){return this.instance||(this.instance=new Vi),this.instance}initCss(){window.$("head").append("<style>\n                        .modal_f{display:flex}\n                        .modal_f_c{display:flex;align-items:center;justify-content:center;}\n                        .modal_f_sb{display:flex;align-items:center;justify-content: space-between;}\n                        .modal_text_over{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n                        .newboss_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .newboss_content{width:680px;border-radius:20px;background:#fff;text-align:center;padding:20px 0}\n                        .newboss_title{font-size:30px;color:#FF6691;margin-bottom:14px}\n                        .newboss_pro{position:relative;width:620px;height:310px;border:1px solid #FF6691;border-radius:10px;margin:0 auto;overflow:hidden;font-size:16px}\n                        .common_modal_line{position:absolute;width:620px;border:none;border-top:1px solid #FFC4D5;margin:0}\n                        .modal_line_1{top:30px}\n                        .modal_line_2{top:170px}\n                        .pro_title{width:120px;height:30px;background:rgba(255, 102, 145, .1);color:#FF6691;line-height:30px;}\n                        .pro_title.actived{background:#FF6691;color:#fff}\n                        .pro_item_content{width:120px;height:140px;flex-direction: column;}\n                        .common_pro_item{width:110px;height:120px;flex-direction: column;opacity:.3;position:relative}\n                        .common_pro_item.actived{opacity:1;background:rgba(255, 102, 145, .12);border-radius:10px}\n                        .common_pro_item .pro_avatar{width:60px;height:60px;border-radius:50%}\n                        .pro_name{margin-top:4px;width:120px}\n                        .gift_pro_finish{position:absolute;top:2px;right:2px}\n                        .newboss_tips{color:#7E7E7E;margin-top:20px}\n                        .newboss_tips span{color:#FF6691}\n                        .newboss_btn{width:200px;height:40px;color:#fff;background:#FF6691;border-radius:20px;margin:20px auto 0;line-height:40px;cursor: pointer;}\n\n                        .common_owner_content{position:relative;width:400px;height:400px;background:#fff;border-radius:20px;text-align:center;padding:20px 0;box-sizing:border-box}\n                        .owner_box_title{font-size:30px;color:#FF6691;margin-bottom:14px}\n                        .owner_box_user{position:relative;width:200px;height:200px;margin:0 auto}\n                        .owner_gift_pic{position:absolute;height:100%;top:0;left:50%;transform:translateX(-50%)}\n                        .owner_gift_avatar{position:absolute;width:60px;height:60px;border-radius:50%;border:2px solid #fff;z-index:10;left:50%;transform:translateX(-50%);bottom:10px}\n                        .owner_box_user_name{margin-top:10px}\n                        .owner_box_user_name span{color:#FF6691}\n                        .common_owner_btn{width:200px;height:40px;color:#fff;background:#FF6691;border-radius:20px;margin:20px auto 0;line-height:40px;cursor: pointer;}\n                        .owner_box_gift_content{display:none}\n                        .owner_box_gift_list{margin:70px auto 75px}\n                        .owner_gift_item{width:100px;height:120px;background:url(https://asset.tuwan.com/chatroom/images/owner_gift_item.png);background-size:100% 100%;margin:0 10px}\n                        .owner_gift_pic_content{width:80px;height:80px;margin:0 auto}\n                        .owner_gift_pic_content img{max-width:80%;max-height:80%}\n                    </style>")}initHtml(){window.$("body").append('<div class="newboss_mask">\n                        <div class="newboss_content">\n                            <div class="newboss_title">七日消费奖励</div>\n                            <div class="newboss_pro modal_f_sb"></div>\n                            <div class="newboss_tips">7日内老板累计消费越多，奖励越好！<span></span></div>\n                            <div class="newboss_btn">知道了</div>\n                        </div>\n                    </div>\n                    <div class="owner_box_modal common-gift-mask">\n                        <div class="owner_box_content common_owner_content">\n                            <div class="common_owner_close common-gift-close"></div>\n                            <div class="owner_box_title">专属礼包</div>\n                            <div class="owner_box_user modal_f_c"></div>\n                            <div class="owner_box_user_name">赠送人<span></span></div>\n                            <div class="open_owner_box common_owner_btn" data-type="open">开启礼包</div>\n                        </div>\n                        <div class="owner_box_gift_content common_owner_content">\n                            <div class="common_owner_close common-gift-close"></div>\n                            <div class="owner_box_title">专属奖励</div>\n                            <div class="owner_box_gift_list modal_f_c"></div>\n                            <div class="take_owner_box common_owner_btn" data-type="take">领取奖励</div>\n                        </div>\n                    </div>'),this.initEvent()}showModal(t){const{captain_nickname:e,captain_avtar:n,nickname:i,avtar:o,money:s,gift:a}=t;let r=`<hr class="modal_line_1 common_modal_line">\n                    <hr class="modal_line_2 common_modal_line">\n                    <div class="pro_item">\n                        <div class="pro_title actived">累计消费</div>\n                        <div class="modal_f_c pro_item_content">\n                            <div class="common_pro_item modal_f_c" style="opacity:1">\n                                <img class="pro_avatar" src="${o}">\n                                <div class="pro_name modal_text_over">${i}</div>\n                            </div>\n                        </div>\n                        <div class="modal_f_c pro_item_content">\n                            <div class="common_pro_item modal_f_c" style="opacity:1">\n                                <img class="pro_avatar" src="${n}">\n                                <div class="pro_name modal_text_over">${e}</div>\n                            </div>\n                        </div>\n                    </div>`;a.forEach((t=>{const e=1==t.complet?'<img class="gift_pro_finish" src="https://asset.tuwan.com/chatroom/images/finish.png">':"";r+=`<div class="pro_item">\n                        <div class="pro_title ${1==t.complet?"actived":""}">${t.money}钻</div>\n                        <div class="modal_f_c pro_item_content">\n                            <div class="common_pro_item modal_f_c ${1==t.complet?"actived":""}">\n                                <img src="${t.user_gift.icon}">\n                                ${e}\n                                <div class="pro_name modal_text_over">${t.user_gift.title}</div>\n                            </div>\n                        </div>\n                        <div class="modal_f_c pro_item_content">\n                            <div class="common_pro_item modal_f_c ${1==t.complet?"actived":""}">\n                                <img src="${t.captain_gift.icon}">\n                                ${e}\n                                <div class="pro_name modal_text_over">${t.captain_gift.title}</div>\n                            </div>\n                        </div>\n                    </div>`})),window.$(".newboss_pro").html(r),window.$(".newboss_tips span").html(`当前已消费${s}钻`),window.$(".newboss_mask").css("display","flex")}showOwnerBox(t){window.$(".common_owner_content").hide(),window.$(".owner_box_content").show(),window.$(".take_owner_box").attr("data-id",t),qt.get(Ot.userZpack(t)).then((t=>{if(0==t.error){const{avtar:e,gift:n,nickname:i,pic:o}=t.data;window.$(".owner_box_modal").css("display","flex");const s=`<img class="owner_gift_pic" src="${o}"><img class="owner_gift_avatar" src="${e}">`;window.$(".owner_box_user").html(s),window.$(".owner_box_user_name span").html(i);let a="";n.forEach((t=>{a+=`<div class="owner_gift_item">\n                                    <div class="ygb_f_c owner_gift_pic_content">\n                                        <img src="${t.icon}">\n                                    </div>\n                                    <div>${t.title+"x"+t.num}</div>\n                                </div>`})),window.$(".owner_box_gift_list").html(a)}else Vt(t.error_msg)}))}initEvent(){window.$(".newboss_mask").on("click",".newboss_btn",(function(){window.$(".newboss_mask").hide()})),window.$(document).on("click",".common_owner_btn",(function(t){const e=this.dataset.type;if("open"==e)window.$(".common_owner_content").hide(),window.$(".owner_box_gift_content").show();else if("take"==e){const t=this.dataset.id;qt.get(Ot.takeUserZpack(t)).then((t=>{0==t.error&&window.$(".owner_box_modal").hide(),Vt(t.error_msg)}))}})),window.$(document).on("click",".common_owner_close",(function(t){window.$(".owner_box_modal").hide()}))}}const Hi=new class{constructor(t){this.ewmInterval=null,this.listenChangeEwm=null,this.request=t}titleRender(t){return'<p class="pay-title">需要支付<span id="pay-needmoney">'+(t/10).toFixed(0)+"</span> 钻石</p>"}desRender(){return'<p style="font-size:14px; color: #666;">支付后将直接进行购买</p>'}renderEwm(t,e,n,i){n||(n=this.titleRender),i||(i=this.desRender);const o=window.jQuery(".pay-ewm");if(o.length>0)return o.show(),void window.jQuery("#pay-ewm-img").attr("src",e);const s=`<div class="pay-ewm" style="display:block;">\n                        <div class="pay-main">\n                            <span class="pay-close"></span>\n                            ${n(t)}\n                            ${i()}\n                            <div style="display: flex; align-items: center; justify-content: center; margin: 10px auto; ">\n                                <img id="pay-ewm-img" src="`+e+'">\n                            </div>\n                            <p style="color: red;font-size: 14px;margin: 6px 0; text-align: center;">严禁利用收款码进行诈骗，发现后会立即通知公安机关</p>\n                            <p style="font-size:14px;color: #666; ">请使用微信或支付宝扫码支付</p>\n                        </div>\n                    </div>';window.jQuery("body").append(s);const a=this;window.jQuery(".pay-ewm").one("click",".pay-close",(function(){a.closePayEwm()}))}removeEwmMask(){const t=window.jQuery(".pay-ewm");t.length>0&&t.remove()}payGift(t){let e=[];for(let o in t)e.push(o+"="+t[o]);const n="anonymous=0&actid=100&platform=0&"+e.join("&"),i=Ot.payDiamond(n);return this.request.get(i)}payBoxGift(t){let e=[];for(let o in t)e.push(o+"="+t[o]);const n="anonymous=0&actid=100&platform=0&"+e.join("&"),i=Ot.payBaobox(n);return this.request.get(i)}payGiftBaoguo(t){let e=[];for(let o in t)e.push(o+"="+t[o]);const n="platform=0&"+e.join("&"),i=Ot.giveGift(n);return this.request.get(i)}payBoxBaoguo(t){let e=[];for(let o in t)e.push(o+"="+t[o]);const n="platform=0&"+e.join("&"),i=Ot.payBaobox(n);return this.request.get(i)}payQRCodeWithDiamond(t,e,n,i){this.payQRCode({typeid:2003,money:t},t,e,n,i)}payQRCode(t,e,n,i,o){let s=[];for(let r in t)s.push(r+"="+t[r]);const a=At+"/Pay/qrcode?format=jsonp&size=4&"+s.join("&");this.request.get(a).then((s=>{if(0==s.error){const l=s.tradeno,d=s.qrcode;this.renderEwm(e,d,i,o),this.listenPay(l,n),t.tradeno=l;const m=this;this.listenChangeEwm||(a=t,r=e,c=n,m.listenChangeEwm=setInterval((function(){m.payQRCode(a,r,c,i,o)}),3e4))}var a,r,c}))}listenPay(t,e){if(!this.ewmInterval){const n=Pt+"/Diamond/checkOrder?format=jsonp&tradeno="+t;let i=this;this.ewmInterval=setInterval((function(){qt.get(n).then((t=>{if(t&&0==t.error){2==t.state&&(i.closePayEwm(),e&&e(t.data))}}))}),2e3)}}closePayEwm(){clearInterval(this.ewmInterval),clearInterval(this.listenChangeEwm),this.listenChangeEwm=null,this.ewmInterval=null,this.removeEwmMask()}}(qt);class Wi{constructor(){this.instance=null,this.newGiftData=null,this.initCss(),this.initHtml()}static getInstance(){return this.instance||(this.instance=new Wi),this.instance}initCss(){window.$("head").append("<style>\n                        .newgift_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .newgift_img{width:400px;cursor: pointer;}\n                    </style>")}initHtml(){window.$("body").append('<div class="newgift_mask">\n                        <img class="newgift_img" src="">\n                    </div>'),this.initEvent()}checkIsNew(t){qt.get(Ot.checkIsNewUser(t)).then((t=>{if(0==t.error){const e=t.data;if(e.length>0){const t=e.filter((t=>t.pack)),n=e.filter((t=>1==t.is_h5));if(t.length>0){const e=t[0].pack.sleep;setTimeout((()=>{this.showNewUserGiftModal(t[0].pack)}),1e3*e)}if(n.length>0){const t={url:n[0].url,iframeWidth:"375px",iframeHeight:"700px"};Ct.createIframe(t)}}}}))}showNewUserGiftModal(t){this.newGiftData=t,window.$(".newgift_mask").css("display","flex"),window.$(".newgift_img").attr("src",t.pic)}initEvent(){let t=this;window.$(".newgift_mask").on("click",".newgift_img",(function(){qt.get(Ot.payNewUserGift(t.newGiftData.id)).then((e=>{if(0==e.error)Vt(e.error_msg),window.$(".newgift_mask").hide(),Wo.getInstance().getGiftsNew(uu.getCid(),0);else if(-2==e.error){const e={typeid:t.newGiftData.buy_type,money:t.newGiftData.id};Hi.payQRCode(e,100*t.newGiftData.money,(t=>{window.$(".newgift_mask").hide(),Vt("购买成功"),Wo.getInstance().getGiftsNew(uu.getCid(),0)}))}}))})),window.$(".newgift_mask").mouseup((function(t){var e=window.$(".newgift_img");e.is(t.target)||0!==e.has(t.target).length||window.$(".newgift_mask").hide()}))}}const Ki="src/js/components/goldMagic/components/resultGiftItem.svelte";function Yi(t){let e;const n={c:function(){e=_("div"),y(e,"class","gift_item_costly_border s-ZVHhKm1-25LO"),x(e,Ki,16,12,459)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:Yi.name,type:"if",source:"(16:8) {#if costly}",ctx:t}),n}function Ji(t){let e,n,i,o,s,a;const r={c:function(){e=_("div"),n=M("恭喜您获得 "),i=M(t[5]),o=M(" 紫晶礼物"),s=M(t[1]),a=M("个"),y(e,"class","gift_item_desc s-ZVHhKm1-25LO"),x(e,Ki,21,10,617)},m:function(t,r){b(t,e,r),I(e,n),I(e,i),I(e,o),I(e,s),I(e,a)},p:function(t,e){32&e&&P(i,t[5]),2&e&&P(s,t[1])},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:r,id:Ji.name,type:"if",source:"(21:8) {#if isBigger}",ctx:t}),r}function Qi(t){let e;const n={c:function(){e=_("div"),y(e,"class","gift_item_hit s-ZVHhKm1-25LO"),x(e,Ki,25,10,731)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:Qi.name,type:"if",source:"(25:8) {#if hit == 1}",ctx:t}),n}function Xi(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g=t[2]&&Yi(t),f=t[4]&&Ji(t),w=1==t[6]&&Qi(t);const v={c:function(){e=_("div"),n=_("div"),g&&g.c(),i=T(),o=_("img"),a=T(),r=_("div"),c=M("x"),l=M(t[1]),d=T(),f&&f.c(),m=T(),w&&w.c(),L(o.src,s=t[0])||y(o,"src",s),y(o,"alt",""),y(o,"class","s-ZVHhKm1-25LO"),x(o,Ki,18,8,525),y(r,"class","num s-ZVHhKm1-25LO"),x(r,Ki,19,8,554),y(n,"class",h=R(t[2]?"gift_item_wrapper costly":"gift_item_wrapper")+" s-ZVHhKm1-25LO"),A(n,"animation-delay",80*t[3]+"ms"),x(n,Ki,11,4,292),y(e,"class",u=R(t[4]?"gift_item_container bigger":"gift_item_container")+" s-ZVHhKm1-25LO"),x(e,Ki,10,0,210)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,s){b(t,e,s),I(e,n),g&&g.m(n,null),I(n,i),I(n,o),I(n,a),I(n,r),I(r,c),I(r,l),I(n,d),f&&f.m(n,null),I(n,m),w&&w.m(n,null)},p:function(t,[a]){t[2]?g||(g=Yi(t),g.c(),g.m(n,i)):g&&(g.d(1),g=null),1&a&&!L(o.src,s=t[0])&&y(o,"src",s),2&a&&P(l,t[1]),t[4]?f?f.p(t,a):(f=Ji(t),f.c(),f.m(n,m)):f&&(f.d(1),f=null),1==t[6]?w||(w=Qi(t),w.c(),w.m(n,null)):w&&(w.d(1),w=null),4&a&&h!==(h=R(t[2]?"gift_item_wrapper costly":"gift_item_wrapper")+" s-ZVHhKm1-25LO")&&y(n,"class",h),8&a&&A(n,"animation-delay",80*t[3]+"ms"),16&a&&u!==(u=R(t[4]?"gift_item_container bigger":"gift_item_container")+" s-ZVHhKm1-25LO")&&y(e,"class",u)},i:k,o:k,d:function(t){t&&C(e),g&&g.d(),f&&f.d(),w&&w.d()}};return p("SvelteRegisterBlock",{block:v,id:Xi.name,type:"component",source:"",ctx:t}),v}function Zi(t,e,n){let{$$slots:i={},$$scope:o}=e;f("ResultGiftItem",i,[]);let{src:s=""}=e,{num:a=1}=e,{costly:r=!1}=e,{index:c=1}=e,{isBigger:l=!1}=e,{title:d=""}=e,{hit:m=0}=e;const h=["src","num","costly","index","isBigger","title","hit"];return Object.keys(e).forEach((t=>{~h.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<ResultGiftItem> was created with unknown prop '${t}'`)})),t.$$set=t=>{"src"in t&&n(0,s=t.src),"num"in t&&n(1,a=t.num),"costly"in t&&n(2,r=t.costly),"index"in t&&n(3,c=t.index),"isBigger"in t&&n(4,l=t.isBigger),"title"in t&&n(5,d=t.title),"hit"in t&&n(6,m=t.hit)},t.$capture_state=()=>({src:s,num:a,costly:r,index:c,isBigger:l,title:d,hit:m}),t.$inject_state=t=>{"src"in t&&n(0,s=t.src),"num"in t&&n(1,a=t.num),"costly"in t&&n(2,r=t.costly),"index"in t&&n(3,c=t.index),"isBigger"in t&&n(4,l=t.isBigger),"title"in t&&n(5,d=t.title),"hit"in t&&n(6,m=t.hit)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r,c,l,d,m]}class to extends h{constructor(t){super(t),u(this,t,Zi,Xi,g,{src:0,num:1,costly:2,index:3,isBigger:4,title:5,hit:6}),p("SvelteRegisterComponent",{component:this,tagName:"ResultGiftItem",options:t,id:Xi.name})}get src(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set src(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get num(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set num(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get costly(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set costly(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get index(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set index(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get isBigger(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set isBigger(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get title(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get hit(){throw new Error("<ResultGiftItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set hit(t){throw new Error("<ResultGiftItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const eo={CRYSTAL_TYPE:866,GOLD_TYPE:873},no="https://asset.tuwan.com/goldMagic/magic_pending.svga",io="https://asset.tuwan.com/goldMagic/gold_pending.svga",oo="src/js/components/goldMagic/components/result.svelte";function so(t,e,n){const i=t.slice();return i[15]=e[n],i[17]=n,i}function ao(t){let e,n;e=new to({props:{index:t[17],num:t[15].uids[0].num,src:t[15].pic,isBigger:1==t[0].length,costly:1==t[15].gift_type,title:t[15].title,hit:t[2]==eo.GOLD_TYPE?t[15].hit:0},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.num=t[15].uids[0].num),1&n&&(i.src=t[15].pic),1&n&&(i.isBigger=1==t[0].length),1&n&&(i.costly=1==t[15].gift_type),1&n&&(i.title=t[15].title),5&n&&(i.hit=t[2]==eo.GOLD_TYPE?t[15].hit:0),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:ao.name,type:"each",source:"(174:12) {#each result as item, index}",ctx:t}),i}function ro(t){let e,n,i,o;const s={c:function(){e=_("span"),n=M("黄金魔法"),i=M(t[7]),o=M("个"),y(e,"class","s-FxhIJdg0yKQw"),x(e,oo,200,12,6530)},m:function(t,s){b(t,e,s),I(e,n),I(e,i),I(e,o)},p:function(t,e){128&e&&P(i,t[7])},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:ro.name,type:"if",source:"(200:12) {#if mode == RESULT_VIEW_TYPE.GOLD_TYPE}",ctx:t}),s}function co(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,$,k,j,D,B,F,U,z,G,H,K,Y,J,Q,X,Z,tt,et,nt,it,ot,st,at=t[0];v(at);let rt=[];for(let p=0;p<at.length;p+=1)rt[p]=ao(so(t,at,p));const ct=t=>O(rt[t],1,1,(()=>{rt[t]=null}));let lt=t[2]==eo.GOLD_TYPE&&ro(t);const dt={c:function(){e=_("div"),n=_("div"),i=_("img"),s=T(),a=_("div"),r=_("div");for(let t=0;t<rt.length;t+=1)rt[t].c();l=T(),d=_("div"),m=_("div"),m.textContent="确定",h=T(),u=_("div"),g=M("再开启"),f=M(t[1]),w=M("次"),$=T(),k=_("div"),j=_("div"),D=_("span"),B=M("我的钻石"),F=M(t[5]),U=M(" 紫晶"),z=M(t[6]),G=T(),lt&&lt.c(),H=T(),K=_("div"),Y=_("i"),J=T(),Q=_("span"),Q.textContent="开启免动画模式",tt=T(),et=_("div"),L(i.src,o="https://asset.tuwan.com/goldMagic/resultTitle.png?v1")||y(i,"src","https://asset.tuwan.com/goldMagic/resultTitle.png?v1"),y(i,"alt",""),y(i,"class","s-FxhIJdg0yKQw"),x(i,oo,161,8,5034),y(n,"class","title s-FxhIJdg0yKQw"),x(n,oo,160,4,5006),y(r,"class","result_content s-FxhIJdg0yKQw"),x(r,oo,171,8,5374),y(a,"class",c=(1==t[0].length?"flex-jc":"")+" "+(t[0].length<7?"result_wrapper scroll_bar_light_purple flex-ac":"result_wrapper scroll_bar_light_purple flex-as")+" s-FxhIJdg0yKQw"),x(a,oo,166,4,5155),y(m,"class","result_action s-FxhIJdg0yKQw"),A(m,"margin-right","10px"),x(m,oo,187,8,5955),y(u,"class","result_action s-FxhIJdg0yKQw"),x(u,oo,194,8,6119),y(d,"class","result_action_container s-FxhIJdg0yKQw"),x(d,oo,186,4,5909),y(D,"class","s-FxhIJdg0yKQw"),x(D,oo,198,12,6421),y(j,"class","result_info_content"),x(j,oo,197,8,6375),y(Y,"class","s-FxhIJdg0yKQw"),x(Y,oo,209,12,6783),y(Q,"class","s-FxhIJdg0yKQw"),x(Q,oo,210,12,6803),y(K,"class",X=R(t[4]?"result_action_ignore ignore":"result_action_ignore")+" s-FxhIJdg0yKQw"),x(K,oo,203,8,6600),y(k,"class","result_info_container s-FxhIJdg0yKQw"),y(k,"style",Z=t[2]==eo.GOLD_TYPE?"justify-content:space-evenly":"padding: 0 46px 0 41px;justify-content: space-between;"),x(k,oo,196,4,6194),y(et,"class","result_vap_anim s-FxhIJdg0yKQw"),x(et,oo,214,4,6855),y(e,"class",nt="result_container "+(t[2]==eo.CRYSTAL_TYPE?"":"glod")+" s-FxhIJdg0yKQw"),x(e,oo,154,0,4885)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,c){b(o,e,c),I(e,n),I(n,i),I(e,s),I(e,a),I(a,r);for(let t=0;t<rt.length;t+=1)rt[t]&&rt[t].m(r,null);I(e,l),I(e,d),I(d,m),I(d,h),I(d,u),I(u,g),I(u,f),I(u,w),I(e,$),I(e,k),I(k,j),I(j,D),I(D,B),I(D,F),I(D,U),I(D,z),I(j,G),lt&&lt.m(j,null),I(k,H),I(k,K),I(K,Y),I(K,J),I(K,Q),I(e,tt),I(e,et),t[12](et),it=!0,ot||(st=[E(m,"click",t[8],!1,!1,!1,!1),E(u,"click",t[10],!1,!1,!1,!1),E(K,"click",t[9],!1,!1,!1,!1)],ot=!0)},p:function(t,[n]){if(5&n){let e;for(at=t[0],v(at),e=0;e<at.length;e+=1){const i=so(t,at,e);rt[e]?(rt[e].p(i,n),q(rt[e],1)):(rt[e]=ao(i),rt[e].c(),q(rt[e],1),rt[e].m(r,null))}for(W(),e=at.length;e<rt.length;e+=1)ct(e);N()}(!it||1&n&&c!==(c=(1==t[0].length?"flex-jc":"")+" "+(t[0].length<7?"result_wrapper scroll_bar_light_purple flex-ac":"result_wrapper scroll_bar_light_purple flex-as")+" s-FxhIJdg0yKQw"))&&y(a,"class",c),(!it||2&n)&&P(f,t[1]),(!it||32&n)&&P(F,t[5]),(!it||64&n)&&P(z,t[6]),t[2]==eo.GOLD_TYPE?lt?lt.p(t,n):(lt=ro(t),lt.c(),lt.m(j,null)):lt&&(lt.d(1),lt=null),(!it||16&n&&X!==(X=R(t[4]?"result_action_ignore ignore":"result_action_ignore")+" s-FxhIJdg0yKQw"))&&y(K,"class",X),(!it||4&n&&Z!==(Z=t[2]==eo.GOLD_TYPE?"justify-content:space-evenly":"padding: 0 46px 0 41px;justify-content: space-between;"))&&y(k,"style",Z),(!it||4&n&&nt!==(nt="result_container "+(t[2]==eo.CRYSTAL_TYPE?"":"glod")+" s-FxhIJdg0yKQw"))&&y(e,"class",nt)},i:function(t){if(!it){for(let t=0;t<at.length;t+=1)q(rt[t]);it=!0}},o:function(t){rt=rt.filter(Boolean);for(let e=0;e<rt.length;e+=1)O(rt[e]);it=!1},d:function(n){n&&C(e),S(rt,n),lt&&lt.d(),t[12](null),ot=!1,V(st)}};return p("SvelteRegisterBlock",{block:dt,id:co.name,type:"component",source:"",ctx:t}),dt}function lo(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Result",i,[]);let s,{num:a=10}=e,{result:r=[]}=e,{onClose:c}=e,{mode:l=eo.CRYSTAL_TYPE}=e,d=!1,m="0",h="0",u="0",p=!1;function g(){p||c()}function v(){p||(d?xt.getInstance().setGoldMagicAnimIgnore("0"):xt.getInstance().setGoldMagicAnimIgnore("1"),n(4,d=!d))}function _(t=0){if(p)return;p=!0;const e=uu.getCid(),i=uu.getSelfInfo().uid;let o="";if(l==eo.CRYSTAL_TYPE){const n={giftid:l,num:a,uids:i,cid:e,pay_confirm:1,pay_sure:t};let s=[];for(let t in n)s.push(t+"="+n[t]);const r="anonymous=0&actid=100&platform=0&"+s.join("&");o=Ot.payBaobox(r)}else o=Ot.openGoldGift(l,e,1,t);qt.get(o).then((t=>{if(0==t.error)if(setTimeout((()=>{window.$(".chat-center-gift-tab .gift-selected").trigger("click")}),500),n(0,r=[]),d)setTimeout((()=>{n(0,r=t.data)}),0),y();else{const e="https://asset.tuwan.com/goldMagic/"+(l==eo.CRYSTAL_TYPE?"crystal/":"glod/"),i=new Xt;i.play({url:e+"video.mp4?v2",ele:s,config:e+"vapc.json?v2"}).then((()=>{n(0,r=t.data),y()})).finally((()=>{i.destory(),p=!1}))}else-2==t.error?(Vt("您的钻石和点点币不足，请充值"),p=!1):199==t.error?p=!1:-1100==t.error?(p=!1,de.getInstance().show("温馨提示",t.data[0].tips,!1,"取消","确认",(()=>{_(a,de.getInstance().choiceStatus)}),(()=>{}),{desAlign:"center",choiceText:t.data[0].remark,choice:"show"})):(Vt(t.error_msg),p=!1)}))}function y(){qt.get(Ot.getTreasureInfo(l)).then((t=>{p=!1,0==t.error?(n(5,m=t.data.diamond_str),n(6,h=t.data.number_str),n(7,u=t.data.glod_num)):Vt(t.error_msg)}))}w((()=>{n(4,d="1"==xt.getInstance().getGoldMagicAnimIgnore()),y()})),t.$$.on_mount.push((function(){void 0!==c||"onClose"in e||t.$$.bound[t.$$.props.onClose]||console.warn("<Result> was created without expected prop 'onClose'")}));const x=["num","result","onClose","mode"];return Object.keys(e).forEach((t=>{~x.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Result> was created with unknown prop '${t}'`)})),t.$$set=t=>{"num"in t&&n(1,a=t.num),"result"in t&&n(0,r=t.result),"onClose"in t&&n(11,c=t.onClose),"mode"in t&&n(2,l=t.mode)},t.$capture_state=()=>({onMount:w,common:uu,request:qt,VapPlayer:Xt,ChatUrls:Ot,ResultGiftItem:to,RESULT_VIEW_TYPE:eo,SessionStorage:xt,showTips:Vt,ConfirmModal:de,num:a,result:r,onClose:c,mode:l,animEl:s,isIgnore:d,diamondStr:m,numberStr:h,glodNum:u,loading:p,onCloseHandle:g,onIgnoreHandle:v,onBuy:_,getTreasureInfo:y}),t.$inject_state=t=>{"num"in t&&n(1,a=t.num),"result"in t&&n(0,r=t.result),"onClose"in t&&n(11,c=t.onClose),"mode"in t&&n(2,l=t.mode),"animEl"in t&&n(3,s=t.animEl),"isIgnore"in t&&n(4,d=t.isIgnore),"diamondStr"in t&&n(5,m=t.diamondStr),"numberStr"in t&&n(6,h=t.numberStr),"glodNum"in t&&n(7,u=t.glodNum),"loading"in t&&(p=t.loading)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,a,l,s,d,m,h,u,g,v,_,c,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(3,s)}))}]}class mo extends h{constructor(t){super(t),u(this,t,lo,co,g,{num:1,result:0,onClose:11,mode:2}),p("SvelteRegisterComponent",{component:this,tagName:"Result",options:t,id:co.name})}get num(){throw new Error("<Result>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set num(t){throw new Error("<Result>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get result(){throw new Error("<Result>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set result(t){throw new Error("<Result>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get onClose(){throw new Error("<Result>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set onClose(t){throw new Error("<Result>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get mode(){throw new Error("<Result>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set mode(t){throw new Error("<Result>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ho="src/js/components/goldMagic/components/history.svelte";function uo(t,e,n){const i=t.slice();return i[9]=e[n],i}function po(t){let e;const n={c:function(){e=_("div"),e.textContent="还未有开启魔法记录",y(e,"class","noDataTipCtn s-k7TnOB86mce0"),x(e,ho,63,16,1858)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:po.name,type:"if",source:"(63:12) {#if list.length == 0}",ctx:t}),n}function go(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g=t[9].dates+"",f=t[9].icon_num+"",w=t[9].gift_num+"";const v={c:function(){e=_("div"),n=M(g),i=M("开启"),o=_("img"),a=M("×"),r=M(f),c=M("，获得"),l=_("img"),m=M("×"),h=M(w),u=T(),y(o,"alt",""),L(o.src,s=t[9].icon)||y(o,"src",s),y(o,"class","s-k7TnOB86mce0"),x(o,ho,67,34,2036),y(l,"alt",""),L(l.src,d=t[9].gift)||y(l,"src",d),y(l,"class","s-k7TnOB86mce0"),x(l,ho,67,83,2085),y(e,"class","history_content_item s-k7TnOB86mce0"),x(e,ho,66,16,1967)},m:function(t,s){b(t,e,s),I(e,n),I(e,i),I(e,o),I(e,a),I(e,r),I(e,c),I(e,l),I(e,m),I(e,h),I(e,u)},p:function(t,e){2&e&&g!==(g=t[9].dates+"")&&P(n,g),2&e&&!L(o.src,s=t[9].icon)&&y(o,"src",s),2&e&&f!==(f=t[9].icon_num+"")&&P(r,f),2&e&&!L(l.src,d=t[9].gift)&&y(l,"src",d),2&e&&w!==(w=t[9].gift_num+"")&&P(h,w)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:v,id:go.name,type:"each",source:"(66:12) {#each list as item}",ctx:t}),v}function fo(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g=0==t[1].length&&po(t),f=t[1];v(f);let w=[];for(let p=0;p<f.length;p+=1)w[p]=go(uo(t,f,p));const $={c:function(){e=_("div"),n=_("div"),i=_("img"),s=T(),a=_("div"),r=_("div"),g&&g.c(),c=T();for(let t=0;t<w.length;t+=1)w[t].c();l=T(),d=_("div"),d.textContent="关闭",L(i.src,o="https://asset.tuwan.com/goldMagic/resultTitle.png?v1")||y(i,"src","https://asset.tuwan.com/goldMagic/resultTitle.png?v1"),y(i,"alt",""),y(i,"class","s-k7TnOB86mce0"),x(i,ho,58,8,1601),y(n,"class","title s-k7TnOB86mce0"),x(n,ho,57,4,1573),y(r,"class","history_content s-k7TnOB86mce0"),x(r,ho,61,8,1777),y(a,"class","history_wrapper scroll_bar_light_purple s-k7TnOB86mce0"),x(a,ho,60,4,1690),y(d,"class","history_close_button s-k7TnOB86mce0"),x(d,ho,76,4,2274),y(e,"class",m="history_container "+(t[0]==eo.CRYSTAL_TYPE?"":"glod")+" s-k7TnOB86mce0"),x(e,ho,56,0,1483)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,m){b(o,e,m),I(e,n),I(n,i),I(e,s),I(e,a),I(a,r),g&&g.m(r,null),I(r,c);for(let t=0;t<w.length;t+=1)w[t]&&w[t].m(r,null);I(e,l),I(e,d),h||(u=[E(a,"scroll",t[2],!1,!1,!1,!1),E(d,"click",t[3],!1,!1,!1,!1)],h=!0)},p:function(t,[n]){if(0==t[1].length?g||(g=po(t),g.c(),g.m(r,c)):g&&(g.d(1),g=null),2&n){let e;for(f=t[1],v(f),e=0;e<f.length;e+=1){const i=uo(t,f,e);w[e]?w[e].p(i,n):(w[e]=go(i),w[e].c(),w[e].m(r,null))}for(;e<w.length;e+=1)w[e].d(1);w.length=f.length}1&n&&m!==(m="history_container "+(t[0]==eo.CRYSTAL_TYPE?"":"glod")+" s-k7TnOB86mce0")&&y(e,"class",m)},i:k,o:k,d:function(t){t&&C(e),g&&g.d(),S(w,t),h=!1,V(u)}};return p("SvelteRegisterBlock",{block:$,id:fo.name,type:"component",source:"",ctx:t}),$}function wo(t,e,n){let{$$slots:i={},$$scope:o}=e;f("History",i,[]);let{mode:s=eo.CRYSTAL_TYPE}=e,{onClose:a}=e,r=1,c=0,l=[],d=!1;function m(t){const{scrollTop:e,clientHeight:n,scrollHeight:i}=t.target;e+n+10>i&&h(r+1)}function h(t){t>c&&0!=c||d||(d=!0,qt.get(Ot.getTreasureRecord(s,t)).then((e=>{d=!1,0==e.error?(r=t,c=e.totalPage,n(1,l=l.concat(e.data))):Vt(e.error_msg)})).catch((()=>{d=!1})))}function u(){a()}w((()=>{h(1)})),t.$$.on_mount.push((function(){void 0!==a||"onClose"in e||t.$$.bound[t.$$.props.onClose]||console.warn("<History> was created without expected prop 'onClose'")}));const p=["mode","onClose"];return Object.keys(e).forEach((t=>{~p.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<History> was created with unknown prop '${t}'`)})),t.$$set=t=>{"mode"in t&&n(0,s=t.mode),"onClose"in t&&n(4,a=t.onClose)},t.$capture_state=()=>({onMount:w,ChatUrls:Ot,common:uu,request:qt,RESULT_VIEW_TYPE:eo,showTips:Vt,mode:s,onClose:a,currentPage:r,totalPage:c,list:l,loading:d,handleScroll:m,onLoadRecord:h,onCloseHandle:u}),t.$inject_state=t=>{"mode"in t&&n(0,s=t.mode),"onClose"in t&&n(4,a=t.onClose),"currentPage"in t&&(r=t.currentPage),"totalPage"in t&&(c=t.totalPage),"list"in t&&n(1,l=t.list),"loading"in t&&(d=t.loading)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,l,m,u,a]}class vo extends h{constructor(t){super(t),u(this,t,wo,fo,g,{mode:0,onClose:4}),p("SvelteRegisterComponent",{component:this,tagName:"History",options:t,id:fo.name})}get mode(){throw new Error("<History>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set mode(t){throw new Error("<History>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get onClose(){throw new Error("<History>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set onClose(t){throw new Error("<History>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function _o(t){let e;const n={c:function(){e=_("div"),e.textContent="hello",x(e,"src/js/components/goldMagic/components/hello.svelte",4,0,25)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,n){b(t,e,n)},p:k,i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:_o.name,type:"component",source:"",ctx:t}),n}function yo(t,e){let{$$slots:n={},$$scope:i}=e;f("Hello",n,[]);const o=[];return Object.keys(e).forEach((t=>{~o.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Hello> was created with unknown prop '${t}'`)})),[]}class xo extends h{constructor(t){super(t),u(this,t,yo,_o,g,{}),p("SvelteRegisterComponent",{component:this,tagName:"Hello",options:t,id:_o.name})}}const bo="src/js/bgm/components/alert.svelte";function $o(t){let e,n,i,o,s,a,r,c,l,d;const m={c:function(){e=_("div"),n=_("div"),i=_("p"),o=M(t[1]),s=T(),a=_("input"),r=T(),c=_("p"),c.textContent="确认",y(i,"class","title s-FOQYcNaLmVEc"),x(i,bo,16,8,412),y(a,"placeholder",t[2]),y(a,"maxlength",t[3]),y(a,"class","s-FOQYcNaLmVEc"),x(a,bo,17,8,449),y(c,"class","btn s-FOQYcNaLmVEc"),x(c,bo,18,8,525),y(n,"class","body s-FOQYcNaLmVEc"),x(n,bo,15,4,360),y(e,"class","bgm_alert s-FOQYcNaLmVEc"),x(e,bo,14,0,294)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(m,h){b(m,e,h),I(e,n),I(n,i),I(i,o),I(n,s),I(n,a),J(a,t[0]),I(n,r),I(n,c),l||(d=[E(a,"input",t[8]),E(c,"click",B(t[5]),!1,!1,!0,!1),E(n,"click",B(t[7]),!1,!1,!0,!1),E(e,"click",B((function(){H(t[4])&&t[4].apply(this,arguments)})),!1,!1,!0,!1)],l=!0)},p:function(e,[n]){t=e,2&n&&P(o,t[1]),4&n&&y(a,"placeholder",t[2]),8&n&&y(a,"maxlength",t[3]),1&n&&a.value!==t[0]&&J(a,t[0])},i:k,o:k,d:function(t){t&&C(e),l=!1,V(d)}};return p("SvelteRegisterBlock",{block:m,id:$o.name,type:"component",source:"",ctx:t}),m}function ko(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Alert",i,[]);let{title:s=""}=e,{value:a=""}=e,{placeholder:r=""}=e,{maxLength:c=5}=e,{confirmCb:l}=e,{closeModal:d}=e;function m(){d&&d(),l&&l(a)}t.$$.on_mount.push((function(){void 0!==l||"confirmCb"in e||t.$$.bound[t.$$.props.confirmCb]||console.warn("<Alert> was created without expected prop 'confirmCb'"),void 0!==d||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<Alert> was created without expected prop 'closeModal'")}));const h=["title","value","placeholder","maxLength","confirmCb","closeModal"];return Object.keys(e).forEach((t=>{~h.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Alert> was created with unknown prop '${t}'`)})),t.$$set=t=>{"title"in t&&n(1,s=t.title),"value"in t&&n(0,a=t.value),"placeholder"in t&&n(2,r=t.placeholder),"maxLength"in t&&n(3,c=t.maxLength),"confirmCb"in t&&n(6,l=t.confirmCb),"closeModal"in t&&n(4,d=t.closeModal)},t.$capture_state=()=>({title:s,value:a,placeholder:r,maxLength:c,confirmCb:l,closeModal:d,confirmClick:m}),t.$inject_state=t=>{"title"in t&&n(1,s=t.title),"value"in t&&n(0,a=t.value),"placeholder"in t&&n(2,r=t.placeholder),"maxLength"in t&&n(3,c=t.maxLength),"confirmCb"in t&&n(6,l=t.confirmCb),"closeModal"in t&&n(4,d=t.closeModal)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,s,r,c,d,m,l,function(e){F.call(this,t,e)},function(){a=this.value,n(0,a)}]}let Co=class extends h{constructor(t){super(t),u(this,t,ko,$o,g,{title:1,value:0,placeholder:2,maxLength:3,confirmCb:6,closeModal:4}),p("SvelteRegisterComponent",{component:this,tagName:"Alert",options:t,id:$o.name})}get title(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get value(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get placeholder(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set placeholder(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get maxLength(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set maxLength(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get confirmCb(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set confirmCb(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get closeModal(){throw new Error("<Alert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<Alert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const Io="src/js/components/goldMagic/components/magic.svelte";function So(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A,j=(t[0]?t[0].unit_price:"")+"",D=(t[0]?10*t[0].unit_price:"")+"";const B={c:function(){e=_("div"),n=_("div"),i=_("div"),o=_("img"),a=T(),r=_("span"),c=M(j),l=T(),d=_("div"),d.textContent="开启1次",m=T(),h=_("div"),u=_("div"),g=_("img"),w=T(),v=_("span"),$=M(D),k=T(),S=_("div"),S.textContent="开启10次",y(o,"class","icon s-IxbgElSsLyeu"),L(o.src,s="https://asset.tuwan.com/goldMagic/magicIcon.png")||y(o,"src","https://asset.tuwan.com/goldMagic/magicIcon.png"),x(o,Io,255,24,8682),y(r,"class","numCtn s-IxbgElSsLyeu"),x(r,Io,259,24,8861),y(i,"class","leftCtn s-IxbgElSsLyeu"),x(i,Io,254,20,8636),y(d,"class","rightCtn s-IxbgElSsLyeu"),x(d,Io,263,20,9026),y(n,"class","normalBtn s-IxbgElSsLyeu"),x(n,Io,248,16,8451),y(g,"class","icon s-IxbgElSsLyeu"),L(g.src,f="https://asset.tuwan.com/goldMagic/magicIcon.png")||y(g,"src","https://asset.tuwan.com/goldMagic/magicIcon.png"),x(g,Io,272,24,9330),y(v,"class","numCtn s-IxbgElSsLyeu"),x(v,Io,276,24,9509),y(u,"class","leftCtn s-IxbgElSsLyeu"),x(u,Io,271,20,9284),y(S,"class","rightCtn s-IxbgElSsLyeu"),x(S,Io,280,20,9679),y(h,"class","normalBtn s-IxbgElSsLyeu"),x(h,Io,265,16,9098),y(e,"class","buttonCtn s-IxbgElSsLyeu"),x(e,Io,247,12,8411)},m:function(s,p){b(s,e,p),I(e,n),I(n,i),I(i,o),I(i,a),I(i,r),I(r,c),I(n,l),I(n,d),I(e,m),I(e,h),I(h,u),I(u,g),I(u,w),I(u,v),I(v,$),I(h,k),I(h,S),R||(A=[E(n,"click",t[14],!1,!1,!1,!1),E(h,"click",t[15],!1,!1,!1,!1)],R=!0)},p:function(t,e){1&e&&j!==(j=(t[0]?t[0].unit_price:"")+"")&&P(c,j),1&e&&D!==(D=(t[0]?10*t[0].unit_price:"")+"")&&P($,D)},d:function(t){t&&C(e),R=!1,V(A)}};return p("SvelteRegisterBlock",{block:B,id:So.name,type:"else",source:"(246:8) {:else}",ctx:t}),B}function To(t){let e,n,i,o,s,a,r,c,l,d,m=t[2]&&Ro(t);const h={c:function(){e=_("div"),n=_("div"),i=_("div"),o=_("input"),s=T(),a=_("div"),m&&m.c(),r=T(),c=_("div"),c.textContent="开启",y(o,"class","inp s-IxbgElSsLyeu"),y(o,"placeholder","输入数量"),y(o,"type","number"),x(o,Io,223,24,7498),y(a,"class","s-IxbgElSsLyeu"),x(a,Io,232,24,7886),y(i,"class","inputNumWarpper s-IxbgElSsLyeu"),x(i,Io,222,20,7444),y(c,"class","smallBtnCtn s-IxbgElSsLyeu"),x(c,Io,240,20,8202),y(n,"class","inputNumCtn s-IxbgElSsLyeu"),x(n,Io,221,16,7398),y(e,"class","buttonCtn s-IxbgElSsLyeu"),A(e,"display","flex"),A(e,"justify-content","center"),x(e,Io,211,12,6840)},m:function(h,u){b(h,e,u),I(e,n),I(n,i),I(i,o),J(o,t[2]),I(i,s),I(i,a),m&&m.m(a,null),I(n,r),I(n,c),l||(d=[E(o,"input",t[12]),E(o,"input",t[13],!1,!1,!1,!1),E(c,"click",t[7],!1,!1,!1,!1)],l=!0)},p:function(t,e){4&e&&Q(o.value)!==t[2]&&J(o,t[2]),t[2]?m?m.p(t,e):(m=Ro(t),m.c(),m.m(a,null)):m&&(m.d(1),m=null)},d:function(t){t&&C(e),m&&m.d(),l=!1,V(d)}};return p("SvelteRegisterBlock",{block:h,id:To.name,type:"if",source:"(210:8) {#if radioIsSelected}",ctx:t}),h}function Ro(t){let e,n,i,o=188*t[2]+"";const s={c:function(){e=_("span"),n=M(o),i=M("紫晶"),x(e,Io,234,32,7964)},m:function(t,o){b(t,e,o),I(e,n),I(e,i)},p:function(t,e){4&e&&o!==(o=188*t[2]+"")&&P(n,o)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:Ro.name,type:"if",source:"(234:28) {#if times}",ctx:t}),s}function Mo(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,S,A,j,D,B,F,U,z,O,N,q,G,V,H,W,K,Y,J,Q,X,Z,tt,et,nt,it,ot,st,at,rt,ct,lt,dt=(t[0]?t[0].hit_tips:"")+"",mt=(t[0]?t[0].diamond_str:"")+"",ht=(t[0]?t[0].number_str:"")+"";function ut(t,e){return t[4]?To:So}let pt=ut(t),gt=pt(t);const ft={c:function(){e=_("div"),n=_("img"),o=T(),s=_("div"),a=T(),r=_("div"),c=_("div"),l=_("img"),m=_("span"),h=M(mt),u=T(),g=_("div"),f=_("img"),v=_("span"),$=M(ht),S=T(),A=_("div"),j=T(),D=_("div"),B=T(),F=_("div"),U=_("div"),z=T(),O=_("div"),N=T(),q=_("div"),G=T(),V=_("div"),H=_("div"),W=T(),gt.c(),K=T(),Y=_("div"),J=_("div"),J.textContent="紫晶礼物赠送后不能提现",Q=T(),X=_("div"),Z=_("span"),tt=_("img"),nt=T(),it=_("img"),st=T(),at=_("span"),at.textContent="自定义开启数量",y(n,"class","title s-IxbgElSsLyeu"),L(n.src,i="https://asset.tuwan.com/goldMagic/magicTitle.png")||y(n,"src","https://asset.tuwan.com/goldMagic/magicTitle.png"),x(n,Io,175,4,5586),y(s,"class","subTitle s-IxbgElSsLyeu"),x(s,Io,176,4,5667),y(l,"class","imgIcon s-IxbgElSsLyeu"),L(l.src,d="https://asset.tuwan.com/goldMagic/diamondTabIcon.png")||y(l,"src","https://asset.tuwan.com/goldMagic/diamondTabIcon.png"),x(l,Io,181,12,5820),y(m,"class","wordCtn s-IxbgElSsLyeu"),x(m,Io,184,14,5946),y(c,"class","subCtn s-IxbgElSsLyeu"),x(c,Io,180,8,5787),y(f,"class","imgIcon s-IxbgElSsLyeu"),L(f.src,w="https://asset.tuwan.com/goldMagic/magicTabIcon.png")||y(f,"src","https://asset.tuwan.com/goldMagic/magicTabIcon.png"),x(f,Io,187,12,6068),y(v,"class","wordCtn s-IxbgElSsLyeu"),x(v,Io,190,14,6192),y(g,"class","subCtn s-IxbgElSsLyeu"),x(g,Io,186,8,6035),y(r,"class","leftTopCtn s-IxbgElSsLyeu"),x(r,Io,179,4,5754),y(A,"class","fireSvgaCtnMagic s-IxbgElSsLyeu"),x(A,Io,194,4,6288),y(D,"class","result_vap_anim s-IxbgElSsLyeu"),x(D,Io,196,4,6330),y(U,"class","fireCtn s-IxbgElSsLyeu"),x(U,Io,199,8,6426),y(O,"class","mainImgCtn mainImgCtnMagic s-IxbgElSsLyeu"),x(O,Io,200,8,6462),y(q,"class","mainSvgaCtn s-IxbgElSsLyeu"),x(q,Io,203,8,6627),y(F,"class","mainShowerCtn s-IxbgElSsLyeu"),x(F,Io,198,4,6390),y(H,"class","topTipsCtn s-IxbgElSsLyeu"),x(H,Io,206,8,6703),y(J,"class","subTips s-IxbgElSsLyeu"),x(J,Io,288,12,9945),y(tt,"class","radioImg default s-IxbgElSsLyeu"),L(tt.src,et="https://asset.tuwan.com/goldMagic/radioDefault.png")||y(tt,"src","https://asset.tuwan.com/goldMagic/radioDefault.png"),x(tt,Io,294,20,10190),y(it,"class","radioImg selected s-IxbgElSsLyeu"),L(it.src,ot="https://asset.tuwan.com/goldMagic/radioSelect.png")||y(it,"src","https://asset.tuwan.com/goldMagic/radioSelect.png"),x(it,Io,298,20,10368),y(Z,"class","spCtn s-IxbgElSsLyeu"),x(Z,Io,293,16,10149),y(at,"class","changeWordCtn s-IxbgElSsLyeu"),x(at,Io,303,16,10566),y(X,"class",rt=R(t[4]?"radioCtn active":"radioCtn")+" s-IxbgElSsLyeu"),x(X,Io,289,12,9996),y(Y,"class","footerBottomCtn s-IxbgElSsLyeu"),x(Y,Io,287,8,9903),y(V,"class","footer s-IxbgElSsLyeu"),x(V,Io,205,4,6674),y(e,"class","MagicCtn s-IxbgElSsLyeu"),x(e,Io,174,0,5559)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,d){b(i,e,d),I(e,n),I(e,o),I(e,s),s.innerHTML=dt,I(e,a),I(e,r),I(r,c),I(c,l),I(c,m),I(m,h),I(r,u),I(r,g),I(g,f),I(g,v),I(v,$),I(e,S),I(e,A),I(e,j),I(e,D),t[11](D),I(e,B),I(e,F),I(F,U),I(F,z),I(F,O),I(F,N),I(F,q),I(e,G),I(e,V),I(V,H),H.innerHTML=t[1],I(V,W),gt.m(V,null),I(V,K),I(V,Y),I(Y,J),I(Y,Q),I(Y,X),I(X,Z),I(Z,tt),I(Z,nt),I(Z,it),I(X,st),I(X,at),ct||(lt=E(X,"click",t[5],!1,!1,!1,!1),ct=!0)},p:function(t,[e]){1&e&&dt!==(dt=(t[0]?t[0].hit_tips:"")+"")&&(s.innerHTML=dt),1&e&&mt!==(mt=(t[0]?t[0].diamond_str:"")+"")&&P(h,mt),1&e&&ht!==(ht=(t[0]?t[0].number_str:"")+"")&&P($,ht),2&e&&(H.innerHTML=t[1]),pt===(pt=ut(t))&&gt?gt.p(t,e):(gt.d(1),gt=pt(t),gt&&(gt.c(),gt.m(V,K))),16&e&&rt!==(rt=R(t[4]?"radioCtn active":"radioCtn")+" s-IxbgElSsLyeu")&&y(X,"class",rt)},i:k,o:k,d:function(n){n&&C(e),t[11](null),gt.d(),ct=!1,lt()}};return p("SvelteRegisterBlock",{block:ft,id:Mo.name,type:"component",source:"",ctx:t}),ft}function Ao(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Magic",i,[]);let s,a,r,{resData:c=null}=e,{handleSetResult:l}=e,{flag:d=0}=e,m="",h=!1,u=[],p=eo.CRYSTAL_TYPE,g=!1,v=function(){n(4,g=!g),g||(a=1,n(2,s=void 0))},_=async function(t=1){h||(h=!0,a=t,u=[],b(t))},y=function(){Zt.getInstance().playEver(".fireSvgaCtnMagic","https://asset.tuwan.com/goldMagic/fire_magic.svga","magicFire")},{handleGetGiftInfo:x=async function(){let t=p;const e=await qt.get(Ot.getGoldMagicInfo(t));0==e.error&&(n(0,c=e.data),1==c.is_hit?y():(Zt.getInstance().clearPlayer("magicFire"),window.$(".fireSvgaCtnMagic").empty()))}}=e;function b(t,e=0){const n=uu.getCid();qt.get(Ot.openMagicGift(p,n,t,e)).then((e=>{if(0==e.error){if(setTimeout((()=>{window.$(".chat-center-gift-tab .gift-selected").trigger("click")}),500),u=e.data,0==(xt.getInstance().getGoldMagicAnimIgnore()||0)){const t="https://asset.tuwan.com/goldMagic/"+(p==eo.CRYSTAL_TYPE?"crystal/":"glod/"),e=new Xt;e.play({url:t+"video.mp4?v2",ele:r,config:t+"vapc.json?v2"}).then((()=>{h=!1,x()})).finally((()=>{e.destory()})),setTimeout((()=>{l(u,s||a),window.$(".result_vap_anim").empty()}),1100)}else h=!1,x(),l(u,s||a)}else-2==e.error?(h=!1,Vt("您的钻石和点点币不足，请充值")):199==e.error?h=!1:-1100==e.error?(h=!1,de.getInstance().show("温馨提示",e.data[0].tips,!1,"取消","确认",(()=>{b(t,de.getInstance().choiceStatus?2:1)}),(()=>{}),{desAlign:"center",choiceText:e.data[0].remark,choice:"show"})):(h=!1,Vt(e.error_msg))}))}let $=function(){s?_(s):Vt("请填写数量")};w((()=>{x(),Zt.getInstance().playEver(".mainImgCtnMagic",no,"pendingSvga")})),t.$$.on_mount.push((function(){void 0!==l||"handleSetResult"in e||t.$$.bound[t.$$.props.handleSetResult]||console.warn("<Magic> was created without expected prop 'handleSetResult'")}));const k=["resData","handleSetResult","flag","handleGetGiftInfo"];Object.keys(e).forEach((t=>{~k.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Magic> was created with unknown prop '${t}'`)}));return t.$$set=t=>{"resData"in t&&n(0,c=t.resData),"handleSetResult"in t&&n(8,l=t.handleSetResult),"flag"in t&&n(9,d=t.flag),"handleGetGiftInfo"in t&&n(10,x=t.handleGetGiftInfo)},t.$capture_state=()=>({onMount:w,common:uu,request:qt,ChatUrls:Ot,VapPlayer:Xt,SessionStorage:xt,showTips:Vt,ConfirmModal:de,RESULT_VIEW_TYPE:eo,magic_pending_svga:no,gold_pending_svga:io,SvgaPlayer:Zt,Alert:Co,resData:c,handleSetResult:l,flag:d,tipsStr:m,times:s,spTimes:a,isGoing:h,animEl:r,result:u,mode:p,radioIsSelected:g,handleChangeRadio:v,handleOpenGift:_,openFire:y,handleGetGiftInfo:x,onBuy:b,handleOpenAnyTimes:$}),t.$inject_state=t=>{"resData"in t&&n(0,c=t.resData),"handleSetResult"in t&&n(8,l=t.handleSetResult),"flag"in t&&n(9,d=t.flag),"tipsStr"in t&&n(1,m=t.tipsStr),"times"in t&&n(2,s=t.times),"spTimes"in t&&(a=t.spTimes),"isGoing"in t&&(h=t.isGoing),"animEl"in t&&n(3,r=t.animEl),"result"in t&&(u=t.result),"mode"in t&&(p=t.mode),"radioIsSelected"in t&&n(4,g=t.radioIsSelected),"handleChangeRadio"in t&&n(5,v=t.handleChangeRadio),"handleOpenGift"in t&&n(6,_=t.handleOpenGift),"openFire"in t&&(y=t.openFire),"handleGetGiftInfo"in t&&n(10,x=t.handleGetGiftInfo),"handleOpenAnyTimes"in t&&n(7,$=t.handleOpenAnyTimes)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(1537&t.$$.dirty){let t="";null==c||c.contentArr.forEach((e=>{t+=`<span style="color: ${e.color}">${e.txt}</span>`})),n(1,m=t),parseInt(localStorage.getItem("goldMagicFlag"))!=d&&(localStorage.setItem("goldMagicFlag",d+""),x())}},[c,m,s,r,g,v,_,$,l,d,x,function(t){Y[t?"unshift":"push"]((()=>{r=t,n(3,r)}))},function(){s=Q(this.value),n(2,s)},t=>{n(2,s=t.target.value.slice(0,6))},()=>{_(1)},()=>{_(10)}]}class Po extends h{constructor(t){super(t),u(this,t,Ao,Mo,g,{resData:0,handleSetResult:8,flag:9,handleGetGiftInfo:10}),p("SvelteRegisterComponent",{component:this,tagName:"Magic",options:t,id:Mo.name})}get resData(){throw new Error("<Magic>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set resData(t){throw new Error("<Magic>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get handleSetResult(){throw new Error("<Magic>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handleSetResult(t){throw new Error("<Magic>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get flag(){throw new Error("<Magic>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set flag(t){throw new Error("<Magic>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get handleGetGiftInfo(){throw new Error("<Magic>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handleGetGiftInfo(t){throw new Error("<Magic>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const jo="src/js/components/goldMagic/components/gold.svelte";function Do(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,S,R,A,j,D,B,F,U,z,O,N,q,G,H,W,K,Y,J,Q,X,Z,tt,et,nt,it,ot,st,at,rt,ct,lt,dt,mt,ht,ut,pt,gt,ft,wt,vt,_t=(t[0]?t[0].diamond_str:"")+"",yt=(t[0]?t[0].number_str:"")+"",xt=(t[0]?t[0].glod_num:"")+"",bt=(t[0]?t[0].remark:"")+"";const $t={c:function(){var p,b;e=_("div"),n=_("img"),o=T(),s=_("div"),a=_("div"),r=_("img"),l=_("span"),d=M(_t),m=T(),h=_("div"),u=_("img"),f=_("span"),w=M(yt),v=T(),$=_("div"),S=_("img"),A=_("span"),j=M(xt),D=M("个"),B=T(),F=_("div"),U=T(),z=_("div"),O=T(),N=_("div"),q=_("div"),G=T(),H=_("div"),W=T(),K=_("div"),Y=T(),J=_("div"),Q=_("div"),X=_("div"),tt=T(),et=_("div"),nt=T(),it=_("div"),ot=_("div"),st=_("span"),at=_("img"),ct=T(),lt=_("span"),lt.textContent="680",dt=M("\n               开启魔法"),mt=T(),ht=_("div"),ut=T(),pt=_("div"),gt=_("div"),ft=M(bt),y(n,"class","title s-ZhgRSzzXxF2B"),L(n.src,i="https://asset.tuwan.com/goldMagic/goldTitle.png")||y(n,"src","https://asset.tuwan.com/goldMagic/goldTitle.png"),x(n,jo,149,4,5378),y(r,"class","imgIcon s-ZhgRSzzXxF2B"),L(r.src,c="https://asset.tuwan.com/goldMagic/diamondTabIcon.png")||y(r,"src","https://asset.tuwan.com/goldMagic/diamondTabIcon.png"),x(r,jo,153,12,5580),y(l,"class","wordCtn s-ZhgRSzzXxF2B"),x(l,jo,153,93,5661),y(a,"class","subCtn s-ZhgRSzzXxF2B"),x(a,jo,152,8,5547),y(u,"class","imgIcon s-ZhgRSzzXxF2B"),L(u.src,g="https://asset.tuwan.com/goldMagic/magicTabIcon.png")||y(u,"src","https://asset.tuwan.com/goldMagic/magicTabIcon.png"),x(u,jo,156,12,5783),y(f,"class","wordCtn s-ZhgRSzzXxF2B"),x(f,jo,156,91,5862),y(h,"class","subCtn s-ZhgRSzzXxF2B"),x(h,jo,155,8,5750),y(S,"class","imgIcon s-ZhgRSzzXxF2B"),L(S.src,R="https://asset.tuwan.com/goldMagic/goldBook.png")||y(S,"src","https://asset.tuwan.com/goldMagic/goldBook.png"),x(S,jo,159,12,5983),y(A,"class","wordCtn s-ZhgRSzzXxF2B"),x(A,jo,159,87,6058),y($,"class","subCtn s-ZhgRSzzXxF2B"),x($,jo,158,8,5950),y(s,"class","leftTopCtn s-ZhgRSzzXxF2B"),x(s,jo,151,4,5514),y(F,"class","fireSvgaCtn s-ZhgRSzzXxF2B"),x(F,jo,163,4,6156),y(z,"class","result_vap_anim s-ZhgRSzzXxF2B"),x(z,jo,165,4,6193),y(q,"class","fireCtn"),x(q,jo,168,8,6289),y(H,"class","mainImgCtn mainImgCtnGold s-ZhgRSzzXxF2B"),x(H,jo,169,8,6325),y(K,"class","mainSvgaCtn"),x(K,jo,172,8,6488),y(N,"class","mainShowerCtn"),x(N,jo,167,4,6253),y(X,"class","showBar s-ZhgRSzzXxF2B"),y(X,"style",Z=`width: ${((null==(p=t[0])?void 0:p.gold_process)||0)/(null==(b=t[0])?void 0:b.gold_total)*100}%`),x(X,jo,176,12,6602),y(Q,"class","progressCtn s-ZhgRSzzXxF2B"),x(Q,jo,175,8,6564),y(et,"class","topTipsCtn s-ZhgRSzzXxF2B"),x(et,jo,178,8,6734),y(at,"class","icon s-ZhgRSzzXxF2B"),L(at.src,rt="https://asset.tuwan.com/goldMagic/magicIcon.png")||y(at,"src","https://asset.tuwan.com/goldMagic/magicIcon.png"),x(at,jo,185,20,7090),y(lt,"class","numCtn s-ZhgRSzzXxF2B"),x(lt,jo,186,20,7183),y(st,"class","innerCtn s-ZhgRSzzXxF2B"),x(st,jo,184,15,7046),y(ot,"class","normalBtn s-ZhgRSzzXxF2B"),y(ot,"id","goldNormalBtn"),x(ot,jo,183,12,6962),y(ht,"class","firedButton s-ZhgRSzzXxF2B"),y(ht,"id","goldFiredBtn"),x(ht,jo,190,12,7289),y(it,"class","buttonCtn s-ZhgRSzzXxF2B"),x(it,jo,182,8,6926),y(gt,"class","subTips s-ZhgRSzzXxF2B"),x(gt,jo,194,12,7431),y(pt,"class","footerBottomCtn s-ZhgRSzzXxF2B"),x(pt,jo,193,8,7389),y(J,"class","footer s-ZhgRSzzXxF2B"),x(J,jo,174,4,6535),y(e,"class","GoldCtn s-ZhgRSzzXxF2B"),x(e,jo,148,0,5352)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,c){b(i,e,c),I(e,n),I(e,o),I(e,s),I(s,a),I(a,r),I(a,l),I(l,d),I(s,m),I(s,h),I(h,u),I(h,f),I(f,w),I(s,v),I(s,$),I($,S),I($,A),I(A,j),I(A,D),I(e,B),I(e,F),I(e,U),I(e,z),t[7](z),I(e,O),I(e,N),I(N,q),I(N,G),I(N,H),I(N,W),I(N,K),I(e,Y),I(e,J),I(J,Q),I(Q,X),I(J,tt),I(J,et),et.innerHTML=t[2],I(J,nt),I(J,it),I(it,ot),I(ot,st),I(st,at),I(st,ct),I(st,lt),I(ot,dt),I(it,mt),I(it,ht),I(J,ut),I(J,pt),I(pt,gt),I(gt,ft),wt||(vt=[E(ot,"click",t[3],!1,!1,!1,!1),E(ht,"click",t[3],!1,!1,!1,!1)],wt=!0)},p:function(t,[e]){var n,i;1&e&&_t!==(_t=(t[0]?t[0].diamond_str:"")+"")&&P(d,_t),1&e&&yt!==(yt=(t[0]?t[0].number_str:"")+"")&&P(w,yt),1&e&&xt!==(xt=(t[0]?t[0].glod_num:"")+"")&&P(j,xt),1&e&&Z!==(Z=`width: ${((null==(n=t[0])?void 0:n.gold_process)||0)/(null==(i=t[0])?void 0:i.gold_total)*100}%`)&&y(X,"style",Z),4&e&&(et.innerHTML=t[2]),1&e&&bt!==(bt=(t[0]?t[0].remark:"")+"")&&P(ft,bt)},i:k,o:k,d:function(n){n&&C(e),t[7](null),wt=!1,V(vt)}};return p("SvelteRegisterBlock",{block:$t,id:Do.name,type:"component",source:"",ctx:t}),$t}function Lo(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Gold",i,[]);let s,{resData:a=null}=e,{handleSetResult:r}=e,{flag:c=0}=e,l=!1,d=[],m="",h=!1,u=eo.GOLD_TYPE,p=function(){l=!l},g=async function(){a.glod_num?h||(h=!0,d=[],y()):Vt("黄金魔法数量不足, 无法开启")},v=function(){Zt.getInstance().playEver(".fireSvgaCtn","https://asset.tuwan.com/goldMagic/fire_gold.svga","goldFire"),Zt.getInstance().playEver(".firedButton","https://asset.tuwan.com/goldMagic/openFiredGold_v2.svga","goldFire2"),window.$("#goldNormalBtn").hide(),window.$("#goldFiredBtn").show()},{handleGetGiftInfo:_=async function(){let t=u;const e=await qt.get(Ot.getGoldMagicInfo(t));0==e.error&&(n(0,a=e.data),1==a.is_hit?v():(Zt.getInstance().clearPlayer("goldFire"),Zt.getInstance().clearPlayer("goldFire2"),window.$(".fireSvgaCtn").empty(),window.$("#goldFiredBtn").empty(),window.$("#goldNormalBtn").show(),window.$("#goldFiredBtn").hide()))}}=e;function y(t=0){const e=uu.getCid();qt.get(Ot.openGoldGift(u,e,1,t)).then((t=>{if(0==t.error){if(setTimeout((()=>{window.$(".chat-center-gift-tab .gift-selected").trigger("click")}),500),d=t.data,0==(xt.getInstance().getGoldMagicAnimIgnore()||0)){const t="https://asset.tuwan.com/goldMagic/glod/",e=new Xt;e.play({url:t+"video.mp4?v2",ele:s,config:t+"vapc.json?v2"}).then((()=>{h=!1,_()})).finally((()=>{e.destory()})),setTimeout((()=>{r(d),window.$(".result_vap_anim").empty()}),1100)}else h=!1,_(),r(d)}else-2==t.error?(h=!1,Vt("您的钻石和点点币不足，请充值")):199==t.error?h=!1:-1100==t.error?(h=!1,de.getInstance().show("温馨提示",t.data[0].tips,!1,"取消","确认",(()=>{y(de.getInstance().choiceStatus?2:1)}),(()=>{}),{desAlign:"center",choiceText:t.data[0].remark,choice:"show"})):(h=!1,Vt(t.error_msg))}))}w((()=>{_(),Zt.getInstance().playEver(".mainImgCtnGold",io,"pendingSvga")})),t.$$.on_mount.push((function(){void 0!==r||"handleSetResult"in e||t.$$.bound[t.$$.props.handleSetResult]||console.warn("<Gold> was created without expected prop 'handleSetResult'")}));const x=["resData","handleSetResult","flag","handleGetGiftInfo"];return Object.keys(e).forEach((t=>{~x.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Gold> was created with unknown prop '${t}'`)})),t.$$set=t=>{"resData"in t&&n(0,a=t.resData),"handleSetResult"in t&&n(4,r=t.handleSetResult),"flag"in t&&n(5,c=t.flag),"handleGetGiftInfo"in t&&n(6,_=t.handleGetGiftInfo)},t.$capture_state=()=>({onMount:w,common:uu,request:qt,ChatUrls:Ot,VapPlayer:Xt,SessionStorage:xt,showTips:Vt,RESULT_VIEW_TYPE:eo,magic_pending_svga:no,gold_pending_svga:io,SvgaPlayer:Zt,ConfirmModal:de,resData:a,handleSetResult:r,flag:c,radioIsSelected:l,animEl:s,result:d,tipsStr:m,isGoing:h,mode:u,handleChangeRadio:p,handleOpenGift:g,openFire:v,handleGetGiftInfo:_,onBuy:y}),t.$inject_state=t=>{"resData"in t&&n(0,a=t.resData),"handleSetResult"in t&&n(4,r=t.handleSetResult),"flag"in t&&n(5,c=t.flag),"radioIsSelected"in t&&(l=t.radioIsSelected),"animEl"in t&&n(1,s=t.animEl),"result"in t&&(d=t.result),"tipsStr"in t&&n(2,m=t.tipsStr),"isGoing"in t&&(h=t.isGoing),"mode"in t&&(u=t.mode),"handleChangeRadio"in t&&(p=t.handleChangeRadio),"handleOpenGift"in t&&n(3,g=t.handleOpenGift),"openFire"in t&&(v=t.openFire),"handleGetGiftInfo"in t&&n(6,_=t.handleGetGiftInfo)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(97&t.$$.dirty){let t="";null==a||a.contentArr.forEach((e=>{t+=`<span style="color: ${e.color}">${e.txt}</span>`})),n(2,m=t),parseInt(localStorage.getItem("goldMagicFlag"))!=c&&(localStorage.setItem("goldMagicFlag",c+""),_())}},[a,s,m,g,r,c,_,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class Eo extends h{constructor(t){super(t),u(this,t,Lo,Do,g,{resData:0,handleSetResult:4,flag:5,handleGetGiftInfo:6}),p("SvelteRegisterComponent",{component:this,tagName:"Gold",options:t,id:Do.name})}get resData(){throw new Error("<Gold>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set resData(t){throw new Error("<Gold>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get handleSetResult(){throw new Error("<Gold>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handleSetResult(t){throw new Error("<Gold>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get flag(){throw new Error("<Gold>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set flag(t){throw new Error("<Gold>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get handleGetGiftInfo(){throw new Error("<Gold>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set handleGetGiftInfo(t){throw new Error("<Gold>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Bo="src/js/components/goldMagic/index.svelte";function Fo(t){let e,n,i={flag:t[1],resData:t[4],handleSetResult:t[11]};e=new Eo({props:i,$$inline:!0}),t[14](e);const o={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.flag=t[1]),16&n&&(i.resData=t[4]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[14](null),G(e,n)}};return p("SvelteRegisterBlock",{block:o,id:Fo.name,type:"else",source:"(101:8) {:else}",ctx:t}),o}function Uo(t){let e,n;e=new Po({props:{flag:t[1],resData:t[5],handleSetResult:t[11]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.flag=t[1]),32&n&&(i.resData=t[5]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Uo.name,type:"if",source:"(99:8) {#if currentType == '1'}",ctx:t}),i}function zo(t){let e,n,i;function o(e){t[15](e)}let s={mode:"1"==t[0]?eo.CRYSTAL_TYPE:eo.GOLD_TYPE};void 0!==t[8]&&(s.onClose=t[8]),e=new vo({props:s,$$inline:!0}),Y.push((()=>X(e,"onClose",o)));const a={c:function(){U(e.$$.fragment)},m:function(t,n){z(e,t,n),i=!0},p:function(t,i){const o={};1&i&&(o.mode="1"==t[0]?eo.CRYSTAL_TYPE:eo.GOLD_TYPE),!n&&256&i&&(n=!0,o.onClose=t[8],Z((()=>n=!1))),e.$set(o)},i:function(t){i||(q(e.$$.fragment,t),i=!0)},o:function(t){O(e.$$.fragment,t),i=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:a,id:zo.name,type:"if",source:"(105:8) {#if isShowHistory}",ctx:t}),a}function Oo(t){let e,n,i;function o(e){t[16](e)}let s={num:t[2],result:t[6],mode:"1"==t[0]?eo.CRYSTAL_TYPE:eo.GOLD_TYPE};void 0!==t[10]&&(s.onClose=t[10]),e=new mo({props:s,$$inline:!0}),Y.push((()=>X(e,"onClose",o)));const a={c:function(){U(e.$$.fragment)},m:function(t,n){z(e,t,n),i=!0},p:function(t,i){const o={};4&i&&(o.num=t[2]),64&i&&(o.result=t[6]),1&i&&(o.mode="1"==t[0]?eo.CRYSTAL_TYPE:eo.GOLD_TYPE),!n&&1024&i&&(n=!0,o.onClose=t[10],Z((()=>n=!1))),e.$set(o)},i:function(t){i||(q(e.$$.fragment,t),i=!0)},o:function(t){O(e.$$.fragment,t),i=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:a,id:Oo.name,type:"if",source:"(109:8) {#if isShowResult}",ctx:t}),a}function No(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,M;const A=[Uo,Fo],P=[];function j(t,e){return"1"==t[0]?0:1}g=j(t),f=P[g]=A[g](t);let D=t[7]&&zo(t),B=t[9]&&Oo(t);const F={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),a=_("div"),r=_("img"),l=T(),d=_("div"),m=_("img"),u=T(),f.c(),w=T(),D&&D.c(),v=T(),B&&B.c(),y(n,"class","coverBg s-RqmoFmijbkFn"),x(n,Bo,87,4,2802),y(r,"class","imgIcon s-RqmoFmijbkFn"),L(r.src,c="https://asset.tuwan.com/goldMagic/learnMoreIcon.png")||y(r,"src","https://asset.tuwan.com/goldMagic/learnMoreIcon.png"),x(r,Bo,91,16,3015),y(a,"class","subCtn s-RqmoFmijbkFn"),x(a,Bo,90,12,2958),y(m,"class","imgIcon s-RqmoFmijbkFn"),L(m.src,h="https://asset.tuwan.com/goldMagic/recordIcon.png")||y(m,"src","https://asset.tuwan.com/goldMagic/recordIcon.png"),x(m,Bo,94,16,3194),y(d,"class","subCtn s-RqmoFmijbkFn"),x(d,Bo,93,12,3127),y(s,"class","rightTopCtn s-RqmoFmijbkFn"),x(s,Bo,89,8,2920),y(o,"class",$=R("1"==t[0]?"goldMagicCtn magic":"goldMagicCtn gold")+" s-RqmoFmijbkFn"),x(o,Bo,88,4,2834),x(e,Bo,86,0,2792)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,h){b(c,e,h),I(e,n),I(e,i),I(e,o),I(o,s),I(s,a),I(a,r),I(s,l),I(s,d),I(d,m),I(o,u),P[g].m(o,null),I(o,w),D&&D.m(o,null),I(o,v),B&&B.m(o,null),k=!0,S||(M=[E(a,"click",t[13],!1,!1,!1,!1),E(d,"click",t[12],!1,!1,!1,!1)],S=!0)},p:function(t,[e]){let n=g;g=j(t),g===n?P[g].p(t,e):(W(),O(P[n],1,1,(()=>{P[n]=null})),N(),f=P[g],f?f.p(t,e):(f=P[g]=A[g](t),f.c()),q(f,1),f.m(o,w)),t[7]?D?(D.p(t,e),128&e&&q(D,1)):(D=zo(t),D.c(),q(D,1),D.m(o,v)):D&&(W(),O(D,1,1,(()=>{D=null})),N()),t[9]?B?(B.p(t,e),512&e&&q(B,1)):(B=Oo(t),B.c(),q(B,1),B.m(o,null)):B&&(W(),O(B,1,1,(()=>{B=null})),N()),(!k||1&e&&$!==($=R("1"==t[0]?"goldMagicCtn magic":"goldMagicCtn gold")+" s-RqmoFmijbkFn"))&&y(o,"class",$)},i:function(t){k||(q(f),q(D),q(B),k=!0)},o:function(t){O(f),O(D),O(B),k=!1},d:function(t){t&&C(e),P[g].d(),D&&D.d(),B&&B.d(),S=!1,V(M)}};return p("SvelteRegisterBlock",{block:F,id:No.name,type:"component",source:"",ctx:t}),F}function qo(t,e,n){let{$$slots:i={},$$scope:o}=e;f("GoldMagic",i,[]);let s,{currentType:a="1"}=e,r=0,c=1,l=0,d=null,m=null,h=[],u=!1,p=function(){n(7,u=!u)},g=!1,v=function(){n(1,r+=1),n(9,g=!g)},_=async function(){let t="1"==a?866:873;const e=await qt.get(Ot.getGoldMagicInfo(t));0==e.error&&("1"==a&&n(5,m=JSON.stringify(e.data)),"2"==a&&n(4,d=JSON.stringify(e.data)))},y=function(t,e=1){n(6,h=t),n(9,g=!g),n(9,g=!0),n(2,c=e)},x=function(){n(7,u=!0)},b=function(){"1"==a?window.open("https://y.tuwan.com/activity/340Cb43562#/"):window.open("https://y.tuwan.com/activity/354C139769#/")};w((()=>{Zt.getInstance().preload("https://asset.tuwan.com/goldMagic/fire_gold.svga"),Zt.getInstance().preload("https://asset.tuwan.com/goldMagic/openFiredGold_v2.svga"),Zt.getInstance().preload("https://asset.tuwan.com/goldMagic/fire_magic.svga"),Zt.getInstance().preload(io),Zt.getInstance().preload(no)}));const $=["currentType"];return Object.keys(e).forEach((t=>{~$.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<GoldMagic> was created with unknown prop '${t}'`)})),t.$$set=t=>{"currentType"in t&&n(0,a=t.currentType)},t.$capture_state=()=>({onMount:w,Result:mo,History:vo,RESULT_VIEW_TYPE:eo,magic_pending_svga:no,gold_pending_svga:io,Hello:xo,request:qt,ChatUrls:Ot,Magic:Po,Gold:Eo,SvgaPlayer:Zt,currentType:a,flag:r,num:c,changeFlag:l,goldChild:s,goldResData:d,magicResData:m,result:h,isShowHistory:u,handleChangeHistory:p,isShowResult:g,handleChangeResult:v,handleOpenGiftInfo:_,handleSetResult:y,openGiftRecordList:x,goToPage:b}),t.$inject_state=t=>{"currentType"in t&&n(0,a=t.currentType),"flag"in t&&n(1,r=t.flag),"num"in t&&n(2,c=t.num),"changeFlag"in t&&(l=t.changeFlag),"goldChild"in t&&n(3,s=t.goldChild),"goldResData"in t&&n(4,d=t.goldResData),"magicResData"in t&&n(5,m=t.magicResData),"result"in t&&n(6,h=t.result),"isShowHistory"in t&&n(7,u=t.isShowHistory),"handleChangeHistory"in t&&n(8,p=t.handleChangeHistory),"isShowResult"in t&&n(9,g=t.isShowResult),"handleChangeResult"in t&&n(10,v=t.handleChangeResult),"handleOpenGiftInfo"in t&&(_=t.handleOpenGiftInfo),"handleSetResult"in t&&n(11,y=t.handleSetResult),"openGiftRecordList"in t&&n(12,x=t.openGiftRecordList),"goToPage"in t&&n(13,b=t.goToPage)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,r,c,s,d,m,h,u,p,g,v,y,x,b,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(3,s)}))},function(t){p=t,n(8,p)},function(t){v=t,n(10,v)}]}class Go extends h{constructor(t){super(t),u(this,t,qo,No,g,{currentType:0}),p("SvelteRegisterComponent",{component:this,tagName:"GoldMagic",options:t,id:No.name})}get currentType(){throw new Error("<GoldMagic>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set currentType(t){throw new Error("<GoldMagic>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class Vo{static initFn(t){$("#goldMagicContainer").off("click").on("click",(function(t){t.stopPropagation()})),$("#goldMagicContainer").empty();const e=$("#goldMagicContainer")[0];let n=new Go({target:e});n.$set({currentType:t}),$(".coverBg").on("click",(function(t){t.stopPropagation(),n.$destroy()}))}}let Ho=0;class Wo{constructor(){this.instance=null,this.emitter=new Ht,this.currentTab=0,this.currentGiftId=0,this.goldBoxNum=0,this.is_send=0,this.initGiftCss(),this.initGiftHtml()}static getInstance(){return this.instance||(this.instance=new Wo),this.instance}onReset(){this.currentTab=0,this.currentGiftId=0;try{const t=window.$(".ddgift-content");t.find("#font-my-diamond").text(""),t.find("#font-my-yue").text(""),t.find("#font-my-crystal").text(""),window.$(".chat-center-gift-tab").empty(),window.$(".chat-center-gift-list-single").empty(),window.$(".gift-my-money-content").css("display","none")}catch(t){}}initGiftCss(){window.$("head").append("<style>\n                        .ddgift-content{width:665px;background:#fff;border:solid 1px #ddd;flex-direction:column;}\n                        .chat-center-gift-tab-content{background:#eee;}\n                        .chat-center-gift-tab-content .chat-center-gift-tab{max-width: 528px;}\n                        .chat-center-gift-tab{align-items:center;text-align:center;height:50px;padding:0 16px;color:#333;}\n                        .chat-center-gift-tab div{width:80px;}\n                        .chat-center-gift-tab div span{padding-bottom:2px;}\n                        .chat-center-gift-tab div.gift-selected span{border-bottom:solid 2px #333;}\n                        .chat-center-gift-tip{flex:1;justify-content:flex-end;align-items:center;cursor:default;text-align:right;}\n                        .chat-center-gift-tip a{margin-right:10px;color:#999;font-size:14px;text-decoration:none;}\n                        .chat-center-gift-tip #imgshoucong{display:none;cursor:pointer;}\n                        .chat-center-gift-tip #level_up{cursor:pointer;margin-right:10px;font-size:12px;color:#D58608}\n                        .chat-center-gift-list{display:flex;flex:1 auto;padding:10px;height:234px;width:646px;overflow-y:auto;overflow-x:hidden;}\n                        .chat-center-gift-list::-webkit-scrollbar {width: 6px;background-color: #f9f9f9;}\n                        .chat-center-gift-list::-webkit-scrollbar-thumb {border-radius: 10px;box-shadow: inset 0 0 6px rgba(220, 220, 220, .3);-webkit-box-shadow: inset 0 0 6px rgba(220, 220, 220, .3);background-color: #ccc;}\n                        .chat-center-gift-list .chat-center-gift-list-single {flex: 1 auto;flex-wrap: wrap;position: relative;}\n                        .chat-center-gift-list .chat-center-gift-item {padding: 10px;text-align: center;color: #333;font-size: 14px;width: 72px;height: 96px;margin-right: 12px;border: solid 1px #fff;}\n                        .chat-center-gift-list .chat-center-gift-item .itemTitleCtn{width: 80px; margin-left: -4px;}\n                        .chat-center-gift-list .chat-center-gift-item.current {border: solid 1px #f91b00;border-radius: 10px;}\n                        .chat-center-gift-list .chat-center-gift-item img {height: 64px;width: 64px;}\n                        .gift-window-bottom {height: 40px;background: #efefef;align-items: center;}\n                        .gift-window-bottom .gift-window-bottom-count {height: 30px;line-height: 30px;margin-left: 6px;padding-left: 10px;background: #fff;position: relative;}\n                        .gift-window-bottom .gift-window-bottom-count span {font-size: 14px;color: #666;}\n                        .gift-window-bottom .gift-window-bottom-count .gift-arrow {padding:0 10px;}\n                        .gift-window-bottom .gift-window-bottom-count input {border-style: none;outline: none;height: 24px;width: 18px;text-align: center;color: #333;}\n                        .gift-window-bottom .sendgift-user{align-items: center;}\n                        .gift-window-bottom .baobox-title{cursor: default; align-items: center;font-size:14px;color: #666; justify-content: center; background:#fff; padding:0 10px;margin-left: 10px; height: 30px;border-radius: 3px; display: none;}\n                        .gift-send-btn {background: #f91b00;font-size: 14px;color: #fff;height: 30px;line-height: 30px;padding: 0 10px;margin-left: 6px;border-radius: 4px;}\n                        .gift-use-btn {background: #f91b00;font-size: 14px;color: #fff;height: 30px;line-height: 30px;padding: 0 10px;margin-left: 6px;border-radius: 4px;display:none;}\n                        .gift-open-btn {background: #5081FF;font-size: 14px;color: #fff;height: 30px;line-height: 30px;padding: 0 10px;margin-left: 6px;border-radius: 4px;display:none;}\n                        .gift-count-list {position: absolute;background: #fff;border: solid 1px #ddd;width: 280px;bottom: 40px;left: 0;padding: 6px 10px;display: none;z-index: 9;line-height: 24px;}\n                        .gift-count-list span {display: inline-block;background: #fdfdfd;text-align: center;width: 50px;border-radius: 4px;border: solid 1px #eee;}\n                        .gift-count-list span:hover,.gift-count-list span.current {border: solid 1px #ff6600;color: #ff6600;}\n                        .gift-send-teacher-content {position: relative;}\n                        .gift-send-teacher-list {position: absolute;bottom: 38px;right: 0;background: #fff;width: 200px;border: solid 1px #ddd;flex-direction: column;max-height: 600px;overflow-y: auto;display: none;}\n                        .gift-send-teacher-list::-webkit-scrollbar {width: 6px;background-color: #f9f9f9;}\n                        .gift-send-teacher-list::-webkit-scrollbar-thumb {border-radius: 10px;box-shadow: inset 0 0 6px rgba(220, 220, 220, .3);-webkit-box-shadow: inset 0 0 6px rgba(220, 220, 220, .3);background-color: #ccc;}\n                        .gift-send-teacher-list>div {line-height: 30px;background: #fff;text-align: center;padding: 10px 0;font-size: 14px;}\n                        .gift-send-teacher-list p:hover {background: #eee;}\n                        .gift-my-money {font-size: 12px;margin-left: 10px;color: #333;display:flex}\n                        .gift-my-money p>font {font-size: 12px;color: #ff0000;}\n                        .gift-my-diamond-content { display: flex;flex-direction: column;width:106px;}\n                        .gift-my-money-content { width:118px; display: flex;flex-direction: column;justify-content: flex-end;display:none;}\n                        .gift-go-congzi {text-align: right;flex: 1 auto;}\n                        .gift-go-congzi a {font-size: 14px;background: #faba05;padding: 6px 10px;border-radius: 5px;color: #f91b00;margin-right: 10px;}\n                        .div-futext{display:none;position: absolute;right: 0;top: 0;}\n                        .common-gift-mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 4000;position: fixed;}\n                        .gold-box-content,.baba-card-content{position: relative;width:510px;height:600px;background:#fff;border-radius:10px;padding-top:34px;box-sizing:border-box;text-align:center}\n                        .svip-pack-content{position: relative;width:504px;height:585px;background: url(https://asset.tuwan.com/chatroom/images/svip_pack_bg.png);padding-top:34px;box-sizing:border-box;text-align:center}\n                        .common-gift-close{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_close.png) no-repeat center center;right: 4px;top: 10px;cursor: pointer;}\n                        .common-gift-que{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_que.png) no-repeat center center;left: 27px;top: 15px;cursor: pointer;z-index:10}\n                        .common-gift-title{color:#FF6691;font-size:36px}\n                        .svip-pack-que{left:60px}\n                        .svip-pack-close{right:42px}\n                        .svip-pack-ribbon{position:absolute;left:0px;top:-50px}\n                        .svip-pack-info-content{width:410px;margin:0 auto;margin-top:44px;flex-wrap:wrap;justify-content: space-around;}\n                        .svip-pack-item{width:70px;margin:0 10px;color:#4B4D7A;font-size:14px;margin-bottom:20px}\n                        .svip-pack-item-content{width:70px;height:70px;border-radius:6px;background:rgba(255, 102, 145, .1);margin-bottom:4px}\n                        .svip-pack-item-content img{max-width:80%;max-height:80%;}\n                        .gold-box-pic-content{width:310px;height:310px;margin:16px auto 5px;}\n                        .baba-card-pic-content{width:190px;height:190px;margin:72px auto 5px;background:rgba(255, 102, 145, .1);border-radius:12px;}\n                        .gold-box-pic-content img,.baba-card-pic-content img{width:80%;max-height:80%}\n                        .gold-box-price{color:#FF6691;font-size:20px;margin-right:20px}\n                        .gold-box-hit{position:absolute;display:none;top:100px;right:50px}\n                        .gold-box-left-num,.gold-box-max-tips{color:#999999;font-size:16px}\n                        .gold-box-max-tips span{color:#FF6691}\n                        .gold-box-open,.baba-card-open,.svip-pack-buy{width:260px;height:64px;background:#FF6691;color:#fff;text-align:center;font-size:24px;line-height:64px;border-radius:42px;cursor: pointer;margin:0 auto;margin-bottom:18px}\n                        .gold-box-progress{position:relative;width:300px;height:10px;border:unset;border-radius:10px;display:block;margin:20px auto 10px;background:#ECECEC}\n                        .gold-box-bar{position: relative;height:10px;background: #ff8ba2;border-radius: 10px;background-size: 200% 100%;background-image: repeating-linear-gradient(-45deg, #ff7896, #ff7896 10px, transparent 10px, transparent 20px);animation: boxProcess 5s linear infinite;}\n                        .gold-box-pic-content img.bounceIn {animation: bounceIn 2s 1 ease-out;}\n                        .gold-box-pic-content img.bounceIn1 {animation: bounceIn1 2s 1 ease-out;}\n                        .baba-card-name{color:#4B4D7A;font-size:24px;margin:16px 0 42px;}\n                        .common-baba-desc{color:#BBBBBB;font-size:16px;margin-bottom:6px}\n                        .svip-pack-buy{background:#fff;color:#FF6691;margin:80px auto 6px}\n                        .svip-pack-price{color:#fff;font-size:20px;}\n\n                        @keyframes bounceIn {\n                            0% {\n                               opacity: 0;\n                               transform: scale(0.1);\n                            }\n                            25% {\n                               opacity: 1;\n                               transform: scale(1.1);\n                            }\n                            50% {\n                               transform: scale(.95);\n                            }\n                            75% {\n                               transform: scale(1.05);\n                            }\n                            100% {\n                               transform: scale(1);\n                            }\n                        }\n                        @keyframes bounceIn1 {\n                            0% {\n                               opacity: 0;\n                               transform: scale(0.1);\n                            }\n                            25% {\n                               opacity: 1;\n                               transform: scale(1.3);\n                            }\n                            50% {\n                               transform: scale(.95);\n                            }\n                            75% {\n                               transform: scale(1.25);\n                            }\n                            100% {\n                               transform: scale(1);\n                            }\n                        }\n                        @keyframes boxProcess {\n                            from {\n                                background-position-x: 0px;\n                            }\n\n                            to {\n                                background-position-x: -200%;\n                            }\n                        }\n\n                        .chat-center-gift-tab>div{position:relative}\n                        .red_doit{position:absolute;background:red;width:6px;height:6px;border-radius:50%;right:14px;top:0;padding:0}\n                    </style>")}initGiftHtml(){let t=`\n                    <div class="flex ddgift-content">\n                        <div class="flex chat-center-gift-tab-content">\n                            <div class="flex chat-center-gift-tab">\n                            </div>\n                            <div class="flex chat-center-gift-tip">\n                                <span id="giftListCtnGiftTipCtn">\n                                    <a href="https://y.tuwan.com/activity/36C33a2de?v=1656553263108#/" target="_blank" id="chat-center-gift-tip" >魔法礼物说明</a>\n                                </span>\n                                <img id="imgshoucong" src="https://res.tuwan.com/templet/play/chat/chatv2/images/shoucongicon.png">\n                                <div id="level_up" class="ygb_f_c">\n                                    <img src="https://asset.tuwan.com/officialsite/images/king.png">\n                                    贵族\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class="flex flex-ac flex-jc jingjia-gift-info"></div>\n                        <div class="chat-center-gift-list"></div>\n                        <div class="flex gift-window-bottom">\n                            <div class="flex gift-window-bottom-count">\n                                <span>数量</span>\n                                <span><input type="number" value="1" id="inputGiftCount"></span>\n                                <span id="spanShowGiftCount" class="gift-arrow">\n                                    <img src="https://res.tuwan.com/templet/play/teacher/images/top_kong_hover.png">\n                                </span>\n                                <div class="gift-count-list" id="giftCountList">\n                                    <span class="current">10</span>\n                                    <span>66</span>\n                                    <span>520</span>\n                                    <span>888</span>\n                                    <span>1314</span>\n                                </div>\n                            </div>\n                            <div class="flex sendgift-user">\n                                <div style="font-size: 14px; margin-left: 6px;">赠送</div>\n                                <div class="flex gift-send-teacher-content gift-window-bottom-count">\n                                    <span id="selectGiftTeacher" uid="0">送麦上所有人</span>\n                                    <span id="spanTeacherShow" class="gift-arrow">\n                                        <img src="https://res.tuwan.com/templet/play/teacher/images/top_kong_hover.png">\n                                    </span>\n                                    <div class="gift-send-teacher-list">\n                                        <div id="divTeacherList"></div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="flex baobox-title"></div>\n                           <div class="flex">\n                              <div class="gift-send-btn" data-type='2'>赠送</div>\n                              <div class="gift-open-btn" data-type='1'>开启</div>\n                              <div class="gift-use-btn" data-type='3'>使用</div>\n                           </div>\n                            <div class="gift-my-money">\n                                <div class="gift-my-diamond-content">\n                                    <p>钻石：<font id="font-my-diamond"></font></p>\n                                    <p class="font-my-crystal-content">紫晶：<font id="font-my-crystal"></font></p>\n                                </div>\n                                <div class="gift-my-money-content" >\n                                    <p class="font-my-yue-content" >点点币：<font id="font-my-yue"></font></p>\n                                </div>\n                              \n                               \n                            </div>\n                            <div class="gift-go-congzi">\n                                <a href="${Ot.getRechargeUrl()}" target="_blank">充值</a>\n                            </div>\n                        </div>\n\n                        <div class="div-futext">\n                            <select class="eff-select">\n                                <option value="3d">3d</option>\n                                <option value="eff">eff</option>\n                            </select>\n                            <input type="text">\n                            <button>确定</button>\n                        </div>\n                    </div>`;window.$(".chat-center-gift-content").html(t);window.$("body").append('<div class="gold-box-mask common-gift-mask">\n                            <div class="gold-box-content">\n                                <a class="gold-box-que common-gift-que" href="https://www.tuwan.com/view/411091/?3" target="_blank"></a>\n                                <div class="gold-box-close common-gift-close"></div>\n                                <img class="gold-box-hit" src="https://asset.tuwan.com/chatroom/images/hit.png?v=2">\n                                <div class="gold-box-title common-gift-title"></div>\n                                <div class="gold-box-pic-content ygb_f_c">\n                                    <img class="gold-box-pic">\n                                </div>\n                                <div class="gold-box-result"></div>\n                                <div class="gold-box-open"></div>\n                                <div class="ygb_f_c gold-common-dis">\n                                    <div class="gold-box-price ygb_f_c">\n                                        <span></span>\n                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/zhuanicon.png">\n                                    </div>\n                                    <div class="gold-box-left-num"></div>\n                                </div>\n                                <div class="gold-box-progress gold-common-dis">\n                                    <div class="gold-box-bar"></div>\n                                </div>\n                                <div class="gold-box-max-tips gold-common-dis"></div>\n                            </div>\n                        </div>\n                        <div class="baba-card-mask common-gift-mask">\n                            <div class="baba-card-content">\n                                <a class="baba-card-que common-gift-que" href="javascript:void(0)" target="_blank"></a>\n                                <div class="baba-card-close common-gift-close"></div>\n                                <div class="baba-card-title common-gift-title"></div>\n                                <div class="baba-card-pic-content ygb_f_c">\n                                    <img class="baba-card-pic">\n                                </div>\n                                <div class="baba-card-name"></div>\n                                <div class="baba-card-open"></div>\n                                <div class="baba-card-desc common-baba-desc"></div>\n                                <div class="baba-card-desc-1 common-baba-desc"></div>\n                            </div>\n                        </div>\n                        <div class="svip-pack-mask common-gift-mask">\n                            <div class="svip-pack-content">\n                                <a class="svip-pack-que common-gift-que" href="javascript:void(0)" target="_blank"></a>\n                                <div class="svip-pack-close common-gift-close"></div>\n                                <img class="svip-pack-ribbon" src="https://asset.tuwan.com/chatroom/images/svip-pack-ribbon.png">\n                                <div class="svip-pack-title common-gift-title"></div>\n                                <div class="svip-pack-info-content ygb_flex"></div>\n                                <div class="svip-pack-buy">确定</div>\n                                <div class="svip-pack-price">\n                                    <span></span>\n                                    <img src="https://res.tuwan.com/templet/play/chat/auto/images/zhuanicon.png">\n                                </div>\n                            </div>\n                        </div>'),this.initGiftEvent()}getGiftTabs(t){const e=this;return new Promise(((n,i)=>{qt.get(Ot.getGiftLists(t,0)).then((t=>{if(0==t.error){e.is_send=t.is_send;const i=window.$(".chat-center-gift-list");if(0==window.$(".chat-center-gift-tab").find("div").length){const e=t.tabs;let n=[],o=[];e.map(((t,e)=>{const i=1==t.is_new?'<b class="red_doit"></b>':"";n.push('<div class="'+(e==this.currentTab?"gift-selected":"")+'" data-id="'+t.id+'"><span>'+t.title+`</span>${i}</div>`),o.push('<div class="flex gifttab chat-center-gift-list-single'+(e==this.currentTab?"":" hide")+'" data-id="'+t.id+'"></div>')})),window.$(".chat-center-gift-tab").html(n.join("")),i.html(o.join(""))}n()}else i("网络错误，请重试")}))}))}checkGiftButtonStatus(t=0,e=0,n=0){3==this.currentTab||7==this.currentTab?383==e||873==e?($(".gift-open-btn").show(),$(".gift-send-btn").hide(),$(".gift-ues-btn").hide()):866==e?($(".gift-open-btn").show(),1==this.is_send?$(".gift-send-btn").show():$(".gift-send-btn").hide(),$(".gift-ues-btn").hide()):384==e||389==e?($(".gift-open-btn").hide(),$(".gift-send-btn").hide(),$(".gift-ues-btn").show()):7==t?($(".gift-open-btn").show(),$(".gift-send-btn").hide(),$(".gift-ues-btn").hide()):16==t&&0==n?($(".gift-open-btn").hide(),$(".gift-send-btn").hide(),$(".gift-ues-btn").show()):($(".gift-open-btn").hide(),$(".gift-send-btn").show(),$(".gift-ues-btn").hide()):($(".gift-open-btn").hide(),$(".gift-ues-btn").hide(),$(".gift-send-btn").show())}getGiftsNew(t,e,n,i){let o=null!=i?i:this.currentTab;const s=this;qt.get(Ot.getGiftLists(t,o)).then((t=>{if(0==t.error){s.is_send=t.is_send;const i=window.$(".chat-center-gift-list");if(0==window.$(".chat-center-gift-tab").find("div").length){const e=t.tabs;let n=[],s=[];e.map((t=>{const e=1==t.is_new?'<b class="red_doit"></b>':"";n.push('<div class="'+(t.id==o?"gift-selected":"")+'" data-id="'+t.id+'"><span>'+t.title+`</span>${e}</div>`),s.push('<div class="flex gifttab chat-center-gift-list-single'+(t.id==o?"":" hide")+'" data-id="'+t.id+'"></div>')})),window.$(".chat-center-gift-tab").html(n.join("")),i.html(s.join(""))}else{window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='"+o+"']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id="+o+"]").addClass("gift-selected")}const a=t.data,r=null!=a&&0!=a.length&&null!=a.find((t=>t.id==e));let c=[];const l=i.find('.chat-center-gift-list-single[data-id="'+o+'"]');let d=!1;if(l.html()){let t=[...l.find(".chat-center-gift-item")];a.forEach(((e,n)=>{e.id!=$(t[n]).data().id&&(d=!0)}))}else d=!0;if(d&&(a.map(((t,i)=>{const o=[];for(let e in t)o.push(`data-${e}=${JSON.stringify(t[e])}`);const s=t.pic,a=t.title,l=t.id,d=t.intro,m=t.type,h=t.diamond;let u=" "==d?"":' title="'+Ct.nrTobr(d)+'" ',p="";p=0!=e?r?e==l?" current":"":0==i?" current":"":17==n?n==m?" current":"":0==i?" current":"";const g="<div"+u+o.join(" ")+' class="chat-center-gift-item'+p+'">\n                                            <div>\n                                                <img src="'+s+'">\n                                            </div>\n                                            <div class="itemTitleCtn">'+a+'</div>\n                                            <div class="flex" style="font-size:12px; color:#666; justify-content:center; align-items:center;">\n                                                <img style="width:12px; height:9px; margin-right:3px;" src="https://res.tuwan.com/templet/play/public/images/zuanshi.png" />\n                                            '+h+"钻\n                                            </div>\n                                        </div>";c.push(g)})),l.html(c.join(""))),s.checkGiftButtonStatus(0,0,0),0!=e&&r){const t=l.find(`.chat-center-gift-item[data-id='${e}']`);i.scrollTop(t.position().top+5)}else i.scrollTop(0);window.$(".chat-center-gift-item").tooltip({align:"top",html:!0})}}))}formatBoxtitle(t){const e=t.split("有机会获得");if(e.length>1)return'有机会获得<span style="color:#ff6691;">'+e[1]+"</span>"}getBaoguo(t,e){const n=this;this.checkGiftButtonStatus(0,0,0),window.$(".sendgift-user").show(),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex"),qt.get(Ot.getHaveGift(uu.getCid(),e)).then((i=>{if(0==i.error){window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='"+e+"']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id="+e+"]").addClass("gift-selected");var o=i.data;if(o.length>0){let i=0,s=[];o.map(((n,o)=>{let a=[];for(let t in n)a.push("data-"+t+'="'+n[t]+'"');let r="";const c=n.num,l=n.type,d=n.pic,m=n.title,h=n.intro;n.to_uid,n.to_nickname;const u=n.id,p=n.price;let g="";7==e&&7==l?g=`<div class="flex" style="font-size:12px; color:#666; justify-content:center; align-items:center;">\n                            <img style="width:12px; height:12px; margin-right:3px;" src="https://asset.tuwan.com/chatroom/images/icon_new_crystal.png">\n                             ${p/10}\n                            </div>`:(r=7==l?p/10+"钻":"x"+c,g=155==u||156==u?'<div class="baoguo-num" num="'+(7==l?"0":c)+'" style="font-size:12px;color:#666;  display: flex; align-items: center; justify-content: center;">\n                                <img style="width:12px; height:9px; margin-right:3px;" src="https://res.tuwan.com/templet/play/public/images/zuanshi.png" />\n                                '+r+"</div>\n                                </div>":'<div class="baoguo-num" num="'+(7==l?"0":c)+'" style="font-size:12px;color:#666;  display: flex; align-items: center; justify-content: center;">\n                                '+r+"</div>\n                                </div>");let f=" "==h?"":' title="'+Ct.nrTobr(h)+'" ';s.push("<div"+f+a.join("")+' class="chat-center-gift-item'+(0!=t?t==u&&0==i?" current":"":0==o?" current":"")+'">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src="'+d+"\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class='itemTitleCtn'>"+m+`</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t${g}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>`),t==u&&0==i&&i++}));const a=window.$(`.chat-center-gift-list .gifttab[data-id='${e}']`);let r;a.html(s.join("")),a.find("img").each((function(){Qe({img:this,retryNum:1,randomNum:!0})})),r=0==t?o[0]:a.find(`.chat-center-gift-item[data-id='${this.currentGiftId}']`)[0].dataset,"383"==r.id||7==r.type&&("866"==r.id||"873"==r.id)?(n.checkGiftButtonStatus(r.type,r.id,0),"866"==r.id?(window.$(".sendgift-user").show(),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex")):(window.$(".baobox-title").html(this.formatBoxtitle(r.intro)),window.$(".baobox-title").css("display","flex"),window.$(".sendgift-user").hide())):16==r.type?0==r.to_uid?(n.checkGiftButtonStatus(r.type,r.id,0),window.$(".sendgift-user").hide(),window.$(".baobox-title").hide()):(n.checkGiftButtonStatus(r.type,r.id,r.to_uid),window.$(".sendgift-user").show(),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex")):n.checkGiftButtonStatus(r.type,r.id,0),window.$(".chat-center-gift-item").tooltip({align:"top",html:!0}),3==e&&$('.gifttab[data-id="3"] .chat-center-gift-item.current').trigger("click")}else{window.$(`.chat-center-gift-list .gifttab[data-id='${e}']`).html('<img style="margin: 0 auto; width: 140px; height: 140px; margin-top: 47px;" src="https://asset.tuwan.com/images/chartRoomNoGift.png" />')}}window.$(".chat-center-gift-item").tooltip({align:"top",html:!0}),window.$(".chat-function-noani").tooltip({align:"top",html:!0})}))}showGoldBox(){qt.get(Ot.goldBoxInfo()).then((t=>{if(0==t.error){let{num:e,process:n,total:i,diamond:o,pic:s,gift:a,rule_pc:r}=t.data;window.$(".gold-box-result").hide(),window.$(".gold-common-dis").show(),window.$(".gold-box-title").html("开启宝箱"),window.$(".gold-box-open").html("开启宝箱"),window.$(".gold-box-open").attr("data-type","open"),window.$(".gold-box-que").attr("href",r),window.$(".gold-box-bar").css("width",n/(i-1)*300+"px"),window.$(".gold-box-pic").attr("src",s),window.$(".gold-box-price span").html(o),n==i-1?(window.$(".gold-box-max-tips").css("color","#FF6691"),window.$(".gold-box-hit").show(),window.$(".gold-box-max-tips").html(`本次暴击有机会获得${a}`)):(window.$(".gold-box-hit").hide(),window.$(".gold-box-max-tips").css("color","#999"),window.$(".gold-box-max-tips").html(`再开启<span>${i-n}个</span>有机会获得<span>${a}</span>`)),window.$(".gold-box-left-num").html(`剩余${e}个`),window.$(".gold-box-mask").css("display","flex"),window.$(".gold-box-pic").removeClass("bounceIn bounceIn1").addClass("shake")}}))}payGoldBox(){qt.get(Ot.openGoldBox(uu.getCid())).then((t=>{let e=window.$(".chat-center-gift-item[data-id='383']")[0].dataset.price;if(0==t.error){const{id:o,title:s,pic:a,hit:r,diamond:c,uids:l}=t.data[0],d=t.num;if(window.$(".gold-box-pic").removeClass("shake"),window.$(".gold-box-open").attr("data-type","sure"),window.$(".gold-common-dis").hide(),window.$(".gold-box-pic").attr("src",a),window.$(".gold-box-result").show(),1==r){let t="";t=401==o?`恭喜您暴击获得"${s}"<br><a href="/shop/" target="_blank" style="color: #ff6691;margin-top:4px;display:block">点击进入星耀商城兑换</a>`:0==c?`恭喜您暴击获得"${s}x${l[0].num}"`:`恭喜您暴击获得"${s}"<br><div style="color: #ff6691;margin-top:4px">价值：${c}<img style="margin-top:-4px;margin-left:10px;" src="https://res.tuwan.com/templet/play/chat/auto/images/zhuanicon.png"></div>`,window.$(".gold-box-result").css({color:"#333","margin-bottom":0==c?"50px":"22px"}),window.$(".gold-box-result").html(t),window.$(".gold-box-pic").addClass("bounceIn1")}else window.$(".gold-box-result").css({color:"#333","margin-bottom":"50px"}),window.$(".gold-box-result").html(`恭喜您获得"${s}"`),window.$(".gold-box-pic").addClass("bounceIn");window.$(".gold-box-title").html("恭喜获得"),window.$(".gold-box-open").html("确定");const m=uu.getSelfInfo();var n=m.diamond,i=m.money;const h=e/10;n>=h?this.emitter.emit("jisuanMoney",h,0):i>=e/100&&this.emitter.emit("jisuanMoney",0,e/100);const u=window.$(".chat-center-gift-list").find('.chat-center-gift-list-single[data-id="3"]').find(".chat-center-gift-item[data-id='383']");this.goldBoxNum=d,d<0?(u.get(0).dataset.num=0,u.find(".baoguo-num").text("x0")):(u.get(0).dataset.num=d,u.find(".baoguo-num").text("x"+d)),this.emitter.emit("playBaobox",t.data)}else-2==t.error?Ct.Confirm("您的钻石和余额不足，请充值",(function(){window.open(Ot.getRechargeUrl())}),"充值"):Vt(t.error_msg)}))}showBaBaBox(){qt.get(Ot.baBaBoxInfo(uu.getMeid())).then((t=>{if(0==t.error){const{title:e,desc:n,desc2:i,data:o,pc:s}=t.data;window.$(".baba-card-title").html(e),window.$(".baba-card-name").html(o[0].title),window.$(".baba-card-open").html("立即使用"),window.$(".baba-card-desc").html(n),window.$(".baba-card-desc-1").html(i),window.$(".baba-card-pic").attr("src",o[0].img),window.$(".baba-card-mask").css("display","flex"),window.$(".baba-card-que").attr("href",s)}}))}useBaBaCard(){qt.get(Ot.useBaBa(uu.getCid(),uu.getMeid())).then((t=>{0==t.error?(window.$(".baba-card-mask").hide(),si.show(".channel-guanming","block"),window.$(".span-channel-guanming-name").html(uu.getRoomInfo().title)):Vt(t.error_msg)}))}showPowerPack(){qt.get(Ot.powerPackInfo(uu.getMeid())).then((t=>{if(0==t.error){const{title:e,price:n,data:i,pc:o}=t.data;let s="";i.forEach((t=>{s+=`<div class="svip-pack-item">\n                                <div class="svip-pack-item-content ygb_f_c">\n                                    <img src="${t.img}">\n                                </div>\n                                <div>${t.title}</div>\n                            </div>`})),window.$(".svip-pack-info-content").html(s),window.$(".svip-pack-mask").css("display","flex"),window.$(".svip-pack-title").html(e),window.$(".svip-pack-price span").html(n),window.$(".svip-pack-que").attr("href",o)}}))}payPowerPack(){qt.get(Ot.buyPowerPack(uu.getMeid())).then((t=>{0==t.error?(Vt(t.error_msg),window.$(".svip-pack-mask").hide()):-2==t.error?Ct.Confirm("您的钻石和余额不足，请充值",(function(){window.open(Ot.getRechargeUrl())}),"充值"):Vt(t.error_msg)}))}resetInputGiftCount(){window.$("#inputGiftCount").val(1)}initGiftEvent(){const t=this;window.$(".chat-center-gift-tab").on("click","> div",(function(){if(window.$(this).hasClass("gift-selected"))return;t.resetInputGiftCount();const e=this.dataset.id;if((3==e||7==e)&&uu.getMeid()>Mt.maxUID)return void t.emitter.emit("showLoginWindow");t.currentTab=e,t.currentGiftId=0,window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='"+e+"']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(this).addClass("gift-selected"),7==e?$("#chat-center-gift-tip").text("紫晶魔法说明").attr("href","https://y.tuwan.com/activity/340Cb43562?v=1703303588331#/"):$("#chat-center-gift-tip").text("魔法礼物说明").attr("href","https://y.tuwan.com/activity/36C33a2de?v=1656553263108#/"),3==e||7==e?t.getBaoguo(0,e):(t.getGiftsNew(uu.getCid(),0,0),t.checkGiftButtonStatus(0,0),window.$(".baobox-title").css("display","none"),window.$(".sendgift-user").css("display","flex"))})),window.$(".chat-center-gift-tab").on("click",".gift-selected[data-id='7']",(function(){t.getBaoguo(0,7)})),window.$(".common-gift-mask").on("click",(function(t){t.stopPropagation()})),window.$(".svip-pack-mask").on("click",".svip-pack-close",(function(t){t.stopPropagation(),window.$(".svip-pack-mask").hide()})),window.$(".svip-pack-mask").on("click",".svip-pack-buy",(function(e){e.stopPropagation(),t.payPowerPack()})),window.$(".baba-card-mask").on("click",".baba-card-close",(function(t){t.stopPropagation(),window.$(".baba-card-mask").hide()})),window.$(".baba-card-mask").on("click",".baba-card-open",(function(e){e.stopPropagation(),t.useBaBaCard()})),window.$(".gold-box-mask").on("click",".gold-box-close",(function(t){t.stopPropagation(),window.$(".gold-box-mask").hide()})),window.$(".gold-box-mask").on("click",".gold-box-open",(function(e){e.stopPropagation();let n=this.dataset.type;"open"==n?(new Date).getTime()-Ho>200&&(t.payGoldBox(),Ho=(new Date).getTime()):"sure"==n&&(0==t.goldBoxNum?window.$(".gold-box-mask").hide():t.showGoldBox())})),window.$(".chat-center-gift-list").on("click",".chat-center-gift-item",(function(){const e=window.$(this).parent();e.find(".chat-center-gift-item").removeClass("current"),window.$(this).addClass("current");const n=this.dataset,i=n.type,o=n.id,s=n.to_uid,a=n.pack,r=n.price;t.currentGiftId=o;const c=e.get(0).dataset.id;t.resetInputGiftCount();24==i?window.$("#giftListCtnGiftTipCtn").html('<a href="https://y.tuwan.com/activity/575C87d860" target="_blank" id="chat-center-gift-tip">礼盒礼物说明</a>'):window.$("#giftListCtnGiftTipCtn").html('<a href="https://y.tuwan.com/activity/36C33a2de?v=1656553263108#/" target="_blank" id="chat-center-gift-tip">魔法礼物说明</a>'),866==o?(1==t.is_send?(window.$(".sendgift-user").show(),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex")):(window.$(".baobox-title").html(t.formatBoxtitle(n.intro)),window.$(".baobox-title").css("display","flex"),window.$(".sendgift-user").hide()),t.checkGiftButtonStatus(i,o)):368==o?(t.showBaBaBox(),t.checkGiftButtonStatus(i,o),window.$(".baobox-title").hide(),window.$(".sendgift-user").hide()):389==o?(t.showPowerPack(),t.checkGiftButtonStatus(i,o),window.$(".baobox-title").html(`礼包价值：<span style="color:#ff6691;">${r/100}点点币</span>`),window.$(".baobox-title").css("display","flex"),window.$(".sendgift-user").hide()):7==c&&7==i||3==c&&7==i||873==o?(t.checkGiftButtonStatus(i,o),window.$(".baobox-title").html(t.formatBoxtitle(n.intro)),window.$(".baobox-title").css("display","flex"),window.$(".sendgift-user").hide()):16==i?0==s?(Vi.getInstance().showOwnerBox(o),t.checkGiftButtonStatus(i,o,s),window.$(".sendgift-user").hide(),window.$(".baobox-title").hide()):(t.checkGiftButtonStatus(i,o,s),window.$(".sendgift-user").show(),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex")):1e4==i?qt.get(Ot.newUserGiftDoit(o)).then((t=>{0==t.error&&Wi.getInstance().showNewUserGiftModal(JSON.parse(a))})):(t.checkGiftButtonStatus(0,0),window.$(".baobox-title").hide(),window.$(".sendgift-user").css("display","flex"),window.$(".sendgift-user").show()),866!=o&&873!=o||(866==o?Vo.initFn(1):Vo.initFn(2))}))}}class Ko{constructor(){this.initStyle(),this.initHtml(),this.stage_list=[],this.unit="",this.stage=1,this.actStage=null,this.cp_info=[],this.cp_info_left=[],this.header=["https://activity-static.tuwan.com/static/png/20210729/4ff8a4c3c9851aeeca02c81d18e6033d.png","https://activity-static.tuwan.com/static/png/20210729/23777c3c03a8c52cfa4bbd1b7542a96a.png"],this.awardPic=["https://asset.tuwan.com/activity/520/chat_will_take.png","https://asset.tuwan.com/activity/520/chat_take.png","https://asset.tuwan.com/activity/520/chat_taked.png"],this.recommend=[],this.stageText=[{title:"19点开启",text:"猜猜我们默契有多少...",img:"https://asset.tuwan.com/activity/2021qixi/start_time.png"},{title:"邀请CP开启",text:"猜猜我们默契有多少...",img:"https://asset.tuwan.com/activity/2021qixi/invite_cp.png"},{title:"取消邀请",text:"您的CP正在赶来的路上",img:"https://asset.tuwan.com/activity/2021qixi/close_invite.png"}],this.stageTimer=null,this.scoketData={},this.fucHandle=new Map([[/^stage_[0-2]$/,this.loverStage0],[/stage_3/,this.beginAnsQue],[/^stage_[4-5]$/,this.ansedQue],[/^stage_6$/,this.actFinished],[/type_0/,this.actNotOpen],[/type_1/,this.inviteUser],[/type_2/,this.closeMyInvite],[/type_invite/,this.receiveInvite],[/type_refuse_invite/,this.refuseMyinvite],[/type_close_invite/,this.closeInvite],[/type_3/,this.refuseInvite],[/type_4/,this.acceptInvite],[/type_5/,this.shareDynamics],[/type_start_answer/,this.resetScore],[/type_cp_answer/,this.compareAns]]),this.myAns="",this.ansTimer=null,this.waitTimer=null,this.imgObj=null,this.imgBolb=null,this.ossImgObj={},this.ossClient=null,this.GETOSSTOKEN=`https://sts-server-${It?"test":"tuwan"}.tuwan.com/upload/getOssToken`,this.OSSCALLBACK=`https://sts-server-${It?"test":"tuwan"}.tuwan.com/upload/callback`,this.isShare=!1,this.groupId=0,this.isrequest=!1,this.imagesArr=new Array,this.preloadArr=["https://asset.tuwan.com/activity/2021qixi/start_time.png","https://asset.tuwan.com/activity/2021qixi/invite_cp.png","https://asset.tuwan.com/activity/2021qixi/close_invite.png","https://asset.tuwan.com/activity/2021qixi/refuse_invite.png","https://asset.tuwan.com/activity/2021qixi/revice_invite.png"],this.preload()}static getInstance(){return this.instance||(this.instance=new Ko),this.instance}preload(){for(let t=0;t<this.preloadArr.length;t++)this.imagesArr[t]=new Image,this.imagesArr[t].src=this.preloadArr[t]}initStyle(){window.$("head").append("<style>\n                        .ygb_flex{display:flex}\n                        .ygb_flex_align_c{display:flex;align-items:center}\n                        .ygb_flex_c{display:flex;align-items:center;justify-content:center}\n                        .ygb_cursor{cursor: pointer;}\n                        .ygb_hide{display:none}\n                        .common_text_style{position: relative;color: #ffc7fa;}\n                        .common_text_style::before {content: attr(text);position: absolute;z-index: 10;color: #fff;-webkit-mask: linear-gradient(to bottom, #fff, transparent);}\n                        .text_over {overflow: hidden;text-overflow: ellipsis;white-space: nowrap}\n                        .lover_day_modal,.act_share_modal,.act_search_modal{position:fixed;display:flex;background:rgba(0,0,0,0.8);top:0;left:0;width:100%;height:100%;z-index:99999;align-items:center;justify-content:center;color:#ffbfff}\n                        .lover_day_content{position:relative;width:681px;height:690px;background:url(https://asset.tuwan.com/activity/2021qixi/chat_lover_bg.png?v=1);}\n                        .lover_day_close{position:absolute;width:36px;height:36px;top:-20px;right:-20px}\n                        .lover_day_tab_content{margin-top:-22px}\n                        .lover_day_tab_item{width:252px;height:70px;margin:0 10px;background:url(https://asset.tuwan.com/activity/2021qixi/chat_ans_title.png);position:relative;z-index:100}\n                        .stage_left_content{margin-left:60px;margin-top:45px}\n                        .act_stage_item{width:120px;height:44px;background:url(https://asset.tuwan.com/activity/520/chat_stage.png);background-size:100% 100%;margin-bottom:26px;text-align:center;flex-direction: column;font-size:16px;}\n                        .act_stage_item.actived{background-image:url(https://asset.tuwan.com/activity/520/stage_s.png);}\n                        .stage_item_num{font-size:12px;}\n                        .act_stage_item.actived .stage_item_name{color:#fff}\n                        .act_stage_item.actived .stage_item_num{color:#fff}\n                        .stage_right_content{position:relative;width:500px;margin-left:10px;text-align:center;margin-top:-14px;}\n                        .stage_cp_content{margin-left:-34px}\n                        .stage_cp_content_item{text-align: center;font-size: 16px;}\n                        .stage_cp_header {width: 200px;height: 200px;position: relative;margin: 0 auto;}\n                        .stage_cp_avatar_bg {width: 200px;position: absolute;z-index: 10;left: 0;}\n                        .stage_cp_avatar {width: 120px;height: 120px;border-radius: 50%;z-index: 1;}\n                        .stage_cp_name {font-size: 16px;width:150px;margin:-24px auto 0}\n                        .stage_cp_score{font-size:12px;}\n                        .lover_change_cp{position: absolute;width:68px;height:36px;top: 170px;left: 50%;z-index: 100;transform: translateX(-50%);}\n                        .stage_pro_content {position: relative;width: 408px;height: 18px;margin: 15px 0px 0 24px;background: url(https://asset.tuwan.com/activity/520/chat_pro_bg.png);}\n                        .stage_pro_bar {max-width: 408px;height: 18px;background: url(https://asset.tuwan.com/activity/520/chat_pro_value.png) no-repeat left center;}\n                        .stage_pro_icon {z-index: 100;}\n                        .stage_pro_tips_content {flex-direction: column;width: 200px;position: absolute;top: -44%;transform: translateX(-50%);}\n                        .stage_pro_tips {font-size: 12px;text-align: center;line-height: 20px;margin-top:-5px}\n                        .stage_gift_content{width:500px;margin-top:48px;text-align:center;font-size:12px}\n                        .stage_gift_content>div{width:120px;}\n                        .act_stage_gift_item {width: 90px;height: 90px;background: url(https://asset.tuwan.com/activity/520/gift_item.png);background-size:100% 100%;margin: 0 auto;margin-bottom: 6px;box-sizing: border-box;}\n                        .act_stage_gift_item img {max-width: 80%;max-height: 80%;}\n                        .stage_gift_btn{width:179px;height:69px;margin:4px auto 0}\n                        .ans_content,.act_share_content,.act_ans_content{flex-direction: column;}\n                        .stage_task_content{position:absolute;bottom:-170px;left:50%;transform: translateX(-50%);width:600px}\n                        .lover_cp_content{margin:24px auto 0}\n                        .act_common_title{font-size:24px;height:200px}\n                        .act_que_content{height:140px}\n                        .act_ansed_title{font-weight:bold;font-size:24px;margin-top:34px;text-align:center}\n                        .lover_stage_btn_item{width:163px;height:49px;font-size:22px;margin:0 10px}\n                        .lover_stage_btn_item div{font-family:loverday;}\n                        .lover_text_tips{font-size:14px;color:#dca5ff;text-align:center;margin-top:30px}\n                        .act_ans_item{width:484px;height:102px;background:url(https://asset.tuwan.com/activity/520/lover_ans_bg.png);margin:0 auto 10px;font-size:16px;color:#ffb2ff;position:relative}\n                        .act_ans_item_option{margin:0 20px 0 30px;font-size:32px;}\n                        .act_cp_ans{margin-right:10px}\n                        .act_ans_choose_content{position:absolute;top:50%;transform: translateY(-50%);right:30px}\n                        .act_ans_score{margin-top:10px;text-align:center}\n                        .act_ans_score span{color:#ff3e99}\n                        .act_countdown{display:none;text-align:center}\n                        .act_ansed_tips{text-align:center;line-height:24px;width:340px;margin:10px auto 30px}\n                        .act_final_award_item{width:110px;flex-direction: column;font-size:14px;margin:0 10px}\n                        .act_final_award_pic{width:94px;height:94px;background:url(https://asset.tuwan.com/activity/520/gift_item.png);background-size:100% 100%;text-align:center;margin-bottom:6px;}\n                        .act_final_award_pic img{max-width:80%;max-height:80%}\n                        .act_share_pic{display:block;width:48px;height:48px;background:url(https://asset.tuwan.com/activity/520/ans_share.png?v=1);margin:14px 10px 4px}\n                        .act_save_pic{display:block;width:48px;height:48px;background:url(https://asset.tuwan.com/activity/520/ans_download.png?v=1);margin:14px 10px 4px}\n                        .act_share_zone{display:block;width:48px;height:48px;background:url(https://asset.tuwan.com/activity/520/ans_share_zone.png?v=1);margin:14px 10px 4px}\n                        .lover_day_item_content{position:relative}\n                        .act_rule_btn{position:absolute;top:50px;right:2px;width:25px;z-index:100;height:82px;background:url(https://asset.tuwan.com/activity/520/lover_rule_btn.png)}\n                        .act_share_content{width:400px;position:relative}\n                        .act_share_modal_close{position:absolute;right:-30px;top:-30px}\n                        .search_modal_content {position:relative;width: 631px;height: 670px;padding: 60px 50px 0;font-size: 16px;box-sizing: border-box;background-image: url(https://asset.tuwan.com/activity/2021qixi/search_bg.png?V=1);z-index:100}\n                        .search_modal_close {position: absolute;top: -10px;right: -18px;}\n                        .search_content {width: 400px;height: 44px;margin: 0 auto;}\n                        .search_item_content{display:none}\n                        .search_input {border: 0;outline: 0;width: 300px;height: 36px;border-radius: 18px;background-color: #5e0c99;text-align: center;color: #fff;font-size: 14px;margin-right: 10px;}\n                        .search_input::-webkit-input-placeholder {color: #c19fe1;}\n                        .search_modal_title {font-size: 18px;font-weight: bold;margin-top: 10px;margin-bottom: 10px;}\n                        .search_user_avatar {width: 80px;height: 80px;border-radius: 50%;border: 2px solid #fdabf1;}\n                        .attention_item {width: 25%;flex-direction: column;text-align: center;}\n                        .attention_name {margin-top: 4px;margin-bottom: 6px;}\n                        .search_info_content {height: 316px;flex-wrap: wrap;}\n                        .search_item {height: 100px;align-items: center;width: 50%;}\n                        .search_name {margin-bottom: 10px;}\n                        .scroll_list {overflow-y: auto;}\n                        .scroll_list::-webkit-scrollbar {width: 6px;}\n                        .scroll_list::-webkit-scrollbar-thumb {width: 6px;background: #faa3d9;border-radius: 3px;}\n                        .set_cp_confirm{position:absolute;top:50%;left:50%;width:376px;height:218px;background: url(https://asset.tuwan.com/activity/520/set_cp_confirm_bg.png);transform: translate(-50% ,-50%);z-index:100;text-align:center}\n                        .set_cp_confirm_title{font-size:24px;font-family:loverday;margin-top:30px}\n                        .set_cp_confirm_tips{font-size:18px;margin:18px auto 30px;}\n                        .set_cp_confirm_btn>img{margin:0 10px}\n                        .act_rule_title{text-align:center;font-size:24px;font-family:loverday;}\n                        .act_rule_item{line-height:30px}\n                        .act_que_ans_content{display:none}\n                        .ansed_img{width:400px}\n                        .act_que_time_tips{color:#ffd8f6;font-size:14px;margin-top:2px;text-align:center}\n                    </style>")}initHtml(){window.$("body").append('<div class="lover_day_modal" style="display:none">\n                        <div class="lover_day_content">\n                            <div class="act_rule_btn ygb_cursor"></div>\n                            <img class="ygb_cursor lover_day_close" src="https://asset.tuwan.com/activity/vday/close.png">\n                            <div class="lover_day_tab_content ygb_flex_c">\n                                <div class="lover_day_tab_item ygb_cursor ygb_flex_c actived"></div>\n                            </div>\n                            <div class="lover_day_item_content ygb_flex" style="display:none">\n                                <div class="stage_left_content"></div>\n                                <div class="stage_right_content">\n                                    <div class="stage_cp_content ygb_flex_c"></div>\n                                    <div class="stage_pro_content">\n                                        <div class="stage_pro_bar"></div>\n                                        <div class="stage_pro_tips_content ygb_flex_c">\n                                            <img class="stage_pro_icon" src="https://asset.tuwan.com/activity/520/chat_pro_icon.png">\n                                            <div class="stage_pro_tips"></div>\n                                        </div>\n                                    </div>\n                                    <div class="stage_gift_content ygb_flex_c"></div>\n                                    <div class="stage_gift_btn ygb_cursor"></div>\n                                </div>\n                                <img class="stage_task_content">\n                            </div>\n                            <div class="lover_day_item_content ans_content ygb_flex">\n                                <div class="lover_cp_content ygb_flex_c"></div>\n                                \x3c!-- 答题开始之前  --\x3e\n                                <div class="act_que_ans_content">\n                                    <div class="act_common_title ygb_flex_c">\n                                        <div class="lover_stage_text common_text_style"></div>\n                                        <img class="act_loading" style="width:26px" src="https://asset.tuwan.com/activity/520/loading.gif?v=1">\n                                    </div>\n                                    <div class="lover_stage_btn_content ygb_flex_c ygb_cursor"></div>\n                                    <div class="lover_text_tips">晚上19点开放，CP在聊天室内即可参与默契考验，<br>每人只能参与两次(发起或接受)，请珍惜机会哦</div>\n                                </div>\n                                \x3c!-- 开始答题  --\x3e\n                                <div class="act_que_ans_content">\n                                    <div class="act_que_content act_common_title ygb_flex_c">\n                                        <div class="act_que_text common_text_style"></div>\n                                    </div>\n                                    <div class="act_ans_content ygb_flex_c ygb_cursor"></div>\n                                    <div class="act_ans_score">累计考验获得<span>0分</span></div>\n                                </div>\n                                \x3c!-- 答题结束  --\x3e\n                                <div class="act_que_ans_content">\n                                    <div class="act_ansed_title common_text_style"></div>\n                                    <div class="act_ansed_tips"></div>\n                                    <div class="act_final_award ygb_flex_c"></div>\n                                    <div class="ygb_flex_c ygb_cursor" style="margin-top:20px">\n                                        <div class="lover_stage_btn_item ygb_flex_c" data-type="5">\n                                            <img src="https://asset.tuwan.com/activity/2021qixi/chat_share.png">\n                                        </div>\n                                    </div>\n                                    <div class="act_que_time_tips"></div>\n                                </div>\n                                \x3c!-- 分享弹窗  --\x3e\n                                <div class="act_share_modal ygb_flex_c" style="display:none">\n                                    <div class="act_share_content ygb_flex_c">\n                                        <img class="ygb_cursor act_share_modal_close" src="https://asset.tuwan.com/activity/vday/close.png">\n                                        <img class="ansed_img" src="">\n                                        <div class="ygb_flex_c">\n                                            <div  class="ygb_flex_c" style="width:100px;font-size:14px;flex-direction:column">\n                                                <a class="act_share_pic ygb_cursor"></a>\n                                                <div>分享到动态</div>\n                                            </div>\n                                            <div  class="ygb_flex_c" style="width:100px;font-size:14px;flex-direction:column">\n                                                <a class="act_share_zone ygb_cursor"></a>\n                                                <div>分享到空间</div>\n                                            </div>\n                                            <div  class="ygb_flex_c" style="width:100px;font-size:14px;flex-direction:column">\n                                                <a class="act_save_pic" href="" download="默契考验.png"></a>\n                                                <div>保存到本地</div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="act_search_modal ygb_flex_c" style="display:none;z-index:100">\n                            <div class="search_modal_content">\n                                <img src="https://asset.tuwan.com/activity/vday/close.png" class="search_modal_close ygb_cursor">\n                                <div class="search_item_content">\n                                    <div class="search_content ygb_flex_c">\n                                        <input type="text" class="search_input" placeholder="请输入UID/昵称/靓号">\n                                        <img class="search_btn ygb_cursor" src="https://asset.tuwan.com/activity/vday/search_btn.png?v=1">\n                                    </div>\n                                    <div class="search_modal_title">为你推荐</div>\n                                    <div class="attention_content ygb_flex"> </div>\n                                    <div class="search_modal_title">搜索结果</div>\n                                    <div class="search_info_content ygb_flex scroll_list"></div>\n                                </div>\n                                <div class="search_item_content" style="width:510px;margin:0 auto">\n                                    <div class="common_text_style act_rule_title" text="规则说明">规则说明</div>\n                                    <div class="act_rule_item">默契考验：</div>\n                                    <div class="act_rule_item">1.2月13日晚19-21点可参与默契考验活动；</div>\n                                    <div class="act_rule_item">2.双方参与默契答题时，回答相同可获得贡献值、头衔以及龙珠奖励，默契分越高奖励越高</div>\n                                    <div class="act_rule_item">3.每人只能参与两次(无论发起或接受)；</div>\n                                    <div class="act_rule_item">当日参与默契考验答题后，默契考验内容定格在结果页;</div>\n                                    <div class="act_rule_item">结果页：显示最后一次参与默契考验的结果；</div>\n                                    <div class="act_rule_item">例如：</div>\n                                    <div class="act_rule_item">用户A（发起方）向用户B发起默契考验，两人完成默契考验后，</div>\n                                    <div class="act_rule_item">结果都定格在结果页；</div>\n                                    <div class="act_rule_item">但如有其他人邀请用户A或B，A和B还可以再参与一次默契考验活动；</div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="set_cp_confirm" style=\'display:none\'>\n                            <div class="set_cp_confirm_title common_text_style" text="提示">提示</div>\n                            <div class="set_cp_confirm_tips common_text_style">活动页中爱情之旅会同步修改哦</div>\n                            <div class="set_cp_confirm_btn ygb_flex_c">\n                                <img class="set_cp_cancel ygb_cursor" src="https://asset.tuwan.com/activity/520/set_cp_cancel.png">\n                                <img class="set_cp_sure ygb_cursor" src="https://asset.tuwan.com/activity/520/set_cp_sure.png">\n                            </div>\n                        </div>\n                    </div>'),this.initEvents()}initAct(t){this.getAnsData(t)}getLoverDayData(t){qt.get(`${Dt}/activity/commonActivity?id=${t}`).then((e=>{const{stage_list:n,stage:i,mileage:o,mileage_rate:s,recommend:a,cp_info:r,unit:c,images:l}=e;this.actId=t,this.unit=c,this.stage=i,this.cp_info_left=r,this.recommend=a,window.$(".lover_day_modal").css("display","flex"),window.$(".stage_pro_bar").css("width",`${s}%`),window.$(".stage_pro_tips_content").css("left",`${s}%`),window.$(".stage_pro_tips").html(`当前${c+o}点`),window.$(".stage_task_content").attr("src",l.other[0]);let d=[];a.forEach((t=>{d.push(`<div class="attention_item flex_c">\n                                <img class="search_user_avatar" src="${t.avatar}">\n                                <div class="attention_name text_over">${t.nickname}</div>\n                                <img class="ygb_cursor act_set_cp" data-uid="${t.uid}" src="https://asset.tuwan.com/activity/520/set_cp_1_m.png">\n                            </div>`)})),window.$(".attention_content").html(d.join(""))}))}renderStageLeft(){let t=[];this.stage_list.forEach((e=>{t.push(`<div class="act_stage_item ygb_cursor ygb_flex_c ${e.stage==this.stage?"actived":""}" data-stage='${e.stage}'>\n                        <div class="stage_item_name">${e.name}</div>\n                        <div class="stage_item_num">${e.num+this.unit}</div>\n                    </div>`)})),window.$(".stage_left_content").html(t.join(""))}renderCpInfo(t){let e=[];const n=0==t?this.cp_info_left:this.cp_info;for(let i=0;i<2;i++){let o=0==i?'<div><img class="act_heart_pic" src="https://asset.tuwan.com/activity/2021qixi/chat_cp_heart.png"><div class="act_countdown"></div></div>':"";e.push(`<div class="stage_cp_content_item">\n                        <div class="stage_cp_header ygb_flex_c">\n                            <img class="stage_cp_avatar_bg" src="${this.header[i]}">\n                            <img class="stage_cp_avatar" src="${n[i]?n[i].avatar:"https://uc.tuwan.com/images/noavatar_1.jpg"}"">\n                        </div>\n                        <div class="stage_cp_name text_over">${n[i].nickname?n[i].nickname:"虚位以待"}</div>\n                        <img src="https://asset.tuwan.com/activity/2021qixi/change_cp_p.png" class="lover_change_cp ygb_cursor">\n                        <div class="stage_cp_score" style="display:${0==t?"block":"none"}">当前${this.unit+(n[i]?n[i].score:"0")}点</div>\n                    </div>${o}`)}0==t?window.$(".stage_cp_content").html(e.join("")):window.$(".lover_cp_content").html(e.join(""))}renderStageGift(){let t=[],e=this.stage_list[this.stage_list.length-this.stage],n=e.award,i=e.is_award;n.forEach((e=>{t.push(`<div>\n                        <div class="act_stage_gift_item ygb_flex_c">\n                            <img src="${e.pic}">\n                        </div>\n                        <div>${e.title}</div>\n                    </div>`)})),window.$(".stage_gift_content").html(t.join("")),window.$(".stage_gift_btn").css("background",`url(${this.awardPic[i+1]}) no-repeat center center`)}showAnsContent(t){}getAnsData(t){qt.get(`${Dt}/activity2021/getAnswerProgress?id=${t||this.actId}`).then((e=>{if(0==e.error){let{stage:n,cp_info:i,countdown:o,group_id:s,unit:a}=e.data;this.unit=a,this.actId=t||this.actId,this.cp_info=i,this.groupId=s,this.renderCpInfo(1),this.scoketData=e.data,this.actStage=n;let r=this.cp_info[0].uid==uu.getMeid();o>0&&r&&(this.loverFucMap("stage",n),this.countDownTimer(o)),2!=n||r?this.loverFucMap("stage",n):this.loverFucMap("type","invite"),this.isrequest=!1,window.$(".lover_day_modal").css("display","flex")}}))}actSocketData(t){this.scoketData=t,this.loverFucMap("type",t.mark)}loverFucMap(t,e){[...this.fucHandle].filter((([n,i])=>n.test(`${t}_${e}`))).forEach((([t,e])=>e.call(this)))}loverStage0(){window.$(".act_loading").hide(),window.$(".act_que_ans_content").hide(),window.$(".act_que_ans_content").eq(0).show(),window.$(".lover_stage_text").attr("text",this.stageText[this.actStage].text),window.$(".lover_stage_text").html(this.stageText[this.actStage].text+""+(this.actStage,"")),2==this.actStage&&window.$(".act_loading").show(),window.$(".lover_stage_btn_content").html(`<div class="lover_stage_btn_item ygb_flex_c" data-type="${this.actStage}">\n                <img src="${this.stageText[this.actStage].img}">\n            </div>`)}actFinished(){window.$(".act_loading").hide(),window.$(".lover_change_cp").hide(),window.$(".act_que_ans_content").hide(),window.$(".act_que_ans_content").eq(0).show(),window.$(".lover_stage_text").attr("text","活动结束"),window.$(".lover_stage_text").html("活动结束"),window.$(".lover_stage_btn_content").html('<div class="lover_stage_btn_item ygb_flex_c" data-type="10">\n                <div text="活动结束" class="common_text_style">活动结束</div>\n            </div>')}actNotOpen(){Vt("活动未开始")}inviteUser(){qt.get(`${Dt}/activity2021/invite?uid=${this.cp_info[1]?this.cp_info[1].uid:0}&id=${this.actId}`).then((t=>{0==t.error?(this.actStage=2,this.loverFucMap("stage",this.actStage),this.countDownTimer(30)):10==t.error&&(window.$(".act_search_modal").css("display","flex"),window.$(".search_item_content").hide(),window.$(".search_item_content").eq(0).show()),Vt(t.error_msg)}))}countDownTimer(t){this.stageTimer&&clearTimeout(this.stageTimer),this.actStage=2,this.stageTimer=setTimeout((()=>{this.loverFucMap("type",this.actStage)}),1e3*t)}closeMyInvite(){qt.get(`${Dt}/activity2021/closeInvite?id=${this.actId}`).then((t=>{clearTimeout(this.stageTimer),this.actStage=1,this.loverFucMap("stage",this.actStage)}))}receiveInvite(){window.$(".act_que_ans_content").hide(),window.$(".act_que_ans_content").eq(0).show(),this.cp_info=this.scoketData.cp_info,this.renderCpInfo(1),this.showAnsContent(1),window.$(".lover_day_modal").css("display","flex"),window.$(".lover_stage_text").attr("text","您的CP正在邀请您"),window.$(".lover_stage_text").html("您的CP正在邀请您"),window.$(".act_loading").show(),window.$(".lover_stage_btn_content").html('<div class="lover_stage_btn_item ygb_flex_c" data-type="3">\n                <img src="https://asset.tuwan.com/activity/2021qixi/refuse_invite.png">\n            </div>\n            <div class="lover_stage_btn_item ygb_flex_c" data-type="4">\n                <img src="https://asset.tuwan.com/activity/2021qixi/revice_invite.png">\n            </div>')}refuseInvite(){this.isrequest||(this.isrequest=!0,qt.get(`${Dt}/activity2021/refuseInvite?id=${this.actId}`).then((t=>{this.getAnsData(this.actId),this.actStage>1&&Vt(t.error_msg)})))}closeInvite(){this.getAnsData(this.actId)}refuseMyinvite(){clearTimeout(this.stageTimer),this.actStage=1,this.loverFucMap("stage",this.actStage)}acceptInvite(){this.isrequest||(this.isrequest=!0,qt.get(`${Dt}/activity2021/agreeInvite?id=${this.actId}`).then((t=>{this.actStage=3,this.loverFucMap("stage",this.actStage),Vt(t.error_msg)})))}resetScore(){window.$(".act_ans_score span").text("0分"),this.isShare=!1}beginAnsQue(){this.myAns="",clearTimeout(this.stageTimer),clearInterval(this.ansTimer),clearInterval(this.waitTimer),this.showAnsContent(1),this.isrequest=!1,window.$(".lover_change_cp").hide(),window.$(".act_que_ans_content").hide(),window.$(".act_que_ans_content").eq(1).show(),window.$(".lover_cp_content .act_heart_pic").attr("src","https://asset.tuwan.com/activity/520/lover_stopwatch.png"),window.$(".lover_cp_content .act_countdown").show(),this.scoketData.last_question?(this.renderNextQueDetail(this.scoketData.last_question),this.compareAns()):this.renderNextQue(this.scoketData)}renderNextQue(t){if(this.myAns="",null==t)return void this.getAnsData();if(null==t.question)return void this.getAnsData();let{number:e,countdown:n}=t;this.renderNextQueDetail(t);let i=n>10?10:n;clearInterval(this.ansTimer),window.$(".lover_cp_content .act_countdown").html(`${i}秒`),this.ansTimer=setInterval((()=>{0==i?(clearInterval(this.ansTimer),this.commitAns("C",e)):(i--,window.$(".lover_cp_content .act_countdown").html(`${i}秒`))}),1e3)}renderNextQueDetail(t){let{number:e,question:n,answer:i}=t;window.$(".act_que_text").attr("text",`${e}.${n}`),window.$(".act_que_text").text(`${e}.${n}`);let o=[];i.forEach(((t,n)=>{o.push(`<div class="act_ans_item ygb_flex_align_c ygb_cursor" data-choose="0" data-ans="${0==n?"A":"B"}" data-num="${e}">\n                            <div class="act_ans_item_option">${0==n?"A":"B"}</div>\n                            <div class="act_ans_item_text">${t}</div>\n                            <div class="act_ans_choose_content">\n                                <img class="act_cp_ans" style="display:none" src="https://asset.tuwan.com/activity/520/lover_choose_right.png">\n                                <img class="act_self_ans" src="https://asset.tuwan.com/activity/520/lover_choose.png">\n                            </div>\n                        </div>`)})),window.$(".act_ans_content").html(o.join(""))}commitAns(t,e){this.myAns=t,window.$(`.act_ans_item[data-ans="${t}"]`).find(".act_self_ans").attr("src","https://asset.tuwan.com/activity/520/lover_choose_right.png"),qt.get(`${Dt}/activity2021/commitAnswer?answer=${t}&number=${e}&id=${this.actId}`).then((t=>{0==t.error||Vt(t.error_msg)}))}compareAns(){window.$(".act_ans_item").attr("data-choose","1");let{answer:t,sum_score:e,next_question:n,last_question:i,question:o,countdown:s,number:a}=this.scoketData,r=i?i.my_answer:this.myAns,c=i?i.cp_answer:t,l={};if(l=null==n?{number:a,countdown:s,question:o,answer:t}:n,"C"==r||"C"==c)this.renderNextQue(n);else{r==c?window.$(`.act_ans_item[data-ans="${c}"]`).find(".act_cp_ans").show():window.$(`.act_ans_item[data-ans="${c}"]`).find(".act_self_ans").attr("src","https://asset.tuwan.com/activity/520/lover_choose_false.png"),i&&window.$(`.act_ans_item[data-ans="${r}"]`).find(".act_self_ans").attr("src","https://asset.tuwan.com/activity/520/lover_choose_right.png"),window.$(".act_ans_score span").text(`${e}分`);let t=i?s:null!==n?n.countdown-10:2;window.$(".lover_cp_content .act_countdown").html(""),t>0?(clearInterval(this.ansTimer),this.waitTimer=setInterval((()=>{1==t?(clearInterval(this.waitTimer),this.renderNextQue(l)):t--}),1e3)):this.renderNextQue(l)}}ansedQue(){const{title:t,text:e,award:n,img_url:i,surplus_text:o,cp_info:s}=this.scoketData;window.$(".act_que_ans_content").hide(),window.$(".act_que_ans_content").eq(2).show(),window.$(".act_ansed_title").text(t),window.$(".act_ansed_title").attr("text",t),window.$(".act_ansed_tips").html(e),window.$(".ansed_img").attr("src",i),window.$(".act_que_time_tips").html(o),this.getBase64(".act_save_pic",i),this.cp_info=s,this.renderCpInfo(1),window.$(".lover_cp_content .act_heart_pic").attr("src","https://asset.tuwan.com/activity/2021qixi/chat_cp_heart.png"),window.$(".lover_cp_content .act_countdown").hide();let a=[];n.forEach((t=>{a.push(`<div class="act_final_award_item ygb_flex_c">\n                            <div class="act_final_award_pic ygb_flex_c">\n                                <img src="${t.pic}">\n                            </div>\n                            <div>${t.title}</div>\n                        </div>`)})),window.$(".act_final_award").html(a.join("")),window.$(".lover_change_cp").hide()}shareDynamics(){window.$(".act_share_modal").css("display","flex")}changeCp(t){qt.get(`${Dt}/active2020/bindNationalDayCp?uid=${t}&id=${this.actId}`).then((t=>{0==t.error&&(this.closeMyInvite(),this.refuseInvite(),this.initAct(this.actId),window.$(".act_search_modal").hide()),Vt(t.error_msg)}))}search(t){qt.get(`${Dt}/active2020/searchuser?kw=${t}`).then((t=>{if(t.data.length>0){let e=[];t.data.forEach((t=>{e.push(`<div class="search_item flex">\n                                <img class="search_user_avatar" src="${t.avatar}">\n                                <div>\n                                    <div class="search_name text_over">${t.nickname}</div>\n                                    <img class="ygb_cursor act_set_cp" data-uid="${t.uid}" src="https://asset.tuwan.com/activity/520/set_cp_1_m.png">\n                                </div>\n                            </div>`)})),window.$(".search_info_content").html(e.join(""))}}))}getBase64(t,e){let n=this;window.URL=window.URL||window.webkitURL;var i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="blob",i.onload=function(){if(200==this.status){n.imgObj=new Image,n.imgObj.src=e,n.imgBolb=this.response;let i=window.URL.createObjectURL(n.imgBolb);window.$(t).attr("href",i),n.initOssClient()}},i.send()}async initOssClient(){await Ct.loadScript("https://asset1.tuwan.com/officialsite/script/aliyun-oss-sdk-6.0.1.js");const{AccessKeyId:t,AccessKeySecret:e,SecurityToken:n,EndPoint:i,BucketName:o}=await this.getToken(this.GETOSSTOKEN);this.client=new window.OSS({endpoint:i,accessKeyId:t,accessKeySecret:e,bucket:o,stsToken:n,secure:!0}),this.ossImgObj.bucketName=o}async putObject(){try{this.ossImgObj.fileName=`attachment/image/${Ct.UUIDNOCA()}.png`;let t=Ct.UUIDNOCA();await this.client.multipartUpload(this.ossImgObj.fileName,this.imgBolb,{callback:{url:this.OSSCALLBACK,body:`BizId=${t}&fileName=${this.ossImgObj.fileName}&bucketName=${this.ossImgObj.bucketName}&positionNum=1&fileType=1&attachStatus=1&userId=${uu.getMeid()}&fileSize=${this.imgBolb.size}&width=${this.imgObj.width}&high=${this.imgObj.height}`}});const e={postContent:"一起来玩默契考验吧~",bizId:t,groupId:this.groupId,labelStr:"146,-1",latitude:0,longitude:0,parentPostId:0,releaseType:1,attachmentCount:1};0==(await qt.post(`https://post${It?"-test":"-tuwan"}.tuwan.com/post/savePost`,e)).code&&(Vt("分享成功"),this.isShare=!0)}catch(t){Vt("服务器繁忙，请稍后重试")}}getToken(t){return new Promise(((e,n)=>{window.$.ajax({url:t,type:"get",dataType:"json",xhrFields:{withCredentials:!0},success:t=>{e(t)},timeout:3e4,error:(t,e,i)=>{n({error:0})}})}))}qqSpaceShare(t){let e=[];for(let i in t)e.push(i+"="+encodeURIComponent(t[i]||""));const n="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+e.join("&");window.open(n)}initEvents(){const t=this,e=window.$(".lover_day_modal");e.on("click",".lover_day_close",(function(){e.hide()})),e.on("click",".act_share_modal_close",(function(){window.$(".act_share_modal").hide()})),e.on("click",".search_modal_close",(function(){window.$(".act_search_modal").hide()})),e.on("click",".stage_gift_btn",(function(){qt.get(`${Dt}/active2020/nationalDayAward?stage=${t.stage}&id=${t.actId}`).then((e=>{0==e.error&&t.getLoverDayData(t.actId),Vt(e.error_msg)}))})),e.on("click",".lover_stage_btn_item",(function(){const e=this.dataset.type;10!=e&&t.loverFucMap("type",e)})),e.on("click",".act_ans_item",(function(){const{ans:e,num:n,choose:i}=this.dataset;window.$(".act_ans_item").attr("data-choose","1"),0==i&&t.commitAns(e,n)})),e.on("click",".lover_change_cp",(function(){qt.get(`${Dt}/activity2021/getRecommendUser?id=${t.actId}`).then((e=>{if(0==e.error){const{list:n}=e.data;t.recommend=n;let i=[];n.forEach((t=>{i.push(`<div class="attention_item flex_c">\n                                <img class="search_user_avatar" src="${t.avatar}">\n                                <div class="attention_name text_over">${t.nickname}</div>\n                                <img class="ygb_cursor act_set_cp" data-uid="${t.uid}" src="https://asset.tuwan.com/activity/520/set_cp_1_m.png">\n                            </div>`)})),window.$(".attention_content").html(i.join("")),window.$(".act_search_modal").css("display","flex"),window.$(".search_item_content").hide(),window.$(".search_item_content").eq(0).show()}}))})),e.on("click",".search_btn",(function(){const e=window.$(".search_input").val();t.search(e)})),e.on("click",".act_set_cp",(function(){const e=this.dataset.uid;t.changeCp(e)})),e.on("click",".set_cp_cancel",(function(){window.$(".set_cp_confirm").hide()})),e.on("click",".set_cp_sure",(function(){const e=this.dataset.uid;window.$(".set_cp_confirm").hide(),t.changeCp(e)})),e.on("click",".act_rule_btn",(function(){window.$(".act_search_modal").css("display","flex"),window.$(".search_item_content").hide(),window.$(".search_item_content").eq(1).show()})),e.on("click",".act_share_pic",(function(){t.isShare?Vt("分享成功"):t.putObject()})),e.on("click",".act_share_zone",(function(){const e=window.$(".ansed_img").attr("src"),n={url:`https://y.tuwan.com/chatroom/${uu.getCid()}`,showcount:"0",desc:"一起来玩默契考验吧~",summary:"一起来玩默契考验吧~",title:"一起来玩默契考验吧~",site:"点点开黑官方聊天室",pics:e,style:"101",width:199,height:30};t.qqSpaceShare(n)}))}}const Yo="src/js/components/common/loading.svelte";function Jo(t){let e,n,i,o;const s={c:function(){e=tt("svg"),n=tt("path"),i=tt("path"),o=tt("animateTransform"),y(n,"opacity","0.2"),y(n,"fill","#9d9393"),y(n,"d","M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946\n    s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634\n    c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"),x(n,Yo,4,4,176),y(o,"attributeType","xml"),y(o,"attributeName","transform"),y(o,"type","rotate"),y(o,"from","0 20 20"),y(o,"to","360 20 20"),y(o,"dur","0.5s"),y(o,"repeatCount","indefinite"),x(o,Yo,9,4,703),y(i,"fill","#9d9393"),y(i,"d","M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0\n    C22.32,8.481,24.301,9.057,26.013,10.047z"),x(i,Yo,7,4,554),y(e,"version","1.1"),y(e,"id","loader-1"),y(e,"x","0px"),y(e,"y","0px"),y(e,"width","40px"),y(e,"height","40px"),y(e,"viewBox","0 0 40 40"),y(e,"enable-background","new 0 0 40 40"),y(e,"xml:space","preserve"),x(e,Yo,3,0,20)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,s){b(t,e,s),I(e,n),I(e,i),I(i,o)},p:k,i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:Jo.name,type:"component",source:"",ctx:t}),s}function Qo(t,e){let{$$slots:n={},$$scope:i}=e;f("Loading",n,[]);const o=[];return Object.keys(e).forEach((t=>{~o.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Loading> was created with unknown prop '${t}'`)})),[]}let Xo=class extends h{constructor(t){super(t),u(this,t,Qo,Jo,g,{}),p("SvelteRegisterComponent",{component:this,tagName:"Loading",options:t,id:Jo.name})}};const{console:Zo}=et,ts="src/js/components/kingTeamH5/index.svelte";function es(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g;const f={c:function(){e=_("div"),n=_("div"),i=M("我的"),s=T(),a=_("div"),r=M("战队荣誉"),l=T(),d=_("div"),m=_("img"),y(n,"role","presentation"),y(n,"class",o=R("tabItem "+(1==t[4]?"active":""))+" s-3tm9N8o4Zont"),x(n,ts,62,12,1863),y(a,"role","presentation"),y(a,"class",c=R("tabItem "+(2==t[4]?"active":""))+" s-3tm9N8o4Zont"),x(a,ts,64,12,2033),L(m.src,h="https://asset.tuwan.com/chartRoom/kingTeam/reloadIconX2.png")||y(m,"src","https://asset.tuwan.com/chartRoom/kingTeam/reloadIconX2.png"),y(m,"alt",""),y(m,"class","s-3tm9N8o4Zont"),x(m,ts,69,16,2448),y(d,"role","presentation"),y(d,"class","reloadBtn s-3tm9N8o4Zont"),x(d,ts,68,12,2358),y(e,"class","tabTitleCtn s-3tm9N8o4Zont"),x(e,ts,61,8,1825)},m:function(o,c){b(o,e,c),I(e,n),I(n,i),I(e,s),I(e,a),I(a,r),I(e,l),I(e,d),I(d,m),u||(g=[E(n,"click",t[8],!1,!1,!1,!1),E(a,"click",t[9],!1,!1,!1,!1),E(d,"click",t[7],!1,!1,!1,!1)],u=!0)},p:function(t,e){16&e&&o!==(o=R("tabItem "+(1==t[4]?"active":""))+" s-3tm9N8o4Zont")&&y(n,"class",o),16&e&&c!==(c=R("tabItem "+(2==t[4]?"active":""))+" s-3tm9N8o4Zont")&&y(a,"class",c)},d:function(t){t&&C(e),u=!1,V(g)}};return p("SvelteRegisterBlock",{block:f,id:es.name,type:"if",source:"(61:4) {#if team_id != 0}",ctx:t}),f}function ns(t){let e,n,i;n=new Xo({$$inline:!0});const o={c:function(){e=_("div"),U(n.$$.fragment),A(e,"text-align","center"),A(e,"margin-top","200px"),x(e,ts,94,8,3837)},m:function(t,o){b(t,e,o),z(n,e,null),i=!0},i:function(t){i||(q(n.$$.fragment,t),i=!0)},o:function(t){O(n.$$.fragment,t),i=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:o,id:ns.name,type:"if",source:"(94:8) {#if !isLoaded}",ctx:t}),o}function is(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k=0!=t[0]&&es(t),S=!t[6]&&ns(t);const M={c:function(){e=_("div"),k&&k.c(),n=T(),i=_("div"),o=_("div"),s=_("div"),a=_("iframe"),d=T(),m=_("div"),h=_("iframe"),v=T(),S&&S.c(),y(a,"title",""),y(a,"id","kingTeamIframe1"),L(a.src,r=`https://y${window.location.host.indexOf("dev")>-1||window.location.host.indexOf("test")>-1?"-test":""}.tuwan.com/${3==t[3]?"squadron":"peaceteam"}`)||y(a,"src",r),y(a,"style",c=`height: ${t[1]+(0==t[0]?50:0)+7}px; width: ${t[2]}; overflow-x: hidden;`),y(a,"class","s-3tm9N8o4Zont"),x(a,ts,76,16,2752),y(s,"class",l=R("tabShowerItem "+(1==t[4]?"active":""))+" s-3tm9N8o4Zont"),x(s,ts,75,12,2673),y(h,"title",""),y(h,"id","kingTeamIframe2"),L(h.src,u=`https://y${window.location.host.indexOf("dev")>-1||window.location.host.indexOf("test")>-1?"-test":""}.tuwan.com/${3==t[3]?"squadron":"peaceteam"}#/introduce/${t[0]}`)||y(h,"src",u),y(h,"style",g=`height: ${t[1]+(0==t[0]?50:0)}px; margin-top: 11px;width: ${t[2]}; overflow-x: hidden;`),y(h,"class","s-3tm9N8o4Zont"),x(h,ts,85,16,3320),y(m,"class",f=R("tabShowerItem "+(2==t[4]?"active":""))+" s-3tm9N8o4Zont"),x(m,ts,84,12,3241),y(o,"style",w="display: "+(t[6]?"block":"none")),x(o,ts,74,8,2605),y(i,"class","tabCtn s-3tm9N8o4Zont"),x(i,ts,73,3,2576),y(e,"class","kingTeamTabContainer s-3tm9N8o4Zont"),x(e,ts,59,0,1759)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(r,c){b(r,e,c),k&&k.m(e,null),I(e,n),I(e,i),I(i,o),I(o,s),I(s,a),t[10](a),I(o,d),I(o,m),I(m,h),I(i,v),S&&S.m(i,null),$=!0},p:function(t,[d]){0!=t[0]?k?k.p(t,d):(k=es(t),k.c(),k.m(e,n)):k&&(k.d(1),k=null),(!$||8&d&&!L(a.src,r=`https://y${window.location.host.indexOf("dev")>-1||window.location.host.indexOf("test")>-1?"-test":""}.tuwan.com/${3==t[3]?"squadron":"peaceteam"}`))&&y(a,"src",r),(!$||7&d&&c!==(c=`height: ${t[1]+(0==t[0]?50:0)+7}px; width: ${t[2]}; overflow-x: hidden;`))&&y(a,"style",c),(!$||16&d&&l!==(l=R("tabShowerItem "+(1==t[4]?"active":""))+" s-3tm9N8o4Zont"))&&y(s,"class",l),(!$||9&d&&!L(h.src,u=`https://y${window.location.host.indexOf("dev")>-1||window.location.host.indexOf("test")>-1?"-test":""}.tuwan.com/${3==t[3]?"squadron":"peaceteam"}#/introduce/${t[0]}`))&&y(h,"src",u),(!$||7&d&&g!==(g=`height: ${t[1]+(0==t[0]?50:0)}px; margin-top: 11px;width: ${t[2]}; overflow-x: hidden;`))&&y(h,"style",g),(!$||16&d&&f!==(f=R("tabShowerItem "+(2==t[4]?"active":""))+" s-3tm9N8o4Zont"))&&y(m,"class",f),(!$||64&d&&w!==(w="display: "+(t[6]?"block":"none")))&&y(o,"style",w),t[6]?S&&(W(),O(S,1,1,(()=>{S=null})),N()):S?64&d&&q(S,1):(S=ns(t),S.c(),q(S,1),S.m(i,null))},i:function(t){$||(q(S),$=!0)},o:function(t){O(S),$=!1},d:function(n){n&&C(e),k&&k.d(),t[10](null),S&&S.d()}};return p("SvelteRegisterBlock",{block:M,id:is.name,type:"component",source:"",ctx:t}),M}function os(t,e,n){let{$$slots:i={},$$scope:o}=e;f("KingTeamH5",i,[]);let s,a,{team_id:r}=e,{iframeHeight:c}=e,{widthPx:l}=e,{gameId:d}=e,m=1,h=!1;w((()=>{setTimeout((()=>{n(6,h=!0)}),900)}));const u=()=>{try{document.querySelector("#kingTeamIframe1").contentWindow.location.reload()}catch(t){console.log(t)}try{document.querySelector("#kingTeamIframe2").contentWindow.location.reload()}catch(t){console.log(t)}},p=()=>{qt.get(Ot.getKingTeamTab(uu.getCid())).then((t=>{if(0==t.error){const e=t.data.team_id;window.$(".zhanduiEnterBtn").attr("data-teamId",e),window.$("#kingTeamParent").hide()}}))},g=()=>{Vt("暂未开放，敬请期待~")};window.handleReloadKingTeam=p,t.$$.on_mount.push((function(){void 0!==r||"team_id"in e||t.$$.bound[t.$$.props.team_id]||Zo.warn("<KingTeamH5> was created without expected prop 'team_id'"),void 0!==c||"iframeHeight"in e||t.$$.bound[t.$$.props.iframeHeight]||Zo.warn("<KingTeamH5> was created without expected prop 'iframeHeight'"),void 0!==l||"widthPx"in e||t.$$.bound[t.$$.props.widthPx]||Zo.warn("<KingTeamH5> was created without expected prop 'widthPx'"),void 0!==d||"gameId"in e||t.$$.bound[t.$$.props.gameId]||Zo.warn("<KingTeamH5> was created without expected prop 'gameId'")}));const v=["team_id","iframeHeight","widthPx","gameId"];Object.keys(e).forEach((t=>{~v.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||Zo.warn(`<KingTeamH5> was created with unknown prop '${t}'`)}));return t.$$set=t=>{"team_id"in t&&n(0,r=t.team_id),"iframeHeight"in t&&n(1,c=t.iframeHeight),"widthPx"in t&&n(2,l=t.widthPx),"gameId"in t&&n(3,d=t.gameId)},t.$capture_state=()=>({onMount:w,common:uu,request:qt,ChatUrls:Ot,Loading:Xo,showTips:Vt,team_id:r,iframeHeight:c,widthPx:l,gameId:d,tabIndex:m,iframeDom:s,currentTeamId:a,isLoaded:h,handleReloadOrigin:u,handleReload:p,disableFn:g}),t.$inject_state=t=>{"team_id"in t&&n(0,r=t.team_id),"iframeHeight"in t&&n(1,c=t.iframeHeight),"widthPx"in t&&n(2,l=t.widthPx),"gameId"in t&&n(3,d=t.gameId),"tabIndex"in t&&n(4,m=t.tabIndex),"iframeDom"in t&&n(5,s=t.iframeDom),"currentTeamId"in t&&(a=t.currentTeamId),"isLoaded"in t&&n(6,h=t.isLoaded)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{1&t.$$.dirty&&(console.log("team_id =-=---="),console.log(r))},[r,c,l,d,m,s,h,u,()=>{n(4,m=1)},()=>{n(4,m=2)},function(t){Y[t?"unshift":"push"]((()=>{s=t,n(5,s)}))}]}class ss extends h{constructor(t){super(t),u(this,t,os,is,g,{team_id:0,iframeHeight:1,widthPx:2,gameId:3}),p("SvelteRegisterComponent",{component:this,tagName:"KingTeamH5",options:t,id:is.name})}get team_id(){throw new Error("<KingTeamH5>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set team_id(t){throw new Error("<KingTeamH5>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get iframeHeight(){throw new Error("<KingTeamH5>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set iframeHeight(t){throw new Error("<KingTeamH5>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get widthPx(){throw new Error("<KingTeamH5>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set widthPx(t){throw new Error("<KingTeamH5>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get gameId(){throw new Error("<KingTeamH5>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set gameId(t){throw new Error("<KingTeamH5>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class as{constructor(){this.instance=null,this.mainEle=window.$(".right .right-main"),this.cid=0,this.team_id="",this.shangGifts=new Map([[34,"https://img3.tuwandata.com/uploads/play/1898151532696070.png"],[57,"https://img3.tuwandata.com/uploads/play/2049781539250469.png"],[106,"https://img3.tuwandata.com/uploads/play/2275621548733308.png"]]),this.initEvent(),this.isTempRoom=!1}static getInstance(){return this.instance||(this.instance=new as),this.instance}static getTabKeys(){return{gaobai:1,meili:2,gongxian:3,carteam:4,autocarteam:5,love:6,bridge:7,diandan:8,musicroom:9,activity:10,vote:11,battle:12,guard:13,solo:14,newcarteam:15,v1team:16,kingTeam:17}}initEvent(){const t=this;this.mainEle.find(".right-tabs").on("click","li",(function(){const e=this.dataset.type;t._setTabDataHtml(e,uu.getCid()),t.mainEle.find(".right-tabs").find("li").removeClass("current"),window.$(this).addClass("current"),t.mainEle.find(".right-info-content").find("li").css("display","none"),t.mainEle.find(".right-info-content").find('li[data-type="'+e+'"]').css("display","block")}));const e=as.getTabKeys();t.mainEle.find(".right-info-content").on("click",'li[data-type="'+e.gaobai+'"] .biaobai-item .block-users_user img',(function(){ki(this.dataset.uid)}))}getTypes(){const t=as.getTabKeys(),e=new Map;return e.set(t.gaobai,"告白墙"),e.set(t.meili,"魅力榜"),e.set(t.gongxian,"贡献榜"),e.set(t.guard,"守护榜"),e.set(t.carteam,"车队"),e.set(t.autocarteam,"车队"),e.set(t.love,"爱的推荐"),e.set(t.bridge,"鹊桥良缘"),e.set(t.diandan,"点单"),e.set(t.musicroom,"歌房"),e.set(t.activity,"活动"),e.set(t.vote,"竞猜"),e.set(t.battle,"赛事"),e.set(t.solo,"solo榜"),e.set(t.newcarteam,"车队"),e.set(t.v1team,"1V1车队"),e.set(t.kingTeam,"战队"),e}async getTags(t){this.isTempRoom=!1;const e=as.getTabKeys(),n=uu.getAnchoringUserId()?[e.guard,e.gongxian]:[e.gongxian,e.meili];let i=[];switch(t){case 0:case 18:case 21:case 1:case 7:case 20:case 23:case 25:case 26:case 28:case 33:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:i=[e.gaobai,e.gongxian,e.meili];break;case 5:this.isTempRoom=!0,i=[e.gongxian,e.meili];break;case 10:case 12:case 13:i=[e.gaobai,e.gongxian,e.meili,e.carteam];break;case 19:i=n;break;case 11:case 16:case 17:case 22:case 24:case 30:case 31:i=[e.gaobai,e.gongxian,e.meili,e.autocarteam];break;case 27:i=[e.gaobai,e.gongxian,e.meili,e.musicroom];break;case 29:i=[e.newcarteam,e.gongxian,e.meili];break;case 32:i=uu.isKillerBattleRoom()?[e.newcarteam,e.gaobai,e.gongxian,e.meili]:[e.gaobai,e.gongxian,e.meili,e.newcarteam];break;case 44:i=[e.gaobai,e.gongxian,e.meili,e.newcarteam]}return 1==uu.roomInfo.allow_solo_fleet&&i.push(e.solo),(uu.isKillerFreeRoom()||uu.isSpyRoom())&&(uu.roomInfo.admin_spe_user.includes(uu.roomInfo.uid)||uu.roomInfo.admin_user.includes(uu.roomInfo.uid)||1==uu.roomInfo.is_patrol)&&i.push(e.v1team),i}async init(t,e){this.cid=t;let n=await this.getTags(e);window.$(".right-tabs .refsh").css("display","none"),window.$(".rightsearch").css("display","none"),this._setTabsHtml(n),this._setTabDataHtml(n[0],t)}async setAutoTeamData(t,e){let n="",i="",o="";if(i=as.getTabKeys().autocarteam,o="加入车队",t.length>0){let i=[];for(let n=0;n<t.length;n++)i.push(this._getAutocarTeamItemRight(t[n],e,"加入车队"));n='<div class="autocarteam-right-list">'+i.join("")+"</div>"}else n='<div class="autocarteam-right-list"><div style="color:#999; font-size:14px; text-align:center; margin-top:20px">现在还没有车队哦~</div></div>';this.mainEle.find(".right-info-content ul li[data-type='"+i+"']").html(n)}setGameTeamData(t){t=`\n            <div style="padding: 10px 6px;" id="right-new-team">\n                <div id="new-right-team-content">\n                    ${t}\n                </div>\n            </div>\n        `,this.mainEle.find(".right-info-content ul li[data-type='"+as.getTabKeys().newcarteam+"']").html(t)}async setTeamData(t,e){let n="";if(t.length>0){let i=[];for(let n=0;n<t.length;n++){const o=this._historyCarteamLihtml(t[n],e);i.push(o)}n='<div class="carteam-right-list">'+i.join("")+"</div>",this.mainEle.find(".right-info-content ul li[data-type='"+as.getTabKeys().carteam+"']").html(n)}else n='<div style="color:#999; font-size:14px; text-align:center; margin-top:20px">现在还没有车队哦~</div>';this.mainEle.find(".right-info-content ul li[data-type='"+as.getTabKeys().carteam+"']").html(n)}_setTabsHtml(t){const e=this.getTypes();let n=[],i=[];for(let o=0;o<t.length;o++){const s=1*t[o];let a=e.get(s);15==s&&(uu.isSpyRoom()?a="卧底桌":uu.isLeyuanshaRoom()?a="乐园桌":uu.isKillerFreeRoom()&&(a="狼人桌")),n.push('<li class="'+(0==o?"current":"")+'" data-type="'+s+'">'+a+"</li>"),i.push('<li style="display:'+(0==o?"block":"none")+'" data-type="'+s+'"></li>')}this.mainEle.find(".right-tabs ul").html(n.join("")),this.mainEle.find(".right-info-content ul").html(i.join(""))}_setTabDataHtml(t,e,n){const i=as.getTabKeys();t==i.gaobai?this._getGaobaiList(t):t==i.gongxian?this._getGongxianList(t):t==i.meili?this._getMeiliList(t):t==i.carteam||t==i.autocarteam||t==i.love||(t==i.bridge?this._setBridge(t):t==i.diandan?this.setDiandanList(t,e,n):t==i.activity?this.setActivityList(t,e,n):t==i.vote?this.setVoteHtml(t,e,n):t==i.battle?this.setBattleHtml(t,e,n):t==i.guard?this.setGuardHtml(t,e,n):t==i.solo?this.setSoloHtml(t,e,n):t==i.newcarteam||(t==i.v1team?this.setV1Html(t):t==i.kingTeam&&this.setKingTeamShow(t)))}setKingTeamShow(t){let e=this.mainEle.find(".right-info-content ul li[data-type='"+t+"']"),n=parseInt($(".chat-center-main .chat-center-right").css("height"))-160;if(!e.html()){new ss({target:e[0]}).$set({team_id:this.team_id,iframeHeight:n,widthPx:"320px"})}}setV1Html(t){const e=this;new Promise(((t,e)=>{qt.get(Ot.getGameFleetList(uu.getCid())).then((e=>{0==e.error?t(e.data):t(0)})).catch((e=>{t(0)}))})).then((n=>{if(null!=n){const i=e.__getV1Html(n);let o="";o=0==i.length?'<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有1v1车队~</div>':' <div class="solo-top-container">\n                     '+i.join("")+"\n                     </div>",this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(o),window.lazyload(window.$(".solo-top-header"))}else this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有1v1车队</div>')}))}setSoloHtml(t){const e=this;new Promise(((t,e)=>{qt.get(Ot.getSoloRank(uu.getCid())).then((e=>{0==e.error?t(e.data):t(0)})).catch((e=>{t(0)}))})).then((n=>{if(null!=n){const i=e.__getSoloHtml(n);let o="";const s=n.list.findIndex((t=>t.user_info.uid==uu.getMeid())),a=-1!=s?'<div class="flex inithide right-top-solo-fixed" >\n                   '+i[s]+"\n                </div>":"";o=0==i.length?'<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有人solo，快去solo吧~</div>':' <div class="solo-top-container">\n                     '+i.join("")+"\n                     "+a+"\n                     </div>",this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(o),window.lazyload(window.$(".solo-top-header"))}else this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有人solo，快去solo吧~</div>')}))}setGuardHtml(t){const e=this;this._getGuardRank(uu.getAnchoringUserId(),uu.getCid(),1).then((n=>{const i=n.list;new Promise(((t,e)=>{qt.get(Ot.getGuardNum(uu.getAnchoringUserId(),uu.getCid())).then((e=>{0==e.error?t(e.data):t(0)})).catch((e=>{t(0)}))})).then((n=>{if(null!=i){const o=e.__getGuardHtml(i);let s="";s=""==o?'<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有人守护，快去守护ta吧~</div>':' <div class="guard-container">\n                     <div class="flex flex-jb flex-ac guard-header-container"><div class="guard-header-num">守护人数:<span>'+n+'</span></div> <div class="shouhu-help-icon"></div></div>\n                     '+o+"\n                     </div>",this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(s)}else this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有人守护，快去守护ta吧~</div>');const o=null!=i?i.find((t=>t.uid==uu.getMeid())):null;li.getInstance().getGuardComp(o)}))}))}__getGuardHtml(t){let e=[];const n=this.__getCarteamIcon();for(let i=0;i<t.length;i++){let o="",s="",a="#999";const r=t[i],c=r.treaicon,l=r.score_total,d=r.eday,m=r.nickname,h=r.uid;r.score;const u=r.avatar,p=r.vipicon,g=r.sex,f=r.treaname;r.medal;let w=Ct.webpImgFormat(u);i<3?(o=' <div class="car-qs-div">\n\t\t\t\t\t\t\t<img class="carqiansan-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+w+'">\n\t\t\t\t\t\t\t<div class="car-qs-guan car-qs-guan-'+(i+1)+'"></div>\n\t\t\t\t\t\t</div>',s="carpai carpai"+(i+1),a="#666"):(o=' <div class="car-qs-paimingnum">'+(i+1)+"</div>",s="paihang-other",a="#999");let v="";""!=c&&(v='<img src="'+c+'">');let _="";_=1==g?'<span class="sex-man">♂</span>':'<span class="sex-girl">♀</span>';const y='<div class="right-paihang-item '+s+'" data-uid="'+h+"\" data-info='"+JSON.stringify(r)+"'>\n\t\t\t\t\t\t\t"+o+'\n\t\t\t\t\t\t\t<div class="carpaihang-userinfo" style="flex:1">\n\t\t\t\t\t\t\t\t<div class="flex carpaihang-userinfo-name">\n\t\t\t\t\t\t\t\t<img src="'+p+'">\n                                    '+v+"\n\t\t\t\t\t\t\t\t\t<p>"+m+"</p>\n\t\t\t\t\t\t\t\t\t"+_+'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div style="font-size: 12px;color: #999">\n\t\t\t\t\t\t\t\t\t'+f+"剩余:"+d+'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex" style="color: '+a+'; align-items:center;">'+l+"&nbsp;"+n+"</div>\n\t\t\t\t\t\t</div>";e.push(y)}return e.join("")}__getV1Html(t){let e=[];for(let n of t){const{uid:t,cid:i,pcid:o,ctime:s,nickname:a,invite_nickname:r,invite_avatar:c,is_game:l}=n;e.push(`<div data-tcid="${i}" data-state="1" class="carteamauto-item" data-vip="0" data-live="0" account="${t}" >\n                            <div class="right-team-item-header margintop6">\n                                <img class="autocar-team-list-header" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="${c}" />\n                                <div class="room_status gaming ${0==l&&"hide"}"></div>\n                                <div class="roomsonging ${0==l&&"hide"}"" ></div>\n                            </div>\n                            <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                                <div class="autocar-team-list-title" >\n                                    <font>${r}</font>\n                                </div>\n                                <div class="autocar-team-list-info-1">${a}</div>\n                                <div class="autocar-team-list-info-2" style="margin-top:6px;display:block">\n                                    <span class="span-htime">已开${s}</span>\n                                </div>\n                            </div>\n                            <div data-tcid="${i}" data-state="1"  class="carauto-team-right-join">加入</div>\n                            \n                        </div>`)}return e}__getSoloHtml(t){let e=[];const n=["#D56003","#454D71","#AB5F18"];for(let i=0;i<t.list.length;i++){let o="",s="#474747";i<3&&(s=n[i]);const a=t.list[i];a.order;const r=a.win_num,c=a.lose_num,l=a.user_info.uid,d=a.user_info.nickname,m=a.user_info.icon,h=a.user_info.avatar;o=i<3?' <div style="color: '+s+'" data-index="'+i+'"  class="solo-top-conatiner flex flex-jc flex-ac">'+(i+1)+"</div>":' <div style="color: '+s+'" data-index="'+i+'" class="solo-top-conatiner flex flex-jc flex-ac">'+(i+1)+"</div>";const u='<div class="right-solo-item flex flex-ac" data-type="solo" data-uid="'+l+"\" data-info='"+JSON.stringify(a)+"'>\n\t\t\t\t\t\t\t"+o+'\n\t\t\t\t\t\t\t<div class="flex">\n\t\t\t\t\t\t\t    <img class="solo-top-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" data-src="'+h+'">\n                                <div style="margin-left: 20px">\n                                    <div class="flex flex-ac">\n                                           <p style="color: #666666;font-size: 16px;margin-right: 10px">'+d+'</p> <img style="height: 18px" src="'+m+'">\n                                    </div>\n\n                                    <div style="margin-top: 4px;color: rgba(0,0,0,.6)"><span>胜:'+r+'</span><span style="margin-left: 10px">败:'+c+"</span></div>\n                                </div>\n                            </div>\n\t\t\t\t\t\t</div>";e.push(u)}return e}setVoteHtml(t){this._getVoteList().then((e=>{if(0==e.length){const e='<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有竞猜，快去竞猜一下吧~</div>';return void this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(e)}this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div class="vote_container"></div> ');const n=window.$(".vote_container"),i={1:"竞猜中",2:"奖励已发放",3:"已结束，未中奖",4:"已取消"};n.empty(),e.forEach((t=>{const{title:e,match_title:o,guess:s,team:a}=t,r=Ct.dateFormatA(new Date(1e3*s.time),"."),c=Ct.dateFormatB(new Date(1e3*s.time));let l="";if(0!=a.length&&a.length>=2){const t=a[0],e=a[1];l=' <div class="vote_item_team_container flex flex-jb flex-ac">\n                    <div class="vote_item_team_wrapper flex flex-ac flex-jc flex-dir-col">\n                        <div class="vote_item_team_icon"><img src="'+t.icon+'"/></div>\n                        <div class="vote_item_team_name">'+t.team+'</div>\n                    </div>\n                    <div class="vote_item_team_vs">VS</div>\n                    <div class="vote_item_team_wrapper flex flex-ac flex-jc flex-dir-col">\n                        <div class="vote_item_team_icon"><img src="'+e.icon+'"/></div>\n                        <div class="vote_item_team_name">'+e.team+"</div>\n                    </div>\n                   </div>"}n.append(' <div class="vote_item_wrapper">\n                <div class="vote_item_title_wrapper flex flex-jb flex-ac">\n                    <div class="vote_item_title">'+o+'</div>\n                    <div class="vote_item_type"> '+e+"</div>\n                </div>\n                "+l+'\n                <div class="vote_item_vote_info_wrapper flex flex-dir-col">\n                    <div class="vote_item_vote_title">竞猜题目：<span>'+s.guess_title+'</span></div>\n                    <div class="vote_item_detail">\n                        <div>已选：<span class="vote_item_detail_choice">'+s.title+'</span></div>\n                        <div>奖励倍数：<span class="vote_item_detail_multiple">'+s.rate+'</span></div>\n                        <div>已投：<span class="vote_item_detail_num">'+s.gift_title+" x "+s.gift_num+'</span></div>\n                    </div>\n                    <div class="item_action_wrapper flex flex-jb flex-ac">\n                         <div class="item_action_date_wrapper">比赛时间<span class="item_action_date">'+r+" "+c+'</span></div>\n                         <div class="item_action item_action_status'+s.state+'">'+i[s.state]+"</div>\n                    </div>\n                </div>\n            </div>")}))})).catch((e=>{this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有竞猜，快去竞猜一下吧~</div>')}))}setBattleHtml(t){if(0!=this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").children().length)return;this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('\n            <div class="army_container"></div>\n            <div class="battle_container" ></div>\n            <div class="battle_schedule_container"> </div>\n        ')}_setBridge(t){return new Promise(((e,n)=>{qt.get(Pt+`/Bridge/bridgeMeet?cid=${this.cid}`).then((e=>{if(0==e.error){const n=e.list;let i="<img src=\"https://res.tuwan.com/templet/play/2020/2020qixi/bridge_title.png\" style='margin-top:10px'>";n.forEach((t=>{i+=`<div class="bridge_item">\n\t\t\t\t\t\t\t\t\t\t\t<div class="bridge_header_content">\n\t\t\t\t\t\t\t\t\t\t\t\t<img class="header" src="${t.avatar1}">\n\t\t\t\t\t\t\t\t\t\t\t\t<img class="header" src="${t.avatar2}">\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="bridge_name_content">\n\t\t\t\t\t\t\t\t\t\t\t\t<div style="text-align:right">${t.name1}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<img src="https://res.tuwan.com/templet/play/2020/2020qixi/rank_heart.png">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>${t.name2}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>`}));const o=`<div class="bridge_list">${i}</div>`;this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(o)}}))}))}initNewCarTeamHtml(t){setTimeout((()=>{this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div style="padding: 10px 6px;" id="right-new-team"><div id="right-team-mime-container" class="new-kaihei-teams"></div><div id="new-right-team-content"></div></div>')}),100)}setNewcarteamHtml(t,e){let n='<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">还没有车队，快去创建吧~</div>';""!=e&&null!=e&&(n=e),this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] #new-right-team-content").html(n),0!=uu.getMycarFid()&&null!=e&&""!=e?window.$(".autoroom-team-item[data-fid='"+uu.getMycarFid()+"']").addClass("hide"):window.$("#right-team-mime-container").empty()}updateNewCarTeamInfoHtml(t,e,n){const{title:i,desc:o,fid:s,fleetnum:a,grading:r}=n,c=i||"",l=r||"";window.$(".autoroom-team-item[data-fid='"+s+"']").addClass("hide");let d='<div class="newcar-team-item" data-fid="'+s+'">\n                               <div style="padding: 15px 0 5px;display: flex;justify-content: center;">'+e+'</div>\n                                <div style="position:relative;padding-bottom: 10px">\n                                   <div style="width: 200px;margin-left: 10px">\n                                        <div style="color: #464646;font-size: 16px;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;">'+o+'</div>\n                                        <div style="margin-top: 2px;color: #9E9E9E;font-size: 14px">★'+c+"★ - "+l+'</div>\n                                   </div>\n                                   <div style="position: absolute;bottom:10px;right: 10px" class="flex flex-ac">\n                                       <span style="color: #666;margin-right: 30px;font-size: 14px;"><font>'+n.data.length+"</font>/"+a+'</span>\n                                       <div class="carauto-item-btn join ">已加入</div>\n                                   </div>\n                               </div>\n                         </div>';this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] #right-team-mime-container").html(d)}_getGaobaiList(t){this._getConfession(this.cid).then((e=>{const n="lazyload_"+(new Date).getTime(),i='<div class="biaobai-list">'+this._getBiaobaiHtml({data:e,lazyCls:n})+"</div>";let o="";0==e.length&&(o='<div class="empty-baibiao" style="color:#999; font-size:14px; text-align:center; margin-top:20px">现在还没有告白哦~</div>'),this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html('<div class="biaobai-title" style="margin-top:10px">\n\t\t\t\t\t\t\t\t\t\t<img src="https://res.tuwan.com/templet/play/chat/images/biaobai.png">\n\t\t\t\t\t\t\t\t\t\t<p><span>大胆向Ta表白吧！</span></p>\n\t\t\t\t\t\t\t\t\t</div>'+i+o),window.lazyload(window.$("."+n))}))}async insertBiaobai(t){const e=this.mainEle.find(".right-info-content ul li[data-type='"+as.getTabKeys().gaobai+"']");e.find(".empty-baibiao").remove();const n=(await this._getConfession(this.cid)).map((t=>t.id));for(const i of t){if(!n.includes(parseInt(i.id)))continue;const t="lazyload_"+(new Date).getTime(),o=this._getBiaobaiHtml({data:[i],lazyCls:t});if(1==i.top)e.find(".biaobai-list").prepend(o);else{const t=e.find(".biaobai-list").find(".biaobai-item.sign-top").last();t.length>0?t.after(o):e.find(".biaobai-list").prepend(o)}window.lazyload(window.$("."+t))}}_getBiaobaiItemUser(t,e,n,i){const o=Ct.webpImgFormat(n);return`    \n            <div class="block-users_user">\n                <img class="${i}" data-uid="${t}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="${i.length>0?"https://res.tuwan.com/templet/play/chat/v2/images/empty.png":n}" data-src="`+o+`"/>\n                <p>${e}</p>\n            </div>\n        `}_getBiaobaiHtml({data:t,lazyCls:e="",itemCls:n="",showDays:i=!1,showTags:o=!0}){let s=[];for(let a=0;a<t.length;a++){const r=t[a].toName,c=t[a].toAvatar,l=t[a].toUid,d=t[a].byName,m=t[a].byAvatar,h=t[a].byUid,u=t[a].answer,p=t[a].startTime,g=t[a].endTime,f=t[a].confession_global,w=t[a].top,v=t[a].days,_=t[a].content,y=[{true_bg:"https://asset.tuwan.com/activity/520/chat_confess_big_1.png?v=2",true_text_bg:"#e2a6f4",true_name_color:"#df70ff"},{true_bg:"https://asset.tuwan.com/activity/520/chat_confess_big_2.png?v=2",true_text_bg:"#9bcff4",true_name_color:"#5dafe8"},{true_bg:"https://asset.tuwan.com/activity/520/chat_confess_big_3.png?v=2",true_text_bg:"#ff8fbc",true_name_color:"#ff5588"},{true_bg:"https://asset.tuwan.com/activity/520/chat_confess_big_4.png?v=2",true_text_bg:"#f6b07b",true_name_color:"#d58950"},{true_bg:"https://asset.tuwan.com/activity/520/chat_confess_big_5.png?v=2",true_text_bg:"#83e4ca",true_name_color:"#51ab93"}][a%5];let x="";x=u&&""!==u?`<div class="gift_confess_item"  style="background:url(${y.true_bg})">\n                            <div class="gift_confess_que_item flex">\n                                <div class="gift_confess_info ygb_f_c" style="margin-right:10px;color:${y.true_name_color}">\n                                    <img style="border:2px solid ${y.true_name_color}" class="layzload-biaobai" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="${m}" data-src="`+m+`">\n                                    <div title="${d}" style="width:70px" class="ygb_text_over">${d}</div>\n                                </div>\n                                <div class="gift_confess_content_text">\n                                    问：${_}\n                                </div>\n                            </div>\n                            <div class="gift_confess_ans_item flex">\n                                <div class="gift_confess_content_text">\n                                    答：${u}\n                                </div>\n                                <div class="gift_confess_info ygb_f_c" style="margin-left:10px;color:${y.true_name_color}">\n                                    <img style="border:2px solid ${y.true_name_color}" class="layzload-biaobai" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="${c}" data-src="`+c+`">\n                                    <div title="${r}" style="width:70px" class="ygb_text_over">${r}</div>\n                                </div>\n                            </div>\n                        </div>`:`<div class="biaobai-item ${1==w?"sign-top":""} ${n}">\n                            <div class="block-users">\n                                ${this._getBiaobaiItemUser(h,d,m,e)}\n                                <p class="block-users_date" style="opacity: 0.4;">${i?v:`${p}-${g}号`}</p>\n                                ${this._getBiaobaiItemUser(l,r,c,e)}\n                            </div>\n                            <div class="flex biaobai-content">\n                                <p>${_.length>35?_.slice(0,35)+"...":_}</p>\n                            </div>\n                            ${o?`\n                                    <div class="biaobai-item_tags">\n                                        ${1==f?'<img src="https://asset.tuwan.com/chatroom/images/biaobai_item_tag_quanzhan.png"/>':""}\n                                        ${1==w?'<img src="https://asset.tuwan.com/chatroom/images/biaobai_item_tag_top.png"/>':""}\n                                    </div>\n                                `:""}\n                        </div>`,s.push(x)}return s.join("")}_getGongxianList(t,e=7){let n=this;this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] .right-top-tabs span").unbind("click"),this.__getBangList("devote",e).then((e=>{this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(e),this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] .right-top-tabs span").bind("click",(e=>{n._getGongxianList(t,e.target.dataset.day)}))}))}_getMeiliList(t,e=7){let n=this;this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] .right-top-tabs span").unbind("click"),this.__getBangList("charm",e).then((e=>{this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(e),this.mainEle.find(".right-info-content ul li[data-type='"+t+"'] .right-top-tabs span").bind("click",(e=>{n._getMeiliList(t,e.target.dataset.day)}))}))}__getBangList(t,e=7){return new Promise(((n,i)=>{let o=this.cid;this.isTempRoom&&(o=uu.roomInfo.pcid);let s=Pt+"/Chatroom/giftCidRank?giftid=34&cid="+o+"&day="+e+"&limit=50&type="+t,a='<div class="flex flex-jc right-top-tabs"><span class="'+(7==e?"current":"")+'" data-day="7">周榜</span><span class="'+(30==e?"current":"")+'" data-day="30">月榜</span></div>';qt.get(s).then((t=>{if(0==t.error){const e=t.data;if(e){const t=this.__getCidRandHtml(e);let i="";i=""==t?a+'<div style="font-size:14px;color:#999; text-align:center; ">还没有榜单，快去贡献一个吧~</div>':a+t,n(i)}else n(a+'<div style="font-size:14px;color:#999; text-align:center;">还没有榜单，快去贡献一个吧~</div>')}}))}))}__getCidRandHtml(t){let e=[];this.__getCarteamIcon();for(let n=0;n<t.length;n++){let i="",o="",s="#999";const a=t[n],r=a.nickname,c=a.uid,l=a.score,d=a.avatar,m=a.vipicon,h=a.sex,u=a.medal;let p=Ct.webpImgFormat(d);n<3?(i=' <div class="car-qs-div">\n\t\t\t\t\t\t\t<img class="carqiansan-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+p+'">\n\t\t\t\t\t\t\t<div class="car-qs-guan car-qs-guan-'+(n+1)+'"></div>\n\t\t\t\t\t\t</div>',o="carpai carpai"+(n+1),s="#666"):(i=' <div class="car-qs-paimingnum">'+(n+1)+"</div>",o="paihang-other",s="#999");let g="";""!=u&&(g='<img src="'+u+'">');let f="";f=1==h?'<span class="sex-man">♂</span>':'<span class="sex-girl">♀</span>';const w='<div class="right-paihang-item '+o+'" data-uid="'+c+"\" data-info='"+JSON.stringify(a)+"'>\n\t\t\t\t\t\t\t"+i+'\n\t\t\t\t\t\t\t<div class="carpaihang-userinfo" style="flex:1">\n\t\t\t\t\t\t\t\t<div class="flex carpaihang-userinfo-name">\n\t\t\t\t\t\t\t\t\t<p>'+r+"</p>\n\t\t\t\t\t\t\t\t\t"+f+'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<img src="'+m+'">\n\t\t\t\t\t\t\t\t\t'+g+'\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flex" style="color: '+s+'; align-items:center;">'+l+"&nbsp;</div>\n\t\t\t\t\t\t</div>";e.push(w)}return e.join("")}__getCarteamIcon(){return'<img src="https://res.tuwan.com/templet/play/chat/auto/images/zhuanicon.png" style="width:20px;height:20px" />'}_getConfession(t,e){return e=e||100,0!=t&&(t=t||this.cid),new Promise(((n,i)=>{const o=Pt+"/Teacher/getConfessionList?format=jsonp&cid="+t+"&limit="+e+"&page=1";qt.get(o).then((t=>{0==t.error&&n(t.data||[])}))}))}_getAutocarTeamItemRight(t,e,n){var i,o,s,a;const r=t.area,c=t.areaid,l=t.avatar,d=t.desc,m=t.fid,h=t.giftid,u=t.giftnum,p=t.level,g=t.nickname,f=t.num,w=t.total,v=t.sports||0,_=t.uid,y=t.uids,x=t.state,b=t.cid,$=t.tcid,k=t.playtime,C=t.vipicon,I=t.live,S=t.subTitle,T=t.areaNum,R=t.startTime,M=t.endTime,A=t.etime,P=t.deskType,j=t.game_type;null==(i=t.roomLevelInfo)||i.imageurl,null==(o=t.roomLevelInfo)||o.is_team;const D=(null==(s=t.roomLevelInfo)?void 0:s.h5imageurl)||"",L=null==(a=t.roomLevelInfo)?void 0:a.roomLevel,E=t.vip,B=this.shangGifts.get(h);let F="",U="",z=null,O="none";u>0&&(F='<div class="carauto-item-shang">赏</div>',U='<span class="span-shang" style="color:#ff5588">【赏<img src="'+B+'" /> x '+u+"】</span>"),v>0&&(F='<div class="carauto-item-shang" style="background:#24aaff;">赛</div>',U='<span class="span-shang" style="color:#ff5588">【竞技<img src="https://res.tuwan.com/templet/play/chat/auto/images/zhuanicon.png" /> x '+v*f+"】</span>");let N="";p&&(N=" "+p+" -"),k>0&&(z=this._kaiedCarteamTime(k),O="block");let q="",G="",V="",H="";const W=0==x&&y.includes(e);1==x?(n="已开车",q="joined"):W&&(n="已加入",q="joined"),(uu.isShengyouFreeRoom()||uu.isShengyouFreeRoomWithPType()||uu.isPListType2())&&!W?(f!=w&&(n="加入",q=""),f==w&&(n=1!=x||uu.isPListType2()?"加入":"满房",q=""),1==E&&(n="VIP",q="vip"),30!=uu.roomInfo.typeid||uu.isPListType2()||"加入"!=n&&"满房"!=n||1!=x||(n="已开车",q="joined")):uu.isSameMusicRoom()&&!W&&1==E&&(n="VIP",q="vip"),(uu.isSameMusicRoom()||uu.isShengyouFreeRoom()||uu.isShengyouFreeRoomWithPType())&&(1!=x||1==E||uu.isSameMusicRoom()||2==I?1==E&&(G="vip",H="margintop6"):(G="songing",V="roomsonging",H="margintop6",30!=uu.roomInfo.typeid||uu.isPListType2()||uu.isCanChoiceCreateCar()||(G="gaming"),(uu.isCanChoiceCreateCar()||uu.isCanChoiceCreateCarTempRoom())&&(0==j?(G="gaming",1==x&&"已开车"!=n&&(n="加入",q="")):1==j&&(G="songing",1==x&&(n="加入",q="")))));let K=" <font>"+f+"</font>/"+w+"人";2==I&&(n="加入",q="",K=""),7==I&&(G="smallgameing"),2==j&&7!=I&&(G="drawing",n="加入",q="");let Y="";"block"==O&&1==x&&(n="已开车",q="joined");try{t.entrance_open&&(n="加入",q="")}catch(J){console.log(J)}if(Y=D?`<div class="kingTeamParent">\n                <div class="kingTeamOuterCtn">\n                <div style="${D?`border-image-width: 12px;border-image-source: url(${D});border-image-slice: 22;border-image-repeat: stretch;`:""}" data-tcid="`+$+'" data-state="'+x+'" class="carteamauto-item '+(D?" kingTeam":"")+'"  data-vip="'+E+'" data-live="'+I+'"  account="'+_+'" areaid="'+c+'" data-fid="'+m+'" sports="'+v+`">\n                <div class="kingTeamStarsGroupCtn" style="display:${L>0?"block":"none"};">\n                    <img class="subImg" src="https://asset.tuwan.com/squadron/images/icon_level${L}.png">\n                </div>\n                <div class="right-team-item-header `+H+'">\n                    <img class="autocar-team-list-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+l+'">\n                    <div class="room_status '+G+'"></div>\n                    <div class="'+V+'"></div>\n                </div>\n                <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                    <div class="autocar-team-list-title" title="'+d+'">\n                        '+U+"<font>"+d+'</font>\n                    </div>\n                    <div class="autocar-team-list-info-1">★'+r+"★ -"+N+K+'</div>\n                    <div class="autocar-team-list-info-2">\n                        <img src="'+C+'">\n                        '+g+'\n                    </div>\n                    <div class="autocar-team-list-info-2" style="margin-top:6px;display:'+O+'">\n                        <span class="span-htime">已开'+z+'</span>\n                    </div>\n                </div>\n                <div data-tcid="'+$+'" data-state="'+x+'" data-fid="'+m+'" class="carauto-team-right-join '+q+'">'+n+"</div>\n                "+F+"\n                </div><div>\n            </div>":'<div data-tcid="'+$+'" data-state="'+x+'" class="carteamauto-item"  data-vip="'+E+'" data-live="'+I+'"  account="'+_+'" areaid="'+c+'" data-fid="'+m+'" sports="'+v+'">\n                <div class="right-team-item-header '+H+'">\n                    <img class="autocar-team-list-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+l+'">\n                    <div class="room_status '+G+'"></div>\n                    <div class="'+V+'"></div>\n                </div>\n                <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                    <div class="autocar-team-list-title" title="'+d+'">\n                        '+U+"<font>"+d+'</font>\n                    </div>\n                    <div class="autocar-team-list-info-1">★'+r+"★ -"+N+K+'</div>\n                    <div class="autocar-team-list-info-2">\n                        <img src="'+C+'">\n                        '+g+'\n                    </div>\n                    <div class="autocar-team-list-info-2" style="margin-top:6px;display:'+O+'">\n                        <span class="span-htime">已开'+z+'</span>\n                    </div>\n                </div>\n                <div data-tcid="'+$+'" data-state="'+x+'" data-fid="'+m+'" class="carauto-team-right-join '+q+'">'+n+"</div>\n                "+F+"\n            </div>",17==I||18==I||"style1"==P){const t=`allHourShowTimeCtn_${uu.getCid()}_${m}`;Fi.initIntervalTime(R,A||M,t),Y='\n                <div data-tcid="'+b+'" data-state="'+x+'" class="carteamauto-item"  data-vip="'+E+'" data-live="'+I+'"  account="'+_+'" areaid="'+c+'" data-fid="'+m+'" sports="'+v+'">\n                    <div class="right-team-item-header '+H+'">\n                        <img class="autocar-team-list-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+l+'">\n                    </div>\n                    <div class="flex-1 song-team-item2" style="margin-left:10px;height: 88px">\n                                <p style="position: relative;width: 203px;">'+d+` <span class="subTtitle" style="font-size: 12px; transform: scale(0.9); display: inline-block;margin-left: -7px;">${S?`(${S})`:""}</span></p>\n                                <p style="margin:3px 0;" class="flex flex-ac" > <span>`+r+`</span></p>\n                                <span style="border-radius: 6px;background: rgba(255, 85, 136, 0.5);width: 64px; height: 22px;font-size: 12px;\n                                        color: #fff;text-align: center;line-height: 22px;z-index: 1; position: absolute; right: 14px; bottom: 13px;">加入</span></p>\n                                <p style="margin-top: 20px; font-size: 12px; opacity: 0.7; display: none" class="${t}"><span class="timeTitle">剩余时间:</span> <span class="timeCtn">00:00</span></p>\n                                <div class="peopleNumCtn" style="position: absolute;right: 30px;bottom: 50px;font-size: 12px;align-items: center;display: flex;color: #666;">\n                                    <span class="spBg" style="display: inline-block;margin-top: -3px;background: url(&quot;https://asset.tuwan.com/chartRoom/currentPeopleNums_gray.png&quot;);background-size: cover;width: 9px;height: 12px;margin-right: 3px;margin-bottom: -2px; margin-bottom: -2px"></span>\n                                    ${T}\n                                </div>\n                            </div>\n                        </div>\n                </div>\n            `}return Y}_kaiedCarteamTime(t){let e=t;e<0&&(e=0);const n=1*parseInt(e/60),i=1*parseInt(e%60);return(n>9?n:"0"+n)+"分"+(i>9?i:"0"+i)+"秒"}_historyCarteamLihtml(t,e){const n=t.avatar,i=t.nickname,o=t.num,s=e-t.stime,a=t.title,r=t.uid;return'<div tcid="'+t.tcid+'" state="1" class="carteam-right-item historycartem'+r+'" dzuid="'+r+'">\n\t\t\t\t\t\t\t<div class="kaied-leader-header">\n\t\t\t\t\t\t\t\t<img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+n+'">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="kaied-leader-info">\n\t\t\t\t\t\t\t\t<p class="kaied-leader-name">'+i+'</p>\n\t\t\t\t\t\t\t\t<p class="kaied-leader-info-now">'+a+"-"+o+'人<span class="span-htime">已开'+this._kaiedCarteamTime(s)+"</span></p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>"}_initYiyuandanData(t,e){this._getDiandanData(e).then((n=>{if(0==n.error){const i=n.data;let o=[];o=0==i.length?[t.gaobai,t.gongxian,t.meili]:[t.diandan,t.gaobai,t.gongxian,t.meili],this._setTabsHtml(o),this._setTabDataHtml(o[0],e,i)}}))}setActivityList(){this._getActivityList().then((t=>{this._setActivityListHtml(t)}))}_setActivityListHtml(t){window.$(".right-activity-item").unbind("click");let e=[];e.push('<div class="right-activity-list">');for(let i=0;i<t.length;i++){const n=t[i],o=n.pic,s=n.describe,a=n.typeid,r=n.value,c=n.title;e.push('<div class="flex flex-dir-col right-activity-item " style="cursor:pointer;" data-typeid="'+a+'" data-value="'+r+'">\n                                <div class="right-activity-banner">\n                                    <img class="layzload-activity"  src="https://res.tuwan.com/templet/play/chat/v2/images/empty.png" data-src="'+o+'" />\n                                </div>\n                                <div class="right-activity-title">'+c+'</div>\n                                <div class="right-activity-info">活动时间:<span> '+s+" </span></div>\n                            </div>")}0==t.length&&e.push('<div style="font-size:14px;color:#999; text-align:center; margin-top:32px">现在还没有活动哦~</div>'),e.push("</div>");const n=e.join("");this.mainEle.find(".right-info-content ul li[data-type='"+as.getTabKeys().activity+"']").html(n),window.lazyload(window.$(".layzload-activity")),window.$(".right-activity-item").bind("click",(function(){const t=this.dataset.typeid,e=this.dataset.value;1==t?window.$.fancybox.open([{src:e}],{loop:!1,toolbar:"auto",buttons:["close"],image:{preload:!0},defaultType:"fade",type:"image"}):2==t?window.open(e):15==t&&Ko.getInstance().initAct(e)}))}_getActivityList(){return new Promise(((t,e)=>{qt.get(Ot.getChatroomActivityList(uu.getCid())).then((n=>{if(0==n.error){const e=n.banner||[];t(e)}else e("err")}))}))}_getVoteList(){return new Promise(((t,e)=>{qt.get(Ot.getMyGuesslist()).then((n=>{0==n.error?t(n.data):e("err")})).catch((t=>{e("err")}))}))}_getGuardRank(t,e,n){return new Promise(((i,o)=>{qt.get(Ot.getGuardRank(t,e,n)).then((t=>{0==t.error?i(t.data):o("err")})).catch((t=>{o("err")}))}))}setDiandanList(t,e,n){n?this._setDiandanListHtml(t,n):this.getDiandanList(e)}getDiandanList(t){const e=as.getTabKeys();this.mainEle.find(".right-tabs").find("li[data-type='"+e.diandan+"']").length>0&&this._getDiandanData(t).then((t=>{0==t.error&&t.data.length>0&&this._setDiandanListHtml(e.diandan,t.data)}))}_getDiandanData(t){return qt.get(Ot.getTeacherList(t))}_setDiandanListHtml(t,e){let n=[];n.push('<div class="right-tehui-list">'),n.push("</div>");const i=n.join("");this.mainEle.find(".right-info-content ul li[data-type='"+t+"']").html(i),window.lazyload(window.$(".layzload-tehui"))}}const rs=Ct.preventQuickClick(500);class cs{constructor(){m(this,"handleResult",(t=>{rs((()=>{this.currentVad=t.voiceProb}))})),m(this,"handlePipeError",(t=>{console.info("voiceError: ",t),this.unPipe()})),m(this,"handleOverload",(t=>{console.info("voiceOverload: ",t)})),this.instance=null,this.extension=null,this.processor=null,this.currentVad=-1}static getInstance(){return this.instance||(this.instance=new cs),this.instance}createExtension(){if(this.extension)return this.processor;const t=new nt({assetsPath:"https://asset.tuwan.com/chatroom/agora/"});return this.extension=t,t.checkCompatibility()?(t.onloaderror=t=>{console.error(t)},window.AgoraRTC.registerExtensions([t]),t):console.warn("vad plugin is not support!")}createProcessor(){if(this.processor)return this.processor;this.createExtension();try{this.processor=this.extension.createProcessor(),this.processor.on("pipeerror",this.handlePipeError),this.processor.on("overload",this.handleOverload),this.processor.on("result",this.handleResult)}catch(t){}}async enable(){this.createProcessor();try{this.processor&&await this.processor.enable()}catch(t){}}async disable(){this.createProcessor();try{this.processor&&await this.processor.disable()}catch(t){}this.currentVad=-1}async pipe(t){this.createProcessor();try{this.processor&&t.pipe(this.processor).pipe(t.processorDestination)}catch(e){console.error(e)}}async unPipe(t){this.createProcessor();try{this.processor&&(this.processor.unpipe(),t&&t.unpipe(),t&&t.pipe(t.processorDestination))}catch(e){console.error(e)}}}const ls=window.AgoraRTC;class ds{constructor(t,e){this.client=null,this.emitter=t||new Ht,this.parent=e,this.appId=Mt.appid,this.leaveData=null,this.localAudio=null,this.localVideo=null,this.role="",this.audioContext=null,this.compressorNode=null,this.audioGainNode=null,this.stream=null,this.customAudioTrack=null,this.onMixinLinster=null,ls.setLogLevel(ls.ERROR),ls.enableLogUpload(),this.onMixin(),"1"!=Ct.getQueryString("log")&&ls.setLogLevel(4)}onMixin(){const t=this;null==this.onMixinLinster?this.onMixinLinster=()=>{null!=t.audioContext&&t.audioContext.resume()}:document.documentElement.removeEventListener("mousedown",this.onMixinLinster),document.documentElement.addEventListener("mousedown",this.onMixinLinster)}getAudioDevices(){return ls.getMicrophones()}get _client(){return this.client}initChat(t,e){const n=ls.createClient({mode:"live",codec:"vp8"});this.client=n,this.emitter.emit("rtcInitSuccess"),n.on("connection-state-change",(t=>{this.emitter.emit("connectionStateChange",t)})),n.on("reconnect",(()=>{this.emitter.emit("reconnect")})),this.client.enableAudioVolumeIndicator(1e3),n.on("volume-indicator",(t=>{this.emitter.emit("volumeIndicator",t);const e=t.map((t=>({uid:t.uid,level:t.level})));this.emitter.emit("volumeIndicatorDetection",e)})),n.on("user-published",((t,e)=>{console.log("user-published"),this.emitter.emit("userPublished",t,e)})),n.on("user-unpublished",((t,e)=>{console.log("user-unpublished"),this.emitter.emit("userUnpublished",t,e)})),n.on("channel-media-relay-state",(t=>{})),n.on("channel-media-relay-event",(t=>{})),n.on("user-left",(t=>{this.emitter.emit("peerLeave",t)})),n.on("mute-audio",((...t)=>{this.emitter.emit("muteAudio",t)})),n.on("unmute-audio",(t=>{this.emitter.emit("unmuteAudio",t.uid)})),n.on("first-audio-frame-decode",(function(t){this.emitter.emit("firstaudioframedecode",t.stream)})),n.on("stream-message",((t,e)=>{this.emitter.emit("stream-message",t,e)})),n.on("audio-metadata",(t=>{this.emitter.emit("audio-metadata",t)}))}joinChat(t,e,n,i=!1,o=!1){this.client&&this.client.join(uu.isSpecialSongRoom()?"e6716c175bd24abda699d12f70b98649":this.appId,e,t,1*n).then((t=>{this.emitter.emit("joinChanneled",t);const e=uu.isShengyouRoom()||o?"high_quality_stereo":"standard_stereo",i=window.localStorage.getItem("device-3a");let s={AEC:!1,AGC:!1,ANS:!1,encoderConfig:e};uu.isSpecialSongRoom()?s={AEC:!1,AGC:!0,ANS:!0,encoderConfig:e}:1==i&&(s={AEC:!0,AGC:!0,ANS:!0,encoderConfig:e}),console.log("before AgoraRTC.createMicrophoneAudioTrack"),ls.createMicrophoneAudioTrack(s).then((t=>{console.log("sucess AgoraRTC.createMicrophoneAudioTrack"),this.localAudio=t,this.emitter.emit("initStreamed",{id:n}),cs.getInstance().pipe(this.localAudio),cs.getInstance().disable()})).catch((t=>{}))})).catch((t=>{console.log("声网加入房间报错--"),console.log(t)}))}setAudioVolume(t,e){if(console.log("setAudioVolume"),uu.isPListType2()||uu.isSongTempRoom())for(let i of e.values())null!=i.audioTrack&&i.audioTrack.setVolume(1*t);else null!=this.audioGainNode&&(this.audioGainNode.gain.value=t/100);try{for(let n of e.values())null!=n.audioTrack&&n.audioTrack.setVolume(1*t)}catch(n){console.log(n)}}setVideoDevice(t){this.localVideo&&this.localVideo.setDevice(t)}setAudioDevice(t){this.localAudio&&this.localAudio.setDevice(t)}setCustomAudioTrackVolume(t){console.log("setCustomAudioTrackVolume"),null!=this.customAudioTrack&&this.customAudioTrack.isPlaying&&this.customAudioTrack.setVolume(1*t)}publishCustomAudioTrack(t){console.log("publishCustomAudioTrack"),this.client.setClientRole("host").then((()=>{this.client.publish(t).then((()=>{this.emitter.emit("streamPublished",this.localAudio)})).catch((t=>{this.emitter.emit("publishStreamError",t)}))})).catch((t=>{}))}unpublishCustomAudioTrack(t){console.log("unpublishCustomAudioTrack"),this.client.unpublish(t)}setRemoteVideoConfig(t,e){null!=this.client&&this.client.setRemoteVideoStreamType(t,e)}publish(){console.log("publish"),this.client&&this.localAudio&&""!=this.parent.audioInputDeviceId&&this.client.setClientRole("host").then((()=>{this.client.publish(this.localAudio).then((()=>{this.emitter.emit("streamPublished",this.localAudio),cs.getInstance().enable()})).catch((t=>{this.emitter.emit("publishStreamError",t)}))})).catch((t=>{}))}async _publishVideo(t){if(this.client){const n=uu.roomInfo.live_code;try{this.localVideo=await ls.createCameraVideoTrack({cameraId:t,encoderConfig:{bitrateMin:n.big.kbps,bitrateMax:n.big.kbps,width:n.big.width,height:{min:n.big.height,max:n.big.height},frameRate:n.big.fps}}),this.client.enableDualStream(),this.client.setLowStreamParameter({bitrate:n.small.kbps,framerate:n.small.fps,width:n.small.width,height:n.small.height}),this.localVideo&&this.client.setClientRole("host").then((()=>{this.client.publish(this.localVideo).then((()=>{Mi.getInstance().showLocalVideo(uu.getMeid(),this.localVideo),Mi.getInstance().setLive(uu.getMeid(),1)})).catch((t=>{this.emitter.emit("publishStreamError",t)}))})).catch((t=>{}))}catch(e){Vt("摄像头识别失败,请检查摄像头是否正常或被占用..")}}}getVideoDevices(){return ls.getCameras()}unpublish(t){console.log("unpublish");let e=!0;this.client.unpublish(this.localAudio).then((()=>{cs.getInstance().disable(),null!=this.localVideo&&0!=this.localVideo.isPlaying||(Cd.getInstance().destorySomething(),this.client.setClientRole("audience",{level:1}).then((()=>{e=!1,this.emitter.emit("unpublishSuccess",e)})).catch((e=>{this.emitter.emit("unpublishError",e,t)})))})).catch((e=>{this.emitter.emit("unpublishError",e,t)}))}unpublishVideo(t){this.client&&this.localVideo&&this.localVideo.isPlaying&&this.client.unpublish(this.localVideo).then((()=>{Mi.getInstance().setLive(uu.getMeid(),0),Mi.getInstance().hideLocalVideo(uu.getMeid()),this.localVideo.stop(),this.localVideo.close()})).catch((e=>{this.emitter.emit("unpublishError",e,t)}))}muteLocalAudio(t){console.log("muteLocalAudio"),t?this.disableAudio():this.enableAudio()}disableAudio(){this.client&&this.localAudio&&this.localAudio.setMuted(!0)}enableAudio(){console.log("enableAudio"),this.client&&this.localAudio&&this.localAudio.setMuted(!1)}setLocalAudioVolume(t){console.log("setLocalAudioVolume"),this.client&&this.localAudio&&this.localAudio.setVolume(t)}isAudioOn(){return console.log("isAudioOn"),!(!this.client||!this.localAudio)&&this.localAudio.enabled}leave(t){return console.log("leave"),new Promise(((t,e)=>{this.client?this.client.leave().then((()=>{cs.getInstance().unPipe(this.localAudio),cs.getInstance().disable(),this.localAudio&&this.localAudio.isPlaying&&(this.localAudio.stop(),this.localAudio.close()),this.localVideo&&this.localVideo.isPlaying&&(this.localVideo.stop(),this.localVideo.close()),t()})).catch((t=>{e(t)})):e()}))}isPlaying(){return!(!this.client||!this.localAudio)&&this.localAudio.isPlaying}isVideoPlaying(){return!(!this.client||!this.localVideo)&&this.localVideo.isPlaying}async subscribe(t){console.log("subscribe"),console.log(t),this.client.subscribe(t,"audio").then((e=>{window.SVGA.volume=xt.getInstance().getMainVolume()/100,t.audioTrack.play();const n=xt.getInstance().getMainVolume();t.audioTrack.setVolume(1*n)})).catch((t=>{console.log("agora error: "+t)}))}async subscribeVideo(t){await this.client.subscribe(t,"video"),Mi.getInstance().checkVideoUser(t),Mi.getInstance().showVideo(t)}unsubscribe(t){console.log("unsubscribe"),this.client.unsubscribe(t).then((()=>{})).catch((t=>{}))}sendStreamMessage(t){this.client&&this.client.sendStreamMessage(t)}sendAudioMetadata(t){this.client&&this.client.sendAudioMetadata(t)}}const ms=window.VERTC;class hs{constructor(t,e){this.emitter=t,this.parent=e,this.appId=Mt.IRTCAppid,this.engine=ms.createEngine(this.appId),this.customAudioTrack=null,this.initEvents()}initEvents(){this.engine.enableAudioPropertiesReport({interval:1e3,enableInBackground:!1}),this.engine.on(ms.events.onRemoteAudioPropertiesReport,(t=>{const e=t.map((t=>({uid:t.streamKey.userId,level:t.audioPropertiesInfo.linearVolume/255*100})));this.emitter.emit("volumeIndicator",e)})),this.engine.on(ms.events.onUserPublishStream,(({userId:t,mediaType:e})=>{e===ms.MediaType.AUDIO_AND_VIDEO?(this.emitter.emit("userPublished",{uid:t},"audio"),this.emitter.emit("userPublished",{uid:t},"video")):this.emitter.emit("userPublished",{uid:t},e===ms.MediaType.AUDIO?"audio":"video")})),this.engine.on(ms.events.onUserUnpublishStream,(({userId:t,mediaType:e})=>{this.emitter.emit("userUnpublished",{uid:t},e===ms.MediaType.AUDIO?"audio":"video")})),this.engine.on(ms.events.onUserLeaveEvent,(t=>{this.emitter.emit("peerLeave",{uid:t.userInfo.userId})})),this.engine.on(ms.events.onRemoteAudioFirstFrame,(({userId:t})=>{this.setAudioVolume(xt.getInstance().getMainVolume()/100,t)}))}setAudioVolume(t,e){(e?[this.engine._remoteAudioPlayer.get(e)]:Array.from(this.engine._remoteAudioPlayer.values())).forEach((e=>{e&&e.domElement&&(e.domElement.volume=t)}))}initChat(t,e){this.emitter.emit("rtcInitSuccess")}get _client(){return this.engine}async joinChat(t,e,n,i=!1,o=!1){this.engine.joinRoom(t,e,{userId:String(n)},{isAutoPublish:!1,isAutoSubscribeAudio:!1,isAutoSubscribeVideo:!1,roomProfileType:ms.RoomProfileType.chatRoom}).then((()=>{this.engine.setAudioProfile(uu.isShengyouRoom()||o?ms.AudioProfileType.hd:ms.AudioProfileType.standardStereo);try{1==window.localStorage.getItem("device-3a")||this.engine.setAudioCaptureConfig({autoGainControl:!1,echoCancellation:!1,noiseSuppression:!1}),this.engine.startAudioCapture()}catch(t){}this.emitter.emit("joinChanneled",n),this.emitter.emit("initStreamed",{id:n})})).catch((t=>{}))}setCustomAudioTrackVolume(t){this.customAudioTrack&&this.customAudioTrack.setVolume(t)}publishCustomAudioTrack(t){}unpublishCustomAudioTrack(t){}setRemoteVideoConfig(t,e){const n=uu.roomInfo.live_code,i=0===e?{width:n.big.width,height:n.big.height}:{width:n.small.width,height:n.small.height};this.engine.setRemoteVideoConfig(String(t),i)}async publish(){if(!(await this.checkPermission({video:!1,audio:!0})).audio)return"1"==Rt?(Vt("麦克风或声卡识别失败，请检查设备后重新打开客户端!"),void console.log("麦克风或声卡识别失败，请检查设备后重新打开客户端!")):void Vt("声卡识别失败，不能播放声音");if(""!=this.parent.audioInputDeviceId)try{await this.engine.setUserVisibility(!0);try{await this.engine.startAudioCapture()}catch(t){console.log(t)}await this.engine.publishStream(ms.MediaType.AUDIO),this.emitter.emit("streamPublished")}catch(t){this.emitter.emit("publishStreamError",t)}}muteLocalAudio(t){console.error("火山暂未实现muteLocalAudio方法："+t)}checkPermission(t){return ms.enableDevices(t)}getAudioDevices(){return ms.enumerateAudioCaptureDevices()}getVideoDevices(){return ms.enumerateVideoCaptureDevices()}setVideoDevice(t){this.engine.setVideoCaptureDevice(t)}setAudioDevice(t){this.engine.setAudioCaptureDevice(t)}async _publishVideo(t){if(!(await this.checkPermission({video:!0,audio:!0})).video)return void Vt("摄像头识别失败,请检查摄像头是否正常或被占用..");const e=uu.roomInfo.live_code;try{this.engine.setVideoCaptureDevice(t),this.engine.enableSimulcastMode(!0),await this.engine.setVideoEncoderConfig([{width:e.big.width,height:e.big.height,frameRate:e.big.fps,maxKbps:e.big.kbps},{width:e.small.width,height:e.small.height,frameRate:e.small.fps,maxKbps:e.small.kbps}]),await this.engine.setUserVisibility(!0),await this.engine.startVideoCapture(),Mi.getInstance().showLocalVideo(uu.getMeid()),Mi.getInstance().setLive(uu.getMeid(),1),this.engine.setLocalVideoPlayer(ms.StreamIndex.STREAM_INDEX_MAIN,{renderDom:"",userId:uu.getMeid()}),this.engine.setLocalVideoPlayer(ms.StreamIndex.STREAM_INDEX_MAIN,{renderDom:Mi.getInstance().getVideoDomId(uu.getMeid()),renderMode:ms.VideoRenderMode.RENDER_MODE_HIDDEN,userId:uu.getMeid()});try{await this.engine.publishStream(ms.MediaType.VIDEO)}catch(n){this.emitter.emit("publishStreamError",n)}}catch(n){Vt("摄像头识别失败,请检查摄像头是否正常或被占用..")}}setLocalAudioVolume(t){}isPlaying(){return!1}unpublish(t){this.engine.unpublishStream(ms.MediaType.AUDIO).then((()=>{this.emitter.emit("unpublishSuccess",!0)})).catch((e=>{this.emitter.emit("unpublishError",e,t)}))}unpublishVideo(t){this.engine.unpublishStream(ms.MediaType.VIDEO).then((()=>{1==t&&Mi.getInstance().setLive(uu.getMeid(),0),Mi.getInstance().hideLocalVideo(uu.getMeid()),this.engine.stopVideoCapture(),this.engine.setLocalVideoPlayer(ms.StreamIndex.STREAM_INDEX_MAIN,{renderDom:"",userId:uu.getMeid()})})).catch((e=>{this.emitter.emit("unpublishError",e,t)}))}leave(t){return new Promise(((t,e)=>{this.engine.leaveRoom().then((()=>{t()})).catch((t=>{e(t)}))}))}subscribe(t){this.engine.subscribeStream(String(t.uid),ms.MediaType.AUDIO).then((t=>{window.SVGA.volume=xt.getInstance().getMainVolume()/100})).catch((t=>{}))}async subscribeVideo(t){try{await this.engine.subscribeStream(String(t.uid),ms.MediaType.VIDEO),Mi.getInstance().checkVideoUser(t),Mi.getInstance().showVideo(t),await this.engine.setRemoteVideoPlayer(ms.StreamIndex.STREAM_INDEX_MAIN,{userId:String(t.uid),renderDom:Mi.getInstance().getVideoDomId(t.uid),renderMode:ms.VideoRenderMode.RENDER_MODE_HIDDEN,isScreen:!1})}catch(e){}}unsubscribe(t){console.log("unsubscribe"),console.log(t),this.engine.unsubscribeStream(String(t.uid),ms.MediaType.AUDIO).then((()=>{})).catch((t=>{}))}sendStreamMessage(){}}const us=window.TRTC;class ps{constructor(t,e){this.client=null,this.emitter=t||new Ht,this.parent=e,this.appId=Mt.TRTCAppid,this.leaveData=null,this.localAudio=null,this.localVideo=null,this.role="",this.audioContext=null,this.compressorNode=null,this.audioGainNode=null,this.stream=null,this.uid=null,this.customAudioTrack=null,this.onMixinLinster=null,this.mixedAudioTrack=null,this.audioSourceA=null,this.audioSourceB=null,this.isFirstStartAudioMixer=!0,this.audioUrl_ID_A="",this.audioUrl_ID_B="",this.isPublishing=!1}getAudioDevices(){return us.getMicrophoneList()}get _client(){return this.client}initChat(t,e){this.uid=t;const n=us.create();this.client=n,this.emitter.emit("rtcInitSuccess"),n.enableAudioVolumeEvaluation(1e3,!0),n.on(us.EVENT.AUDIO_VOLUME,(t=>{const e=t.result.map((t=>({uid:t.userId||uu.getMeid(),level:t.volume})));e.length&&(this.emitter.emit("volumeIndicator",e),this.emitter.emit("volumeIndicatorDetection",e))})),n.on(us.EVENT.REMOTE_AUDIO_AVAILABLE,(async t=>{const e=xt.getInstance().getMainVolume();await this.client.setRemoteAudioVolume("*",parseInt(e))})),n.on(us.EVENT.REMOTE_AUDIO_AVAILABLE,(t=>{this.emitter.emit("userPublished",t.userId,"audio")})),n.on(us.EVENT.REMOTE_AUDIO_UNAVAILABLE,(t=>{this.client.muteRemoteAudio(t.userId,!0),this.emitter.emit("userUnpublished",t.userId,"")}))}async joinChat(t,e,n,i=!1,o=!1,s){if(this.client){await this.client.enterRoom({strRoomId:s,sdkAppId:this.appId,userId:n+"",userSig:t,scene:us.TYPE.SCENE_LIVE,autoReceiveAudio:!1}).catch((t=>{if(uu.getSelfInfo().teacher&&uu.getAnchorKengUser(uu.getMeid())){const{code:e=""}=t;100013==e&&Vt(`RTC异常，type:TRTC, code:${e},请联系相关运营`)}}));let e=n;this.emitter.emit("joinChanneled",e),this.localAudio=!0,this.emitter.emit("initStreamed",{id:n})}}async setAudioVolume(t,e){await this.client.setRemoteAudioVolume("*",parseInt(t))}setVideoDevice(t){}async setAudioDevice(t){this.isPublishing&&this.client.updateLocalAudio({option:{microphoneId:t}})}setCustomAudioTrackVolume(t){null!=this.customAudioTrack&&this.customAudioTrack.isPlaying&&this.customAudioTrack.setVolume(1*t)}async publishCustomAudioTrack(t,e){let n=e;const i=t.captureStream().getAudioTracks()[0],o=n.captureStream().getAudioTracks()[0],s=t.src,a=e.src;this.audioUrl_ID_A!=s&&(this.audioUrl_ID_A&&(await this.client.stopPlugin("AudioMixer",{id:this.audioUrl_ID_A}),await this.client.stopPlugin("AudioMixer",{id:this.audioUrl_ID_B})),await this.client.startPlugin("AudioMixer",{id:s,track:i}),await this.client.startPlugin("AudioMixer",{id:a,track:o}),this.audioUrl_ID_A=s,this.audioUrl_ID_B=a)}async unpublishCustomAudioTrack(t,e){await this.client.stopPlugin("AudioMixer",{id:this.audioUrl_ID_A}),await this.client.stopPlugin("AudioMixer",{id:this.audioUrl_ID_B}),this.audioUrl_ID_A="",this.audioUrl_ID_B=""}publish(){console.log("innner publish"),this.client.switchRole(us.TYPE.ROLE_ANCHOR).then((async()=>{await this.client.startLocalAudio(),this.emitter.emit("streamPublished"),this.isPublishing=!0})).catch((t=>{console.log("agora publish err:"+t)}))}getVideoDevices(){return us.getCameraList()}async unpublish(t){let e=!0;this.isPublishing=!1,await this.client.muteRemoteAudio(this.uid+"",!0),this.client.stopLocalAudio().then((async()=>{null!=this.localVideo&&0!=this.localVideo.isPlaying||(Cd.getInstance().destorySomething(),this.client.switchRole(us.TYPE.ROLE_AUDIENCE).then((()=>{e=!1,this.emitter.emit("unpublishSuccess",e)})).catch((e=>{this.emitter.emit("unpublishError",e,t)})))})).catch((e=>{this.emitter.emit("unpublishError",e,t)}))}muteLocalAudio(t){t?this.disableAudio():this.enableAudio()}enableAudio(){throw new Error("Method not implemented.")}disableAudio(){this.client}setLocalAudioVolume(t){this.client&&this.localAudio&&this.localAudio.setVolume(t)}leave(t){return new Promise(((t,e)=>{this.client?this.client.exitRoom().then((async()=>{await this.client.stopLocalAudio(),t()})).catch((t=>{e(t)})):e()}))}isPlaying(){return!(!this.client||!this.localAudio)&&this.localAudio.isPlaying}isVideoPlaying(){return!(!this.client||!this.localVideo)&&this.localVideo.isPlaying}async subscribe(t){try{await this.client.muteRemoteAudio(t+"",!0)}catch(e){}this.client.muteRemoteAudio(t+"",!1).then((()=>{window.SVGA.volume=xt.getInstance().getMainVolume()/100,xt.getInstance().getMainVolume()})).catch((t=>{console.log("trtc error: "+t)}))}async subscribeVideo(t){await this.client.subscribe(t,"video"),Mi.getInstance().checkVideoUser(t),Mi.getInstance().showVideo(t)}unsubscribe(t){this.client.muteRemoteAudio(t+"",!0).then((()=>{console.log("unsubscribe-suceess")})).catch((t=>{console.log("unsubscribe-err",t)}))}sendStreamMessage(t){this.client&&this.client.sendStreamMessage(t)}unpublishVideo(){}}class gs{constructor(t,e){this.client=null,this.emitter=t||new Ht,this.parent=e,this.appId=Mt.zegoAppid,this.autoMixerTimer=null,this.soundLevelEvt=[],this.soundLevelTimer=null,this.viewObj={}}resetFn(){}getAudioDevices(){return window.AgoraRTC.getMicrophones()}get _client(){return this.client}disposeStreamId(t){return"_0"==t.substr(-2,2)?t.slice(0,-2):t}uidToStreamId(t){return`${t}_0`}initChat(t,e){const n=new window.ZegoExpressEngine(this.appId,`wss://webliveroom${this.appId}-api.imzego.com/ws`);n.setLogConfig({logLevel:"disable",remoteLogLevel:"info"}),n.setDebugVerbose(!1),n.zegoWebRTM.reporter.tracerHandler.tracer.setLogLevel("debug"),n.setEngineConfig({keepAudioTrack:!0,playClearLastFrame:!1,previewClearLastFrame:!1,mixingAudioDelay:-100,choirRole:1}),n.zegoWebRTC.setAccess(!0),n.setSEIConfig({SEIPass:!0,emulationPreventionByte:!0}),n.zegoWebRTC.enableVideoHardwareEncoder(!0),this.client=n,this.emitter.emit("rtcInitSuccess"),uu.isChorusRoom()||n.setSoundLevelDelegate(!0,2e3),n.on("soundLevelUpdate",(t=>{this.soundLevelEvt=t})),n.on("publisherStateUpdate",(({streamID:t,state:e})=>{switch(e){case"PUBLISHING":this.emitter.emit("publisherSuccess",t);break;case"NO_PUBLISH":this.emitter.emit("unpublisherSuccess",t)}})),n.on("roomStreamUpdate",(async(t,e,n=[])=>{switch(e){case"ADD":for(const t of n)this.emitter.emit("userPublished",{uid:this.disposeStreamId(t.streamID),streamID:t.streamID},"audio");break;case"DELETE":for(const t of n)this.emitter.emit("userUnpublished",{uid:this.disposeStreamId(t.streamID),streamID:t.streamID},"audio")}})),n.on("playerRecvSEI",((t,e)=>{this.emitter.emit("playerRecvSEI",t,e)})),n.on("autoMixerSoundLevelUpdate",(t=>{if(!this.autoMixerTimer){const e=[];for(const[n,i]of t)e.push({uid:this.disposeStreamId(n),level:i});this.emitter.emit("autoMixerSoundLevelUpdate",e),this.autoMixerTimer=setTimeout((()=>{window.clearTimeout(this.autoMixerTimer),this.autoMixerTimer=null}),2e3)}}))}startVolumeIndicator(){this.stopVolumeIndicator(),this.soundLevelTimer=setInterval((()=>{const t=this.soundLevelEvt.map((t=>({uid:this.disposeStreamId(t.streamID),level:t.soundLevel})));this.emitter.emit("volumeIndicator",t),this.emitter.emit("volumeIndicatorDetection",t),this.soundLevelEvt=[]}),2e3)}stopVolumeIndicator(){this.soundLevelTimer&&(window.clearInterval(this.soundLevelTimer),this.soundLevelTimer=null)}joinChat(t,e,n,i=!1,o=!1){this.client&&this.client.loginRoom(e,t,{userID:String(n)},{userUpdate:!0}).then((async()=>{this.emitter.emit("joinChanneled",n),uu.isChorusRoom()||this.startVolumeIndicator();const t=window.localStorage.getItem("device-3a");let e={AEC:!1,AGC:!1,ANS:!1};uu.isChorusRoom()?e={AEC:!1,AGC:!0,ANS:!0}:1==t&&(e={AEC:!0,AGC:!0,ANS:!0}),this.client.createStream({camera:c({videoQuality:4,audioBitrate:128,video:!1,audio:!0},e)}).then((t=>{this.localAudio=t,this.emitter.emit("initStreamed",{id:n})})).catch((t=>{}))})).catch((t=>{}))}setAudioVolume(t,e){let n=this.viewObj;Object.keys(n).forEach((e=>{let i=n[e];null==i||i.setVolume(1*t)}));for(let i of e.values())null!=i.audioTrack&&i.audioTrack.setVolume(t)}setVideoDevice(t){}setAudioDevice(t){}setCustomAudioTrackVolume(t){}publishCustomAudioTrack(t){this.client&&this.localAudio&&this.client.startMixingAudio(this.localAudio,[t])}unpublishCustomAudioTrack(t){this.client&&this.localAudio&&this.client.stopMixingAudio(this.localAudio,[t])}setRemoteVideoConfig(t,e){}async publish(){if(this.localAudio&&this.client&&""!=this.parent.audioInputDeviceId)try{await this.client.startPublishingStream(this.uidToStreamId(uu.getMeid()),this.localAudio,{isSEIStart:!0,SEIType:1,forceSynchronousNetworkTime:1,videoCodec:"H264",setDeviceDelayByUser:100}),this.emitter.emit("streamPublished",this.localAudio)}catch(t){this.emitter.emit("publishStreamError",t)}}async unpublish(t){this.localAudio&&this.client&&(await this.client.stopPublishingStream(this.uidToStreamId(uu.getMeid())),this.emitter.emit("unpublishSuccess",!0))}async _publishVideo(t){}unpublishVideo(t){}getVideoDevices(){return window.AgoraRTC.getCameras()}muteLocalAudio(t){}disableAudio(){}enableAudio(){}setLocalAudioVolume(t){this.client&&this.localAudio&&this.client.mutePublishStreamAudio(this.localAudio,0==t)}isAudioOn(){}leave(t){return this.stopVolumeIndicator(),new Promise(((t,e)=>{this.client?(this.client.logoutRoom(),t()):e()}))}isPlaying(){}isVideoPlaying(){}async subscribe(t){if(this.client){const e=await this.client.startPlayingStream(t.streamID,{isSEIStart:!0,playoutDelayHint:.5}),n=this.client.createRemoteStreamView(e);n.play("zego_audio_container",{enableAutoplayDialog:!1}),this.viewObj[t.uid]=n;const i=xt.getInstance().getMainVolume();return n.setVolume(1*i),n.on("autoplayFailed",(()=>{console.error("autoplayFailed",t.streamID)})),window.SVGA.volume=xt.getInstance().getMainVolume()/100,t.audioTrack=n,n}}async subscribeVideo(t){}unsubscribe(t){if(this.client){this.client.stopPlayingStream(t.streamID);try{let e=t.uid;this.viewObj[e]=null,delete this.viewObj.uid}catch(e){console.log(e)}}}sendStreamMessage(t){}}class fs{constructor(){m(this,"setLocalAudioVolume",(t=>{this.currentRtc().setLocalAudioVolume(t)})),m(this,"isPlaying",(()=>this.currentRtc().isPlaying())),this.emitter=new Ht,this.agoraRtc=new ds(this.emitter,this),this.iRtc=new hs(this.emitter,this),this.zegoRtc=new gs(this.emitter,this),this.tencentRtc=new ps(this.emitter,this),this.audioInputDeviceId="",this.getDevices()}currentRtcType(){return uu.roomInfo?uu.roomInfo.voice_type:0}currentRtc(){const t=this.currentRtcType();try{0!=t&&this.agoraRtc&&this.agoraRtc.client&&this.agoraRtc.client.leave&&this.agoraRtc.client.leave(),2!=t&&this.zegoRtc&&this.zegoRtc.client&&this.zegoRtc.client.leave&&this.zegoRtc.client.leave()}catch(e){console.log(e)}switch(t){case 0:return this.agoraRtc;case 1:return this.iRtc;case 2:return this.zegoRtc;case 3:return this.tencentRtc}return this.agoraRtc}initChat(t,e){console.log("this.currentRtc()"),console.log(this.currentRtc()),this.currentRtc().initChat(t,e)}joinChat(...t){this.currentRtc().joinChat(...t)}publishCustomAudioTrack(...t){this.currentRtc().publishCustomAudioTrack(...t)}unpublishCustomAudioTrack(...t){this.currentRtc().unpublishCustomAudioTrack(...t)}publish(){this.currentRtc().publish()}publishVideo(){this.currentRtc().getVideoDevices().then((t=>{const e=t.filter((t=>"YY开播"==t.label));if(0==t.length)return void Vt("请检查摄像头是否安装正确");let n=0;if(e.length>0)n=e[0].deviceId;else{const e=t.filter((t=>"default"==t.label));n=e.length>0?e[0].deviceId:t[0].deviceId}this.currentRtc()._publishVideo(n)})).catch((t=>{Vt("摄像头识别失败,请检查摄像头是否正常..")}))}unpublish(t){this.currentRtc().unpublish(t)}unpublishVideo(t){this.currentRtc().unpublishVideo(t)}muteLocalAudio(t){this.currentRtc().muteLocalAudio(t)}setRemoteVideoConfig(...t){this.currentRtc().setRemoteVideoConfig(...t)}leave(t){return this.currentRtc().leave(t)}unsubscribe(t){this.currentRtc().unsubscribe(t)}setCustomAudioTrackVolume(t){this.currentRtc().setCustomAudioTrackVolume(t)}setVideoDevice(t){this.currentRtc().setVideoDevice(t)}setAudioDevice(t){const e=this;this.agoraRtc.getAudioDevices().then((n=>{n.length>0&&null!=n.find((e=>e.deviceId==t))&&e.currentRtc().setAudioDevice(t)})).catch((t=>{}))}setAudioVolume(t,e){this.currentRtc().setAudioVolume(t,e)}sendStreamMessage(t){this.currentRtc().sendStreamMessage(t)}sendAudioMetadata(t){this.currentRtc().sendAudioMetadata(t)}async subscribe(t){return await this.currentRtc().subscribe(t)}async subscribeVideo(t){await this.currentRtc().subscribeVideo(t)}get localVideo(){return this.currentRtc().localVideo}get localAudio(){return this.currentRtc().localAudio}get customAudioTrack(){return this.currentRtc().customAudioTrack}get audioGainNode(){return this.currentRtc().audioGainNode}get leaveData(){return this.currentRtc().leaveData}get client(){return this.currentRtc()._client}getDevices(){this.agoraRtc.getAudioDevices().then((t=>{if(t.length>0){const e=window.localStorage.getItem("device-id");if(null!=t.find((t=>t.deviceId==e)))this.audioInputDeviceId=e;else for(let n=0;n<t.length;n++){const e=t[n].kind,i=t[n].deviceId;t[n].groupId,"audioinput"==e&&""==this.audioInputDeviceId&&(this.audioInputDeviceId=i)}}})).catch((t=>{}))}}class ws{constructor(t){m(this,"userPublishedCallback",(async(t,e)=>{const n=1*t.uid;if(this.usersMap.set(n,t),this.subscribeSet.has(n)){const e=await this.client.subscribe(t);e&&(this.streamViewMap.set(n,e),this.muteSet.has(n)&&e.setAudioMuted(!0))}})),m(this,"userUnpublishedCallback",((t,e)=>{this.usersMap.delete(1*t.uid),this.streamViewMap.delete(1*t.uid)})),m(this,"joinChanneledCallback",(()=>{this.joinChanneledCb&&this.joinChanneledCb()})),m(this,"initStreamedCallback",(()=>{this.initStreamedCb&&this.initStreamedCb()})),m(this,"streamMessageCallback",((t,e)=>{this.streamMessageCb&&this.streamMessageCb(t,e)})),m(this,"audioMessageCallback",(t=>{this.audioMessageCb&&this.audioMessageCb(t)})),m(this,"streamPublishedCallback",(()=>{this.published=!0,this.streamPublishedCb&&this.streamPublishedCb()})),m(this,"unpublishSuccessCallback",(()=>{this.published=!1,this.unpublishSuccessCb&&this.unpublishSuccessCb()})),m(this,"receiveSeiCallback",((t,e)=>{this.receiveSeiCb&&this.receiveSeiCb(t,e)})),m(this,"publisherSuccessCallback",(t=>{this.publisherSuccessCb&&this.publisherSuccessCb(t)})),m(this,"autoMixerSoundLevelUpdateCallback",(t=>{this.autoMixerSoundLevelUpdateCb&&this.autoMixerSoundLevelUpdateCb(t)})),m(this,"setLocalAudioVolume",(t=>{this.client.setLocalAudioVolume(t)})),m(this,"isPlaying",(()=>this.client.isPlaying())),this.foreverSubscribeSet=new Set,this.usersMap=new Map,this.subscribeSet=new Set,this.muteSet=new Set,this.streamViewMap=new Map,this.published=!1,t?this.client=t:(this.client=new fs,this.client.initChat()),this.registerEvents(),this.joinChanneledCb=null,this.initStreamedCb=null,this.streamMessageCb=null,this.streamMessageCb=null,this.streamPublishedCb=null,this.unpublishSuccessCb=null,this.receiveSeiCb=null,this.publisherSuccessCb=null,this.autoMixerSoundLevelUpdateCb=null}registerEvents(){this.client.emitter.on("userPublished",this.userPublishedCallback),this.client.emitter.on("userUnpublished",this.userUnpublishedCallback),this.client.emitter.on("joinChanneled",this.joinChanneledCallback),this.client.emitter.on("initStreamed",this.initStreamedCallback),this.client.emitter.on("stream-message",this.streamMessageCallback),this.client.emitter.on("audio-metadata",this.audioMessageCallback),this.client.emitter.on("streamPublished",this.streamPublishedCallback),this.client.emitter.on("unpublishSuccess",this.unpublishSuccessCallback),this.client.emitter.on("playerRecvSEI",this.receiveSeiCallback),this.client.emitter.on("publisherSuccess",this.publisherSuccessCallback),this.client.emitter.on("autoMixerSoundLevelUpdate",this.autoMixerSoundLevelUpdateCallback)}removeEvents(){this.client.emitter.off("userPublished",this.userPublishedCallback),this.client.emitter.off("userUnpublished",this.userUnpublishedCallback),this.client.emitter.off("joinChanneled",this.joinChanneledCallback),this.client.emitter.off("initStreamed",this.initStreamedCallback),this.client.emitter.off("stream-message",this.streamMessageCallback),this.client.emitter.off("streamPublished",this.streamPublishedCallback),this.client.emitter.off("unpublishSuccess",this.unpublishSuccessCallback),this.client.emitter.off("playerRecvSEI",this.receiveSeiCallback),this.client.emitter.off("publisherSuccess",this.publisherSuccessCallback),this.client.emitter.off("autoMixerSoundLevelUpdate",this.autoMixerSoundLevelUpdateCallback)}join(t,e,n=uu.getMeid()){this.client.joinChat(e,t,n,!0)}publishCustomAudioTrack(t){this.client.publishCustomAudioTrack(t)}leave(){this.client.leave()}destroy(){this.leave(),this.removeEvents(),this.published=!1}foreverSubscribe(t){t*=1,this.foreverSubscribeSet.add(t),this.subscribe(t)}hasSubscribe(t){return this.subscribeSet.has(1*t)}async subscribe(t){if(t*=1,!this.subscribeSet.has(t)&&(this.subscribeSet.add(t),this.usersMap.has(t))){const e=this.usersMap.get(t),n=await this.client.subscribe(e);n&&(this.streamViewMap.set(t,n),this.muteSet.has(t)&&n.setAudioMuted(!0))}}unsubscribe(t){if(t*=1,!this.foreverSubscribeSet.has(t)){if(this.usersMap.has(t)){const e=this.usersMap.get(t);this.client.unsubscribe(e)}this.subscribeSet.delete(t)}}unsubscribeAll(){for(const t of this.subscribeSet)this.unsubscribe(t)}mute(t){if(t*=1,!this.muteSet.has(t)&&(this.muteSet.add(t),this.streamViewMap.has(t))){this.streamViewMap.get(t).setAudioMuted(!0)}}unmute(t){if(t*=1,this.muteSet.delete(t),this.streamViewMap.has(t)){this.streamViewMap.get(t).setAudioMuted(!1)}}hasMuted(t){return this.muteSet.has(1*t)}setVolume(t){this.client.setAudioVolume(t,this.usersMap)}}function vs(t,e){for(var n=new Set,i=Array.from(t),o=0;o<i.length;o++)e.has(i[o])||n.add(i[o]);return n}class _s{constructor(){this.htmlDom=null,this.setRole=null,this.muteLocalAudio=null,this.rtcClient=null,this.messageHandle=this.messageHandle.bind(this),this.volumeIndicatorCallback=this.volumeIndicatorCallback.bind(this),this.mainChannel=null,this.seatsList=[],this.cocosSeatsList=[],this.subscribeSet=new Set}static getInstance(){return this.instance||(this.instance=new _s),this.instance}onReset(){this.htmlDom&&(this.htmlDom.remove(),this.htmlDom=null),this.setRole=null,this.muteLocalAudio=null,this.rtcClient&&(this.rtcClient.emitter.off("volumeIndicator",this.volumeIndicatorCallback),this.rtcClient=null),window.removeEventListener("message",this.messageHandle),this.mainChannel&&(this.mainChannel.removeEvents(),this.mainChannel=null),this.seatsList=[],this.cocosSeatsList=[],this.subscribeSet.clear()}initTemplate(t){this.initHtml(t),this.initEvents(),this.initRtc(t),uu.isCocosH5Room()&&this.createMainChannel()}initHtml(t){const e=`\n            <div class="squidActive-anchor">\n                ${Fi._initSeatData(2,158,135,90,90,"主持",!1,!1,"add")}\n            </div>\n        `,n=`\n            <div class="squidActive-jiabin">\n                ${new Array(3).fill(0).map(((t,e)=>Fi._getOtherAnchorSeatHtml({position:3+e,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:100,pheight:135,width:65,height:65,isshowmeili:!1}))).join("")}\n            </div>\n        `,i=uu.getCid(),o=Ct.readCookie("Tuwan_Passport");let s=Ct.readCookie("g_uid");const a=uu.getSelfInfo()||{},r=a.uid||uu.getRoomInfo().uid,c=a.nickname,l=a.avatar;let d="",m=!1;m=8==uu.getRoomInfo().game_info.gameid||9==uu.getRoomInfo().game_info.gameid;const h=uu.getRoomInfo().game_info;h&&(uu.isCocosH5Room()?(uu.getMeid()<Mt.maxUID&&(s=""),d=m?It?"https://y-test.tuwan.com/amongusActiveTest?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:"https://y.tuwan.com/amongusActive?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:It?"https://y-test.tuwan.com/drawSomeActive?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:"https://y.tuwan.com/drawSomeActive?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s):d=m?It?"https://y-test.tuwan.com/amongusActiveTest?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:"https://y.tuwan.com/amongusActive?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:It?"https://y-test.tuwan.com/spyActiveTest?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s:"https://y.tuwan.com/spyActive?cid="+i+"&roomId="+h.fleetid+"&token="+o+"&game_type=4&userId="+r+"&userName="+c+"&userImg="+l+"&startScene=HallGame&guid="+s),m?(setTimeout((()=>{$(".squidActive_seats").css("marginLeft"," -825px")}),10),this.htmlDom=window.$(`\n            <div class="squidActive-content flex" style="height: 540px;">\n                <div class="squidActive_wrapper flex flex-jc">\n                    <div class="squidActive_seats">  \n                        ${e}\n                        ${n}\n                    </div>\n                    <iframe id="squidActiveIframe" style="width: 740px;height: 540px;position: absolute;right: 110px;top: -10px;margin-left: -480px;z-index: 8;" src="${d}" frameborder="0" scrolling="no" allowtransparency="true"></iframe>\n                </div>\n                ${uu.isCocosH5Room()?"":'\n                    <div style="position: absolute; left: 30px; top: 35px;">\n                        <div class="spyActive-rule flex flex-jc flex-ac">玩法</div>\n                    </div>\n                '}\n            </div>\n        `)):this.htmlDom=window.$(`\n            <div class="squidActive-content flex" style="height: 540px;">\n                <div class="squidActive_wrapper flex flex-jc">\n                    <div class="squidActive_seats">  \n                        ${e}\n                        ${n}\n                    </div>\n                    <iframe id="squidActiveIframe" src="${d}" frameborder="0" scrolling="no" allowtransparency="true"></iframe>\n                </div>\n                ${uu.isCocosH5Room()?"":'\n                    <div style="position: absolute; left: 30px; top: 35px;">\n                        <div class="spyActive-rule flex flex-jc flex-ac">玩法</div>\n                    </div>\n                '}\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom)}initEvents(){this.htmlDom.on("click",".spyActive-rule",(function(t){t.stopPropagation(),ze.show({title:"玩法介绍",desc:uu.roomInfo.rule_desc.replace(/\/r\/n/g,"<br />").replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")})})),window.addEventListener("message",this.messageHandle)}async createMainChannel(){this.mainChannel=new ws(uu.globalRtcClient)}updateSeats(t){uu.isCocosH5Room()&&(this.seatsList=t||[],this.disposeSubscribes())}updateCocosSubscribes(t){uu.isCocosH5Room()&&(this.cocosSeatsList=t||[],this.disposeSubscribes())}disposeSubscribes(){const t=[...this.seatsList.map((t=>t.uid)),...this.cocosSeatsList],e=new Set(t),n=vs(this.subscribeSet,e),i=vs(e,this.subscribeSet);this.subscribeSet=e;for(const o of n)this.mainChannel.unsubscribe(o);for(const o of i)this.mainChannel.subscribe(o);window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin")||this.inSeats(uu.getMeid())||this.setRole&&this.setRole(0)}inSeats(t){return new Set([...this.seatsList.map((t=>t.uid)),...this.cocosSeatsList]).has(t)}inCocosSeats(t){return new Set(this.cocosSeatsList).has(Number(t))}getCocosUsers(){return this.cocosSeatsList}sendGetSubscribeList(){uu.globalDDSocket.send("getSubscribeList",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.roomInfo.typeid})}socketToUids(){return uu.isCocosH5Room()&&uu.getRoomInfo().mute_room_message&&this.inCocosSeats(uu.getMeid())?this.cocosSeatsList.join(","):""}canShowSocketMessage(t){return!(uu.isCocosH5Room()&&uu.getRoomInfo().mute_room_message&&t!=uu.getMeid()&&this.inCocosSeats(uu.getMeid())&&!this.inCocosSeats(t))}initRtc(t){let e=!1;e=8==t.game_info.gameid||9==t.game_info.gameid,e||this.rtcClient.emitter.on("volumeIndicator",this.volumeIndicatorCallback)}volumeIndicatorCallback(t){const e=t.map((t=>({uid:t.uid,level:t.level})));this.volumeIndicator(e)}messageHandle(t){if(!this.htmlDom)return;const e=this.htmlDom.find("#squidActiveIframe")[0],n=t.data;if("spy"===n.type){const t=n.data;switch(t.type){case"getUsersWithUids":const n=[];for(const t of uu.getAnchorKengUsers().keys())n.push(t);e.contentWindow.postMessage({type:"spy",data:{type:"getUsersWithUids",data:n}},"*");break;case"showUserCard":this.showUserCard(t.data),e.contentWindow.postMessage({type:"spy",data:{type:"showUserCard"}},"*");break;case"removeUserCard":this.removeUserCard(),e.contentWindow.postMessage({type:"spy",data:{type:"removeUserCard"}},"*");break;case"setClientRole":this.setRole&&this.setRole(t.data),e.contentWindow.postMessage({type:"spy",data:{type:"setClientRole"}},"*");break;case"muteLocalAudioStream":this.muteLocalAudio&&this.muteLocalAudio(t.data),e.contentWindow.postMessage({type:"spy",data:{type:"muteLocalAudioStream"}},"*")}}}showUserCard(t){if(!this.htmlDom)return;const e=this.htmlDom.find("#squidActiveIframe"),{uid:n,x:i,y:o,width:s,isHomeOwner:a}=t;kd.showUserFloatInfo({account:n,roomChannel:uu.getChannel(),isSpyOwner:a}).then((t=>{const n=window.$(t).width();t.css({top:e.offset().top+e.height()-o,left:e.offset().left+i+s/2-n/2}),t.show()}))}removeUserCard(){window.$(".chat-huiyuan-info").remove()}getGameUsersWithUids(){return uu.isCocosH5Room()?Promise.resolve(this.getCocosUsers()||[]):this.iframePostMessage("getCocosUsers")}getGamingUsersWithUids(){return this.iframePostMessage("getCocosGamingUsers")}downWheat(t){console.log("downWheat"),this.iframePostMessage("downWheat",t)}volumeIndicator(t){this.iframePostMessage("volumeIndicator",t)}iframePostMessage(t,e){if(!this.htmlDom)return;const n=this.htmlDom.find("#squidActiveIframe")[0];return new Promise(((i,o)=>{function s(e){if("spy"===e.data.type){const n=e.data.data;n.type==t&&(window.removeEventListener("message",s),i(n.data))}}window.addEventListener("message",s),n.contentWindow.postMessage({type:"spy",data:{type:t,data:e}},"*"),setTimeout((()=>{window.removeEventListener("message",s),o(new Error("响应超时"))}),3e3)}))}inCocosGame(t=uu.getMeid()){return this.inSeats(t)}notInGame(t=uu.getMeid()){return new Promise(((e,n)=>{uu.isSpyActiveRoom()?this.getGamingUsersWithUids().then((i=>{i.map((t=>1*t)).includes(1*t)?n():e()})).catch((t=>{e()})):uu.isCocosH5Room()&&this.inCocosSeats(t)?n():e()}))}}class ys{static show({text:t,pointerEvents:e="inherit"}={}){this.html&&this.hide(),this.html=window.$(`\n            <div class="double-bounce-loading" style="pointer-events: ${e}">\n                <div class="double-bounce-block">\n                    <div class="bounces">\n                        <div class="double-bounce1"></div>\n                        <div class="double-bounce2"></div>\n                    </div>\n                    ${t?`<p>${t}</p>`:""}\n                </div>\n            </div>\n        `),window.$("body").append(this.html)}static hide(){this.html&&this.html.remove(),this.html=null}}class xs{constructor(){this.instance=null,this.reportId=1,this.client=null,this.initCss(),this.initHtml(),this.reportPicArr=[],this.uploadedPicArr=[],this.reportType=1,this.reportInfo={}}static getInstance(){return this.instance||(this.instance=new xs),this.instance}initCss(){window.$("head").append("<style>\n                        .modal_f{display:flex}\n                        .modal_f_c{display:flex;align-items:center;justify-content:center;}\n                        .modal_f_sb{display:flex;align-items:center;justify-content: space-between;}\n                        .report_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 9999999;position: fixed;}\n                        .report_content{position:relative;width:396px;min-height:502px;background:#fff;border-radius:12px;padding:30px;box-sizing:border-box;text-align:center;color:#333}\n                        .report_close{position:absolute;right:10px;top:10px;cursor: pointer;}\n                        .report_title{font-size:16px;}\n                        .report_type_content{flex-wrap:wrap;margin-top:25px;}\n                        .report_type_item{width:102px;height:30px;border:1px solid #dddddd;border-radius:4px;font-size:14px;margin-bottom:12px;cursor: pointer;background:unset}\n                        .report_type_item.actived{border:1px solid #ff6691;background:url(https://asset.tuwan.com/officialsite/images/report_type_select.png) no-repeat 80px center}\n                        .report_type_item:not(:nth-child(3n+3)) {margin-right: 12px;}\n                        .report_text_content{width:334px;height:108px;border-radius:6px;display:block;padding: 10px;margin: 12px auto 14px;outline: none;resize: none;box-sizing:border-box;border:unset;background:#f7f7f7}\n                        .report_pic_title{text-align:left}\n                        .report_pic_content{margin-top:23px;flex-wrap:wrap}\n                        .report_pic_item, .report_video_item{width:80px;height:80px;border-radius:6px;overflow:hidden;position:relative;background:#f7f7f7;margin-right:24px;margin-bottom:20px}\n                        .select_report_img, .select_report_video{width:80px;height:80px;}\n                        .report_delete{position:absolute;right:0;top:0;cursor: pointer;}\n                        .upload_report_pic{width:80px;height:80px;border-radius:6px;cursor: pointer;background:#f7f7f7 url(https://asset.tuwan.com/officialsite/images/report_camera.png) no-repeat center center;margin-bottom:24px}\n                        .upload_report_label{width:80px;height:80px}\n                        .upload_report_input{width: 80px;height: 80px;opacity: 0;cursor: pointer;}\n                        .commit_report{width:186px;height:36px;color:#fff;background:#ff6691;border-radius:8px;font-size:18px;margin:0 auto;cursor: pointer;}\n                    </style>")}initHtml(){window.$("body").append('<div class="report_mask">\n                        <div class="report_content">\n                            <img class="report_close" src="https://asset.tuwan.com/officialsite/images/report_close.png">\n                            <div class="report_title"></div>\n                            <div class="report_type_content modal_f"></div>\n                            <textarea type="text" placeholder="请描述违规细节" maxlength="50" class="report_text_content"></textarea>\n                            <div class="report_pic_title">补充图片证据</div>\n                            <div class="report_pic_content modal_f">\n                                <div class="upload_report_pic">\n                                    <input id="upimg" class="upload_report_input" type="file" accept="image/*,video/*">\n                                </div>\n                            </div>\n                            <div class="commit_report modal_f_c">提交</div>\n                        </div>\n                    </div>'),this.getReortTags(),this.initEvent()}showReportModal(t,e){this.reportType=t,this.reportInfo=e,this.reportPicArr=[],this.uploadedPicArr=[],window.$(".report_pic_item").remove(),window.$(".report_video_item").remove(),window.$(".report_text_content").val(""),window.$(".report_title").html(`举报${e.title}`),window.$(".report_mask").css("display","flex"),document.getElementById("upimg").value=""}getReortTags(){qt.get(Ot.getReportTag()).then((t=>{if(0==t.error){const e=t.data;let n="";e.forEach(((t,e)=>{0==e&&(this.reportId=t.id),n+=`<div class="report_type_item modal_f_c ${0==e?"actived":""}" data-id="${t.id}">${t.name}</div>`})),window.$(".report_type_content").html(n)}}))}addReportPic(t){let e=t.value,n=this;if(!e)return!1;{let e=t.files[0],i=new FileReader;i.readAsDataURL(e),i.onload=function(t){let i=t.target.result;if(e.type.indexOf("video")>=0){const t=200;if(e.size/1024/1024>t)return void Vt(`请上传${t}M内视频`);n.reportPicArr.push(e);let o=`<div class="report_video_item">\n                                    <video class="select_report_video" src="${i}"/>\n                                    <img class="report_delete" src="https://asset.tuwan.com/officialsite/images/report_delete.png"/>\n                                </div>`;window.$(".upload_report_pic").before(o)}else if(e.type.indexOf("image")>=0){if(e.size/1024/1024>5)return void Vt("请上传5M内图片");n.reportPicArr.push(e);let t=`<div class="report_pic_item">\n                                    <img class="report_delete" src="https://asset.tuwan.com/officialsite/images/report_delete.png"/>\n                                    <img class="select_report_img" src="${i}"/>\n                                </div>`;window.$(".upload_report_pic").before(t)}}}}reportMsg(){const t=window.$(".report_text_content").val();qt.get(Ot.reportMsg(t,this.reportId,this.reportType,this.uploadedPicArr.join(","),this.reportInfo.vid)).then((t=>{0==t.error?(window.$(".report_mask").hide(),Vt("举报成功"),ys.hide()):ys.hide()})).catch((()=>{ys.hide()}))}async initOssClient(){if(!this.client){await Ct.loadScript("https://asset1.tuwan.com/officialsite/script/aliyun-oss-sdk-6.0.1.js");const t=(await qt.get("https://u."+window.MAIN_DOMAIN+"/Oss/sts")).data;if(null!=t){const{AccessKeyId:e,AccessKeySecret:n,SecurityToken:i}=t;this.client=new window.OSS({endpoint:"oss-cn-qingdao.aliyuncs.com",accessKeyId:e,accessKeySecret:n,bucket:"tuwanpicshare",stsToken:i,secure:!0})}}}async putObject(t,e,n){if(await this.initOssClient(),this.client){let n=await this.client.multipartUpload(e,t);this.uploadedPicArr.push(n.name)}}initEvent(){let t=this;window.$(".report_mask").on("click",".report_close",(function(){window.$(".report_mask").hide()})),window.$(".report_mask").on("click",".report_type_item",(function(){const e=window.$(this).index(),n=this.dataset.id;window.$(".report_type_item").removeClass("actived"),window.$(".report_type_item").eq(e).addClass("actived"),t.reportId=n})),window.$(".report_mask").on("click",".upload_report_input",(function(e){9==t.reportPicArr.length&&(Vt("最多上传9个文件"),e.preventDefault())})),window.$(".report_mask").on("change",".upload_report_input",(function(){t.addReportPic(this),document.getElementById("upimg").value=""})),window.$(".report_mask").on("click",".report_delete",(function(){const e=window.$(this).parent().index();t.reportPicArr.splice(e,1),window.$(this).parent().remove()})),window.$(".report_mask").on("click",".commit_report",(function(){window.$(".report_text_content").val()?0!=t.reportPicArr.length?(t.uploadedPicArr=[],ys.show({text:"文件正在上传中..."}),Promise.all(t.reportPicArr.map(((e,n)=>new Promise((async(i,o)=>{try{const o=e.name,s=o.substr(o.lastIndexOf(".")+1),a=`compliant/${Ct.UUIDNOCA()}.${s}`;await t.putObject(e,a,n),i()}catch(s){o()}}))))).then((()=>{t.reportMsg()})).catch((()=>{ys.hide()}))):Vt("请补充图片证据"):Vt("请描述违规细节")}))}}const bs={createAutoCarDataGloab:null,g_isUpdateSelfInfo:!1,wishListEnterObj:null};class $s{constructor(){this.posMap=new Map}setSeats(t){this.posMap.clear();for(const e of t)this.posMap.set(1*e.position,e)}isAnchoringUser(t){const e=this.posMap.get(2);return e&&e.uid==t}getAnchorKengUser(t){return uu.getAnchorKengUser(t)}isInAnchors(t){return uu.isInAnchors(t)}getAnchoringUser(){return this.getAnchoringUserFromPosition(2)}getAnchoringUserId(){const t=this.getAnchoringUserFromPosition(2);return t?t.uid:0}getAnchoringUserFromPosition(t){return this.posMap.get(1*t)}isOwnerUser(t){for(let e of this.posMap.values())if(e.uid==t&&1==e.owner)return!0;return!1}}class ks{constructor(){this.htmlDom=null,this.specialSeats=null,this.modals=new Map}onReset(t=!0){if(t){this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null;for(let t of this.modals.values())t.$destroy();this.modals.clear()}}setSpecialSeats(t){this.specialSeats||(this.specialSeats=new $s),this.specialSeats.setSeats(t)}getSeatSource(){return this.specialSeats?this.specialSeats:uu}getAnchoringUserFromPosition(t){return this.getSeatSource().getAnchoringUserFromPosition(t)}mineIsOwner(){return this.getSeatSource().isOwnerUser(uu.getMeid())}mineIsAudience(){return!this.getAnchorKengUser(uu.getMeid())}mineIsMainSong(){const t=this.getAnchoringUserFromPosition(1);return!(!t||t.uid!=uu.getMeid())}mineIsGuest(){const t=this.getAnchoringUserFromPosition(3);return!(!t||t.uid!=uu.getMeid())}mineIsAnchor(){return this.getSeatSource().isAnchoringUser(uu.getMeid())}mineIsChorus(){return this.getChorusMembers().findIndex((t=>t.uid==uu.getMeid()))>=0}mineInAnchors(){return this.getAnchorKengUser(uu.getMeid())}getAnchorKengUser(t){return uu.getAnchorKengUser(t)}getChorusMembers(){throw new Error("需要子类重写这个方法返回合唱者数组")}commonShowModal(t,e){const n=this;let i=this.modals.get(t);if(!i){let o=function(){n.modals.delete(t),i.$destroy(),i=null};i=new t({target:document.body,props:c({closeModal:o},e)}),this.modals.set(t,i)}}clearSvelteComp(t){this[t]&&(this[t].$destroy(),this[t]=null)}clearSvelteComps(t){t.forEach((t=>this.clearSvelteComp.bind(this)(t)))}}var Cs=(t=>(t.fair="fair",t.good="good",t.excellent="excellent",t))(Cs||{});const Is=80,Ss=100;class Ts{constructor(){this.offset=0,this.n=0}handlePitch(t,e,n){if(e<=0)return 0;this.n+=1;const i=t-e;if(this.offset=this.offset*(this.n-1)/this.n+i/this.n,this.offset<0?this.offset=Math.max(this.offset,-1*n*.4):this.offset=Math.min(this.offset,.4*n),Math.abs(e-t)<1)return e;switch(this.n){case 1:return Math.min(e+.5*this.offset,n);case 2:return Math.min(e+.6*this.offset,n);case 3:return Math.min(e+.7*this.offset,n);case 4:return Math.min(e+.8*this.offset,n);case 5:return Math.min(e+.9*this.offset,n);default:return Math.min(e+this.offset,n)}}reset(){this.offset=0,this.n=0}}class Rs{calcScore(t,e,n,i){const o=this.pitchToTone(e),s=this.pitchToTone(t);let a=1-n/100*Math.abs(s-o)+i/100;return a=Math.max(0,a),a=Math.min(1,a),100*a}pitchToTone(t){return 12*Math.max(0,Math.log(t/55+1e-6)/Math.log(2))}}const Ms=it.Reader,As=it.Writer,Ps=it.util,js=it.roots.default||(it.roots.default={});js.MsgType=(()=>{const t={},e=Object.create(t);return e[t[0]="UNKNOWN_TYPE"]=0,e[t[1001]="LRC_TIME"]=1001,e})();const Ds=js.LrcTime=(()=>{function t(t){if(t)for(let e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.type=0,t.prototype.forward=!1,t.prototype.ts=Ps.Long?Ps.Long.fromBits(0,0,!1):0,t.prototype.songId="",t.prototype.uid=0,t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=As.create()),null!=t.type&&Object.hasOwnProperty.call(t,"type")&&e.uint32(8).int32(t.type),null!=t.forward&&Object.hasOwnProperty.call(t,"forward")&&e.uint32(16).bool(t.forward),null!=t.ts&&Object.hasOwnProperty.call(t,"ts")&&e.uint32(24).int64(t.ts),null!=t.songId&&Object.hasOwnProperty.call(t,"songId")&&e.uint32(34).string(t.songId),null!=t.uid&&Object.hasOwnProperty.call(t,"uid")&&e.uint32(40).int32(t.uid),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof Ms||(t=Ms.create(t));let n=void 0===e?t.len:t.pos+e,i=new js.LrcTime;for(;t.pos<n;){let e=t.uint32();switch(e>>>3){case 1:i.type=t.int32();break;case 2:i.forward=t.bool();break;case 3:i.ts=t.int64();break;case 4:i.songId=t.string();break;case 5:i.uid=t.int32();break;default:t.skipType(7&e)}}return i},t.decodeDelimited=function(t){return t instanceof Ms||(t=new Ms(t)),this.decode(t,t.uint32())},t.fromObject=function(t){if(t instanceof js.LrcTime)return t;let e=new js.LrcTime;switch(t.type){default:if("number"==typeof t.type){e.type=t.type;break}break;case"UNKNOWN_TYPE":case 0:e.type=0;break;case"LRC_TIME":case 1001:e.type=1001}return null!=t.forward&&(e.forward=Boolean(t.forward)),null!=t.ts&&(Ps.Long?(e.ts=Ps.Long.fromValue(t.ts)).unsigned=!1:"string"==typeof t.ts?e.ts=parseInt(t.ts,10):"number"==typeof t.ts?e.ts=t.ts:"object"==typeof t.ts&&(e.ts=new Ps.LongBits(t.ts.low>>>0,t.ts.high>>>0).toNumber())),null!=t.songId&&(e.songId=String(t.songId)),null!=t.uid&&(e.uid=0|t.uid),e},t.toObject=function(t,e){e||(e={});let n={};if(e.defaults){if(n.type=e.enums===String?"UNKNOWN_TYPE":0,n.forward=!1,Ps.Long){let t=new Ps.Long(0,0,!1);n.ts=e.longs===String?t.toString():e.longs===Number?t.toNumber():t}else n.ts=e.longs===String?"0":0;n.songId="",n.uid=0}return null!=t.type&&t.hasOwnProperty("type")&&(n.type=e.enums===String?void 0===js.MsgType[t.type]?t.type:js.MsgType[t.type]:t.type),null!=t.forward&&t.hasOwnProperty("forward")&&(n.forward=t.forward),null!=t.ts&&t.hasOwnProperty("ts")&&("number"==typeof t.ts?n.ts=e.longs===String?String(t.ts):t.ts:n.ts=e.longs===String?Ps.Long.prototype.toString.call(t.ts):e.longs===Number?new Ps.LongBits(t.ts.low>>>0,t.ts.high>>>0).toNumber():t.ts),null!=t.songId&&t.hasOwnProperty("songId")&&(n.songId=t.songId),null!=t.uid&&t.hasOwnProperty("uid")&&(n.uid=t.uid),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,it.util.toJSONOptions)},t.getTypeUrl=function(t){return void 0===t&&(t="type.googleapis.com"),t+"/LrcTime"},t})();const Ls=(t={})=>Ds.encode(t).finish(),Es=t=>Ds.decode(t);class Bs{constructor(){this._songIndex=0,this._sequence=0,this._songIndex=-1}handlerMessage(t,e){return JSON.parse(function(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}(e))}genMessage(t){return function(t){const e=[];for(let n=0,i=t.length;n<i;++n)e.push(t.charCodeAt(n));return new Uint8Array(e)}(JSON.stringify(t))}}class Fs{constructor(){this.level=3}_log(...t){console.log(...t)}_err(...t){let e="";for(let n of t)e+="string"==typeof n?n:JSON.stringify(n);console.error(e)}setLevel(t){if("number"!=typeof t||!(t<=3&&t>=0))throw Error("Invalid level");this.level=t}debug(...t){this.level<=0&&this._log(`${new Date}[ENGINE-DEBUG]: `,...t)}info(...t){this.level<=1&&this._log(`${new Date}[ENGINE-DEBUG]: `,...t)}warn(...t){this.level<=2&&this._log(`${new Date}[ENGINE-DEBUG]: `,...t)}error(...t){this.level<=3&&this._err(`${new Date}[ENGINE-DEBUG]: `,...t)}}function Us(t=[]){if(!t.length)return 0;return t.reduce(((t,e)=>t+e),0)/t.length}function zs(t,e,n){return t.map((t=>{let i=t.x,o=t.x+t.width,s=i,a=o;return i<e?s=e:o>n&&(a=n),l(c({},t),{x:s-e,width:a-s})}))}function Os(t,e,n){return t.filter((t=>{const i=t.x,o=i+t.width;return i>=e&&o<=n||(i<=e&&o>=e||i<=n&&o>=n)}))}function Ns(t){let e=[];return t.tones.forEach((t=>{e.push(Us(t.scores))})),Math.floor(Us(e))}let qs=class t{constructor(){this.lineAreaWidth=375,this.lineAreaHeight=60,this.lyric={},this.totalScore=0,this.cumulativeScore=0,this.pitch=0,this.pitchMin=0,this.pitchMax=0,this.pitchHeight=0,this.reactInfo=[],this.coloringReactInfo=[],this.currentTime=0,this._timer=0,this._pitchIsZeroCount=0,this.lineIndex=0,this.voicePitchChanger=new Ts,this.toneCalculator=new Rs,this.log=new Fs,this.messageHandler=new Bs,this._emitter=ot(),this._combo={[Cs.fair]:0,[Cs.good]:0,[Cs.excellent]:0}}static getInstance(){return t._instance||(t._instance=new t),t._instance}_pitchToY(t){return t<this.pitchMin&&(t=this.pitchMin),t>this.pitchMax&&(t=this.pitchMax),(t-this.pitchMin)/this.pitchHeight*this.lineAreaHeight}_calcReactInfo(){let t=[];for(let e of this.lyric.lines)for(let n of e.tones)t.push({x:n.beginTime*Is+Ss,y:this._pitchToY(n.pitch),width:n.duration*Is,word:n.word});this.reactInfo=t}_addNewColoringReactInfo(t){const{beginTime:e,duration:n}=t,i=e+n;let o=this.currentTime,s=o+.05;s>i&&(s=i);let a={x:o*Is+Ss,y:this._pitchToY(t.pitch),width:(s-o)*Is},r=this.coloringReactInfo[this.coloringReactInfo.length-1];r&&function(t,e){const n=t.x+t.width,i=e.x;return Math.abs(i-n)<4}(r,a)&&function(t,e){const{beginTime:n,duration:i}=e,o=n*Is+Ss,s=o+i*Is,a=t.x,r=t.x+t.width;return a>=o&&r<=s}(r,t)&&(r=this.coloringReactInfo.pop(),a.width=a.x+a.width-r.x,a.x=r.x),this.coloringReactInfo.push(a)}_dealReact(){const t=this.currentTime*Is,e=t+Ss,n=t+this.lineAreaWidth;let i=Os(this.reactInfo,t,n);i=zs(i,t,n);let o=Os(this.coloringReactInfo,t,e);o=zs(o,t,e),this.emit("draw",{filterReactInfo:i,filterColoringReactInfo:o})}_dealLine(){var t;if(!(null==(t=this.lyric)?void 0:t.lines))return;let e=this.lyric.lines.length;for(let n=e-1;n>=0;n--){const t=this.lyric.lines[n],{beginTime:i,duration:o}=t,s=i+o;if(this.currentTime>=s&&n>this.lineIndex){this.lineIndex=n;const i=Ns(t);t.score=i,this.cumulativeScore+=i,this.emit("lineEnd",{line:this.lineIndex,score:i}),this.lineIndex==e-1&&(this.cumulativeScore=0);break}}}_dealTime(){var t,e,n;if(this.currentTime){let i=0;this.lineIndex>=0&&(i=(null==(t=this.lyric)?void 0:t.lines)&&(null==(n=null==(e=this.lyric)?void 0:e.lines[this.lineIndex])?void 0:n.score)||0),this._emitter.emit("timeUpdate",{progress:this.currentTime,lineIndex:this.lineIndex,cumulativeScore:this.cumulativeScore,score:i})}}setTime(t){this.currentTime=t,this._dealTime(),this._dealReact(),this._dealLine()}async setLyric(t){this.reset();const{song:e={}}=t,{general:n={},midi_lrc:i={}}=e,{name:o,singer:s,type:a}=n,{paragraph:r={}}=i,{sentence:c}=r,l=c[0],d=c[c.length-1],m=l.tone[0],h=d.tone[d.tone.length-1];this.lyric.name=o,this.lyric.singer=s,this.lyric.type=a,this.lyric.lines=i,this.lyric.preludeEndPosition=Number(m.begin),this.lyric.duration=Number(h.end);const u=c.map((({tone:t})=>{let e="",n=[];Array.isArray(t)||(t=[t]);for(let s of t)e+=s.word,n.push({beginTime:Number(s.begin),duration:Number(s.end)-Number(s.begin),word:s.word,pitch:Number(s.pitch),lang:s.lang,pronounce:s.pronounce,scores:[]});const i=t[0],o=t[t.length-1];return{beginTime:Number(i.begin),duration:Number(o.end)-Number(i.begin),content:e,tones:n,score:0}}));this.lyric.lines=u,this.lyric.hasPitch=function(t){if(!Array.isArray(t))return!1;for(let e of t)for(let t of e.tones)if(t.pitch)return!0;return!1}(u),this.totalScore=function(t){return 100*t.length}(u);const{min:p,max:g}=function(t){let e=Number.MAX_VALUE,n=Number.MIN_VALUE;for(let i of t)for(let t of i.tones)t.pitch<e&&(e=t.pitch),t.pitch>n&&(n=t.pitch);return{min:e,max:n}}(u);return this.pitchMin=p,this.pitchMax=g,this.pitchHeight=g-p,this._calcReactInfo(),this.log.debug("lyric",this.lyric),this.log.debug("reactInfo",this.reactInfo),this.lyric}setPitch(t){var e;if(!(null==(e=this.lyric)?void 0:e.lines))return;if(!this.lyric.hasPitch)return!1;if(!this.reactInfo.length)return;if(this.pitch=t,0==t?this._pitchIsZeroCount++:this._pitchIsZeroCount=0,!(t>0||this._pitchIsZeroCount>10))return this.emitCursor(t),void this.emit("cursorTailAnim",!1);this._pitchIsZeroCount=0;const n=function(t,e){let n=null;for(let i of t.lines){for(let t of i.tones){const i=t.beginTime,o=i+t.duration;if(i<=e&&o>=e){n=t;break}}if(n)break}return n}(this.lyric,this.currentTime);if(!n)return void this.emitCursor(t);this.log.debug("hit",n);const i=n.pitch,o=this.voicePitchChanger.handlePitch(i,t,this.pitchMax),s=this.toneCalculator.calcScore(o,i,10,0);this.emit("hit",{word:n.word,stdPitch:i,voicePitch:o,originalPitch:t}),n.scores.push(s),s>=70?(this.emitCursor(n.pitch-16),this._addNewColoringReactInfo(n),this.emit("cursorTailAnim",!0)):(this.emitCursor(o),this.emit("cursorTailAnim",!1))}emitCursor(t){const e=this._pitchToY(t);this.emit("cursor",{x:Ss,y:e})}reset(){this.voicePitchChanger.reset(),this._timer=0,this._pitchIsZeroCount=0,this.lineIndex=0,this.coloringReactInfo=[],this.currentTime=0,this.cumulativeScore=0,this.totalScore=0,this.pitch=0,this.pitchMin=0,this.pitchMax=0,this.pitchHeight=0,this.lyric={}}destory(){this._emitter.all.clear()}on(t,e){this._emitter.on(t,e)}off(t,e){this._emitter.off(t,e)}emit(t,e){this._emitter.emit(t,e)}};const Gs=22089888e5,Vs=200,Hs=0,Ws=3,Ks=4,Ys=6,Js=7,Qs=8,Xs=9;var Zs,ta={};function ea(t,e,n,i){return new(n||(n=Promise))((function(o,s){function a(t){try{c(i.next(t))}catch(e){s(e)}}function r(t){try{c(i.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}c((i=i.apply(t,e||[])).next())}))}function na(){try{return!!globalThis.AudioWorklet&&!!globalThis.AudioWorkletNode}catch(t){return!1}}function ia(){try{return!!globalThis.WebAssembly&&!!globalThis.WebAssembly.instantiate}catch(t){return!1}}Zs=()=>(()=>{var t={3536:(t,e,n)=>{var i=n(1910);t.exports=i},8171:(t,e,n)=>{n(6450);var i=n(4058).Object,o=t.exports=function(t,e,n){return i.defineProperty(t,e,n)};i.defineProperty.sham&&(o.sham=!0)},2956:(t,e,n)=>{n(7627),n(6274),n(5967),n(8881),n(4560),n(7206),n(4349),n(7971);var i=n(4058);t.exports=i.Promise},3685:(t,e,n)=>{t.exports=n(621)},621:(t,e,n)=>{var i=n(3536);t.exports=i},4883:(t,e,n)=>{var i=n(7475),o=n(9826),s=TypeError;t.exports=function(t){if(i(t))return t;throw s(o(t)+" is not a function")}},174:(t,e,n)=>{var i=n(4284),o=n(9826),s=TypeError;t.exports=function(t){if(i(t))return t;throw s(o(t)+" is not a constructor")}},1851:(t,e,n)=>{var i=n(7475),o=String,s=TypeError;t.exports=function(t){if("object"==typeof t||i(t))return t;throw s("Can't set "+o(t)+" as a prototype")}},8479:t=>{t.exports=function(){}},5743:(t,e,n)=>{var i=n(7046),o=TypeError;t.exports=function(t,e){if(i(e,t))return t;throw o("Incorrect invocation")}},6059:(t,e,n)=>{var i=n(941),o=String,s=TypeError;t.exports=function(t){if(i(t))return t;throw s(o(t)+" is not an object")}},1692:(t,e,n)=>{var i=n(4529),o=n(9413),s=n(623),a=function(t){return function(e,n,a){var r,c=i(e),l=s(c),d=o(a,l);if(t&&n!=n){for(;l>d;)if((r=c[d++])!=r)return!0}else for(;l>d;d++)if((t||d in c)&&c[d]===n)return t||d||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},3765:(t,e,n)=>{var i=n(5329);t.exports=i([].slice)},1385:(t,e,n)=>{var i=n(9813)("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(r){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var s={};s[i]=function(){return{next:function(){return{done:n=!0}}}},t(s)}catch(a){}return n}},2532:(t,e,n)=>{var i=n(4163),o=i({}.toString),s=i("".slice);t.exports=function(t){return s(o(t),8,-1)}},9697:(t,e,n)=>{var i=n(2885),o=n(7475),s=n(2532),a=n(9813)("toStringTag"),r=Object,c="Arguments"==s(function(){return arguments}());t.exports=i?s:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=r(t),a))?n:c?s(e):"Object"==(i=s(e))&&o(e.callee)?"Arguments":i}},3489:(t,e,n)=>{var i=n(953),o=n(1136),s=n(9677),a=n(5988);t.exports=function(t,e,n){for(var r=o(e),c=a.f,l=s.f,d=0;d<r.length;d++){var m=r[d];i(t,m)||n&&i(n,m)||c(t,m,l(e,m))}}},4160:(t,e,n)=>{var i=n(5981);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},3538:t=>{t.exports=function(t,e){return{value:t,done:e}}},2029:(t,e,n)=>{var i=n(5746),o=n(5988),s=n(1887);t.exports=i?function(t,e,n){return o.f(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},1887:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},5929:(t,e,n)=>{var i=n(2029);t.exports=function(t,e,n,o){return o&&o.enumerable?t[e]=n:i(t,e,n),t}},5609:(t,e,n)=>{var i=n(1899),o=Object.defineProperty;t.exports=function(t,e){try{o(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},5746:(t,e,n)=>{var i=n(5981);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},6616:t=>{var e="object"==typeof document&&document.all,n=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},1333:(t,e,n)=>{var i=n(1899),o=n(941),s=i.document,a=o(s)&&o(s.createElement);t.exports=function(t){return a?s.createElement(t):{}}},3281:t=>{t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:(t,e,n)=>{var i=n(8501),o=n(6049);t.exports=!i&&!o&&"object"==typeof window&&"object"==typeof document},8501:t=>{t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},4470:(t,e,n)=>{var i=n(2861),o=n(1899);t.exports=/ipad|iphone|ipod/i.test(i)&&void 0!==o.Pebble},2749:(t,e,n)=>{var i=n(2861);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},6049:(t,e,n)=>{var i=n(2532),o=n(1899);t.exports="process"==i(o.process)},8045:(t,e,n)=>{var i=n(2861);t.exports=/web0s(?!.*chrome)/i.test(i)},2861:(t,e,n)=>{var i=n(626);t.exports=i("navigator","userAgent")||""},3385:(t,e,n)=>{var i,o,s=n(1899),a=n(2861),r=s.process,c=s.Deno,l=r&&r.versions||c&&c.version,d=l&&l.v8;d&&(o=(i=d.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(o=+i[1]),t.exports=o},6759:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3995:(t,e,n)=>{var i=n(5329),o=Error,s=i("".replace),a=String(o("zxcasd").stack),r=/\n\s*at [^:]*:[^\n]*/,c=r.test(a);t.exports=function(t,e){if(c&&"string"==typeof t&&!o.prepareStackTrace)for(;e--;)t=s(t,r,"");return t}},8780:(t,e,n)=>{var i=n(5981),o=n(1887);t.exports=!i((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},6887:(t,e,n)=>{var i=n(1899),o=n(9730),s=n(5329),a=n(7475),r=n(9677).f,c=n(7252),l=n(4058),d=n(6843),m=n(2029),h=n(953),u=function(t){var e=function(n,i,s){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,i)}return new t(n,i,s)}return o(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var n,o,p,g,f,w,v,_,y=t.target,x=t.global,b=t.stat,$=t.proto,k=x?i:b?i[y]:(i[y]||{}).prototype,C=x?l:l[y]||m(l,y,{})[y],I=C.prototype;for(p in e)n=!c(x?p:y+(b?".":"#")+p,t.forced)&&k&&h(k,p),f=C[p],n&&(w=t.dontCallGetSet?(_=r(k,p))&&_.value:k[p]),g=n&&w?w:e[p],n&&typeof f==typeof g||(v=t.bind&&n?d(g,i):t.wrap&&n?u(g):$&&a(g)?s(g):g,(t.sham||g&&g.sham||f&&f.sham)&&m(v,"sham",!0),m(C,p,v),$&&(h(l,o=y+"Prototype")||m(l,o,{}),m(l[o],p,g),t.real&&I&&!I[p]&&m(I,p,g)))}},5981:t=>{t.exports=function(t){try{return!!t()}catch(e){return!0}}},9730:(t,e,n)=>{var i=n(8285),o=Function.prototype,s=o.apply,a=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(s):function(){return a.apply(s,arguments)})},6843:(t,e,n)=>{var i=n(5329),o=n(4883),s=n(8285),a=i(i.bind);t.exports=function(t,e){return o(t),void 0===e?t:s?a(t,e):function(){return t.apply(e,arguments)}}},8285:(t,e,n)=>{var i=n(5981);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},8834:(t,e,n)=>{var i=n(8285),o=Function.prototype.call;t.exports=i?o.bind(o):function(){return o.apply(o,arguments)}},9417:(t,e,n)=>{var i=n(5746),o=n(953),s=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,r=o(s,"name"),c=r&&"something"===function(){}.name,l=r&&(!i||i&&a(s,"name").configurable);t.exports={EXISTS:r,PROPER:c,CONFIGURABLE:l}},4163:(t,e,n)=>{var i=n(8285),o=Function.prototype,s=o.call,a=i&&o.bind.bind(s,s);t.exports=i?a:function(t){return function(){return s.apply(t,arguments)}}},5329:(t,e,n)=>{var i=n(2532),o=n(4163);t.exports=function(t){if("Function"===i(t))return o(t)}},626:(t,e,n)=>{var i=n(4058),o=n(1899),s=n(7475),a=function(t){return s(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(i[t])||a(o[t]):i[t]&&i[t][e]||o[t]&&o[t][e]}},2902:(t,e,n)=>{var i=n(9697),o=n(4229),s=n(2119),a=n(2077),r=n(9813)("iterator");t.exports=function(t){if(!s(t))return o(t,r)||o(t,"@@iterator")||a[i(t)]}},3476:(t,e,n)=>{var i=n(8834),o=n(4883),s=n(6059),a=n(9826),r=n(2902),c=TypeError;t.exports=function(t,e){var n=arguments.length<2?r(t):e;if(o(n))return s(i(n,t));throw c(a(t)+" is not iterable")}},4229:(t,e,n)=>{var i=n(4883),o=n(2119);t.exports=function(t,e){var n=t[e];return o(n)?void 0:i(n)}},1899:(t,e,n)=>{var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},953:(t,e,n)=>{var i=n(5329),o=n(9678),s=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return s(o(t),e)}},7748:t=>{t.exports={}},4845:(t,e,n)=>{var i=n(1899);t.exports=function(t,e){var n=i.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}},5463:(t,e,n)=>{var i=n(626);t.exports=i("document","documentElement")},2840:(t,e,n)=>{var i=n(5746),o=n(5981),s=n(1333);t.exports=!i&&!o((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},7026:(t,e,n)=>{var i=n(5329),o=n(5981),s=n(2532),a=Object,r=i("".split);t.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?r(t,""):a(t)}:a},1302:(t,e,n)=>{var i=n(5329),o=n(7475),s=n(3030),a=i(Function.toString);o(s.inspectSource)||(s.inspectSource=function(t){return a(t)}),t.exports=s.inspectSource},3794:(t,e,n)=>{var i=n(941),o=n(2029);t.exports=function(t,e){i(e)&&"cause"in e&&o(t,"cause",e.cause)}},5402:(t,e,n)=>{var i,o,s,a=n(7093),r=n(1899),c=n(941),l=n(2029),d=n(953),m=n(3030),h=n(4262),u=n(7748),p="Object already initialized",g=r.TypeError,f=r.WeakMap;if(a||m.state){var w=m.state||(m.state=new f);w.get=w.get,w.has=w.has,w.set=w.set,i=function(t,e){if(w.has(t))throw g(p);return e.facade=t,w.set(t,e),e},o=function(t){return w.get(t)||{}},s=function(t){return w.has(t)}}else{var v=h("state");u[v]=!0,i=function(t,e){if(d(t,v))throw g(p);return e.facade=t,l(t,v,e),e},o=function(t){return d(t,v)?t[v]:{}},s=function(t){return d(t,v)}}t.exports={set:i,get:o,has:s,enforce:function(t){return s(t)?o(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return n}}}},6782:(t,e,n)=>{var i=n(9813),o=n(2077),s=i("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[s]===t)}},7475:(t,e,n)=>{var i=n(6616),o=i.all;t.exports=i.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},4284:(t,e,n)=>{var i=n(5329),o=n(5981),s=n(7475),a=n(9697),r=n(626),c=n(1302),l=function(){},d=[],m=r("Reflect","construct"),h=/^\s*(?:class|function)\b/,u=i(h.exec),p=!h.exec(l),g=function(t){if(!s(t))return!1;try{return m(l,d,t),!0}catch(e){return!1}},f=function(t){if(!s(t))return!1;switch(a(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!u(h,c(t))}catch(e){return!0}};f.sham=!0,t.exports=!m||o((function(){var t;return g(g.call)||!g(Object)||!g((function(){t=!0}))||t}))?f:g},7252:(t,e,n)=>{var i=n(5981),o=n(7475),s=/#|\.prototype\./,a=function(t,e){var n=c[r(t)];return n==d||n!=l&&(o(e)?i(e):!!e)},r=a.normalize=function(t){return String(t).replace(s,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a},2119:t=>{t.exports=function(t){return null==t}},941:(t,e,n)=>{var i=n(7475),o=n(6616),s=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:i(t)||t===s}:function(t){return"object"==typeof t?null!==t:i(t)}},2529:t=>{t.exports=!0},6664:(t,e,n)=>{var i=n(626),o=n(7475),s=n(7046),a=n(2302),r=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return o(e)&&s(e.prototype,r(t))}},3091:(t,e,n)=>{var i=n(6843),o=n(8834),s=n(6059),a=n(9826),r=n(6782),c=n(623),l=n(7046),d=n(3476),m=n(2902),h=n(7609),u=TypeError,p=function(t,e){this.stopped=t,this.result=e},g=p.prototype;t.exports=function(t,e,n){var f,w,v,_,y,x,b,$=n&&n.that,k=!(!n||!n.AS_ENTRIES),C=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),S=!(!n||!n.INTERRUPTED),T=i(e,$),R=function(t){return f&&h(f,"normal",t),new p(!0,t)},M=function(t){return k?(s(t),S?T(t[0],t[1],R):T(t[0],t[1])):S?T(t,R):T(t)};if(C)f=t.iterator;else if(I)f=t;else{if(!(w=m(t)))throw u(a(t)+" is not iterable");if(r(w)){for(v=0,_=c(t);_>v;v++)if((y=M(t[v]))&&l(g,y))return y;return new p(!1)}f=d(t,w)}for(x=C?t.next:f.next;!(b=o(x,f)).done;){try{y=M(b.value)}catch(A){h(f,"throw",A)}if("object"==typeof y&&y&&l(g,y))return y}return new p(!1)}},7609:(t,e,n)=>{var i=n(8834),o=n(6059),s=n(4229);t.exports=function(t,e,n){var a,r;o(t);try{if(!(a=s(t,"return"))){if("throw"===e)throw n;return n}a=i(a,t)}catch(c){r=!0,a=c}if("throw"===e)throw n;if(r)throw a;return o(a),n}},3847:(t,e,n)=>{var i=n(5143).IteratorPrototype,o=n(9290),s=n(1887),a=n(904),r=n(2077),c=function(){return this};t.exports=function(t,e,n,l){var d=e+" Iterator";return t.prototype=o(i,{next:s(+!l,n)}),a(t,d,!1,!0),r[d]=c,t}},5105:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(2529),a=n(9417),r=n(7475),c=n(3847),l=n(249),d=n(8929),m=n(904),h=n(2029),u=n(5929),p=n(9813),g=n(2077),f=n(5143),w=a.PROPER,v=a.CONFIGURABLE,_=f.IteratorPrototype,y=f.BUGGY_SAFARI_ITERATORS,x=p("iterator"),b="keys",$="values",k="entries",C=function(){return this};t.exports=function(t,e,n,a,p,f,I){c(n,e,a);var S,T,R,M=function(t){if(t===p&&L)return L;if(!y&&t in j)return j[t];switch(t){case b:case $:case k:return function(){return new n(this,t)}}return function(){return new n(this)}},A=e+" Iterator",P=!1,j=t.prototype,D=j[x]||j["@@iterator"]||p&&j[p],L=!y&&D||M(p),E="Array"==e&&j.entries||D;if(E&&(S=l(E.call(new t)))!==Object.prototype&&S.next&&(s||l(S)===_||(d?d(S,_):r(S[x])||u(S,x,C)),m(S,A,!0,!0),s&&(g[A]=C)),w&&p==$&&D&&D.name!==$&&(!s&&v?h(j,"name",$):(P=!0,L=function(){return o(D,this)})),p)if(T={values:M($),keys:f?L:M(b),entries:M(k)},I)for(R in T)(y||P||!(R in j))&&u(j,R,T[R]);else i({target:e,proto:!0,forced:y||P},T);return s&&!I||j[x]===L||u(j,x,L,{name:p}),g[e]=L,T}},5143:(t,e,n)=>{var i,o,s,a=n(5981),r=n(7475),c=n(941),l=n(9290),d=n(249),m=n(5929),h=n(9813),u=n(2529),p=h("iterator"),g=!1;[].keys&&("next"in(s=[].keys())?(o=d(d(s)))!==Object.prototype&&(i=o):g=!0),!c(i)||a((function(){var t={};return i[p].call(t)!==t}))?i={}:u&&(i=l(i)),r(i[p])||m(i,p,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},2077:t=>{t.exports={}},623:(t,e,n)=>{var i=n(3057);t.exports=function(t){return i(t.length)}},5331:t=>{var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?n:e)(i)}},6132:(t,e,n)=>{var i,o,s,a,r,c,l,d,m=n(1899),h=n(6843),u=n(9677).f,p=n(2941).set,g=n(2749),f=n(4470),w=n(8045),v=n(6049),_=m.MutationObserver||m.WebKitMutationObserver,y=m.document,x=m.process,b=m.Promise,$=u(m,"queueMicrotask"),k=$&&$.value;k||(i=function(){var t,e;for(v&&(t=x.domain)&&t.exit();o;){e=o.fn,o=o.next;try{e()}catch(n){throw o?a():s=void 0,n}}s=void 0,t&&t.enter()},g||v||w||!_||!y?!f&&b&&b.resolve?((l=b.resolve(void 0)).constructor=b,d=h(l.then,l),a=function(){d(i)}):v?a=function(){x.nextTick(i)}:(p=h(p,m),a=function(){p(i)}):(r=!0,c=y.createTextNode(""),new _(i).observe(c,{characterData:!0}),a=function(){c.data=r=!r})),t.exports=k||function(t){var e={fn:t,next:void 0};s&&(s.next=e),o||(o=e,a()),s=e}},9520:(t,e,n)=>{var i=n(4883),o=TypeError,s=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw o("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new s(t)}},4649:(t,e,n)=>{var i=n(5803);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}},9290:(t,e,n)=>{var i,o=n(6059),s=n(9938),a=n(6759),r=n(7748),c=n(5463),l=n(1333),d=n(4262)("IE_PROTO"),m=function(){},h=function(t){return"<script>"+t+"<\/script>"},u=function(t){t.write(h("")),t.close();var e=t.parentWindow.Object;return t=null,e},p=function(){try{i=new ActiveXObject("htmlfile")}catch(o){}var t,e;p="undefined"!=typeof document?document.domain&&i?u(i):((e=l("iframe")).style.display="none",c.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(h("document.F=Object")),t.close(),t.F):u(i);for(var n=a.length;n--;)delete p.prototype[a[n]];return p()};r[d]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(m.prototype=o(t),n=new m,m.prototype=null,n[d]=t):n=p(),void 0===e?n:s.f(n,e)}},9938:(t,e,n)=>{var i=n(5746),o=n(3937),s=n(5988),a=n(6059),r=n(4529),c=n(4771);e.f=i&&!o?Object.defineProperties:function(t,e){a(t);for(var n,i=r(e),o=c(e),l=o.length,d=0;l>d;)s.f(t,n=o[d++],i[n]);return t}},5988:(t,e,n)=>{var i=n(5746),o=n(2840),s=n(3937),a=n(6059),r=n(3894),c=TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;e.f=i?s?function(t,e,n){if(a(t),e=r(e),a(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var i=d(t,e);i&&i.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:i.configurable,enumerable:"enumerable"in n?n.enumerable:i.enumerable,writable:!1})}return l(t,e,n)}:l:function(t,e,n){if(a(t),e=r(e),a(n),o)try{return l(t,e,n)}catch(i){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},9677:(t,e,n)=>{var i=n(5746),o=n(8834),s=n(6760),a=n(1887),r=n(4529),c=n(3894),l=n(953),d=n(2840),m=Object.getOwnPropertyDescriptor;e.f=i?m:function(t,e){if(t=r(t),e=c(e),d)try{return m(t,e)}catch(n){}if(l(t,e))return a(!o(s.f,t,e),t[e])}},946:(t,e,n)=>{var i=n(5629),o=n(6759).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},7857:(t,e)=>{e.f=Object.getOwnPropertySymbols},249:(t,e,n)=>{var i=n(953),o=n(7475),s=n(9678),a=n(4262),r=n(4160),c=a("IE_PROTO"),l=Object,d=l.prototype;t.exports=r?l.getPrototypeOf:function(t){var e=s(t);if(i(e,c))return e[c];var n=e.constructor;return o(n)&&e instanceof n?n.prototype:e instanceof l?d:null}},7046:(t,e,n)=>{var i=n(5329);t.exports=i({}.isPrototypeOf)},5629:(t,e,n)=>{var i=n(5329),o=n(953),s=n(4529),a=n(1692).indexOf,r=n(7748),c=i([].push);t.exports=function(t,e){var n,i=s(t),l=0,d=[];for(n in i)!o(r,n)&&o(i,n)&&c(d,n);for(;e.length>l;)o(i,n=e[l++])&&(~a(d,n)||c(d,n));return d}},4771:(t,e,n)=>{var i=n(5629),o=n(6759);t.exports=Object.keys||function(t){return i(t,o)}},6760:(t,e)=>{var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},8929:(t,e,n)=>{var i=n(5329),o=n(6059),s=n(1851);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(a){}return function(n,i){return o(n),s(i),e?t(n,i):n.__proto__=i,n}}():void 0)},5623:(t,e,n)=>{var i=n(2885),o=n(9697);t.exports=i?{}.toString:function(){return"[object "+o(this)+"]"}},9811:(t,e,n)=>{var i=n(8834),o=n(7475),s=n(941),a=TypeError;t.exports=function(t,e){var n,r;if("string"===e&&o(n=t.toString)&&!s(r=i(n,t)))return r;if(o(n=t.valueOf)&&!s(r=i(n,t)))return r;if("string"!==e&&o(n=t.toString)&&!s(r=i(n,t)))return r;throw a("Can't convert object to primitive value")}},1136:(t,e,n)=>{var i=n(626),o=n(5329),s=n(946),a=n(7857),r=n(6059),c=o([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=s.f(r(t)),n=a.f;return n?c(e,n(t)):e}},4058:t=>{t.exports={}},2:t=>{t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},7742:(t,e,n)=>{var i=n(1899),o=n(6991),s=n(7475),a=n(7252),r=n(1302),c=n(9813),l=n(3321),d=n(8501),m=n(2529),h=n(3385),u=o&&o.prototype,p=c("species"),g=!1,f=s(i.PromiseRejectionEvent),w=a("Promise",(function(){var t=r(o),e=t!==String(o);if(!e&&66===h)return!0;if(m&&(!u.catch||!u.finally))return!0;if(!h||h<51||!/native code/.test(t)){var n=new o((function(t){t(1)})),i=function(t){t((function(){}),(function(){}))};if((n.constructor={})[p]=i,!(g=n.then((function(){}))instanceof i))return!0}return!e&&(l||d)&&!f}));t.exports={CONSTRUCTOR:w,REJECTION_EVENT:f,SUBCLASSING:g}},6991:(t,e,n)=>{var i=n(1899);t.exports=i.Promise},6584:(t,e,n)=>{var i=n(6059),o=n(941),s=n(9520);t.exports=function(t,e){if(i(t),o(e)&&e.constructor===t)return e;var n=s.f(t);return(0,n.resolve)(e),n.promise}},1542:(t,e,n)=>{var i=n(6991),o=n(1385),s=n(7742).CONSTRUCTOR;t.exports=s||!o((function(t){i.all(t).then(void 0,(function(){}))}))},8397:t=>{var e=function(){this.head=null,this.tail=null};e.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=e},8219:(t,e,n)=>{var i=n(2119),o=TypeError;t.exports=function(t){if(i(t))throw o("Can't call method on "+t);return t}},4431:(t,e,n)=>{var i=n(626),o=n(5988),s=n(9813),a=n(5746),r=s("species");t.exports=function(t){var e=i(t),n=o.f;a&&e&&!e[r]&&n(e,r,{configurable:!0,get:function(){return this}})}},904:(t,e,n)=>{var i=n(2885),o=n(5988).f,s=n(2029),a=n(953),r=n(5623),c=n(9813)("toStringTag");t.exports=function(t,e,n,l){if(t){var d=n?t:t.prototype;a(d,c)||o(d,c,{configurable:!0,value:e}),l&&!i&&s(d,"toString",r)}}},4262:(t,e,n)=>{var i=n(8726),o=n(9418),s=i("keys");t.exports=function(t){return s[t]||(s[t]=o(t))}},3030:(t,e,n)=>{var i=n(1899),o=n(5609),s="__core-js_shared__",a=i[s]||o(s,{});t.exports=a},8726:(t,e,n)=>{var i=n(2529),o=n(3030);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.0",mode:i?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(t,e,n)=>{var i=n(6059),o=n(174),s=n(2119),a=n(9813)("species");t.exports=function(t,e){var n,r=i(t).constructor;return void 0===r||s(n=i(r)[a])?e:o(n)}},4620:(t,e,n)=>{var i=n(5329),o=n(2435),s=n(5803),a=n(8219),r=i("".charAt),c=i("".charCodeAt),l=i("".slice),d=function(t){return function(e,n){var i,d,m=s(a(e)),h=o(n),u=m.length;return h<0||h>=u?t?"":void 0:(i=c(m,h))<55296||i>56319||h+1===u||(d=c(m,h+1))<56320||d>57343?t?r(m,h):i:t?l(m,h,h+2):d-56320+(i-55296<<10)+65536}};t.exports={codeAt:d(!1),charAt:d(!0)}},3405:(t,e,n)=>{var i=n(3385),o=n(5981);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},2941:(t,e,n)=>{var i,o,s,a,r=n(1899),c=n(9730),l=n(6843),d=n(7475),m=n(953),h=n(5981),u=n(5463),p=n(3765),g=n(1333),f=n(8348),w=n(2749),v=n(6049),_=r.setImmediate,y=r.clearImmediate,x=r.process,b=r.Dispatch,$=r.Function,k=r.MessageChannel,C=r.String,I=0,S={};try{i=r.location}catch(P){}var T=function(t){if(m(S,t)){var e=S[t];delete S[t],e()}},R=function(t){return function(){T(t)}},M=function(t){T(t.data)},A=function(t){r.postMessage(C(t),i.protocol+"//"+i.host)};_&&y||(_=function(t){f(arguments.length,1);var e=d(t)?t:$(t),n=p(arguments,1);return S[++I]=function(){c(e,void 0,n)},o(I),I},y=function(t){delete S[t]},v?o=function(t){x.nextTick(R(t))}:b&&b.now?o=function(t){b.now(R(t))}:k&&!w?(a=(s=new k).port2,s.port1.onmessage=M,o=l(a.postMessage,a)):r.addEventListener&&d(r.postMessage)&&!r.importScripts&&i&&"file:"!==i.protocol&&!h(A)?(o=A,r.addEventListener("message",M,!1)):o="onreadystatechange"in g("script")?function(t){u.appendChild(g("script")).onreadystatechange=function(){u.removeChild(this),T(t)}}:function(t){setTimeout(R(t),0)}),t.exports={set:_,clear:y}},9413:(t,e,n)=>{var i=n(2435),o=Math.max,s=Math.min;t.exports=function(t,e){var n=i(t);return n<0?o(n+e,0):s(n,e)}},4529:(t,e,n)=>{var i=n(7026),o=n(8219);t.exports=function(t){return i(o(t))}},2435:(t,e,n)=>{var i=n(5331);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},3057:(t,e,n)=>{var i=n(2435),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},9678:(t,e,n)=>{var i=n(8219),o=Object;t.exports=function(t){return o(i(t))}},6935:(t,e,n)=>{var i=n(8834),o=n(941),s=n(6664),a=n(4229),r=n(9811),c=n(9813),l=TypeError,d=c("toPrimitive");t.exports=function(t,e){if(!o(t)||s(t))return t;var n,c=a(t,d);if(c){if(void 0===e&&(e="default"),n=i(c,t,e),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===e&&(e="number"),r(t,e)}},3894:(t,e,n)=>{var i=n(6935),o=n(6664);t.exports=function(t){var e=i(t,"string");return o(e)?e:e+""}},2885:(t,e,n)=>{var i={};i[n(9813)("toStringTag")]="z",t.exports="[object z]"===String(i)},5803:(t,e,n)=>{var i=n(9697),o=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},9826:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},9418:(t,e,n)=>{var i=n(5329),o=0,s=Math.random(),a=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++o+s,36)}},2302:(t,e,n)=>{var i=n(3405);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3937:(t,e,n)=>{var i=n(5746),o=n(5981);t.exports=i&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8348:t=>{var e=TypeError;t.exports=function(t,n){if(t<n)throw e("Not enough arguments");return t}},7093:(t,e,n)=>{var i=n(1899),o=n(7475),s=i.WeakMap;t.exports=o(s)&&/native code/.test(String(s))},9813:(t,e,n)=>{var i=n(1899),o=n(8726),s=n(953),a=n(9418),r=n(3405),c=n(2302),l=o("wks"),d=i.Symbol,m=d&&d.for,h=c?d:d&&d.withoutSetter||a;t.exports=function(t){if(!s(l,t)||!r&&"string"!=typeof l[t]){var e="Symbol."+t;r&&s(d,t)?l[t]=d[t]:l[t]=c&&m?m(e):h(e)}return l[t]}},9812:(t,e,n)=>{var i=n(6887),o=n(7046),s=n(249),a=n(8929),r=n(3489),c=n(9290),l=n(2029),d=n(1887),m=n(3995),h=n(3794),u=n(3091),p=n(4649),g=n(9813),f=n(8780),w=g("toStringTag"),v=Error,_=[].push,y=function(t,e){var n,i=arguments.length>2?arguments[2]:void 0,r=o(x,this);a?n=a(v(),r?s(this):x):(n=r?this:c(x),l(n,w,"Error")),void 0!==e&&l(n,"message",p(e)),f&&l(n,"stack",m(n.stack,1)),h(n,i);var d=[];return u(t,_,{that:d}),l(n,"errors",d),n};a?a(y,v):r(y,v,{name:!0});var x=y.prototype=c(v.prototype,{constructor:d(1,y),message:d(1,""),name:d(1,"AggregateError")});i({global:!0,constructor:!0,arity:2},{AggregateError:y})},7627:(t,e,n)=>{n(9812)},6274:(t,e,n)=>{var i=n(4529),o=n(8479),s=n(2077),a=n(5402),r=n(5988).f,c=n(5105),l=n(3538),d=n(2529),m=n(5746),h="Array Iterator",u=a.set,p=a.getterFor(h);t.exports=c(Array,"Array",(function(t,e){u(this,{type:h,target:i(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,l(void 0,!0)):l("keys"==n?i:"values"==n?e[i]:[i,e[i]],!1)}),"values");var g=s.Arguments=s.Array;if(o("keys"),o("values"),o("entries"),!d&&m&&"values"!==g.name)try{r(g,"name",{value:"values"})}catch(f){}},6450:(t,e,n)=>{var i=n(6887),o=n(5746),s=n(5988).f;i({target:"Object",stat:!0,forced:Object.defineProperty!==s,sham:!o},{defineProperty:s})},5967:()=>{},4560:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(4883),a=n(9520),r=n(2),c=n(3091);i({target:"Promise",stat:!0},{allSettled:function(t){var e=this,n=a.f(e),i=n.resolve,l=n.reject,d=r((function(){var n=s(e.resolve),a=[],r=0,l=1;c(t,(function(t){var s=r++,c=!1;l++,o(n,e,t).then((function(t){c||(c=!0,a[s]={status:"fulfilled",value:t},--l||i(a))}),(function(t){c||(c=!0,a[s]={status:"rejected",reason:t},--l||i(a))}))})),--l||i(a)}));return d.error&&l(d.value),n.promise}})},6890:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(4883),a=n(9520),r=n(2),c=n(3091);i({target:"Promise",stat:!0,forced:n(1542)},{all:function(t){var e=this,n=a.f(e),i=n.resolve,l=n.reject,d=r((function(){var n=s(e.resolve),a=[],r=0,d=1;c(t,(function(t){var s=r++,c=!1;d++,o(n,e,t).then((function(t){c||(c=!0,a[s]=t,--d||i(a))}),l)})),--d||i(a)}));return d.error&&l(d.value),n.promise}})},7206:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(4883),a=n(626),r=n(9520),c=n(2),l=n(3091),d="No one promise resolved";i({target:"Promise",stat:!0},{any:function(t){var e=this,n=a("AggregateError"),i=r.f(e),m=i.resolve,h=i.reject,u=c((function(){var i=s(e.resolve),a=[],r=0,c=1,u=!1;l(t,(function(t){var s=r++,l=!1;c++,o(i,e,t).then((function(t){l||u||(u=!0,m(t))}),(function(t){l||u||(l=!0,a[s]=t,--c||h(new n(a,d)))}))})),--c||h(new n(a,d))}));return u.error&&h(u.value),i.promise}})},3376:(t,e,n)=>{var i=n(6887),o=n(2529),s=n(7742).CONSTRUCTOR,a=n(6991),r=n(626),c=n(7475),l=n(5929),d=a&&a.prototype;if(i({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&c(a)){var m=r("Promise").prototype.catch;d.catch!==m&&l(d,"catch",m,{unsafe:!0})}},6934:(t,e,n)=>{var i,o,s,a=n(6887),r=n(2529),c=n(6049),l=n(1899),d=n(8834),m=n(5929),h=n(8929),u=n(904),p=n(4431),g=n(4883),f=n(7475),w=n(941),v=n(5743),_=n(487),y=n(2941).set,x=n(6132),b=n(4845),$=n(2),k=n(8397),C=n(5402),I=n(6991),S=n(7742),T=n(9520),R="Promise",M=S.CONSTRUCTOR,A=S.REJECTION_EVENT,P=S.SUBCLASSING,j=C.getterFor(R),D=C.set,L=I&&I.prototype,E=I,B=L,F=l.TypeError,U=l.document,z=l.process,O=T.f,N=O,q=!!(U&&U.createEvent&&l.dispatchEvent),G="unhandledrejection",V=function(t){var e;return!(!w(t)||!f(e=t.then))&&e},H=function(t,e){var n,i,o,s=e.value,a=1==e.state,r=a?t.ok:t.fail,c=t.resolve,l=t.reject,m=t.domain;try{r?(a||(2===e.rejection&&Q(e),e.rejection=1),!0===r?n=s:(m&&m.enter(),n=r(s),m&&(m.exit(),o=!0)),n===t.promise?l(F("Promise-chain cycle")):(i=V(n))?d(i,n,c,l):c(n)):l(s)}catch(h){m&&!o&&m.exit(),l(h)}},W=function(t,e){t.notified||(t.notified=!0,x((function(){for(var n,i=t.reactions;n=i.get();)H(n,t);t.notified=!1,e&&!t.rejection&&Y(t)})))},K=function(t,e,n){var i,o;q?((i=U.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),l.dispatchEvent(i)):i={promise:e,reason:n},!A&&(o=l["on"+t])?o(i):t===G&&b("Unhandled promise rejection",n)},Y=function(t){d(y,l,(function(){var e,n=t.facade,i=t.value;if(J(t)&&(e=$((function(){c?z.emit("unhandledRejection",i,n):K(G,n,i)})),t.rejection=c||J(t)?2:1,e.error))throw e.value}))},J=function(t){return 1!==t.rejection&&!t.parent},Q=function(t){d(y,l,(function(){var e=t.facade;c?z.emit("rejectionHandled",e):K("rejectionhandled",e,t.value)}))},X=function(t,e,n){return function(i){t(e,i,n)}},Z=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,W(t,!0))},tt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw F("Promise can't be resolved itself");var i=V(e);i?x((function(){var n={done:!1};try{d(i,e,X(tt,n,t),X(Z,n,t))}catch(o){Z(n,o,t)}})):(t.value=e,t.state=1,W(t,!1))}catch(o){Z({done:!1},o,t)}}};if(M&&(B=(E=function(t){v(this,B),g(t),d(i,this);var e=j(this);try{t(X(tt,e),X(Z,e))}catch(n){Z(e,n)}}).prototype,(i=function(t){D(this,{type:R,done:!1,notified:!1,parent:!1,reactions:new k,rejection:!1,state:0,value:void 0})}).prototype=m(B,"then",(function(t,e){var n=j(this),i=O(_(this,E));return n.parent=!0,i.ok=!f(t)||t,i.fail=f(e)&&e,i.domain=c?z.domain:void 0,0==n.state?n.reactions.add(i):x((function(){H(i,n)})),i.promise})),o=function(){var t=new i,e=j(t);this.promise=t,this.resolve=X(tt,e),this.reject=X(Z,e)},T.f=O=function(t){return t===E||void 0===t?new o(t):N(t)},!r&&f(I)&&L!==Object.prototype)){s=L.then,P||m(L,"then",(function(t,e){var n=this;return new E((function(t,e){d(s,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete L.constructor}catch(et){}h&&h(L,B)}a({global:!0,constructor:!0,wrap:!0,forced:M},{Promise:E}),u(E,R,!1,!0),p(R)},4349:(t,e,n)=>{var i=n(6887),o=n(2529),s=n(6991),a=n(5981),r=n(626),c=n(7475),l=n(487),d=n(6584),m=n(5929),h=s&&s.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!s&&a((function(){h.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=l(this,r("Promise")),n=c(t);return this.then(n?function(n){return d(e,t()).then((function(){return n}))}:t,n?function(n){return d(e,t()).then((function(){throw n}))}:t)}}),!o&&c(s)){var u=r("Promise").prototype.finally;h.finally!==u&&m(h,"finally",u,{unsafe:!0})}},8881:(t,e,n)=>{n(6934),n(6890),n(3376),n(5921),n(4069),n(4482)},5921:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(4883),a=n(9520),r=n(2),c=n(3091);i({target:"Promise",stat:!0,forced:n(1542)},{race:function(t){var e=this,n=a.f(e),i=n.reject,l=r((function(){var a=s(e.resolve);c(t,(function(t){o(a,e,t).then(n.resolve,i)}))}));return l.error&&i(l.value),n.promise}})},4069:(t,e,n)=>{var i=n(6887),o=n(8834),s=n(9520);i({target:"Promise",stat:!0,forced:n(7742).CONSTRUCTOR},{reject:function(t){var e=s.f(this);return o(e.reject,void 0,t),e.promise}})},4482:(t,e,n)=>{var i=n(6887),o=n(626),s=n(2529),a=n(6991),r=n(7742).CONSTRUCTOR,c=n(6584),l=o("Promise"),d=s&&!r;i({target:"Promise",stat:!0,forced:s||r},{resolve:function(t){return c(d&&this===l?a:this,t)}})},7971:(t,e,n)=>{var i=n(4620).charAt,o=n(5803),s=n(5402),a=n(5105),r=n(3538),c="String Iterator",l=s.set,d=s.getterFor(c);a(String,"String",(function(t){l(this,{type:c,string:o(t),index:0})}),(function(){var t,e=d(this),n=e.string,o=e.index;return o>=n.length?r(void 0,!0):(t=i(n,o),e.index+=t.length,r(t,!1))}))},7634:(t,e,n)=>{n(6274);var i=n(3281),o=n(1899),s=n(9697),a=n(2029),r=n(2077),c=n(9813)("toStringTag");for(var l in i){var d=o[l],m=d&&d.prototype;m&&s(m)!==c&&a(m,c,l),r[l]=r.Array}},1910:(t,e,n)=>{var i=n(8171);t.exports=i},7460:(t,e,n)=>{var i=n(2956);n(7634),t.exports=i},9662:(t,e,n)=>{var i=n(614),o=n(6330),s=TypeError;t.exports=function(t){if(i(t))return t;throw s(o(t)+" is not a function")}},6077:(t,e,n)=>{var i=n(614),o=String,s=TypeError;t.exports=function(t){if("object"==typeof t||i(t))return t;throw s("Can't set "+o(t)+" as a prototype")}},1223:(t,e,n)=>{var i=n(5112),o=n(30),s=n(3070).f,a=i("unscopables"),r=Array.prototype;null==r[a]&&s(r,a,{configurable:!0,value:o(null)}),t.exports=function(t){r[a][t]=!0}},9670:(t,e,n)=>{var i=n(111),o=String,s=TypeError;t.exports=function(t){if(i(t))return t;throw s(o(t)+" is not an object")}},1318:(t,e,n)=>{var i=n(5656),o=n(1400),s=n(6244),a=function(t){return function(e,n,a){var r,c=i(e),l=s(c),d=o(a,l);if(t&&n!=n){for(;l>d;)if((r=c[d++])!=r)return!0}else for(;l>d;d++)if((t||d in c)&&c[d]===n)return t||d||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},4326:(t,e,n)=>{var i=n(84),o=i({}.toString),s=i("".slice);t.exports=function(t){return s(o(t),8,-1)}},648:(t,e,n)=>{var i=n(1694),o=n(614),s=n(4326),a=n(5112)("toStringTag"),r=Object,c="Arguments"==s(function(){return arguments}());t.exports=i?s:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=r(t),a))?n:c?s(e):"Object"==(i=s(e))&&o(e.callee)?"Arguments":i}},9920:(t,e,n)=>{var i=n(2597),o=n(3887),s=n(1236),a=n(3070);t.exports=function(t,e,n){for(var r=o(e),c=a.f,l=s.f,d=0;d<r.length;d++){var m=r[d];i(t,m)||n&&i(n,m)||c(t,m,l(e,m))}}},8544:(t,e,n)=>{var i=n(7293);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},6178:t=>{t.exports=function(t,e){return{value:t,done:e}}},8880:(t,e,n)=>{var i=n(9781),o=n(3070),s=n(9114);t.exports=i?function(t,e,n){return o.f(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},9114:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},8052:(t,e,n)=>{var i=n(614),o=n(3070),s=n(6339),a=n(3072);t.exports=function(t,e,n,r){r||(r={});var c=r.enumerable,l=void 0!==r.name?r.name:e;if(i(n)&&s(n,l,r),r.global)c?t[e]=n:a(e,n);else{try{r.unsafe?t[e]&&(c=!0):delete t[e]}catch(d){}c?t[e]=n:o.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t}},3072:(t,e,n)=>{var i=n(7854),o=Object.defineProperty;t.exports=function(t,e){try{o(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e}},9781:(t,e,n)=>{var i=n(7293);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:t=>{var e="object"==typeof document&&document.all,n=void 0===e&&void 0!==e;t.exports={all:e,IS_HTMLDDA:n}},317:(t,e,n)=>{var i=n(7854),o=n(111),s=i.document,a=o(s)&&o(s.createElement);t.exports=function(t){return a?s.createElement(t):{}}},8324:t=>{t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(t,e,n)=>{var i=n(317)("span").classList,o=i&&i.constructor&&i.constructor.prototype;t.exports=o===Object.prototype?void 0:o},8113:(t,e,n)=>{var i=n(5005);t.exports=i("navigator","userAgent")||""},7392:(t,e,n)=>{var i,o,s=n(7854),a=n(8113),r=s.process,c=s.Deno,l=r&&r.versions||c&&c.version,d=l&&l.v8;d&&(o=(i=d.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(o=+i[1]),t.exports=o},748:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1060:(t,e,n)=>{var i=n(1702),o=Error,s=i("".replace),a=String(o("zxcasd").stack),r=/\n\s*at [^:]*:[^\n]*/,c=r.test(a);t.exports=function(t,e){if(c&&"string"==typeof t&&!o.prepareStackTrace)for(;e--;)t=s(t,r,"");return t}},2914:(t,e,n)=>{var i=n(7293),o=n(9114);t.exports=!i((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},2109:(t,e,n)=>{var i=n(7854),o=n(1236).f,s=n(8880),a=n(8052),r=n(3072),c=n(9920),l=n(4705);t.exports=function(t,e){var n,d,m,h,u,p=t.target,g=t.global,f=t.stat;if(n=g?i:f?i[p]||r(p,{}):(i[p]||{}).prototype)for(d in e){if(h=e[d],m=t.dontCallGetSet?(u=o(n,d))&&u.value:n[d],!l(g?d:p+(f?".":"#")+d,t.forced)&&void 0!==m){if(typeof h==typeof m)continue;c(h,m)}(t.sham||m&&m.sham)&&s(h,"sham",!0),a(n,d,h,t)}}},7293:t=>{t.exports=function(t){try{return!!t()}catch(e){return!0}}},2104:(t,e,n)=>{var i=n(4374),o=Function.prototype,s=o.apply,a=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?a.bind(s):function(){return a.apply(s,arguments)})},4374:(t,e,n)=>{var i=n(7293);t.exports=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:(t,e,n)=>{var i=n(4374),o=Function.prototype.call;t.exports=i?o.bind(o):function(){return o.apply(o,arguments)}},6530:(t,e,n)=>{var i=n(9781),o=n(2597),s=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,r=o(s,"name"),c=r&&"something"===function(){}.name,l=r&&(!i||i&&a(s,"name").configurable);t.exports={EXISTS:r,PROPER:c,CONFIGURABLE:l}},84:(t,e,n)=>{var i=n(4374),o=Function.prototype,s=o.call,a=i&&o.bind.bind(s,s);t.exports=i?a:function(t){return function(){return s.apply(t,arguments)}}},1702:(t,e,n)=>{var i=n(4326),o=n(84);t.exports=function(t){if("Function"===i(t))return o(t)}},5005:(t,e,n)=>{var i=n(7854),o=n(614);t.exports=function(t,e){return arguments.length<2?(n=i[t],o(n)?n:void 0):i[t]&&i[t][e];var n}},8173:(t,e,n)=>{var i=n(9662),o=n(8554);t.exports=function(t,e){var n=t[e];return o(n)?void 0:i(n)}},7854:(t,e,n)=>{var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:(t,e,n)=>{var i=n(1702),o=n(7908),s=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return s(o(t),e)}},3501:t=>{t.exports={}},490:(t,e,n)=>{var i=n(5005);t.exports=i("document","documentElement")},4664:(t,e,n)=>{var i=n(9781),o=n(7293),s=n(317);t.exports=!i&&!o((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},8361:(t,e,n)=>{var i=n(1702),o=n(7293),s=n(4326),a=Object,r=i("".split);t.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?r(t,""):a(t)}:a},9587:(t,e,n)=>{var i=n(614),o=n(111),s=n(7674);t.exports=function(t,e,n){var a,r;return s&&i(a=e.constructor)&&a!==n&&o(r=a.prototype)&&r!==n.prototype&&s(t,r),t}},2788:(t,e,n)=>{var i=n(1702),o=n(614),s=n(5465),a=i(Function.toString);o(s.inspectSource)||(s.inspectSource=function(t){return a(t)}),t.exports=s.inspectSource},8340:(t,e,n)=>{var i=n(111),o=n(8880);t.exports=function(t,e){i(e)&&"cause"in e&&o(t,"cause",e.cause)}},9909:(t,e,n)=>{var i,o,s,a=n(4811),r=n(7854),c=n(111),l=n(8880),d=n(2597),m=n(5465),h=n(6200),u=n(3501),p="Object already initialized",g=r.TypeError,f=r.WeakMap;if(a||m.state){var w=m.state||(m.state=new f);w.get=w.get,w.has=w.has,w.set=w.set,i=function(t,e){if(w.has(t))throw g(p);return e.facade=t,w.set(t,e),e},o=function(t){return w.get(t)||{}},s=function(t){return w.has(t)}}else{var v=h("state");u[v]=!0,i=function(t,e){if(d(t,v))throw g(p);return e.facade=t,l(t,v,e),e},o=function(t){return d(t,v)?t[v]:{}},s=function(t){return d(t,v)}}t.exports={set:i,get:o,has:s,enforce:function(t){return s(t)?o(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return n}}}},614:(t,e,n)=>{var i=n(4154),o=i.all;t.exports=i.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},4705:(t,e,n)=>{var i=n(7293),o=n(614),s=/#|\.prototype\./,a=function(t,e){var n=c[r(t)];return n==d||n!=l&&(o(e)?i(e):!!e)},r=a.normalize=function(t){return String(t).replace(s,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a},8554:t=>{t.exports=function(t){return null==t}},111:(t,e,n)=>{var i=n(614),o=n(4154),s=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:i(t)||t===s}:function(t){return"object"==typeof t?null!==t:i(t)}},1913:t=>{t.exports=!1},2190:(t,e,n)=>{var i=n(5005),o=n(614),s=n(7976),a=n(3307),r=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return o(e)&&s(e.prototype,r(t))}},3061:(t,e,n)=>{var i=n(3383).IteratorPrototype,o=n(30),s=n(9114),a=n(8003),r=n(7497),c=function(){return this};t.exports=function(t,e,n,l){var d=e+" Iterator";return t.prototype=o(i,{next:s(+!l,n)}),a(t,d,!1,!0),r[d]=c,t}},1656:(t,e,n)=>{var i=n(2109),o=n(6916),s=n(1913),a=n(6530),r=n(614),c=n(3061),l=n(9518),d=n(7674),m=n(8003),h=n(8880),u=n(8052),p=n(5112),g=n(7497),f=n(3383),w=a.PROPER,v=a.CONFIGURABLE,_=f.IteratorPrototype,y=f.BUGGY_SAFARI_ITERATORS,x=p("iterator"),b="keys",$="values",k="entries",C=function(){return this};t.exports=function(t,e,n,a,p,f,I){c(n,e,a);var S,T,R,M=function(t){if(t===p&&L)return L;if(!y&&t in j)return j[t];switch(t){case b:case $:case k:return function(){return new n(this,t)}}return function(){return new n(this)}},A=e+" Iterator",P=!1,j=t.prototype,D=j[x]||j["@@iterator"]||p&&j[p],L=!y&&D||M(p),E="Array"==e&&j.entries||D;if(E&&(S=l(E.call(new t)))!==Object.prototype&&S.next&&(s||l(S)===_||(d?d(S,_):r(S[x])||u(S,x,C)),m(S,A,!0,!0),s&&(g[A]=C)),w&&p==$&&D&&D.name!==$&&(!s&&v?h(j,"name",$):(P=!0,L=function(){return o(D,this)})),p)if(T={values:M($),keys:f?L:M(b),entries:M(k)},I)for(R in T)(y||P||!(R in j))&&u(j,R,T[R]);else i({target:e,proto:!0,forced:y||P},T);return s&&!I||j[x]===L||u(j,x,L,{name:p}),g[e]=L,T}},3383:(t,e,n)=>{var i,o,s,a=n(7293),r=n(614),c=n(111),l=n(30),d=n(9518),m=n(8052),h=n(5112),u=n(1913),p=h("iterator"),g=!1;[].keys&&("next"in(s=[].keys())?(o=d(d(s)))!==Object.prototype&&(i=o):g=!0),!c(i)||a((function(){var t={};return i[p].call(t)!==t}))?i={}:u&&(i=l(i)),r(i[p])||m(i,p,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},7497:t=>{t.exports={}},6244:(t,e,n)=>{var i=n(7466);t.exports=function(t){return i(t.length)}},6339:(t,e,n)=>{var i=n(7293),o=n(614),s=n(2597),a=n(9781),r=n(6530).CONFIGURABLE,c=n(2788),l=n(9909),d=l.enforce,m=l.get,h=Object.defineProperty,u=a&&!i((function(){return 8!==h((function(){}),"length",{value:8}).length})),p=String(String).split("String"),g=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||r&&t.name!==e)&&(a?h(t,"name",{value:e,configurable:!0}):t.name=e),u&&n&&s(n,"arity")&&t.length!==n.arity&&h(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&h(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(o){}var i=d(t);return s(i,"source")||(i.source=p.join("string"==typeof e?e:"")),t};Function.prototype.toString=g((function(){return o(this)&&m(this).source||c(this)}),"toString")},4758:t=>{var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?n:e)(i)}},6277:(t,e,n)=>{var i=n(1340);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}},30:(t,e,n)=>{var i,o=n(9670),s=n(6048),a=n(748),r=n(3501),c=n(490),l=n(317),d=n(6200)("IE_PROTO"),m=function(){},h=function(t){return"<script>"+t+"<\/script>"},u=function(t){t.write(h("")),t.close();var e=t.parentWindow.Object;return t=null,e},p=function(){try{i=new ActiveXObject("htmlfile")}catch(o){}var t,e;p="undefined"!=typeof document?document.domain&&i?u(i):((e=l("iframe")).style.display="none",c.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(h("document.F=Object")),t.close(),t.F):u(i);for(var n=a.length;n--;)delete p.prototype[a[n]];return p()};r[d]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(m.prototype=o(t),n=new m,m.prototype=null,n[d]=t):n=p(),void 0===e?n:s.f(n,e)}},6048:(t,e,n)=>{var i=n(9781),o=n(3353),s=n(3070),a=n(9670),r=n(5656),c=n(1956);e.f=i&&!o?Object.defineProperties:function(t,e){a(t);for(var n,i=r(e),o=c(e),l=o.length,d=0;l>d;)s.f(t,n=o[d++],i[n]);return t}},3070:(t,e,n)=>{var i=n(9781),o=n(4664),s=n(3353),a=n(9670),r=n(4948),c=TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;e.f=i?s?function(t,e,n){if(a(t),e=r(e),a(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var i=d(t,e);i&&i.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:i.configurable,enumerable:"enumerable"in n?n.enumerable:i.enumerable,writable:!1})}return l(t,e,n)}:l:function(t,e,n){if(a(t),e=r(e),a(n),o)try{return l(t,e,n)}catch(i){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},1236:(t,e,n)=>{var i=n(9781),o=n(6916),s=n(5296),a=n(9114),r=n(5656),c=n(4948),l=n(2597),d=n(4664),m=Object.getOwnPropertyDescriptor;e.f=i?m:function(t,e){if(t=r(t),e=c(e),d)try{return m(t,e)}catch(n){}if(l(t,e))return a(!o(s.f,t,e),t[e])}},8006:(t,e,n)=>{var i=n(6324),o=n(748).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},5181:(t,e)=>{e.f=Object.getOwnPropertySymbols},9518:(t,e,n)=>{var i=n(2597),o=n(614),s=n(7908),a=n(6200),r=n(8544),c=a("IE_PROTO"),l=Object,d=l.prototype;t.exports=r?l.getPrototypeOf:function(t){var e=s(t);if(i(e,c))return e[c];var n=e.constructor;return o(n)&&e instanceof n?n.prototype:e instanceof l?d:null}},7976:(t,e,n)=>{var i=n(1702);t.exports=i({}.isPrototypeOf)},6324:(t,e,n)=>{var i=n(1702),o=n(2597),s=n(5656),a=n(1318).indexOf,r=n(3501),c=i([].push);t.exports=function(t,e){var n,i=s(t),l=0,d=[];for(n in i)!o(r,n)&&o(i,n)&&c(d,n);for(;e.length>l;)o(i,n=e[l++])&&(~a(d,n)||c(d,n));return d}},1956:(t,e,n)=>{var i=n(6324),o=n(748);t.exports=Object.keys||function(t){return i(t,o)}},5296:(t,e)=>{var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},7674:(t,e,n)=>{var i=n(1702),o=n(9670),s=n(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(a){}return function(n,i){return o(n),s(i),e?t(n,i):n.__proto__=i,n}}():void 0)},2140:(t,e,n)=>{var i=n(6916),o=n(614),s=n(111),a=TypeError;t.exports=function(t,e){var n,r;if("string"===e&&o(n=t.toString)&&!s(r=i(n,t)))return r;if(o(n=t.valueOf)&&!s(r=i(n,t)))return r;if("string"!==e&&o(n=t.toString)&&!s(r=i(n,t)))return r;throw a("Can't convert object to primitive value")}},3887:(t,e,n)=>{var i=n(5005),o=n(1702),s=n(8006),a=n(5181),r=n(9670),c=o([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=s.f(r(t)),n=a.f;return n?c(e,n(t)):e}},2626:(t,e,n)=>{var i=n(3070).f;t.exports=function(t,e,n){n in t||i(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},4488:(t,e,n)=>{var i=n(8554),o=TypeError;t.exports=function(t){if(i(t))throw o("Can't call method on "+t);return t}},8003:(t,e,n)=>{var i=n(3070).f,o=n(2597),s=n(5112)("toStringTag");t.exports=function(t,e,n){t&&!n&&(t=t.prototype),t&&!o(t,s)&&i(t,s,{configurable:!0,value:e})}},6200:(t,e,n)=>{var i=n(2309),o=n(9711),s=i("keys");t.exports=function(t){return s[t]||(s[t]=o(t))}},5465:(t,e,n)=>{var i=n(7854),o=n(3072),s="__core-js_shared__",a=i[s]||o(s,{});t.exports=a},2309:(t,e,n)=>{var i=n(1913),o=n(5465);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.0",mode:i?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:(t,e,n)=>{var i=n(7392),o=n(7293);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},1400:(t,e,n)=>{var i=n(9303),o=Math.max,s=Math.min;t.exports=function(t,e){var n=i(t);return n<0?o(n+e,0):s(n,e)}},5656:(t,e,n)=>{var i=n(8361),o=n(4488);t.exports=function(t){return i(o(t))}},9303:(t,e,n)=>{var i=n(4758);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},7466:(t,e,n)=>{var i=n(9303),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},7908:(t,e,n)=>{var i=n(4488),o=Object;t.exports=function(t){return o(i(t))}},7593:(t,e,n)=>{var i=n(6916),o=n(111),s=n(2190),a=n(8173),r=n(2140),c=n(5112),l=TypeError,d=c("toPrimitive");t.exports=function(t,e){if(!o(t)||s(t))return t;var n,c=a(t,d);if(c){if(void 0===e&&(e="default"),n=i(c,t,e),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===e&&(e="number"),r(t,e)}},4948:(t,e,n)=>{var i=n(7593),o=n(2190);t.exports=function(t){var e=i(t,"string");return o(e)?e:e+""}},1694:(t,e,n)=>{var i={};i[n(5112)("toStringTag")]="z",t.exports="[object z]"===String(i)},1340:(t,e,n)=>{var i=n(648),o=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},6330:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},9711:(t,e,n)=>{var i=n(1702),o=0,s=Math.random(),a=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++o+s,36)}},3307:(t,e,n)=>{var i=n(6293);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(t,e,n)=>{var i=n(9781),o=n(7293);t.exports=i&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:(t,e,n)=>{var i=n(7854),o=n(614),s=i.WeakMap;t.exports=o(s)&&/native code/.test(String(s))},5112:(t,e,n)=>{var i=n(7854),o=n(2309),s=n(2597),a=n(9711),r=n(6293),c=n(3307),l=o("wks"),d=i.Symbol,m=d&&d.for,h=c?d:d&&d.withoutSetter||a;t.exports=function(t){if(!s(l,t)||!r&&"string"!=typeof l[t]){var e="Symbol."+t;r&&s(d,t)?l[t]=d[t]:l[t]=c&&m?m(e):h(e)}return l[t]}},9191:(t,e,n)=>{var i=n(5005),o=n(2597),s=n(8880),a=n(7976),r=n(7674),c=n(9920),l=n(2626),d=n(9587),m=n(6277),h=n(8340),u=n(1060),p=n(2914),g=n(9781),f=n(1913);t.exports=function(t,e,n,w){var v="stackTraceLimit",_=w?2:1,y=t.split("."),x=y[y.length-1],b=i.apply(null,y);if(b){var $=b.prototype;if(!f&&o($,"cause")&&delete $.cause,!n)return b;var k=i("Error"),C=e((function(t,e){var n=m(w?e:t,void 0),i=w?new b(t):new b;return void 0!==n&&s(i,"message",n),p&&s(i,"stack",u(i.stack,2)),this&&a($,this)&&d(i,this,C),arguments.length>_&&h(i,arguments[_]),i}));if(C.prototype=$,"Error"!==x?r?r(C,k):c(C,k,{name:!0}):g&&v in b&&(l(C,b,v),l(C,b,"prepareStackTrace")),c(C,b),!f)try{$.name!==x&&s($,"name",x),$.constructor=C}catch(I){}return C}}},6992:(t,e,n)=>{var i=n(5656),o=n(1223),s=n(7497),a=n(9909),r=n(3070).f,c=n(1656),l=n(6178),d=n(1913),m=n(9781),h="Array Iterator",u=a.set,p=a.getterFor(h);t.exports=c(Array,"Array",(function(t,e){u(this,{type:h,target:i(t),index:0,kind:e})}),(function(){var t=p(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,l(void 0,!0)):l("keys"==n?i:"values"==n?e[i]:[i,e[i]],!1)}),"values");var g=s.Arguments=s.Array;if(o("keys"),o("values"),o("entries"),!d&&m&&"values"!==g.name)try{r(g,"name",{value:"values"})}catch(f){}},1703:(t,e,n)=>{var i=n(2109),o=n(7854),s=n(2104),a=n(9191),r=o.WebAssembly,c=7!==Error("e",{cause:7}).cause,l=function(t,e){var n={};n[t]=a(t,e,c),i({global:!0,constructor:!0,arity:1,forced:c},n)},d=function(t,e){if(r&&r[t]){var n={};n[t]=a("WebAssembly."+t,e,c),i({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:c},n)}};l("Error",(function(t){return function(e){return s(t,this,arguments)}})),l("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),l("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),l("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),l("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),l("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),l("URIError",(function(t){return function(e){return s(t,this,arguments)}})),d("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),d("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),d("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))},3948:(t,e,n)=>{var i=n(7854),o=n(8324),s=n(8509),a=n(6992),r=n(8880),c=n(5112),l=c("iterator"),d=c("toStringTag"),m=a.values,h=function(t,e){if(t){if(t[l]!==m)try{r(t,l,m)}catch(i){t[l]=m}if(t[d]||r(t,d,e),o[e])for(var n in a)if(t[n]!==a[n])try{r(t,n,a[n])}catch(i){t[n]=a[n]}}};for(var u in o)h(i[u]&&i[u].prototype,u);h(s,"DOMTokenList")},6226:(t,e,n)=>{t.exports=n(7460)},7445:(t,e,n)=>{t.exports=n(3685)}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return(()=>{n.r(i),n.d(i,{AudioExtension:()=>b,AudioProcessor:()=>y,Extension:()=>x,PromiseMutex:()=>I,Ticker:()=>k,VideoProcessor:()=>_,logger:()=>h,reporter:()=>g});var t=n(7445);function e(e,n,i){return n in e?t(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}n(1703),n(6992),n(3948);var o=n(6226),s=n.n(o);class a{constructor(){e(this,"_events",{}),e(this,"addListener",this.on)}getListeners(t){return this._events[t]?this._events[t].map((t=>t.listener)):[]}on(t,e){this._events[t]||(this._events[t]=[]);const n=this._events[t];-1===this._indexOfListener(n,e)&&n.push({listener:e,once:!1})}once(t,e){this._events[t]||(this._events[t]=[]);const n=this._events[t];-1===this._indexOfListener(n,e)&&n.push({listener:e,once:!0})}off(t,e){if(!this._events[t])return;const n=this._events[t],i=this._indexOfListener(n,e);-1!==i&&n.splice(i,1),0===this._events[t].length&&delete this._events[t]}removeAllListeners(t){t?delete this._events[t]:this._events={}}emit(t){this._events[t]||(this._events[t]=[]);const e=this._events[t].map((t=>t));for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(let s=0;s<e.length;s+=1){const n=e[s];n.once&&this.off(t,n.listener),n.listener.apply(this,i||[])}}_indexOfListener(t,e){let n=t.length;for(;n--;)if(t[n].listener===e)return n;return-1}emitAsPromise(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return 0===this.getListeners(t).length?s().reject(new Error("No promise event handler.")):new(s())(((e,i)=>{this.emit(t,...n,e,i)}))}emitAsPromiseNoResponse(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return 0===this.getListeners(t).length?s().resolve():new(s())(((e,i)=>{this.emit(t,...n,e,i)}))}}function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,e=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,t).toLowerCase();return n.length===t?"".concat(e).concat(n):"".concat(e).concat(n)+r(t-n.length,"")}const c=Date.now(),l={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function d(){const t=new Date;return t.toTimeString().split(" ")[0]+":"+t.getMilliseconds()}const m=t=>{for(const e in l)if(Object.prototype.hasOwnProperty.call(l,e)&&l[e]===t)return e;return"DEFAULT"},h=new class{constructor(){e(this,"logLevel",l.DEBUG),e(this,"hookLog",void 0)}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=[l.DEBUG].concat(e);this.log.apply(this,i)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=[l.INFO].concat(e);this.log.apply(this,i)}warning(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=[l.WARNING].concat(e);this.log.apply(this,i)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=[l.ERROR].concat(e);this.log.apply(this,i)}log(){for(var t,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(Date.now()-c<100)return void setTimeout((()=>{this.log(...n)}),Date.now()-c);const o=Math.max(0,Math.min(4,n[0]));if(n[0]=d()+" Agora-Extension [".concat(m(o),"]:"),o<this.logLevel)return;const s=d()+" %cAgora-Extension [".concat(m(o),"]:");let a=[];switch(o){case l.DEBUG:a=[s,"color: #64B5F6;"].concat(n.slice(1)),console.log.apply(console,a);break;case l.INFO:a=[s,"color: #1E88E5; font-weight: bold;"].concat(n.slice(1)),console.log.apply(console,a);break;case l.WARNING:a=[s,"color: #FB8C00; font-weight: bold;"].concat(n.slice(1)),console.warn.apply(console,a);break;case l.ERROR:a=[s,"color: #B00020; font-weight: bold;"].concat(n.slice(1)),console.error.apply(console,a)}null===(t=this.hookLog)||void 0===t||t.call(this,o,a)}};function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function p(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?u(Object(i),!0).forEach((function(n){e(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const g=new class{constructor(){e(this,"apiInvokeMsgQueue",[]),e(this,"hookApiInvoke",void 0)}reportApiInvoke(t){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const e=Date.now(),n=()=>({name:t.name,apiInvokeTime:e,options:t.options});let i=!1;var o;(o=t.timeout,new(s())((t=>{window.setTimeout(t,o)}))).then((()=>{i||(this.sendApiInvoke(p(p({},n()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),h.debug("".concat(t.name," timeout")))}));const a=new Error("".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{if(i)throw a;i=!0,this.sendApiInvoke(p(p({},n()),{},{success:!0},t.reportResult&&{result:e}))},onError:t=>{if(i)throw t;i=!0,this.sendApiInvoke(p(p({},n()),{},{success:!1,error:t.toString()}))}}}sendApiInvoke(t){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,t]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(t)}};function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function w(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?f(Object(i),!0).forEach((function(n){e(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}class v extends a{get enabled(){return this._enabled}output(t,e){if(this.outputTrack===t)return;const n=g.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:null==t?void 0:t.toString()}});this.outputTrack=t,this.destination&&this.destination.updateInput({track:t,context:e}),n.onSuccess()}constructor(){super(),e(this,"inputTrack",void 0),e(this,"outputTrack",void 0),e(this,"_enabled",!0),e(this,"_source",void 0),e(this,"ID",r(6,"")),e(this,"destination",void 0),e(this,"context",void 0),e(this,"name",void 0)}enable(){if(this._enabled)return;const t=g.reportApiInvoke({name:"".concat(this.name,".enable"),options:!0});h.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var e;const n=null===(e=this.onEnableChange)||void 0===e?void 0:e.call(this,this._enabled);if(n instanceof s())return n.then((()=>{t.onSuccess()})).catch((e=>{throw t.onError(e),e}));t.onSuccess()}catch(n){throw t.onError(n),n}}disable(){if(!this._enabled)return;const t=g.reportApiInvoke({name:"".concat(this.name,".enable"),options:!1});h.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var e;const n=null===(e=this.onEnableChange)||void 0===e?void 0:e.call(this,this._enabled);if(n instanceof s())return n.then((()=>{t.onSuccess()})).catch((e=>{throw t.onError(e),e}));t.onSuccess()}catch(n){throw t.onError(n),n}}}class _ extends v{get kind(){return"video"}pipe(t){const e=g.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:t.name}});if(this.destination===t)return e.onSuccess(),t;if(t._source){const n=new Error("Processor ".concat(t.name," already being piped, please call ").concat(t._source.name,".unpipe() beforehand."));throw e.onError(n),n}return this.destination&&this.unpipe(),this.destination=t,t._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),e.onSuccess(),t}unpipe(){if(!this.destination)return;const t=g.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});h.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const t=this.destination;this.destination._source=void 0,this.destination=void 0,t.reset()}finally{t.onSuccess()}}updateInput(t){var e,n;t.context!==this.context&&(this.context=t.context,null===(e=this.onPiped)||void 0===e||e.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:t.context})),t.track&&this.inputTrack!==t.track&&(this.inputTrack=t.track,null===(n=this.onTrack)||void 0===n||n.call(this,t.track,this.context))}reset(){var t;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,null===(t=this.onUnpiped)||void 0===t||t.call(this),this.destination&&this.destination.reset()}}class y extends v{constructor(){super(...arguments),e(this,"inputNode",void 0),e(this,"outputNode",void 0),e(this,"destination",void 0),e(this,"context",void 0)}get kind(){return"audio"}pipe(t){const e=g.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:t.name}});if(this.destination===t)return e.onSuccess(),t;if(t._source){const n=new Error("Processor ".concat(t.name," already being piped, please call ").concat(t._source.name,".unpipe() beforehand."));throw e.onError(n),n}return this.destination&&this.unpipe(),this.destination=t,t._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),e.onSuccess(),t}unpipe(){if(!this.destination)return;h.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const t=g.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var e;let t=this.destination;null===(e=this.outputNode)||void 0===e||e.disconnect(),this.destination._source=void 0,this.destination=void 0,t.reset()}finally{t.onSuccess()}}output(t,e){if(t instanceof MediaStreamTrack)super.output(t,e);else if(t instanceof AudioNode){if(this.outputNode===t)return;const n=g.reportApiInvoke({name:"".concat(this.name,".output"),options:w(w({},t instanceof MediaStreamTrack&&{track:t.toString()}),t instanceof AudioNode&&{audioNode:t.toString()})});this.outputNode=t,this.destination&&this.destination.updateInput({node:t,context:e}),n.onSuccess()}}updateInput(t){var e,n,i;t.context!==this.context&&(this.context=t.context,null===(e=this.onPiped)||void 0===e||e.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:t.context})),t.track&&this.inputTrack!==t.track&&(this.inputTrack=t.track,null===(n=this.onTrack)||void 0===n||n.call(this,t.track,this.context)),t.node&&this.inputNode!==t.node&&(this.inputNode=t.node,null===(i=this.onNode)||void 0===i||i.call(this,t.node,this.context))}reset(){var t;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,null===(t=this.onUnpiped)||void 0===t||t.call(this,this.context),this.context=void 0,this.destination&&this.destination.reset()}}class x{constructor(){e(this,"__registered__",!1),e(this,"logger",h),e(this,"reporter",g),e(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class b extends x{}let $;class k{get running(){return this._running}constructor(t,n){if(e(this,"type",void 0),e(this,"interval",void 0),e(this,"fn",void 0),e(this,"_running",!1),e(this,"_osc",void 0),!t)throw new Error;if(n<=0)throw new Error;this.type=t,this.interval=n}add(t){this.fn=t}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const t=()=>{setTimeout((()=>{this.fn&&this.fn(),this._running&&t()}),this.interval)};t();break}case"RAF":{const t=e=>{requestAnimationFrame((n=>{n-e<this.interval?this._running&&t(e):(this.fn&&this.fn(),this._running&&t(n))}))};t(performance.now());break}case"Oscillator":{$||($=new AudioContext);const t=$.createGain();let e;t.gain.value=0,t.connect($.destination);const n=()=>{this.fn&&this.fn(),e&&e.disconnect(),e=$.createOscillator(),this._osc=e,e.connect(t),this._running&&(e.onended=n,e.start(0),e.stop($.currentTime+this.interval/1e3))};n();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}let C=1;class I{constructor(t){e(this,"lockingPromise",s().resolve()),e(this,"locks",0),e(this,"name",""),e(this,"lockId",void 0),this.lockId=C++,t&&(this.name=t)}get isLocked(){return this.locks>0}lock(t){let e;this.locks+=1;const n=new(s())((t=>{e=()=>{this.locks-=1,t()}})),i=this.lockingPromise.then((()=>e));return this.lockingPromise=this.lockingPromise.then((()=>n)),i}}})(),i})(),{get exports(){return ta},set exports(t){ta=t}}.exports=Zs();class oa extends EventTarget{static create(t,e){return ea(this,void 0,void 0,(function*(){if(!na()||!ia())throw new Error("Does not support AudioWorklet and/or WebAssembly");const n=new Blob(['!function(){"use strict";var t;if(globalThis.isPitchDetectorRegistered=null!==(t=globalThis.isPitchDetectorRegistered)&&void 0!==t&&t,!globalThis.isPitchDetectorRegistered){class t extends AudioWorkletProcessor{constructor(){super(),this.port.onmessage=this.onmessage.bind(this),this.enabled=!0,this.destroyed=!1,this.chunkCount=0,this.intervalInChunk=5,this.voicePitch=[]}process(t,e){if(this.destroyed)return!1;try{if(this.enabled&&this.pitchDetector&&t&&t[0]&&t[0][0]){const e=t[0][0];this.pitchDetector.analyze(e)}}finally{const r=Math.min(t.length,e.length);for(let i=0;i<r;++i){const r=t[i],s=e[i],n=Math.min(r.length,s.length);for(let t=0;t<n;++t)s[t].set(r[t])}}return!0}validate(t){try{return"0.0.0"===t.PitchDetector.getVersion()}catch(t){return!1}}initialize(e){(function(t={}){var e,r=t;r.ready=new Promise((t=>{e=t}));var i,s,n,h,o,a=t=>console.log(t),c=t=>console.error(t);function l(){var t=o.buffer;i=new Int8Array(t),s=new Uint8Array(t),n=new Uint32Array(t),h=new Float32Array(t)}var u=0;function f(t){this.R=t,this.P=t-24,this.aa=function(t){n[this.P+4>>2]=t},this.S=function(){return n[this.P+4>>2]},this.$=function(t){n[this.P+8>>2]=t},this.Z=function(){i[this.P+12>>0]=1},this.W=function(){return 0!=i[this.P+12>>0]},this.U=function(){i[this.P+13>>0]=0},this.Y=function(t,e){this.T(0),this.aa(t),this.$(e)},this.T=function(t){n[this.P+16>>2]=t},this.V=function(){return n[this.P+16>>2]},this.X=function(){if(F(this.S()))return n[this.R>>2];var t=this.V();return 0!==t?t:this.R}}var v,d,p,g,y,b,w,m,P,D,C,I,M,R,k,A,T,E,F,W,S=t=>{var e=u;if(!e)return R(0),0;var r=new f(e);r.T(e);var i=r.S();if(!i)return R(0),e;for(var s in t){var n=t[s];if(0===n||n===i)break;if(E(n,i,r.P+16))return R(n),e}return R(i),e},x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,z=(t,e)=>{for(var r=e+NaN,i=e;t[i]&&!(i>=r);)++i;if(16<i-e&&t.buffer&&x)return x.decode(t.subarray(e,i));for(r="";e<i;){var s=t[e++];if(128&s){var n=63&t[e++];if(192==(224&s))r+=String.fromCharCode((31&s)<<6|n);else{var h=63&t[e++];65536>(s=224==(240&s)?(15&s)<<12|n<<6|h:(7&s)<<18|n<<12|h<<6|63&t[e++])?r+=String.fromCharCode(s):(s-=65536,r+=String.fromCharCode(55296|s>>10,56320|1023&s))}}else r+=String.fromCharCode(s)}return r},L=t=>t?z(s,t):"",U=[null,[],[]],O=[],N=t=>{var e=O[t];return e||(t>=O.length&&(O.length=t+1),O[t]=e=v.get(t)),e},V=[],_={t:function(t){r.log&&r.log(t?z(s,t):"")},i:t=>((t=new f(t)).W()||t.Z(),t.U(),T(t.R),t.X()),f:()=>S([]),a:t=>S([t]),b:(t,e,r)=>{throw new f(t).Y(e,r),u=t},e:t=>{throw u||=t,u},c:()=>{throw""},m:(t,e,r)=>s.copyWithin(t,e,e+r),k:t=>{var e=s.length;if(2147483648<(t>>>=0))return!1;for(var r=1;4>=r;r*=2){var i=e*(1+.2/r);i=Math.min(i,t+100663296);var n=Math;i=Math.max(t,i);t:{n=(n.min.call(n,2147483648,i+(65536-i%65536)%65536)-o.buffer.byteLength+65535)/65536;try{o.grow(n),l();var h=1;break t}catch(t){}h=void 0}if(h)return!0}return!1},l:()=>52,o:function(){return 70},g:(t,e,r,i)=>{for(var h=0,o=0;o<r;o++){var l=n[e>>2],u=n[e+4>>2];e+=8;for(var f=0;f<u;f++){var v=s[l+f],d=U[t];0===v||10===v?((1===t?a:c)(z(d,0)),d.length=0):d.push(v)}h+=u}return n[i>>2]=h,0},j:function(t,e){var r=k();try{return N(t)(e)}catch(t){if(A(r),t!==t+0)throw t;M(1,0)}},r:function(t,e,r){var i=k();try{return N(t)(e,r)}catch(t){if(A(i),t!==t+0)throw t;M(1,0)}},h:function(t,e,r,i){var s=k();try{return N(t)(e,r,i)}catch(t){if(A(s),t!==t+0)throw t;M(1,0)}},s:function(t){var e=k();try{N(t)()}catch(t){if(A(e),t!==t+0)throw t;M(1,0)}},d:function(t,e,r){var i=k();try{N(t)(e,r)}catch(t){if(A(i),t!==t+0)throw t;M(1,0)}},p:function(t,e,r,i){var s=k();try{N(t)(e,r,i)}catch(t){if(A(s),t!==t+0)throw t;M(1,0)}},q:function(t,e,r,i){var s=k();try{N(t)(e,r,i)}catch(t){if(A(s),t!==t+0)throw t;M(1,0)}},n:function(t,e,r,i,s,n,h){var o=k();try{W(t,e,r,i,s,n,h)}catch(t){if(A(o),t!==t+0)throw t;M(1,0)}}};return r.addFunction=(t,e)=>{if(!d){d=new WeakMap;var r=v.length;if(d)for(var i=0;i<0+r;i++){var s=N(i);s&&d.set(s,i)}}if(r=d.get(t)||0)return r;if(V.length)r=V.pop();else{try{v.grow(1)}catch(t){if(!(t instanceof RangeError))throw t;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}r=v.length-1}try{i=r,v.set(i,t),O[i]=v.get(i)}catch(o){if(!(o instanceof TypeError))throw o;if("function"==typeof WebAssembly.Function){i=WebAssembly.Function,s={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"};for(var n={parameters:[],results:"v"==e[0]?[]:[s[e[0]]]},h=1;h<e.length;++h)n.parameters.push(s[e[h]]);e=new i(n,t)}else{for(i=[1],s=e.slice(0,1),e=e.slice(1),n={i:127,p:127,j:126,f:125,d:124,e:111},i.push(96),128>(h=e.length)?i.push(h):i.push(h%128|128,h>>7),h=0;h<e.length;++h)i.push(n[e[h]]);"v"==s?i.push(0):i.push(1,n[s]),e=[0,97,115,109,1,0,0,0,1],128>(s=i.length)?e.push(s):e.push(s%128|128,s>>7),e.push.apply(e,i),e.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),e=new WebAssembly.Module(new Uint8Array(e)),e=new WebAssembly.Instance(e,{e:{f:t}}).exports.f}i=r,v.set(i,e),O[i]=v.get(i)}return d.set(t,r),r},r.removeFunction=t=>{d.delete(N(t)),v.set(t,null),O[t]=v.get(t),V.push(t)},WebAssembly.instantiate(r.wasm,{a:_}).then((t=>{t=t.instance.exports,p=t.w,g=t.x,y=t.y,b=t.z,w=t.A,m=t.B,P=t.C,D=t.D,C=t.F,I=t.G,M=t.H,R=t.I,k=t.J,A=t.K,T=t.L,E=t.M,F=t.N,W=t.O,v=t.E,o=t.u,l(),t.v(),e(r)})),r.PitchDetector=class{constructor(t,e,i,s){const n=C(e*Float32Array.BYTES_PER_ELEMENT);this.buffer=new Float32Array(h.buffer,n,e),this.P=r.addFunction(s,"vff");try{this.R=p(t,e,i,this.P)}catch(t){throw Error(L(D(t)))}}analyze(t){if(t.length!=this.buffer.length)throw Error("Invalid frame length");this.buffer.set(t);try{g(this.R,this.buffer.byteOffset,t.length)}catch(t){throw Error(L(D(t)))}}reset(){y(this.R)}setCallbackInterval(t){try{b(this.R,t)}catch(t){throw Error(L(D(t)))}}setCallback(t){r.removeFunction(this.P),this.P=r.addFunction(t,"vff"),w(this.R,this.P)}destroy(){I(this.buffer.byteOffset),this.buffer=void 0,r.removeFunction(this.P),this.P=void 0,m(this.R),this.R=void 0}},r.PitchDetector.getVersion=function(){return L(P())},t.ready})({wasm:e}).then((e=>{if(!this.validate(e))throw new Error("Invalid wasm file");this.pitchDetector=new e.PitchDetector(sampleRate,t.renderQuantumFrames,t.pitchDetectorInterval,this.report.bind(this)),this.port.postMessage({method:"initialize",result:void 0})})).catch((t=>{this.port.postMessage({method:"initialize",error:t})}))}disable(){!0===this.enabled&&(this.enabled=!1),this.port.postMessage({method:"disable",result:void 0})}enable(){!1===this.enabled&&(this.enabled=!0),this.port.postMessage({method:"enable",result:void 0})}setInterval(e){try{if(e<=0||e%t.pitchDetectorInterval!=0)throw new Error("Invalid callback interval");this.intervalInChunk=Math.floor(e/t.pitchDetectorInterval),this.chunkCount=0,this.port.postMessage({method:"setInterval",result:void 0})}catch(t){this.port.postMessage({method:"setInterval",error:t})}}destroy(){var t;null===(t=this.pitchDetector)||void 0===t||t.destroy(),this.destroyed=!0,this.port.postMessage({method:"destroy",result:void 0})}report(e,r){if(this.chunkCount+=1,e>t.pitchDetectorThreshold&&this.voicePitch.push(r),this.chunkCount>=this.intervalInChunk){this.chunkCount=0;let t=0;this.voicePitch.length>0&&(this.voicePitch.sort(((t,e)=>t-e)),t=this.voicePitch[Math.floor(this.voicePitch.length/2)],this.voicePitch=[]),this.port.postMessage({method:"report",voicePitch:t})}}onmessage(t){const e=t.data,r=e.method;"initialize"===r?this.initialize(e.wasm):"disable"===r?this.disable():"enable"===r?this.enable():"setInterval"===r?this.setInterval(e.interval):"destroy"===r&&this.destroy()}}t.renderQuantumFrames=128,t.pitchDetectorThreshold=.9,t.pitchDetectorInterval=10,registerProcessor("pitch-detector-worklet-processor",t),globalThis.isPitchDetectorRegistered=!0}}();\n'],{type:"text/javascript"}),i=URL.createObjectURL(n);yield t.audioWorklet.addModule(i),setTimeout((()=>URL.revokeObjectURL(i)),0);const o=new AudioWorkletNode(t,"pitch-detector-worklet-processor",{numberOfInputs:1,numberOfOutputs:1}),s=new oa(o),a=yield e;return yield s.initialize(a),s}))}getNode(){return this.node}disable(){return ea(this,void 0,void 0,(function*(){yield this.exchange({method:"disable"})}))}enable(){return ea(this,void 0,void 0,(function*(){yield this.exchange({method:"enable"})}))}setInterval(t){return ea(this,void 0,void 0,(function*(){yield this.exchange({method:"setInterval",interval:t})}))}destroy(){return ea(this,void 0,void 0,(function*(){yield this.exchange({method:"destroy"})}))}constructor(t){super(),this.node=t,this.node.port.onmessage=this.onmessage.bind(this)}onmessage(t){const e=t.data;"report"===e.method&&this.dispatchEvent(new CustomEvent("pitchInfo",{detail:{voicePitch:e.voicePitch}}))}initialize(t){return ea(this,void 0,void 0,(function*(){yield this.exchange({method:"initialize",wasm:t})}))}exchange(t,e=[]){const n=this.node.port;return new Promise(((i,o)=>{n.addEventListener("message",(function e(s){const a=s.data;a.method===t.method&&(n.removeEventListener("message",e),a.error?o(a.error):i(a.result))})),n.postMessage(t,e),n.start()}))}}class sa extends ta.AudioProcessor{constructor(t){super(),this.name="PitchDetectorProcessor",this.wasmSourcePromise=t,this.isDestroyed=!1}setInterval(t){return ea(this,void 0,void 0,(function*(){const e=yield this.getHandler();yield e.setInterval(t)}))}destroy(){return ea(this,void 0,void 0,(function*(){if(this._source||this.destination)throw new Error(`Cannot destroy processor-${this.ID} piped to another processor, you might call unpipe() first`);const t=yield this.getHandler();yield t.destroy(),this.handlerPromise=void 0,this.isDestroyed=!0}))}onPiped(t){if(!this.handlerPromise)try{this.handlerPromise=oa.create(t.getAudioContext(),this.wasmSourcePromise).then((t=>(t.addEventListener("pitchInfo",this.onPitchInfo.bind(this)),t)))}catch(e){throw e}}onUnpiped(){try{this.getHandler().then((t=>t.removeEventListener("voicePitch",this.onPitchInfo.bind(this))))}catch(t){throw t}}onNode(t,e){return ea(this,void 0,void 0,(function*(){const n=(yield this.getHandler()).getNode();t.connect(n),this.output(t,e)}))}onEnableChange(t){return ea(this,void 0,void 0,(function*(){try{const e=yield this.getHandler();t?yield e.enable():yield e.disable()}catch(e){throw this._enabled=!t,e}}))}onPitchInfo(t){const e=t.detail;this.emitAsPromiseNoResponse("pitchInfo",{voicePitch:e.voicePitch})}getHandler(){return ea(this,void 0,void 0,(function*(){if(this.isDestroyed)throw new Error(`Processor-${this.ID} was destroyed`);if(!this.handlerPromise)throw new Error(`Processor-${this.ID} is not piped, you might call pipe() first`);try{return yield this.handlerPromise}catch(t){throw new Error(`Processor-${this.ID} is not piped successfully`)}}))}}class aa extends ta.AudioExtension{constructor(t){super(),this.VERSION="0.0.0",this.BUILD="304c2fe-dirty(12/11/2023, 5:01:06 PM)",this.options=t}checkCompatibility(){return na()&&ia()}_createProcessor(){var t;return this.wasmSourcePromise=null!==(t=this.wasmSourcePromise)&&void 0!==t?t:function(t,e){return ea(this,void 0,void 0,(function*(){const n=WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))?`${t.endsWith("/")?t.slice(0,-1):t}/pitch_detector_module_simd.wasm`:`${t.endsWith("/")?t.slice(0,-1):t}/pitch_detector_module.wasm`,i=yield fetch(n,e);if(i.ok)return yield i.arrayBuffer();if(404===i.status)throw new Error("Can not find the wasm file, you might publish wasm files and pass in the path");throw new Error(`Failed to fetch the wasm file with status ${i.status}`)}))}(this.options.assetsPath,this.options.fetchOptions),new sa(this.wasmSourcePromise)}}class ra{static init(){this.extension=new aa({assetsPath:"https://asset.tuwan.com/chatroom/agora/newwasm/"}),window.AgoraRTC.registerExtensions([this.extension])}constructor(){this.state=0,this.timer=null}start(t){if(2!=this.state){if(ra.extension.checkCompatibility()){if(!uu.globalRtcClient.localAudio)return void(this.timer=setTimeout((()=>{this.start(t)}),50));this.state,this.processor=ra.extension.createProcessor();try{uu.globalRtcClient.localAudio.pipe(this.processor).pipe(uu.globalRtcClient.localAudio.processorDestination),this.processor.setInterval(50)}catch(e){console.error(e)}this.processor.on("pitchInfo",(e=>{const n=e.voicePitch;t.setPitch(n)}))}}else this.clearTimer()}resume(){this.processor&&this.processor.enable()}stop(){this.processor&&this.processor.disable()}async destroy(){if(this.processor)try{this.processor.unpipe(),await this.processor.destroy(),uu.globalRtcClient.localAudio.pipe(uu.globalRtcClient.localAudio.processorDestination)}catch(t){}finally{this.processor=null}this.clearTimer()}clearTimer(){this.timer&&(window.clearTimeout(this.timer),this.timer=null)}}const ca={},la=function(t,e,n){if(!e||0===e.length)return t();const i=document.getElementsByTagName("link");return Promise.all(e.map((t=>{if((t=function(t){return"https://asset-slt.tuwan.com/"+t}(t))in ca)return;ca[t]=!0;const e=t.endsWith(".css"),o=e?'[rel="stylesheet"]':"";if(!!n)for(let n=i.length-1;n>=0;n--){const o=i[n];if(o.href===t&&(!e||"stylesheet"===o.rel))return}else if(document.querySelector(`link[href="${t}"]${o}`))return;const s=document.createElement("link");return s.rel=e?"stylesheet":"modulepreload",e||(s.as="script",s.crossOrigin=""),s.href=t,document.head.appendChild(s),e?new Promise(((e,n)=>{s.addEventListener("load",e),s.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${t}`))))})):void 0}))).then((()=>t()))};function da(t){return t.toString().padStart(2,"0")}var ma=(t=>(t[t.DEBUG=0]="DEBUG",t[t.WARN=1]="WARN",t[t.ERROR=2]="ERROR",t))(ma||{}),ha=(t=>(t[t.IDLE=0]="IDLE",t[t.PLAYING=3]="PLAYING",t[t.PAUSE=4]="PAUSE",t))(ha||{}),ua=(t=>(t[t.ORIGINAL=1]="ORIGINAL",t[t.ACCOMPANY=2]="ACCOMPANY",t))(ua||{});const pa=new class{constructor(t){this.level=ma.ERROR,this.prefix="",this.preTime=0,this._recordList=[];const{level:e,prefix:n}=t;void 0!==e&&(this.level=e),n&&(this.prefix=n)}setLogLevel(t){this.level=t}debug(...t){this.level<=ma.DEBUG&&this._log(`${this._genPrefix()}[DEBUG]: `,...t)}warn(...t){this.level<=ma.WARN&&this._log(`${this._genPrefix()}[WARN]: `,...t)}error(...t){this.level<=ma.ERROR&&this._err(`${this._genPrefix()}[ERROR]: `,...t)}record(...t){const e=Date.now();let n=0;if(this._recordList.length){n=e-this._recordList[this._recordList.length-1].time}const i=`[time] ${t} +${n}ms`;this._recordList.push({id:this._recordList.length,text:i,time:e}),this.debug(i)}recordEnd(){this._recordList=[]}_log(...t){const[e,...n]=t;console.log(`%c${e}`,"color:yellow",...n)}_err(...t){let e="";for(const n of t)e+="string"==typeof n?n:JSON.stringify(n);console.error(e)}_genPrefix(){return(t=>{t||(t=new Date);const e=t.getHours(),n=t.getMinutes(),i=t.getSeconds(),o=t.getMilliseconds();return`${da(e)}:${da(n)}:${da(i)}:${da(o)}`})()+(this.prefix?` [${this.prefix}]`:"")}}({level:ma.ERROR,prefix:"agoraEngine"}),ga=Mt.YSD_PID,fa=Mt.YSD_APP_KEY,wa=window.AgoraRTC;class va{constructor(t){this.pid=ga,this.pKey=fa,this.userId="",this.token="",this.currentTime=0,this.currentLine=0,this.lyric={},this.audioContext=new AudioContext,this.bgmStatus=ha.IDLE,this.bgmType=ua.ACCOMPANY,this._emitter=ot(),this._intervalIds=[],this._bgmTimerStart=!1,this.config=t}get isIdle(){return this.bgmStatus===ha.IDLE}get isOriginalBgmStart(){var t;return(null==(t=null==this?void 0:this.originalBgmTrack)?void 0:t.getCurrentTime())>0}get isAccompanyBgmStart(){var t;return(null==(t=null==this?void 0:this.accompanyBgmTrack)?void 0:t.getCurrentTime())>0}get totalLine(){var t,e;return(null==(e=null==(t=this.lyric)?void 0:t.content)?void 0:e.length)||0}get bgmDuration(){var t;return 1e3*(null==(t=this.originalBgmTrack)?void 0:t.duration)||0}get rtcClient(){return this.config.rtcClient}get yinsudaClient(){if(!window.yinsudaClient)throw new Error("yinsudaClient is not defined");return window.yinsudaClient}setLogLevel(t){pa.setLogLevel(t)}async setUser(t){window.yinsudaClient||await la((()=>import("./index.umd-ab25901c.js")),["assets/index.umd-ab25901c.js","assets/vendor-a26d429a.js","assets/vendor.1725411945463.b63fc2a0.css"]);const e=await qt.get(Ot.yinsudaGetUserToken()),{yinsuda_uid:n,token:i}=e.data;this.userId=n,this.token=i,await this.yinsudaClient.setUser({userid:this.userId,token:this.token,clientPid:this.pid,appkey:this.pKey,isVip:0}),pa.debug("setUser success")}async getLyric(t,e){try{e&&({song_id:t}.isAccompany=1);const{data:n,status:i}=await this.yinsudaClient.getLyric({song_id:t});if(0!==i){const t="getLyric error";throw pa.error(t),new Error(t)}return n.lyric&&(this.lyric=(t=>{const e=st.parse(t);for(const n of e.content){const t=n.content[n.content.length-1],e=n.start+t.start+t.duration;n.lastToneEndTime=e}return e})(n.lyric)),pa.debug("getLyric success",this.lyric),this.lyric}catch(n){throw pa.error("getLyric error",n),n}}async getPitchData(t){try{const{status:e,data:n}=await this.yinsudaClient.getPitchData({song_id:t});if(0!==e)throw pa.error("getPitchData error",e),new Error("getPitchData error");return pa.debug("getPitchData success",null==n?void 0:n.pitch),null==n?void 0:n.pitch}catch(e){throw pa.error("getPitchData error",e),e}}prepare(){this.yinsudaClient.setAudioParams({sampleRate:48e3,channels:1}),this.yinsudaClient.setScoreHardLevel({level:5}),pa.debug("prepare success")}async getRealTimePitch(){try{const{status:t,data:e}=await this.yinsudaClient.getRealTimePitch();if(0!==t)throw pa.error("getRealTimePitch error",t),new Error("getRealTimePitch error");return pa.debug("getRealTimePitch success",e),e}catch(t){throw pa.error("getRealTimePitch error",t),t}}async getScore(t=0){try{const{status:e,data:n}=await this.yinsudaClient.getScore({pts:t});if(0!==e)throw pa.error("getScore error",e),new Error("getScore error");return pa.debug("getScore success",n),n}catch(e){throw pa.error("getScore error",e),e}}async getAverageScore(t=0){try{const{status:e,data:n}=await this.yinsudaClient.getAverageScore({pts:t});if(0!==e)throw pa.error("getAverageScore error",e),new Error("getAverageScore error");return pa.debug("getAverageScore success",n),n}catch(e){throw pa.error("getAverageScore error",e),e}}async getTotalScore(t=0){try{const{status:e,data:n}=await this.yinsudaClient.getTotalScore({pts:t});if(0!==e)throw pa.error("getTotalScore error",e),new Error("getTotalScore error");return pa.debug("getTotalScore success",n),n}catch(e){throw pa.error("getTotalScore error",e),e}}async reset(){var t,e,n,i;null==(t=this.accompanyBgmTrack)||t.stopProcessAudioBuffer(),null==(e=this.accompanyBgmTrack)||e.close(),this.accompanyBgmTrack=void 0,null==(n=this.originalBgmTrack)||n.stopProcessAudioBuffer(),null==(i=this.originalBgmTrack)||i.close(),this.originalBgmTrack=void 0,this.bgmStatus=ha.IDLE,this.lyric={},this.currentTime=0,this.currentLine=0,this._bgmTimerStart=!1,this._intervalIds.forEach((t=>clearInterval(t))),this._intervalIds=[],this.stopProcessAudio(),this.mediaStreamAudioSourceNode=void 0,pa.debug("reset success")}destory(){var t;this.reset(),this.audioContext.close(),this._emitter.all.clear(),null==(t=this.audioTrack)||t.close(),this.audioTrack=void 0,pa.debug("destory success")}setAudioTrack(t){this.audioTrack=t,pa.debug("setAudioTrack success")}async startProcessAudio(){if(!this.audioTrack)throw new Error("audioTrack is not defined");this.audioContext=new AudioContext;const t=URL.createObjectURL(new Blob(['\n      const MAX_NUM = 1700  \n      const float32Array2Int16Array = (source) => {\n        let intArray = new Int16Array(source.length);\n        for (let i = 0;i < source.length;i++) {\n          if (source[i] < 0) {\n            source[i] = source[i] * 32768\n          } else if (source[i] > 0) {\n            source[i] = source[i] * 32767\n          }\n          intArray[i] = Math.round(source[i]);\n        }\n        return intArray;\n      }\n\n\n      class PCMProcessor extends AudioWorkletProcessor {\n        process(inputs, outputs, parameters) {\n          const input = inputs[0] \n          if (!this.audioData) {\n            this.audioData = []\n          }\n          if (input[0]) {\n            this.audioData.push(...input[0])\n            if (this.audioData.length > MAX_NUM) {\n              this.port.postMessage({\n                pcm: float32Array2Int16Array(this.audioData)\n              })\n              this.audioData = []\n            }\n          }\n\n          return true\n        }\n\n      }\n      registerProcessor("pcm-processor", PCMProcessor)\n    '],{type:"text/javascript"}));await this.audioContext.audioWorklet.addModule(t).then((()=>{console.log("AudioWorklet module loaded.")})).catch((t=>{console.error("catch error"),console.error(t)}));const e=new AudioWorkletNode(this.audioContext,"pcm-processor"),n=this.audioTrack.getMediaStreamTrack();this.mediaStreamAudioSourceNode=this.audioContext.createMediaStreamSource(new MediaStream([n])),this.mediaStreamAudioSourceNode.connect(e),e.port.onmessage=t=>{var e;const n=null==(e=t.data)?void 0:e.pcm;n&&this._dealAudioPcm(n)},pa.debug("startProcessAudio success")}stopProcessAudio(){var t;this.audioTrack,null==(t=this.mediaStreamAudioSourceNode)||t.disconnect(),pa.debug("stopProcessAudio success")}stopTimer(){this._intervalIds.forEach((t=>clearInterval(t))),this._intervalIds=[]}async genBgmTracks(t,e){var n,i;pa.record("genBgmTracks start"),await this.yinsudaClient.initCodec("https://asset.tuwan.com/chatroom/agora/yinsuda0530"),pa.record("genBgmTracks initCodec success");const o={song_id:t};e&&(o.isAccompany=1);const s=await this.yinsudaClient.downloadSongById(o);pa.record("genBgmTracks download song success");const a=s.data.mp3Data;let r,c;if(a[0]){let t=new Blob([a[0]],{type:"audio/mpeg"});r=new File([t],"accompany.mp3",{type:t.type})}if(a[1]){let t=new Blob([a[1]],{type:"audio/mpeg"});c=new File([t],"original.mp3",{type:t.type})}pa.record("genBgmTracks generate mp3 file success");let l=[];r&&l.push(wa.createBufferSourceAudioTrack({source:r})),c&&l.push(wa.createBufferSourceAudioTrack({source:c}));const d=await Promise.all(l);pa.record("genBgmTracks create buffer source audio track success"),this.accompanyBgmTrack=d[0],this.originalBgmTrack=d[1],null==(n=this.accompanyBgmTrack)||n.on("source-state-change",this._handleSourceStateChange.bind(this)),null==(i=this.originalBgmTrack)||i.on("source-state-change",this._handleSourceStateChange.bind(this)),pa.debug("genBgmTracks success",this.accompanyBgmTrack,this.originalBgmTrack)}playBgm(t){var e,n,i,o;t==ua.ACCOMPANY?(null==(e=this.accompanyBgmTrack)||e.startProcessAudioBuffer(),null==(n=this.accompanyBgmTrack)||n.play()):(null==(i=this.originalBgmTrack)||i.startProcessAudioBuffer(),null==(o=this.originalBgmTrack)||o.play()),this.bgmStatus=ha.PLAYING,this.bgmType=t,this.emit("statusChanged",{status:this.bgmStatus,type:this.bgmType}),this._startBgmTimer(),pa.debug("playBgm success")}toggleBgmTrack(){var t,e,n,i,o,s,a,r,c,l,d,m,h,u;this.bgmType==ua.ORIGINAL?(null==(t=this.originalBgmTrack)||t.pauseProcessAudioBuffer(),this.isAccompanyBgmStart?(null==(e=this.accompanyBgmTrack)||e.seekAudioBuffer(this.currentTime/1e3),this.bgmStatus==ha.PLAYING&&(null==(n=this.accompanyBgmTrack)||n.resumeProcessAudioBuffer())):this.bgmStatus==ha.PLAYING?(null==(i=this.accompanyBgmTrack)||i.startProcessAudioBuffer(),null==(o=this.accompanyBgmTrack)||o.seekAudioBuffer(this.currentTime/1e3),null==(s=this.accompanyBgmTrack)||s.play()):null==(a=this.accompanyBgmTrack)||a.seekAudioBuffer(this.currentTime/1e3),this.bgmType=ua.ACCOMPANY):this.bgmType==ua.ACCOMPANY&&(null==(r=this.accompanyBgmTrack)||r.pauseProcessAudioBuffer(),this.isOriginalBgmStart?(null==(c=this.originalBgmTrack)||c.seekAudioBuffer(this.currentTime/1e3),this.bgmStatus==ha.PLAYING&&(null==(l=this.originalBgmTrack)||l.resumeProcessAudioBuffer())):this.bgmStatus==ha.PLAYING?(null==(d=this.originalBgmTrack)||d.startProcessAudioBuffer(),null==(m=this.originalBgmTrack)||m.seekAudioBuffer(this.currentTime/1e3),null==(h=this.originalBgmTrack)||h.play()):null==(u=this.originalBgmTrack)||u.seekAudioBuffer(this.currentTime/1e3),this.bgmType=ua.ORIGINAL),this.emit("statusChanged",{status:this.bgmStatus,type:this.bgmType}),pa.debug("toggleBgmTrack success")}toggleBgmStatus(){this.bgmStatus===ha.PLAYING?(this._pauseBgm(),this.bgmStatus=ha.PAUSE):this.bgmStatus==ha.PAUSE&&(this._resumeBgm(),this.bgmStatus=ha.PLAYING),this.emit("statusChanged",{status:this.bgmStatus,type:this.bgmType}),pa.debug("toggleBgmStatus success")}setBgmVolume(t){var e,n;t<0||t>100||this.isIdle||(null==(e=this.accompanyBgmTrack)||e.setVolume(t),null==(n=this.originalBgmTrack)||n.setVolume(t))}seekBgmProgress(t){var e,n;t<0||(this.currentTime=t,null==(e=this.accompanyBgmTrack)||e.seekAudioBuffer(t/1e3),null==(n=this.originalBgmTrack)||n.seekAudioBuffer(t/1e3),pa.debug("seekBgmProgress success",this.currentTime))}justStartBgmTimer(){this.bgmStatus=ha.PLAYING,this.bgmType=1,this.emit("statusChanged",{status:this.bgmStatus,type:this.bgmType}),this._startBgmTimer(),pa.debug("justStartBgmTimer success")}getBgmProgress(){var t,e;let n=0;if(this.isIdle)return n;let i=(null==(t=null==this?void 0:this.originalBgmTrack)?void 0:t.getCurrentTime())||0,o=(null==(e=null==this?void 0:this.accompanyBgmTrack)?void 0:e.getCurrentTime())||0;return n=i>o?i:o,1e3*n}on(t,e){this._emitter.on(t,e)}off(t,e){this._emitter.off(t,e)}emit(t,e){"progressChanged"!==t&&"pitchChanged"!==t&&pa.debug("event emit: ",t,e),this._emitter.emit(t,e)}async _dealLine(){var t;if(!(null==(t=this.lyric)?void 0:t.content))return;let e=this.lyric.content.length;for(let n=0;n<e;n++){const t=this.lyric.content[n],{lastToneEndTime:e}=t;if(this.currentTime>=e&&n>this.currentLine){this.currentLine=n;const[t,e]=await Promise.all([this.yinsudaClient.getScore({pts:this.currentTime}),this.yinsudaClient.getTotalScore({pts:this.currentTime})]),{index:i=0,score:o=0}=(null==t?void 0:t.data)||{},{totalScore:s=0}=(null==e?void 0:e.data)||{};let a=0;this.currentLine==i&&(a=o>=0?o:0),this.emit("lineChanged",{lineNumber:this.currentLine,lineScore:a,totalScore:s});break}}}async _dealAudioPcm(t){var e;if(this.bgmStatus!==ha.PLAYING)return;this.yinsudaClient.processScore({buffer:t,pts:this.currentTime});var n=await this.yinsudaClient.getRealTimePitch();const i=(null==(e=null==n?void 0:n.data)?void 0:e.pitch)||0;this.emit("pitchChanged",{realPitch:i,time:this.currentTime})}_startBgmTimer(){if(this._bgmTimerStart)return;this._bgmTimerStart=!0;const t=setInterval((()=>{this.currentTime=this.getBgmProgress(),this.emit("progressChanged",{time:this.currentTime}),this._dealLine()}),20);this._intervalIds.push(t)}_pauseBgm(){var t,e;this.bgmType===ua.ORIGINAL?null==(t=this.originalBgmTrack)||t.pauseProcessAudioBuffer():null==(e=this.accompanyBgmTrack)||e.pauseProcessAudioBuffer()}_resumeBgm(){var t,e;this.bgmType===ua.ORIGINAL?null==(t=this.originalBgmTrack)||t.resumeProcessAudioBuffer():null==(e=this.accompanyBgmTrack)||e.resumeProcessAudioBuffer()}_handleSourceStateChange(t){pa.debug("bgm source state change",t),"stopped"==t&&(this.reset(),this.emit("statusChanged",{status:this.bgmStatus,type:this.bgmType}))}}const _a=at((function(t,e){e(t)}),1e3);class ya extends ks{constructor(){super(),m(this,"handleStreamMessage",((t,e)=>{const n=this.engine.messageHandler.handlerMessage(t,e),{cmd:i,time:o,duration:s,ntp:a,pitch:r}=n;switch(i){case"setLrcTime":let t=o;if(t<=0)return;if(this.loadMuisc&&8==this.loadMuisc.status){uu.globalRtcClient.client.getNtpWallTimeInMs();const e=1e3*this.loadMuisc.currentTrack().getCurrentTime();if(Math.abs(o-e)>50&&o<s){t=o;const e=this;_a(t/1e3,(function(t){e.loadMuisc.seek(t)}))}else t=e;this.setMainSongProgress(t/1e3)}const e=t/1e3;if(this.mineIsAudience()&&0==this.isForward){const e=t>1500?t-1500:0;this.setLyricOffset(e/1e3),this.setMainSongProgress(e/1e3)}this.updateMusicCountdown(e),this.mineIsChorus()&&this.loadMuisc&&this.loadMuisc.seekOnce(e)&&this.loadMuisc.startPlay();break;case"setVoicePitch":this.mineIsChorus()&&this.setMainSongPitch(r)}})),m(this,"handleAudioMessage",((t,e)=>{const n=Es(audioData),{ts:i,songId:o}=n;let s=i;if(!(s<=0)&&this.loadMuisc&&8==this.loadMuisc.status){const t=1e3*this.loadMuisc.currentTrack().getCurrentTime();if(Math.abs(i-t)>50&&i<duration){s=t;const e=this;_a(s/1e3,(function(t){e.loadMuisc.seek(t)}))}else s=t}})),this._engine=null,this.loadMuisc=null,this.isForward=!1,this.actInfo=null,this.microphoneReday=!1,this.huatongEle=null,this.setRole=null,this.seatsElements=null,this.subChannel=null,this.subChannelBgm=null,this.mainChannel=null,this.vocalScore=0,this.subscribeSet=new Set,this.recordPreviousVolume=-1,this.captureAudioHandle=null,this.reportVolumeIndex=0,this.evaluateScore=null,this.new_engine=new va,this.lyric=null,this.pitchData=null}onReset(t=!0){super.onReset(t),uu.globalRtcClient.emitter.off("stream-message",this.handleStreamMessage),uu.globalRtcClient.emitter.off("audio-metadata",this.handleAudioMessage),this.destroyLoadMuisc(),this._engine&&(this._engine.destory(),this._engine=null),this.new_engine&&this.new_engine.stopTimer(),this.isForward=!1,this.microphoneReday=!1,this.huatongEle=null,this.seatsElements=null,this.destroyEvaluateScore(),this.mainChannel&&(this.mainChannel.removeEvents(),this.mainChannel=null),this.leaveSubChannel(),this.leaveSubChannelBgm(),this.vocalScore=0,this.subscribeSet.clear(),this.stopCaptureAudio(),this.reportVolumeIndex=0}async initTemplate(t){this.isForward=1==uu.getRoomInfo().forward,uu.globalRtcClient.emitter.on("stream-message",this.handleStreamMessage),uu.globalRtcClient.emitter.on("audio-metadata",this.handleAudioMessage),this.huatongEle=$(".chat-huatong"),this.seatsElements=window.$(".chat-center-main"),ra.init(),this.createMainChannel()}get engine(){return this._engine||(this._engine=qs.getInstance(),this._engine.lineAreaWidth=600,this._engine.lineAreaHeight=60,this.subscribeEngineEvents()),this._engine}createMainChannel(){this.mainChannel=new ws(uu.globalRtcClient),this.mainChannel.initStreamedCb=async()=>{this.microphoneReday=!0}}joinSubChannel(){const{sub_channel:t,sub_channel_key:e}=this.actInfo;this.subChannel=new ws,this.subChannel.join(t,e),this.subChannel.streamMessageCb=(t,e)=>{if(this.mineIsAudience()&&1==this.isForward){const n=this.engine.messageHandler.handlerMessage(t,e);if("setLrcTime"==n.cmd){if(!n.ver){let t=n.realTime;t/=1e3,t=t>0?t:0,this.setLyricOffset(t-.2),this.setMainSongProgress(t-.2)}}else"setVoicePitch"==n.cmd&&this.setMainSongPitch(n.pitch)}}}async checkAnchorMusicLoaded(t=0){if(this.loadMuisc&&6==this.loadMuisc.status){0!=t&&this.loadMuisc.seek(t),this.loadMuisc.startPlay();const{bgm_host_channel_key:e,bgm_host_uid:n}=this.actInfo,i=new ws;i.join(uu.getRoomInfo().channel,e,n),i.joinChanneledCb=()=>{i.publishCustomAudioTrack(this.loadMuisc.originalTrack),i.publishCustomAudioTrack(this.loadMuisc.accompaniedTrack)},this.subChannelBgm=i}}engineTimeUpdate(t){const{progress:e}=t;if(this.mineIsPublishStreamRole()){const{duration:t,song_code:n}=this.actInfo.song_info,i=1e3*e;uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({cmd:"setLrcTime",ntp:uu.globalRtcClient.client.getNtpWallTimeInMs()+Gs,duration:parseInt(String(1e3*t),10),time:parseInt(String(i- -190),10),realTime:parseInt(String(i),10),playerState:3,pitch:0,songIdentifier:String(n),forward:this.isForward,ver:2}),syncWithAudio:!0});const o=Ls({cmd:"setLrcTime",type:1001,ts:parseInt(String(i),10),songId:String(n),forward:!0,uid:uu.getMeid()});uu.globalRtcClient.sendAudioMetadata({value:o}),this.updateMusicCountdown(e)}this.setLyricOffset(e)}engineLineEnd(t){this.vocalScore=t.score}engineDraw(t){}engineCursor(t){}subscribeEngineEvents(){this.engine.on("timeUpdate",this.engineTimeUpdate.bind(this)),this.new_engine.on("lineChanged",(t=>{const{lineNumber:e,lineScore:n,totalScore:i}=t;let o=n,s=e;o>0&&(console.log("lineChanged="+e+"-"+n+"-"+i),qt.get(Ot.getKtvReportScore(uu.getCid(),this.actInfo.song_info.order_id,s+1,o)).then((t=>{})))}))}isSonger(){return!1}updateEvaluateScoreState(){this.isSonger()?this.evaluateScore?this.evaluateScore.resume():(this.evaluateScore=new ra,this.evaluateScore.start(this.engine)):this.evaluateScore&&this.evaluateScore.stop()}updateAnchorMicrophoneState(){if(this.mainChannel&&this.getAnchorKengUser(uu.getMeid())&&!this.huatongIsOpen())if(this.microphoneReday)this.mainChannel.published||(this.setRole(1),this.mainChannel.setLocalAudioVolume(0));else{let t=setInterval((()=>{this.microphoneReday&&(window.clearInterval(t),t=null,this.updateAnchorMicrophoneState())}),300)}}resumePreviousVolume(){}updatePreviousVolume(t){}setVolumes(t,e=!1){xt.getInstance().setMainVolume(1*t),this.setVolume(1*t),e&&window.$(".chat-voice-volume input[type='range']").val(1*t)}setVolume(t){this.mainChannel&&this.mainChannel.setVolume(t),this.subChannel&&this.subChannel.setVolume(t)}verifySongUrl(t){if(!t||""==t)return Vt("歌曲链接为空"),!1;if(!t)return Vt("歌曲有问题，链接为空"),!1;let e=t.split("|");return 2!=e.length?(Vt("歌曲有问题，缺少原唱或者伴奏"),!1):!(e[0].indexOf(".mp3")<0||e[1].indexOf(".mp3")<0)||(Vt("歌曲类型有问题，返回了不是mp3的链接"),!1)}reportRtcScore(){uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({service:"audio_smart_mixer",version:"V1",payload:{cname:uu.getRoomInfo().channel,uid:uu.getMeid()+"",uLv:-1,specialLabel:0,audioRoute:3,vocalScore:this.vocalScore}}),syncWithAudio:!0})}reportRtcMixerStatus(){uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({service:"audio_smart_mixer_status",version:"V1",payload:{Ts:uu.globalRtcClient.client.getNtpWallTimeInMs(),cname:uu.getRoomInfo().channel,status:1,bgmUID:String(this.actInfo.host_bgm_uid),leadsingerUID:String(uu.getMeid())}}),syncWithAudio:!0})}startCaptureAudio(t=!0){this.captureAudioHandle||(this.captureAudioHandle=Ct.captureAudioVolume(null,(e=>{const n=this.huatongIsOpen()?Math.floor(2.55*e):0;t&&this.reportVolumeIndex++%2&&setTimeout((()=>{this.reportLocalVolume(n)}),Math.floor(200*Math.random()))})),this.captureAudioHandle.start())}stopCaptureAudio(){this.captureAudioHandle&&(this.captureAudioHandle.stop(),this.captureAudioHandle=null)}checkUserShowOrHideWave(t,e){t&&(e>=4?this.showWaveWithUser(t):this.hideWaveWithUser(t))}showWaveWithUser(t){t&&t.uid&&this.seatsElements&&this.seatsElements.find(".seat-item-empty[data-uid='"+t.uid+"']").addClass("speaking")}hideWaveWithUser(t){t&&t.uid&&this.seatsElements&&this.seatsElements.find(".seat-item-empty[data-uid='"+t.uid+"']").removeClass("speaking")}destroyLoadMuisc(){this.loadMuisc&&(this.loadMuisc.destroy(),this.loadMuisc=null)}huatongIsOpen(){return!this.huatongEle.hasClass("chat-huatong-jin")}autoOpenMicrophone(){this.huatongIsOpen()||(this.huatongEle.removeClass("chat-huatong-jin"),this.setRole&&this.setRole(1))}chorusAutoCloseMicrophone(){this.huatongIsOpen()&&(this.huatongEle.addClass("chat-huatong-jin"),this.setRole&&this.setRole(0))}updateMusicCountdown(t){}setLyricOffset(t){console.error("子类重写此方法")}mineIsPublishStreamRole(){return console.error("子类重写此方法"),!1}setMainSongProgress(t){}setMainSongPitch(t){}reportLocalVolume(t){}leaveSubChannel(){this.subChannel&&(this.subChannel.destroy(),this.subChannel=null)}async leaveSubChannelBgm(){this.subChannelBgm&&(this.subChannelBgm.leave(),this.subChannelBgm=null)}resetEngine(){this._engine&&this._engine.reset(),this.vocalScore=0}destroyEvaluateScore(){this.evaluateScore&&(this.evaluateScore.destroy(),this.evaluateScore=null)}}const xa="src/js/ktv/rankModal/tableCellStyle1.svelte";function ba(t){let e,n;const i={c:function(){e=_("p"),n=M(t[1]),y(e,"class","no_p s-ybje4cnvID9Y"),x(e,xa,12,8,397)},m:function(t,i){b(t,e,i),I(e,n)},p:function(t,e){2&e&&P(n,t[1])},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:ba.name,type:"else",source:"(12:4) {:else}",ctx:t}),i}function $a(t){let e,n;e=new ye({props:{class:"no_img",src:"https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.src="https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:$a.name,type:"if",source:"(10:4) {#if rank <= 3}",ctx:t}),i}function ka(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A,j,D,L,F,V,K,Y,J,Q,X,Z=t[0].user_info.nickname+"",tt=t[0].song_info.name+"",et=t[0].song_info.singer+"",nt=t[0].max_score+"",it=t[0].play_num+"";const ot=[$a,ba],st=[];function at(t,e){return t[1]<=3?0:1}n=at(t),i=st[n]=ot[n](t),s=new ye({props:{class:"head",src:t[0].user_info.avatar},$$inline:!0}),Y=new ye({props:{class:"arrow",src:"https://dynamics-share.tuwan.com/activity/e8abcbe41c633d04a62d500212798cac.png"},$$inline:!0});const ct={c:function(){e=_("div"),i.c(),o=T(),U(s.$$.fragment),a=T(),r=_("div"),c=_("p"),l=M(Z),d=T(),m=_("p"),h=M("《"),u=M(tt),g=M("》-"),f=M(et),w=T(),v=_("div"),$=_("div"),k=_("p"),S=M(nt),R=T(),A=_("p"),A.textContent="分",j=T(),D=_("p"),L=M("演唱"),F=M(it),V=M("次"),K=T(),U(Y.$$.fragment),y(c,"class","name s-ybje4cnvID9Y"),x(c,xa,16,8,517),y(m,"class","desc s-ybje4cnvID9Y"),x(m,xa,17,8,571),y(r,"class","info s-ybje4cnvID9Y"),x(r,xa,15,4,490),y(k,"class","score s-ybje4cnvID9Y"),x(k,xa,21,12,732),y(A,"class","unit s-ybje4cnvID9Y"),x(A,xa,22,12,782),y($,"class","flex flex-ac flex-jend"),x($,xa,20,8,683),y(D,"class","times s-ybje4cnvID9Y"),x(D,xa,24,8,827),y(v,"class","counts s-ybje4cnvID9Y"),x(v,xa,19,4,654),y(e,"class","ktv-table_cell_style1 s-ybje4cnvID9Y"),rt(e,"top3",t[1]<=3),x(e,xa,8,0,141)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,p){b(i,e,p),st[n].m(e,null),I(e,o),z(s,e,null),I(e,a),I(e,r),I(r,c),I(c,l),I(r,d),I(r,m),I(m,h),I(m,u),I(m,g),I(m,f),I(e,w),I(e,v),I(v,$),I($,k),I(k,S),I($,R),I($,A),I(v,j),I(v,D),I(D,L),I(D,F),I(D,V),I(e,K),z(Y,e,null),J=!0,Q||(X=E(e,"click",B((function(){H(t[2].bind(null,t[0]))&&t[2].bind(null,t[0]).apply(this,arguments)})),!1,!1,!0,!1),Q=!0)},p:function(a,[r]){let c=n;n=at(t=a),n===c?st[n].p(t,r):(W(),O(st[c],1,1,(()=>{st[c]=null})),N(),i=st[n],i?i.p(t,r):(i=st[n]=ot[n](t),i.c()),q(i,1),i.m(e,o));const d={};1&r&&(d.src=t[0].user_info.avatar),s.$set(d),(!J||1&r)&&Z!==(Z=t[0].user_info.nickname+"")&&P(l,Z),(!J||1&r)&&tt!==(tt=t[0].song_info.name+"")&&P(u,tt),(!J||1&r)&&et!==(et=t[0].song_info.singer+"")&&P(f,et),(!J||1&r)&&nt!==(nt=t[0].max_score+"")&&P(S,nt),(!J||1&r)&&it!==(it=t[0].play_num+"")&&P(F,it),(!J||2&r)&&rt(e,"top3",t[1]<=3)},i:function(t){J||(q(i),q(s.$$.fragment,t),q(Y.$$.fragment,t),J=!0)},o:function(t){O(i),O(s.$$.fragment,t),O(Y.$$.fragment,t),J=!1},d:function(t){t&&C(e),st[n].d(),G(s),G(Y),Q=!1,X()}};return p("SvelteRegisterBlock",{block:ct,id:ka.name,type:"component",source:"",ctx:t}),ct}function Ca(t,e,n){let{$$slots:i={},$$scope:o}=e;f("TableCellStyle1",i,[]);let{data:s}=e,{rank:a}=e,{itemClickCb:r}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<TableCellStyle1> was created without expected prop 'data'"),void 0!==a||"rank"in e||t.$$.bound[t.$$.props.rank]||console.warn("<TableCellStyle1> was created without expected prop 'rank'"),void 0!==r||"itemClickCb"in e||t.$$.bound[t.$$.props.itemClickCb]||console.warn("<TableCellStyle1> was created without expected prop 'itemClickCb'")}));const c=["data","rank","itemClickCb"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<TableCellStyle1> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank),"itemClickCb"in t&&n(2,r=t.itemClickCb)},t.$capture_state=()=>({Img:ye,data:s,rank:a,itemClickCb:r}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank),"itemClickCb"in t&&n(2,r=t.itemClickCb)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r]}class Ia extends h{constructor(t){super(t),u(this,t,Ca,ka,g,{data:0,rank:1,itemClickCb:2}),p("SvelteRegisterComponent",{component:this,tagName:"TableCellStyle1",options:t,id:ka.name})}get data(){throw new Error("<TableCellStyle1>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<TableCellStyle1>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get rank(){throw new Error("<TableCellStyle1>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set rank(t){throw new Error("<TableCellStyle1>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get itemClickCb(){throw new Error("<TableCellStyle1>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set itemClickCb(t){throw new Error("<TableCellStyle1>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Sa="src/js/ktv/rankModal/tableCellStyle2.svelte";function Ta(t){let e,n;const i={c:function(){e=_("p"),n=M(t[1]),y(e,"class","no_p s-AxVDTuFbk30O"),x(e,Sa,12,8,397)},m:function(t,i){b(t,e,i),I(e,n)},p:function(t,e){2&e&&P(n,t[1])},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:Ta.name,type:"else",source:"(12:4) {:else}",ctx:t}),i}function Ra(t){let e,n;e=new ye({props:{class:"no_img",src:"https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.src="https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Ra.name,type:"if",source:"(10:4) {#if rank <= 3}",ctx:t}),i}function Ma(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A,j,D,L,F,V=t[0].song_info.name+"",K=t[0].song_info.singer+"",Y=t[0].play_num+"",J=t[0].max_score+"";const Q=[Ra,Ta],X=[];function Z(t,e){return t[1]<=3?0:1}n=Z(t),i=X[n]=Q[n](t),j=new ye({props:{class:"arrow",src:"https://dynamics-share.tuwan.com/activity/e8abcbe41c633d04a62d500212798cac.png"},$$inline:!0});const tt={c:function(){e=_("div"),i.c(),o=T(),s=_("div"),a=_("p"),r=M("《"),c=M(V),l=M("》-"),d=M(K),m=T(),h=_("p"),u=M("演唱"),g=M(Y),f=M("次"),w=T(),v=_("div"),$=_("p"),k=M(J),S=T(),R=_("p"),R.textContent="分",A=T(),U(j.$$.fragment),y(a,"class","name s-AxVDTuFbk30O"),x(a,Sa,15,8,465),y(h,"class","desc s-AxVDTuFbk30O"),x(h,Sa,16,8,541),y(s,"class","info s-AxVDTuFbk30O"),x(s,Sa,14,4,438),y($,"class","score s-AxVDTuFbk30O"),x($,Sa,19,8,630),y(R,"class","unit s-AxVDTuFbk30O"),x(R,Sa,20,8,676),y(v,"class","flex flex-ac"),x(v,Sa,18,4,595),y(e,"class","ktv-table_cell_style2 s-AxVDTuFbk30O"),rt(e,"top3",t[1]<=3),x(e,Sa,8,0,141)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,p){b(i,e,p),X[n].m(e,null),I(e,o),I(e,s),I(s,a),I(a,r),I(a,c),I(a,l),I(a,d),I(s,m),I(s,h),I(h,u),I(h,g),I(h,f),I(e,w),I(e,v),I(v,$),I($,k),I(v,S),I(v,R),I(e,A),z(j,e,null),D=!0,L||(F=E(e,"click",B((function(){H(t[2].bind(null,t[0]))&&t[2].bind(null,t[0]).apply(this,arguments)})),!1,!1,!0,!1),L=!0)},p:function(s,[a]){let r=n;n=Z(t=s),n===r?X[n].p(t,a):(W(),O(X[r],1,1,(()=>{X[r]=null})),N(),i=X[n],i?i.p(t,a):(i=X[n]=Q[n](t),i.c()),q(i,1),i.m(e,o)),(!D||1&a)&&V!==(V=t[0].song_info.name+"")&&P(c,V),(!D||1&a)&&K!==(K=t[0].song_info.singer+"")&&P(d,K),(!D||1&a)&&Y!==(Y=t[0].play_num+"")&&P(g,Y),(!D||1&a)&&J!==(J=t[0].max_score+"")&&P(k,J),(!D||2&a)&&rt(e,"top3",t[1]<=3)},i:function(t){D||(q(i),q(j.$$.fragment,t),D=!0)},o:function(t){O(i),O(j.$$.fragment,t),D=!1},d:function(t){t&&C(e),X[n].d(),G(j),L=!1,F()}};return p("SvelteRegisterBlock",{block:tt,id:Ma.name,type:"component",source:"",ctx:t}),tt}function Aa(t,e,n){let{$$slots:i={},$$scope:o}=e;f("TableCellStyle2",i,[]);let{data:s}=e,{rank:a}=e,{itemClickCb:r}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<TableCellStyle2> was created without expected prop 'data'"),void 0!==a||"rank"in e||t.$$.bound[t.$$.props.rank]||console.warn("<TableCellStyle2> was created without expected prop 'rank'"),void 0!==r||"itemClickCb"in e||t.$$.bound[t.$$.props.itemClickCb]||console.warn("<TableCellStyle2> was created without expected prop 'itemClickCb'")}));const c=["data","rank","itemClickCb"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<TableCellStyle2> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank),"itemClickCb"in t&&n(2,r=t.itemClickCb)},t.$capture_state=()=>({Img:ye,data:s,rank:a,itemClickCb:r}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank),"itemClickCb"in t&&n(2,r=t.itemClickCb)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r]}class Pa extends h{constructor(t){super(t),u(this,t,Aa,Ma,g,{data:0,rank:1,itemClickCb:2}),p("SvelteRegisterComponent",{component:this,tagName:"TableCellStyle2",options:t,id:Ma.name})}get data(){throw new Error("<TableCellStyle2>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<TableCellStyle2>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get rank(){throw new Error("<TableCellStyle2>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set rank(t){throw new Error("<TableCellStyle2>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get itemClickCb(){throw new Error("<TableCellStyle2>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set itemClickCb(t){throw new Error("<TableCellStyle2>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ja="src/js/components/empty.svelte";function Da(t){let e,n,i,o,s,a,r,c;n=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/music_library_empty.png"},$$inline:!0});const l={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),s=M(t[0]),y(o,"class","s-AHLU_ocY84SA"),rt(o,"btn",t[1]),x(o,ja,14,4,316),y(e,"class","empty s-AHLU_ocY84SA"),x(e,ja,12,0,211)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(l,d){b(l,e,d),z(n,e,null),I(e,i),I(e,o),I(o,s),a=!0,r||(c=E(o,"click",B(t[2]),!1,!1,!0,!1),r=!0)},p:function(t,[e]){(!a||1&e)&&P(s,t[0]),(!a||2&e)&&rt(o,"btn",t[1])},i:function(t){a||(q(n.$$.fragment,t),a=!0)},o:function(t){O(n.$$.fragment,t),a=!1},d:function(t){t&&C(e),G(n),r=!1,c()}};return p("SvelteRegisterBlock",{block:l,id:Da.name,type:"component",source:"",ctx:t}),l}function La(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Empty",i,[]);let{desc:s="没有搜到该歌曲呢"}=e,{showBtn:a=!1}=e,{btnCb:r}=e;function c(){a&&r&&r()}t.$$.on_mount.push((function(){void 0!==r||"btnCb"in e||t.$$.bound[t.$$.props.btnCb]||console.warn("<Empty> was created without expected prop 'btnCb'")}));const l=["desc","showBtn","btnCb"];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Empty> was created with unknown prop '${t}'`)})),t.$$set=t=>{"desc"in t&&n(0,s=t.desc),"showBtn"in t&&n(1,a=t.showBtn),"btnCb"in t&&n(3,r=t.btnCb)},t.$capture_state=()=>({Img:ye,desc:s,showBtn:a,btnCb:r,descClick:c}),t.$inject_state=t=>{"desc"in t&&n(0,s=t.desc),"showBtn"in t&&n(1,a=t.showBtn),"btnCb"in t&&n(3,r=t.btnCb)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,c,r]}class Ea extends h{constructor(t){super(t),u(this,t,La,Da,g,{desc:0,showBtn:1,btnCb:3}),p("SvelteRegisterComponent",{component:this,tagName:"Empty",options:t,id:Da.name})}get desc(){throw new Error("<Empty>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set desc(t){throw new Error("<Empty>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showBtn(){throw new Error("<Empty>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showBtn(t){throw new Error("<Empty>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get btnCb(){throw new Error("<Empty>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set btnCb(t){throw new Error("<Empty>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Ba="src/js/components/menus.svelte";function Fa(t,e,n){const i=t.slice();return i[5]=e[n],i[7]=n,i}function Ua(t){let e,n,i,o,s,a=t[5]+"";const r={c:function(){e=_("p"),n=M(a),y(e,"class",i="item "+(t[1]===t[7]?"selected":"")+" s-sdIPt5uZODeT"),x(e,Ba,12,8,248)},m:function(i,a){b(i,e,a),I(e,n),o||(s=E(e,"click",(function(){H(t[2].bind(null,t[7]))&&t[2].bind(null,t[7]).apply(this,arguments)}),!1,!1,!1,!1),o=!0)},p:function(o,s){t=o,1&s&&a!==(a=t[5]+"")&&P(n,a),2&s&&i!==(i="item "+(t[1]===t[7]?"selected":"")+" s-sdIPt5uZODeT")&&y(e,"class",i)},d:function(t){t&&C(e),o=!1,s()}};return p("SvelteRegisterBlock",{block:r,id:Ua.name,type:"each",source:"(12:4) {#each data as title, index}",ctx:t}),r}function za(t){let e,n=t[0];v(n);let i=[];for(let s=0;s<n.length;s+=1)i[s]=Ua(Fa(t,n,s));const o={c:function(){e=_("div");for(let t=0;t<i.length;t+=1)i[t].c();y(e,"class","menus "+t[3]+" s-sdIPt5uZODeT"),x(e,Ba,10,0,175)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,n){b(t,e,n);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p:function(t,[o]){if(7&o){let s;for(n=t[0],v(n),s=0;s<n.length;s+=1){const a=Fa(t,n,s);i[s]?i[s].p(a,o):(i[s]=Ua(a),i[s].c(),i[s].m(e,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},i:k,o:k,d:function(t){t&&C(e),S(i,t)}};return p("SvelteRegisterBlock",{block:o,id:za.name,type:"component",source:"",ctx:t}),o}function Oa(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Menus",i,[]);let{data:s=[]}=e,{selectedIndex:a=0}=e,{changeCb:r=(()=>{})}=e;const{class:c=""}=e;return t.$$set=t=>{n(4,e=j(j({},e),D(t))),"data"in t&&n(0,s=t.data),"selectedIndex"in t&&n(1,a=t.selectedIndex),"changeCb"in t&&n(2,r=t.changeCb)},t.$capture_state=()=>({data:s,selectedIndex:a,changeCb:r,className:c}),t.$inject_state=t=>{n(4,e=j(j({},e),t)),"data"in e&&n(0,s=t.data),"selectedIndex"in e&&n(1,a=t.selectedIndex),"changeCb"in e&&n(2,r=t.changeCb)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),e=D(e),[s,a,r,c]}class Na extends h{constructor(t){super(t),u(this,t,Oa,za,g,{data:0,selectedIndex:1,changeCb:2}),p("SvelteRegisterComponent",{component:this,tagName:"Menus",options:t,id:za.name})}get data(){throw new Error("<Menus>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Menus>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get selectedIndex(){throw new Error("<Menus>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set selectedIndex(t){throw new Error("<Menus>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get changeCb(){throw new Error("<Menus>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set changeCb(t){throw new Error("<Menus>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function qa(t){let e,n,i,o,s;const a=t[5].default,r=ct(a,t,t[4],null),c={c:function(){e=_("div"),r&&r.c(),y(e,"class",n="common_scroll_view scroll_bar_"+t[0]+" "+t[2].class),x(e,"src/js/components/scrollView.svelte",15,0,398)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(n,a){b(n,e,a),r&&r.m(e,null),i=!0,o||(s=E(e,"scroll",t[1],!1,!1,!1,!1),o=!0)},p:function(t,[o]){r&&r.p&&(!i||16&o)&&lt(r,a,t,t[4],i?mt(a,t[4],o,null):dt(t[4]),null),(!i||5&o&&n!==(n="common_scroll_view scroll_bar_"+t[0]+" "+t[2].class))&&y(e,"class",n)},i:function(t){i||(q(r,t),i=!0)},o:function(t){O(r,t),i=!1},d:function(t){t&&C(e),r&&r.d(t),o=!1,s()}};return p("SvelteRegisterBlock",{block:c,id:qa.name,type:"component",source:"",ctx:t}),c}function Ga(t,e,n){let{$$slots:i={},$$scope:o}=e;f("ScrollView",i,["default"]);let{scrollBottomCb:s=null}=e,{thumbColor:a="gray"}=e;function r(){const t=window.$(this).height(),e=this.scrollHeight,n=this.scrollTop;Math.ceil(n+t)>=e&&s&&s()}return t.$$set=t=>{n(2,e=j(j({},e),D(t))),"scrollBottomCb"in t&&n(3,s=t.scrollBottomCb),"thumbColor"in t&&n(0,a=t.thumbColor),"$$scope"in t&&n(4,o=t.$$scope)},t.$capture_state=()=>({scrollBottomCb:s,thumbColor:a,scroll:r}),t.$inject_state=t=>{n(2,e=j(j({},e),t)),"scrollBottomCb"in e&&n(3,s=t.scrollBottomCb),"thumbColor"in e&&n(0,a=t.thumbColor)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),e=D(e),[a,r,e,s,o,i]}class Va extends h{constructor(t){super(t),u(this,t,Ga,qa,g,{scrollBottomCb:3,thumbColor:0}),p("SvelteRegisterComponent",{component:this,tagName:"ScrollView",options:t,id:qa.name})}get scrollBottomCb(){throw new Error("<ScrollView>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scrollBottomCb(t){throw new Error("<ScrollView>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get thumbColor(){throw new Error("<ScrollView>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set thumbColor(t){throw new Error("<ScrollView>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Ha="src/js/ktv/rankRuleModal/index.svelte";function Wa(t,e,n){const i=t.slice();return i[2]=e[n],i}function Ka(t){let e,n,i,o,s,a,r=t[2].title+"",c=t[2].desc+"";const l={c:function(){e=_("div"),n=_("p"),i=M(r),o=T(),s=_("p"),a=T(),y(n,"class","title s-7g8pDcJ0N5PJ"),x(n,Ha,42,16,1172),y(s,"class","desc s-7g8pDcJ0N5PJ"),x(s,Ha,43,16,1222),y(e,"class","block s-7g8pDcJ0N5PJ"),x(e,Ha,41,12,1136)},m:function(t,r){b(t,e,r),I(e,n),I(n,i),I(e,o),I(e,s),s.innerHTML=c,I(e,a)},p:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:l,id:Ka.name,type:"each",source:"(41:8) {#each data as item}",ctx:t}),l}function Ya(t){let e,n=t[1];v(n);let i=[];for(let s=0;s<n.length;s+=1)i[s]=Ka(Wa(t,n,s));const o={c:function(){for(let t=0;t<i.length;t+=1)i[t].c();e=ht()},m:function(t,n){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,n);b(t,e,n)},p:function(t,o){if(2&o){let s;for(n=t[1],v(n),s=0;s<n.length;s+=1){const a=Wa(t,n,s);i[s]?i[s].p(a,o):(i[s]=Ka(a),i[s].c(),i[s].m(e.parentNode,e))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d:function(t){S(i,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Ya.name,type:"slot",source:'(40:4) <ScrollView thumbColor=\\"white_purple\\">',ctx:t}),o}function Ja(t){let e,n,i,o,s,a,r,c,l;o=new ye({props:{class:"back",src:"https://dynamics-share.tuwan.com/activity/e8e5e069ad8884dba3734e1dcfc0c390.png"},$$inline:!0}),o.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)})),a=new Va({props:{thumbColor:"white_purple",$$slots:{default:[Ya]},$$scope:{ctx:t}},$$inline:!0});const d={c:function(){e=_("div"),n=_("p"),n.textContent="榜单说明",i=T(),U(o.$$.fragment),s=T(),U(a.$$.fragment),r=T(),c=_("div"),y(n,"class","title s-7g8pDcJ0N5PJ"),x(n,Ha,37,4,901),A(c,"height","20px"),x(c,Ha,47,4,1317),y(e,"class","rank_rule_modal flex flex-dir-col s-7g8pDcJ0N5PJ"),x(e,Ha,36,0,849)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,d){b(t,e,d),I(e,n),I(e,i),z(o,e,null),I(e,s),z(a,e,null),I(e,r),I(e,c),l=!0},p:function(e,[n]){t=e;const i={};32&n&&(i.$$scope={dirty:n,ctx:t}),a.$set(i)},i:function(t){l||(q(o.$$.fragment,t),q(a.$$.fragment,t),l=!0)},o:function(t){O(o.$$.fragment,t),O(a.$$.fragment,t),l=!1},d:function(t){t&&C(e),G(o),G(a)}};return p("SvelteRegisterBlock",{block:d,id:Ja.name,type:"component",source:"",ctx:t}),d}function Qa(t,e,n){let{$$slots:i={},$$scope:o}=e;f("RankRuleModal",i,[]);let{back:s}=e;const a=[{title:"嗨唱榜",desc:"\n                1、排序规则：</br>\n                按照该歌曲的完整演唱次数，由高至低排列；同时展示该歌曲的最佳演唱者信息及分数；</br></br>\n                2、更新规则：</br>\n                每30分钟更新同步榜单数据；\n            "},{title:"单曲榜",desc:"\n                1、进入规则：</br>\n                通过嗨唱榜单中，歌曲最后方的“>”按钮，点击后进入该歌曲的单曲排行榜；</br></br>\n                2、排序规则：</br>\n                根据每个人演唱该歌曲的分数，由高至低排列；\n            "},{title:"其他",desc:"\n                1、需要打开“评分”功能，才能计入榜单排名；</br>\n                2、每日0点更新当日榜单（0点后演唱完成的歌曲不计\n                入今日榜单排名）；\n            "}];t.$$.on_mount.push((function(){void 0!==s||"back"in e||t.$$.bound[t.$$.props.back]||console.warn("<RankRuleModal> was created without expected prop 'back'")}));const r=["back"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<RankRuleModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"back"in t&&n(0,s=t.back)},t.$capture_state=()=>({ScrollView:Va,Img:ye,back:s,data:a}),t.$inject_state=t=>{"back"in t&&n(0,s=t.back)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a]}class Xa extends h{constructor(t){super(t),u(this,t,Qa,Ja,g,{back:0}),p("SvelteRegisterComponent",{component:this,tagName:"RankRuleModal",options:t,id:Ja.name})}get back(){throw new Error("<RankRuleModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set back(t){throw new Error("<RankRuleModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Za="yesterday",tr="today",er="god",nr="mine",ir="src/js/ktv/rankModal/index.svelte";function or(t,e,n){const i=t.slice();return i[11]=e[n],i[13]=n,i}function sr(t){let e,n,i,o;const s=[rr,ar],a=[];function r(t,e){return t[3].length>0?0:1}e=r(t),n=a[e]=s[e](t);const c={c:function(){n.c(),i=ht()},m:function(t,n){a[e].m(t,n),b(t,i,n),o=!0},p:function(t,o){let c=e;e=r(t),e===c?a[e].p(t,o):(W(),O(a[c],1,1,(()=>{a[c]=null})),N(),n=a[e],n?n.p(t,o):(n=a[e]=s[e](t),n.c()),q(n,1),n.m(i.parentNode,i))},i:function(t){o||(q(n),o=!0)},o:function(t){O(n),o=!1},d:function(t){a[e].d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:c,id:sr.name,type:"if",source:"(75:8) {#if renderList}",ctx:t}),c}function ar(t){let e,n;e=new Ea({props:{desc:"暂无数据"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:ar.name,type:"else",source:"(86:12) {:else}",ctx:t}),i}function rr(t){let e,n;e=new Va({props:{class:"musics",thumbColor:"white_purple",$$slots:{default:[mr]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};16394&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:rr.name,type:"if",source:"(76:12) {#if renderList.length > 0}",ctx:t}),i}function cr(t){let e,n;e=new Ia({props:{data:t[11],rank:t[13]+1,itemClickCb:t[6]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};8&n&&(i.data=t[11]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:cr.name,type:"else",source:"(81:24) {:else}",ctx:t}),i}function lr(t){let e,n;e=new Pa({props:{data:t[11],rank:t[13]+1,itemClickCb:t[6]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};8&n&&(i.data=t[11]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:lr.name,type:"if",source:"(79:24) {#if category[categoryIndex].type == HI_CATEGORY_MINE}",ctx:t}),i}function dr(t){let e,n,i,o;const s=[lr,cr],a=[];function r(t,e){return t[4][t[1]].type==nr?0:1}e=r(t),n=a[e]=s[e](t);const c={c:function(){n.c(),i=ht()},m:function(t,n){a[e].m(t,n),b(t,i,n),o=!0},p:function(t,o){let c=e;e=r(t),e===c?a[e].p(t,o):(W(),O(a[c],1,1,(()=>{a[c]=null})),N(),n=a[e],n?n.p(t,o):(n=a[e]=s[e](t),n.c()),q(n,1),n.m(i.parentNode,i))},i:function(t){o||(q(n),o=!0)},o:function(t){O(n),o=!1},d:function(t){a[e].d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:c,id:dr.name,type:"each",source:"(78:20) {#each renderList as item, index}",ctx:t}),c}function mr(t){let e,n,i=t[3];v(i);let o=[];for(let r=0;r<i.length;r+=1)o[r]=dr(or(t,i,r));const s=t=>O(o[t],1,1,(()=>{o[t]=null})),a={c:function(){for(let t=0;t<o.length;t+=1)o[t].c();e=ht()},m:function(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);b(t,e,i),n=!0},p:function(t,n){if(90&n){let a;for(i=t[3],v(i),a=0;a<i.length;a+=1){const s=or(t,i,a);o[a]?(o[a].p(s,n),q(o[a],1)):(o[a]=dr(s),o[a].c(),q(o[a],1),o[a].m(e.parentNode,e))}for(W(),a=i.length;a<o.length;a+=1)s(a);N()}},i:function(t){if(!n){for(let t=0;t<i.length;t+=1)q(o[t]);n=!0}},o:function(t){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)O(o[e]);n=!1},d:function(t){S(o,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:a,id:mr.name,type:"slot",source:'(77:16) <ScrollView class=\\"musics\\" thumbColor=\\"white_purple\\">',ctx:t}),a}function hr(t){let e,n;e=new Xa({props:{back:t[9]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.back=t[9]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:hr.name,type:"if",source:"(90:8) {#if showRule}",ctx:t}),i}function ur(t){let e,n,i,o,s,a,r,c,l,d,m,h,u;i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_white.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)})),c=new ye({props:{src:"https://dynamics-share.tuwan.com/activity/3f68398b45d393888c3f8b314bb04f52.png"},$$inline:!0}),c.$on("click",t[7]),d=new Na({props:{class:"categroy",data:t[4].map(pr),selectedIndex:t[1],changeCb:t[5]},$$inline:!0});let g=t[3]&&sr(t),f=t[2]&&hr(t);const w={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("div"),a=_("p"),a.textContent="嗨唱榜",r=T(),U(c.$$.fragment),l=T(),U(d.$$.fragment),m=T(),g&&g.c(),h=T(),f&&f.c(),y(a,"class","s-RueMvXBOVFjX"),x(a,ir,70,12,2258),y(s,"class","title_con s-RueMvXBOVFjX"),x(s,ir,69,8,2222),y(n,"class","body s-RueMvXBOVFjX"),x(n,ir,67,4,2078),y(e,"class","ktv_rank_modal s-RueMvXBOVFjX"),x(e,ir,66,0,2045)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,p){b(t,e,p),I(e,n),z(i,n,null),I(n,o),I(n,s),I(s,a),I(s,r),z(c,s,null),I(n,l),z(d,n,null),I(n,m),g&&g.m(n,null),I(n,h),f&&f.m(n,null),u=!0},p:function(e,[i]){t=e;const o={};2&i&&(o.selectedIndex=t[1]),d.$set(o),t[3]?g?(g.p(t,i),8&i&&q(g,1)):(g=sr(t),g.c(),q(g,1),g.m(n,h)):g&&(W(),O(g,1,1,(()=>{g=null})),N()),t[2]?f?(f.p(t,i),4&i&&q(f,1)):(f=hr(t),f.c(),q(f,1),f.m(n,null)):f&&(W(),O(f,1,1,(()=>{f=null})),N())},i:function(t){u||(q(i.$$.fragment,t),q(c.$$.fragment,t),q(d.$$.fragment,t),q(g),q(f),u=!0)},o:function(t){O(i.$$.fragment,t),O(c.$$.fragment,t),O(d.$$.fragment,t),O(g),O(f),u=!1},d:function(t){t&&C(e),G(i),G(c),G(d),g&&g.d(),f&&f.d()}};return p("SvelteRegisterBlock",{block:w,id:ur.name,type:"component",source:"",ctx:t}),w}const pr=t=>t.name;function gr(t,e,n){let i,{$$slots:o={},$$scope:s}=e;f("RankModal",o,[]);let{closeModal:a}=e,r=[{name:"昨天",type:Za,url:Ot.getKtvYesterdaySongRank},{name:"今天",type:tr,url:Ot.getKtvTodaySongRank},{name:"热门",type:er,url:Ot.getKtvGodSongRank},{name:"我的",type:nr,url:Ot.getKtvMineSongRank}],c=1,l=t=>n(1,c=t),d=!1,m={[Za]:null,[tr]:null,[er]:null,[nr]:null};function h(t){qt.get(r[t].url(uu.getCid())).then((e=>{0==e.error?n(8,m[r[t].type]=e.data.list||[],m):Vt(e.error_msg)}))}function u(t){ad.getInstance().showSongRankModal({data:t.song_info})}function p(){n(2,d=!0)}t.$$.on_mount.push((function(){void 0!==a||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<RankModal> was created without expected prop 'closeModal'")}));const g=["closeModal"];Object.keys(e).forEach((t=>{~g.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<RankModal> was created with unknown prop '${t}'`)}));return t.$$set=t=>{"closeModal"in t&&n(0,a=t.closeModal)},t.$capture_state=()=>({onMount:w,ItemStyle1:Ia,ItemStyle2:Pa,Empty:Ea,Img:ye,Menus:Na,ScrollView:Va,Rule:Xa,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,HI_CATEGORY_YESTERDAY:Za,HI_CATEGORY_TODAY:tr,HI_CATEGORY_GOD:er,HI_CATEGORY_MINE:nr,Ktv:ad,closeModal:a,category:r,categoryIndex:c,categoryChange:l,showRule:d,songMap:m,requestRankList:h,itemClick:u,ruleClick:p,renderList:i}),t.$inject_state=t=>{"closeModal"in t&&n(0,a=t.closeModal),"category"in t&&n(4,r=t.category),"categoryIndex"in t&&n(1,c=t.categoryIndex),"categoryChange"in t&&n(5,l=t.categoryChange),"showRule"in t&&n(2,d=t.showRule),"songMap"in t&&n(8,m=t.songMap),"renderList"in t&&n(3,i=t.renderList)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{2&t.$$.dirty&&h(c),258&t.$$.dirty&&n(3,i=m[r[c].type])},[a,c,d,i,r,l,u,p,m,()=>{n(2,d=!1)}]}let fr=class extends h{constructor(t){super(t),u(this,t,gr,ur,g,{closeModal:0}),p("SvelteRegisterComponent",{component:this,tagName:"RankModal",options:t,id:ur.name})}get closeModal(){throw new Error("<RankModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<RankModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const wr="src/js/ktv/songRankModal/item.svelte";function vr(t){let e,n;const i={c:function(){e=_("p"),n=M(t[1]),y(e,"class","no_p s-VWdkNevnyoaK"),x(e,wr,11,8,314)},m:function(t,i){b(t,e,i),I(e,n)},p:function(t,e){2&e&&P(n,t[1])},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:vr.name,type:"else",source:"(11:4) {:else}",ctx:t}),i}function _r(t){let e,n;e=new ye({props:{class:"no_img",src:"https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.src="https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[1]+".png"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:_r.name,type:"if",source:"(9:4) {#if rank <= 3}",ctx:t}),i}function yr(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v=t[0].user_info.nickname+"",$=t[0].max_score+"";const k=[_r,vr],S=[];function R(t,e){return t[1]<=3?0:1}n=R(t),i=S[n]=k[n](t),s=new ye({props:{class:"head",src:t[0].user_info.avatar},$$inline:!0});const A={c:function(){e=_("div"),i.c(),o=T(),U(s.$$.fragment),a=T(),r=_("div"),c=_("p"),l=M(v),d=T(),m=_("div"),h=_("p"),u=M($),g=T(),f=_("p"),f.textContent="分",y(c,"class","name s-VWdkNevnyoaK"),x(c,wr,15,8,434),y(r,"class","info s-VWdkNevnyoaK"),x(r,wr,14,4,407),y(h,"class","score s-VWdkNevnyoaK"),x(h,wr,18,8,530),y(f,"class","unit s-VWdkNevnyoaK"),x(f,wr,19,8,576),y(m,"class","flex flex-ac"),x(m,wr,17,4,495),y(e,"class","ktv-table_cell_style2 s-VWdkNevnyoaK"),rt(e,"top3",t[1]<=3),x(e,wr,7,0,114)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){b(t,e,i),S[n].m(e,null),I(e,o),z(s,e,null),I(e,a),I(e,r),I(r,c),I(c,l),I(e,d),I(e,m),I(m,h),I(h,u),I(m,g),I(m,f),w=!0},p:function(t,[a]){let r=n;n=R(t),n===r?S[n].p(t,a):(W(),O(S[r],1,1,(()=>{S[r]=null})),N(),i=S[n],i?i.p(t,a):(i=S[n]=k[n](t),i.c()),q(i,1),i.m(e,o));const c={};1&a&&(c.src=t[0].user_info.avatar),s.$set(c),(!w||1&a)&&v!==(v=t[0].user_info.nickname+"")&&P(l,v),(!w||1&a)&&$!==($=t[0].max_score+"")&&P(u,$),(!w||2&a)&&rt(e,"top3",t[1]<=3)},i:function(t){w||(q(i),q(s.$$.fragment,t),w=!0)},o:function(t){O(i),O(s.$$.fragment,t),w=!1},d:function(t){t&&C(e),S[n].d(),G(s)}};return p("SvelteRegisterBlock",{block:A,id:yr.name,type:"component",source:"",ctx:t}),A}function xr(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Item",i,[]);let{data:s}=e,{rank:a}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Item> was created without expected prop 'data'"),void 0!==a||"rank"in e||t.$$.bound[t.$$.props.rank]||console.warn("<Item> was created without expected prop 'rank'")}));const r=["data","rank"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Item> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank)},t.$capture_state=()=>({Img:ye,data:s,rank:a}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"rank"in t&&n(1,a=t.rank)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a]}let br=class extends h{constructor(t){super(t),u(this,t,xr,yr,g,{data:0,rank:1}),p("SvelteRegisterComponent",{component:this,tagName:"Item",options:t,id:yr.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get rank(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set rank(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const $r="src/js/ktv/songRankModal/index.svelte";function kr(t,e,n){const i=t.slice();return i[3]=e[n],i[5]=n,i}function Cr(t){let e,n,i,o;const s=[Sr,Ir],a=[];function r(t,e){return t[2].length>0?0:1}e=r(t),n=a[e]=s[e](t);const c={c:function(){n.c(),i=ht()},m:function(t,n){a[e].m(t,n),b(t,i,n),o=!0},p:function(t,o){let c=e;e=r(t),e===c?a[e].p(t,o):(W(),O(a[c],1,1,(()=>{a[c]=null})),N(),n=a[e],n?n.p(t,o):(n=a[e]=s[e](t),n.c()),q(n,1),n.m(i.parentNode,i))},i:function(t){o||(q(n),o=!0)},o:function(t){O(n),o=!1},d:function(t){a[e].d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:c,id:Cr.name,type:"if",source:"(36:8) {#if renderList}",ctx:t}),c}function Ir(t){let e,n;e=new Ea({props:{desc:"暂无数据"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Ir.name,type:"else",source:"(43:12) {:else}",ctx:t}),i}function Sr(t){let e,n;e=new Va({props:{class:"musics",thumbColor:"white_purple",$$slots:{default:[Rr]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};68&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Sr.name,type:"if",source:"(37:12) {#if renderList.length > 0}",ctx:t}),i}function Tr(t){let e,n;e=new br({props:{data:t[3],rank:t[5]+1},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.data=t[3]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Tr.name,type:"each",source:"(39:20) {#each renderList as item, index}",ctx:t}),i}function Rr(t){let e,n,i=t[2];v(i);let o=[];for(let r=0;r<i.length;r+=1)o[r]=Tr(kr(t,i,r));const s=t=>O(o[t],1,1,(()=>{o[t]=null})),a={c:function(){for(let t=0;t<o.length;t+=1)o[t].c();e=ht()},m:function(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);b(t,e,i),n=!0},p:function(t,n){if(4&n){let a;for(i=t[2],v(i),a=0;a<i.length;a+=1){const s=kr(t,i,a);o[a]?(o[a].p(s,n),q(o[a],1)):(o[a]=Tr(s),o[a].c(),q(o[a],1),o[a].m(e.parentNode,e))}for(W(),a=i.length;a<o.length;a+=1)s(a);N()}},i:function(t){if(!n){for(let t=0;t<i.length;t+=1)q(o[t]);n=!0}},o:function(t){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)O(o[e]);n=!1},d:function(t){S(o,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:a,id:Rr.name,type:"slot",source:'(38:16) <ScrollView class=\\"musics\\" thumbColor=\\"white_purple\\">',ctx:t}),a}function Mr(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g=t[1].name+"",f=t[1].singer+"";i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_white.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let w=t[2]&&Cr(t);const v={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),s.textContent="单曲榜",a=T(),r=_("p"),c=M("《"),l=M(g),d=M("》-"),m=M(f),h=T(),w&&w.c(),y(s,"class","title s-1na_uYLt7ogK"),x(s,$r,33,8,978),y(r,"class","name s-1na_uYLt7ogK"),x(r,$r,34,8,1011),y(n,"class","body s-1na_uYLt7ogK"),x(n,$r,31,4,834),y(e,"class","ktv_song_rank_modal s-1na_uYLt7ogK"),x(e,$r,30,0,796)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,p){b(t,e,p),I(e,n),z(i,n,null),I(n,o),I(n,s),I(n,a),I(n,r),I(r,c),I(r,l),I(r,d),I(r,m),I(n,h),w&&w.m(n,null),u=!0},p:function(e,[i]){t=e,(!u||2&i)&&g!==(g=t[1].name+"")&&P(l,g),(!u||2&i)&&f!==(f=t[1].singer+"")&&P(m,f),t[2]?w?(w.p(t,i),4&i&&q(w,1)):(w=Cr(t),w.c(),q(w,1),w.m(n,null)):w&&(W(),O(w,1,1,(()=>{w=null})),N())},i:function(t){u||(q(i.$$.fragment,t),q(w),u=!0)},o:function(t){O(i.$$.fragment,t),O(w),u=!1},d:function(t){t&&C(e),G(i),w&&w.d()}};return p("SvelteRegisterBlock",{block:v,id:Mr.name,type:"component",source:"",ctx:t}),v}function Ar(t,e,n){let{$$slots:i={},$$scope:o}=e;f("SongRankModal",i,[]);let{closeModal:s}=e,{data:a}=e;w((()=>{qt.get(Ot.getKtvSingSongRank(uu.getCid(),a.song_code)).then((t=>{0==t.error?n(2,r=t.data.list):Vt(t.error_msg)}))}));let r=null;t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<SongRankModal> was created without expected prop 'closeModal'"),void 0!==a||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<SongRankModal> was created without expected prop 'data'")}));const c=["closeModal","data"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<SongRankModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"data"in t&&n(1,a=t.data)},t.$capture_state=()=>({onMount:w,Item:br,Empty:Ea,Img:ye,ScrollView:Va,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,closeModal:s,data:a,renderList:r}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"data"in t&&n(1,a=t.data),"renderList"in t&&n(2,r=t.renderList)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r]}class Pr extends h{constructor(t){super(t),u(this,t,Ar,Mr,g,{closeModal:0,data:1}),p("SvelteRegisterComponent",{component:this,tagName:"SongRankModal",options:t,id:Mr.name})}get closeModal(){throw new Error("<SongRankModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<SongRankModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<SongRankModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<SongRankModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const jr="src/js/components/marquee.svelte";function Dr(t){let e,n;const i={c:function(){e=_("p"),n=M(t[0]),y(e,"class","s-EjHMeFXCf5oN"),x(e,jr,31,12,871)},m:function(t,i){b(t,e,i),I(e,n)},p:function(t,e){1&e&&P(n,t[0])},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:Dr.name,type:"if",source:"(31:8) {#if loop && canloop}",ctx:t}),i}function Lr(t){let e,n,i,o,s,a=t[1]&&t[5]&&Dr(t);const r={c:function(){e=_("div"),n=_("div"),i=_("p"),o=M(t[0]),s=T(),a&&a.c(),y(i,"class","s-EjHMeFXCf5oN"),x(i,jr,29,8,815),y(n,"class","container flex s-EjHMeFXCf5oN"),y(n,"style",t[4]),rt(n,"loop",t[1]&&t[5]),x(n,jr,28,4,721),y(e,"class","marquee flex "+t[6]+" s-EjHMeFXCf5oN"),x(e,jr,27,0,653)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(r,c){b(r,e,c),I(e,n),I(n,i),I(i,o),I(n,s),a&&a.m(n,null),t[8](n),t[9](e)},p:function(t,[e]){1&e&&P(o,t[0]),t[1]&&t[5]?a?a.p(t,e):(a=Dr(t),a.c(),a.m(n,null)):a&&(a.d(1),a=null),16&e&&y(n,"style",t[4]),34&e&&rt(n,"loop",t[1]&&t[5])},i:k,o:k,d:function(n){n&&C(e),a&&a.d(),t[8](null),t[9](null)}};return p("SvelteRegisterBlock",{block:r,id:Lr.name,type:"component",source:"",ctx:t}),r}function Er(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Marquee",i,[]);let s,a,{text:r=""}=e,{rate:c=1}=e,{loop:l=!0}=e,d="",m=!1;const{class:h=""}=e;return t.$$set=t=>{n(10,e=j(j({},e),D(t))),"text"in t&&n(0,r=t.text),"rate"in t&&n(7,c=t.rate),"loop"in t&&n(1,l=t.loop)},t.$capture_state=()=>({text:r,rate:c,loop:l,style:d,textRef:s,containerRef:a,canloop:m,className:h}),t.$inject_state=t=>{n(10,e=j(j({},e),t)),"text"in e&&n(0,r=t.text),"rate"in e&&n(7,c=t.rate),"loop"in e&&n(1,l=t.loop),"style"in e&&n(4,d=t.style),"textRef"in e&&n(2,s=t.textRef),"containerRef"in e&&n(3,a=t.containerRef),"canloop"in e&&n(5,m=t.canloop)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{143&t.$$.dirty&&r&&s&&l&&a&&setTimeout((()=>{s.clientWidth>a.clientWidth&&(n(5,m=!0),n(4,d=`animation-duration: ${2*s.clientWidth/100*2*c}s`))}),0)},e=D(e),[r,l,s,a,d,m,h,c,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(2,s)}))},function(t){Y[t?"unshift":"push"]((()=>{a=t,n(3,a)}))}]}class Br extends h{constructor(t){super(t),u(this,t,Er,Lr,g,{text:0,rate:7,loop:1}),p("SvelteRegisterComponent",{component:this,tagName:"Marquee",options:t,id:Lr.name})}get text(){throw new Error("<Marquee>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set text(t){throw new Error("<Marquee>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get rate(){throw new Error("<Marquee>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set rate(t){throw new Error("<Marquee>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get loop(){throw new Error("<Marquee>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set loop(t){throw new Error("<Marquee>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Fr=2,Ur="src/js/ktv/muiscInfo/index.svelte";function zr(t){let e,n,i,o,s,a,r,c,l,d;n=new Br({props:{text:t[0],loop:t[0]!=Or},$$inline:!0});const m={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("div"),s=_("p"),a=M(t[1]),r=T(),c=_("p"),l=M(t[2]),y(s,"class","s-wbgnqEzeq8oo"),x(s,Ur,79,8,2327),y(c,"class","s-wbgnqEzeq8oo"),x(c,Ur,80,8,2355),y(o,"class","status flex flex-ac flex-between"),x(o,Ur,78,4,2272),y(e,"class","music_info s-wbgnqEzeq8oo"),x(e,Ur,75,0,2186)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,m){b(t,e,m),z(n,e,null),I(e,i),I(e,o),I(o,s),I(s,a),I(o,r),I(o,c),I(c,l),d=!0},p:function(t,[e]){const i={};1&e&&(i.text=t[0]),1&e&&(i.loop=t[0]!=Or),n.$set(i),(!d||2&e)&&P(a,t[1]),(!d||4&e)&&P(l,t[2])},i:function(t){d||(q(n.$$.fragment,t),d=!0)},o:function(t){O(n.$$.fragment,t),d=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:m,id:zr.name,type:"component",source:"",ctx:t}),m}const Or="等待您的演唱";function Nr(t){return String(parseInt(String(t/60))).padStart(2,"0")+":"+String(t%60).padStart(2,"0")}function qr(t,e,n){let i,{$$slots:o={},$$scope:s}=e;function a(){n(5,l+=1)}f("MuiscInfo",o,[]);let{seconds:r=0}=e;const c=ad.getInstance();let l=0,d=Or,m="原唱",h=0;function u(t){c.actInfo&&c.actInfo.song_info?n(0,d=c.actInfo.song_info.name+"-演唱者："+c.actInfo.song_info.nickname):n(0,d=Or),!c.getAnchorKengUser(uu.getMeid())&&c.actInfo&&c.actInfo.song_info?c.actInfo&&c.actInfo.song_info&&n(1,m=1==c.actInfo.song_info.original_switch?"原唱":"伴奏"):c.actInfo&&n(1,m=1==c.controlData.original_switch?"原唱":"伴奏"),p(h)}function p(t){var e;if(c.actInfo&&c.actInfo.stage==Fr)if(0==t){const{duration:t,progress:e=0}=c.actInfo.song_info;n(6,h=t-parseInt(String(e/1e3),10))}else n(6,h=t);else(null==(e=c.actInfo)?void 0:e.song_info)?n(6,h=c.actInfo.song_info.duration||0):n(6,h=0)}const g=["seconds"];return Object.keys(e).forEach((t=>{~g.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MuiscInfo> was created with unknown prop '${t}'`)})),t.$$set=t=>{"seconds"in t&&n(4,r=t.seconds)},t.$capture_state=()=>({Marquee:Br,ACT_STAGE_PLAYING:Fr,common:uu,Ktv:ad,forceUpdate:a,seconds:r,instance:c,WAIT_NAME:Or,forceUpdateIndex:l,name:d,originName:m,realSeconds:h,update:u,updateTime:p,formatTime:Nr,textTime:i}),t.$inject_state=t=>{"seconds"in t&&n(4,r=t.seconds),"forceUpdateIndex"in t&&n(5,l=t.forceUpdateIndex),"name"in t&&n(0,d=t.name),"originName"in t&&n(1,m=t.originName),"realSeconds"in t&&n(6,h=t.realSeconds),"textTime"in t&&n(2,i=t.textTime)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{32&t.$$.dirty&&u(),16&t.$$.dirty&&p(r),64&t.$$.dirty&&n(2,i=Nr(h))},[d,m,i,a,r,l,h]}class Gr extends h{constructor(t){super(t),u(this,t,qr,zr,g,{forceUpdate:3,seconds:4}),p("SvelteRegisterComponent",{component:this,tagName:"MuiscInfo",options:t,id:zr.name})}get forceUpdate(){return this.$$.ctx[3]}set forceUpdate(t){throw new Error("<MuiscInfo>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get seconds(){throw new Error("<MuiscInfo>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set seconds(t){throw new Error("<MuiscInfo>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Vr="src/js/ktv/hiRankBtn/index.svelte";function Hr(t){let e,n,i,o,s,a,r;o=new ye({props:{src:"https://dynamics-share.tuwan.com/activity/05cd8263af2f2dfab738ee8375a326ac.png"},$$inline:!0});const c={c:function(){e=_("div"),n=_("p"),n.textContent="嗨唱榜",i=T(),U(o.$$.fragment),y(n,"class","s-TnUk6owAqHyz"),x(n,Vr,12,4,262),y(e,"class","hi-btn flex flex-ac flex-jc s-TnUk6owAqHyz"),x(e,Vr,11,0,199)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,l){b(c,e,l),I(e,n),I(e,i),z(o,e,null),s=!0,a||(r=E(e,"click",t[0],!1,!1,!1,!1),a=!0)},p:k,i:function(t){s||(q(o.$$.fragment,t),s=!0)},o:function(t){O(o.$$.fragment,t),s=!1},d:function(t){t&&C(e),G(o),a=!1,r()}};return p("SvelteRegisterBlock",{block:c,id:Hr.name,type:"component",source:"",ctx:t}),c}function Wr(t,e,n){let{$$slots:i={},$$scope:o}=e;f("HiRankBtn",i,[]);const s=ad.getInstance();function a(){s.showRankModal()}const r=[];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<HiRankBtn> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({Ktv:ad,Img:ye,instance:s,click:a}),[a]}class Kr extends h{constructor(t){super(t),u(this,t,Wr,Hr,g,{}),p("SvelteRegisterComponent",{component:this,tagName:"HiRankBtn",options:t,id:Hr.name})}}const Yr="src/js/ktv/controlModule/index.svelte";function Jr(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A,j;o=new ye({props:{class:"logo",src:"https://dynamics-share.tuwan.com/activity/215eaa06df9644f390aff05be956b410.png"},$$inline:!0}),m=new ye({props:{class:"arrow",src:"https://dynamics-share.tuwan.com/activity/f0c920d486a2f7cc9507bfd4b69f055a.png"},$$inline:!0}),$=new ye({props:{class:"adjust",src:"https://dynamics-share.tuwan.com/activity/98decdda8b476a72aa7bd558b3811505.png"},$$inline:!0}),$.$on("click",t[2]),S=new ye({props:{class:"choose",src:"https://dynamics-share.tuwan.com/activity/c1a280d1c966321197c46d0f57c79c62.png"},$$inline:!0}),S.$on("click",t[3]);const D={c:function(){e=_("div"),n=_("div"),i=_("div"),U(o.$$.fragment),s=T(),a=_("p"),r=M("已点（"),c=M(t[0]),l=M("）"),d=T(),U(m.$$.fragment),h=T(),u=_("p"),g=M("下一首："),f=M(t[1]),w=T(),v=_("div"),U($.$$.fragment),k=T(),U(S.$$.fragment),y(a,"class","s-cHnt28gVJqVn"),x(a,Yr,46,12,1227),y(i,"class","choice-musics flex flex-ac s-cHnt28gVJqVn"),x(i,Yr,44,8,1010),y(u,"class","music-name s-cHnt28gVJqVn"),x(u,Yr,49,8,1393),x(n,Yr,43,4,996),y(v,"class","control flex flex-ac s-cHnt28gVJqVn"),x(v,Yr,51,4,1450),y(e,"class","control-module flex flex-ac flex-between s-cHnt28gVJqVn"),x(e,Yr,42,0,937)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(p,_){b(p,e,_),I(e,n),I(n,i),z(o,i,null),I(i,s),I(i,a),I(a,r),I(a,c),I(a,l),I(i,d),z(m,i,null),I(n,h),I(n,u),I(u,g),I(u,f),I(e,w),I(e,v),z($,v,null),I(v,k),z(S,v,null),R=!0,A||(j=E(i,"click",B(t[4]),!1,!1,!0,!1),A=!0)},p:function(t,[e]){(!R||1&e)&&P(c,t[0]),(!R||2&e)&&P(f,t[1])},i:function(t){R||(q(o.$$.fragment,t),q(m.$$.fragment,t),q($.$$.fragment,t),q(S.$$.fragment,t),R=!0)},o:function(t){O(o.$$.fragment,t),O(m.$$.fragment,t),O($.$$.fragment,t),O(S.$$.fragment,t),R=!1},d:function(t){t&&C(e),G(o),G(m),G($),G(S),A=!1,j()}};return p("SvelteRegisterBlock",{block:D,id:Jr.name,type:"component",source:"",ctx:t}),D}function Qr(t,e,n){let{$$slots:i={},$$scope:o}=e;function s(){n(6,a+=1)}f("ControlModule",i,[]);let a=0,r="无，快来点歌吧~";const c=ad.getInstance();function l(){c.showAdjustParamsModal()}function d(){c.showMusicLibrary()}let m=c.selectedMusicData.list.length;function h(){c.showMusicLibrary({defaultMemuIndex:1})}const u=[];return Object.keys(e).forEach((t=>{~u.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<ControlModule> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({Ktv:ad,Img:ye,forceUpdate:s,forceUpdateIndex:a,musicName:r,instance:c,adjustClick:l,libraryClick:d,selectCount:m,showSelectedLibrary:h}),t.$inject_state=t=>{"forceUpdateIndex"in t&&n(6,a=t.forceUpdateIndex),"musicName"in t&&n(1,r=t.musicName),"selectCount"in t&&n(0,m=t.selectCount)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(65&t.$$.dirty)if(n(0,m=c.selectedMusicData.list.length),m>1){const t=c.selectedMusicData.list[1];n(1,r=`《${t.name}》演唱者：${t.nickname}`)}else n(1,r="无，快来点歌吧~")},[m,r,l,d,h,s,a]}class Xr extends h{constructor(t){super(t),u(this,t,Qr,Jr,g,{forceUpdate:5}),p("SvelteRegisterComponent",{component:this,tagName:"ControlModule",options:t,id:Jr.name})}get forceUpdate(){return this.$$.ctx[5]}set forceUpdate(t){throw new Error("<ControlModule>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function Zr(t){let e,n,i;const o={c:function(){e=_("input"),y(e,"class","common_slider s-l_k4G-HM4Zw7"),y(e,"type","range"),A(e,"background-size",t[0]/t[2]*100+"% 100%"),y(e,"max",t[2]),y(e,"min",t[1]),x(e,"src/js/components/slider.svelte",6,0,94)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,s){b(o,e,s),J(e,t[0]),n||(i=[E(e,"change",t[4]),E(e,"input",t[4]),E(e,"change",t[3],!1,!1,!1,!1)],n=!0)},p:function(t,[n]){5&n&&A(e,"background-size",t[0]/t[2]*100+"% 100%"),4&n&&y(e,"max",t[2]),2&n&&y(e,"min",t[1]),1&n&&J(e,t[0])},i:k,o:k,d:function(t){t&&C(e),n=!1,V(i)}};return p("SvelteRegisterBlock",{block:o,id:Zr.name,type:"component",source:"",ctx:t}),o}function tc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Slider",i,[]);let{min:s=0}=e,{max:a=100}=e,{value:r=30}=e;const c=["min","max","value"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Slider> was created with unknown prop '${t}'`)})),t.$$set=t=>{"min"in t&&n(1,s=t.min),"max"in t&&n(2,a=t.max),"value"in t&&n(0,r=t.value)},t.$capture_state=()=>({min:s,max:a,value:r}),t.$inject_state=t=>{"min"in t&&n(1,s=t.min),"max"in t&&n(2,a=t.max),"value"in t&&n(0,r=t.value)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,s,a,function(e){F.call(this,t,e)},function(){r=Q(this.value),n(0,r)}]}class ec extends h{constructor(t){super(t),u(this,t,tc,Zr,g,{min:1,max:2,value:0}),p("SvelteRegisterComponent",{component:this,tagName:"Slider",options:t,id:Zr.name})}get min(){throw new Error("<Slider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set min(t){throw new Error("<Slider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get max(){throw new Error("<Slider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set max(t){throw new Error("<Slider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get value(){throw new Error("<Slider>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(t){throw new Error("<Slider>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function nc(t){let e,n;e=new ye({props:{class:"common_switch",src:t[0]?t[2]:t[1],style:"height: "+t[3]+"px;"},$$inline:!0}),e.$on("click",t[4]);const i={c:function(){U(e.$$.fragment)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){z(e,t,i),n=!0},p:function(t,[n]){const i={};7&n&&(i.src=t[0]?t[2]:t[1]),8&n&&(i.style="height: "+t[3]+"px;"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:nc.name,type:"component",source:"",ctx:t}),i}function ic(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Switch",i,[]);let s,{closeUrl:a="https://dynamics-share.tuwan.com/activity/89f46c850a431aa88cf0da9c2b0cbc9f.png"}=e,{openUrl:r="https://dynamics-share.tuwan.com/activity/c1d03f03aad1f27483898e7f1ea753c9.png"}=e,{open:c=!1}=e,{height:l=32}=e,{onChange:d}=e,{protectTime:m=0}=e;function h(){s?Vt("操作不要太频繁"):(s=setTimeout((()=>{s=null}),m),n(0,c=!c),d&&d(c))}t.$$.on_mount.push((function(){void 0!==d||"onChange"in e||t.$$.bound[t.$$.props.onChange]||console.warn("<Switch> was created without expected prop 'onChange'")}));const u=["closeUrl","openUrl","open","height","onChange","protectTime"];return Object.keys(e).forEach((t=>{~u.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Switch> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeUrl"in t&&n(1,a=t.closeUrl),"openUrl"in t&&n(2,r=t.openUrl),"open"in t&&n(0,c=t.open),"height"in t&&n(3,l=t.height),"onChange"in t&&n(5,d=t.onChange),"protectTime"in t&&n(6,m=t.protectTime)},t.$capture_state=()=>({Img:ye,showTips:Vt,closeUrl:a,openUrl:r,open:c,height:l,onChange:d,protectTime:m,timer:s,click:h}),t.$inject_state=t=>{"closeUrl"in t&&n(1,a=t.closeUrl),"openUrl"in t&&n(2,r=t.openUrl),"open"in t&&n(0,c=t.open),"height"in t&&n(3,l=t.height),"onChange"in t&&n(5,d=t.onChange),"protectTime"in t&&n(6,m=t.protectTime),"timer"in t&&(s=t.timer)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[c,a,r,l,h,d,m]}class oc extends h{constructor(t){super(t),u(this,t,ic,nc,g,{closeUrl:1,openUrl:2,open:0,height:3,onChange:5,protectTime:6}),p("SvelteRegisterComponent",{component:this,tagName:"Switch",options:t,id:nc.name})}get closeUrl(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeUrl(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get openUrl(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set openUrl(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get open(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set open(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get height(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set height(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get onChange(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set onChange(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get protectTime(){throw new Error("<Switch>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set protectTime(t){throw new Error("<Switch>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const sc="src/js/ktv/adjustParamsModal/index.svelte";function ac(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,M,P,j,D,L,E,B,F,N,V;function W(e){t[11](e)}i=new ye({props:{class:"close_btn",src:"https://dynamics-share.tuwan.com/activity/2fdbc88fbe01e2bb833f2ea167af3793.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)})),d=new oc({props:{height:32,open:1==t[7].controlData.original_switch,onChange:t[4],protectTime:1e3},$$inline:!0});let K={};function J(e){t[12](e)}void 0!==t[6]&&(K.value=t[6]),f=new ec({props:K,$$inline:!0}),Y.push((()=>X(f,"value",W))),f.$on("change",(function(){H(t[2])&&t[2].apply(this,arguments)}));let Q={};void 0!==t[5]&&(Q.value=t[5]),R=new ec({props:Q,$$inline:!0}),Y.push((()=>X(R,"value",J))),R.$on("change",(function(){H(t[1])&&t[1].apply(this,arguments)})),D=new ye({props:{class:"change_muisc",src:"https://dynamics-share.tuwan.com/activity/474485e542761cc5a45c5d67b56d4b42.png"},$$inline:!0}),D.$on("click",t[8]),N=new oc({props:{height:32,open:1==t[7].controlData.score_switch,onChange:t[3],protectTime:1e3},$$inline:!0});const tt={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),s.textContent="调音台",a=T(),r=_("div"),c=_("p"),c.textContent="原唱",l=T(),U(d.$$.fragment),m=T(),h=_("div"),u=_("p"),u.textContent="话筒音量",g=T(),U(f.$$.fragment),v=T(),$=_("div"),k=_("p"),k.textContent="背景音量",S=T(),U(R.$$.fragment),P=T(),j=_("div"),U(D.$$.fragment),L=T(),E=_("div"),B=_("p"),B.textContent="评分",F=T(),U(N.$$.fragment),y(s,"class","title s-5Ea4T982aXrd"),x(s,sc,57,8,1752),y(c,"class","s-5Ea4T982aXrd"),x(c,sc,59,12,1849),y(r,"class","origin_song flex flex-ac flex-between s-5Ea4T982aXrd"),x(r,sc,58,8,1785),y(u,"class","s-5Ea4T982aXrd"),x(u,sc,63,12,2051),y(h,"class","slider_container s-5Ea4T982aXrd"),x(h,sc,62,8,2008),y(k,"class","s-5Ea4T982aXrd"),x(k,sc,67,12,2200),y($,"class","slider_container s-5Ea4T982aXrd"),x($,sc,66,8,2157),y(B,"class","evaluate_score s-5Ea4T982aXrd"),x(B,sc,73,16,2571),y(E,"class","flex flex-ac"),x(E,sc,72,12,2528),y(j,"class","flex flex-ac flex-between"),A(j,"margin-top","30px"),x(j,sc,70,8,2302),y(n,"class","body s-5Ea4T982aXrd"),x(n,sc,55,4,1585),y(e,"class","adjust_params_modal s-5Ea4T982aXrd"),x(e,sc,54,0,1547)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,p){b(t,e,p),I(e,n),z(i,n,null),I(n,o),I(n,s),I(n,a),I(n,r),I(r,c),I(r,l),z(d,r,null),I(n,m),I(n,h),I(h,u),I(h,g),z(f,h,null),I(n,v),I(n,$),I($,k),I($,S),z(R,$,null),I(n,P),I(n,j),z(D,j,null),I(j,L),I(j,E),I(E,B),I(E,F),z(N,E,null),V=!0},p:function(e,[n]){t=e;const i={};16&n&&(i.onChange=t[4]),d.$set(i);const o={};!w&&64&n&&(w=!0,o.value=t[6],Z((()=>w=!1))),f.$set(o);const s={};!M&&32&n&&(M=!0,s.value=t[5],Z((()=>M=!1))),R.$set(s);const a={};8&n&&(a.onChange=t[3]),N.$set(a)},i:function(t){V||(q(i.$$.fragment,t),q(d.$$.fragment,t),q(f.$$.fragment,t),q(R.$$.fragment,t),q(D.$$.fragment,t),q(N.$$.fragment,t),V=!0)},o:function(t){O(i.$$.fragment,t),O(d.$$.fragment,t),O(f.$$.fragment,t),O(R.$$.fragment,t),O(D.$$.fragment,t),O(N.$$.fragment,t),V=!1},d:function(t){t&&C(e),G(i),G(d),G(f),G(R),G(D),G(N)}};return p("SvelteRegisterBlock",{block:tt,id:ac.name,type:"component",source:"",ctx:t}),tt}function rc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("AdjustParamsModal",i,[]);let{closeModal:s=null}=e,{bgmValue:a=40}=e,{bgmChange:r=null}=e,{localValue:c=40}=e,{localChange:l=null}=e,{scoreChange:d}=e,{originChange:m}=e,h=a,u=c;const p=ad.getInstance();function g(){var t,e;const n=(null==(e=null==(t=p.actInfo)?void 0:t.song_info)?void 0:e.order_id)||"0";p.getAnchorKengUser(uu.getMeid())?window.$.DialogByZ.Confirm({Title:"提示",Content:"确认切歌吗？",BtnL:"取消",BtnR:"确定",FunL(){window.$.DialogByZ.Close()},FunR(){window.$.DialogByZ.Close(),qt.get(Ot.getKtvChangeSong(uu.getCid(),n)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}}):Vt("需上麦才可以切掉其他人点的歌哦")}t.$$.on_mount.push((function(){void 0!==d||"scoreChange"in e||t.$$.bound[t.$$.props.scoreChange]||console.warn("<AdjustParamsModal> was created without expected prop 'scoreChange'"),void 0!==m||"originChange"in e||t.$$.bound[t.$$.props.originChange]||console.warn("<AdjustParamsModal> was created without expected prop 'originChange'")}));const w=["closeModal","bgmValue","bgmChange","localValue","localChange","scoreChange","originChange"];return Object.keys(e).forEach((t=>{~w.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<AdjustParamsModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"bgmValue"in t&&n(9,a=t.bgmValue),"bgmChange"in t&&n(1,r=t.bgmChange),"localValue"in t&&n(10,c=t.localValue),"localChange"in t&&n(2,l=t.localChange),"scoreChange"in t&&n(3,d=t.scoreChange),"originChange"in t&&n(4,m=t.originChange)},t.$capture_state=()=>({Slider:ec,Img:ye,Switch:oc,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,Ktv:ad,closeModal:s,bgmValue:a,bgmChange:r,localValue:c,localChange:l,scoreChange:d,originChange:m,_bgmValue:h,_localValue:u,instance:p,changeMuisc:g}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"bgmValue"in t&&n(9,a=t.bgmValue),"bgmChange"in t&&n(1,r=t.bgmChange),"localValue"in t&&n(10,c=t.localValue),"localChange"in t&&n(2,l=t.localChange),"scoreChange"in t&&n(3,d=t.scoreChange),"originChange"in t&&n(4,m=t.originChange),"_bgmValue"in t&&n(5,h=t._bgmValue),"_localValue"in t&&n(6,u=t._localValue)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,r,l,d,m,h,u,p,g,a,c,function(t){u=t,n(6,u)},function(t){h=t,n(5,h)}]}class cc extends h{constructor(t){super(t),u(this,t,rc,ac,g,{closeModal:0,bgmValue:9,bgmChange:1,localValue:10,localChange:2,scoreChange:3,originChange:4}),p("SvelteRegisterComponent",{component:this,tagName:"AdjustParamsModal",options:t,id:ac.name})}get closeModal(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get bgmValue(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set bgmValue(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get bgmChange(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set bgmChange(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get localValue(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set localValue(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get localChange(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set localChange(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get scoreChange(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scoreChange(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get originChange(){throw new Error("<AdjustParamsModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set originChange(t){throw new Error("<AdjustParamsModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const lc=0,dc=1,mc=3,hc="src/js/components/category.svelte";function uc(t,e,n){const i=t.slice();return i[7]=e[n],i[9]=n,i}function pc(t){let e,n;e=new ye({props:{class:"logo",src:t[7].logo},$$inline:!0}),e.$on("click",t[4].bind(null,t[9]));const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src=t[7].logo),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:pc.name,type:"if",source:"(41:20) {#if typeof item == 'object'}",ctx:t}),i}function gc(t){let e,n,i,o,s,a,r,c,l,d,m=("string"==typeof t[7]?t[7]:t[7].name)+"",h="object"==typeof t[7]&&pc(t);const u={c:function(){e=_("div"),n=_("div"),i=_("p"),o=M(m),a=T(),h&&h.c(),r=T(),y(i,"class",s="item "+(t[1]===t[9]?"selected":"")+" s-axuFUqXDI80H"),x(i,hc,39,20,1197),y(n,"class","item_con flex flex-ac"),x(n,hc,38,16,1141),y(e,"class","swiper-slide s-axuFUqXDI80H"),x(e,hc,37,12,1098)},m:function(s,m){b(s,e,m),I(e,n),I(n,i),I(i,o),I(n,a),h&&h.m(n,null),I(e,r),c=!0,l||(d=E(i,"click",B((function(){H(t[2].bind(null,t[9]))&&t[2].bind(null,t[9]).apply(this,arguments)})),!1,!1,!0,!1),l=!0)},p:function(e,a){t=e,(!c||1&a)&&m!==(m=("string"==typeof t[7]?t[7]:t[7].name)+"")&&P(o,m),(!c||2&a&&s!==(s="item "+(t[1]===t[9]?"selected":"")+" s-axuFUqXDI80H"))&&y(i,"class",s),"object"==typeof t[7]?h?(h.p(t,a),1&a&&q(h,1)):(h=pc(t),h.c(),q(h,1),h.m(n,null)):h&&(W(),O(h,1,1,(()=>{h=null})),N())},i:function(t){c||(q(h),c=!0)},o:function(t){O(h),c=!1},d:function(t){t&&C(e),h&&h.d(),l=!1,d()}};return p("SvelteRegisterBlock",{block:u,id:gc.name,type:"each",source:"(35:8) {#each data as item, index}",ctx:t}),u}function fc(t){let e,n,i,o=t[0];v(o);let s=[];for(let c=0;c<o.length;c+=1)s[c]=gc(uc(t,o,c));const a=t=>O(s[t],1,1,(()=>{s[t]=null})),r={c:function(){e=_("div"),n=_("div");for(let t=0;t<s.length;t+=1)s[t].c();y(n,"class","swiper-wrapper"),x(n,hc,33,4,819),y(e,"class","category swiper s-axuFUqXDI80H"),x(e,hc,32,0,763)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(o,a){b(o,e,a),I(e,n);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(n,null);t[6](e),i=!0},p:function(t,[e]){if(23&e){let i;for(o=t[0],v(o),i=0;i<o.length;i+=1){const a=uc(t,o,i);s[i]?(s[i].p(a,e),q(s[i],1)):(s[i]=gc(a),s[i].c(),q(s[i],1),s[i].m(n,null))}for(W(),i=o.length;i<s.length;i+=1)a(i);N()}},i:function(t){if(!i){for(let t=0;t<o.length;t+=1)q(s[t]);i=!0}},o:function(t){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)O(s[e]);i=!1},d:function(n){n&&C(e),S(s,n),t[6](null)}};return p("SvelteRegisterBlock",{block:r,id:fc.name,type:"component",source:"",ctx:t}),r}function wc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Category",i,[]);let s,{data:a=[]}=e,{selectedIndex:r=0}=e,{changeCb:c=(()=>{})}=e,{logoCb:l=(t=>{})}=e;function d(t){r==t&&l&&l(t)}w((()=>{const t=new window.Swiper(s,{direction:"horizontal",slidesPerView:"auto",freeMode:!0,mousewheel:!0,observer:!0,observeParents:!0});return()=>t.destroy()}));const m=["data","selectedIndex","changeCb","logoCb"];return Object.keys(e).forEach((t=>{~m.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Category> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,a=t.data),"selectedIndex"in t&&n(1,r=t.selectedIndex),"changeCb"in t&&n(2,c=t.changeCb),"logoCb"in t&&n(5,l=t.logoCb)},t.$capture_state=()=>({onMount:w,Img:ye,data:a,selectedIndex:r,changeCb:c,logoCb:l,swiperRef:s,logoClick:d}),t.$inject_state=t=>{"data"in t&&n(0,a=t.data),"selectedIndex"in t&&n(1,r=t.selectedIndex),"changeCb"in t&&n(2,c=t.changeCb),"logoCb"in t&&n(5,l=t.logoCb),"swiperRef"in t&&n(3,s=t.swiperRef)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,r,c,s,d,l,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(3,s)}))}]}class vc extends h{constructor(t){super(t),u(this,t,wc,fc,g,{data:0,selectedIndex:1,changeCb:2,logoCb:5}),p("SvelteRegisterComponent",{component:this,tagName:"Category",options:t,id:fc.name})}get data(){throw new Error("<Category>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Category>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get selectedIndex(){throw new Error("<Category>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set selectedIndex(t){throw new Error("<Category>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get changeCb(){throw new Error("<Category>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set changeCb(t){throw new Error("<Category>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get logoCb(){throw new Error("<Category>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set logoCb(t){throw new Error("<Category>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const _c="src/js/ktv/musicLibrary/music.svelte";function yc(t,e,n){const i=t.slice();return i[5]=e[n],i}function xc(t){let e,n;e=new ye({props:{class:"head",src:t[5].avatar},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src=t[5].avatar),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:xc.name,type:"each",source:"(18:8) {#each data._orders as item}",ctx:t}),i}function bc(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w=t[0].name+"",$=(t[2]?t[0].nickname:t[0].singer)+"";d=new ye({props:{class:"effect",src:"https://res.tuwan.com/chatroom/images/icon_song_playing.gif"},$$inline:!0});let k=t[0]._orders;v(k);let R=[];for(let p=0;p<k.length;p+=1)R[p]=xc(yc(t,k,p));const A=t=>O(R[t],1,1,(()=>{R[t]=null})),j=t[4].default,D=ct(j,t,t[3],null),L={c:function(){e=_("div"),n=_("div"),i=_("p"),o=M(w),s=T(),a=_("div"),r=_("p"),c=M($),l=T(),U(d.$$.fragment),m=T(),h=_("div");for(let t=0;t<R.length;t+=1)R[t].c();u=T(),D&&D.c(),y(i,"class","name s-YX3mfJc6K4ue"),x(i,_c,10,8,199),y(r,"class","singer s-YX3mfJc6K4ue"),x(r,_c,12,12,278),y(a,"class","flex flex-ac"),x(a,_c,11,8,239),x(n,_c,9,4,185),y(h,"class","flex flex-ac"),x(h,_c,16,4,475),y(e,"class",g="music "+t[1]+" s-YX3mfJc6K4ue"),x(e,_c,8,0,155)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,p){b(t,e,p),I(e,n),I(n,i),I(i,o),I(n,s),I(n,a),I(a,r),I(r,c),I(a,l),z(d,a,null),I(e,m),I(e,h);for(let e=0;e<R.length;e+=1)R[e]&&R[e].m(h,null);I(h,u),D&&D.m(h,null),f=!0},p:function(t,[n]){if((!f||1&n)&&w!==(w=t[0].name+"")&&P(o,w),(!f||5&n)&&$!==($=(t[2]?t[0].nickname:t[0].singer)+"")&&P(c,$),1&n){let e;for(k=t[0]._orders,v(k),e=0;e<k.length;e+=1){const i=yc(t,k,e);R[e]?(R[e].p(i,n),q(R[e],1)):(R[e]=xc(i),R[e].c(),q(R[e],1),R[e].m(h,u))}for(W(),e=k.length;e<R.length;e+=1)A(e);N()}D&&D.p&&(!f||8&n)&&lt(D,j,t,t[3],f?mt(j,t[3],n,null):dt(t[3]),null),(!f||2&n&&g!==(g="music "+t[1]+" s-YX3mfJc6K4ue"))&&y(e,"class",g)},i:function(t){if(!f){q(d.$$.fragment,t);for(let t=0;t<k.length;t+=1)q(R[t]);q(D,t),f=!0}},o:function(t){O(d.$$.fragment,t),R=R.filter(Boolean);for(let e=0;e<R.length;e+=1)O(R[e]);O(D,t),f=!1},d:function(t){t&&C(e),G(d),S(R,t),D&&D.d(t)}};return p("SvelteRegisterBlock",{block:L,id:bc.name,type:"component",source:"",ctx:t}),L}function $c(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Music",i,["default"]);let{data:s={}}=e,{cls:a=""}=e,{showNickname:r=!1}=e;const c=["data","cls","showNickname"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Music> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data),"cls"in t&&n(1,a=t.cls),"showNickname"in t&&n(2,r=t.showNickname),"$$scope"in t&&n(3,o=t.$$scope)},t.$capture_state=()=>({Img:ye,data:s,cls:a,showNickname:r}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"cls"in t&&n(1,a=t.cls),"showNickname"in t&&n(2,r=t.showNickname)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r,o,i]}let kc=class extends h{constructor(t){super(t),u(this,t,$c,bc,g,{data:0,cls:1,showNickname:2}),p("SvelteRegisterComponent",{component:this,tagName:"Music",options:t,id:bc.name})}get data(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get cls(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set cls(t){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showNickname(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showNickname(t){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const Cc="src/js/ktv/musicLibrary/musics.svelte";function Ic(t,e,n){const i=t.slice();return i[8]=e[n],i}function Sc(t){let e,n,i,o,s,a=t[8]._title+"";const r={c:function(){e=_("p"),n=M(a),y(e,"class",i="btn "+t[8]._titleCls+" s-jwlPs1PO4iYb"),x(e,Cc,72,16,2148)},m:function(i,a){b(i,e,a),I(e,n),o||(s=E(e,"click",(function(){H(t[0].bind(null,t[8]))&&t[0].bind(null,t[8]).apply(this,arguments)}),!1,!1,!1,!1),o=!0)},p:function(o,s){t=o,8&s&&a!==(a=t[8]._title+"")&&P(n,a),8&s&&i!==(i="btn "+t[8]._titleCls+" s-jwlPs1PO4iYb")&&y(e,"class",i)},i:k,o:k,d:function(t){t&&C(e),o=!1,s()}};return p("SvelteRegisterBlock",{block:r,id:Sc.name,type:"else",source:"(72:12) {:else}",ctx:t}),r}function Tc(t){let e,n;e=new ye({props:{class:"delete",src:"https://dynamics-share.tuwan.com/activity/f7e6911c13a6651b8231b206be9b9d9f.png"},$$inline:!0}),e.$on("click",(function(){H(t[0].bind(null,t[8]))&&t[0].bind(null,t[8]).apply(this,arguments)}));const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(e,n){t=e},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Tc.name,type:"if",source:"(70:12) {#if item._title == '删除'}",ctx:t}),i}function Rc(t){let e,n,i,o;const s=[Tc,Sc],a=[];function r(t,e){return"删除"==t[8]._title?0:1}e=r(t),n=a[e]=s[e](t);const c={c:function(){n.c(),i=ht()},m:function(t,n){a[e].m(t,n),b(t,i,n),o=!0},p:function(t,o){let c=e;e=r(t),e===c?a[e].p(t,o):(W(),O(a[c],1,1,(()=>{a[c]=null})),N(),n=a[e],n?n.p(t,o):(n=a[e]=s[e](t),n.c()),q(n,1),n.m(i.parentNode,i))},i:function(t){o||(q(n),o=!0)},o:function(t){O(n),o=!1},d:function(t){a[e].d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:c,id:Rc.name,type:"slot",source:"(69:8) <Music data={item} cls={item._muiscCls} showNickname={menuType == MENU_TYPE_SELECTED}>",ctx:t}),c}function Mc(t){let e,n;e=new kc({props:{data:t[8],cls:t[8]._muiscCls,showNickname:t[1]==dc,$$slots:{default:[Rc]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};8&n&&(i.data=t[8]),8&n&&(i.cls=t[8]._muiscCls),2&n&&(i.showNickname=t[1]==dc),2057&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Mc.name,type:"each",source:"(68:4) {#each realData as item}",ctx:t}),i}function Ac(t){let e;const n={c:function(){e=_("p"),e.textContent="先唱一些再点吧",y(e,"class","select_more_desc s-jwlPs1PO4iYb"),x(e,Cc,79,8,2398)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:Ac.name,type:"if",source:"(79:4) {#if menuType == MENU_TYPE_SELECTED && realData.length >= 60}",ctx:t}),n}function Pc(t){let e,n,i,o=t[3];v(o);let s=[];for(let l=0;l<o.length;l+=1)s[l]=Mc(Ic(t,o,l));const a=t=>O(s[t],1,1,(()=>{s[t]=null}));let r=t[1]==dc&&t[3].length>=60&&Ac(t);const c={c:function(){for(let t=0;t<s.length;t+=1)s[t].c();e=T(),r&&r.c(),n=ht()},m:function(t,o){for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,o);b(t,e,o),r&&r.m(t,o),b(t,n,o),i=!0},p:function(t,i){if(11&i){let n;for(o=t[3],v(o),n=0;n<o.length;n+=1){const a=Ic(t,o,n);s[n]?(s[n].p(a,i),q(s[n],1)):(s[n]=Mc(a),s[n].c(),q(s[n],1),s[n].m(e.parentNode,e))}for(W(),n=o.length;n<s.length;n+=1)a(n);N()}t[1]==dc&&t[3].length>=60?r||(r=Ac(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:function(t){if(!i){for(let t=0;t<o.length;t+=1)q(s[t]);i=!0}},o:function(t){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)O(s[e]);i=!1},d:function(t){S(s,t),t&&C(e),r&&r.d(t),t&&C(n)}};return p("SvelteRegisterBlock",{block:c,id:Pc.name,type:"slot",source:'(67:0) <ScrollView class=\\"musics\\" {scrollBottomCb}>',ctx:t}),c}function jc(t){let e,n;e=new Va({props:{class:"musics",scrollBottomCb:t[2],$$slots:{default:[Pc]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){z(e,t,i),n=!0},p:function(t,[n]){const i={};4&n&&(i.scrollBottomCb=t[2]),2059&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:jc.name,type:"component",source:"",ctx:t}),i}function Dc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Musics",i,[]);const s=ad.getInstance();let{data:a}=e,{clickMuiscCb:r}=e,{menuType:c}=e,{scrollBottomCb:l}=e;function d(){n(6,m+=1)}let m=0,h=a;t.$$.on_mount.push((function(){void 0!==a||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Musics> was created without expected prop 'data'"),void 0!==r||"clickMuiscCb"in e||t.$$.bound[t.$$.props.clickMuiscCb]||console.warn("<Musics> was created without expected prop 'clickMuiscCb'"),void 0!==c||"menuType"in e||t.$$.bound[t.$$.props.menuType]||console.warn("<Musics> was created without expected prop 'menuType'"),void 0!==l||"scrollBottomCb"in e||t.$$.bound[t.$$.props.scrollBottomCb]||console.warn("<Musics> was created without expected prop 'scrollBottomCb'")}));const u=["data","clickMuiscCb","menuType","scrollBottomCb"];return Object.keys(e).forEach((t=>{~u.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Musics> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(4,a=t.data),"clickMuiscCb"in t&&n(0,r=t.clickMuiscCb),"menuType"in t&&n(1,c=t.menuType),"scrollBottomCb"in t&&n(2,l=t.scrollBottomCb)},t.$capture_state=()=>({Music:kc,MENU_TYPE_SELECTED:dc,ORDER_TYPE_1:1,ChorusRoom:ad,ScrollView:Va,Img:ye,instance:s,data:a,clickMuiscCb:r,menuType:c,scrollBottomCb:l,forceUpdate:d,forceUpdateIndex:m,realData:h}),t.$inject_state=t=>{"data"in t&&n(4,a=t.data),"clickMuiscCb"in t&&n(0,r=t.clickMuiscCb),"menuType"in t&&n(1,c=t.menuType),"scrollBottomCb"in t&&n(2,l=t.scrollBottomCb),"forceUpdateIndex"in t&&n(6,m=t.forceUpdateIndex),"realData"in t&&n(3,h=t.realData)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{var e;if(82&t.$$.dirty){const t=null==(e=null==s?void 0:s.actInfo)?void 0:e.song_info;n(3,h=a.map((e=>{const n=!!t&&(c==dc?t.order_id==e.order_id:t.song_code==e.song_code);let i="",o="",s="";return c==dc?i="删除":1==e._order_status?(i="取消",o="disable"):i="点歌",n&&(s="playing"),e._title=i,e._titleCls=o,e._muiscCls=s,e})))}},[r,c,l,h,a,d,m]}let Lc=class extends h{constructor(t){super(t),u(this,t,Dc,jc,g,{data:4,clickMuiscCb:0,menuType:1,scrollBottomCb:2,forceUpdate:5}),p("SvelteRegisterComponent",{component:this,tagName:"Musics",options:t,id:jc.name})}get data(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clickMuiscCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set clickMuiscCb(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get menuType(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set menuType(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get scrollBottomCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scrollBottomCb(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[5]}set forceUpdate(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const Ec="src/js/components/search.svelte";function Bc(t){let e,n,i,o,s,a,r;n=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/muisc_library_search.png"},$$inline:!0});const c={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("input"),y(o,"placeholder",t[1]),y(o,"class","s-KWgYOLS3j7_9"),x(o,Ec,9,4,248),y(e,"class","search_bar s-KWgYOLS3j7_9"),x(e,Ec,7,0,137)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,l){b(c,e,l),z(n,e,null),I(e,i),I(e,o),J(o,t[0]),s=!0,a||(r=E(o,"input",t[2]),a=!0)},p:function(t,[e]){(!s||2&e)&&y(o,"placeholder",t[1]),1&e&&o.value!==t[0]&&J(o,t[0])},i:function(t){s||(q(n.$$.fragment,t),s=!0)},o:function(t){O(n.$$.fragment,t),s=!1},d:function(t){t&&C(e),G(n),a=!1,r()}};return p("SvelteRegisterBlock",{block:c,id:Bc.name,type:"component",source:"",ctx:t}),c}function Fc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Search",i,[]);let{placeholder:s="歌曲/歌手"}=e,{value:a=""}=e;const r=["placeholder","value"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Search> was created with unknown prop '${t}'`)})),t.$$set=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(0,a=t.value)},t.$capture_state=()=>({Img:ye,placeholder:s,value:a}),t.$inject_state=t=>{"placeholder"in t&&n(1,s=t.placeholder),"value"in t&&n(0,a=t.value)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,s,function(){a=this.value,n(0,a)}]}class Uc extends h{constructor(t){super(t),u(this,t,Fc,Bc,g,{placeholder:1,value:0}),p("SvelteRegisterComponent",{component:this,tagName:"Search",options:t,id:Bc.name})}get placeholder(){throw new Error("<Search>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set placeholder(t){throw new Error("<Search>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get value(){throw new Error("<Search>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(t){throw new Error("<Search>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const zc="src/js/ktv/musicLibrary/index.svelte";function Oc(t){let e,n,i,o,s;function a(e){t[17](e)}let r={};void 0!==t[2]&&(r.value=t[2]),e=new Uc({props:r,$$inline:!0}),Y.push((()=>X(e,"value",a)));let c=t[7]&&0==t[2].length&&Nc(t);const l={c:function(){U(e.$$.fragment),i=T(),c&&c.c(),o=ht()},m:function(t,n){z(e,t,n),b(t,i,n),c&&c.m(t,n),b(t,o,n),s=!0},p:function(t,i){const s={};!n&&4&i&&(n=!0,s.value=t[2],Z((()=>n=!1))),e.$set(s),t[7]&&0==t[2].length?c?(c.p(t,i),132&i&&q(c,1)):(c=Nc(t),c.c(),q(c,1),c.m(o.parentNode,o)):c&&(W(),O(c,1,1,(()=>{c=null})),N())},i:function(t){s||(q(e.$$.fragment,t),q(c),s=!0)},o:function(t){O(e.$$.fragment,t),O(c),s=!1},d:function(t){G(e,t),t&&C(i),c&&c.d(t),t&&C(o)}};return p("SvelteRegisterBlock",{block:l,id:Oc.name,type:"if",source:"(263:8) {#if menusIndex == 0}",ctx:t}),l}function Nc(t){let e,n;e=new vc({props:{data:t[7],selectedIndex:t[3],changeCb:t[9]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};128&n&&(i.data=t[7]),8&n&&(i.selectedIndex=t[3]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Nc.name,type:"if",source:"(265:12) {#if category && searchText.length == 0}",ctx:t}),i}function qc(t){let e,n;e=new Ea({props:{desc:t[2]?"没有搜到该歌曲呢":"暂无歌曲内容"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.desc=t[2]?"没有搜到该歌曲呢":"暂无歌曲内容"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:qc.name,type:"if",source:"(271:45) ",ctx:t}),i}function Gc(t){let e,n,i={menuType:t[1],data:t[5],clickMuiscCb:t[10],scrollBottomCb:t[11]};e=new Lc({props:i,$$inline:!0}),t[18](e);const o={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.menuType=t[1]),32&n&&(i.data=t[5]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[18](null),G(e,n)}};return p("SvelteRegisterBlock",{block:o,id:Gc.name,type:"if",source:"(269:8) {#if realMusicList?.length > 0}",ctx:t}),o}function Vc(t){let e,n,i,o,s,a,r,c,l,d;i=new Na({props:{data:t[4],selectedIndex:t[1],changeCb:t[8]},$$inline:!0}),s=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),s.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let m=0==t[1]&&Oc(t);const h=[Gc,qc],u=[];function g(t,e){var n,i;return(null==(n=t[5])?void 0:n.length)>0?0:0==(null==(i=t[5])?void 0:i.length)?1:-1}~(c=g(t))&&(l=u[c]=h[c](t));const f={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),U(s.$$.fragment),a=T(),m&&m.c(),r=T(),l&&l.c(),y(n,"class","body s-dnQ4nIJ6b2XU"),x(n,zc,259,4,8049),y(e,"class","music_library s-dnQ4nIJ6b2XU"),x(e,zc,258,0,8017)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,l){b(t,e,l),I(e,n),z(i,n,null),I(n,o),z(s,n,null),I(n,a),m&&m.m(n,null),I(n,r),~c&&u[c].m(n,null),d=!0},p:function(e,[o]){t=e;const s={};16&o&&(s.data=t[4]),2&o&&(s.selectedIndex=t[1]),i.$set(s),0==t[1]?m?(m.p(t,o),2&o&&q(m,1)):(m=Oc(t),m.c(),q(m,1),m.m(n,r)):m&&(W(),O(m,1,1,(()=>{m=null})),N());let a=c;c=g(t),c===a?~c&&u[c].p(t,o):(l&&(W(),O(u[a],1,1,(()=>{u[a]=null})),N()),~c?(l=u[c],l?l.p(t,o):(l=u[c]=h[c](t),l.c()),q(l,1),l.m(n,null)):l=null)},i:function(t){d||(q(i.$$.fragment,t),q(s.$$.fragment,t),q(m),q(l),d=!0)},o:function(t){O(i.$$.fragment,t),O(s.$$.fragment,t),O(m),O(l),d=!1},d:function(t){t&&C(e),G(i),G(s),m&&m.d(),~c&&u[c].d()}};return p("SvelteRegisterBlock",{block:f,id:Vc.name,type:"component",source:"",ctx:t}),f}function Hc(t,e,n){let i,{$$slots:o={},$$scope:s}=e;f("MusicLibrary",o,[]);let{defaultMemuIndex:a=0}=e,{closeModal:r}=e;function d(){const t=S(),e=[...g];e[dc]=`已选（${t.length}）`,n(4,g=e),n(15,y=l(c({},y),{[dc]:t})),n(14,m++,m)}let m=0;const h=ad.getInstance(),u=S();let p,g=["曲库",`已选（${u.length}）`],v=a,_=t=>n(1,v=t),y={[lc]:{},[dc]:u,[mc]:null},x=null,b="";function $(){qt.get(Ot.onSearchSongYinSuDa(b)).then((t=>{if(0==t.error){const e=t.data||[];n(15,y=l(c({},y),{[mc]:e}))}}))}let k=null,C=-1,I=t=>n(3,C=t);function S(){return h.selectedMusicData.list}function T(){return h.selectedMusicData.map}function R(t=v,e=!1){if(0==t)if(0==t&&-1==C);else{let i=M(t,C);if(i&&i.length>0&&0==e);else{let e=0==t&&k?k[C].sub_type:void 0,i=null!=e?y[0][String(e)]:null;qt.get(Ot.getKtvSongListWithType(uu.getCid(),t+1,e,i?i.page:void 0)).then((o=>{if(0==o.error){let s=o.data.list||[];0==t?(i?(i.page=i.page+1,i.list=i.list.concat(s)):i={page:2,list:s},n(15,y=l(c({},y),{[lc]:l(c({},y[0]),{[String(e)]:i})}))):n(15,y=l(c({},y),{[t]:s}))}}))}}}function M(t=v,e=C){let n=null;if(0==t)if(b.length>0)n=y[3];else{let t=k?k[e].sub_type:void 0,i=y[0][String(t)];n=i?i.list:null}else n=y[t];if(n){const e=T();n=n.map((n=>{const i=e.get(n.song_code)||[],o=i.find((t=>t.uid==uu.getMeid()));return n._order_status=o?1:2,o&&(n._order_id=o.order_id),n._orders=0==t?i.slice(0,3).reverse():[n],n}))}return n}function A(t){v==dc?window.$.DialogByZ.Confirm({Title:"提示",Content:"确认将这首歌删除吗？",BtnL:"取消",BtnR:"确定",FunL(){window.$.DialogByZ.Close()},FunR(){window.$.DialogByZ.Close(),P(t)}}):P(t)}function P(t){let e=null;if(0==v&&2==t._order_status){if(!h.microphoneReday)return void Vt("未检测到您的麦克风，等稍后在重试点歌！");e=Ot.getKtvPickSong(uu.getCid(),t.song_code)}else e=Ot.getKtvDeleteSong(uu.getCid(),null!=t.order_id?t.order_id:t._order_id);qt.get(e).then((t=>{0!=t.error&&Vt(t.error_msg)}))}function j(){if(0==v&&0==b.length){M().length%20==0&&R(0,!0)}}w((()=>{qt.get(Ot.getKtvSongTypeList(uu.getCid())).then((t=>{0==t.error&&(n(16,k=t.data.sub_tab),(null==k?void 0:k.length)&&n(3,C=0))}))})),t.$$.on_mount.push((function(){void 0!==r||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<MusicLibrary> was created without expected prop 'closeModal'")}));const D=["defaultMemuIndex","closeModal"];return Object.keys(e).forEach((t=>{~D.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MusicLibrary> was created with unknown prop '${t}'`)})),t.$$set=t=>{"defaultMemuIndex"in t&&n(12,a=t.defaultMemuIndex),"closeModal"in t&&n(0,r=t.closeModal)},t.$capture_state=()=>({onMount:w,ChatUrls:Ot,common:uu,request:qt,MENU_TYPE_QUKU:0,MENU_TYPE_SELECTED:dc,SEARCH_TYPE:3,ORDER_TYPE_1:1,ORDER_TYPE_2:2,Ktv:ad,Img:ye,Category:vc,Empty:Ea,Menus:Na,Musics:Lc,Search:Uc,showTips:Vt,defaultMemuIndex:a,closeModal:r,updateSelectedData:d,forceUpdateIndex:m,instance:h,selectedList:u,menus:g,menusIndex:v,menusChange:_,allData:y,realMusicList:x,searchText:b,musicsRef:p,requestSearchList:$,categoryData:k,categoryIndex:C,categoryChange:I,getSelectedData:S,getSelectedMap:T,requestMuiscList:R,getMusicList:M,clickMuiscWithData:A,execAction:P,scrollBottomCb:j,category:i}),t.$inject_state=t=>{"defaultMemuIndex"in t&&n(12,a=t.defaultMemuIndex),"closeModal"in t&&n(0,r=t.closeModal),"forceUpdateIndex"in t&&n(14,m=t.forceUpdateIndex),"menus"in t&&n(4,g=t.menus),"menusIndex"in t&&n(1,v=t.menusIndex),"menusChange"in t&&n(8,_=t.menusChange),"allData"in t&&n(15,y=t.allData),"realMusicList"in t&&n(5,x=t.realMusicList),"searchText"in t&&n(2,b=t.searchText),"musicsRef"in t&&n(6,p=t.musicsRef),"categoryData"in t&&n(16,k=t.categoryData),"categoryIndex"in t&&n(3,C=t.categoryIndex),"categoryChange"in t&&n(9,I=t.categoryChange),"category"in t&&n(7,i=t.category)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{65536&t.$$.dirty&&n(7,i=k?k.map((t=>t.name)):null),4&t.$$.dirty&&b.length&&$(),10&t.$$.dirty&&(0==v&&-1==C||R()),49166&t.$$.dirty&&n(5,x=M())},[r,v,b,C,g,x,p,i,_,I,A,j,a,d,m,y,k,function(t){b=t,n(2,b)},function(t){Y[t?"unshift":"push"]((()=>{p=t,n(6,p)}))}]}let Wc=class extends h{constructor(t){super(t),u(this,t,Hc,Vc,g,{defaultMemuIndex:12,closeModal:0,updateSelectedData:13}),p("SvelteRegisterComponent",{component:this,tagName:"MusicLibrary",options:t,id:Vc.name})}get defaultMemuIndex(){throw new Error("<MusicLibrary>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set defaultMemuIndex(t){throw new Error("<MusicLibrary>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get closeModal(){throw new Error("<MusicLibrary>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<MusicLibrary>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateSelectedData(){return this.$$.ctx[13]}set updateSelectedData(t){throw new Error("<MusicLibrary>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const Kc="src/js/ktv/components/roleSongTag.svelte";function Yc(t){let e,n,i,o,s;n=new ye({props:{src:"https://dynamics-share.tuwan.com/activity/7e7273361dc5ea3882d5bd4766ac14f7.png"},$$inline:!0});const a={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),o.textContent="演唱",y(o,"class","s-xiQ_06zFE4UG"),x(o,Kc,6,4,218),y(e,"class","role_song_tag flex flex-ac flex-jc s-xiQ_06zFE4UG"),x(e,Kc,4,0,69)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,a){b(t,e,a),z(n,e,null),I(e,i),I(e,o),s=!0},p:k,i:function(t){s||(q(n.$$.fragment,t),s=!0)},o:function(t){O(n.$$.fragment,t),s=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:a,id:Yc.name,type:"component",source:"",ctx:t}),a}function Jc(t,e,n){let{$$slots:i={},$$scope:o}=e;f("RoleSongTag",i,[]);const s=[];return Object.keys(e).forEach((t=>{~s.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<RoleSongTag> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({Img:ye}),[]}class Qc extends h{constructor(t){super(t),u(this,t,Jc,Yc,g,{}),p("SvelteRegisterComponent",{component:this,tagName:"RoleSongTag",options:t,id:Yc.name})}}const Xc="src/js/ktv/resultModal/index.svelte";function Zc(t,e,n){const i=t.slice();return i[5]=e[n],i}function tl(t){let e,n,i,o,s,a,r,c=t[5].score+"";n=new ye({props:{src:t[5].logo},$$inline:!0});const l={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),s=M("x"),a=M(c),y(o,"class","s-H0skvfp7acz9"),x(o,Xc,73,24,2263),y(e,"class","score_con flex flex-ac flex-between s-H0skvfp7acz9"),x(e,Xc,71,20,2142)},m:function(t,c){b(t,e,c),z(n,e,null),I(e,i),I(e,o),I(o,s),I(o,a),r=!0},p:function(t,e){const i={};8&e&&(i.src=t[5].logo),n.$set(i),(!r||8&e)&&c!==(c=t[5].score+"")&&P(a,c)},i:function(t){r||(q(n.$$.fragment,t),r=!0)},o:function(t){O(n.$$.fragment,t),r=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:l,id:tl.name,type:"each",source:"(71:16) {#each scoreData as item}",ctx:t}),l}function el(t){let e;const n={c:function(){e=_("p"),e.textContent="未开启得分",y(e,"class","s-H0skvfp7acz9"),x(e,Xc,81,24,2629)},m:function(t,n){b(t,e,n)},p:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:el.name,type:"else",source:"(81:20) {:else}",ctx:t}),n}function nl(t){let e,n,i;const o={c:function(){e=_("p"),e.textContent="得分",n=T(),i=_("span"),i.textContent=`${t[4].score}`,y(e,"class","s-H0skvfp7acz9"),x(e,Xc,78,24,2513),y(i,"class","s-H0skvfp7acz9"),x(i,Xc,79,24,2547)},m:function(t,o){b(t,e,o),b(t,n,o),b(t,i,o)},p:k,d:function(t){t&&C(e),t&&C(n),t&&C(i)}};return p("SvelteRegisterBlock",{block:o,id:nl.name,type:"if",source:"(78:20) { #if data.score_switch == 1}",ctx:t}),o}function il(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,$,k,R,A,j,D,L,F;a=new ye({props:{class:"head_img",src:t[4].avatar},$$inline:!0}),c=new Qc({$$inline:!0});let V=t[3];v(V);let K=[];for(let p=0;p<V.length;p+=1)K[p]=tl(Zc(t,V,p));const Y=t=>O(K[t],1,1,(()=>{K[t]=null}));function J(t,e){return 1==t[1].score_switch?nl:el}let Q=J(t),X=Q(t);const Z={c:function(){e=_("div"),n=_("div"),i=_("div"),o=_("div"),s=_("div"),U(a.$$.fragment),r=T(),U(c.$$.fragment),l=T(),d=_("p"),d.textContent=`${t[4].nickname}`,m=T(),h=_("p"),h.textContent=`《${t[4].name.slice(0,10)}》`,u=T(),g=_("div");for(let t=0;t<K.length;t+=1)K[t].c();f=T(),w=_("div"),X.c(),$=T(),k=_("p"),R=M("确定("),A=M(t[2]),j=M(")"),y(s,"class","head s-H0skvfp7acz9"),x(s,Xc,62,16,1752),y(d,"class","name s-H0skvfp7acz9"),x(d,Xc,66,16,1911),y(h,"class","song_name s-H0skvfp7acz9"),x(h,Xc,67,16,1967),y(o,"class","user flex flex-dir-col flex-ac s-H0skvfp7acz9"),x(o,Xc,61,12,1691),y(w,"class","get_score flex flex-ac flex-jc s-H0skvfp7acz9"),rt(w,"closeSwitch",2==t[1].score_switch),x(w,Xc,76,16,2351),y(g,"class","score_block s-H0skvfp7acz9"),x(g,Xc,69,12,2054),y(i,"class","info flex s-H0skvfp7acz9"),x(i,Xc,60,8,1655),y(k,"class","confirm_btn s-H0skvfp7acz9"),x(k,Xc,86,8,2734),y(n,"class","body s-H0skvfp7acz9"),x(n,Xc,59,4,1628),y(e,"class","ktv_result_modal s-H0skvfp7acz9"),x(e,Xc,58,0,1593)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(p,v){b(p,e,v),I(e,n),I(n,i),I(i,o),I(o,s),z(a,s,null),I(s,r),z(c,s,null),I(o,l),I(o,d),I(o,m),I(o,h),I(i,u),I(i,g);for(let t=0;t<K.length;t+=1)K[t]&&K[t].m(g,null);I(g,f),I(g,w),X.m(w,null),I(n,$),I(n,k),I(k,R),I(k,A),I(k,j),D=!0,L||(F=E(k,"click",B((function(){H(t[0])&&t[0].apply(this,arguments)})),!1,!1,!0,!1),L=!0)},p:function(e,[n]){if(t=e,8&n){let e;for(V=t[3],v(V),e=0;e<V.length;e+=1){const i=Zc(t,V,e);K[e]?(K[e].p(i,n),q(K[e],1)):(K[e]=tl(i),K[e].c(),q(K[e],1),K[e].m(g,f))}for(W(),e=V.length;e<K.length;e+=1)Y(e);N()}Q===(Q=J(t))&&X?X.p(t,n):(X.d(1),X=Q(t),X&&(X.c(),X.m(w,null))),(!D||2&n)&&rt(w,"closeSwitch",2==t[1].score_switch),(!D||4&n)&&P(A,t[2])},i:function(t){if(!D){q(a.$$.fragment,t),q(c.$$.fragment,t);for(let t=0;t<V.length;t+=1)q(K[t]);D=!0}},o:function(t){O(a.$$.fragment,t),O(c.$$.fragment,t),K=K.filter(Boolean);for(let e=0;e<K.length;e+=1)O(K[e]);D=!1},d:function(t){t&&C(e),G(a),G(c),S(K,t),X.d(),L=!1,F()}};return p("SvelteRegisterBlock",{block:Z,id:il.name,type:"component",source:"",ctx:t}),Z}function ol(t,e,n){let i,o,{$$slots:s={},$$scope:a}=e;f("ResultModal",s,[]);let{closeModal:r}=e,{data:c={}}=e;const l=c.song_info;w((()=>{let t=setInterval((()=>{n(2,--o),0==o&&(window.clearInterval(t),r&&r())}),1e3);return()=>{window.clearInterval(t)}})),w((()=>{const t=ad.getInstance().handclapSound;t&&(t.volume(xt.getInstance().getMainVolume()/100*.5),t.play())})),t.$$.on_mount.push((function(){void 0!==r||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<ResultModal> was created without expected prop 'closeModal'")}));const d=["closeModal","data"];return Object.keys(e).forEach((t=>{~d.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<ResultModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,r=t.closeModal),"data"in t&&n(1,c=t.data)},t.$capture_state=()=>({onMount:w,Img:ye,RoleSongTag:Qc,Ktv:ad,SessionStorage:xt,closeModal:r,data:c,songInfo:l,countdown:o,scoreData:i}),t.$inject_state=t=>{"closeModal"in t&&n(0,r=t.closeModal),"data"in t&&n(1,c=t.data),"countdown"in t&&n(2,o=t.countdown),"scoreData"in t&&n(3,i=t.scoreData)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{2&t.$$.dirty&&n(2,o=c.countdown)},n(3,i=[{logo:"https://dynamics-share.tuwan.com/activity/71540957674c56349c9230845de65d31.png",score:l.grade_4||0},{logo:"https://dynamics-share.tuwan.com/activity/4d2c38dcd239b5589eca61ceb20d8595.png",score:l.grade_3||0},{logo:"https://dynamics-share.tuwan.com/activity/91a4db8140d07dafb7b6d0271d97553b.png",score:l.grade_2||0},{logo:"https://dynamics-share.tuwan.com/activity/8fb93b0093aaa9a288c47284ed47e522.png",score:l.grade_1||0}]),[r,c,o,i,l]}class sl extends h{constructor(t){super(t),u(this,t,ol,il,g,{closeModal:0,data:1}),p("SvelteRegisterComponent",{component:this,tagName:"ResultModal",options:t,id:il.name})}get closeModal(){throw new Error("<ResultModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<ResultModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get data(){throw new Error("<ResultModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<ResultModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class al{constructor(){this.list=[],this.map=new Map,this.changeCallback=null,this.isRequestedList=!1,this.requestList()}requestList(){qt.get(Ot.getKtvOrderList(uu.getCid())).then((t=>{0==t.error&&(this.list=t.data.order_list||[],this.isRequestedList=!0,this.updateMap())}))}insert(t){let e=this.map.get(t.song_code);e?e.push(t):e=[t],this.map.set(t.song_code,e)}updateMap(){for(const t of this.list)this.insert(t);this.changeCallback&&this.changeCallback()}add(t){if(this.isRequestedList){const e=t.id_list.findIndex((e=>t.song_info.order_id==e));e>=0&&(e<this.list.length?this.list.splice(e,0,t.song_info):this.list.push(t.song_info),this.insert(t.song_info),this.changeCallback&&this.changeCallback())}}delete(t){if(this.isRequestedList){const e=this.list.findIndex((e=>e.order_id==t.order_id));if(e>=0){const n=this.list[e];this.list.splice(e,1);let i=this.map.get(n.song_code);if(i){const e=i.findIndex((e=>e.order_id==t.order_id));i.splice(e,1),this.map.set(n.song_code,i)}this.changeCallback&&this.changeCallback()}}}}const rl="src/js/ktv/mainButton/index.svelte";function cl(t){let e,n;e=new ye({props:{class:"changeMuisc",src:"https://dynamics-share.tuwan.com/activity/0bdebecfb470b52f9b70ecc81c5168ff.png"},$$inline:!0}),e.$on("click",t[4]);const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:cl.name,type:"if",source:"(124:4) {#if title == START_TITLE}",ctx:t}),i}function ll(t){let e,n,i,o,s,a,r,c,l,d=t[2]==dl&&cl(t);const m={c:function(){e=_("div"),n=_("div"),i=M(t[2]),o=T(),s=_("div"),a=T(),d&&d.c(),y(s,"class","progressBar s-DRF0cHDpQJcQ"),A(s,"width",Math.ceil(t[0]?82*t[1]:0)+"%"),x(s,rl,121,8,3192),y(n,"class","ktv_main_btn s-DRF0cHDpQJcQ"),rt(n,"disable",t[2]==ml||t[2]==hl),x(n,rl,119,4,3054),y(e,"class","ktv_main_btn_con s-DRF0cHDpQJcQ"),x(e,rl,118,0,3019)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(m,h){b(m,e,h),I(e,n),I(n,i),I(n,o),I(n,s),I(e,a),d&&d.m(e,null),r=!0,c||(l=E(n,"click",t[3],!1,!1,!1,!1),c=!0)},p:function(t,[o]){(!r||4&o)&&P(i,t[2]),(!r||3&o)&&A(s,"width",Math.ceil(t[0]?82*t[1]:0)+"%"),(!r||4&o)&&rt(n,"disable",t[2]==ml||t[2]==hl),t[2]==dl?d?(d.p(t,o),4&o&&q(d,1)):(d=cl(t),d.c(),q(d,1),d.m(e,null)):d&&(W(),O(d,1,1,(()=>{d=null})),N())},i:function(t){r||(q(d),r=!0)},o:function(t){O(d),r=!1},d:function(t){t&&C(e),d&&d.d(),c=!1,l()}};return p("SvelteRegisterBlock",{block:m,id:ll.name,type:"component",source:"",ctx:t}),m}const dl="开始演唱",ml="伴奏加载中",hl="等待演唱中",ul="开始点歌";function pl(t,e,n){let{$$slots:i={},$$scope:o}=e;f("MainButton",i,[]);let{download:s=!1}=e,{showLyricCb:a}=e;function r(){n(8,l+=1)}function c(t){t<.8&&0==m?m=(new Date).getTime():m>0&&(new Date).getTime()-m>30&&n(1,d=t)}let l=0,d=0,m=0;const h=ad.getInstance();let u=ul;function p(){switch(u){case ul:h.showMusicLibrary();break;case dl:h.actInfo.song_info&&(a&&a(),h.autoOpenMicrophone(),h.checkAnchorCanDisposeMicrophone(!0)||h.setLoadVolemeValue())}}function g(){var t,e;const n=(null==(e=null==(t=ad.getInstance().actInfo)?void 0:t.song_info)?void 0:e.order_id)||"0";window.$.DialogByZ.Confirm({Title:"提示",Content:"确认切歌吗？",BtnL:"取消",BtnR:"确定",FunL(){window.$.DialogByZ.Close()},FunR(){window.$.DialogByZ.Close(),qt.get(Ot.getKtvChangeSong(uu.getCid(),n)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}})}t.$$.on_mount.push((function(){void 0!==a||"showLyricCb"in e||t.$$.bound[t.$$.props.showLyricCb]||console.warn("<MainButton> was created without expected prop 'showLyricCb'")}));const w=["download","showLyricCb"];return Object.keys(e).forEach((t=>{~w.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MainButton> was created with unknown prop '${t}'`)})),t.$$set=t=>{"download"in t&&n(0,s=t.download),"showLyricCb"in t&&n(5,a=t.showLyricCb)},t.$capture_state=()=>({Img:ye,Ktv:ad,common:uu,request:qt,showTips:Vt,ChatUrls:Ot,download:s,showLyricCb:a,forceUpdate:r,setPercent:c,forceUpdateIndex:l,percent:d,protectTime:m,instance:h,START_TITLE:dl,LOADING_TITLE:ml,SONGING_TITLE:hl,CHOICE_TITLE:ul,title:u,btnClick:p,changeMuisc:g}),t.$inject_state=t=>{"download"in t&&n(0,s=t.download),"showLyricCb"in t&&n(5,a=t.showLyricCb),"forceUpdateIndex"in t&&n(8,l=t.forceUpdateIndex),"percent"in t&&n(1,d=t.percent),"protectTime"in t&&(m=t.protectTime),"title"in t&&n(2,u=t.title)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{257&t.$$.dirty&&(s?n(2,u=ml):(n(2,u=ul),h.actInfo&&h.actInfo.song_info&&(h.mineIsMainSong()?n(2,u=dl):n(2,u=hl)))),1&t.$$.dirty&&0==s&&(n(1,d=0),m=0)},[s,d,u,p,g,a,r,c,l]}let gl=class extends h{constructor(t){super(t),u(this,t,pl,ll,g,{download:0,showLyricCb:5,forceUpdate:6,setPercent:7}),p("SvelteRegisterComponent",{component:this,tagName:"MainButton",options:t,id:ll.name})}get download(){throw new Error("<MainButton>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set download(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showLyricCb(){throw new Error("<MainButton>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showLyricCb(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[6]}set forceUpdate(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get setPercent(){return this.$$.ctx[7]}set setPercent(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};class fl{constructor(t,{lineCount:e=3,lineHeight:n=28}={}){const i=document.querySelector(t);this.canvas=i,this.context=i.getContext("2d"),this.initWidthHeight=!1,this.fps=60,this.fpsInterval=1e3/this.fps,this.last=(new Date).getTime(),this.lineCount=e,this.lineHeight=n,this.fontSize=18,this.offsets=0,this.maxScrollDuration=600,this.minScrollDuration=250,this.useMinScrollDuration=!1,this.showShadow=!0,this.activeColor=this.context.createLinearGradient(0,0,0,this.lineHeight),this.activeColor.addColorStop("0","#FF6691"),this.activeColor.addColorStop("1.0","#FF6691"),this.backgroundColor=this.context.createLinearGradient(0,0,0,this.lineHeight),this.backgroundColor.addColorStop("0","#FFFFFF"),this.backgroundColor.addColorStop("1.0","#FFFFFF"),this.backgroundSubColor=this.context.createLinearGradient(0,0,0,this.lineHeight),this.backgroundSubColor.addColorStop("0","rgba(255,255,255,0.8)"),this.backgroundSubColor.addColorStop("1.0","rgba(255,255,255,0.8)"),this.isPause=!1,this.lines=[],this.transformY=0,this.canvasWidth=400,this.canvasHeight=this.lineCount*this.lineHeight,this.useLrcAverageDuration=!0,this.requestAnimationFrameCode=null,this.parseXmlCallback=null}updatePropertys(){this.canvasHeight=this.lineCount*this.lineHeight}setInitData(t,e="xml"){if(uu.isYinSuDa()){let n;"good"==e?(n=t,this.offsets=n.offset,this.lines=n.content,this.isPause=!1):(n="xml"==e?this.xmlLyricsParse(t):this.lrcLyricsParse(t),this.offsets=n.offset,this.lines=n.lines,this.isPause=!1)}else{const n="xml"==e?this.xmlLyricsParse(t):this.lrcLyricsParse(t);this.offsets=n.offset,this.lines=n.lines,this.isPause=!1}}setInitDataZego(t){const e=t.lines.map((t=>l(c({},t),{offset:t.begin_time,words:t.words.map((e=>l(c({},e),{begin:(t.begin_time+e.offset)/1e3,end:(t.begin_time+e.offset+e.duration)/1e3,offset:t.begin_time+e.offset})))})));this.offsets=0,this.lines=e,this.isPause=!1}setOffSets(t,e){(e||t>this.offsets)&&(this.offsets=t)}setIsPause(t){this.isPause=t}xmlLyricsParse(t){let e=new window.fxparser.XMLParser({ignoreAttributes:!1,parseAttributeValue:!0,attributeNamePrefix:""}).parse(t);this.parseXmlCallback&&this.parseXmlCallback(e);let n=new Array;const i=Array.isArray(e.song.midi_lrc.paragraph)?e.song.midi_lrc.paragraph:[e.song.midi_lrc.paragraph];for(let o=0;o<i.length;o++){let t=i[o];for(let e=0;null!=t.sentence&&e<t.sentence.length;e++){let i=t.sentence[e].tone||t.sentence[e].monolog;Array.isArray(i)||(i=[i]);let o=new Array;for(let t=0;t<i.length;t++){let e=i[t];if(!e.word){if(!e["#text"])continue;e.word=e["#text"]}let n=Math.round(1e3*e.begin),s=Math.round(1e3*e.end);o.push(l(c({},e),{offset:n,duration:s-n}))}0!=o.length&&n.push({words:o,offset:o[0].offset,duration:o[o.length-1].offset+o[o.length-1].duration-o[0].offset})}}return{title:e.song.general.name,artist:e.song.general.singer,album:"",offset:0,lines:n}}lrcLyricsParse(t){let e=t.split("[").filter((t=>""!=t.trim())).map((t=>t.replace("\r","").replace("\n",""))),n=new Array;try{for(let t=0;t<e.length;t++){let i=e[t].split("]");2==i[0].split(":").length&&(i[0]="00:"+i[0]);let o=window.moment.duration(i[0]).asMilliseconds(),s=0;if(t<e.length-1){let n=e[t+1].split("]");2==n[0].split(":").length&&(n[0]="00:"+n[0]),s=window.moment.duration(n[0]).asMilliseconds()-o}else s=1e3;if(i.length<=1)continue;let a=i[1].split(""),r=this.useLrcAverageDuration?Math.round(s/a.length):0,c=a.map(((t,e)=>({word:t,offset:o+e*r,duration:r})));n.push({offset:o,duration:s,words:c})}}catch(i){n.push({offset:0,duration:1e3,words:[{word:"该歌词暂不支持",offset:0,duration:0}]})}return{title:"",artist:"",album:"",offset:0,lines:n}}drawTextLine(t,e){if(uu.isYinSuDa()){const n=this.context,i=this.canvasWidth;let o=t.content.reduce(((t,e)=>/^[A-Za-z]+$/.test(e.content)?`${t} ${e.content}`:`${t}${e.content}`),"");n.save(),this.showShadow&&(n.shadowColor="rgba(0, 0, 0, 0.2)"),n.fillStyle=0!=e?this.backgroundSubColor:this.backgroundColor;let s=n.measureText(o),a=s.width>i?s.width/2:i/2;if(s.width>i&&this.offsets>=t.start&&0==e&&(a+=-1*(s.width-i)*((this.offsets-t.start)/t.duration)),n.fillText(o,a,(this.lineHeight-this.fontSize)/2+this.fontSize+e*this.lineHeight+this.transformY),n.restore(),this.offsets>=t.start&&0==e){let r=t.start,c=t.content.filter((t=>t.start+r<=this.offsets)),l=c.slice(0,c.length-1).map((t=>t.content)).join(""),d=c[c.length-1],m=n.measureText(l).width+n.measureText(d.content).width*((this.offsets-(d.start+r))/d.duration),h=-1*(i/2+s.width/2)+m;h=h>=0?0:h,n.save(),n.beginPath(),n.rect(h,this.transformY,i,this.lineHeight),n.strokeStyle="transparent",n.lineWidth=0,n.stroke(),n.closePath(),n.clip(),this.showShadow&&(n.shadowColor="rgba(0, 0, 0, 0.2)"),n.fillStyle=this.activeColor,n.fillText(o,a,(this.lineHeight-this.fontSize)/2+this.fontSize+e*this.lineHeight+this.transformY),n.restore()}}else{const n=this.context,i=this.canvasWidth;let o=t.words.reduce(((t,e)=>/^[A-Za-z]+$/.test(e.word)?`${t} ${e.word}`:`${t}${e.word}`),"");n.save(),this.showShadow&&(n.shadowColor="rgba(0, 0, 0, 0.2)"),n.fillStyle=0!=e?this.backgroundSubColor:this.backgroundColor;let s=n.measureText(o),a=s.width>i?s.width/2:i/2;if(s.width>i&&this.offsets>=t.offset&&0==e&&(a+=-1*(s.width-i)*((this.offsets-t.offset)/t.duration)),n.fillText(o,a,(this.lineHeight-this.fontSize)/2+this.fontSize+e*this.lineHeight+this.transformY),n.restore(),this.offsets>=t.offset&&0==e){let r=t.words.filter((t=>t.offset<=this.offsets)),c=r.slice(0,r.length-1).map((t=>t.word)).join(""),l=r[r.length-1],d=n.measureText(c).width+n.measureText(l.word).width*((this.offsets-l.offset)/l.duration),m=-1*(i/2+s.width/2)+d;m=m>=0?0:m,n.save(),n.beginPath(),n.rect(m,this.transformY,i,this.lineHeight),n.strokeStyle="transparent",n.lineWidth=0,n.stroke(),n.closePath(),n.clip(),this.showShadow&&(n.shadowColor="rgba(0, 0, 0, 0.2)"),n.fillStyle=this.activeColor,n.fillText(o,a,(this.lineHeight-this.fontSize)/2+this.fontSize+e*this.lineHeight+this.transformY),n.restore()}}}renderWord(){if(uu.isYinSuDa()){let t=(new Date).getTime(),e=t-this.last;const n=this.fpsInterval;if(e>n){this.last=t-e%n;const i=this.lines;if(!this.isPause&&i.length>0){this.offsets+=n;const t=this.context;this.context.font=`${this.fontSize}px 'Microsoft YaHei'`,this.context.textAlign="center",this.showShadow&&(this.context.shadowOffsetX=2,this.context.shadowOffsetY=2,this.context.shadowBlur=2),t.clearRect(0,0,this.canvasWidth,this.canvasHeight);let e=i.filter((t=>t.start<=this.offsets-(this.useMinScrollDuration?this.minScrollDuration:0))),o=e.length>0?e.length-1:0;for(let s=0;s<=this.lineCount;s++){let t=i[o+s];if(0==s){let e=t.start+t.duration,a=t.start,r=this.offsets-e;if(r+n>=0){let t=i[o+s+1];if(t){let n=a+t.start-e;if(n>=this.maxScrollDuration?(n=this.maxScrollDuration,this.useMinScrollDuration=!1):n<this.minScrollDuration?(n=this.minScrollDuration,this.useMinScrollDuration=!0):this.useMinScrollDuration=!1,r<n){let t=this.lineHeight*(r/n);this.transformY=-1*t}}}else this.transformY=0}t&&this.drawTextLine(t,s)}}}}else{let t=(new Date).getTime(),e=t-this.last;const n=this.fpsInterval;if(e>n){this.last=t-e%n;const i=this.lines;if(!this.isPause&&i.length>0){this.offsets+=n;const t=this.context;this.context.font=`${this.fontSize}px 'Microsoft YaHei'`,this.context.textAlign="center",this.showShadow&&(this.context.shadowOffsetX=2,this.context.shadowOffsetY=2,this.context.shadowBlur=2),t.clearRect(0,0,this.canvasWidth,this.canvasHeight);let e=i.filter((t=>t.offset<=this.offsets-(this.useMinScrollDuration?this.minScrollDuration:0))),o=e.length>0?e.length-1:0;for(let s=0;s<=this.lineCount;s++){let t=i[o+s];if(0==s){let e=t.offset+t.duration,a=this.offsets-e;if(a+n>=0){let t=i[o+s+1];if(t){let n=t.offset-e;if(n>=this.maxScrollDuration?(n=this.maxScrollDuration,this.useMinScrollDuration=!1):n<this.minScrollDuration?(n=this.minScrollDuration,this.useMinScrollDuration=!0):this.useMinScrollDuration=!1,a<n){let t=this.lineHeight*(a/n);this.transformY=-1*t}}}else this.transformY=0}t&&this.drawTextLine(t,s)}}}}this.requestAnimationFrameCode=requestAnimationFrame((()=>{this.renderWord()}))}clearAnimationFrame(){this.requestAnimationFrameCode&&(cancelAnimationFrame(this.requestAnimationFrameCode),this.requestAnimationFrameCode=null)}destroy(){this.clearAnimationFrame(),this.context&&this.context.clearRect(0,0,this.canvasWidth,this.canvasHeight)}}const{console:wl}=et,vl="src/js/components/lyric.svelte";function _l(t){let e;const n={c:function(){e=_("i"),y(e,"class","common-lyric-note left s-XuokZNAEjfN4"),x(e,vl,184,12,6532)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:_l.name,type:"if",source:"(184:8) {#if musicLogoShowLine == 1}",ctx:t}),n}function yl(t){let e;const n={c:function(){e=_("i"),y(e,"class","common-lyric-note right s-XuokZNAEjfN4"),x(e,vl,188,12,6654)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:yl.name,type:"if",source:"(188:8) {#if musicLogoShowLine == 1}",ctx:t}),n}function xl(t){let e;const n={c:function(){e=_("i"),y(e,"class","common-lyric-note left s-XuokZNAEjfN4"),x(e,vl,193,12,6801)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:xl.name,type:"if",source:"(193:8) {#if musicLogoShowLine == 2}",ctx:t}),n}function bl(t){let e;const n={c:function(){e=_("i"),y(e,"class","common-lyric-note right s-XuokZNAEjfN4"),x(e,vl,197,12,6922)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:bl.name,type:"if",source:"(197:8) {#if musicLogoShowLine == 2}",ctx:t}),n}function $l(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f=1==t[5]&&_l(t),w=1==t[5]&&yl(t),v=2==t[5]&&xl(t),$=2==t[5]&&bl(t);const S={c:function(){e=_("div"),n=_("canvas"),o=T(),s=_("div"),a=_("div"),f&&f.c(),r=T(),c=M(t[1]),l=T(),w&&w.c(),d=T(),m=_("div"),v&&v.c(),h=T(),u=M(t[2]),g=T(),$&&$.c(),y(n,"id","common-lyric"),y(n,"width","400px"),y(n,"height",i=t[3]*t[4]+"px"),x(n,vl,179,4,6263),y(e,"class","common-lyric-wrapper s-XuokZNAEjfN4"),A(e,"display",t[0]?"flex":"none"),x(e,vl,178,0,6179),y(a,"class","flex flex-jc"),x(a,vl,182,4,6456),y(m,"class","flex flex-jc desc"),x(m,vl,191,4,6720),y(s,"class","common-lyric-empty flex flex-ac flex-dir-col s-XuokZNAEjfN4"),A(s,"display",t[0]?"none":"flex"),x(s,vl,181,0,6348)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){b(t,e,i),I(e,n),b(t,o,i),b(t,s,i),I(s,a),f&&f.m(a,null),I(a,r),I(a,c),I(a,l),w&&w.m(a,null),I(s,d),I(s,m),v&&v.m(m,null),I(m,h),I(m,u),I(m,g),$&&$.m(m,null)},p:function(t,[o]){24&o&&i!==(i=t[3]*t[4]+"px")&&y(n,"height",i),1&o&&A(e,"display",t[0]?"flex":"none"),1==t[5]?f||(f=_l(t),f.c(),f.m(a,r)):f&&(f.d(1),f=null),2&o&&P(c,t[1]),1==t[5]?w||(w=yl(t),w.c(),w.m(a,null)):w&&(w.d(1),w=null),2==t[5]?v||(v=xl(t),v.c(),v.m(m,h)):v&&(v.d(1),v=null),4&o&&P(u,t[2]),2==t[5]?$||($=bl(t),$.c(),$.m(m,null)):$&&($.d(1),$=null),1&o&&A(s,"display",t[0]?"none":"flex")},i:k,o:k,d:function(t){t&&C(e),t&&C(o),t&&C(s),f&&f.d(),w&&w.d(),v&&v.d(),$&&$.d()}};return p("SvelteRegisterBlock",{block:S,id:$l.name,type:"component",source:"",ctx:t}),S}function kl(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Lyric",i,[]);let{playing:s=!1}=e,{parseXmlCb:a=null}=e,{defaultTitle:r="欢迎来听歌"}=e,{defaultDesc:c="唱歌请带耳机避免回音"}=e,{lineCount:l=3}=e,{lineHeight:d=28}=e,{forceSync:m=!1}=e,{deviationValue:h=0}=e,{musicLogoShowLine:u=2}=e;function p(t){_(),x=t,Promise.all([y(t),Ct.loadScript("https://asset2.tuwan.com/script/moment.min.js"),Ct.loadScript("https://asset2.tuwan.com/script/fxparser.js")]).then((([e])=>{null!=e&&x==t&&(n(14,b=new fl("#common-lyric",{lineCount:l,lineHeight:d})),n(14,b.showShadow=!1,b),n(14,b.parseXmlCallback=a,b),b.setInitData(e,t.indexOf(".xml")>=0||t.indexOf(".zip")>=0?"xml":"lrc"),b.renderWord(),b.setIsPause(!0))})).catch((t=>{Vt("网络错误,请稍后再试..")}))}function g(t){if(_(),t){n(0,s=!0);try{n(14,b=new fl("#common-lyric",{lineCount:l,lineHeight:d})),n(14,b.showShadow=!1,b),n(14,b.parseXmlCallback=a,b),b.setInitData(t,"good"),b.renderWord()}catch(e){console.log(e),Vt("网络错误,请稍后再试..")}}}function w(t,e){e&&(_(),x=t,Promise.resolve().then((async()=>{const i=await e.requestResource({songID:t,vendorID:2},1);if(0===i.errorCode&&0===i.resource.code){const o=await e.getKrcLyricByToken(i.resource.data.krc_token),{errorCode:s,lyrics:a}=o;0==s&&x==t&&(n(14,b=new fl("#common-lyric")),n(14,b.showShadow=!1,b),b.setInitDataZego(a),b.renderWord(),b.setIsPause(!0))}})))}function v(t){if(null!=b){b.isPause&&b.setIsPause(!1);const e=1e3*t;if(h>0&&s&&Math.abs(b.offsets-e)<h)return;b.setOffSets(e,m),n(0,s=!0)}}function _(){n(0,s=!1),b&&(b.destroy(),n(14,b=null))}async function y(t){let e=await qt.getBinary(t);if(t.indexOf(".zip")>=0){const t=await window.JSZip.loadAsync(e);let n=null;t.forEach(((t,e)=>{n=e})),e=await n.async("string")}else e=Ct.byteToString(e);return e}let x="",b=null;ut((()=>{x="",_()}));const $=["playing","parseXmlCb","defaultTitle","defaultDesc","lineCount","lineHeight","forceSync","deviationValue","musicLogoShowLine"];return Object.keys(e).forEach((t=>{~$.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||wl.warn(`<Lyric> was created with unknown prop '${t}'`)})),t.$$set=t=>{"playing"in t&&n(0,s=t.playing),"parseXmlCb"in t&&n(6,a=t.parseXmlCb),"defaultTitle"in t&&n(1,r=t.defaultTitle),"defaultDesc"in t&&n(2,c=t.defaultDesc),"lineCount"in t&&n(3,l=t.lineCount),"lineHeight"in t&&n(4,d=t.lineHeight),"forceSync"in t&&n(7,m=t.forceSync),"deviationValue"in t&&n(8,h=t.deviationValue),"musicLogoShowLine"in t&&n(5,u=t.musicLogoShowLine)},t.$capture_state=()=>({onDestroy:ut,request:qt,Utils:Ct,LyricsPlayer:fl,showTips:Vt,playing:s,parseXmlCb:a,defaultTitle:r,defaultDesc:c,lineCount:l,lineHeight:d,forceSync:m,deviationValue:h,musicLogoShowLine:u,play:p,playYinSuDa:g,playZego:w,setLyricOffset:v,destoryLyricsPlayer:_,decompression:y,playingUrl:x,lyricsPlayer:b}),t.$inject_state=t=>{"playing"in t&&n(0,s=t.playing),"parseXmlCb"in t&&n(6,a=t.parseXmlCb),"defaultTitle"in t&&n(1,r=t.defaultTitle),"defaultDesc"in t&&n(2,c=t.defaultDesc),"lineCount"in t&&n(3,l=t.lineCount),"lineHeight"in t&&n(4,d=t.lineHeight),"forceSync"in t&&n(7,m=t.forceSync),"deviationValue"in t&&n(8,h=t.deviationValue),"musicLogoShowLine"in t&&n(5,u=t.musicLogoShowLine),"playingUrl"in t&&(x=t.playingUrl),"lyricsPlayer"in t&&n(14,b=t.lyricsPlayer)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{16408&t.$$.dirty&&b&&(n(14,b.lineCount=l,b),n(14,b.lineHeight=d,b),b.updatePropertys())},[s,r,c,l,d,u,a,m,h,p,g,w,v,_,b]}class Cl extends h{constructor(t){super(t),u(this,t,kl,$l,g,{playing:0,parseXmlCb:6,defaultTitle:1,defaultDesc:2,lineCount:3,lineHeight:4,forceSync:7,deviationValue:8,musicLogoShowLine:5,play:9,playYinSuDa:10,playZego:11,setLyricOffset:12,destoryLyricsPlayer:13}),p("SvelteRegisterComponent",{component:this,tagName:"Lyric",options:t,id:$l.name})}get playing(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set playing(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get parseXmlCb(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set parseXmlCb(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get defaultTitle(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set defaultTitle(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get defaultDesc(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set defaultDesc(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get lineCount(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set lineCount(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get lineHeight(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set lineHeight(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceSync(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set forceSync(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get deviationValue(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set deviationValue(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get musicLogoShowLine(){throw new Error("<Lyric>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set musicLogoShowLine(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get play(){return this.$$.ctx[9]}set play(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playYinSuDa(){return this.$$.ctx[10]}set playYinSuDa(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playZego(){return this.$$.ctx[11]}set playZego(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get setLyricOffset(){return this.$$.ctx[12]}set setLyricOffset(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get destoryLyricsPlayer(){return this.$$.ctx[13]}set destoryLyricsPlayer(t){throw new Error("<Lyric>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Il="src/js/ktv/prepare/index.svelte";function Sl(t){let e,n,i,o,s,a,r,c,l,d,m,h;s=new ye({props:{src:t[0]},$$inline:!0});const u={c:function(){e=_("div"),n=_("div"),i=_("p"),i.textContent="即将由",o=T(),U(s.$$.fragment),a=T(),r=_("p"),c=_("span"),c.textContent=`${t[1]}`,l=M(" 演唱"),d=T(),m=_("p"),m.textContent=`《${t[2]}》`,y(i,"class","s-UKtjwsOJMNEH"),x(i,Il,52,8,1038),y(c,"class","s-UKtjwsOJMNEH"),x(c,Il,54,11,1088),y(r,"class","s-UKtjwsOJMNEH"),x(r,Il,54,8,1085),y(n,"class","block1 flex flex-ac s-UKtjwsOJMNEH"),x(n,Il,51,4,996),y(m,"class","name s-UKtjwsOJMNEH"),x(m,Il,56,4,1134),y(e,"class","prepare flex flex-dir-col flex-ac s-UKtjwsOJMNEH"),x(e,Il,50,0,944)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,u){b(t,e,u),I(e,n),I(n,i),I(n,o),z(s,n,null),I(n,a),I(n,r),I(r,c),I(r,l),I(e,d),I(e,m),h=!0},p:k,i:function(t){h||(q(s.$$.fragment,t),h=!0)},o:function(t){O(s.$$.fragment,t),h=!1},d:function(t){t&&C(e),G(s)}};return p("SvelteRegisterBlock",{block:u,id:Sl.name,type:"component",source:"",ctx:t}),u}function Tl(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Prepare",i,[]);let s,{countdown:a=5}=e,{countdownEnd:r}=e;function c(){return s}function l(t){window.clearInterval(s),s=null,t<=0||(s=setInterval((()=>{0==--t&&(window.clearInterval(s),s=null,r&&r())}),1e3))}ut((()=>{window.clearInterval(s),s=null}));const d=ad.getInstance(),{avatar:m,nickname:h,name:u}=d.actInfo.song_info;t.$$.on_mount.push((function(){void 0!==r||"countdownEnd"in e||t.$$.bound[t.$$.props.countdownEnd]||console.warn("<Prepare> was created without expected prop 'countdownEnd'")}));const p=["countdown","countdownEnd"];return Object.keys(e).forEach((t=>{~p.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Prepare> was created with unknown prop '${t}'`)})),t.$$set=t=>{"countdown"in t&&n(3,a=t.countdown),"countdownEnd"in t&&n(4,r=t.countdownEnd)},t.$capture_state=()=>({onDestroy:ut,Ktv:ad,Img:ye,countdown:a,countdownEnd:r,getTimer:c,timer:s,startCountdown:l,instance:d,avatar:m,nickname:h,name:u}),t.$inject_state=t=>{"countdown"in t&&n(3,a=t.countdown),"countdownEnd"in t&&n(4,r=t.countdownEnd),"timer"in t&&(s=t.timer)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{8&t.$$.dirty&&l(a)},[m,h,u,a,r,c]}let Rl=class extends h{constructor(t){super(t),u(this,t,Tl,Sl,g,{countdown:3,countdownEnd:4,getTimer:5}),p("SvelteRegisterComponent",{component:this,tagName:"Prepare",options:t,id:Sl.name})}get countdown(){throw new Error("<Prepare>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set countdown(t){throw new Error("<Prepare>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get countdownEnd(){throw new Error("<Prepare>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set countdownEnd(t){throw new Error("<Prepare>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get getTimer(){return this.$$.ctx[5]}set getTimer(t){throw new Error("<Prepare>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};var Ml=globalThis&&globalThis.__assign||function(){return Ml=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Ml.apply(this,arguments)};function Al(t,e,n){var i=this;this.endVal=e,this.options=n,this.version="2.3.2",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(t){i.startTime||(i.startTime=t);var e=t-i.startTime;i.remaining=i.duration-e,i.useEasing?i.countDown?i.frameVal=i.startVal-i.easingFn(e,0,i.startVal-i.endVal,i.duration):i.frameVal=i.easingFn(e,i.startVal,i.endVal-i.startVal,i.duration):i.frameVal=i.startVal+(i.endVal-i.startVal)*(e/i.duration);var n=i.countDown?i.frameVal<i.endVal:i.frameVal>i.endVal;i.frameVal=n?i.endVal:i.frameVal,i.frameVal=Number(i.frameVal.toFixed(i.options.decimalPlaces)),i.printValue(i.frameVal),e<i.duration?i.rAF=requestAnimationFrame(i.count):null!==i.finalEndVal?i.update(i.finalEndVal):i.callback&&i.callback()},this.formatNumber=function(t){var e,n,o,s,a=t<0?"-":"";e=Math.abs(t).toFixed(i.options.decimalPlaces);var r=(e+="").split(".");if(n=r[0],o=r.length>1?i.options.decimal+r[1]:"",i.options.useGrouping){s="";for(var c=0,l=n.length;c<l;++c)0!==c&&c%3==0&&(s=i.options.separator+s),s=n[l-c-1]+s;n=s}return i.options.numerals&&i.options.numerals.length&&(n=n.replace(/[0-9]/g,(function(t){return i.options.numerals[+t]})),o=o.replace(/[0-9]/g,(function(t){return i.options.numerals[+t]}))),a+i.options.prefix+n+o+i.options.suffix},this.easeOutExpo=function(t,e,n,i){return n*(1-Math.pow(2,-10*t/i))*1024/1023+e},this.options=Ml(Ml({},this.defaults),n),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(e),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,""===this.options.separator&&(this.options.useGrouping=!1),this.el="string"==typeof t?document.getElementById(t):t,this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined","undefined"!=typeof window&&this.options.enableScrollSpy&&(this.error?console.error(this.error,t):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push((function(){return i.handleScroll(i)})),window.onscroll=function(){window.onScrollFns.forEach((function(t){return t()}))},this.handleScroll(this)))}Al.prototype.handleScroll=function(t){if(t&&window&&!t.once){var e=window.innerHeight+window.scrollY,n=t.el.getBoundingClientRect(),i=n.top+n.height+window.pageYOffset;i<e&&i>window.scrollY&&t.paused?(t.paused=!1,setTimeout((function(){return t.start()}),t.options.scrollSpyDelay),t.options.scrollSpyOnce&&(t.once=!0)):window.scrollY>i&&!t.paused&&t.reset()}},Al.prototype.determineDirectionAndSmartEasing=function(){var t=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>t;var e=t-this.startVal;if(Math.abs(e)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=t;var n=this.countDown?1:-1;this.endVal=t+n*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=t,this.finalEndVal=null;null!==this.finalEndVal?this.useEasing=!1:this.useEasing=this.options.useEasing},Al.prototype.start=function(t){this.error||(this.callback=t,this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},Al.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},Al.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},Al.prototype.update=function(t){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(t),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,null==this.finalEndVal&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},Al.prototype.printValue=function(t){var e=this.formattingFn(t);"INPUT"===this.el.tagName?this.el.value=e:"text"===this.el.tagName||"tspan"===this.el.tagName?this.el.textContent=e:this.el.innerHTML=e},Al.prototype.ensureNumber=function(t){return"number"==typeof t&&!isNaN(t)},Al.prototype.validateValue=function(t){var e=Number(t);return this.ensureNumber(e)?e:(this.error="[CountUp] invalid start or end value: ".concat(t),null)},Al.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration};const Pl="src/js/ktv/score/index.svelte";function jl(t){let e,n;const i={c:function(){e=_("div"),n=_("p"),y(n,"class","value s-2I5zKs8GF_aO"),x(n,Pl,21,4,384),y(e,"class","shorus_score s-2I5zKs8GF_aO"),x(e,Pl,20,0,353)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(i,o){b(i,e,o),I(e,n),t[3](n)},p:k,i:k,o:k,d:function(n){n&&C(e),t[3](null)}};return p("SvelteRegisterBlock",{block:i,id:jl.name,type:"component",source:"",ctx:t}),i}function Dl(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Score",i,[]);let s,a,{value:r=0}=e;w((()=>{n(2,a=new Al(s,r,{separator:""}))}));const c=["value"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Score> was created with unknown prop '${t}'`)})),t.$$set=t=>{"value"in t&&n(1,r=t.value)},t.$capture_state=()=>({onMount:w,CountUp:Al,value:r,valueDom:s,countup:a}),t.$inject_state=t=>{"value"in t&&n(1,r=t.value),"valueDom"in t&&n(0,s=t.valueDom),"countup"in t&&n(2,a=t.countup)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{6&t.$$.dirty&&r>0&&a&&a.update(r)},[s,r,a,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(0,s)}))}]}let Ll=class extends h{constructor(t){super(t),u(this,t,Dl,jl,g,{value:1}),p("SvelteRegisterComponent",{component:this,tagName:"Score",options:t,id:jl.name})}get value(){throw new Error("<Score>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set value(t){throw new Error("<Score>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};function El(t){let e;const n={c:function(){e=_("div"),y(e,"class","effect s-wrqm_2zcbaGc"),x(e,"src/js/components/effect.svelte",35,0,773)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(n,i){b(n,e,i),t[2](e)},p:k,i:k,o:k,d:function(n){n&&C(e),t[2](null)}};return p("SvelteRegisterBlock",{block:n,id:El.name,type:"component",source:"",ctx:t}),n}function Bl(t,e,n){let i,o,{$$slots:s={},$$scope:a}=e;function r(t){c(),Zt.getInstance().loadParser(i,t,1,!1).then((({player:t,videoItem:e})=>{o=t,t.setVideoItem(e),t.startAnimation(),t.onFinished((()=>{o=null}))}),(t=>{}))}function c(){o&&(o.stopAnimation(),o.clear(),o=null)}f("Effect",s,[]),ut((()=>{c()}));const l=[];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Effect> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({onDestroy:ut,SvgaPlayer:Zt,play:r,ref:i,playerHandle:o,clearPlayer:c}),t.$inject_state=t=>{"ref"in t&&n(0,i=t.ref),"playerHandle"in t&&(o=t.playerHandle)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[i,r,function(t){Y[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}class Fl extends h{constructor(t){super(t),u(this,t,Bl,El,g,{play:1}),p("SvelteRegisterComponent",{component:this,tagName:"Effect",options:t,id:El.name})}get play(){return this.$$.ctx[1]}set play(t){throw new Error("<Effect>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class Ul{constructor(t,e,n,i,o,s,a){this.x=t;let r=a.height-(e-i/2);r>=a.height&&(r=a.height-i),r<=0&&(r=i),this.y=r,this.width=n,this.lineHeight=i,this.graduation=o,this.color=s,this.canvasObj=a,this.ctx=a.getContext("2d")}draw(){this.ctx.beginPath(),this.ctx.fillStyle=this.color,this.ctx.strokeStyle=this.color,this.ctx.lineWidth=1;const t=this.x,e=this.y,n=this.width-1,i=this.lineHeight;this.ctx.beginPath(),this.ctx.moveTo(t+2,e),this.ctx.lineTo(t+n-2,e),this.ctx.arcTo(t+n,e,t+n,e+2,2),this.ctx.lineTo(t+n,e+i-2),this.ctx.arcTo(t+n,e+i,t+n-2,e+i,2),this.ctx.lineTo(t+2,e+i),this.ctx.arcTo(t,e+i,t,e+i-2,2),this.ctx.lineTo(t,e+2),this.ctx.arcTo(t,e,t+2,e,2),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}update(t){this.scoreArry=t}}const zl="src/js/components/stave/index.svelte";function Ol(t){let e,n,i,o,s,a,r,c;s=new ye({props:{src:"https://dynamics-share.tuwan.com/activity/52da9b769c2d074babfbcdd0ad9863a5.png",class:"cy",style:"height: "+t[0]+"px;"},$$inline:!0}),r=new ye({props:{src:"https://dynamics-share.tuwan.com/activity/9c41523ddd863802ad961ef706a0d024.png",class:"curso",style:"top: "+(t[0]-5-t[2])+"px;"},$$inline:!0});const l={c:function(){e=_("div"),n=_("div"),i=_("canvas"),o=T(),U(s.$$.fragment),a=T(),U(r.$$.fragment),y(i,"class","lineCanvas"),x(i,zl,74,6,1928),A(n,"visibility","hidden"),x(n,zl,73,4,1888),y(e,"class","stave s-L5BKWQKmuMU-"),x(e,zl,72,0,1864)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(l,d){b(l,e,d),I(e,n),I(n,i),t[6](i),I(n,o),z(s,n,null),I(n,a),z(r,n,null),c=!0},p:function(t,[e]){const n={};1&e&&(n.style="height: "+t[0]+"px;"),s.$set(n);const i={};5&e&&(i.style="top: "+(t[0]-5-t[2])+"px;"),r.$set(i)},i:function(t){c||(q(s.$$.fragment,t),q(r.$$.fragment,t),c=!0)},o:function(t){O(s.$$.fragment,t),O(r.$$.fragment,t),c=!1},d:function(n){n&&C(e),t[6](null),G(s),G(r)}};return p("SvelteRegisterBlock",{block:l,id:Ol.name,type:"component",source:"",ctx:t}),l}function Nl(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Stave",i,[]);let s,{lineWidth:a=600}=e,{lineHeight:r=60}=e;function c(t){t>=0&&n(2,d=t)}function l({filterReactInfo:t=[],filterColoringReactInfo:e=[]}={}){u();const n=s.height/5;t.map((t=>new Ul(t.x,t.y,t.width,4,n,"#d8d8d8",s))).forEach((t=>{t.draw()}));e.map((t=>new Ul(t.x,t.y,t.width,4,n,"#FF8AB4",s))).forEach((t=>{t.draw()}))}let d=0;function m(){n(1,s.height=r,s),n(1,s.width=a,s)}function h(){const t=s.getContext("2d");t.clearRect(0,0,s.width,s.height),t.beginPath(),t.strokeStyle="#ffffff80",t.lineWidth=1;const e=s.height/5;for(let n=0;n<6;n++){let i=n*e;t.moveTo(0,i),t.lineTo(s.width,i)}t.stroke()}function u(){s.getContext("2d").clearRect(0,0,s.width,s.height),h()}w((()=>{m(),h()}));const p=["lineWidth","lineHeight"];return Object.keys(e).forEach((t=>{~p.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Stave> was created with unknown prop '${t}'`)})),t.$$set=t=>{"lineWidth"in t&&n(3,a=t.lineWidth),"lineHeight"in t&&n(0,r=t.lineHeight)},t.$capture_state=()=>({onMount:w,Spectrum:Ul,Img:ye,lineWidth:a,lineHeight:r,drawCursor:c,draw:l,lineObj:s,cursorVal:d,canvasInit:m,initLine:h,clearReact:u}),t.$inject_state=t=>{"lineWidth"in t&&n(3,a=t.lineWidth),"lineHeight"in t&&n(0,r=t.lineHeight),"lineObj"in t&&n(1,s=t.lineObj),"cursorVal"in t&&n(2,d=t.cursorVal)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,s,d,a,c,l,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class ql extends h{constructor(t){super(t),u(this,t,Nl,Ol,g,{lineWidth:3,lineHeight:0,drawCursor:4,draw:5}),p("SvelteRegisterComponent",{component:this,tagName:"Stave",options:t,id:Ol.name})}get lineWidth(){throw new Error("<Stave>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set lineWidth(t){throw new Error("<Stave>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get lineHeight(){throw new Error("<Stave>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set lineHeight(t){throw new Error("<Stave>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get drawCursor(){return this.$$.ctx[4]}set drawCursor(t){throw new Error("<Stave>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get draw(){return this.$$.ctx[5]}set draw(t){throw new Error("<Stave>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Gl="src/js/ktv/mainBlock/index.svelte";function Vl(t){let e,n,i,o,s,a={defaultTitle:"大家一起来",defaultDesc:"欢乐KTV 有你更精彩",parseXmlCb:t[14],lineCount:t[12].actInfo&&1==t[12].actInfo.sound_track_switch?t[8]:4,forceSync:!0,deviationValue:300};e=new Cl({props:a,$$inline:!0}),t[31](e);let r=t[8]==Zl&&t[12].actInfo.song_info&&Wl(t),c=t[3]!=Fr&&t[11]&&Jl(t);const l={c:function(){U(e.$$.fragment),n=T(),r&&r.c(),i=T(),c&&c.c(),o=ht()},m:function(t,a){z(e,t,a),b(t,n,a),r&&r.m(t,a),b(t,i,a),c&&c.m(t,a),b(t,o,a),s=!0},p:function(t,n){const s={};256&n[0]&&(s.lineCount=t[12].actInfo&&1==t[12].actInfo.sound_track_switch?t[8]:4),e.$set(s),t[8]==Zl&&t[12].actInfo.song_info?r?(r.p(t,n),256&n[0]&&q(r,1)):(r=Wl(t),r.c(),q(r,1),r.m(i.parentNode,i)):r&&(W(),O(r,1,1,(()=>{r=null})),N()),t[3]!=Fr&&t[11]?c?(c.p(t,n),2056&n[0]&&q(c,1)):(c=Jl(t),c.c(),q(c,1),c.m(o.parentNode,o)):c&&(W(),O(c,1,1,(()=>{c=null})),N())},i:function(t){s||(q(e.$$.fragment,t),q(r),q(c),s=!0)},o:function(t){O(e.$$.fragment,t),O(r),O(c),s=!1},d:function(s){t[31](null),G(e,s),s&&C(n),r&&r.d(s),s&&C(i),c&&c.d(s),s&&C(o)}};return p("SvelteRegisterBlock",{block:l,id:Vl.name,type:"else",source:"(165:4) {:else}",ctx:t}),l}function Hl(t){let e,n,i,o=t[10]&&Ql(t),s={showLyricCb:t[15]};n=new gl({props:s,$$inline:!0}),t[30](n);const a={c:function(){o&&o.c(),e=T(),U(n.$$.fragment)},m:function(t,s){o&&o.m(t,s),b(t,e,s),z(n,t,s),i=!0},p:function(t,i){t[10]?o?(o.p(t,i),1024&i[0]&&q(o,1)):(o=Ql(t),o.c(),q(o,1),o.m(e.parentNode,e)):o&&(W(),O(o,1,1,(()=>{o=null})),N());n.$set({})},i:function(t){i||(q(o),q(n.$$.fragment,t),i=!0)},o:function(t){O(o),O(n.$$.fragment,t),i=!1},d:function(i){o&&o.d(i),i&&C(e),t[30](null),G(n,i)}};return p("SvelteRegisterBlock",{block:a,id:Hl.name,type:"if",source:"(160:4) {#if showPrepare}",ctx:t}),a}function Wl(t){let e,n,i,o,s,a;const r=[Yl,Kl],c=[];var l;n=(l=t)[12].actInfo&&1==l[12].actInfo.sound_track_switch?0:1,i=c[n]=r[n](t);let d={value:t[12].actInfo.song_info.score||0};s=new Ll({props:d,$$inline:!0}),t[33](s);const m={c:function(){e=_("div"),i.c(),o=T(),U(s.$$.fragment),y(e,"class","audioTrackCon flex flex-ac s-ksXpvskj6Kvq"),x(e,Gl,167,12,4998)},m:function(t,i){b(t,e,i),c[n].m(e,null),I(e,o),z(s,e,null),a=!0},p:function(t,e){i.p(t,e);s.$set({})},i:function(t){a||(q(i),q(s.$$.fragment,t),a=!0)},o:function(t){O(i),O(s.$$.fragment,t),a=!1},d:function(i){i&&C(e),c[n].d(),t[33](null),G(s)}};return p("SvelteRegisterBlock",{block:m,id:Wl.name,type:"if",source:"(167:8) {#if lyricCount == LYRIC_COUNT_2 && instance.actInfo.song_info}",ctx:t}),m}function Kl(t){let e;const n={c:function(){e=_("div"),A(e,"width","600px"),A(e,"height","60px"),x(e,Gl,171,20,5217)},m:function(t,n){b(t,e,n)},p:k,i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:Kl.name,type:"else",source:"(171:16) {:else}",ctx:t}),n}function Yl(t){let e,n;e=new ql({props:{},$$inline:!0}),t[32](e);const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){e.$set({})},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[32](null),G(e,n)}};return p("SvelteRegisterBlock",{block:i,id:Yl.name,type:"if",source:"(169:16) {#if instance.actInfo && instance.actInfo.sound_track_switch == 1}",ctx:t}),i}function Jl(t){let e,n,i={showLyricCb:t[15]};e=new gl({props:i,$$inline:!0}),t[34](e);const o={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){e.$set({})},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[34](null),G(e,n)}};return p("SvelteRegisterBlock",{block:o,id:Jl.name,type:"if",source:"(177:8) {#if stage != ACT_STAGE_PLAYING && showMainBtn}",ctx:t}),o}function Ql(t){let e,n,i={countdown:t[9],countdownEnd:t[13]};e=new Rl({props:i,$$inline:!0}),t[29](e);const o={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};512&n[0]&&(i.countdown=t[9]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[29](null),G(e,n)}};return p("SvelteRegisterBlock",{block:o,id:Ql.name,type:"if",source:"(161:8) {#if simulateKeyFunction}",ctx:t}),o}function Xl(t){let e,n,i,o,s,a;const r=[Hl,Vl],c=[];function l(t,e){return t[2]?0:1}n=l(t),i=c[n]=r[n](t);s=new Fl({props:{},$$inline:!0}),t[35](s);const d={c:function(){e=_("div"),i.c(),o=T(),U(s.$$.fragment),y(e,"class","mainBlock flex flex-dir-col flex-ac s-ksXpvskj6Kvq"),x(e,Gl,158,0,4391)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){b(t,e,i),c[n].m(e,null),I(e,o),z(s,e,null),a=!0},p:function(t,a){let d=n;n=l(t),n===d?c[n].p(t,a):(W(),O(c[d],1,1,(()=>{c[d]=null})),N(),i=c[n],i?i.p(t,a):(i=c[n]=r[n](t),i.c()),q(i,1),i.m(e,o));s.$set({})},i:function(t){a||(q(i),q(s.$$.fragment,t),a=!0)},o:function(t){O(i),O(s.$$.fragment,t),a=!1},d:function(i){i&&C(e),c[n].d(),t[35](null),G(s)}};return p("SvelteRegisterBlock",{block:d,id:Xl.name,type:"component",source:"",ctx:t}),d}const Zl=2;function td(t,e,n){let i,{$$slots:o={},$$scope:s}=e;function a(){n(27,C+=1)}function r(t){v&&v.$set(t)}function c(t){v&&v.setPercent(t)}function l(){w.actInfo&&w.actInfo.stage!=Fr&&w.actInfo.song_info?(4==w.actInfo.stage?n(9,T=5+w.actInfo.countdown):n(9,T=5),n(2,R=!0)):_&&_.getTimer()&&w.actInfo.song_info||n(2,R=!1)}function d(t){y&&y.setLyricOffset(t)}function m(t){x&&x.$set({value:t})}function h(t){const e={1:"miss",2:"good",3:"great",4:"perfect"};e[t]&&b&&b.play(`https://asset.tuwan.com/chatroom/ktv/${e[t]}.svga?a=2`)}function u(t){$&&$.draw(t)}function p(t){$&&$.drawCursor(t)}function g(t){n(26,i=t)}f("MainBlock",o,[]);const w=ad.getInstance();let v,_,y,x,b,$,k,C=0,I=4,S=!1,T=5,R=!1,M=!0,A=-1,P=!0;function j(){w.actInfo.stage==Fr&&n(2,R=!1)}function D(t){w.engine&&w.engine.setLyric(t),w.syncEngine&&w.syncEngine.setLyric(t)}function L(){n(2,R=!1),n(11,P=!1)}const E=[];return Object.keys(e).forEach((t=>{~E.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MainBlock> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({MainButton:gl,Lyric:Cl,Prepare:Rl,Score:Ll,Effect:Fl,Stave:ql,Ktv:ad,ACT_STAGE_PREPARE:1,ACT_STAGE_PLAYING:Fr,ACT_STAGE_STOP:3,ACT_STAGE_END:4,forceUpdate:a,updateMainButtonState:r,updateMainButtonProgress:c,updatePrepareVisible:l,setLyricOffset:d,updateScore:m,playEffect:h,updateStaveDraw:u,updateStaveCursor:p,updateLyric:g,lyric:i,instance:w,PREPARE_COUNTDOWN:5,LYRIC_COUNT_2:Zl,LYRIC_COUNT_4:4,forceUpdateIndex:C,mainBtnComp:v,prepareComp:_,lyricComp:y,scoreComp:x,effectComp:b,staveComp:$,lyricCount:I,showLyric:S,prepareCountdown:T,showPrepare:R,simulateKeyFunction:M,song_order_id:k,stage:A,showMainBtn:P,prepareCountdownEnd:j,parseXmlCb:D,showLyricCb:L}),t.$inject_state=t=>{"lyric"in t&&n(26,i=t.lyric),"forceUpdateIndex"in t&&n(27,C=t.forceUpdateIndex),"mainBtnComp"in t&&n(0,v=t.mainBtnComp),"prepareComp"in t&&n(4,_=t.prepareComp),"lyricComp"in t&&n(1,y=t.lyricComp),"scoreComp"in t&&n(5,x=t.scoreComp),"effectComp"in t&&n(6,b=t.effectComp),"staveComp"in t&&n(7,$=t.staveComp),"lyricCount"in t&&n(8,I=t.lyricCount),"showLyric"in t&&(S=t.showLyric),"prepareCountdown"in t&&n(9,T=t.prepareCountdown),"showPrepare"in t&&n(2,R=t.showPrepare),"simulateKeyFunction"in t&&n(10,M=t.simulateKeyFunction),"song_order_id"in t&&n(28,k=t.song_order_id),"stage"in t&&n(3,A=t.stage),"showMainBtn"in t&&n(11,P=t.showMainBtn)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{134217729&t.$$.dirty[0]&&(n(3,A=w.actInfo?w.actInfo.stage:-1),w.actInfo&&w.actInfo.song_info?(n(28,k=w.actInfo.song_info.order_id),n(8,I=1==w.actInfo.song_info.score_switch?Zl:4)):S=!0,v&&v.forceUpdate()),268435456&t.$$.dirty[0]&&(n(10,M=!1),setTimeout((()=>{n(10,M=!0)}),0)),335544322&t.$$.dirty[0]&&k&&y&&(y.destoryLyricsPlayer(),w.actInfo&&w.actInfo.song_info&&y.playYinSuDa(i)),4&t.$$.dirty[0]&&w.htmlDom.find(".ktv-room-anchor-container").css("opacity",R?0:1),8&t.$$.dirty[0]&&A==Fr&&n(11,P=!0)},[v,y,R,A,_,x,b,$,I,T,M,P,w,j,D,L,a,r,c,l,d,m,h,u,p,g,i,C,k,function(t){Y[t?"unshift":"push"]((()=>{_=t,n(4,_)}))},function(t){Y[t?"unshift":"push"]((()=>{v=t,n(0,v)}))},function(t){Y[t?"unshift":"push"]((()=>{y=t,n(1,y)}))},function(t){Y[t?"unshift":"push"]((()=>{$=t,n(7,$)}))},function(t){Y[t?"unshift":"push"]((()=>{x=t,n(5,x)}))},function(t){Y[t?"unshift":"push"]((()=>{v=t,n(0,v)}))},function(t){Y[t?"unshift":"push"]((()=>{b=t,n(6,b)}))}]}class ed extends h{constructor(t){super(t),u(this,t,td,Xl,g,{forceUpdate:16,updateMainButtonState:17,updateMainButtonProgress:18,updatePrepareVisible:19,setLyricOffset:20,updateScore:21,playEffect:22,updateStaveDraw:23,updateStaveCursor:24,updateLyric:25},null,[-1,-1]),p("SvelteRegisterComponent",{component:this,tagName:"MainBlock",options:t,id:Xl.name})}get forceUpdate(){return this.$$.ctx[16]}set forceUpdate(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateMainButtonState(){return this.$$.ctx[17]}set updateMainButtonState(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateMainButtonProgress(){return this.$$.ctx[18]}set updateMainButtonProgress(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updatePrepareVisible(){return this.$$.ctx[19]}set updatePrepareVisible(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get setLyricOffset(){return this.$$.ctx[20]}set setLyricOffset(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateScore(){return this.$$.ctx[21]}set updateScore(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playEffect(){return this.$$.ctx[22]}set playEffect(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateStaveDraw(){return this.$$.ctx[23]}set updateStaveDraw(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateStaveCursor(){return this.$$.ctx[24]}set updateStaveCursor(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateLyric(){return this.$$.ctx[25]}set updateLyric(t){throw new Error("<MainBlock>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const nd=(t={})=>{const{url:e,method:n="GET",onProgress:i,data:o=null}=t;return new Promise((async t=>{const s=await fetch(e,{method:n,body:o}),a=+s.headers.get("content-length"),r=new Uint8Array(0==a?2e7:a);let c=0;const l=s.body.getReader();let d=0;for(;;){const{done:t,value:e}=await l.read();if(t)break;r.set(e,c),c+=e.length,d+=e.length,i&&i({loaded:d,total:a})}t(r.buffer)}))},id=class{constructor(t){this._status=0,this.statusChangeCb=null,this.playMusicTickCb=null,this.downloadTickCb=null,this.downloadMuiscErrorCb=null,this.playendCb=null,this.code=null,this.originalTrack=null,this.accompaniedTrack=null,this.defaultGain=0,this.autoPlay=!1,this.isSeeked=!1,this.volumeMultiple=2,this.volumeValue=100,this.tickTime=20,this.zcm=null,this.resource_id=null,this._pause=!1,this.isStatusNext=!0,this.engine=t}get isOriginalBgmStart(){var t;return(null==(t=null==this?void 0:this.originalTrack)?void 0:t.getCurrentTime())>0}get isAccompanyBgmStart(){var t;return(null==(t=null==this?void 0:this.accompaniedTrack)?void 0:t.getCurrentTime())>0}destroy(){9!=this.status&&this.onStopLocalAudioMixin()}set status(t){this.isStatusNext||(this._status=t),this.statusChangeCb&&this.statusChangeCb(t),this.isStatusNext&&(this._status=t)}get status(){return this._status}play(t,e,n){if(0!=this.status)throw new Error("此对象已经被使用过，不能在使用");if(window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin"))return void Vt("您还未开麦,请开麦后再试..");Vt("正在加载歌曲..."),this.code=t,this.status=1;const i=this;qt.get(Ot.getSongInfo(t,e,n)).then((t=>{if(0==t.error){if(null==t.data.playUrl)return void Vt("歌曲地址错误,请删除该歌曲重新点歌..");i.playWithUrl(t.data.playUrl)}else"异常数据请求"==t.error_msg?Vt("您收藏的歌曲资源可能过期了,请删除重新点歌"):Vt(t.error_msg)}))}preloadUrl(t){this.autoPlay=!1,uu.isYinSuDa()?this.extractAudioNew():this.extractAudio(t)}playWithUrl(t){this.autoPlay=!0,3==uu.getRoomInfo().yjx_song_switch?this.extractAudioNew():this.extractAudio(t)}async extractAudio(t){this.status=3;let e=t.split("|"),n=0,i=0;try{const t=await Promise.all([nd({url:e[0],onProgress:({loaded:t,total:e})=>{n=t/e,this.progressTick(n,i)}}),nd({url:e[1],onProgress:({loaded:t,total:e})=>{i=t/e,this.progressTick(n,i)}})]);if(9==this.status)return;this.status=4,await this.createCustomAudioTrack(t),this.autoPlay&&8!=this.status&&await this.startPlay()}catch(o){console.log(o),this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb(o)}}async extractAudioNew(){await this.createCustomAudioTrackNew(),this.autoPlay&&8!=this.status&&await this.startPlay()}async startPlay(){if(9!=this.status){if(this.autoPlay=!0,6!=this.status)throw new Error("startPlay失败，因为歌曲没加载好了");await this.playCustomAudioTrack(),this.status=8,this.startReportTimer()}}async createCustomAudioTrack(t){if(9==this.status)return;id._decodeAudio||(id._decodeAudio=new AudioContext),this.status=5;const[e,n]=t,i=await id._decodeAudio.decodeAudioData(e);if(9==this.status)return;if(this.originalTrack=await window.AgoraRTC.createBufferSourceAudioTrack({source:i}),9==this.status)return void this.destoryAudioTrack();this.originalTrack.setVolume(this.volumeValue*this.volumeMultiple);const o=await id._decodeAudio.decodeAudioData(n);9!=this.status&&(this.accompaniedTrack=await window.AgoraRTC.createBufferSourceAudioTrack({source:o}),9!=this.status?(this.accompaniedTrack.setVolume(this.volumeValue*this.volumeMultiple),this.status=6):this.destoryAudioTrack())}async createCustomAudioTrackNew(){var t,e;this.originalTrack=this.engine.originalBgmTrack,null==(t=this.originalTrack)||t.setVolume(this.volumeValue*this.volumeMultiple),this.accompaniedTrack=this.engine.accompanyBgmTrack,null==(e=this.accompaniedTrack)||e.setVolume(this.volumeValue*this.volumeMultiple),this.status=6}async playCustomAudioTrack(){if(9!=this.status)if(this.status=7,uu.isYinSuDa())1==this.defaultGain?this.engine.playBgm(1):this.engine.playBgm(2);else if(1==this.defaultGain){if(this.originalTrack){let t=this.originalTrack.getCurrentTime();this.originalTrack.play(),this.originalTrack.startProcessAudioBuffer(),this.originalTrack.seekAudioBuffer(t),this._pause&&this.originalTrack.pauseProcessAudioBuffer()}}else if(this.accompaniedTrack){let t=this.accompaniedTrack.getCurrentTime();this.accompaniedTrack.play(),this.accompaniedTrack.startProcessAudioBuffer(),this.accompaniedTrack.seekAudioBuffer(t),this._pause&&this.accompaniedTrack.pauseProcessAudioBuffer()}}onTaggerGain(){var t,e,n,i,o,s,a,r,c,l,d,m,h,u;if(9!=this.status)if(1==this.defaultGain){if(this.originalTrack)if(3==uu.getRoomInfo().yjx_song_switch){let r=this.originalTrack.getCurrentTime(),c=this.accompaniedTrack.getCurrentTime(),l=r>c?r:c;null==(t=this.accompaniedTrack)||t.pauseProcessAudioBuffer(),this.isOriginalBgmStart?(null==(e=this.originalTrack)||e.seekAudioBuffer(l),this._pause||null==(n=this.originalTrack)||n.resumeProcessAudioBuffer()):this._pause?null==(a=this.originalTrack)||a.seekAudioBuffer(l):(null==(i=this.originalTrack)||i.startProcessAudioBuffer(),null==(o=this.originalTrack)||o.seekAudioBuffer(l),null==(s=this.originalTrack)||s.play())}else{this.accompaniedTrack.stop();let t=this.accompaniedTrack.getCurrentTime();this.accompaniedTrack.stopProcessAudioBuffer(),this._pause||this.originalTrack.play(),this.originalTrack.startProcessAudioBuffer(),this.originalTrack.seekAudioBuffer(t)}}else if(this.originalTrack)if(3==uu.getRoomInfo().yjx_song_switch){let t=this.originalTrack.getCurrentTime(),e=this.accompaniedTrack.getCurrentTime(),n=t>e?t:e;null==(r=this.originalTrack)||r.pauseProcessAudioBuffer(),this.isAccompanyBgmStart?(null==(c=this.accompaniedTrack)||c.seekAudioBuffer(n),this._pause||null==(l=this.accompaniedTrack)||l.resumeProcessAudioBuffer()):this._pause?null==(u=this.accompaniedTrack)||u.seekAudioBuffer(n):(null==(d=this.accompaniedTrack)||d.startProcessAudioBuffer(),null==(m=this.accompaniedTrack)||m.seekAudioBuffer(n),null==(h=this.accompaniedTrack)||h.play())}else{this.originalTrack.stop();let t=this.originalTrack.getCurrentTime();this.originalTrack.stopProcessAudioBuffer(),this._pause||this.accompaniedTrack.play(),this.accompaniedTrack.startProcessAudioBuffer(),this.accompaniedTrack.seekAudioBuffer(t)}}pause(){this._pause=!0,1==this.defaultGain?this.originalTrack&&this.originalTrack.pauseProcessAudioBuffer():this.accompaniedTrack&&this.accompaniedTrack.pauseProcessAudioBuffer()}resume(){this._pause=!1,1==this.defaultGain?this.originalTrack&&this.originalTrack.resumeProcessAudioBuffer():this.accompaniedTrack&&this.accompaniedTrack.resumeProcessAudioBuffer()}progressTick(t,e){this.downloadTickCb&&this.downloadTickCb(.5*t+.5*e)}seekOnce(t){if(6==this.status&&this.originalTrack&&this.accompaniedTrack&&!this.isSeeked)return this.isSeeked=!0,this.seek(t),!0}seek(t){9!=this.status&&this.originalTrack&&this.accompaniedTrack&&(uu.isYinSuDa()?setTimeout((()=>{this.engine.seekBgmProgress(1e3*t)}),0):1==this.defaultGain?(this.originalTrack.startProcessAudioBuffer(),this.originalTrack.seekAudioBuffer(t)):(this.accompaniedTrack.startProcessAudioBuffer(),this.accompaniedTrack.seekAudioBuffer(t)))}currentTrack(){return 1==this.defaultGain?this.originalTrack:this.accompaniedTrack}startReportTimer(){let t;t=3==uu.getRoomInfo().yjx_song_switch?this.accompaniedTrack.source.duration||Math.floor(this.engine.bgmDuration/1e3):this.accompaniedTrack.source.duration,this.reportTimer=setInterval((()=>{let e=0;this.originalTrack&&1==this.defaultGain?e=this.originalTrack.getCurrentTime():this.accompaniedTrack&&0==this.defaultGain&&(e=this.accompaniedTrack.getCurrentTime()),this.playMusicTick(e,t)}),this.tickTime)}playMusicTick(t,e){9!=this.status&&(this.playMusicTickCb&&this.playMusicTickCb(t,e),t+1>=e&&(this.onStopLocalAudioMixin(),this.playendCb&&this.playendCb()))}changeVolume(t){this.originalTrack&&this.originalTrack.setVolume(t*this.volumeMultiple),this.accompaniedTrack&&this.accompaniedTrack.setVolume(t*this.volumeMultiple)}onStopLocalAudioMixin(){this.status=9,this.clearReportTimer(),this.destoryAudioTrack()}clearReportTimer(){this.reportTimer&&(window.clearInterval(this.reportTimer),this.reportTimer=null)}destoryAudioTrack(){this.originalTrack&&(this.originalTrack.stopProcessAudioBuffer(),this.originalTrack.stop(),this.originalTrack.close(),this.originalTrack=null),this.accompaniedTrack&&(this.accompaniedTrack.stopProcessAudioBuffer(),this.accompaniedTrack.stop(),this.accompaniedTrack.close(),this.accompaniedTrack=null)}};let od=id;m(od,"_decodeAudio",null);const sd=[3,4,5,6,7,8];let ad=class t extends ya{constructor(){super(),this.jiabinConDom=null,this.muiscInfoComp=null,this.hiRankBtnComp=null,this.mainBlockComp=null,this.controlModuleComp=null,this.selectedMusicData=null,this.roleSongTagComp=null,this.actInfo=null,this.setRole=null,this.showLoginWindow=null,this.bgmVolumeValue=40,this.localVolumeValue=100,this.songReportTimer=null,this.anchorReportTimer=null,this.pitchReportTimer=null,this.qucikMockPlayProgressTimer=null,this.controlData={original_switch:2,score_switch:1},this.handclapSound=null,this.syncEngine=null,this.currentPlayingSongCode=null,this.currentPlayingTime=+new Date}static getInstance(){return this.instance||(this.instance=new t),this.instance}onReset(t=!0){super.onReset(t),t&&(this.clearSvelteComps(["muiscInfoComp","hiRankBtnComp","mainBlockComp","controlModuleComp","roleSongTagComp"]),this.jiabinConDom=null),this.selectedMusicData=null,this.actInfo=null,this.setRole=null,this.showLoginWindow=null,this.clearSongReportTimer(),this.clearAnchorReportTimer(),this.clearPitchReportTimer(),this.clearQucikMockPlayProgressTimer(),this.controlData={original_switch:2,score_switch:1},this.handclapSound=null,this.syncEngine=null}initTemplate(t){super.initTemplate(),this.selectedMusicData=new al,this.selectedMusicData.changeCallback=()=>{const t=this.modals.get(Wc);t&&t.updateSelectedData(),this.controlModuleComp&&this.controlModuleComp.forceUpdate()},this.initHtml(t),this.requestBaseData(),this.huatongIsOpen()||this.reportMicrophoneState(2),this.handclapSound=new window.Howl({src:["https://asset.tuwan.com/chatroom/ktv/guzhang.mp3"],volume:xt.getInstance().getMainVolume()/100*.5}),this.createSyncEngine()}initHtml(t){const e=`\n            <div class="ktv-room-anchor-container">\n                ${Fi._getOtherAnchorSeatHtml({position:1,shouhutype:1,index:0,role:"",defaultbg:"default",pwidth:130,pheight:160,width:110,height:110,isshowmeili:!1,closeHide:!0})}\n            </div>\n        `,n=`\n            <div class="ktv-room-jiabin flex flex-ac flex-jc">\n                ${sd.map((t=>Fi._getOtherAnchorSeatHtml({position:t,shouhutype:1,index:0,role:"",defaultbg:"add",pwidth:124,pheight:120,width:80,height:80,isshowmeili:!1}))).join("")}\n            </div>\n        `;this.htmlDom=window.$(`\n            <div class="ktv-room-content flex flex-jc" style="height: 540px;">\n                <div class="ktv-background-img"></div>\n                <div class="ktv-room_wrapper flex flex-dir-col flex-ac">\n                    <div class="ktv-room_wrapper_topRow flex flex-ac flex-between"/>\n                    ${e}\n                    <div class="ktv-content-center_main-block"></div>\n                    <div class="ktv-content-center_control"></div>\n                    ${n}\n                    <div class="ktv all_faces"/>\n                </div>\n                <div style="position: absolute; left: 30px; top: 35px;">\n                    <div class="song-but song-but-clockin flex flex-jc flex-ac hide">打卡</div>\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom),ci.show(3,ci.type.smallKtvLeave),this.createRoleSongTag(),this.createTopViews(),this.createCenterBlock(),this.createControlModule(),this.updateMainSeatName(),this.requestControlData()}requestBaseData(){qt.get(Ot.getKtvBaseData(uu.getCid())).then((t=>{0==t.error?(this.actInfo=t.data,this.actInfo.song_info&&null==this.actInfo.song_info.name?this.actInfo.song_info=null:this.actInfo.song_info.score_switch=t.data.score_switch,this.mainChannel.foreverSubscribe(t.data.bgm_player_uid),this.joinSubChannel(),this.updateStageState(),this.updateChannelState(),4==this.actInfo.stage&&t.data.settlement_song_info&&t.data.settlement_song_info.name&&this.showResultModal({data:{countdown:t.data.countdown,song_info:t.data.settlement_song_info}})):Vt(t.error_msg)}))}requestControlData(){qt.get(Ot.getKtvSoundConsole(uu.getCid())).then((t=>{0==t.error&&(this.controlData=t.data,this.muiscInfoComp&&this.muiscInfoComp.forceUpdate())}))}updateSeats(){this.actInfo&&(this.repeatRefresh(),this.updateChannelState(),this.updateChorusRoleVolume(),this.updateAnchorMicrophoneState(),this.updateChorusRoleTag(),this.updateMainSeatName(),this.checkReportVolume(),this.updateEvaluateScoreState(),this.checkMicrophoneIsSecretlyOpened())}updateSocketData(t){if(!this.actInfo)return;const e=t.data;switch(t.mark){case"stage":this.updateStage(e);break;case"add_song":this.selectedMusicData.add(e);break;case"del_song":this.selectedMusicData.delete(e);break;case"next_song":e.song_info&&e.song_info.name?(this.actInfo.song_info=e.song_info,this.actInfo.song_info.score_switch=e.score_switch,this.actInfo.song_info.original_switch=e.original_switch):this.actInfo.song_info=null,this.updateStageState();break;case"download":this.downloadSong(e.song_info);break;case"voice_print":for(const t of e.volume_list)this.checkUserShowOrHideWave(t,t.volume);break;case"score":this.actInfo.song_info&&(this.actInfo.song_info.score=e.score),this.mainBlockComp&&this.mainBlockComp.updateScore(e.score),this.mainBlockComp&&this.mainBlockComp.playEffect(e.grade||0);break;case"score_switch":this.actInfo.song_info&&(this.actInfo.song_info.score_switch=e.score_switch),this.mainBlockComp&&this.mainBlockComp.forceUpdate();break;case"original_switch":this.actInfo.song_info&&(this.actInfo.song_info.original_switch=e.original_switch),this.muiscInfoComp&&this.muiscInfoComp.forceUpdate()}}updateStage(t){if(!this.actInfo)return;const e=t,{song_info:n}=e,i=d(e,["song_info"]);this.actInfo=c(c({},this.actInfo),i),1==this.actInfo.stage&&(this.actInfo.song_info=null),this.updateStageState(),4==this.actInfo.stage&&this.showResultModal({data:t})}updateStageState(){this.updateChorusRoleVolume(),this.repeatRefresh(),this.mainBlockComp&&this.mainBlockComp.updatePrepareVisible(),this.updateReportRtcScore(),this.updateEvaluateScoreState(),this.updateChannelState(),this.checkQucikMockPlayProgressTimer()}repeatRefresh(){this.checkStreamTimer(),this.updateMusicState(),this.updateMusicInfo(),this.updateMainBlock(),this.updateReportRtcScore(),this.checkPitchTimer();const t=this.modals.get(Wc);t&&t.updateSelectedData()}updateChannelState(){if(this.actInfo){const t=this.actInfo.robot_uid;if(!this.subChannel)return;if(this.mineIsAudience()&&1!=this.actInfo.stage)this.subChannel.subscribe(t),this.mainChannel.unsubscribeAll(),this.subscribeSet.clear();else{this.subChannel.unsubscribe(t);const e=Array.from(uu.anchorUsers.values()),n=vs(this.subscribeSet,new Set(e.map((t=>t.uid))));for(const t of n)this.mainChannel.unsubscribe(t),this.subscribeSet.delete(t);for(const t of e.map((t=>t.uid)))t==uu.getMeid()||this.subscribeSet.has(t)||(this.subscribeSet.add(t),this.mainChannel.subscribe(t))}}}updateMainBlock(){this.actInfo&&this.mainBlockComp&&this.mainBlockComp.forceUpdate()}updateMusicInfo(){this.actInfo&&this.muiscInfoComp&&this.muiscInfoComp.forceUpdate()}updateMusicState(){!this.mineIsMainSong()||this.actInfo.stage!=Fr||this.loadMuisc?(this.actInfo.stage==Fr&&(this.mineIsMainSong()?this.checkAnchorMusicLoaded():this.mineIsChorus()?this.loadMuisc||this.downloadSong(this.actInfo.song_info):this.destroyLoadMuisc(),this.mineIsMainSong()||this.leaveSubChannelBgm()),3==this.actInfo.stage&&(this.destroyLoadMuisc(),this.leaveSubChannelBgm())):this.downloadSong(this.actInfo.song_info)}updateReportRtcScore(){this.clearSongReportTimer(),this.mineIsAudience()||8!=this.actInfo.state||(this.songReportTimer=setInterval((()=>{this.reportRtcScore()}),3e3))}updateChorusRoleTag(){if(this.jiabinConDom||(this.jiabinConDom=this.htmlDom.find(".ktv-room-jiabin")),this.jiabinConDom){const t=this.getAnchoringUserFromPosition(1),e=!(!this.actInfo||!this.actInfo.song_info);for(const n of sd){const i=this.jiabinConDom.find(`.seat-item-empty[data-aposition="${n}"] .seat-role-tag`),o=this.getAnchoringUserFromPosition(n);o?e&&t&&t.uid==o.uid?i.text("演唱").css("background-color","#FF6F99").css("color","white").show():e&&1==o.wheat_switch?i.text("合唱").css("background-color","white").css("color","#FF6691").show():1==o.owner?i.text("房主").css("background-color","#892EFF").css("color","white").show():i.hide():i.hide()}}}checkMicrophoneIsSecretlyOpened(){!this.mineIsMainSong()&&this.microphoneReday&&this.mainChannel.published&&!this.huatongIsOpen()?this.setRole(0):this.mineIsAudience()&&this.huatongIsOpen()&&this.chorusAutoCloseMicrophone()}checkReportVolume(){this.getAnchorKengUser(uu.getMeid())?this.startCaptureAudio(!0):this.stopCaptureAudio()}updateMainSeatName(){this.htmlDom.find(".ktv-room-anchor-container .seat-item-empty .seat-user-name").css("opacity",this.getAnchoringUserFromPosition(1)?1:0)}async downloadSong(t){var e;console.log(t);const n=t.song_url;this.mainBlockComp.updateMainButtonState({download:!0}),await this.createLoadMuisc(t),null==(e=this.loadMuisc)||e.preloadUrl(n)}isSonger(){return!!this.actInfo&&(this.actInfo.stage==Fr&&(this.mineIsMainSong()||this.mineIsChorus()))}engineTimeUpdate(t){super.engineTimeUpdate(t),this.mineIsMainSong()&&this.actInfo&&this.actInfo.song_info&&qt.get(Ot.getKtvReportProgress(uu.getCid(),this.actInfo.song_info.order_id,1e3*t.progress))}engineLineEnd(t){super.engineLineEnd(t);let{line:e,score:n}=t;this.huatongIsOpen()||(n=0),qt.get(Ot.getKtvReportScore(uu.getCid(),this.actInfo.song_info.order_id,e+1,n)).then((t=>{}))}engineDraw(t){this.mineIsMainSong()&&(this.huatongIsOpen()||(t.filterColoringReactInfo=[]),this.mainBlockComp&&this.mainBlockComp.updateStaveDraw(t))}engineCursor(t){if(this.mineIsMainSong()){let e=t.y;this.huatongIsOpen()||(e=0),this.mainBlockComp&&this.mainBlockComp.updateStaveCursor(e)}}syncEngineDraw(t){this.mineIsMainSong()||this.mainBlockComp&&this.mainBlockComp.updateStaveDraw(t)}syncEngineCursor(t){this.mineIsMainSong()||this.mainBlockComp&&this.mainBlockComp.updateStaveCursor(t.y)}setMainSongProgress(t){this.syncEngine.setTime(t),this.clearQucikMockPlayProgressTimer(),this.qucikMockPlayProgressTimer=setInterval((()=>{t+=.02,this.syncEngine.setTime(t)}),20)}setMainSongPitch(t){this.syncEngine.setPitch(t)}async createLoadMuisc(t){if(uu.isYinSuDa()){const n=t.song_code+"";if(this.currentPlayingSongCode==n&&+new Date-this.currentPlayingTime<1e4)return;try{this.currentPlayingSongCode=n,this.currentPlayingTime=+new Date,await this.new_engine.setUser(uu.getMeid()),this.lyric=await this.new_engine.getLyric(n,!0),this.pitchData=await this.new_engine.getPitchData(n),this.mainBlockComp&&this.mainBlockComp.updateLyric(this.lyric),this.new_engine.prepare(),await this.new_engine.genBgmTracks(n,!0),t.uid==uu.getMeid()&&(await this.new_engine.justStartBgmTimer(),this.new_engine.setAudioTrack(uu.globalRtcClient.agoraRtc.localAudio),this.new_engine.startProcessAudio())}catch(e){console.log(e)}console.log("音速达好了 ----"+n+"time="+new Date)}this.destroyLoadMuisc(),this.loadMuisc=new od(this.new_engine),this.loadMuisc.volumeValue=this.bgmVolumeValue,this.loadMuisc.isStatusNext=!1,this.loadMuisc.defaultGain=1==this.controlData.original_switch?1:0,this.loadMuisc.code=t.song_code,this.loadMuisc.playMusicTickCb=this.muiscTick.bind(this),this.loadMuisc.statusChangeCb=this.musicStateChange.bind(this),this.loadMuisc.downloadTickCb=this.musicDownloadPercent.bind(this),this.loadMuisc.playendCb=this.muiscEndCb.bind(this),this.loadMuisc.downloadMuiscErrorCb=()=>{Vt("歌曲加载失败，请稍后重试"),this.destroyLoadMuisc(),this.mainBlockComp.updateMainButtonState({defaultGaindownload:!1})}}setLyricOffset(t){this.mainBlockComp.setLyricOffset(t)}muiscTick(t){this.mineIsAudience()||this.engine.setTime(t)}musicStateChange(t){4==t&&this.mainBlockComp.updateMainButtonState({download:!1}),6==t&&(qt.get(Ot.getKtvDownload(uu.getCid(),this.loadMuisc.code)),this.mineIsMainSong()&&this.actInfo.stage==Fr&&this.actInfo&&this.actInfo.song_info&&this.checkAnchorMusicLoaded(1*(this.actInfo.song_info.progress||0)/1e3))}musicDownloadPercent(t){this.mainBlockComp.updateMainButtonProgress(t)}muiscEndCb(){this.mineIsMainSong()&&this.actInfo&&this.actInfo.song_info&&qt.get(Ot.getKtvPlayEnd(uu.getCid(),this.actInfo.song_info.order_id))}updateChorusRoleVolume(){}updateMusicCountdown(t){if(!this.actInfo||!this.actInfo.song_info)return;const e=this.actInfo.song_info.duration-parseInt(t);this.actInfo.stage==Fr&&this.muiscInfoComp&&this.muiscInfoComp.$set({seconds:e})}checkStreamTimer(){this.mineIsMainSong()||this.mineInAnchors()&&1==this.actInfo.stage?this.anchorReportTimer||(this.anchorReportTimer=setInterval((()=>{this.reportRtcMixerStatus()}),200)):this.clearAnchorReportTimer()}checkPitchTimer(){this.actInfo&&0!=this.actInfo.sound_track_switch&&(this.mineIsMainSong()&&this.actInfo.stage==Fr?this.pitchReportTimer||(this.pitchReportTimer=setInterval((()=>{uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({cmd:"setVoicePitch",pitch:this.huatongIsOpen()?this.engine.pitch:0,songIdentifier:this.actInfo.song_info.song_code,forward:!0}),syncWithAudio:!0})}),50)):this.clearPitchReportTimer())}checkQucikMockPlayProgressTimer(){this.actInfo.stage!=Fr&&this.clearQucikMockPlayProgressTimer()}setLoadVolemeValue(){uu.isKtvSmallRoom()&&this.mainChannel.setLocalAudioVolume(this.localVolumeValue)}checkAnchorCanDisposeMicrophone(t=!0){return!!(uu.isKtvSmallRoom()&&this.getAnchorKengUser(uu.getMeid())&&this.microphoneReday&&this.mainChannel.published)&&(this.mainChannel.setLocalAudioVolume(t?this.localVolumeValue:0),!0)}createRoleSongTag(){this.roleSongTagComp=new Qc({target:this.htmlDom.find(".ktv-room-anchor-container")[0]})}createTopViews(){const t=this.htmlDom.find(".ktv-room_wrapper_topRow")[0];this.muiscInfoComp=new Gr({target:t}),this.hiRankBtnComp=new Kr({target:t})}createCenterBlock(){this.mainBlockComp=new ed({target:this.htmlDom.find(".ktv-content-center_main-block")[0]})}createControlModule(){this.controlModuleComp=new Xr({target:this.htmlDom.find(".ktv-content-center_control")[0]})}createSyncEngine(){this.syncEngine=new qs,this.syncEngine.lineAreaWidth=600,this.syncEngine.lineAreaHeight=60,this.syncEngine.on("draw",this.syncEngineDraw.bind(this)),this.syncEngine.on("cursor",this.syncEngineCursor.bind(this))}showAdjustParamsModal(){this.commonShowModal(cc,{bgmValue:this.bgmVolumeValue,bgmChange:t=>{const e=Number(t.target.value);this.bgmVolumeValue=e,this.loadMuisc&&this.loadMuisc.changeVolume(e)},localValue:this.localVolumeValue,localChange:t=>{const e=Number(t.target.value);this.localVolumeValue=e,this.huatongIsOpen()&&this.mainChannel.setLocalAudioVolume(e)},originChange:t=>{qt.get(Ot.getKtvSetOriginalSwitch(uu.getCid(),t?1:2)),this.controlData.original_switch=t?1:2,this.loadMuisc&&(this.loadMuisc.defaultGain=t?1:0,8==this.loadMuisc.status&&this.loadMuisc.onTaggerGain()),this.muiscInfoComp&&this.muiscInfoComp.forceUpdate(),this.getAnchorKengUser(uu.getMeid())||Vt("上麦后生效")},scoreChange:t=>{qt.get(Ot.getKtvSetScoreSwitch(uu.getCid(),t?1:2)),this.controlData.score_switch=t?1:2,this.mineIsMainSong()||Vt("成为演唱者后生效")}})}getChorusMembers(){let t=[];for(const e of sd){const n=this.getSeatSource().getAnchoringUserFromPosition(e);n&&t.push(n)}return t}mineIsPublishStreamRole(){return this.mineIsMainSong()}getAllFacesDom(){return this.htmlDom.find(".all_faces.ktv")}reportMicrophoneState(t){uu.isKtvSmallRoom()&&qt.get(Ot.getKtvReportWheat(uu.getCid(),t))}reportLocalVolume(t){qt.get(Ot.getKtvReportVolume(uu.getCid(),t))}showMusicLibrary(t){this.commonShowModal(Wc,t)}showRankModal(){this.commonShowModal(fr)}showSongRankModal(t){this.commonShowModal(Pr,t)}showResultModal(t){this.commonShowModal(sl,t)}clearSongReportTimer(){this.songReportTimer&&(window.clearInterval(this.songReportTimer),this.songReportTimer=null)}clearAnchorReportTimer(){this.anchorReportTimer&&(window.clearInterval(this.anchorReportTimer),this.anchorReportTimer=null)}clearPitchReportTimer(){this.pitchReportTimer&&(window.clearInterval(this.pitchReportTimer),this.pitchReportTimer=null)}clearQucikMockPlayProgressTimer(){this.qucikMockPlayProgressTimer&&(window.clearInterval(this.qucikMockPlayProgressTimer),this.qucikMockPlayProgressTimer=null)}resetSyncEngine(){this.syncEngine&&this.syncEngine.reset()}};const{Object:rd,console:cd}=et,ld="src/js/components/models/setScore.svelte";function dd(t,e,n){const i=t.slice();return i[42]=e[n],i}function md(t,e,n){const i=t.slice();return i[45]=e[n].id,i[46]=e[n].title,i[48]=n,i}function hd(t,e,n){const i=t.slice();return i[45]=e[n].id,i[46]=e[n].title,i[48]=n,i}function ud(t,e,n){const i=t.slice();return i[45]=e[n].id,i[50]=e[n].value,i}function pd(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,$,k,R,j,D,L,B,F,U,z,O,N,q,G,H,W,K,Y,Q,X,Z,tt,et,nt,it,ot,st,at,rt,ct,lt,dt,mt,ht,ut,pt,gt,ft,wt,vt,_t,yt,xt,bt,$t,kt,Ct,It,St,Tt,Rt,Mt,At,Pt,jt,Dt,Lt,Et,Bt,Ft,Ut,zt,Ot,Nt=t[13][t[3]]+"",qt=(t[7]||"")+"",Gt=t[8];v(Gt);let Vt=[];for(let p=0;p<Gt.length;p+=1)Vt[p]=gd(ud(t,Gt,p));let Ht=t[9];v(Ht);let Wt=[];for(let p=0;p<Ht.length;p+=1)Wt[p]=fd(hd(t,Ht,p));let Kt=t[9];v(Kt);let Yt=[];for(let p=0;p<Kt.length;p+=1)Yt[p]=wd(md(t,Kt,p));let Jt=t[9][t[4]]&&t[9][t[4]].list&&vd(t);const Qt={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),a=M(Nt),c=T(),l=_("div"),d=_("div"),m=_("div");for(let t=0;t<Vt.length;t+=1)Vt[t].c();h=T(),u=_("div"),u.textContent="确认",f=T(),w=_("div"),$=_("div");for(let t=0;t<Wt.length;t+=1)Wt[t].c();R=T(),j=_("div"),D=_("div");for(let t=0;t<Yt.length;t+=1)Yt[t].c();L=T(),B=_("div"),F=_("div"),F.textContent="选择标签",U=T(),z=_("div"),Jt&&Jt.c(),O=T(),N=_("div"),q=T(),G=_("div"),H=_("textarea"),W=T(),K=_("div"),K.textContent="提交",Q=T(),X=_("div"),Z=_("div"),tt=_("div"),et=M("自由分配"),it=T(),ot=_("div"),st=_("div"),at=_("span"),at.textContent="目标厅ID:",rt=T(),ct=_("input"),lt=T(),dt=_("div"),mt=_("span"),mt.textContent="目标大厅:",ht=T(),ut=_("span"),pt=M(qt),gt=T(),ft=_("div"),ft.textContent="确认",vt=T(),_t=_("div"),yt=_("div"),xt=_("span"),xt.textContent="是否确认队长:",bt=T(),$t=_("span"),kt=M(t[2]),Ct=M("("),It=M(t[1]),St=M(")"),Tt=T(),Rt=_("div"),Mt=_("span"),Mt.textContent="录入大厅:",At=T(),Pt=_("span"),jt=M(t[7]),Dt=M("("),Lt=M(t[6]),Et=M(")"),Bt=T(),Ft=_("div"),Ft.textContent="确认",y(n,"class","bg s-lcDv-07WYg8p"),x(n,ld,219,8,5871),y(s,"class","title s-lcDv-07WYg8p"),y(s,"style",r="display: "+(5!=t[3]?"block":"none")),x(s,ld,221,12,5965),y(m,"class","tabListCtn s-lcDv-07WYg8p"),x(m,ld,227,20,6327),y(u,"class","confirmBtn step1 s-lcDv-07WYg8p"),x(u,ld,237,20,6770),y(d,"class","step1Ctn s-lcDv-07WYg8p"),y(d,"style",g="display: "+(1==t[3]?"block":"none")),x(d,ld,226,16,6226),y($,"class","innerCtn s-lcDv-07WYg8p"),x($,ld,241,20,6981),y(w,"class","step2Ctn s-lcDv-07WYg8p"),y(w,"style",k="display: "+(2==t[3]?"block":"none")),x(w,ld,240,16,6880),y(D,"class","innerCtn s-lcDv-07WYg8p"),x(D,ld,252,20,7582),y(F,"class","leftCtn s-lcDv-07WYg8p"),x(F,ld,261,24,8120),y(z,"class","tabListCtn s-lcDv-07WYg8p"),x(z,ld,262,24,8176),A(N,"clear","both"),x(N,ld,274,24,8872),y(B,"class","tabListContainer s-lcDv-07WYg8p"),x(B,ld,260,20,8065),y(H,"class","textareaCtn s-lcDv-07WYg8p"),y(H,"placeholder","还不行，TA还有哪些不足"),x(H,ld,277,24,8982),x(G,ld,276,20,8952),y(K,"class","confirmBtn step2 s-lcDv-07WYg8p"),x(K,ld,279,20,9116),y(j,"class","step3Ctn s-lcDv-07WYg8p"),y(j,"style",Y="display: "+(3==t[3]?"block":"none")),x(j,ld,251,16,7481),y(tt,"class",nt=`smallBtn ${3==t[10]?"active":""} s-lcDv-07WYg8p`),x(tt,ld,287,24,9728),y(Z,"class","topBtnGroup s-lcDv-07WYg8p"),x(Z,ld,283,20,9329),y(at,"class","leftTitle s-lcDv-07WYg8p"),x(at,ld,292,28,10095),y(ct,"class","inputCtn s-lcDv-07WYg8p"),y(ct,"type","text"),y(ct,"placeholder","请输入厅ID"),x(ct,ld,293,28,10161),y(st,"class","itemCtn s-lcDv-07WYg8p"),x(st,ld,291,24,10045),y(mt,"class","leftTitle s-lcDv-07WYg8p"),x(mt,ld,302,28,10569),y(ut,"class","resultTitle"),x(ut,ld,302,65,10606),y(dt,"class","itemCtn s-lcDv-07WYg8p"),x(dt,ld,301,24,10519),y(ot,"class","bottomCtn_5 s-lcDv-07WYg8p"),A(ot,"display",""+(2==t[10]?"block":"none")),x(ot,ld,290,20,9930),y(ft,"class","confirmBtn step_456_btn s-lcDv-07WYg8p"),x(ft,ld,305,20,10736),y(X,"class","step4Ctn step_4_Ctn"),y(X,"style",wt="display: "+(4==t[3]?"block":"none")),x(X,ld,282,16,9217),y(xt,"class","leftCtn s-lcDv-07WYg8p"),x(xt,ld,309,24,10999),y($t,"class","rightCtn"),x($t,ld,310,24,11060),y(yt,"class","itemCtn s-lcDv-07WYg8p"),x(yt,ld,308,20,10953),y(Mt,"class","leftCtn s-lcDv-07WYg8p"),x(Mt,ld,313,24,11201),y(Pt,"class","rightCtn"),x(Pt,ld,314,24,11260),y(Rt,"class","itemCtn s-lcDv-07WYg8p"),x(Rt,ld,312,20,11155),y(Ft,"class","confirmBtn step_5_btn s-lcDv-07WYg8p"),x(Ft,ld,316,20,11358),y(_t,"class","step5Ctn s-lcDv-07WYg8p"),y(_t,"style",Ut="display: "+(5==t[3]?"block":"none")),x(_t,ld,307,16,10852),y(l,"class","innerCtn s-lcDv-07WYg8p"),x(l,ld,225,12,6187),y(o,"class","setScoreCtn s-lcDv-07WYg8p"),x(o,ld,220,8,5927),y(e,"id","setScoreModel"),y(e,"class","s-lcDv-07WYg8p"),x(e,ld,218,4,5838)},m:function(r,p){b(r,e,p),I(e,n),I(e,i),I(e,o),I(o,s),I(s,a),I(o,c),I(o,l),I(l,d),I(d,m);for(let t=0;t<Vt.length;t+=1)Vt[t]&&Vt[t].m(m,null);I(d,h),I(d,u),I(l,f),I(l,w),I(w,$);for(let t=0;t<Wt.length;t+=1)Wt[t]&&Wt[t].m($,null);I(l,R),I(l,j),I(j,D);for(let t=0;t<Yt.length;t+=1)Yt[t]&&Yt[t].m(D,null);I(j,L),I(j,B),I(B,F),I(B,U),I(B,z),Jt&&Jt.m(z,null),I(B,O),I(B,N),I(j,q),I(j,G),I(G,H),J(H,t[12]),I(j,W),I(j,K),I(l,Q),I(l,X),I(X,Z),I(Z,tt),I(tt,et),I(X,it),I(X,ot),I(ot,st),I(st,at),I(st,rt),I(st,ct),J(ct,t[6]),I(ot,lt),I(ot,dt),I(dt,mt),I(dt,ht),I(dt,ut),I(ut,pt),I(X,gt),I(X,ft),I(l,vt),I(l,_t),I(_t,yt),I(yt,xt),I(yt,bt),I(yt,$t),I($t,kt),I($t,Ct),I($t,It),I($t,St),I(_t,Tt),I(_t,Rt),I(Rt,Mt),I(Rt,At),I(Rt,Pt),I(Pt,jt),I(Pt,Dt),I(Pt,Lt),I(Pt,Et),I(_t,Bt),I(_t,Ft),zt||(Ot=[E(n,"click",t[14],!1,!1,!1,!1),E(u,"click",t[26],!1,!1,!1,!1),E(H,"input",t[30]),E(K,"click",t[17],!1,!1,!1,!1),E(tt,"click",t[31],!1,!1,!1,!1),E(ct,"input",t[32]),E(ct,"keyup",t[33],!1,!1,!1,!1),E(ft,"click",t[34],!1,!1,!1,!1),E(Ft,"click",t[35],!1,!1,!1,!1)],zt=!0)},p:function(t,e){if(8&e[0]&&Nt!==(Nt=t[13][t[3]]+"")&&P(a,Nt),8&e[0]&&r!==(r="display: "+(5!=t[3]?"block":"none"))&&y(s,"style",r),2304&e[0]){let n;for(Gt=t[8],v(Gt),n=0;n<Gt.length;n+=1){const i=ud(t,Gt,n);Vt[n]?Vt[n].p(i,e):(Vt[n]=gd(i),Vt[n].c(),Vt[n].m(m,null))}for(;n<Vt.length;n+=1)Vt[n].d(1);Vt.length=Gt.length}if(8&e[0]&&g!==(g="display: "+(1==t[3]?"block":"none"))&&y(d,"style",g),33296&e[0]){let n;for(Ht=t[9],v(Ht),n=0;n<Ht.length;n+=1){const i=hd(t,Ht,n);Wt[n]?Wt[n].p(i,e):(Wt[n]=fd(i),Wt[n].c(),Wt[n].m($,null))}for(;n<Wt.length;n+=1)Wt[n].d(1);Wt.length=Ht.length}if(8&e[0]&&k!==(k="display: "+(2==t[3]?"block":"none"))&&y(w,"style",k),66064&e[0]){let n;for(Kt=t[9],v(Kt),n=0;n<Kt.length;n+=1){const i=md(t,Kt,n);Yt[n]?Yt[n].p(i,e):(Yt[n]=wd(i),Yt[n].c(),Yt[n].m(D,null))}for(;n<Yt.length;n+=1)Yt[n].d(1);Yt.length=Kt.length}t[9][t[4]]&&t[9][t[4]].list?Jt?Jt.p(t,e):(Jt=vd(t),Jt.c(),Jt.m(z,null)):Jt&&(Jt.d(1),Jt=null),4096&e[0]&&J(H,t[12]),8&e[0]&&Y!==(Y="display: "+(3==t[3]?"block":"none"))&&y(j,"style",Y),1024&e[0]&&nt!==(nt=`smallBtn ${3==t[10]?"active":""} s-lcDv-07WYg8p`)&&y(tt,"class",nt),64&e[0]&&ct.value!==t[6]&&J(ct,t[6]),128&e[0]&&qt!==(qt=(t[7]||"")+"")&&P(pt,qt),1024&e[0]&&A(ot,"display",""+(2==t[10]?"block":"none")),8&e[0]&&wt!==(wt="display: "+(4==t[3]?"block":"none"))&&y(X,"style",wt),4&e[0]&&P(kt,t[2]),2&e[0]&&P(It,t[1]),128&e[0]&&P(jt,t[7]),64&e[0]&&P(Lt,t[6]),8&e[0]&&Ut!==(Ut="display: "+(5==t[3]?"block":"none"))&&y(_t,"style",Ut)},d:function(t){t&&C(e),S(Vt,t),S(Wt,t),S(Yt,t),Jt&&Jt.d(),zt=!1,V(Ot)}};return p("SvelteRegisterBlock",{block:Qt,id:pd.name,type:"if",source:"(218:0) {#if visible}",ctx:t}),Qt}function gd(t){let e,n,i,o,s,a,r=t[50]+"";function c(){return t[25](t[45])}const l={c:function(){e=_("div"),n=M(r),i=T(),y(e,"class",o=R("tabItem "+(t[11]==t[45]?"active":""))+" s-lcDv-07WYg8p"),x(e,ld,229,28,6440)},m:function(t,o){b(t,e,o),I(e,n),I(e,i),s||(a=E(e,"click",c,!1,!1,!1,!1),s=!0)},p:function(i,s){t=i,256&s[0]&&r!==(r=t[50]+"")&&P(n,r),2304&s[0]&&o!==(o=R("tabItem "+(t[11]==t[45]?"active":""))+" s-lcDv-07WYg8p")&&y(e,"class",o)},d:function(t){t&&C(e),s=!1,a()}};return p("SvelteRegisterBlock",{block:l,id:gd.name,type:"each",source:"(229:24) {#each stepListData as {id, value}}",ctx:t}),l}function fd(t){let e,n,i,o,s,a,r,c,l,d=t[46]+"";function m(){return t[27](t[48],t[45])}const h={c:function(){e=_("div"),n=_("div"),o=T(),s=_("div"),a=M(d),r=T(),y(n,"class",i=R(`itemBg bg${t[48]+1} ${t[4]==t[48]?"active":""}`)+" s-lcDv-07WYg8p"),x(n,ld,244,32,7198),y(s,"class","desc s-lcDv-07WYg8p"),x(s,ld,245,32,7315),y(e,"class","listCtn s-lcDv-07WYg8p"),x(e,ld,243,28,7101)},m:function(t,i){b(t,e,i),I(e,n),I(e,o),I(e,s),I(s,a),I(e,r),c||(l=E(e,"click",m,!1,!1,!1,!1),c=!0)},p:function(e,o){t=e,16&o[0]&&i!==(i=R(`itemBg bg${t[48]+1} ${t[4]==t[48]?"active":""}`)+" s-lcDv-07WYg8p")&&y(n,"class",i),512&o[0]&&d!==(d=t[46]+"")&&P(a,d)},d:function(t){t&&C(e),c=!1,l()}};return p("SvelteRegisterBlock",{block:h,id:fd.name,type:"each",source:"(243:24) {#each stepListData3 as {id, title}",ctx:t}),h}function wd(t){let e,n,i,o,s,a,r,c,l,d=t[46]+"";function m(){return t[28](t[48],t[45])}const h={c:function(){e=_("div"),n=_("div"),o=T(),s=_("div"),a=M(d),r=T(),y(n,"class",i=R(`itemBg bg${t[48]+1} ${t[4]==t[48]?"active":""}`)+" s-lcDv-07WYg8p"),x(n,ld,255,32,7802),y(s,"class","desc s-lcDv-07WYg8p"),x(s,ld,256,32,7919),y(e,"class","listCtn s-lcDv-07WYg8p"),x(e,ld,254,28,7702)},m:function(t,i){b(t,e,i),I(e,n),I(e,o),I(e,s),I(s,a),I(e,r),c||(l=E(e,"click",m,!1,!1,!1,!1),c=!0)},p:function(e,o){t=e,16&o[0]&&i!==(i=R(`itemBg bg${t[48]+1} ${t[4]==t[48]?"active":""}`)+" s-lcDv-07WYg8p")&&y(n,"class",i),512&o[0]&&d!==(d=t[46]+"")&&P(a,d)},d:function(t){t&&C(e),c=!1,l()}};return p("SvelteRegisterBlock",{block:h,id:wd.name,type:"each",source:"(254:24) {#each stepListData3 as {id, title}",ctx:t}),h}function vd(t){let e,n=t[9][t[4]].list;v(n);let i=[];for(let s=0;s<n.length;s+=1)i[s]=_d(dd(t,n,s));const o={c:function(){for(let t=0;t<i.length;t+=1)i[t].c();e=ht()},m:function(t,n){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,n);b(t,e,n)},p:function(t,o){if(4194864&o[0]){let s;for(n=t[9][t[4]].list,v(n),s=0;s<n.length;s+=1){const a=dd(t,n,s);i[s]?i[s].p(a,o):(i[s]=_d(a),i[s].c(),i[s].m(e.parentNode,e))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d:function(t){S(i,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:vd.name,type:"if",source:"(264:28) {#if stepListData3[stepTwoIndex] && stepListData3[stepTwoIndex].list}",ctx:t}),o}function _d(t){let e,n,i,o,s,a,r=t[42]+"";function c(){return t[29](t[42])}const l={c:function(){e=_("div"),n=M(r),i=T(),y(e,"class",o=R("tabItem "+(t[5].indexOf(t[42])>-1?"active":""))+" s-lcDv-07WYg8p"),x(e,ld,265,36,8419)},m:function(t,o){b(t,e,o),I(e,n),I(e,i),s||(a=E(e,"click",c,!1,!1,!1,!1),s=!0)},p:function(i,s){t=i,528&s[0]&&r!==(r=t[42]+"")&&P(n,r),560&s[0]&&o!==(o=R("tabItem "+(t[5].indexOf(t[42])>-1?"active":""))+" s-lcDv-07WYg8p")&&y(e,"class",o)},d:function(t){t&&C(e),s=!1,a()}};return p("SvelteRegisterBlock",{block:l,id:_d.name,type:"each",source:"(265:32) {#each stepListData3[stepTwoIndex]['list'] as item}",ctx:t}),l}function yd(t){let e,n=t[0]&&pd(t);const i={c:function(){n&&n.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){n&&n.m(t,i),b(t,e,i)},p:function(t,i){t[0]?n?n.p(t,i):(n=pd(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){n&&n.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:yd.name,type:"component",source:"",ctx:t}),i}function xd(t,e,n){let{$$slots:i={},$$scope:o}=e;f("SetScore",i,[]);let s,a,r,c,l,d,{visible:m=!1}=e,h="",u="",p=4,g="",w=0,v=[],_=[];const y={1:"选择本次考核的游戏类型",2:"请对TA本局表现做出评价",3:"请对TA本局表现做出评价",4:"选择队长类型",5:""};let x,b,$;function k(){n(0,m=!1)}function C(){console.log(gameValue),console.log(communicationValue),n(0,m=!1)}function I(t,e){n(1,h=t),n(2,u=e),n(3,p=2),s=void 0,n(4,a=void 0),n(5,g=""),n(11,b=""),T(),n(0,m=!0)}function S(){n(0,m=!1)}const T=()=>{const t=JSON.parse(localStorage.getItem("userInfoScoreInfo")||"{}"),e=t.gameinfo,i=t.game_tag,o=t.is_free;let s=Object.keys(e),a=[];d=o,s.forEach((t=>{a.push({id:t,value:e[t].title})})),1==a.length&&n(11,b=a[0].id),n(8,v=a),n(9,_=i)},R=(t,e)=>{n(4,a=t),n(3,p=3),r=e},M=(t,e)=>{n(4,a=t),r=e,n(5,g=""),n(12,$="")},A=async()=>{if(!$)return void Vt("请填写评价");let t;1==x&&(t=0),2==x&&(t=1),3==x&&(t=2);const e={uid:h,score:r,dtid:b,tag:g,remark:$,cid:c||"",is_self:t||2},n=await qt.get(Ot.setUserScoreInfo(e));0==n.error?(Vt(n.error_msg),S()):Vt(n.error_msg)},P=async()=>{if(x){if(2==x)if(c){const t=await qt.get(Ot.getChatroomInfo({uid:h,cid:c}));0==t.error?n(3,p=5):(Vt(t.error_msg),setTimeout((()=>{n(0,m=!1)}),1e3))}else Vt("请输入厅ID");else if(1==x||3==x){const t=await qt.get(Ot.getChatroomInfo({uid:h,cid:0}));0==t.error?n(3,p=1):(Vt(t.error_msg),setTimeout((()=>{n(0,m=!1)}),1e3))}}else Vt("请选择招聘类型")},j=()=>{n(3,p=1)},D=()=>{n(3,p=2)},L=async t=>{const e=await qt.get(Ot.getSearchCid(c));if(0==e.error){const t=e.data.title;n(7,l=t)}},E=t=>{let e=g.split(","),i=e.indexOf(t);i>-1?(e.splice(i,1),n(12,$=$.replaceAll(t,""))):(e.push(t),n(12,$=($||"")+t)),e=e.filter((t=>{if(t)return t})),n(5,g=e.join(",")),w++},B=["visible"];rd.keys(e).forEach((t=>{~B.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||cd.warn(`<SetScore> was created with unknown prop '${t}'`)}));return t.$$set=t=>{"visible"in t&&n(0,m=t.visible)},t.$capture_state=()=>({showTips:Vt,common:uu,request:qt,ChatUrls:Ot,visible:m,uid:h,nickname:u,stepIndex:p,stepOneIndex:s,stepTwoIndex:a,stepThreeIndex:g,resultId:r,cid:c,resultTitle:l,_is_free:d,updateFlagNum:w,stepListData:v,stepListData3:_,titleObj:y,step4_tab_index:x,dtid:b,textareaValue:$,handleClickBg:k,handleConfirm:C,open:I,close:S,initDataFn:T,clickEmoItem:R,clickEmoItemSub:M,finalClick:A,goPage5:P,goPage1:j,goPage2:D,handleChange:L,clickTabItem:E}),t.$inject_state=t=>{"visible"in t&&n(0,m=t.visible),"uid"in t&&n(1,h=t.uid),"nickname"in t&&n(2,u=t.nickname),"stepIndex"in t&&n(3,p=t.stepIndex),"stepOneIndex"in t&&(s=t.stepOneIndex),"stepTwoIndex"in t&&n(4,a=t.stepTwoIndex),"stepThreeIndex"in t&&n(5,g=t.stepThreeIndex),"resultId"in t&&(r=t.resultId),"cid"in t&&n(6,c=t.cid),"resultTitle"in t&&n(7,l=t.resultTitle),"_is_free"in t&&(d=t._is_free),"updateFlagNum"in t&&(w=t.updateFlagNum),"stepListData"in t&&n(8,v=t.stepListData),"stepListData3"in t&&n(9,_=t.stepListData3),"step4_tab_index"in t&&n(10,x=t.step4_tab_index),"dtid"in t&&n(11,b=t.dtid),"textareaValue"in t&&n(12,$=t.textareaValue)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[m,h,u,p,a,g,c,l,v,_,x,b,$,y,k,R,M,A,P,j,D,L,E,I,S,t=>{n(11,b=t)},()=>{D()},(t,e)=>{R(t,e)},(t,e)=>{M(t,e)},t=>{E(t)},function(){$=this.value,n(12,$)},()=>{n(10,x=3)},function(){c=this.value,n(6,c)},t=>{L()},()=>{P()},()=>{j()}]}class bd extends h{constructor(t){super(t),u(this,t,xd,yd,g,{visible:0,open:23,close:24},null,[-1,-1]),p("SvelteRegisterComponent",{component:this,tagName:"SetScore",options:t,id:yd.name})}get visible(){throw new Error("<SetScore>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set visible(t){throw new Error("<SetScore>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get open(){return this.$$.ctx[23]}set open(t){throw new Error("<SetScore>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get close(){return this.$$.ctx[24]}set close(t){throw new Error("<SetScore>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const $d={empty:-1,text:1,image:2,gift:3,notalk:4,tiren:5,xiamai:6,zhiling:7,zhilingcb:8,diandan:9,baoboss:10,jiebaoboss:11,norecxiamai:12,norecshangmai:13,gochat:14,sendselfmicid:16,getselfmicid:17,norecshangmaiuids:18,readpacket:19,getredmoney:20,getredmoneywang:21,xiamaikeng:25,paidancompleteboss:26,paidancompletepeipei:27,requestshangmai:28,responseshangmai:29,shangmaimessage:30,xiamaimessage:31,volumeh5:32,voicechange:33,agree:34,carteamxuanyan:35,clearcarteamxuanyan:36,autoteamyaoqing:38,delautocarcard:39,jiesanteam:40,wzshangfen:41,text3d:42,showzhuanpan:43,startzhuanpan:44,closezhuanpan:45,shareGift:46,openzhuanpan:47,deleteMsg:49,xcxvoice:50,channellottery:51,koukuan:52,yongfeng:53,baodang:56,shangwei:57,newUser:58,videoTemp:59,shangGuestWei:60,song:61,giftall:101,boxmessage:102,prowercard:1e4,sendGameRole:1990,commonContent:3e3,volumnRemind:3001,gaobaiCard:3002,textReport:3003};let kd=new class{constructor(){this.Type=$d,this.treeTimer=null,this.gloabGuardIconData=null,this.noAnimateUids=[3192211,2699693,2860784,3399037,3290998,3397744,2736590,2142193,1600731,2983629,2044022,3011910,3287341,2493281,2709753,3192211,2487836,3531138,3220784,2088794,3406299,3022508,3382006,2959920,3145783],this.emitter=new Ht,this.gaobaiBgIndex=1,this.messageContainer=window.$(".chat-center-message"),this.setScoreModelInstance=null}setGuardData(t){this.gloabGuardIconData=t}messageFormat(t,e,n,i,o,s,a=""){const r=uu.getSelfInfo(),c={uid:r.uid,nickname:r.nickname,viplevel:r.viplevel,vipuid:r.uid,teacher:r.teacher,medal:r.medal,vipicon:r.vipicon,color:r.color,pendant:r.pendant,bubble:r.bubble,bubble_app:r.bubble_app,guard:r.guard,avatar:r.avatar,sex:r.sex,hat:r.hat,time:"",platforms:"1",isupdate:bs.g_isUpdateSelfInfo?1:-1};bs.g_isUpdateSelfInfo&&(bs.g_isUpdateSelfInfo=!1);const l='"userinfo":'+JSON.stringify(c)+",";if(t==this.Type.image){return"{"+l+'"type":"'+t+'", "thumb":"'+e+'", "image":"'+n+'","ratio":"'+i+'","payEmoji":'+o+',"version":"1","to":"'+_s.getInstance().socketToUids()+'","sessionid":"'+Ct.getSessionId(r.uid)+'"}'}if(t==this.Type.giftall){let t=e;return t.userinfo=c,t.isupdate=1,JSON.stringify(t)}if(t==this.Type.boxmessage){let t=e;return t.userinfo=c,t.version="1",t.to="",JSON.stringify(t)}if(t==this.Type.zhiling)return"{"+l+'"type":"'+t+'", "message":"'+e+'", "roomchannel":"'+n+'","version":"1","to":""}';if(t==this.Type.zhilingcb)return"{"+l+'"type":"'+t+'", "message":"'+e+'", "roomchannel":"'+n+'", "account":"'+i+'","version":"1","to":""}';if(t==this.Type.diandan)return"{"+l+'"type":"'+t+'", "nickname":"'+e+'", "account":"'+n+'", "avatar":"'+i+'", "vipicon":"'+o+'","version":"1","to":""}';if(t==this.Type.baoboss)return"{"+l+'"type":"'+t+'", "account":"'+e+'", "jiedaiaccount":"'+n+'"}';if(t==this.Type.jiebaoboss)return"{"+l+'"type":"'+t+'", "account":"'+e+'", "result":'+n+"}";if(t==this.Type.norecxiamai)return"{"+l+'"type":"'+t+'", "account":"'+e+'"}';if(t==this.Type.norecshangmai)return"{"+l+'"type":"'+t+'", "account":"'+e+'"}';if(t==this.Type.gochat){return"{"+l+'"type":"'+t+'", "account":"'+e+'", "channel":"'+n+'", "gotypeid":"'+i+'", "cid":"'+o+'","version":"1","live":'+(1==s?1:0)+"}"}if(t==this.Type.empty)return"{"+l+'"type":"'+t+'", "empty":"'+e+'"}';if(t==this.Type.sendselfmicid)return"{"+l+'"type":"'+t+'", "account":"'+e+'", "micid":"'+n+'"}';if(t==this.Type.norecshangmaiuids)return"{"+l+'"type":"'+t+'", "uids":"'+e+'"}';if(t==this.Type.requestshangmai)return"{"+l+'"type":"'+t+'","touid":"'+e+'","position":"'+(n||3)+'","tonickname":"'+(i||"")+'"}';if(t==this.Type.responseshangmai)return"{"+l+'"type":"'+t+'","result":"'+e+'"}';if(t==this.Type.shangmaimessage)return"{"+l+'"type":"'+t+'","status":"'+e+'"}';if(t==this.Type.xiamaimessage)return"{"+l+'"type":"'+t+'","status":"'+e+'"}';if(t==this.Type.volumeh5)return"{"+l+'"type":"'+t+'","uservolume":'+e+"}";if(t==this.Type.voicechange)return"{"+l+'"type":"'+t+'","isvoice":'+e+"}";if(t==this.Type.agree)return"{"+l+'"type":"'+t+'","url":"'+e+'"}';if(t==this.Type.carteamxuanyan)return"{"+l+'"type":"'+t+'","fid":"'+e+'","text":"'+n+'","version":"1","to":""}';if(t==this.Type.clearcarteamxuanyan)return"{"+l+'"type":"'+t+'","fid":"'+e+'","version":"1","to":""}';if(t==this.Type.jiesanteam)return"{"+l+'"type":"'+t+'","fid":"'+e+'","cid":"'+n+'"}';if(t==this.Type.autoteamyaoqing)return"{"+l+'"type":"'+t+'", '+e+', "version":"1", "to":"" }';if(t==this.Type.delautocarcard)return"{"+l+'"type":"'+t+'", "createid":"'+e+'", "version":"1", "to":"" }';if(t==this.Type.text3d){var d=e;const t=c;return d.userinfo=t,d.version="1",d.to="",JSON.stringify(d)}if(t==this.Type.showzhuanpan)return"{"+l+'"type":"'+t+'", "touid":"'+e+'","version":"1","to":"" }';if(t==this.Type.startzhuanpan)return"{"+l+'"type":"'+t+'", "index":"'+e+'" }';if(t==this.Type.closezhuanpan)return"{"+l+'"type":"'+t+'"}';if(t==this.Type.openzhuanpan)return"{"+l+'"type":"'+t+'"}';if(t==this.Type.shareGift)return"{"+l+'"type":"'+t+'", '+e+" }";if(t==this.Type.text){let i=_s.getInstance().socketToUids(),o="";return(uu.isDrawTempRoom()||uu.isDrawRoom())&&(o='"subType":"1",'),"{"+l+'"type":"'+t+'", "message":"'+e+'","version":"1",'+o+'"atUsers":'+JSON.stringify(n)+', "to":"'+i+'" ,"sessionid":"'+Ct.getSessionId(r.uid)+'"}'}return t==this.Type.deleteMsg?"{"+l+'"type":"'+t+'", "sessionid":"'+e+'", "uniqid":"'+a+'"}':t==this.Type.xcxvoice?"{"+l+'"type":"'+t+'", "uids":"'+e+'"}':t==this.Type.song?"{"+l+'"type":"'+t+'", "lrcId":"'+e+'", "duration":"'+n+'", "time":"'+i+'", "uid":"'+o+'","version":"1","to":"","isCompleted":'+s+" }":"{"+l+'"type":"'+t+'", "message":"'+e+'"}'}loginNickname2(t,e,n,i){if(t>Mt.maxUID)return window.$("#chatHeadYkNickname").text("游客"+t),void(1!=Rt&&window.$(".downloadexe").show());e+="";let o=uu.nameFormat(e),s=`<img onerror="this.src='${Mt.defaultHead}';" src="${n}" />`;window.$("#chatHeadNickname").html(o),window.$("#chatHeadNickname").attr("account",t),window.$("#chatHeadImage").html(s),1==Rt?(window.$("#chatClientHeadNickname").html(o),window.$("#chatClientHeadNickname").attr("account",t),window.$("#chatClientHeadImage").html(s),window.$("#chat-head-right-client").show(),window.$("#chat-head-right-web").hide()):window.$(".downloadexe").show(),window.$(".jump-to-center").attr("href",`${Mt.domain}/home/${1==i?"advisor":"msg"}/`)}async updateUserInfo(t){setTimeout((function(){qt.getUserInfo(t,"updateUserInfo",!0).then((e=>{const n=uu.getSelfInfo();if(t==n.uid){const t=n.money,i=n.number,o=n.diamond;e.money=t,e.diamond=o,e.number=i,bt.setSelfUser(e)}else bt.addUserInfo(e)}))}),2e3)}getGuardHtml(t){let e="",n=uu.getCid();if(t.length>0)for(let o=0;o<t.length;o++){const i=t[o],s=i.hostuid,a=i.cid;if(0==s&&a==n){const t=i.typeids;t.length>0&&(e=t[0].pic)}}let i="";return""!=e&&(i='<span class="chatroom-tag shouhu-icon">\n                            <img style="height:18px;" src="'+e+'" />\n                        </span>'),i}showMessage(t,e,n,i,o=0){const s=n.type,a=n.isRecord||!1;let r="";if(Object.hasOwnProperty.call(n,"uniqid")&&(r=n.uniqid),s==this.Type.volumeh5)return;const d=n.userinfo;if(d&&1==d.isupdate&&this._updateFromUserInfo(t,d),s==this.Type.image){if(!_s.getInstance().canShowSocketMessage(n.uid||n.userinfo.uid||""))return;if(0!=o&&uu.getCid()!=o)return;const i=n.thumb,r=n.image;if(-1==i.indexOf("tuwandata.com")&&-1==i.indexOf("tuwan.com"))return;var m='<img class="chat-message-image" style="margin-top:16px;" src="'+i+'" image="'+r+'" data-ispay="'+(n.payEmoji?1:0)+'">';const c=n.sessionid;this._textMessage(t,e,m,s,a,(t=>{this.appendMessage(t,!0,i)}),d,c)}else if(s==this.Type.giftall){let e=n.from;this.showGiftAll(n,d,t,e,i)}else if(s==this.Type.boxmessage)this._showOpenboxMessage(n,d.nickname).then((n=>{this._textMessage(t,e,n,s,a,(t=>{this.appendMessage(t,!1)}),d)}),d);else if(s==this.Type.diandan){let t=n.nickname;const e='<div class="flex boss_'+n.account+' boss-diandan-message"><div class="boss-diandan-message-info"><img class="diandain-avatar" src="'+n.avatar+'" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" /><img class="diandain-level" src="'+n.vipicon+'" />老板 <span style="color:#ff017a">'+t+'</span> 要下单了，派单请快速迎驾。</div><span style="margin-left:30px; line-height:30px;" class="chat-center-time"></span></div>';this.appendMessage(e)}else if(s==this.Type.baodang){const t=window.$(n.msg).text().split(" ");if(n.is_colour){const t='<div  class="chat-center-vip"> </div> ';this.appendMessage(window.$(t).append(n.msg))}else if(1==t.length){const t=window.$(n.msg).removeAttr("color"),e='<div  class="chat-center-vip"> </div> ';this.appendMessage(window.$(e).append(t))}else{const e=`\n                    <div class="chat-center-vip">\n                        <font>${t[0]}</font>\n                        <font color="#FE6699">${t[1]}</font>\n                        ${t[2]?`<font>${t[2]}</font>`:""}\n                    </div>\n                `;this.appendMessage(e)}window.$(".invite-modal").addClass("hide")}else if(s==this.Type.baoboss);else if(s==this.Type.norecxiamai);else if(s==this.Type.norecshangmai);else if(s==this.Type.sendselfmicid);else if(s==this.Type.readpacket){const i=n.nickname,o=n.avatar,r=n.desc,c=n.tradeno,l='<div typeid="'+n.typeid+'" nickname="'+i+'" avatar="'+o+'" desc="'+r+'" tradeno="'+c+'" class="redpacket-message">\n                                    <p>'+r+'</p>\n                                    <p class="redpacket-message-qiang-btn">点击抢红包</p>\n                                </div>';this._textMessage(t,e,l,s,a,(t=>{this.appendMessage(t)}),d)}else if(s==this.Type.getredmoney){let e=n.nickname;const i=n.from,o=n.redtype;uu.isTakeMeRoom()&&null!=uu.getAnchorKengUser(t)&&(e=uu.getAnchorKengUser(t).nickname),t==uu.getSelfInfo().uid&&(e="你");let s="";0==o||1==o?s='<div class="readpacket-get-message" style="float:left;">'+e+"领取了"+i+"的<span>红包</span></div>":2==o&&(s=' <div class="readpacket-get-message readpacket-get-message-wang" style="float:left;">'+e+"领取了"+i+"红包</div>");const a=`<div style="margin-bottom:10px;">\n                            ${s}\n                        </div>`;this.appendMessage(a)}else if(s==this.Type.getredmoneywang){var h=n.nickname;const e=n.from,i=n.redtype,o=0==i?n.diamond:n.money,s=n.unit;uu.isTakeMeRoom()&&null!=uu.getAnchorKengUser(t)&&(h=uu.getAnchorKengUser(t).nickname),t==uu.getSelfInfo().uid&&(h="你");let a="";0==i||1==i?a=` <div class="readpacket-get-message readpacket-get-message-wang" style="float:left;">${h}领取了${e}红包${1*o}${s}，成为人气王红包</div>`:2==i&&(a=` <div class="readpacket-get-message readpacket-get-message-wang" style="float:left;">${h}领取了${e}红包${1*o}${s}，成为捧花使者</div>`);const r=`<div style="margin-bottom:10px;">${a}</div>`;this.appendMessage(r)}else if(s==this.Type.text){if(!_s.getInstance().canShowSocketMessage(n.uid||n.userinfo.uid||""))return;let m=n.message;const h=0,u=Ae.getInstance().buildEmoji(m),p=n.sessionid,g=n.textColor||"#333";a||(Si.getInstance().sendDanmu(u),Ti.getInstance().sendDanmu(u),Mi.getInstance().sendDanmu(u)),this._textMessage(t,e,u,s,a,(s=>{this.appendMessage(s),n.safe_msg&&n.safe_msg.length&&this.showMessage(t,e,l(c({},n),{type:this.Type.textReport}),i,o),n.isdybg&&1==n.isdybg&&this.canvasBg(p),1==uu.roomInfo.at&&fe.getInstance().isAtMe(n.atUsers)&&(fe.getInstance().atMeUser.push({uid:n.userinfo.uid,avatar:n.userinfo.avatar,name:n.userinfo.nickname}),fe.getInstance().onActionAt2Me(),fe.getInstance().onObserve())}),d,p,h,g,fe.getInstance().isAtMe(n.atUsers),0,r)}else if(s==this.Type.volumeh5);else if(s==this.Type.carteamxuanyan){const t=n.fid,e=n.text;Fi.showXuanyanText_all(t,e)}else if(s==this.Type.clearcarteamxuanyan){const t=n.fid,e=window.$(".carteam-keng-users li[fid='"+t+"']");e.find(".carteam-duizhang-xuanyan").hide(),e.find("p.carteam-xuanyan-text").text("点击这里可以填写队长宣言哦~")}else if(s==this.Type.autoteamyaoqing){const i=n.teaminfo,o=i.cid,r=i.giftid,c=i.giftnum,l=i.desc,m=i.areaname,h=i.levelname,u=i.fleetnum||uu.getRoomInfo().fleetnum,p=i.avatar,g=d.nickname,f=i.fid,w=i.sports||0,v=i.mode||0,_=d.vipicon;if(0!=o&&uu.getCid()!=o)return;if(uu.isJiamianRoom())return;let y="",x="";c>0&&"0"==w?(y='<div class="carauto-item-shang">赏</div>',x='<span style="color:#ff5588">【赏<img src="'+this._getGiftPic(r)+'" /> x '+c+"】</span>"):w>0&&(y='<div class="carauto-item-shang" style="background:#24aaff;">赛</div>');let b="";h&&(b=" - "+h);const $=uu.isPListType2()?"":"- <font>1</font>/"+u+"人",k='<div class="carteamauto-item carteamauto-item-message" fid="'+f+'" autouid="'+t+'" style="margin-top:10px; max-width:294px;" sports="'+w+`">\n                                <img class="${v>0?"":"hide"}" src="https://asset.tuwan.com/chatroom/images/welcomeTeamIcon_x2.png" style="width: 50px; position: absolute; left: 22px;top: 4px;">\n                                <div>\n                                    <img class="autocar-team-list-header" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'" src="`+p+'">\n                                </div>\n                                <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                                    <div class="autocar-team-list-title" title="'+l+'">\n                                        '+x+"<font>"+l+'</font>\n                                    </div>\n                                    <div class="autocar-team-list-info-1">★'+m+"★ "+b+$+' </div>\n                                    <div class="autocar-team-list-info-2">\n                                        <img src="'+_+'">\n                                        '+g+'\n                                    </div>\n                                </div>\n                                <div class="carauto-team-right-join" sports="'+w+'" autouid="'+t+'" fid="'+f+'">加入'+uu.getCarButtonStr()+"</div>\n                                "+y+"\n                            </div>";this._textMessage(t,e,k,s,a,(t=>{this.appendMessage(t)}),d)}else if(s==this.Type.wzshangfen){const i=n.declaration,o=n.fid,r=n.segment,c=uu.getSelfInfo().avatar,l=d.nickname,m=d.vipicon,h='<div class="carteamauto-item carteamauto-item-message" fid="'+o+'" autouid="'+t+'" style="margin-top:10px; max-width:294px;">\n                                <div>\n                                    <img class="autocar-team-list-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+c+'">\n                                </div>\n                                <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                                    <div class="autocar-team-list-title" title="'+""+'">\n                                        <font>'+i+'</font>\n                                    </div>\n                                    <div class="autocar-team-list-info-1">'+r+'</div>\n                                    <div class="autocar-team-list-info-2">\n                                        <img src="'+m+'">\n                                        '+l+"\n                                    </div>\n                                </div>\n                            </div>";this._textMessage(t,e,h,s,a,(t=>{this.appendMessage(t)}),d)}else if(s==this.Type.delautocarcard){const t=n.createid,e=window.$(".chat-center-message .carteamauto-item-message[autouid='"+t+"']");e.length>0&&e.parents(".chat-text-content").remove()}else if(s==this.Type.text3d){const t=n.text,e=n.texttype;if("3d"==e){const e=' <div class="text3d-main">\n                                            <div class="text3d-content">\n                                                <div class="text3danimate" style="text-align:center; margin-top:10px; color:#ff3000;font-size:8vw; transform-style: preserve-3d;-webkit-transform-style: preserve-3d">\n\n                                                </div>\n                                            </div>\n                                        </div>',n=window.$(e);window.$("body").append(n);const i=n.find(".text3danimate");this.splitText(i[0],t),this.letterWave(i[0])}else if("eff"==e){const e='<div class="effect-slide effect-slide--current">\n                                    <h4 class="effect-word effect-word--4">'+t+"</h4>\n                                </div>";window.$("body").append(e),this._playEffText(t)}}else if(s==this.Type.showzhuanpan){const e=n.touid;window.$(".chat-zhuanpan").attr("touid",e),window.$(".chat-zhuanpan").attr("zcuid",t),window.$(".chat-zhuanpan .start-zhuan").attr("isclick","0"),window.$(".start-zhuan").attr("src","https://res.tuwan.com/templet/play/chat/images/start_pan.png"),window.$(".chat-zhuanpan").show()}else if(s==this.Type.startzhuanpan);else if(s==this.Type.closezhuanpan);else if(s==this.Type.openzhuanpan);else if(s==this.Type.song)uu.isSongTempRoom()?le.getInstance().onListenerLyricsOffSets(n):uu.isSongPkRoom()&&mu.getInstance().onListenerLyricsOffSets(n);else if(s==this.Type.shareGift){const i=n.giftInfo,o=d.nickname,r=' <div class="share_success_text">\n                            <img class="share_success_gift_pic" src="'+i.giftPic+'" alt="">\n                            <div class="share_success_info">\n                                <div>恭喜<span>'+o+"</span> 通过<span>邀请好友</span></div>\n                                <div>抽中了<span>"+i.giftname+"</span>奖励</div>\n                            </div>\n                        </div>";this._textMessage(t,e,r,s,a,(t=>{this.appendMessage(t)}),d)}else if(s==this.Type.deleteMsg){const t=n.sessionid;window.$("#"+t).length>0?(window.$("#"+t).html('<div style="color:#999;">管理已将消息撤回</div>'),window.$("#"+t).attr("data-deleted","1")):Vt("手机端发送的暂时不能撤消"),ji.getInstance().onRevocationMessage(n,(t=>{const e=t.sessionid+"_temp";window.$("#"+e).length>0&&(window.$("#"+e).html('<div style="color:#999;">管理已将消息撤回</div>'),window.$("#"+e).attr("data-deleted","1"))}))}else if(s==this.Type.channellottery)this._lotterygiftdanmu(n).then((n=>{this._textMessage(t,e,n,s,a,(t=>{this.appendMessage(t)}),d)}));else if(s==this.Type.prowercard){const t={};this._prowergiftdanmu(n).then((e=>{this._textMessage(n.uid,0,e,s,a,(t=>{this.appendMessage(t)}),t)}))}else if(s==this.Type.newUser){let t=n.user_name,e=n.captain_name;const i='<div class="flex newuser-message"><span style="color:#ff017a">'+t+'</span>上了<span style="color:#ff017a">'+e+'</span>的车队，<span style="color:#ff017a">'+e+"</span>尽快和老板一起开黑吧~</div>";this.appendMessage(i)}else if(s==this.Type.videoTemp){const i=n.teaminfo,o=i.cid,r=i.giftid,c=i.giftnum,l=i.desc,m=i.areaname,h=i.levelname,u=i.avatar,p=d.nickname,g=i.fid,f=i.sports||0,w=i.live||0,v=d.vipicon;let _="",y="";c>0&&"0"==f?(_='<div class="carauto-item-shang">赏</div>',y='<span style="color:#ff5588">【赏<img src="'+this._getGiftPic(r)+'" /> x '+c+"】</span>"):f>0&&(_='<div class="carauto-item-shang" style="background:#24aaff;">赛</div>');let x="";h&&(x=" - "+h);const b='<div class="carteamauto-item carteamauto-item-message"  fid="'+g+'" autouid="'+t+'" style="margin-top:10px; max-width:294px;" sports="'+f+'">\n                                <div>\n                                    <img class="autocar-team-list-header" onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+u+'">\n                                </div>\n                                <div style="padding:0 0 0 10px; flex:1; margin-top:-3px;">\n                                    <div class="autocar-team-list-title" title="'+l+'">\n                                        '+y+"<font>"+l+'</font>\n                                    </div>\n                                    <div class="autocar-team-list-info-1">★'+m+"★ "+x+'</div>\n                                    <div class="autocar-team-list-info-2">\n                                        <img src="'+v+'">\n                                        '+p+'\n                                    </div>\n                                </div>\n                                <div live="2" tcid="'+o+'" class="carauto-team-right-join" sports="'+f+'" autouid="'+t+'" fid="'+g+'">加入'+(4!=w?uu.getCarButtonStr():"")+"</div>\n                                "+_+"\n                            </div>";this._textMessage(t,e,b,s,a,(t=>{this.appendMessage(t)}),d)}else if(s==this.Type.sendGameRole){if(0!=o&&uu.getCid()!=o)return;const i=n.sessionid,r=`\n                <img class="chat-center-send_game_role-copy" style="margin-left: 3px; margin-top: -20px; width: 14px; height: 14px; cursor: pointer;" data-nav_type="${n.nav_type}" data-clipboard-text="${3===n.nav_type?n.steam_code:n.title}" src="https://res.tuwan.com/chatroom/images/send_game_role_copy.png"/>\n            `,c=`\n                <div class="chat-center-send_game_role flex" style="margin-top: 10px;">\n                    <div class="flex flex-ac" style="padding: 0 15px; height: 75px; background-color: rgba(0, 0, 0, 0.2); border-radius: 0px 15px 15px 15px;">\n                        <img style="width: 45px; height: 45px;" src="${n.icon}"/>\n                        <div style="margin-left: 8px;">\n                            <div class="flex flex-ac">\n                                <p style="font-size: 15px; font-weight: 600; color: #FFFFFF; line-height: 21px;">${n.title}</p>\n                                ${1===n.nav_type?r:""}\n                            </div>\n                            <div class="flex flex-ac">\n                                <p style="font-size: 12px; font-weight: 400; color: #EBEBF5; line-height: 15px; height: 15px; margin-top: 3px; max-width: 300px; overflow: hidden;">${n.desc}</p>\n                                ${3===n.nav_type?r:""}\n                            <div>\n                        </div>\n                    </div>\n                </div>\n            `;this._textMessage(t,e,c,s,a,(t=>{this.appendMessage(t),Ct.loadScript("https://res2.tuwan.com/templet/play/chat/js/clipboard.min.js").then((()=>{let t=new window.ClipboardJS(".chat-center-send_game_role-copy");t.on("success",(function(t){1==t.trigger.dataset.nav_type?Vt("昵称已复制，去游戏内添加好友吧"):3==t.trigger.dataset.nav_type?Vt("好友码已复制，去Steam添加好友吧"):Vt("复制成功")})),t.on("error",(function(t){Vt("复制失败，请手动复制")}))}))}),{},i)}else if(s==this.Type.commonContent){let{content:t,user_icon:e,user_name_color:i,user_name:o}=n;t=t.replace("user_icon user_name",""),this.appendMessage(`\n                <p style="line-height: 22px;">\n                    <img style="height: 16px; margin-right: 4px;" src="${e}"/>\n                    <span style="color: ${i};">${o}</span>\n                    <span style="${this.getMessageColor("#333")};">${t}</span>\n                </p>\n            `)}else if(s==this.Type.volumnRemind){let{nickname:t,chat_msg:e}=n;this.appendMessage(`\n                <p style="line-height: 22px;">\n                    ${t?`<span style="color: rgb(62, 75, 128);">${t} </span>`:""}\n                    <span style="${this.getMessageColor("#333")};">${e}</span>\n                </p>\n            `)}else if(s==this.Type.gaobaiCard)this._textMessage(t,e,as.getInstance()._getBiaobaiHtml({data:[n],lazyCls:"",itemCls:`bg_${this.gaobaiBgIndex}`,showDays:!0,showTags:!1}),s,a,(t=>{this.appendMessage(t,!1)}),{}),this.gaobaiBgIndex=this.gaobaiBgIndex+1,this.gaobaiBgIndex>5&&(this.gaobaiBgIndex=1);else if(s==this.Type.textReport){const t=n.safe_msg.split("</span>")[0].split(';">')[1],e=$(`<p class="report-illegal-content">${t}<span class="report_btn" data-uid="${n.userinfo.uid}" data-nickname="${n.userinfo.nickname}">举报</span></p>`);this.appendMessage(e);const i=this;e.find(".report_btn").on("click",(function(t){if(t.stopPropagation(),uu.getMeid()>Mt.maxUID)return void i.emitter.emit("showLoginWindow");const e={vid:this.dataset.uid,title:this.dataset.nickname};xs.getInstance().showReportModal(2,e)}))}const u=this.messageContainer.find("> div, > p");if(u.length>100)for(var p=0;p<u.length-100;p++)u.eq(p).remove()}_prowergiftdanmu(t){return new Promise(((e,n)=>{const{cardid:i,part1:o,part2:s,teachername:a,uname:r,teacherid:c,message:l}=t;c==uu.getMeid()&&(1==i?this.emitter.emit("notalk",4,c,l):2==i&&this.emitter.emit("kick",5,c,l)),e(`<div class="flex chat-gift-main">\n                        <div class="chat-gift-content chat-gift-content-fen">\n                            <span style="color: #f4205b">${r}</span>${o}<span style="color: #f4205b">${a}</span>${s}\n                        </div>\n                    </div>`)}))}_lotterygiftdanmu(t){return new Promise(((e,n)=>{const{giftUserName:i,gift:o,giftNum:s,taskName:a}=t;e(`<div class="flex chat-gift-main">\n                        <div class="chat-gift-content chat-gift-content-fen">\n                            <span style="color: #f4205b">${i}</span>领取${a}，获得<span style="color: #f4205b">${o}x${s}</span>\n                        </div>\n                    </div>`)}))}async _updateFromUserInfo(t,e){const n=bt.getUserInfo(1*t);if(n){for(let t in e)"platforms"!=t&&"vipuid"!=t&&"time"!=t&&(n[t]=e[t]);if(bt.addUserInfo(n),"nickname"in e){const n=e.nickname;window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+t+"']").find(".seat-user-name").text(n)}he&&he.updateChannelUserInfo(uu.getChannel(),t,n)}}_playEffText(t){const e=[{options:{shapesOnTop:!0,shapeColors:["#ec4747","#5447ec","#ecb447","#a847ec","#635f65","#35c394","#9985ee","#f54665","#4718f5","#f5aa18"],totalShapes:20},hide:{lettersAnimationOpts:{duration:300,delay:(t,e)=>30*(t.parentNode.children.length-e-1),easing:"easeOutExpo",opacity:0,translateY:(t,e)=>e%2==0?"80%":"-80%",rotate:(t,e)=>e%2==0?-25:25},shapesAnimationOpts:{duration:50,easing:"easeOutExpo",translateX:t=>t.dataset.tx,translateY:t=>t.dataset.ty,scale:0,rotate:0,opacity:{value:0,duration:50,easing:"linear"}}},show:{lettersAnimationOpts:{duration:400,delay:(t,e)=>80*(t.parentNode.children.length-e-1),easing:"easeOutElastic",opacity:{value:[0,1],duration:100,easing:"linear"},translateY:(t,e)=>e%2==0?["-80%","0%"]:["80%","0%"],rotate:[90,0]},shapesAnimationOpts:{duration:()=>window.anime.random(1e3,3e3),delay:(t,e)=>20*e,easing:"easeOutElastic",translateX:t=>{const e=window.anime.random(-250,250);return t.dataset.tx=e,[0,e]},translateY:t=>{const e=window.anime.random(-250,250);return t.dataset.ty=e,[0,e]},scale:t=>{const e=wi(.1,.6);return t.dataset.s=e,[e,e]},rotate:()=>window.anime.random(-90,90),opacity:{value:.6,duration:1e3,easing:"linear"}}}}][0],n=document.querySelector(".effect-word"),i=new bi(n,e.options);i.show(e.show).then((()=>{setTimeout((()=>{i.hide(e.hide).then((()=>{document.querySelector(".effect-slide").remove()}))}),3e3)}))}async _showOpenboxMessage(t,e){const n=t.self,i=t.boxname,o=t.ifACrit,s=t.boxnum,a=t.giftinfo,r=[{name:"铜宝箱",pic:"https://img3.tuwandata.com/uploads/play2/gift/1892021607098145.png?a=1"},{name:"银宝箱",pic:"https://img3.tuwandata.com/uploads/play2/gift/1202071607098140.png?a=1"},{name:"金宝箱",pic:"https://img3.tuwandata.com/uploads/play2/gift/8190871606379968.png?a=1"},{name:"紫晶",pic:"https://img3.tuwandata.com/uploads/play2/gift/8797071703313794.png"}].find((t=>t.name==i));let c=[];for(let l=0;l<a.length;l++){const t=a[l],d="金宝箱*3"==t.giftname?"金宝箱":t.giftname,m=t.giftpic,h=t.users;for(let a=0;a<h.length;a++){const t=h[a].nickname,l=h[a].uid,u=h[a].num;let p="",g=i;null!=r&&(g='<img class="message_gift_icon" src="'+r.pic+'" />'),p=1==n?null!=m?'<span style="color: #f4205b">'+Ct.replaceGuan(e)+"</span>打开"+g+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+`</span>,${o?'<span style="color: #f4205b">产生暴击</span>':""}获得 <img class="message_gift_icon" src="`+m+'" /> <span style="color: #f4205b"> x'+u+"</span>":'<span style="color: #f4205b">'+Ct.replaceGuan(e)+"</span>打开"+i+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+`</span>,${o?'<span style="color: #f4205b">产生暴击</span>':""}获得<span style="color: #f4205b">`+d+"x"+u+"</span>":uu.isTakeMeRoom()?null!=uu.getBossInfo()&&uu.getBossInfo().uid==l&&1==uu.getBossInfo().face?null!=m?'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">神秘人</span>'+g+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得 <img class="message_gift_icon" src="'+m+'" /> <span style="color: #f4205b">x'+u+"</span>":'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">神秘人</span>'+i+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得<span style="color: #f4205b">'+d+"x"+u+"</span>":null!=m?'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">'+Ct.replaceGuan(t)+" </span>"+g+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得<img class="message_gift_icon" src="'+m+'" /><span style="color: #f4205b"> x'+u+"</span>":'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">'+Ct.replaceGuan(t)+" </span>"+i+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得<span style="color: #f4205b">'+d+"x"+u+"</span>":null!=m?'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">'+Ct.replaceGuan(t)+" </span>"+g+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得 <img class="message_gift_icon" src="'+m+'" /> <span style="color: #f4205b">x'+u+"</span>":'<span style="color: #f4205b">'+Ct.replaceGuan(e)+'</span>送给<span style="color: #f4205b">'+Ct.replaceGuan(t)+" </span>"+i+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+s+'</span>, 获得<span style="color: #f4205b">'+d+"x"+u+"</span>",c.push('<div class="flex chat-gift-main">\n                                <div class="chat-gift-content chat-gift-content-fen">\n                                    '+p+"\n                                </div>\n                            </div>")}}return c.join("")}_getGiftPic(t){return ue.get(1*t).icon}_setXuanyanText(t,e){if(""==e)return;const n=window.$(".carteam-keng-users li[fid='"+t+"']");n.find(".carteam-duizhang-xuanyan").css("display","flex"),n.find(".carteam-xuanyan-div").show(),n.find("p.carteam-xuanyan-text").text(e)}setXuanyanText(t,e){this._setXuanyanText(t,e)}appendHunliRedPackMessage(t){const e=t.userinfo;let n=e.nickname;const i=e.uid,o=t.best,s=t.diamond;i==uu.getMeid()&&(n="你");let a="";a=1==o?' <div class="readpacket-get-message readpacket-get-message-wang" style="float:left;">恭喜'+n+"领取了喜结良缘红包"+s+"钻，成为本场捧花天使</div>":'<div class="readpacket-get-message" style="float:left;">恭喜'+n+"领取了喜结良缘<span>红包</span></div>";const r=`<div style="margin-bottom:10px;">\n                            ${a}\n                        </div>`;this.appendMessage(r)}appendMessageTouzi(t){const e=t.data.userinfo,n=e.isteacher,i=e.medal,o=e.nickname;e.platforms,e.time;const s=e.vipicon;e.viplevel,e.vipuid;const a=e.uid,r=t.data.svga;let c="",l="";l=uu.isTempCarteamRoom()?"老板":uu.getRoomUserIdentity(1*a,n);var d="";d=i&&"null"!==i&&""!=i?'<span class="chatroom-tag">\n                            <img style="height:18px;" src="'+i+'" />\n                        </span>':"",c=1==n?'<span class="chatroom-tag">\n                        <i class="chat-room-peiwan-tag">'+l+'</i>\n                    </span>\n                    <span class="chatroom-tag">\n                        <img style="height:18px;" src="'+s+'" />\n                    </span>'+d:'\n                    <span class="chatroom-tag">\n                        <img class="img-laoban-icon" src="https://res.tuwan.com/templet/play/chat/images/laobanicon.png">\n                    </span>\n                    <span class="chatroom-tag">\n                        <img style="height:18px;" src="'+s+'" />\n                    </span>'+d;const m=(new Date).getTime(),h='<div class="chat-text-content">\n                        <div style="display:flex; align-items:center;">\n                            '+c+'\n                            <span style="position:relative;" class="chat-message-in-nickname">'+o+'</span>\n                        </div>\n                        <div data-nickname="'+o+'" class="chat-center-talktext">\n                            <div class="game-touzi" id="gameTouzi_'+m+'"></div>\n                        </div>\n                    </div>';this.appendMessage(h),Zt.getInstance().loadParser("#gameTouzi_"+m,r,1,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}appendMessage(t,e,n){const i=window.$(".chat-center-window-main");window.$(".chat-center-message").append(t),e&&this._showImage(n,i),Mt.isUpScroll?window.$("#chatNewmessage").show():i.scrollTop(999999)}async _showImage(t,e){Ct.loadImage(t,(()=>{Mt.isUpScroll||e.scrollTop(999999)}))}showGiftAll(t,e,n,i,o){let s=t.count,a=t.from,r=t.giftname,c=t.giftid,l=t.gifsrc,d=t.boxnum||0,m=t.gifttype,h=t.lovetypeid,u=t.showtype,p=t.guardpic,g=t.guardranking,f=t.guardtype,w=t.guardtital,v=t.days||7,_=t.price||0,y=t.touserinfo,x=t.video_pc_url,b=t.video_app_url,$=t.video_sound,k=t.isRecord||!1,C=t.video_type;l||(l=window.$(".chat-center-gift-list .chat-center-gift-item[giftid='"+c+"']").attr("gifpic"));const I={account:n,uid:i,formatmsg:t,userinfo:e,src:l,count:s,giftName:r,roomType:o,showtype:u,price:_,boxnum:d,gifttype:m,lovetypeid:h,giftid:c,guardpic:p,guardtype:f,guardranking:g,guardtital:w,days:v,video_pc_url:x,video_app_url:b,video_sound:$,video_type:C,isrecord:k};"isupdate"in e||1==e.face?this._giftMiddle(y,I,e.nickname):qt.getUserInfo(a,"showGiftAll").then((t=>{this._giftMiddle(y,I,t.nickname)}))}async _giftMiddle(t,e,n){const i=e.account;8==e.gifttype&&i==uu.getMeid()&&this.updateUserInfo(i);let o=[],s=[];for(let a=0;a<t.length;a++){const i=t[a].userid,r=t[a].username||"";let c="";if(r)c=r;else{const t=bt.getUserInfo(i);if(t)c=t.nickname;else if(uu.isSongPkRoom()){const t=mu.getInstance().getAnchorKengUser(i);c=t?t.nickname:""}else c=uu.anchorUsers.get(i)?uu.anchorUsers.get(i).nickname:""}await this._giftdanmu(n,c,i,e).then((t=>{if(uu.isBattleRoom()||uu.isVideoTempRoom()||uu.isLiveTempRoom()){const t=e.giftName,i=e.count,o='<span style="color:rgba(255,255,255,.6)">'+Ct.replaceGuan(n)+'</span>给<span style="color:rgba(255,255,255,.6)">'+Ct.replaceGuan(c)+' </span> 送了 <span style="color: #FF6691"> '+t+' x</span><span style="color: #FF6691">'+i+"</span>";uu.isVideoTempRoom()&&Ti.getInstance().sendDanmu(o),uu.isLiveTempRoom()?Mi.getInstance().sendDanmu(o):Si.getInstance().sendDanmu(o)}o.push('<div class="flex chat-gift-main">\n                                <div class="chat-gift-content chat-gift-content-fen">\n                                    '+t+"\n                                </div>\n                            </div>")})),s.push(i)}e.imgmsgHtml=o,e.teacheruids=s,this._giftTextmessage(e)}_giftdanmu(t,e,n,i){return new Promise(((o,s)=>{let a="";const r=i.gifttype;i.lovetypeid;const c=i.giftName,l=i.formatmsg.pathpic,d=i.count,m=Ct.replaceGuan(t),h=Ct.replaceGuan(e);if(8==r){const t=i.guardpic,e=i.guardtital,s=i.guardranking,r=i.days||7,c=uu.getSelfInfo().guard,l='<span style="font-size:18px;">'+r+"</span>天";if(0==c.length)a='<span style="color: #f4205b">'+m+'</span>加入了<span style="color: #f4205b">'+h+' </span>的<span style="color: #f4205b">'+e+"</span> "+l+' <img class="message_guard_icon" src="'+t+'" />',o(a);else{let i=!1;for(let t=c.length-1;t>=0;t--){c[t].hostuid==n&&(i=!0)}i||0==s?(a='<span style="color: #f4205b">'+m+'</span>加入了<span style="color: #f4205b">'+h+' </span>的<span style="color: #f4205b">'+e+"</span> "+l+' <img class="message_guard_icon" src="'+t+'" />',o(a)):(a='<span style="color: #f4205b">'+m+'</span>成为了<span style="color: #f4205b">'+h+' </span>的<span style="color: #f4205b">'+e+"</span> "+l+" , 成为第"+s+'位守护<img class="message_guard_icon" src="'+t+'" />',o(a))}}else a=null!=l?'<span style="color: #f4205b">'+m+'</span>送给<span style="color: #f4205b">'+h+' </span><img class="message_gift_icon" src="'+l+'" /><span style="color: #f4205b">x</span><span style="color: #f4205b">'+d+"</span>":'<span style="color: #f4205b">'+m+'</span>送给<span style="color: #f4205b">'+h+" </span>"+c+'<span style="color: #f4205b">x</span><span style="color: #f4205b">'+d+"</span>",o(a)}))}_giftTextmessage(t){const e=t.account,n=t.account,i=t.imgmsgHtml,o=t.formatmsg,s=t.userinfo,a=t.teacheruids,r=t.src,c=t.count,l=t.giftName,d=t.showtype,m=t.giftid;t.price;const h=t.boxnum||0,u=t.video_pc_url;t.video_app_url;const p=t.video_sound,g=t.isrecord,f=t.video_type;let w="";Object.hasOwnProperty.call(t,"uniqid")&&(w=t.uniqid),this._textMessage(e,n,i.join(""),o.type,g,(t=>{1*h==0&&this.appendMessage(t);const n=1*uu.getMeid();let i=a.map((t=>1*t));if((!xt.getInstance().getGiftEffectSwithState()||e==n||i.includes(1*n))&&(!(Si.getInstance().getFullScreenStatus()||Ti.getInstance().getFullScreenStatus()||Mi.getInstance().getFullScreenStatus())||e==n)&&!document.hidden&&2!=d&&(r||u))if(298==m&&c>=10){let t=[],e=[],n=!0;for(let i=0;i<a.length;i++){const o=a[i],s=this.getTeacherEle(o);let r=bt.getUserInfo(o);if(r||(r=uu.isSongPkRoom()?mu.getInstance().getAnchorKengUser(o):uu.anchorUsers.get(o)),e.push(r&&r.avatar?r.avatar:"https://uc.tuwan.com/images/noavatar_1.jpg"),0!=s.length){n=!0;const e=s.width(),i=s.height(),o=s.offset().left+e/2,a=s.offset().top+i/2,r=o-window.$(window).width()/2,c=a-window.$(window).height()/2;t.push({x:r,y:c})}else t.push({x:-1,y:-1}),n=!1}new Ui({svgaPath:"https://img3.tuwandata.com/uploads/play/1389981591019040.svga",teachersPosition:t,avatars:e,isSeat:n})}else{const t=r&&r.lastIndexOf(".");if("svga"==(r&&r.substr(t+1))||u){const t=o.wheat_frames,n=o.wheat_gif,i=n&&n.length>0&&t>0;if(!Gi.getInstance().interceptDisposeAnimate(r,a,l,u,f,p,m,e))if(i&&Zt.getInstance().preload(n),i||!Yt.isSvgaGift(u))for(let o=0;o<a.length;o++)i?this.startSvgaNew(r,a[o],l,u,f,p,m,e,!1,t,(()=>{const t=Yt.getTeacherEle(a[o]);if(t&&t.length>0){const e=window.$('<div class="seat-fly-svga"></div>');window.$(t.get(0)).find(".seat-head").append(e),Zt.getInstance().loadParser(e.get(0),n,1,!0).then((({videoItem:t,player:n})=>{n.setVideoItem(t),n.startAnimation(),n.onFinished((()=>{e.remove()}))}),(t=>{}))}})):this.startSvgaNew(r,a[o],l,u,f,p,m,e);else{if(uu.isPartyGame())return;const t=new Kt;t.handle=()=>{this.startSvgaNew(r,a,l,u,f,p,m,e,!0,void 0,void 0,t)},Wt.getInstance().inQueue(t)}}else for(let e=0;e<a.length;e++)this.giftAnimateNew(r,c,a[e],l,a)}}),s,null,null,null,!1,h,w)}async startSvgaNew(t,e,n,i,o,s,a,r,c,l,d,m){Yt.play(t,e,n,i,o,s,a,r,c,l,d,m)}async giftAnimateNew(t,e,n,i,o){let s=this.getAnmitionEle(e,o,t);window.$("body").append(s);const a=this.getTeacherEle(n);if(0==a.length)s.snabbt({scale:[4,4]}).snabbt({scale:[0,0],delay:1e3,complete:()=>{s.remove()}});else{const t=this.getTeacherPosition(a),e=t.x,n=t.y;s.snabbt({scale:[4,4]}).snabbt({position:[e,n,0],scale:[.5,.5],delay:1e3,start:()=>{}}).snabbt({scale:[0,0],delay:1e3,complete:()=>{s.remove()}})}}getTeacherPosition(t){if(t.length>0){const e=t.width(),n=t.height(),i=t.offset().left+e/2,o=t.offset().top+n/2;return{x:i-window.$(window).width()/2,y:o-window.$(window).height()/2}}return{x:0,y:0}}getEleCenterPosition(t){const e=t.width(),n=t.height();return{x:t.offset().left+e/2,y:t.offset().top+n/2}}getTeacherEle(t){return window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+t+"']")}getAnmitionEle(t,e,n){return window.$('<div class="gift-animate">\n                            <img style="" src="'+n+'"><font>x'+t+"</font>\n                        </div>")}splitText(t,e){var n=e.split(" ");n.forEach((function(e,i){var o=document.createElement("span");o.className="text-area-word",e.split("").forEach((function(t,e){var n=document.createElement("span");n.className="text-area-letter",n.style.opacity=0,n.textContent=t,o.appendChild(n)})),t.appendChild(o),i!==n.length-1&&o.insertAdjacentHTML("afterEnd"," ")}))}letterWave(t){window.snabbt(t.querySelectorAll(".text-area-letter"),{fromRotation:function(t){return t%2==0?[-Math.PI/2,0,0]:[Math.PI/2,0,0]},rotation:[0,0,0],delay:function(t){return 60*t},duration:600,perspective:5,fromOpacity:0,opacity:1,easing:"spring",springConstant:.4,springDeceleration:.5,complete:()=>{this.hideText3d(t)}})}hideText3d(t){const e=window.$(t).parents(".text3d-content");window.snabbt(e[0],{fromOpacity:1,opacity:0,delay:2e3,duration:600,complete:function(){e.parents(".text3d-main").remove()}})}async giftFly(t,e,n,i={}){const{vapPlayer:o}=i,s=this.getTeacherEle(e,n);if(null==e||null==e||""==e||1*e==0||0==s.length)t.snabbt({fromOpacity:1,opacity:0,complete:()=>{t.remove(),o&&o.destory()}});else{const e=s.width(),n=s.height(),i=s.offset().left+e/2,a=s.offset().top+n/2,r=i-window.$(window).width()/2,c=a-window.$(window).height()/2;t.snabbt({position:[r,c,0],scale:[.1,.1],complete:()=>{}}).snabbt({scale:[0,0],delay:1200,complete:()=>{t.remove(),o&&o.destory()}})}}_textMessage(t,e,n,i,o,s,a,r,c,l,d=!1,m=0,h){"bubble"in a?s(this._messageHtml(a,n,t,i,r,c,l,d,o,m,h)):qt.getUserInfo(t,"_textMessage").then((e=>{s(this._messageHtml(e,n,t,i,r,c,l,d,o,m,h))}))}_messageHtml(t,e,n,i,o,s,a,r=!1,c=!1,l=0,d=""){let m=n&&"0"!=n?n:t.uid,h=t.color||(uu.isJiamianRoom()?"#e3dadc":"#333");t.gurad;let u=t.nickname,p=t.vipicon,g=t.teacher,f=t.medal,w=t.match_user_icon,v=t.bubble||0,_=t.bubble_app||0,y="",x="";x=uu.getRoomUserIdentity(1*m,g);let b="";b=f&&"null"!==f&&""!=f?'<span class="chatroom-tag">\n                            <img style="height:18px;" src="'+f+'" />\n                        </span>':"",102==i&&(b="");let $="";w&&w.length&&($='\n                <span class="chatroom-tag">\n                    <img style="height:18px;" src="https://dynamics-share.tuwan.com/activity/43b786918bf9a0338f997b2321acbcbb.png" />\n                </span>\n            '),y=1==g?$+'\n                    <span class="chatroom-tag">\n                        <i class="chat-room-peiwan-tag">'+x+'</i>\n                    </span>\n                    \n                    \n                    <span class="chatroom-tag">\n                        <img style="height:18px;" src="'+p+'" />\n                    </span>'+b:$+'\n                    <span class="chatroom-tag">\n                        <img class="img-laoban-icon" src="https://res.tuwan.com/templet/play/chat/images/laobanicon.png">\n                    </span>\n                    \n                    <span class="chatroom-tag">\n                        <img style="height:18px;" src="'+p+'" />\n                    </span>'+b,m>Mt.maxUID&&(y="");let k=uu.nameFormat(u),C="",I="";"#ffe14c"==h?(C="ygb_title",h=""):uu.isCanWhiteFont()?h="#ccc":"#666"!=h||!uu.isTempCarteamRoom()||uu.isTruthSmallRoom()||uu.isLoveTempRoom()||uu.isVideoTempRoom()||(h="#ccc");let S=[],T="",R=this.getMessageColor(a),M=e;if((uu.isVideoTempRoom()||uu.isLiveTempRoom())&&(h="#666"),uu.isDrawRoom()&&(h="#eee"),1==v&&1==i){I="chat_content_136438";const t=_.bgpc,n=_.bgpc_width;_.bgpc_color;const i=_.icon_pc,o=n/3;T="border: solid "+o+"px transparent;border-image: url("+t+") "+o+" fill round; ",i&&""!=i[0]&&S.push('<img class="qipaotopleft" src="'+i[0]+'" />'),i&&""!=i[1]&&S.push('<img class="qipaotopright" src="'+i[1]+'" />'),i&&""!=i[2]&&S.push('<img class="qipaobottomleft" src="'+i[2]+'" />'),i&&""!=i[3]&&S.push('<img class="qipaobottomright" src="'+i[3]+'" />');M='<font style="color:'+_.text_color+'">'+e+"</font>"}101==i&&(k=Ct.replaceGuanSp_R(k)),102==i&&(k=Ct.replaceGuan(k)),k=uu.nameColor(h,k);let A="";const P=t.pendant;P&&(A='<img style="position:absolute;right:-40px; bottom:0; width:40px;" src="'+P+'" />');let j="";o&&(j=' id="'+o+'"');let D="",L="";1==s&&o?(T="",L="display:flex; align-items: center; width:700px; min-height:60px; border-radius:6px; padding:16px 20px; margin-top:10px; box-sizing: border-box; overflow:hidden;",D='\n                <canvas width="700" height="600" class="message-text-canvas" id="canvastext_'+o+`"></canvas>\n                <div class="message-canvas-text" style="color:${"#333"==a?"#fff":a}"><span class="letters">`+e+"</span></div>"):D=M+S.join("");const E=uu.getMeid()+"-"+(new Date).getTime(),B=r?'at="'+E+'" light="1"':"";r&&(fe.getInstance().addAtTag(E),fe.getInstance().onPushObserve(E));const F='<div class="chat-text-content" '+B+'>\n                        <div style="display:flex; align-items:center;">\n                            '+y+'\n                            \n                            <span style="position:relative;" account="'+m+'" class="chat-message-in-nickname '+C+'">'+k+A+'</span>\n                            <span class="chat-center-time"></span>\n                        </div>\n                        <div data-uniqid="'+d+'" data-nickname="'+u+'" data-type="'+i+'" data-uid="'+m+'" class="chat-center-talktext '+(1==i?I:"")+'" style="'+L+T+R+'"'+j+">\n                            "+D+"\n                        </div>\n                    </div>";if(0==c&&(i==this.Type.text||i==this.Type.image||i==this.Type.giftall||i==this.Type.boxmessage)){if(i==this.Type.giftall&&1==l)return;ji.getInstance().appendMessage(m,F)}return F}getMessageColor(t){let e=`color:${!uu.isCanWhiteFont()&&(!uu.isTempCarteamRoom()||uu.isTruthSmallRoom()||uu.isTruthSmallRoom()||uu.isLoveTempRoom()||uu.isVideoTempRoom()||uu.isKtvSmallRoom()||uu.isWerewolfTeamRoom()||"#333"!=t)?t||"#333":"#eee"}`;return(uu.isVideoTempRoom()||uu.isLiveTempRoom())&&(e="color:#666"),uu.isDrawRoom()&&(e="color:#eee"),e}canvasBg(t){!function(t){var e=t||{},n=function(){return Math.random()},i=e.canvas||document.createElement("canvas"),o=i.width,s=i.height;null===i.parentNode&&(i.setAttribute("style","position:fixed;z-index:-1;left:0;top:0;min-width:100vw;min-height:100vh;"),o=i.width=window.innerWidth,s=i.height=window.innerHeight,document.body.appendChild(i));var a=i.getContext("2d");a.shadowColor=e.shadowColor||"#fff",a.shadowBlur=e.blur||4;var r=a.createLinearGradient(0,0,o,s);r.addColorStop(0,e.colorStart||"#2AE"),r.addColorStop(1,e.colorStop||"#17B");for(var c=e.bubbles||Math.floor(.02*(o+s)),l=[],d=0;d<c;d++)l.push({f:(e.bubbleFunc||function(){return"hsla(0, 0%, 100%, "+.1*n()+")"}).call(),x:n()*o,y:n()*s,r:(e.radiusFunc||function(){return 4+n()*o/25}).call(),a:(e.angleFunc||function(){return n()*Math.PI*2}).call(),v:(e.velocityFunc||function(){return.1+.5*n()}).call()});!function t(){if(null===i.parentNode)return cancelAnimationFrame(t);!1!==e.animate&&requestAnimationFrame(t),a.globalCompositeOperation="source-over",a.fillStyle=r,a.fillRect(0,0,o,s),a.globalCompositeOperation=e.compose||"lighter",l.forEach((function(t){a.beginPath(),a.arc(t.x,t.y,t.r,0,2*Math.PI),a.fillStyle=t.f,a.fill(),t.x+=Math.cos(t.a)*t.v,t.y+=Math.sin(t.a)*t.v,t.x-t.r>o&&(t.x=-t.r),t.x+t.r<0&&(t.x=o+t.r),t.y-t.r>s&&(t.y=-t.r),t.y+t.r<0&&(t.y=s+t.r)}))}()}({colorStart:"#4c004c",colorStop:"#1a001a",bubbles:40,canvas:document.querySelector("#canvastext_"+t)});const e=document.querySelector("#"+t+" .letters");e.innerHTML=e.textContent.replace(/\S/g,"<span class='letter'>$&</span>"),window.anime.timeline({loop:!1}).add({targets:"#"+t+" .letter",translateY:["1.1em",0],translateX:["0.55em",0],translateZ:0,rotateZ:[180,0],duration:750,easing:"easeOutExpo",delay:(t,e)=>50*e})}chatGiftTeachersList(t,e,n,i){if(t>Mt.maxUID)return;window.$("#divTeacherList").html("");let o=[],s=[];o.push(this._getGiftTeacherItem(0,"送麦上所有人","#666",0));const a=this;window.$(".room-item[channel='"+i+"'] .room-item-perons .person-item").each((function(){const t=this.dataset.uid,e=this.dataset.nickname,n=this.dataset.color;if(0!=t&&t<Mt.maxUID){s.some((e=>e==t))||(s.push(t),o.push(a._getGiftTeacherItem(t,e,n,0)))}})),(uu.isTempCarteamRoom()||uu.isLive17And18())&&uu.getAnchorKengUsers().forEach((t=>{s.push(t.uid),o.push(a._getGiftTeacherItem(t.uid,t.nickname,t.color,0))}));let r="";if(e.indexOf("♕")>-1){r=e.split("♕")[1]||""}if(e.indexOf("♚")>-1){r=e.split("♚")[1]||""}if(e.indexOf("♔")>-1){r=e.split("♔")[1]||""}if(e.indexOf("☬")>-1){r=e.split("☬")[1]||""}window.$("#selectGiftTeacher").text(r||e).attr("uid",t).attr("name",e).attr("color",n),window.$("#divTeacherList").html(o.join(""))}_getGiftTeacherItem(t,e,n,i){let o=e;return 0==t&&(o='<font style="color:red">'+e+"</font>"),'<p style="order:'+i+";color:"+n+'" uid="'+t+'" color="'+n+'" name="'+e+'">'+o+"</p>"}showUserFloatInfo({account:t,roomChannel:e,tposition:n=0,fid:i=0,aposition:o=-1,cid:s=uu.getCid(),isSpyOwner:a=!1}){return new Promise(((r,c)=>{qt.getUserInfo(t,"showUserFloatInfo").then((async c=>{const{nickname:l}=c;sessionStorage.setItem("setScoreNickName",l),qt.get(Ot.getUserScoreInfo(t)).then((async l=>{let d=0;if(0==l.error&&l.info){const t=l.info;d=t.evaluate,localStorage.setItem("userInfoScoreInfo",JSON.stringify(t))}const m=await this._setFloatInfo({account:t,roomChannel:e,person:c,tposition:n,fid:i,aposition:o,cid:s,isSpyOwner:a,evaluate:d});r(m)}))}))}))}async _setFloatInfo({account:t,roomChannel:e,person:n,tposition:i=0,fid:o=0,aposition:s=-1,cid:a=uu.getCid(),isSpyOwner:r=!1,evaluate:c}){const l=Ct.webpImgFormat(n.avatar),d=n.medal,m=n.uid,h=n.nickname;n.score;const u=1*n.teacher||1*n.teacher;n.vip;const p=n.viplevel,g=n.sex,f=n.vipuid,w=n.skin||"",v=n.skin_bg||"",_=n.vipicon;n.self_cid;let y=n.color;var x=Mt.domain+"/play/"+m+"/";let b="",$="",k=!1;const C=1*uu.getMeid(),I=this.Type;this.treeTimer&&(clearTimeout(this.treeTimer),this.treeTimer=null);const S=uu.isAdminUids(C),T=uu.isAdmin_spe_user(C),R=uu.roomInfo.is_patrol;if(e==uu.getChannel()&&(k=uu.isManager(C)||uu.isAnchoringUser(C)||S||T||uu.roomInfo.room_manage==C||uu.isAnchoringUser(uu.getMeid())||1==R||r||uu.isKtvSmallRoom()&&ad.getInstance().mineIsOwner()),k){let e="",n="",a="";T?e='<span account="'+t+'" type="'+I.koukuan+'" nickname="'+h+'">扣款</span>\n                            <span account="'+t+'" type="'+I.yongfeng+'" nickname="'+h+'">永封</span>':1==R?e='<span account="'+t+'" type="'+I.koukuan+'" nickname="'+h+'">扣款</span>':S?(e='<span account="'+t+'" type="'+I.koukuan+'" nickname="'+h+'">扣款</span>',a='<span account="'+t+'" type="'+I.notalk+'">禁言</span>'):r||(a='<span account="'+t+'" type="'+I.notalk+'">禁言</span>'),uu.isJingPaiRoom()&&uu.isAnchoringUser(C)&&t!=C&&(n='<span account="'+t+'" type="'+I.shangwei+'">上位</span>');let c=!0;if((uu.isKingTeamRoom()||uu.isPeaceTeamRoom())&&1!=uu.getRoomInfo().team_stage&&(c=!1),uu.isTempCarteamRoom())uu.isAnchors2(C)?b='<p class="guanliyuan-guanli" account="'+t+`">\n                                        <span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+'">下麦</span>\n                                    </p>':S||1==R?b='<p class="guanliyuan-guanli" account="'+t+'">\n                                        '+e+"\n                                        "+a+'\n                                        <span account="'+t+'" type="'+I.tiren+`">踢人</span>\n                                        <span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+'">下麦</span>\n                                    </p>':uu.roomInfo.room_manage==C?b='<p class="guanliyuan-guanli" account="'+t+'">\n                                        '+a+'\n                                        <span account="'+t+'" type="'+I.tiren+`">踢人</span>\n                                        <span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+'">下麦</span>\n                                    </p>':(uu.isAnchoringUser(uu.getMeid())||uu.isKtvSmallRoom()&&ad.getInstance().mineIsOwner())&&(b='<p class="guanliyuan-guanli" account="'+t+'">\n                                        '+a+`\n                                        <span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+'">下麦</span>\n                                    </p>');else{let l=function(e){return 1==e?`<span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+`" iscocosgame=${e}>下麦</span>`:`<span style="display: ${c?"block":"none"}" account="`+t+'" type="'+I.xiamai+'" tposition="'+i+'" fid="'+o+'" aposition="'+s+'">下麦</span>'},d=uu.isManager(C)||S||1==R?'<span account="'+t+'" type="'+I.tiren+'">踢人</span>':"",m="";if(r||!uu.isInAnchors(t)&&1!=R||(m=l()),8!=uu.getRoomInfo().game_info.gameid&&9!=uu.getRoomInfo().game_info.gameid||(r||18==uu.getRoomInfo().live&&!uu.getAnchoringUserId()&&uu.isInAnchors(C))&&(m=l(1)),(uu.isSpyActiveRoom()||uu.isCocosH5Room())&&0==m.length)try{(await _s.getInstance().getGameUsersWithUids()).map((t=>String(t))).includes(String(t))&&t!=uu.getMeid()&&(m=l())}catch(N){}b='<p class="guanliyuan-guanli" account="'+t+`">\n                                    ${e+n+a+d}\n                                    `+m+"\n                                </p>"}}$=f>0?`<span class='takeme-hide-tag vipid level_${p}'><span class="vipicon"></span>${f}</span>`:"ID:<span>"+m+"</span>";let M=uu.nameFormat(h,85,t);if(0==window.$(".chat-huiyuan-info").length){const t=window.$('<div class="flex chat-huiyuan-info"></div>');window.$("body").append(t),this.registryEvents(t),this.emitter.emit("registryEvents",t)}const A=window.$(".chat-huiyuan-info");A.attr("id","user_"+m),A.attr("uid",m),A.click((function(t){t.stopPropagation()}));let P="";""!=w?uu.isTakeMeRoom()&&uu.getAnchorKengUser(m)&&1==uu.getAnchorKengUser(m).face?(A.removeClass("skin"),A.css({background:"#eee",border:"solid 1px rgba(220,220,220,0.4)"}),P="background:#fff;"):(A.addClass("skin"),A.css({background:"url("+w+") no-repeat center center #eee",border:"transparent"}),P="background:rgba(0, 0, 0, 0.2);"):(A.removeClass("skin"),A.css({background:"#eee",border:"solid 1px rgba(220,220,220,0.4)"}),P="background:#fff;");let j="";uu.isTakeMeRoom()&&uu.getAnchorKengUser(m)&&1==uu.getAnchorKengUser(m).face||(j=""!=v?"background:url("+v+") no-repeat center center":"");let D="";"#ffe14c"==y?(D="ygb_title",y=""):"#b460da"==y?(D="ygb_pink",y=""):""!=w&&(y="#fff"),uu.isJiamianRoom()&&"#666"==y&&(y="#667"),M=uu.nameColor(y,M);let L="";!uu.getRoomInfo().manage_uid.split(",").map((t=>1*t)).includes(C)||uu.isJingPaiRoom()||uu.isTruthRoom()||(L='<div style="font-size:12px;height:18px;position:absolute;bottom:0; left:50%;transform:translateX(-50%); display:flex; width:75%">\n            <button class="float-yqsm" data-position="3" data-nickname="'+h+'" data-uid="'+m+'" style="width:52px; padding:0; flex:1; margin:0 5px">申请嘉宾</button>\n        </div>');let E="";""!=d&&(E='<img style="height:16px;" class="vipicon" src="'+d+'" />'),Ct.readCookie("Tuwan_Passport");let B="";0==uu.roomInfo.gift_hide&&(B='<a style="display:'+(m>Mt.maxUID?"none":"inline-block")+';" nickname="'+h+'" uid="'+m+'" color="'+y+'" href="javascript:;" class="chat-huiyuan-sentgift-btn" style="margin-right: 5px;">送礼物</a>');let F=`<p data-uid="${t}" data-nickname="${h}" class="report_user takeme-hide-tag">举报</p>`,U='<div class="chat-huiyuan-right-buttons takeme-hide-tag">\n                        <a target="_blank" href="'+x+`" class="chat-huiyuan-yue-btn ${0==n.teacher&&n.vip<=1&&"hide"}" style="cursor:pointer;">主页</a>\n                    </div>`,z=`<div class="setScoreCtn ${1!=c&&"hide"}" data-uid=${t} style="margin-left: 36px">\n                        <a href="javascript:void(0);" class="chat-huiyuan-yue-btn" style="cursor:pointer;">评价</a>\n                    </div>`;m>8e8&&(F="",U="");const O=`<div class="flex chat-huiyuan-info-top">\n                    ${F}\n                    <div class="huiyuan-head" style="position:relative;`+j+'">\n                        <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\';" src="'+l+'">\n                        '+L+'\n                    </div>\n                    <div class="huiyuan-head-right" style="flex:1;">\n                        <p class="huiyuan-head-right-nickname">\n                            <span style="display:inline-block; max-width:118px; overflow: hidden;display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; text-overflow:ellipsis; vertical-align:middle" class="'+D+'">'+M+'</span><em class="takeme-hide-tag '+(2==g?"girl":"man")+'">'+(2==g?"♀":"♂")+`</em></em>\n                        </p>\n                        <div class="chatWithPersonCtn ${(m==uu.getMeid()||1!=uu.roomInfo.at)&&"hide"}" uid="`+m+'">@Ta</div>\n                        <p class="takeme-hide-tag">\n                            <img style="height:16px; margin-right:5px" class="vipicon" src="'+_+'" />\n                            '+E+'\n                        </p>\n                        <p class="huiyuan-head-right-id takeme-hide-tag">'+$+"</p>\n                        \n                        "+b+'\n                        <div class="flex huiyuan-head-right-tree takeme-hide-tag" style="align-items:center; margin-top:2px"></div>\n                        <div class="flex huiyuan-head-right-summer"></div>\n                    </div>\n                </div>\n                <div style="clear: both;"></div>\n                <div class="flex flex-between chat-huiyuan-info-bottom" style="'+P+'">\n                    <div class="flex chat-huiyuan-buttons">\n                        <a style="display:'+(m>Mt.maxUID?"none":"inline-block")+`;margin-right: ${1==u?"5px":"10px"};" nickname="`+h+'" uid="'+m+'" href="javascript:;" class="chat-huiyuan-chat-btn takeme-hide-tag chartOne2One">私聊</a>\n                        '+B+"\n                    </div>\n\n                   "+z+"\n                   "+U+"\n                </div>";return A.html(O),this.treeTimer=setTimeout((()=>{let e=window.$(".chat-huiyuan-info").attr("uid");t==e&&"none"!==window.$(".chat-huiyuan-info").css("display")&&this._showTime(e,a)}),200),A}_showTime(t,e){qt.get(Pt+`/Activity/getUserCard?format=jsonp&platform=0&uid=${t}&cid=${e}`).then((n=>{if(0==n.error){if(e==uu.getCid()&&1==n.is_invite&&t!=uu.getMeid()&&(window.$(".chat-huiyuan-info .chat-huiyuan-right-buttons .chat-huiyuan-invite-btn").remove(),window.$(".chat-huiyuan-info .chat-huiyuan-right-buttons").prepend(`<a style="display:inline-block;" uid="${t}" color="#666" href="javascript:;" class="chat-huiyuan-invite-btn">邀请</a>`)),1*t<Mt.maxUID&&1==n.is_wheatinvite&&!uu.isInAnchors(t)&&t!=uu.getMeid()){const e=1*uu.getMeid(),n=uu.isAdminUids(e),i=uu.isAdmin_spe_user(e);if(n||i);else{const e=uu.roomInfo.party_set.listshow?"邀请上麦":"上麦",n=`<span class="guanli-invite-shangmai" type="invite-shangmai" account="${t}">${e}</span>`;window.$(".guanliyuan-guanli").length>0?(window.$(".guanliyuan-guanli .guanli-invite-shangmai").remove(),window.$(".guanliyuan-guanli").prepend(n)):window.$(".huiyuan-head-right-id").after(`<p class="guanliyuan-guanli">\n                                ${n}\n                            </p>`)}}const{data:i,type:o}=n;let s=[];for(let t=0;t<i.length;t++){const{image:e,time:n,is_user:o}=i[t];s.push('<div class="flex flex-center" style="align-items: center;">\n                                    <img style="width:22px;height:22px; border-radius:100%; border:solid 1px #ff7499; margin-right:4px" src="'+e+`" />\n                                    <p class="text_over huiyuan-head-right-time" title="${n}" style="font-size:12px;${1==o?"":"background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/timericon.png) no-repeat 0 center;text-indent:12px;"}">`+n+"</p>\n                                </div>")}if(window.$(".huiyuan-head-right-tree").html(s.join("")),o>0)if(window.$(".guanliyuan-guanli").length>0)window.$(".manage_host_btn").length>0&&window.$(".manage_host_btn").remove(),window.$(".guanliyuan-guanli").prepend(`<span class="manage_host_btn" type="manage_host_level" account="${t}" manage="${o}">${1==o?"金牌":"普通"}</span>`);else{let e=`<p class="guanliyuan-guanli">\n                                        <span class="manage_host_btn" type="manage_host_level" account="${t}" manage="${o}">${1==o?"金牌":"普通"}</span>\n                                    </p>`;window.$(".huiyuan-head-right-id").after(e)}else window.$(".manage_host_btn").remove()}}))}registryEvents(t){const e=this;t.on("click",".chat-huiyuan-sentgift-btn",(function(t){t.stopPropagation();const n=window.$(this).attr("uid"),i=window.$(this).attr("nickname"),o=window.$(this).attr("color");e.emitter.emit("showGiftWindow",n,i,o,Wo.getInstance().currentTab,Wo.getInstance().currentGiftId)})),t.on("click",".chat-huiyuan-invite-btn",(function(t){t.stopPropagation();const e=window.$(this).attr("uid");qt.get(Ot.werewolfInvite(uu.getCid(),e)).then((t=>{0!=t.error&&Vt(t.error_msg)}))})),t.on("click",".chat-huiyuan-chat-btn",(function(t){t.stopPropagation();const n=uu.getMeid();if(n>Mt.maxUID)return void e.emitter.emit("showLoginWindow");const i=window.$(this).attr("uid");if(n==i)return void Ct.Alert("要和自己聊天？自言自语好了。^_^");const o=window.$(this).attr("nickname");e.emitter.emit("setChatIframe",i,o)})),t.on("click",".chatWithPersonCtn",(function(t){t.stopPropagation();if(uu.getMeid()>Mt.maxUID)return void e.emitter.emit("showLoginWindow");let n=$(this).attr("uid");const i=$(".chat-input-chat-textarea textarea").val();$(".chat-input-chat-textarea textarea").val(`${i} @`),window.$(".at-user-item.selected").removeClass("selected"),window.$(`.at-user-item[data-uid=${n}]`).addClass("selected"),fe.getInstance().onEntry()})),t.on("click",".report_user",(function(){if(uu.getMeid()>Mt.maxUID)return void e.emitter.emit("showLoginWindow");const t={vid:this.dataset.uid,title:this.dataset.nickname};xs.getInstance().showReportModal(2,t)})),t.on("click",".setScoreCtn",(t=>{const e=t.currentTarget.dataset.uid,n=sessionStorage.getItem("setScoreNickName")||"";let i=$("body")[0];this.setScoreModelInstance=new bd({target:i}),this.setScoreModelInstance.open(e,n)}))}};class Cd{constructor(){this.keyupTimer=null,this.page=1,this.currrentPage=1,this.currrentIndex=0,this.currentSongCode=0,this.extVersion="",this._rtcclient=null,this._wssocket=null,this.reportTimer=null,this.audioContext=null,this.defaultGain=0,this.myMediaSteam=null,this.originalTrack=null,this.accompaniedTrack=null,this.engine=new va,this.lyric=null,this.pitchData=null,this.bgmType=1}static getInstance(){return this.instance||(this.instance=new Cd,this.instance.onEventListener()),this.instance}get isOriginalBgmStart(){var t;return(null==(t=null==this?void 0:this.originalTrack)?void 0:t.getCurrentTime())>0}get isAccompanyBgmStart(){var t;return(null==(t=null==this?void 0:this.accompaniedTrack)?void 0:t.getCurrentTime())>0}async justDownLoadLyric(t){try{const e=t+"";await this.engine.setUser(uu.getMeid()),this.lyric=await this.engine.getLyric(e,!0)}catch(e){console.log(e)}}onReset(){this.page=1,this.currrentPage=1,this.currrentIndex=0,0!=this.currentSongCode&&this.onStopLocalAudioMixin(),this.currentSongCode=0,this.clearReportTimer()}destorySomething(){this.destoryAudioTrack(),this.clearReportTimer()}clearReportTimer(){this.reportTimer&&(window.clearInterval(this.reportTimer),this.reportTimer=null)}bindSocket(t){this._wssocket=t}bindAgoraClient(t){this._rtcclient=t}onSearchSong(t){const e=this,n=xt.getInstance().getSongOrderList()||[];if(""!=t){let i;i=3==uu.getRoomInfo().yjx_song_switch?Ot.onSearchSongYinSuDa(t):Ot.onSearchSong(t),qt.get(i).then((t=>{window.$(".song-search-resource-list").empty(),0==t.error&&t.data.length>0?(window.$(".song-all-resource-list").addClass("hide"),window.$(".song-search-resource-list").removeClass("hide"),window.$(".song-search-empty").addClass("hide"),t.data.map((t=>{let e="";e=n.find((e=>e.code==t.song_code))?'<div class="song-search-resource-item-but" active="1" data-token="'+t.token+'" data-code="'+t.song_code+'"\n                            data-name="'+t.name+'" data-singer="'+t.singer+'" data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">已点</div>':'<div class="song-search-resource-item-but" data-token="'+t.token+'" data-code="'+t.song_code+'"\n                            data-name="'+t.name+'" data-singer="'+t.singer+'" data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">点歌</div>',window.$(".song-search-resource-list").append(' <div class="song-search-resource-item flex flex-jb flex-ac">\n                            <div class="song-search-resource-item-info">\n                                <div class="song-search-resource-item-title">'+t.name+'</div>\n                                <div class="song-search-resource-item-singer">'+t.singer+"</div>\n                            </div>\n                             "+e+"\n                        </div>")}))):e.onSearchEmpty()})).catch((t=>{e.onSearchEmpty()}))}else e.onShowResource()}onSearchEmpty(){window.$(".song-all-resource-list").addClass("hide"),window.$(".song-search-resource-list").addClass("hide"),window.$(".song-search-empty").removeClass("hide")}onShowResource(){window.$(".song-all-resource-list").removeClass("hide"),window.$(".song-search-resource-list").addClass("hide"),window.$(".song-search-empty").addClass("hide")}getSongList(){const t=this;t.onShowResource();const e=xt.getInstance().getSongOrderList()||[];if(this.currrentPage==this.page){let n;n=3==uu.getRoomInfo().yjx_song_switch?Ot.getSongListYinSuDa(this.page):Ot.getSongList(this.page),qt.get(n).then((n=>{0==n.error?(t.currrentPage=n.page,n.data.map((t=>{let n="";n=e.find((e=>e.code==t.song_code))?'<div class="song-search-resource-item-but" active="1" data-token="'+t.token+'" data-code="'+t.song_code+'"\n                            data-name="'+t.name+'" data-singer="'+t.singer+'" data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">已点</div>':'<div class="song-search-resource-item-but" data-token="'+t.token+'" data-code="'+t.song_code+'"\n                            data-name="'+t.name+'" data-singer="'+t.singer+'" data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">点歌</div>',window.$(".song-all-resource-list").append(' <div class="song-search-resource-item flex flex-jb flex-ac">\n                            <div class="song-search-resource-item-info">\n                                <div class="song-search-resource-item-title">'+t.name+'</div>\n                                <div class="song-search-resource-item-singer">'+t.singer+"</div>\n                            </div>\n                           "+n+"\n                        </div>")}))):t.page=t.currrentPage})).catch((e=>{t.page=t.currrentPage})),this.page++}}getOrderList(){const t=xt.getInstance().getSongOrderList()||[];t.length>0?(window.$(".song-order-resource-list").empty(),window.$(".song-order-resource-list").removeClass("hide"),window.$(".song-order-empty").addClass("hide"),t.map((t=>{window.$(".song-order-resource-list").append('\n                    <div class="song-search-resource-item flex flex-jb flex-ac" data-token="'+t.token+'" data-code="'+t.code+'" data-name="'+t.name+'" data-singer="'+t.singer+'"  data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">\n                        <div class="song-search-resource-item-info">\n                            <div class="song-search-resource-item-title">'+t.name+'</div>\n                            <div class="song-search-resource-item-singer flex">\n                                <img src="https://res.tuwan.com/chatroom/images/icon_song_playing.gif" /> '+t.singer+'\n                            </div>\n                        </div>\n                        <div class="flex flex-ac">\n                            <div class="song-order-reset" style="width: 16px; height: 16px; margin-top: -6px; border: 2px solid #dddddd; background-color: #ffffff; border-radius: 4px; margin-right: 10px;"/>\n                            <div class="song-order-option" data-token="'+t.token+'" data-code="'+t.code+'" data-name="'+t.name+'" data-singer="'+t.singer+'" data-type="'+t.type+'" data-lyric="'+t.lyric_type+'">\n                                <img src="https://res.tuwan.com/chatroom/images/icon_song_del.png" />\n                            </div>\n                        </div>\n                    </div>\n                ')})),window.$('.song-order-resource-list .song-search-resource-item[data-code="'+this.currentSongCode+'"]').addClass("playing")):(window.$(".song-order-resource-list").addClass("hide"),window.$(".song-order-empty").removeClass("hide"))}onStopLocalAudioMixin(){this.clearReportTimer(),0!=this.currentSongCode&&(le.getInstance()._onStopLocalAudioMixin(),mu.getInstance()._onStopLocalAudioMixin(),qt.get(Ot.setSongPlayYinSuDa(uu.getCid(),this.currentSongCode)),this._wssocket.send("setSongPlay",{cid:uu.getCid(),song_code:this.currentSongCode,platform:0,play:0}),this.currentSongCode=0,window.$(".song-order-resource-list .song-search-resource-item").removeClass("playing"),window.$(".song-play-name").text("暂无歌曲"),window.$(".song-play-anchor").text("无"),window.$(".song-but-accompany").addClass("hide"),this.destorySomething())}onShowPlayingSongFlag(t,e){if(le.getInstance().onShowPlayingSongFlag(t,e),t){window.$('.song-order-resource-list .song-search-resource-item[data-code="'+t+'"]').addClass("playing");const e=window.$('.song-order-resource-list .song-search-resource-item[data-code="'+t+'"]')[0].dataset;window.$(".song-play-name").text(e.name),window.$(".song-play-anchor").text(e.singer)}}noticeServicePlayingCode(t){qt.get(Ot.setSongPlayYinSuDa(uu.getCid(),t)),this._wssocket.send("setSongPlay",{cid:uu.getCid(),song_code:t,platform:0,play:1})}destoryAudioTrack(){this.originalTrack&&(this.originalTrack.stopProcessAudioBuffer(),this.originalTrack.stop(),this._rtcclient.unpublishCustomAudioTrack(this.originalTrack),this.originalTrack=null),this.accompaniedTrack&&(this.accompaniedTrack.stopProcessAudioBuffer(),this.accompaniedTrack.stop(),this._rtcclient.unpublishCustomAudioTrack(this.accompaniedTrack),this.accompaniedTrack=null)}async playSongWithCode(t,e){ys.show({text:"正在下载歌词，请稍等..."});try{this.currentSongCode=e,this.destoryAudioTrack(),this.downloadUrl(t)}catch(n){ys.hide()}}async downloadUrl(t){let e=t.split("|");const n=await Promise.all([fetch(e[0]),fetch(e[1])]),i=await n[0].arrayBuffer(),o=await n[1].arrayBuffer();if(await this.createCustomAudioTrack([i,o]),await this.publishCustomAudioTrack(),this.startReportTimer(),uu.isSongTempRoom()){if(1!=uu.getAnchorKengUser(uu.getMeid()).live_rec)return}this.onShowPlayingSongFlag(this.currentSongCode,1),this.noticeServicePlayingCode(this.currentSongCode),Vt("下载成功，正在进行播放"),ys.hide()}async handelSetTrackAndPublish(){if(await this.createCustomAudioTrack_yinsuda(),await this.publishCustomAudioTrack(),this.startReportTimer(),uu.isSongTempRoom()){if(1!=uu.getAnchorKengUser(uu.getMeid()).live_rec)return}this.onShowPlayingSongFlag(this.currentSongCode,1),this.noticeServicePlayingCode(this.currentSongCode),Vt("下载成功，正在进行播放"),ys.hide()}async createCustomAudioTrack(t){const[e,n]=t;var i=new AudioContext;const o=await i.decodeAudioData(e);this.originalTrack=await window.AgoraRTC.createBufferSourceAudioTrack({source:o});var s=new AudioContext;const a=await s.decodeAudioData(n);this.accompaniedTrack=await window.AgoraRTC.createBufferSourceAudioTrack({source:a});const r=window.$(".song-play-volume-slide input[type='range']").val();this.originalTrack.setVolume(parseInt(r)),this.accompaniedTrack.setVolume(parseInt(r))}async createCustomAudioTrack_yinsuda(){this.originalTrack=this.engine.originalBgmTrack,this.accompaniedTrack=this.engine.accompanyBgmTrack;const t=window.$(".song-play-volume-slide input[type='range']").val();this.originalTrack.setVolume(parseInt(t)),this.accompaniedTrack.setVolume(parseInt(t))}async publishCustomAudioTrack(){var t,e,n,i,o,s;1==this.defaultGain?this.originalTrack&&(null==(t=this.originalTrack)||t.startProcessAudioBuffer(),null==(e=this.originalTrack)||e.seekAudioBuffer(0),null==(n=this.originalTrack)||n.play()):this.accompaniedTrack&&(null==(i=this.accompaniedTrack)||i.startProcessAudioBuffer(),null==(o=this.accompaniedTrack)||o.seekAudioBuffer(0),null==(s=this.accompaniedTrack)||s.play()),this.originalTrack&&this._rtcclient.publishCustomAudioTrack(this.originalTrack),this.accompaniedTrack&&this._rtcclient.publishCustomAudioTrack(this.accompaniedTrack)}startReportTimer(){const t=this.originalTrack.duration||this.originalTrack.source.duration;this.reportTimer=setInterval((()=>{let e=0;this.originalTrack&&1==this.defaultGain?e=this.originalTrack.getCurrentTime():this.accompaniedTrack&&0==this.defaultGain&&(e=this.accompaniedTrack.getCurrentTime()),this.disposeLyrisProgress(e,t)}),50)}disposeLyrisProgress(t,e){uu.isSongTempRoom()?le.getInstance().setLyricsOffSets(t):uu.isSongPkRoom()&&mu.getInstance().setLyricsOffSets(t),this.onSyncCurrentTime(t,e),0!=t&&(uu.isSongTempRoom()||uu.isSongPkRoom())||this.onStopLocalAudioMixin()}onTaggerGain(){var t,e,n,i,o,s,a,r,c,l,d,m,h,u;if(1==this.defaultGain){if(this.originalTrack){let r=this.originalTrack.getCurrentTime(),c=this.accompaniedTrack.getCurrentTime(),l=r>c?r:c;null==(t=this.accompaniedTrack)||t.pauseProcessAudioBuffer(),this.isOriginalBgmStart?(null==(e=this.originalTrack)||e.seekAudioBuffer(l),this._pause||null==(n=this.originalTrack)||n.resumeProcessAudioBuffer()):this._pause?null==(a=this.originalTrack)||a.seekAudioBuffer(l):(null==(i=this.originalTrack)||i.startProcessAudioBuffer(),null==(o=this.originalTrack)||o.seekAudioBuffer(l),null==(s=this.originalTrack)||s.play())}}else if(this.originalTrack){let t=this.originalTrack.getCurrentTime(),e=this.accompaniedTrack.getCurrentTime(),n=t>e?t:e;null==(r=this.originalTrack)||r.pauseProcessAudioBuffer(),this.isAccompanyBgmStart?(null==(c=this.accompaniedTrack)||c.seekAudioBuffer(n),this._pause||null==(l=this.accompaniedTrack)||l.resumeProcessAudioBuffer()):this._pause?null==(u=this.accompaniedTrack)||u.seekAudioBuffer(n):(null==(d=this.accompaniedTrack)||d.startProcessAudioBuffer(),null==(m=this.accompaniedTrack)||m.seekAudioBuffer(n),null==(h=this.accompaniedTrack)||h.play())}}onSyncCurrentTime(t,e){const n=uu.getMeid(),i=kd.Type,o=e==t&&0!=t,s=kd.messageFormat(i.song,this.currentSongCode,parseInt(1e3*e),parseInt(1e3*t),n,o),a=JSON.parse(s+"");a.version="1";const r={message:JSON.stringify(a)};this._wssocket.send("message",r)}showQukuModal(){window.$(".song-queuelist").show(),window.$(".song-play-volume-slide").css("display","none"),0==window.$(".song-search-resource-item").length&&this.getSongList()}needMuteCustomTrack(){if(uu.isSongTempRoom()&&this.originalTrack){if(uu.isVeRtc())return!0;if(this.originalTrack.isPlaying||this.accompaniedTrack.isPlaying)return this.originalTrack.setVolume(0),this.originalTrack.setMuted(!0),this.accompaniedTrack.setVolume(0),this.accompaniedTrack.setMuted(!0),this._rtcclient.localAudio.setMuted(!0),!0}return!1}needUnMuteCustomTrack(){if(uu.isSongTempRoom()&&this.originalTrack&&this.originalTrack.muted){const t=1*window.$(".song-play-volume-slide input[type='range']").val();return this.originalTrack.setVolume(t),this.originalTrack.setMuted(!1),this.accompaniedTrack.setVolume(t),this.accompaniedTrack.setMuted(!1),this._rtcclient.localAudio&&this._rtcclient.localAudio.setMuted(!1),!0}return!1}onEventListener(){const t=this;window.$(".song-queue-tab").on("click",(e=>{const n=e.target.dataset.tab;this.currrentIndex=n,window.$(".song-queue-tab.active").removeClass("active"),window.$(e.target).addClass("active"),0==this.currrentIndex?(window.$(".song-search-container").removeClass("hide"),window.$(".song-order-container").addClass("hide")):(window.$(".song-search-container").addClass("hide"),window.$(".song-order-container").removeClass("hide"),t.getOrderList())})),window.$(".song-search-bar-input").on("keyup",(function(e){null==t.keyupTimer&&(t.keyupTimer=setTimeout((()=>{t.onSearchSong(e.target.value),clearTimeout(t.keyupTimer),t.keyupTimer=null}),1e3))})),window.$(".song-all-resource-list").on("scroll",(function(){const e=window.$(this).height(),n=this.scrollHeight,i=this.scrollTop;Math.ceil(i+e)>=n&&t.getSongList()})),window.$(".song-queuelist").on("click",(function(t){t.stopPropagation(),window.$(t.target).is(".song-play-volume")||window.$(".song-play-volume-slide").css("display","none")})),window.$(".song-play-volume-slide input[type='range']").on("input",(function(){let e=window.$(this).val();t.originalTrack&&t.originalTrack.setVolume(1*e),t.accompaniedTrack&&t.accompaniedTrack.setVolume(1*e)})),window.$(".song-all-resource-list,.song-search-resource-list").on("click",".song-search-resource-item-but",(function(t){const e=t.target.dataset;if(1!=e.active){window.$(t.target).attr("active",1),window.$(t.target).text("已点");let n=xt.getInstance().getSongOrderList()||[];n.push({token:e.token,code:e.code,name:e.name,singer:e.singer,time:(new Date).getTime(),type:e.type,lyric_type:e.lyric}),xt.getInstance().setSongOrderList(n)}})),window.$(".song-order-resource-list").on("click",".song-search-resource-item",(async function(e){e.stopPropagation();const n=e.currentTarget.dataset,i=n.code;if(n.token,n.name,n.type,n.lyric,window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin"))Vt("您还未开麦,请开麦后再试..");else if(i!=t.currentSongCode)if(uu.isSongPkRoom()&&0==t.currentSongCode&&Date.parse(new Date)/1e3-mu.getInstance().lyricTimestamp<=2)Vt("当前已经有选手正在播放音乐，请告知对方暂停播放音乐。");else{if(t.onStopLocalAudioMixin(),uu.isSongTempRoom()){if(1!=uu.getAnchorKengUser(uu.getMeid()).live_rec)return void Vt("请在歌手位置,在播放背景音乐..")}ys.show({text:"正在下载歌词，请稍等..."});try{t.destoryAudioTrack();const e=i+"";t.currentSongCode=e,await t.engine.setUser(uu.getMeid()),t.lyric=await t.engine.getLyric(e,!0),t.pitchData=await t.engine.getPitchData(e),t.engine.prepare(),await t.engine.genBgmTracks(e,!0),t.handelSetTrackAndPublish()}catch(o){console.log(o),ys.hide(),Vt("网络错误,请稍后再试..")}}})),window.$(".song-order-resource-list").on("click",".song-order-reset",(function(e){e.stopPropagation(),t.onStopLocalAudioMixin()})),window.$(".song-order-resource-list").on("click",".song-order-option",(function(e){e.stopPropagation();const n=e.currentTarget.dataset,i=n.code,o=n.name;de.getInstance().show("提示","您确定要删除"+o+"?",!1,"取消","确认",(()=>{const n=window.$('.song-search-resource-item-but[data-code="'+i+'"]');n.removeAttr("active"),n.text("点歌"),window.$(e.currentTarget.parentElement.parentElement).remove();let o=xt.getInstance().getSongOrderList()||[];xt.getInstance().setSongOrderList(o.filter((t=>t.code!=i))),i==t.currentSongCode&&t.onStopLocalAudioMixin()}))})),window.$(".song-play-volume").on("click",(function(){window.$(".song-play-volume-slide").css("display","flex")}))}}class Id{constructor(){this.initStyle(),this.actData=null,this.cid=0,window.isYgbShowActive=!0,this.emitter=new Ht,this.ranklist=[],this.bannerSwiper=null,this.rankTitleArr=[],this.list=[],this.images=[],this.modalData={},this.curIndex=0,this.jumpUrl="",this.actId=0,this.text={},this.stageArr=[],this.curItem={},this.timeID=null,this.itemData=null,this.textArr=[],this.rankIdArr=[]}static getInstance(){return this.instance||(this.instance=new Id),this.instance}initStyle(){window.$("head").append('<style>/* 浮窗 */\n#act_modal_content{position:absolute;top:70%;width:140px;height:140px;right:350px;z-index:100;cursor:pointer}\n.act_modal_icon_content{display:block !important;width:140px !important;height:140px !important;}\n.act_icon_item{z-index:10;position:relative;left:50%;transform:translateX(-50%);width:120px;height:120px;}\n.act_modal_close{cursor:pointer;width:18px;height:18px;background:url(https://res.tuwan.com/templet/play/rechargefirst/recharge_first_little_close.png);background-size:100% 100%;position:absolute;top:6px;right:17px;z-index:800}\n.swiper_item{flex-direction:column;}\n\n/* 公共样式 */\n.float_window_modal{display:none;width:310px;height:460px;position:absolute;left:-300px;bottom:10px;background-size:100% 100%;z-index:800;font-size:14px;text-align:center;box-sizing:border-box}\n.float_window_flex{display:flex;}\n.float_window_flex_c{display:flex;align-items:center;justify-content:center}\n.float_window_flex_sb{display:flex;align-items:center;justify-content:space-between}\n.float_window_common_img{max-width:80%;max-height:80%}\n.float_window_progress_bg{width:240px;height:14px;margin:0 auto 4px;position:relative;border-radius:7px;}\n.float_window_progress_val{height:14px;position:relative;border-radius:7px}\n.float_window_progress_rate{position:absolute;width:100%;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;color:#fff}\n.float_window_explain{font-size:12px;height:32px;}\n.float_window_text_over{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n.float_window_nav_content{width: 288px;margin:40px auto 4px;font-weight:bold;}\n.float_window_common_gift_svga {position: relative;width: 100%;height: 100%;}\n.float_window_common_gift_svga canvas {position: absolute !important;}\n\n\n/* 里程浮窗 */\n.float_window_meter_title{font-size:16px;margin:8px auto 16px;font-weight:bold;color:#fff}\n.float_window_meter_cp_content{margin-top:10px}\n.float_window_user_info{font-weight:bold;margin:-10px 10px 0}\n.float_window_cp_header_content{position:relative;width:90px;height:90px;margin:0 auto 0;}\n.float_window_cp_header_border{position:absolute;z-index:10;left:0;width:90px;height:90px;}\n.float_window_cp_header_avatar{position:relative;z-index:1;width:70px;height:70px;border-radius:50%;}\n.float_window_cp_name{width:120px;margin:0 auto;}\n.float_window_cp_score{width:120px;font-weight:normal;font-size:12px;}\n.float_window_meter_progress_bg{width:220px;height:40px;margin:5px auto 0;position:relative;}\n.float_window_meter_progress_val{height:40px;position:relative;}\n.float_window_meter_progress_icon_content{width:220px;height:35px;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:10}\n.float_window_meter_progress_icon_item{width:35px;height:35px;}\n.float_window_cp_cid_info{width:240px;margin:5px auto;font-size:14px;}\n.float_window_cp_cid_info a{text-decoration: none;}\n\n/* 收集浮窗 */\n.float_window_collect_title{font-size:18px;height:24px;font-weight:bold;margin-top:16px;color:#fff6cd}\n.float_window_collect_task_content{margin:0 auto 10px;font-size:12px;justify-content: center;}\n.float_window_collect_task_item{line-height:1}\n.float_window_collect_task_text{margin-top:4px}\n\n/* 彩蛋套装 */\n.suit_content{margin-top:5px}\n.suit_egg_pic{width:130px;}\n.suit_detail_content{width:205px;height:94px;margin:0 5px;font-size:12px}\n\n/* CP浮窗 */\n.float_window_act_rank_item{width:288px;height:64px;margin:0 auto;text-align:left;box-sizing:border-box;align-items:center}\n.float_window_act_rank_index{width:46px;margin-left:20px;text-align:center}\n.float_window_act_cp_header{position:relative;width:80px;margin:0 6px}\n.float_window_act_cp_header_item{width:36px;height:36px;border-radius:50%;margin:0}\n.float_window_act_cp_heart{position:absolute;left:50%;top:50%;transform: translate(-50%, -50%);}\n.float_window_act_cp_name_content{width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}\n.float_window_act_cp_name_item{width:60px}\n\n.act_womenleague{display:none;position:absolute;left:-280px;bottom:8px;background-size:100% 100%;z-index:800;font-size:14px;color:#ffb28c;text-align:center;padding-top:56px;box-sizing:border-box;transform:translate(-82%,-70%)}\n.act_womenleague .act_womenleague_close { position: absolute; right: -20px; top: 0; width: 18px; height: 18px; }\n.act_womenleague .act_womenleague_teamnames { display: flex; padding: 0 20px; justify-content: space-between; }\n.act_womenleague .act_womenleague_teamnames .act_womenleague_teamname  { font-size: 16px; font-weight: bold; width: 110px; white-space: nowrap; text-aligen: center; line-height: 44px; }\n.act_womenleague .act_womenleague_teaminfo_list { display: flex; padding: 0 20px; justify-content: space-between; }\n.act_womenleague .act_womenleague_teaminfo  { display: flex; flex-direction: column; }\n.act_womenleague .act_womenleague_team_member { display: flex; align-items: flex-end; margin-bottom: 8px; }\n.act_womenleague .act_womenleague_team_member_info { display: flex; flex-direction: column; align-items: center; }\n.act_womenleague .act_womenleague_avatar { width: 42px; height: 42px; background: url(\'https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_team_info_avatar.png\') center center no-repeat; background-size: 100% 100%; box-sizing: border-box; padding: 2px; }\n.act_womenleague .act_womenleague_avatar img { width: 100%; height: 100%; border-radius: 100%; }\n.act_womenleague .act_womenleague_name { font-size: 12px; color: #2dc4ff; margin-top: 8px; line-height: 12px; }\n.act_womenleague .act_womenleague_vote_info { font-size: 10px; line-height: 14px; margin-left: 6px; display: flex; flex-direction: column; align-items: flex-start; }\n.act_womenleague .act_womenleague_vote_num { text-align: left; white-space: nowrap; }\n.act_womenleague .act_womenleague_vote_btn { cursor: pointer;   width: 58px;  height: 22px;  background: url("https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_vote_btn.png?v=1") center center no-repeat;  background-size: 100% 100%; margin-top: 4px; }\n.act_womenleague .act_womenleague_gift_btn { cursor: pointer;   width: 58px;  height: 22px;  background: url("https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_gift_btn.png?v=1") center center no-repeat;  background-size: 100% 100%; margin-top: 4px; }\n\n.act_womenleague_vote{display:none;position:absolute;left:-580px;bottom:40px;background-size:100% 100%;z-index:850;font-size:12px;box-sizing: border-box;transform:translate(-100%,-50%)}\n.act_womenleague_vote .act_womenleague_vote_close { position: absolute; right: -20px; top: 0; width: 18px; height: 18px; }\n.act_womenleague_vote .act_womenleague_vote_song_tips {    font-size: 12px;    line-height: 20px; white-space: nowrap; text-align: center;}\n.act_womenleague_vote .act_womenleague_vote_song_tips span { color: #ffea00;}\n.act_womenleague_vote .act_womenleague_vote_song_rank {    font-size: 10px;   margin-top: 12px; text-align: center;}\n.act_womenleague_vote .act_womenleague_vote_song_content {  display: flex;  width: 190px; justify-content: space-between;   margin: 14px auto;}\n.act_womenleague_vote .act_womenleague_vote_num_btn {    width: 30px;    height: 30px;  line-height: 30px;   color: #c95afc;    font-size: 22px;    font-weight: bold;}\n.act_womenleague_vote .act_womenleague_vote_input {    width: 125px;    height: 30px;    line-height: 30px;   background: #6729ee;    outline: none;    border: none;    font-size: 20px;    font-weight: bold;    padding: 0 10px;    box-sizing: border-box;    border: 1px solid #8631de;    color: #c95afc;    text-align: center;}\n.act_womenleague_vote .act_womenleague_vote_input::-webkit-outer-spin-button,.act_womenleague_vote_input::-webkit-inner-spin-button {    -webkit-appearance: none;}\n.act_womenleague_vote .act_womenleague_vote_input[type="number"] {    -moz-appearance: textfield;}\n.act_womenleague_vote .act_womenleague_vote_num_list {    width: 192px;    height: 34px;    margin: 0 auto 30px;    display: none;}\n.act_womenleague_vote .act_womenleague_vote_num_item {    width: 60px;    height: 34px;    border-radius: 3px;    background: #8e6eff;    color: #fff;    line-height: 34px;    text-align: center;    font-size: 18px;}\n.act_womenleague_vote .act_womenleague_vote_btn {    width: 76px;    height: 33px;    background: url(https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_vote_modal_btn.png) center center no-repeat;    background-size: 100% 100%;    margin: 0 auto;}\n\n\n.act_womenleague_gift{display:none;position:absolute;left:-580px;bottom:40px;background-size:100% 100%;z-index:850;font-size:12px;box-sizing: border-box;transform:translate(-100%,-54%)}\n.act_womenleague_gift .act_womenleague_gift_close { position: absolute; right: -20px; top: 0; width: 18px; height: 18px; }\n.act_womenleague_gift .act_womenleague_gift_song_tips {    font-size: 12px;    line-height: 15px;  padding: 0 20px; text-align: center; }\n.act_womenleague_gift .act_womenleague_gift_song_tips span { color: #ffea00;}\n.act_womenleague_gift .act_womenleague_gift_preview {   width: 176px; height: 100px; border: 1px solid #872cdc; background: #4b20a9; display: flex; flex-direction: column; align-items: center; margin: 5px auto;}\n.act_womenleague_gift .act_womenleague_gift_preview img {   width: 58px; height: 58px;}\n.act_womenleague_gift .act_womenleague_gift_content {  display: flex;  width: 178px; justify-content: space-between;   margin: 0 auto;  margin-top: 3px;}\n.act_womenleague_gift .act_womenleague_gift_content label { white-space: nowrap;}\n.act_womenleague_gift .act_womenleague_gift_num_btn {    width: 20px;    height: 20px;  line-height: 20px;   color: #c95afc;    font-size: 16px;    font-weight: bold;}\n.act_womenleague_gift .act_womenleague_gift_input {    width: 58px;    height: 20px;    line-height: 20px;   background: #6729ee;    outline: none;    border: none;    font-size: 14px;    font-weight: bold;    padding: 0 10px;    box-sizing: border-box;    border: 1px solid #8631de;    color: #c95afc;    text-align: center;}\n.act_womenleague_gift .act_womenleague_gift_input::-webkit-outer-spin-button,.act_womenleague_gift_input::-webkit-inner-spin-button {    -webkit-appearance: none;}\n.act_womenleague_gift .act_womenleague_gift_input[type="number"] {    -moz-appearance: textfield;}\n.act_womenleague_gift .act_womenleague_gift_num_list {   display: flex;  width: 178px;  justify-content: space-between; margin: 0 auto; margin-top: 3px; }\n.act_womenleague_gift .act_womenleague_gift_num_item {    border: 1px solid #833ee4;   height: 16px;    border-radius: 3px;     color: #ffffff;  padding: 0 4px;  line-height: 16px;    text-align: center;    font-size: 12px; cursor: pointer; }\n.act_womenleague_gift .act_womenleague_gift_btns { display: flex;  width: 170px; justify-content: space-between; align-items: center;  margin: 0 auto; margin-top: 2px; }\n.act_womenleague_gift .act_womenleague_gift_send_btn {    width: 76px;    height: 33px;    background: url(https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_gift_send_btn.png) center center no-repeat;    background-size: 100% 100%;    margin: 0 auto;}\n.act_womenleague_gift .act_womenleague_gift_cancel_btn {    width: 66px;    height: 23px;    background: url(https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_gift_cancel_btn.png) center center no-repeat;    background-size: 100% 100%;    margin: 0 auto;}\n\n.act_singrank_userlist { display: flex; flex-direction: column; overflow-y: auto; overflow-x: hidden; margin-top: 10px; width: 100%; height: 290px; }\n.act_singrank_userlist::-webkit-scrollbar {width: 4px;background: #414d98;border-radius: 4px;}\n.act_singrank_userlist::-webkit-scrollbar-thumb {width: 4px;background: #6a79e3;border-radius: 4px;}\n.act_singrank_userinfo { display: flex; align-items: center; margin: 3px auto; width: 100%;}\n.act_singrank_idx { margin-left: 28px; width: 26px; height: 26px; display: flex; align-items: center; justify-content: center; color: #000b2f;  background: url(https://asset.tuwan.com/activity/play/2021/2021singrank/images/rank_index_bg.png) center center no-repeat;    background-size: 100% 100%; }\n.act_singrank_avatar { margin-left: 42px; width: 52px; height: 52px; border-radius: 100%; border: 2px solid #505db4; box-sizing: border-box; }\n.act_singrank_avatar img { width: 100%; height: 100%; border-radius: 100%; }\n.act_singrank_name { margin-left: 8px; max-width: 75px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\n.act_singrank_num { color: #5bd6ff; width: 66px; margin-left: auto; text-align: center; }\n.gopage { display: block; margin: 0 auto; margin-top: 10px; width: 102px; height: 39px;  background: url(https://asset.tuwan.com/activity/play/2021/2021singrank/images/gopage_btn.png) center center no-repeat;    background-size: 100% 100%; }\n\n\n\n.act_musicrank { display:flex; flex-direction: column; overflow-y: auto; overflow-x: hidden; margin-top: 80px; width: 100%; height: 270px; padding: 0 25px; box-sizing: border-box; }\n.act_musicrank::-webkit-scrollbar {width: 4px;background: transparent;border-radius: 4px;}\n.act_musicrank::-webkit-scrollbar-thumb {width: 4px;background: #68329d;border-radius: 4px;}\n.act_musicrank_userinfo { display: flex; align-items: center; margin: 0 auto; width: 100%; border-bottom:1px dotted rgba(121,67,184,0.7); padding: 10px 0; box-sizing: border-box;}\n.act_musicrank_userinfo:last-child{ border-bottom:1px dotted transparent; }\n.act_musicrank_idx {  width: 26px; height: 26px; display: flex; align-items: center; justify-content: center; color: #ffffff; font-size: 18px;  }\n.act_musicrank_avatar { margin-left: 10px; width: 26px; height: 26px; border-radius: 100%; border: 2px solid #fe98d4; box-sizing: border-box; }\n.act_musicrank_avatar img { width: 100%; height: 100%; border-radius: 100%; }\n.act_musicrank_name { margin-left: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;color: #e1c1ff; font-size: 14px; max-width: 110px;  }\n.act_musicrank_btn { color: #feffb8; height: 28px; font-size: 14px; margin-left: auto; display: flex; align-items: center; justify-content: center; background: #ff77c7; border-radius: 8px; cursor: pointer; padding: 0 10px; }\n\n\n.romantic_card_content{width:264px;height:188px;margin:0 auto;padding-top:85px;box-sizing:border-box}\n.romantic_card_content .float_window_user_info .float_window_cp_header_content{width:64px;height:64px}\n.romantic_card_content .float_window_user_info .float_window_cp_header_border{width:64px;height:64px}\n.romantic_card_content .float_window_user_info .float_window_cp_header_avatar{width:50px;height:50px}\n.romantic_card_content .float_window_user_info .float_window_cp_name{width:80px;margin-top:-6px;font-weight: normal}\n.romantic_heart{margin:0 -20px}\n.romantic_card_gift_content{margin:6px auto}\n.romantic_card_gift_item{width:60px;margin:0 4px}\n.romantic_card_gift_img{width:50px;height:50px;margin:0 auto 2px;}\n\n\n.wolf_container{position: relative;height:100%;display: flex;flex-direction: column;align-items: center;}\n.wolf_countdonw {font-size: 16px;font-weight: 400;color: #FFFFFF;line-height: 26px;margin-top:8px;}\n.wolf_countdonw span {font-size: 18px;font-weight: 500;}\n.wolf_title {height: 27px;width: 277px;margin: 24px 0;background: url(https://res.tuwan.com/activity/wolfmatch/wolf_match_pc_title.png) no-repeat center / 100% 100%;}\n.wolf_bottom {width: 100%;height: 60px;position: absolute;bottom: 0;}\n.wolf_bottom div{width: 290px;height: 60px;background: url(https://res.tuwan.com/activity/wolfmatch/wolf_match_bottom.png) no-repeat center / 100% 100%;margin-left: 10px;}\n.wolf_header {width: 54px;height: 54px;border: 1px solid #FFFFFF;border-radius: 100%;position: relative;margin:0 9px 9px 9px;}\n.wolf_item {width: 72px;margin-bottom: 20px;display: flex;flex-direction: column;align-items: center;}\n.wolf_header .mine {position: absolute;bottom: 0;left: 0;width: 21px;height: 21px;background: url(https://res.tuwan.com/activity/wolfmatch/wolf_match_mine.png) no-repeat center / 100% 100%;}\n.wolf_header img {width: 100%;height: 100%;border-radius: 100%;overflow: hidden;}\n.wolf_name {font-size: 12px;font-weight: 400;color: #FFFFFF;line-height: 18px;white-space: nowrap;text-overflow: ellipsis;overflow: hidden;text-align: center;width:72px;}\n.wolf_warpper {display: flex;overflow-y: auto;width:100%;flex:1;}\n.wolf_content {display: grid;padding: 0 10px;grid-template-columns: repeat(4, auto);margin-bottom: auto;}\n.wolf_warpper::-webkit-scrollbar {width: 0px;}\n\n\n.constellation_content{position: relative;top: 13px;left: 25px;}\n.constellation_content img{position: absolute;left:0;top:0}\n.take_content{display:none;width:286px;height:194px;position:absolute;left:50%;transform: translateX(-50%);bottom:11px}\n\n.goddess_gift_content{margin:10px auto}\n.goddess_gift_item{width:82px;margin:0 4px}\n.goddess_gift_img{width:73px;height:73px;margin:0 auto 2px;}\n\n.goddess_progress_bg{width:198px;height:8px;margin:16px auto 14px;position:relative;border-radius:4px}\n.goddess_progress_val{height:8px;position:relative;border-radius:4px}\n.goddess_star{position:absolute;top:50%;transform: translate(-50%,-50%);z-index:10}\n\n\n.float_window_tab_item{margin:0 10px;cursor:pointer;opacity:.5}\n.float_window_tab_item.actived{opacity:1}\n.guard_rank_item{align-items: center;height: 60px}\n.guard_rank_index{width:100px;margin-left: 30px;margin-right: 8px}\n.guard_rank_info_content{align-items: center;text-align: left;line-height: 20px}\n.guard_rank_avatar_content{position: relative;width: 40px;height: 40px;margin-right: 8px}\n.guard_rank_avatar_border{position: absolute;top:0;left:0;z-index: 10}\n.guard_rank_avatar{width: 36px;height: 36px;border-radius: 50%}\n.float_window_tab_common_content{position:relative;height:250px}\n.task_nav_content{position:absolute;left:50%;transform:translateX(-50%);bottom:20px}\n.task_nav_item{width:10px;height:10px;background: #37118b;border-radius:50%;margin:0 5px}\n.task_nav_item.actived{background: #7636ff;}\n.task_arrow_item{margin:0 10px}\n.special_color {color: #f99f9f}\n.task_text_content{width:100%;height:140px;font-size:16px;padding:10px 0;box-sizing:border-box;justify-content: center;}\n.task_pre{width:100%;height:140px;font-size:18px}\n.task_detail{flex-direction: column;}\n.task_name{width:220px;line-height:26px}\n.task_btn_content{width:122px;height:38px;margin:10px auto;color:#fff;font-size:18px;text-align:center;line-height:38px}\n.task_btn_content.opa{opacity:.5}\n\n.flower_content{display:flex;align-items:flex-end;justify-content:center;margin-top:10px;}\n\n.flower_name{margin: 5px auto;}\n\n.flower_progress{margin-top:8px;position:relative;}\n.flower_progress_data{position:absolute;display:flex;width:260px;left:50%;transform:translate(-50%,100%);bottom:-2px;}\n\n.float_flower_progress_bg{width:230px;height:14px;margin:0 auto 4px;position:relative;border-radius:7px; background-repeat:no-repeat;background-position:left center; }\n.float_flower_progress_val{height:14px;position:relative;border-radius:7px;background-repeat:no-repeat;background-position:left center;}\n.float_flower_progress_rate{position:absolute;width:100%;left:50%;top:50%;transform:translate(-50%,-50%);font-size:12px;color:#fff}\n\n.rose_tablist{display:flex;align-items:center;justify-content:center;margin-top:10px;}\n.rose_tablist .float_window_tab_item{width:100px;height:26px;background-position:center center;background-size: 100% 100%;display:flex;align-items:center;justify-content:center;font-size:14px;color:#fff;}\n.rose_content{display:flex;align-items:center;justify-content:center;flex-direction:column;flex:1;}\n.rose_awardlist{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;min-height:134px;}\n.rose_awardlist.num_4{padding:0 50px;}\n.rose_btn{margin-top:4px;width:210px;height:26px;font-size:14px;color:#fff;display:flex;align-items:center;justify-content:center;white-space:nowrap;background-position:center center;background-size: 100% 100%;}</style>')}initBannerList(t,e){uu.isH5ActiveRoom()||window.isYgbShowActive&&(this.cid=t,qt.get(`${Dt}/Activitymanagement/activity?cid=${t}&from=1`).then((t=>{let n=t.data;if(0!=window.$("#act_modal_content").length&&window.$("#act_modal_content").remove(),null==n||0==n.length)return;this.actData=n;window.$("body").append('<div id="act_modal_content">\n                                        <div class="act_modal_icon_content swiper-container swiper-no-swiping">\n                                            <div class="act_modal_close"></div>\n                                            <div class="swiper-wrapper act_modal_icon_list"></div>\n                                        </div>\n                                        <div class="pagination">\n                                            <div class="pagination-button pagination-button-prev"></div>\n                                            <div class="pagination-bullets"></div>\n                                            <div class="pagination-button pagination-button-next"></div>\n                                        </div>\n                                        <div class="float_window_modal"></div>\n                                    </div>'),window.$("body").append('\n                \x3c!-- 女子联赛 --\x3e\n                <div class="act_womenleague"></div>\n                \x3c!-- 女子联赛投票 --\x3e\n                <div class="act_womenleague_vote"></div>\n                \x3c!-- 女子联赛送礼 --\x3e\n                <div class="act_womenleague_gift"></div>\n            '),this.renderActIcon(),e&&e("act_modal_content"),this.initActiveEvents()})))}updateData(t){let e=this.actData.findIndex((e=>e.activityid==t.activityid));-1==e&&0==t.close?this.actData.push(t):-1!=e&&1==t.close?this.actData.splice(e,1):-1!=e&&0==t.close&&this.actData.splice(e,1,t),this.renderActIcon()}renderActIcon(){let t="";for(let a=0;a<this.actData.length;a++)t+=this.renderIcon(this.actData[a]);window.$(".act_modal_icon_list").html(t);try{this.bannerSwiper&&this.bannerSwiper.destroy()}catch(s){}const e={},n={};this.actData.length>0&&(e.el=".pagination .pagination-bullets",e.clickable=!0,this.actData.length>=2?(window.$("#act_modal_content .pagination-button").css("display","block"),n.nextEl=".pagination-button-next",n.prevEl=".pagination-button-prev"):window.$("#act_modal_content .pagination-button").css("display","none"),this.actData.length>5&&(e.dynamicBullets=!0)),this.bannerSwiper=new window.Swiper(".act_modal_icon_content",{autoplay:{delay:3e3,disableOnInteraction:!1},speed:300,loop:1!=this.actData.length,preventClicks:!0,pagination:e,navigation:n});const i=window.$(".swiper_item");let o=this;i.on({mouseenter:function(){o.bannerSwiper&&o.bannerSwiper.autoplay.stop()},mouseleave:function(){o.bannerSwiper&&o.bannerSwiper.autoplay.start()}}),window.$(".act_icon_item").tooltip({align:"top",html:!0})}openNewTab(t){let e="";e="diandiankaihei.com"==window.MAIN_DOMAIN?t.replace("y.tuwan.com","www.diandiankaihei.com"):t,window.open(e)}destroy(){try{this.bannerSwiper&&(this.bannerSwiper.destroy(),this.bannerSwiper=null)}catch(t){}finally{this.bannerSwiper=null}}renderIcon(t){const{activityid:e,pcimg:n,pcsvga:i,pcintroduce:o,act_type:s,pcurl:a,h5_type:r}=t;let c="";return n&&(c=`<div class="swiper-slide swiper_item float_window_flex_c">\n                        <div class="act_icon_item_content" data-id="${e}" data-h5="${r}" data-acttype="${s}" data-pcurl=${a}>\n                            <img class="act_icon_item" src="${n}" title="${Ct.nrTobr(o)}">\n                        </div>\n                    </div>`),c}initSvga(t,e,n){const i=document.querySelectorAll(".svga_item")[n].querySelector(`.svga_${e}`);Zt.getInstance().loadParser(i,t,0,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}filterActData(t){return new Promise(((e,n)=>{let i=this.actData.filter((e=>e.activityid==t));i.length>0?e(i[0]):n()}))}initActiveEvents(){const t=window.$("#act_modal_content");let e=this;window.$(".float_window_modal").on({mouseenter:function(){let t=window.$(this).index(),n=this.dataset.type;n?6==n?(window.$(".float_window_rank_content").html(e.renderCpRankList(t)),window.$(".qjc_rank_name").html("用户")):3==n&&(window.$(".qjc_rank_name").html("厅名称"),window.$(".float_window_rank_content").html(e.renderRankList(t))):0==e.modalData.type?window.$(".float_window_rank_content").html(e.renderCpRankList(t)):1==e.modalData.type?window.$(".float_window_rank_content").html(e.renderRankList(t)):2==e.modalData.type?e.dragonBoatPk(e.itemData,t+1):3==e.modalData.type&&window.$(".float_window_rank_content").html(e.renderDragonList(t))}},".float_window_nav_item"),t.on("click",".suit_arrow_item",(function(){const t=this.dataset.type;e.commonArrow(t),window.$(".suit_detail_content").html(e.renderSuitDetail(e.curIndex))})),t.on("click",".jigsaw_arrow_item",(function(){const t=this.dataset.type;e.commonArrow(t),window.$(".jigsaw_detail_content").html(e.renderJigsawDetail(e.curIndex)),window.$(".jigsaw_detail_title").html(e.textArr[e.curIndex])})),t.on("click",".constellation_arrow_item",(function(){const t=this.dataset.type;e.commonArrow(t),window.$(".suit_detail_content").html(e.renderConstellationGift())})),t.on("click",".collector_arrow_item",(function(){const t=this.dataset.type;e.commonArrow(t),e.renderCollectorTaskDetail(e.curIndex)})),t.on("click",".rose_tablist .float_window_tab_item",(function(){const t=this.dataset.id;window.$(this).addClass("actived").siblings().removeClass("actived"),e.roseGodnessTask(t)})),t.on("click",".share_pic",(function(){qt.get(`${Dt}/activity2023/shareRomanticCard?act_id=${e.actId}&cid=${e.cid}`).then((t=>{}))})),t.on("click",".float_window_jump",(function(){const t=this.dataset.url;e.openNewTab(t)})),t.on("click",".act_modal_close",(function(){window.isYgbShowActive=!1,t.remove()})),t.on("click",".act_icon_item_content",(function(){const t=this.dataset.id,n=this.dataset.h5;if(566!=t)if(2==n){let t=this.dataset.pcurl;const e={url:t,iframeWidth:"375px",iframeHeight:"700px"};(t.indexOf("chorusringrank")>=0||t.indexOf("320Cac68a9")>=0||t.indexOf("391C0908c5")>=0)&&(e.iframeWidth="100%",e.iframeHeight="100%"),t.indexOf("close")>=0&&(e.closeIcon="https://res.tuwan.com/templet/play/chat/v3/images/closeiconv2.png?v=1",e.closeTop="10px",e.closeLeft="338px"),Ct.createIframe(e)}else if(1*t)e.filterActData(t).then((t=>{const{act_type:n,show_webview:i,pcurl:o,act_id:s,activityid:a}=t;1==i?198==a?(window.$(".act_womenleague").toggle(),window.$(".act_womenleague_vote").hide(),window.$(".act_womenleague_gift").hide(),e.womenleague(s)):Ko.getInstance().initAct(s):e.openNewTab(o)}),(t=>{}));else{let t=this.dataset.acttype,n=this.dataset.pcurl;1==t?window.$.fancybox.open([{src:n}],{loop:!1,toolbar:"auto",buttons:["close"],image:{preload:!0},defaultType:"fade",type:"image"}):e.openNewTab(n)}})),t.on({mouseenter:function(){const t=this.dataset.id;e.filterActData(t).then((t=>{window.$(".float_window_modal").html("");const n=t.window_type,i=t.activityid;if(207!==i){if(198!=i)if(297!=i)if(566!=i)if(1103!=i)switch(1*n){case 2:e.picPro(t);break;case 3:e.constellation(t);break;case 4:t.image.background3?e.meterNewTask(t):e.meterTask(t);break;case 6:e.dragonTask(t);break;case 7:let{rank_type:n}=t.extra_params;if(1*n==1)e.commonGroupRank(t);else e.commonSingleRank(t);break;case 8:e.collectTask(t);break;case 9:e.carnivalModal(t);break;case 10:e.dragon(t);break;case 11:e.suitData(t);break;case 13:e.jigsawData(t);break;case 14:e.romanticCard(t);break;case 15:e.constellationGift(t);break;case 16:e.goddessData(t);break;case 17:e.guardAllianceWindow(t);break;case 18:e.flowerData(t);break;case 19:e.dragonBoatPk(t,1);break;case 20:e.collectorTask(t);break;case 21:e.drawAndGuess(t);break;case 22:e.dragonHeroRank(t);break;case 25:e.starMaster(t);break;case 26:e.blindBox(t)}else e.roseGodness(t);else e.wolfgaming(t);else e.musicrank(t)}else e.singrank(t)}),(t=>{}))},mouseleave:function(t){window.$(".float_window_modal").hide(),e.timeID&&(clearInterval(e.timeID),e.timeID=null)}},".act_icon_item_content"),window.$(".float_window_modal").on({mouseenter:function(){window.$(".float_window_modal").show()},mouseleave:function(){window.$(".float_window_modal").hide()}}),window.$(".act_womenleague").on("click",".act_womenleague_vote_btn",(t=>{const e=window.$(t.target);this.womenleaguevote(window.$(e).data("actid"),window.$(e).data("uid"),window.$(e).data("name"),window.$(e).data("mid"))})),window.$(".act_womenleague").on("click",".act_womenleague_gift_btn",(t=>{const e=window.$(t.target);this.womenleaguegift(window.$(e).data("actid"),window.$(e).data("uid"),window.$(e).data("name"),window.$(e).data("mid"))})),window.$(".act_womenleague").on("click",".act_womenleague_close",(t=>{window.$(".act_womenleague").hide(),window.$(".act_womenleague_vote").hide(),window.$(".act_womenleague_gift").hide()})),window.$(".act_womenleague_vote").on("click",".act_womenleague_vote_close",(t=>{window.$(".act_womenleague_vote").hide()})),window.$(".act_womenleague_gift").on("click",".act_womenleague_gift_close",(t=>{window.$(".act_womenleague_gift").hide()})),window.$(".act_womenleague_gift").on("click",".act_womenleague_gift_cancel_btn",(t=>{window.$(".act_womenleague_gift").hide()})),window.$(".act_womenleague_vote").on("click",".act_womenleague_vote_num_btn",(t=>{const e=window.$(t.target);let n=parseInt(window.$(".act_womenleague_vote_input").val());"add"==e.data("type")?n<99999&&n++:n>1&&n--,window.$(".act_womenleague_vote_input").val(n)})),window.$(".act_womenleague_gift").on("click",".act_womenleague_gift_num_btn",(t=>{const e=window.$(t.target);let n=parseInt(window.$(".act_womenleague_gift_input").val());"add"==e.data("type")?n<99999&&n++:n>1&&n--,window.$(".act_womenleague_gift_input").val(n)})),window.$(".act_womenleague_vote").on("mousedown",".act_womenleague_vote_input",(t=>{t.stopPropagation()})),window.$(".act_womenleague_gift").on("mousedown",".act_womenleague_gift_input",(t=>{t.stopPropagation()})),window.$(".act_womenleague_vote").on("input",".act_womenleague_vote_input",(t=>{t.target.value.length>5&&(t.target.value=t.target.value.slice(0,5))})),window.$(".act_womenleague_gift").on("input",".act_womenleague_gift_input",(t=>{t.target.value.length>5&&(t.target.value=t.target.value.slice(0,5))})),window.$(".act_womenleague_gift").on("click",".act_womenleague_gift_num_item",(t=>{const e=window.$(t.target);let n=parseInt(e.data("num"));window.$(".act_womenleague_gift_input").val(n)})),window.$(".act_womenleague_vote").on("click",".act_womenleague_vote_btn",(t=>{const e=window.$(t.target);let n=parseInt(window.$(".act_womenleague_vote_input").val()),i=window.$(e).data("actid"),o=window.$(e).data("mid"),s=window.$(e).data("uid");window.$(e).data("name"),qt.post(Dt+"/Activity2021/leagueVote",{act_id:i,mid:o,uid:s,num:n}).then((t=>{0==t.error_code?(Vt("投票成功"),window.$(".act_womenleague_vote").hide(),this.womenleague(i)):Vt(t.error_msg)}))})),window.$(".act_womenleague_gift").on("click",".act_womenleague_gift_send_btn",(t=>{const e=window.$(t.target);let n=window.$(e).data("giftid"),i=parseInt(window.$(".act_womenleague_gift_input").val()),o=window.$(e).data("uid"),s=window.$(e).data("name");this.sendgift(n,o,s,i)}))}meterNewTask(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/active2020/nationalDayRoom?id=${t.act_id}`).then((o=>{if(0==o.error){let{title:s,rate:a,cp_info:r,room_info:c,mileage_rate:l,have_award:d,need_mileage:m,stage:h,unit:u,maxscore:p,score:g,romantic_card_url:f,user_level:w}=o.data,v="",_="",y="",x="";this.actId=t.act_id;for(let t=0;t<6;t++)v+=`<div class="float_window_flex_c" style="width:36px;height:31px;"><img src="${t<=h-1?n.stage_bright.pic:n.stage_dark.pic}"></div>`;let b={nameStyle:`font-size:${i.nickname.size}px;color:${i.nickname.color}`,scoreStyle:`font-size:${i.score_text.size}px;color:${i.score_text.color}`};x=6==h&&""!=f&&0==d?`<img src="${f}" style="width:223px;height:146px;margin:-10px auto 10px;display:block">\n                                    <img class="share_pic" src="${n.button.pic}" style="width:210px;height:26px;margin:0 auto 6px;display:block">\n                                    <img class="float_window_jump" data-url="${e}" src="${n.upgradation.pic}" style="width:210px;height:26px;margin:0 auto;display:${3!==w?"block":"none"}">`:`<div class="float_window_flex_c">\n                                    ${this.renderHeader(r[0],n.left_avatar_frame.pic,u,e,b)}\n                                    ${this.renderHeader(r[1],n.right_avatar_frame.pic,u,e,b)}\n                                </div>\n                                <div class="float_window_meter_progress_bg"  style="background: url(${n.stage_progress_background.pic}) no-repeat center center;display:${0==d?"block":"none"}">\n                                    <div class="float_window_meter_progress_val" style="width:calc(234px*${l}/100);background: url(${n.stage_progress_cover.pic}) no-repeat center left;"></div>\n                                    <div class="float_window_meter_progress_icon_content float_window_flex_sb" style="width:234px">${v}</div>\n                                </div>\n                                <div style="display:${0==d?"block":"none"};font-size:${i.upgrade_text.size}px;color:${i.upgrade_text.color}">距离升级还需：${m+u}</div>\n                                <img class="float_window_jump" data-url="${e}" style="display:${1==d?"inline":"none"};margin-top:6px" src="${n.button_2.pic}">\n                                <div class="float_window_text_over float_window_cp_cid_info" style="display:${0!==c.cid?"block":"none"};font-size:${i.cp_title.size}px;color:${i.cp_title.color}">\n                                    您的CP正在<a href="${Mt.domain}/chatroom/${c.cid}" style="font-size:${i.room_text.size}px;color:${i.room_text.color}">${c.title} <img src="https://res.tuwan.com/templet/play/2020/2020autumn/chat_gif.gif"></a>\n                                </div>`,_=`${y}\n                        <div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_meter_title" style="font-size:${i.stage_name.size}px;color:${i.stage_name.color}">${s}</div>\n                        ${x}`;let $={html:_,bg:1==w?n.background.pic:2==w?n.background2.pic:n.background3.pic,color:i.main.color,pt:"146px"};this.renderContent($)}}))}meterTask(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/active2020/nationalDayRoom?id=${t.act_id}`).then((t=>{if(0==t.error){const{title:o,rate:s,cp_info:a,room_info:r,mileage_rate:c,have_award:l,need_mileage:d,stage:m,unit:h,maxscore:u,score:p}=t.data;let g="",f="",w="",v=1*u-1*p;for(let t=0;t<6;t++)g+=`<div class="float_window_flex_c"><img class="float_window_common_img" src="${t<=m-1?n.stage_bright.pic:n.stage_dark.pic}"></div>`;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${v}个集齐`;w=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,s,e,t,14)}let _={nameStyle:`font-size:${i.nickname.size}px;color:${i.nickname.color}`,scoreStyle:`font-size:${i.score_text.size}px;color:${i.score_text.color}`};f=`${w}\n                        <div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_meter_title" style="font-size:${i.stage_name.size}px;color:${i.stage_name.color}">${o}</div>\n                        <div class="float_window_flex_c">\n                            ${this.renderHeader(a[0],n.left_avatar_frame.pic,h,e,_)}\n                            ${this.renderHeader(a[1],n.right_avatar_frame.pic,h,e,_)}\n                        </div>\n                        <div class="float_window_meter_progress_bg"  style="background: url(${n.stage_progress_background.pic}) no-repeat center center;display:${0==l?"block":"none"}">\n                            <div class="float_window_meter_progress_val" style="width:calc(220px*${c}/100);background: url(${n.stage_progress_cover.pic}) no-repeat center left;"></div>\n                            <div class="float_window_meter_progress_icon_content float_window_flex_sb">${g}</div>\n                        </div>\n                        <div style="display:${0==l?"block":"none"};font-size:${i.upgrade_text.size}px;color:${i.upgrade_text.color}">距离升级还需：${d+h}</div>\n                        <img class="float_window_jump" data-url="${e}" style="display:${1==l?"inline":"none"};margin-top:6px" src="${n.button_2.pic}">\n                        <div class="float_window_text_over float_window_cp_cid_info" style="display:${0!==r.cid?"block":"none"};font-size:${i.cp_title.size}px;color:${i.cp_title.color}">\n                            您的CP正在<a href="${Mt.domain}/chatroom/${r.cid}" style="font-size:${i.room_text.size}px;color:${i.room_text.color}">${r.title} <img src="https://res.tuwan.com/templet/play/2020/2020autumn/chat_gif.gif"></a>\n                        </div>`;let y={html:f,bg:n.background.pic,color:i.main.color,pt:"138px"};this.renderContent(y)}}))}collectTask(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2021/collectWindow?id=${t.act_id}`).then((t=>{if(0==t.error){const{task:o,max_score:s,score:a,rate:r}=t.data;let c=[],l=[n.button_1.pic,n.button_2.pic,n.button_3.pic];1==o.stage?c=[n.gift_1.pic,n.gift_2.pic,n.gift_3.pic]:2==o.stage?c=[n.gift_1.pic,n.gift_2.pic,n.gift_3.pic,n.gift_4.pic]:3!=o.stage&&4!=o.stage||(c=[n.gift_1.pic,n.gift_2.pic,n.gift_3.pic,n.gift_5.pic]);let d="",m="",h="",u=1*s-1*a;if(o.giftList.forEach(((t,e)=>{d+=`<div class="float_window_collect_task_item" style="font-size:${i.gift_name.size}px;color:${i.gift_name.color};margin:${3==c.length?"20px 9px":(e+1)%2==0?"30px 0 10px":"10px 0"}">\n                                    <img src="${c[e]}" style="opacity:${t.have_num>=t.num?1:.6};">\n                                    <div class="float_window_collect_task_text">${t.have_num}/${t.num}</div>\n                                </div>`})),n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${u}个集齐`;h=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,r,e,t,14)}m=`${h}\n                        <div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_collect_title" style="font-size:${i.stage_name.size}px;color:${i.stage_name.color}">${o.name}</div>\n                        <div class="float_window_collect_task_content float_window_flex">${d}</div>\n                        <img class="float_window_jump" data-url="${e}" src="${l[o.status]}">`;let p={html:m,bg:n.background.pic,color:i.main.color,pt:n.progress_background.pic?"137px":"151px"};this.renderContent(p)}}))}carnivalModal(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity/icesnowroom?id=${t.act_id}`).then((t=>{const{list:o,max_score:s,score:a,rate:r}=t.data;let c="",l=1*s-1*a;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${l}个集齐`;c=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,r,e,t,14)}let d=[n.active_background_1.pic,n.active_background_2.pic,n.active_background_3.pic,n.active_background_4.pic,n.active_background_5.pic];c+=`<div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>`,o.forEach(((t,o)=>{c+=`<a href="${e+(e.indexOf("?")>-1?"&":"?")}type_id=${t.type_id}" target="_blank" style="box-sizing:border-box;padding-top:6px;width:242px;height:47px;margin:3px auto;text-align:center;display:block;background:url(${n.button_background.pic}) center center no-repeat">\n                            <div class="float_window_flex_c" style="height:25px">\n                                <img src="${d[o]}">\n                            </div>\n                            <div style="font-size:${i.button_text.size}px;color:${i.button_text.color};margin-top:-4px">今日有${t.num}个厅举办</div>\n                        </a>`}));let m={html:c,bg:n.background.pic,color:i.main.color,pt:"125px"};this.renderContent(m)}))}constellation(t){const{image:e,text:n}=t;qt.get(`${Dt}/activity2021/zodiacProgressWindow?id=${t.act_id}&cid=${this.cid}`).then((t=>{const{devote:i,devote_progress:o,stage:s}=t.data;let a=0,r="";s<3?(a=i/o[s+1].devote*100,r=this.calcDevote(i)+"/"+this.calcDevote(o[s+1].devote)):(a=100,r="MAX");let c=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,l={html:this.renderProcess(e.progress_background.pic,e.progress_cover.pic,a,r,c,14),bg:[e.background_0.pic,e.background_1.pic,e.background_2.pic,e.background_3.pic][s],color:n.progress_text.color,pt:"130px"};this.renderContent(l)}))}commonSingleRank(t){const{image:e,text:n,extra_params:i,activityid:o}=t;o!=(1==Ct.getQueryString("env")?955:970)?qt.get(`${Dt}/activity/roomWindow?cid=${this.cid}&id=${t.act_id}&stage=${t.extra_params.rank_stage}&type=${t.extra_params.rank_id}`).then((o=>{const{rank_list:s,max_score:a,score:r,rate:c}=o;this.ranklist=s,this.modalData={avatarColor:n.head_frame.color,activedTextColor:n.rank_text.color,activedBg:e.self_background.pic,navBg:e.button_unselect?e.button_unselect.pic:"",navTextColor:n.button_text?n.button_text.color:"",activedNavBg:e.button_select?e.button_select.pic:"",activedNavTextColor:n.button_text?n.button_text.color:"",heart:e.cp_avatar_heart?e.cp_avatar_heart.pic:"",type:6==t.extra_params.rank_id?0:1};let l="",d="",m=1*a-1*r;if(e.progress_background.pic){let t=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,i=`还剩${m}个集齐`;l=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,c,i,t,14)}s.length>1&&(d='<div class="float_window_nav_content float_window_flex_c" style="margin-top:10px">',s.forEach(((t,e)=>{d+=`<div class="float_window_nav_item float_window_flex_c ${0==e?"actived":""}">${t.name}</div>`})),d+="</div>");let h={html:`${l}\n                        <div class="float_window_explain" style="color:${n.main.color}">${n.main.content}</div>\n                        ${d}\n                        <div class="float_window_flex float_window_nav_content" style="margin-top:${s.length>1?"10px":"40px"}">\n                            <div class="float_window_act_rank_index">排名</div>\n                            <div style="margin-left:80px">${3==i.rank_id?"厅名称":"用户"}</div>\n                        </div>\n                        <div class="float_window_rank_content"></div>`,bg:e.background.pic,color:n.main.color,pt:e.progress_background.pic?"140px":"160px"};this.renderContent(h).then((()=>{s.length>1&&window.$(".float_window_nav_item").css({width:"100px",height:"26px",margin:"0 5px"});let e=6==t.extra_params.rank_id?this.renderCpRankList(0,t.extra_params.rank_stage):this.renderRankList(0,t.extra_params.rank_stage);window.$(".float_window_rank_content").html(e)}))})):this.qjcSpecialRank(t)}qjcSpecialRank(t){const{image:e,text:n,extra_params:i}=t;qt.get(`${Dt}/activity/roomWindow?cid=${this.cid}&id=${t.act_id}&stage=${t.extra_params.rank_stage}&type=${t.extra_params.rank_id}`).then((i=>{const{rank_list:o}=i;this.ranklist=o;let s=n.button_text.color.split(",");this.rankIdArr=t.extra_params.rank_id.split(",");let a="";this.modalData={avatarColor:n.head_frame.color,activedTextColor:n.rank_text.color,activedBg:e.self_background.pic,navBg:e.button_unselect?e.button_unselect.pic:"",navTextColor:s[0],activedNavBg:e.button_select?e.button_select.pic:"",activedNavTextColor:s.length>1?s[1]:s[0],heart:e.cp_avatar_heart?e.cp_avatar_heart.pic:"",type:6==this.rankIdArr[0]?0:1},o.length>1&&(a='<div class="float_window_nav_content float_window_flex_c" style="margin-top:10px">',o.forEach(((t,e)=>{a+=`<div data-type="${this.rankIdArr[e]}" class="float_window_nav_item float_window_flex_c ${0==e?"actived":""}">${t.name}</div>`})),a+="</div>");let r={html:`<div class="float_window_explain" style="color:${n.main.color}">${n.main.content}</div>\n                        ${a}\n                        <div class="float_window_flex float_window_nav_content" style="margin-top:${o.length>1?"10px":"40px"}">\n                            <div class="float_window_act_rank_index">排名</div>\n                            <div style="margin-left:80px" class="qjc_rank_name">${3==this.rankIdArr[0]?"厅名称":"用户"}</div>\n                        </div>\n                        <div class="float_window_rank_content"></div>`,bg:e.background.pic,color:n.main.color,pt:e.progress_background.pic?"140px":"160px"};this.renderContent(r).then((()=>{o.length>1&&window.$(".float_window_nav_item").css({width:"100px",height:"26px",margin:"0 5px"});let t=6==this.rankIdArr[0]?this.renderCpRankList(0):this.renderRankList(0);window.$(".float_window_rank_content").html(t)}))}))}commonGroupRank(t){const{image:e,text:n,extra_params:i}=t;qt.get(`${Dt}/activity/groupWindow?cid=${this.cid}&id=${t.act_id}&stage=${t.extra_params.rank_stage}&type=${t.extra_params.rank_id}`).then((o=>{const{rank_list:s}=o;this.ranklist=s,this.modalData={avatarColor:n.head_frame.color,activedTextColor:n.rank_text.color,activedBg:e.self_background.pic,navBg:e.button_unselect.pic,navTextColor:n.button_text.color,activedNavBg:e.button_select.pic,activedNavTextColor:n.button_text.color,heart:e.cp_avatar_heart?e.cp_avatar_heart.pic:"",type:6==t.extra_params.rank_id?0:1};let a=`<div class="float_window_explain" style="color:${n.main.color}">${n.main.content}</div>\n                        <div class="float_window_nav_content float_window_flex_c" style="margin-top:10px">`;s.forEach(((t,e)=>{a+=`<div class="float_window_nav_item float_window_flex_c ${0==e?"actived":""}">${t.name}</div>`})),a+=`</div><div class="float_window_flex float_window_nav_content" style="margin-top:10px">\n                        <div class="float_window_act_rank_index">排名</div>\n                        <div style="margin-left:80px">${3==i.rank_id?"厅名称":"用户"}</div>\n                    </div>\n                    <div class="float_window_rank_content"></div>`;let r={html:a,bg:e.background.pic,color:n.main.color,pt:e.progress_background.pic?"140px":"160px"};this.renderContent(r).then((()=>{window.$(".float_window_nav_item").css({width:"77px",height:"24px",margin:"0 5px"});let e=6==t.extra_params.rank_id?this.renderCpRankList(0,t.extra_params.rank_stage):this.renderRankList(0,t.extra_params.rank_stage);window.$(".float_window_rank_content").html(e)}))}))}dragonTask(t){const{image:e,text:n}=t;qt.get(`${Dt}/activity.window.dragon/dragonSoul?act_id=${t.act_id}&cid=${this.cid}`).then((t=>{const{rate:i,stage:o,now_blood:s,surplus_blood:a,now_blood_text:r,mvp_list:c,mvp_title:l,group_name:d,room_list:m,room_title:h,unit:u}=t.data;let p=[{list:m,unit:u},{list:c,unit:u}];this.ranklist=p,this.modalData={avatarColor:n.head_frame.color,activedTextColor:n.rank_text.color,activedBg:e.self_background.pic,navBg:e.button_unselect?e.button_unselect.pic:"",navTextColor:n.button_text?n.button_text.color:"",activedNavBg:e.button_select?e.button_select.pic:"",activedNavTextColor:n.button_text?n.button_text.color:"",type:3};let g="",f=`剩余${a<1e4?a:this.upFixed(a/1e4,2)}${u}`,w=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,v=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,i,f,w,20),_=[h,l];g=`${v}\n                    <div class="float_window_explain" style="margin-top:15px;color:${n.main.color};font-size:${n.main.size}px">${n.main.content.replace("xx",o).replace("yy",d)}</div>\n                    <div class="float_window_nav_content float_window_flex_c" style="margin-top:10px">`,_.forEach(((t,e)=>{g+=`<div class="float_window_nav_item float_window_flex_c ${0==e?"actived":""}">${t}</div>`})),g+='</div>\n                    <div class="float_window_flex float_window_nav_content" style="margin-top:10px">\n                        <div class="float_window_act_rank_index">排名</div>\n                        <div class="float_window_act_rank_title" style="margin-left:80px">厅名称</div>\n                    </div>\n                    <div class="float_window_rank_content"></div>';let y={html:g,bg:e.background.pic,color:n.main.color,pt:"124px"};this.renderContent(y).then((()=>{window.$(".float_window_nav_item").css({width:"100px",height:"24px",margin:"0 5px"});let t=this.renderDragonList(0);window.$(".float_window_rank_content").html(t)}))}))}dragon(t){const{image:e,text:n}=t;qt.get(Dt+`/activity.window.dragon/slayDragon?cid=${this.cid}&act_id=${t.act_id}`).then((t=>{const{killed_num:i,max_num:o,big_dragon_show:s,now_time:a,escape_time:r,big_dragon_blood:c,killed_blood:l,gift_num:d,gift_max_num:m}=t.data;let h="",u="",p="",g="";if(e.progress_background.pic){let t=`font-size:${n.gift_progress_text.size}px;color:${n.gift_progress_text.color}`,a=`${d}个/${m}个`,r=0==s?`${i}条/${o}条`:`${l}血量/${c}血量`,h=d/m*100,g=0==s?i/o*100:(c-l)/c*100;u=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,h,a,t,20),p=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,g,r,t,20)}if(1==s){let t=n.big_dragon_time_text.content.replace("xx",'<span class="dragon_time"></span>');g=`<div class="float_window_explain" style="margin:10px auto 110px;color:${n.big_dragon_time_text.color};font-size:${n.big_dragon_time_text.size}px;">${t}</div>`}else g=`<div class="float_window_explain" style="margin:10px auto 110px;color:${n.big_dragon_text.color};font-size:${n.big_dragon_text.size}px;">${n.big_dragon_text.content}</div>`;h+=`${u}\n                    <div class="float_window_explain" style="margin:10px auto 110px;color:${n.small_dragon_text.color};font-size:${n.small_dragon_text.size}px;">${n.small_dragon_text.content}</div>\n                    ${p}\n                    ${g}\n                    `;let f={html:h,bg:e.background.pic,pt:"185px"};this.renderContent(f).then((()=>{1==s&&this.countDown(a,r)}))}))}countDown(t,e,n=!1){const i=this;let o=e-t,s=Math.floor(o/3600)<10?"0"+Math.floor(o/3600):Math.floor(o/3600),a=Math.floor(o/60%60)<10?"0"+Math.floor(o/60%60):Math.floor(o/60%60),r=Math.floor(o%60)<10?"0"+Math.floor(o%60):Math.floor(o%60),c=n?s+":":"";window.$(".dragon_time").html(`${c}${a}:${r}`),t++,this.timeID=setInterval((function(){let o=e-t;if(o>=0){let e=Math.floor(o/3600)<10?"0"+Math.floor(o/3600):Math.floor(o/3600),i=Math.floor(o/60%60)<10?"0"+Math.floor(o/60%60):Math.floor(o/60%60),s=Math.floor(o%60)<10?"0"+Math.floor(o%60):Math.floor(o%60),a=n?e+":":"";window.$(".dragon_time").html(`${a}${i}:${s}`),t++}else clearInterval(i.timeID)}),1e3)}suitData(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2022/colorEggWindow?id=${t.act_id}`).then((t=>{const{max_score:o,score:s,rate:a}=t.data.animation,{finish_num:r,is_finish:c,level:l,list:d,name:m,pic:h,pic2:u}=t.data.task_info;this.images=n,this.list=d,this.curIndex=0,this.jumpUrl=e;let p="",g="",f=1*o-1*s;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${f}个集齐`;p=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,a,e,t,14)}i.main.content&&(g=`<div class="float_window_explain" style="color:${i.main.color};font-size:${i.main.size}px">${i.main.content}</div>`);let w={html:`${p}\n                        ${g}\n                        <div class="float_window_meter_title" style="margin:25px auto 10px" style="color:${i.button_text.color}">${i.button_text.content.replace("xx",m)}</div>\n                        <img src="${1==c?u:h}" class="suit_egg_pic">\n                        <div class="suit_content float_window_flex_c">\n                            <img class="suit_arrow_item" data-type="left" src="${n.arrow_pic.pic}">\n                            <div class="suit_detail_content float_window_flex_c" style="background:url(${n.award_background.pic})"></div>\n                            <img class="suit_arrow_item" data-type="right" src="${n.arrow_right_pic.pic}">\n                        </div>`,bg:n.background.pic,color:i.main.color,pt:"123px"};this.renderContent(w).then((()=>{window.$(".suit_detail_content").html(this.renderSuitDetail(0))}))}))}picPro(t){const{image:e,text:n,extra_params:i}=t;qt.get(`${Dt}/activity/roomWindow?cid=${this.cid}&id=${t.act_id}`).then((t=>{const{max_score:i,score:o,rate:s}=t;let a="",r=1*i-1*o;if(e.progress_background.pic){let t=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,i=`还剩${r}个集齐`;a=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,s,i,t,14)}let c={html:a,bg:e.background.pic,color:n.main.color,pt:"164px"};this.renderContent(c)}))}romanticCard(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2023/romanticCard?act_id=${t.act_id}`).then((t=>{const{card_id:o,card_name:s,card_num:a,romantic_value:r,total_romantic_value:c,cp_info:l,award_list:d,status:m}=t.data;this.images=n;let h="",u=r/c*100;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`${r}/${c}浪漫值`;h=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,u,e,t,14)}let p=n[`card_background${o}`].pic,g={nameStyle:`font-size:${i.nickname.size}px;color:${i.nickname.color}`,scoreStyle:"display:none"},f=`<div class="romantic_card_gift_content float_window_flex_c" style="font-size:${i.award_text.size}px;color:${i.award_text.color}">\n                             <div style="writing-mode: vertical-rl;letter-spacing: 6px;">奖励</div>`;d.forEach(((t,e)=>{f+=`<div class="romantic_card_gift_item">\n                                    <div class="romantic_card_gift_img float_window_flex_c" style="background: url(${n.gift_bg.pic});">\n                                        <img class="float_window_common_img" src="${t.pic}">\n                                    </div>\n                                    <div>${t.title}</div>\n                                </div>\n                                `})),f+="</div>";let w={html:`\n                        <div class="float_window_explain" style="color:${i.main.color};height: 20px">${i.main.content.replace("xx",s).replace("yy",a)}</div>\n                        <div class="romantic_card_content" style="background: url(${p});">\n                             <div class="float_window_flex_c" style="margin-bottom:10px">\n                                ${this.renderHeader(l[0].user_info,n.avatar_border.pic,"",e,g)}\n                                <img class="romantic_heart" src="${n.heart.pic}">\n                                ${this.renderHeader(l[1].user_info,n.avatar_border.pic,"",e,g)}\n                            </div>\n                            ${h}\n                        </div>\n                        ${f}\n                        <img src="${n[`button_${m}`].pic}" class="float_window_jump" data-url="${e}"> \n                        `,bg:n.background.pic,color:i.main.color,pt:"104px"};this.renderContent(w)}))}jigsawData(t){const{pcurl:e,image:n,text:i,extra_params:o}=t;qt.get(`${Dt}/activity/newYear2023?act_id=${t.act_id}`).then((t=>{const{max_score:o,score:s,rate:a,task_list:r}=t.data;this.images=n,this.curIndex=0,this.list=r,this.textArr=i.progress_text.content.split("，");let c="",l=1*o-1*s;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${l}个集齐`;c=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,a,e,t,14)}let d={html:`${c}\n                        <div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_collect_title jigsaw_detail_title" style="font-size:16px;color:#ffef99">${this.textArr[0]}</div>\n                        <div class="jigsaw_content float_window_flex_c">\n                            <img class="jigsaw_arrow_item" data-type="left" src="${n.left_arrow.pic}">\n                            <div class="jigsaw_detail_content float_window_flex_c" style="position: relative;width:230px;height:140px;"></div>\n                            <img class="jigsaw_arrow_item" data-type="right" src="${n.right_arrow.pic}">\n                        </div>\n                        <img src="${n.button_pic.pic}" class="float_window_jump" data-url="${e}"> \n                        `,bg:n.background.pic,color:i.main.color,pt:"154px"};this.renderContent(d).then((()=>{window.$(".jigsaw_detail_content").html(this.renderJigsawDetail(0))}))}))}renderJigsawDetail(t){let e=this.list[t],n="",i=[{left:"0px",top:"10px"},{left:"40px",top:"70px"},{left:"94px",top:"10px"},{left:"140px",top:"70px"}];for(let o=0,s=e.length;o<s;o++){let t=e[o];n+=`<div style="position:absolute;width:100px;left:${i[o].left};top:${i[o].top}">\n                        <div class="float_window_flex_c" style="align-items: flex-end;">\n                             <img src="${0==t.status?this.images.piece_pic.pic:this.images.piece_pic_s.pic}">\n                             <div style="color:#ffe59a;font-size:12px">x${t.piece_num}</div>\n                        </div>\n                        <div style="font-size: 12px;">${t.desc}</div>\n                    </div>`}return n}renderSuitDetail(t){let e=this.list[t],n="";return 0==e.status?n=this.images.button_1.pic:1==e.status?n=this.images.button_2.pic:2==e.status&&(n=this.images.button_3.pic),` <div style="width:80px">\n                        <div class="float_window_flex_c" style="width:60px;height:60px;margin:0 auto;background:url(${this.images.award_frame.pic})">\n                            <img src="${e.award[0].pic}" style="max-width:60%;max-height:60%">\n                        </div>\n                        <div class="text_over" title="${e.award[0].title}">${e.award[0].title}</div>\n                    </div>\n                    <div style="width:100px">\n                        <div class="float_window_flex_c" style="height:40px;margin-top:4px;">${e.config.title}</div>\n                        <img src="${n}" class="float_window_jump" data-url="${this.jumpUrl}">\n                    </div>`}constellationGift(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2023/constellationCollect?act_id=${t.act_id}`).then((t=>{let{current_stage:o,stage_list:s}=t.data;this.images=n,this.list=s,this.curIndex=o-1,this.curItem=s[o-1],this.text=i,this.stageArr=["宝宝","公主","女王"];let a={html:`<div class="float_window_flex_c">\n                            <img class="constellation_arrow_item" data-type="left" src="${n.arrow_left.pic}">\n                            <div class="constellation_title" style="font-weight:bold;margin:0 20px;color:${i.main.color};font-size:${i.main.size}px;"></div>\n                            <img class="constellation_arrow_item" data-type="right" src="${n.arrow_right.pic}">\n                        </div>\n                        <div class="constellation_desc" style="margin-top:4px;color:${i.constellation_name.color};font-size:${i.constellation_name.size}px;"></div>\n                        <div class="constellation_content"></div>\n                        <div class="take_content" style="background: url(${n.mask_bg.pic});">\n                            <img class="float_window_jump" style="margin-top: 130px" data-url="${e}" src="${n.button_2.pic}">\n                        </div>`,bg:n[`bg_${o}`].pic,color:i.main.color,pt:"120px"};this.renderContent(a).then((()=>{this.renderConstellationGift()}))}))}renderConstellationGift(){this.curItem=this.list[this.curIndex];let t=this.curItem.collect_list;window.$(".constellation_title").html(this.text.main.content.replace("xx",this.stageArr[this.curIndex])),window.$(".constellation_desc").html(this.text.constellation_name.content.replace("xx",this.stageArr[this.curIndex]));let e="";t.forEach(((t,n)=>{e+=`<img src="${this.images[`icon_${t}`].pic}">`})),2==this.curItem.status?window.$(".take_content").show():window.$(".take_content").hide(),window.$(".constellation_content").html(e),window.$(".float_window_modal").css({"background-image":`url(${this.images[`bg_${this.curIndex+1}`].pic})`})}goddessData(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2023/goddessWindow?act_id=${t.act_id}`).then((t=>{let{max_score:o,score:s,rate:a,current_stage:r,my_num:c,task_list:l}=t.data;this.images=n;let d="",m=1*o-1*s;if(n.progress_background.pic){let t=`font-size:${i.progress_text.size}px;color:${i.progress_text.color}`,e=`还剩${m}个集齐`;d=this.renderProcess(n.progress_background.pic,n.progress_cover.pic,a,e,t,14)}const h=l.some((t=>1==t.status)),u=l.filter(((t,e)=>t.stage==r))[0];let p="";u.award.forEach(((t,e)=>{p+=`\n                        <div class="goddess_gift_item">\n                            <div class="goddess_gift_img float_window_flex_c" style="background: url(${n.gift_bg.pic});">\n                                <img class="float_window_common_img" src="${t.pic}">\n                            </div>\n                            <div style="font-size:${i.award_text.size}px;color:${i.award_text.color};">${t.title}</div>\n                        </div>`}));let g=0;l.slice(0,r).forEach(((t,e)=>{g+=1*t.num}));let f=1*c/g*100,w={html:`${d}\n                        <div class="float_window_explain" style="margin-top:10px;color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_collect_title jigsaw_detail_title" style="font-size:${i.stage_name.size}px;color:${i.stage_name.color};margin-top:10px">${u.name}</div>\n                        <div class="goddess_gift_content float_window_flex_c" style="align-items: flex-start;">\n                            ${p}\n                        </div>\n                        <div class="goddess_progress_bg" style="background: url(${n.stage_progress_background.pic});">\n                            <img src="${n.icon.pic}" class="goddess_star" style="left:calc(198px*${f}/100)" alt="">\n                            <div class="goddess_progress_val" style="width:calc(198px*${f}/100);background: url(${n.stage_progress_cover.pic});"></div>\n                        </div>\n                        <div>当前星光值：${c}</div>\n                        <img src="${h?n.take.pic:n.will_take.pic}" class="float_window_jump" data-url="${e}"> \n                        `,bg:n.background.pic,color:i.main.color,pt:"140px"};this.renderContent(w)}))}guardAllianceWindow(t){const{image:e,text:n}=t;qt.get(`${Dt}/activity2023/guardAllianceWindow?act_id=${t.act_id}&cid=${this.cid}`).then((i=>{let{rank_list:o,hp_progress:s,self_data:a}=i.data;this.itemData=t,this.images=e;let r="",c="";if(e.progress_background.pic){let t=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,i=s+"%",o=0==s?"已完成":n.progress_text.content.replace("xx",i);r=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,s,o,t,16)}o.forEach(((t,i)=>{c+=`<div class="float_window_flex guard_rank_item" style="font-size:${n.rank_text.size}px;color:${n.rank_text.color}">\n                                <div class="guard_rank_index">${i+1}</div>\n                                <div class="float_window_flex guard_rank_info_content">\n                                    <div class="guard_rank_avatar_content float_window_flex_c">\n                                        <img src="${e.header.pic}" class="guard_rank_avatar_border" alt="">\n                                        <img src="${t.user_info.avatar}" class="guard_rank_avatar" alt="">\n                                    </div>\n                                    <div>\n                                         <div>${t.user_info.nickname}</div>\n                                         <div>${n.rank_text.content}：${t.score}</div>\n                                    </div>\n                                </div>\n                            </div>`}));let l={html:`<div style="color:${n.main.color};font-size:${n.main.size}px;font-weight: bold;margin-bottom: 10px">${n.main.content}</div>\n                        ${r}\n                        <img src="${e.title.pic}" alt="" style="margin:20px auto 4px">\n                        <div style="height: 180px">${c}</div>\n                        <div class="float_window_flex guard_rank_item" style="font-size:${n.rank_text.size}px;color:${n.rank_text.color}">\n                            <div class="guard_rank_index">我的</div>\n                            <div class="float_window_flex guard_rank_info_content">\n                                <div class="guard_rank_avatar_content float_window_flex_c">\n                                    <img src="${e.header.pic}" class="guard_rank_avatar_border" alt="">\n                                    <img src="${a.user_info.avatar}" class="guard_rank_avatar" alt="">\n                                </div>\n                                <div>\n                                    <div>${a.user_info.nickname}</div>\n                                    <div>${n.rank_text.content}：${a.score}</div>\n                                </div>\n                            </div>\n                        </div>\n                        `,bg:e.background.pic,color:n.rank_text.color,pt:"106px"};this.renderContent(l)}))}dragonBoatPk(t,e){const{pcurl:n,image:i,text:o}=t;qt.get(`${Dt}/activity2023/getDragonBoatCampData?act_id=${t.act_id}&cid=${this.cid}&group_id=${e}`).then((s=>{let{sweet_num:a,salt_num:r}=s.data;this.images=i,this.itemData=t,this.modalData={navBg:i.tab.pic,navTextColor:"#fff",activedNavBg:i.tab_s.pic,activedNavTextColor:"#fff",type:2};let c="",l=a/(a+r);l=0==a&&0==r?.5:l,l=l>1?1:l,[{name:"端游组",id:1},{name:"手游组",id:2},{name:"娱乐/狼人杀",id:3}].forEach(((t,n)=>{c+=`<div class="float_window_nav_item float_window_flex_c ${t.id==e?"actived":""}">${t.name}</div>`}));let d={html:`<div style="color:${o.main.color};font-size:${o.main.size}px;font-weight: bold;">${o.main.content}</div>\n                        <div class="float_window_nav_content float_window_flex_c" style="margin-top:4px">${c}</div>\n                        <div class="float_window_flex_c">\n                            <div>\n                                <div>甜粽阵营</div>\n                                <img src="${i.icon_1.pic}" style="opacity:${a>r?1:.5}">\n                            </div>\n                            <img src="${i.vs.pic}" style="margin:10px -4px 0">\n                            <div>\n                                <div>咸粽阵营</div>\n                                <img src="${i.icon_2.pic}" style="opacity:${a<r?1:.5}">\n                            </div>\n                        </div>\n                        <div style="position:relative;width:240px;height:14px;margin:14px auto 24px;">\n                            <img style="position:absolute;left:${100*l}%;transform:translateX(-31%);top:-20px" src="${i.pro_icon.pic}">\n                            <div style="position:absolute;left:0;top:0;z-index:1;width:${240*l}px;height:14px;background:url(${i.pro_1.pic})"></div>\n                            <div style="position:absolute;right:0;top:0;width:240px;height:14px;background:url(${i.pro_2.pic})"></div>\n                            <div style="position:absolute;left:0;top:20px">甜度：${a}</div>\n                            <div style="position:absolute;right:0;top:20px">咸度：${r}</div>\n                        </div>\n                        <img class="float_window_jump" data-url="${n}&group_id=${e}" src="${i.btn.pic}">`,bg:i.background.pic,color:o.main.color,pt:"150px"};this.renderContent(d).then((()=>{window.$(".float_window_nav_item").css({width:"84px",height:"26px",margin:"0 5px",letterSpacing:"-1px"}),this.resetNav(e-1)}))}))}collectorTask(t){const{pcurl:e,image:n,text:i}=t;qt.get(`${Dt}/activity2023/giftCollectorWindow?act_id=${t.act_id}&cid=${this.cid}`).then((t=>{const{level:o,list:s}=t.data;this.images=n,this.curIndex=0,this.list=s,this.jumpUrl=e;let a="";if(o>0){let t=s.findIndex((t=>2==t.status)),e=s.findIndex((t=>1==t.status));this.curIndex=-1==t?-1==e?s.length-1:e:t,a=`<div class="collector_title_content float_window_flex_c">\n                                <img class="collector_arrow_item" data-type="left" src="${n.left_arrow.pic}">\n                                <div style="margin:0 20px">\n                                    <div class="float_window_explain" style="color:${i.main.color};height:unset;margin-top:16px;">${i.main.content}</div>\n                                </div>\n                                <img class="collector_arrow_item" data-type="right" src="${n.right_arrow.pic}">\n                            </div>\n                            <div class="collector_content"></div>`}else a=`<div class="float_window_jump ygb_cursor" data-url="${e}" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>`;let r={html:a,bg:0==o?n.select_task.pic:n.background.pic,color:i.main.color,pt:"118px"};this.renderContent(r).then((()=>{o>0&&this.renderCollectorTaskDetail(this.curIndex)}))}))}renderCollectorTaskDetail(t){let{collect_list:e,award_list:n,status:i}=this.list[t],o="",s="";e.forEach((t=>{let e="";e=1==t.up_status?`<div>收集${t.receive_num}/${t.num}</div>`:`<div>${this.dateFormat(t.up_time)}上线</div>`,o+=`<div style="background: url(${this.images[`level_${t.gift_grade}`].pic});width:82px;height:107px;text-align:center;margin:0 5px;color:#e8f6fe;font-size:12px;opacity:${t.receive_num>=t.num?1:.5}">\n                            <img src="${t.pic}" style="margin-top:10px;width:58px;height:58px;">\n                            <div style="width:100%" class="float_window_text_over">${t.simple_title}</div>\n                            ${e}\n                        </div>`})),n.forEach(((t,e)=>{let n="";n=t.pic.endsWith("svga")?`<div class="float_window_common_gift_svga float_window_common_img collector_svga_${e}"></div>`:`<img src="${t.pic}" class="float_window_common_img">`,s+=`<div style="width:75px;font-size:12px;">\n                            <div style="background: url(${this.images.gift_bg.pic});width:65px;height:67px;margin:0 5px;" class="float_window_flex_c">\n                                ${n}\n                            </div>\n                            <div style="width:100%;margin-top:2px;" class="float_window_text_over">${t.simple_title}</div>\n                            <div style="width:100%;" class="float_window_text_over">${"devote"==t.type?"":"*"}${t.num}${t.unit}</div>\n                        </div>`}));let a=["will_take","take","taked"],r="";r=-1==this.list.findIndex((t=>1==t.status||2==t.status))?"upgrade":a[i-1];let c=`<div class="float_window_flex_c" style="margin-top:8px">${o}</div>\n                    <div class="float_window_flex_c" style="margin-top:32px;">${s}</div>\n                    <img src="${this.images[`${r}`].pic}" class="float_window_jump" data-url="${this.jumpUrl}">`;window.$(".collector_content").html(c),n.forEach(((t,e)=>{t.pic.endsWith("svga")&&Zt.getInstance().loadParser(`.collector_svga_${e}`,t.pic,0,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}))}dateFormat(t){let e=new Date(1e3*t);var n={};return n.M=e.getMonth()+1,n.D=e.getDate(),`${n.M}月${n.D}日`}drawAndGuess(t){const{image:e,text:n,extra_params:i}=t;qt.get(`${Dt}/activity2023/drawAndGuessWindow?cid=${this.cid}&act_id=${t.act_id}`).then((t=>{const{max_score:i,score:o,award_list:s}=t.data;let a="",r="",c=o/i*100;if(c=c>100?100:c,e.progress_background.pic){let t="font-size:12px;color:#fff",n=`${c}%`;a=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,c,n,t,14)}s.forEach(((t,n)=>{let i="";i=t.pic.endsWith("svga")?`<div class="float_window_common_gift_svga float_window_common_img collector_svga_${n}"></div>`:`<img src="${t.pic}" class="float_window_common_img">`,r+=`<div style="background: url(${e.gift_bg.pic});width:111px;height:136px;margin:0 5px;font-size:12px;">\n                                <div style="background: url(${e.icon_bg.pic});width:72px;height:72px;margin:10px auto" class="float_window_flex_c">\n                                    ${i}\n                                </div>\n                                <div style="width:100%;" class="float_window_text_over">${t.simple_title}</div>\n                                <div style="width:100%;" class="float_window_text_over">${"devote"==t.type?"":"*"}${t.num}${t.unit}</div>\n                            </div>`}));let l={html:`\n                        <div class="float_window_explain" style="margin-top:10px;margin-bottom:10px;height:unset;font-size:${n.main.size}px">${n.main.content}</div>\n                        ${a}\n                        <div style="margin-top:40px;font-size:${n.main.size}px;margin-bottom:4px;">${i}积分奖励</div>\n                        <div class="float_window_flex_c">${r}</div>\n                        \n                      `,bg:e.background.pic,color:n.main.color,pt:"164px"};this.renderContent(l).then((()=>{s.forEach(((t,e)=>{t.pic.endsWith("svga")&&Zt.getInstance().loadParser(`.collector_svga_${e}`,t.pic,0,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}))}))}))}blindBox(t){const{image:e,text:n,extra_params:i,pcurl:o}=t;qt.get(`${Pt}/activity.platform.blindbox/getprocessdata?cid=${this.cid}&specify_act_id=${t.act_id}&format=json`,"json").then((t=>{const i=t.data.backgrounds;let s="",a="";i.forEach(((t,e)=>{let n="";n=1==t.special?"width:275px;height:74px;margin-bottom:2px;":"width:84px;height:60px;margin:0 2px 5px;",s+=`<img style="opacity:${0==t.get?.6:1};${n}border-radius:5px;" src='${t.popup_background}'">`})),t.data.have_award_to_get&&(a=`<div class="float_window_jump float_window_flex_c" data-url="${o}" style="position:absolute;bottom:5px;left:8px;z-index:10;background: url(${e.bottom.pic});width:296px;height:55px;box-sizing:border-box;padding:0 70px 0 10px;text-align:left">\n                            ${t.data.tips}\n                        </div>`);let r={html:`\n                        <div class="float_window_explain float_window_jump" data-url="${o}" style="margin-top:5px;height:unset;font-size:${n.main.size}px">${n.main.content}</div>\n                        <img class="float_window_jump ygb_cursor" data-url="${o}" src='${e.btn.pic}' style="margin-bottom:25px;">\n                        <div class="float_window_flex_c float_window_jump" data-url="${o}" style="flex-wrap:wrap">${s}</div>\n                        ${a}\n                      `,bg:e.background.pic,color:n.main.color,pt:"110px"};this.renderContent(r)}))}renderContent(t){return new Promise(((e,n)=>{window.$(".float_window_modal").html(t.html),window.$(".float_window_modal").css({"background-image":`url(${t.bg})`,color:t.color,"padding-top":t.pt}),window.$(".float_window_modal").show(),e()}))}renderProcess(t,e,n,i,o,s){return`<div class="float_window_progress_bg" style="background: url(${t});height:${s}px">\n                    <div class="float_window_progress_val" style="width:calc(240px*${n}/100);background: url(${e});height:${s}px;border-radius:${s/2}px"></div>\n                    <div class="float_window_progress_rate" style="${o};height:${s}px;line-height:${s}px">${i}</div>\n                </div>`}renderHeader(t,e,n,i,o){return`<div class="float_window_user_info">\n                    <div class="float_window_jump float_window_flex_c float_window_cp_header_content" data-url="${i}">\n                        <img class="float_window_cp_header_border" src="${e}">\n                        <img class="float_window_cp_header_avatar" src="${t.avatar}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n                    </div>\n                    <div class="float_window_cp_name float_window_text_over" style="${o.nameStyle}">${t.nickname?t.nickname:"虚位以待"}</div>\n                    <div class="float_window_cp_score float_window_text_over" style="${o.scoreStyle}">${t.score+n}</div>\n                </div>`}resetNav(t){window.$(".float_window_nav_item").removeClass("actived"),window.$(".float_window_nav_item").eq(t).addClass("actived"),window.$(".float_window_nav_item").css({"background-image":`url(${this.modalData.navBg})`,color:this.modalData.navTextColor}),window.$(".float_window_nav_item.actived").css({"background-image":`url(${this.modalData.activedNavBg})`,color:this.modalData.activedNavTextColor})}renderCpRankList(t,e){let n="",i=t;e>1&&(i=e-2),this.resetNav(i);const o=this.ranklist[t].unit;return this.ranklist[t].list.forEach((t=>{const e=1==t.is_ower?`background:url(${this.modalData.activedBg});color:${this.modalData.activedTextColor}`:"";n+=`<div class="float_window_act_rank_item float_window_flex" style="${e}">\n                        <div class="float_window_act_rank_index">${t.order}</div>\n                        <div class="float_window_act_cp_header flex">\n                            <img class="float_window_act_cp_header_item" style="border:2px solid ${this.modalData.avatarColor}" src="${t.avatar}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n                            <img class="float_window_act_cp_heart" src="${this.modalData.heart}">\n                            <img class="float_window_act_cp_header_item" style="border:2px solid ${this.modalData.avatarColor}" src="${t.savatar}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n                        </div>\n                        <div>\n                            <div class="float_window_act_cp_name_content flex" title="${t.nickname}♥${t.snickname}">\n                                <div class="float_window_act_cp_name_item float_window_text_over">${t.nickname}</div>\n                                <div style="color:${this.modalData.heartColor}">♥</div>\n                                <div class=" ommon_act_cp_name_item float_window_text_over">${t.snickname?t.snickname:"虚位以待"}</div>\n                            </div>\n                            <div>${o}:${this.calcDevote(t.devote)}</div>\n                        </div>\n                    </div>`})),n}renderRankList(t,e){let n="",i=t;e>1&&(i=e-2),this.resetNav(i);const o=this.ranklist[t].unit;return this.ranklist[t].list[0]&&this.ranklist[t].list[0].uid>0?window.$(".float_window_act_rank_title").html("用户昵称"):this.ranklist[t].list[0]&&!this.ranklist[t].list[0].uid?window.$(".float_window_act_rank_title").html("厅名"):window.$(".float_window_act_rank_title").html("用户昵称"),this.ranklist[t].list.forEach((t=>{const e=1==t.is_ower?`background:url(${this.modalData.activedBg});color:${this.modalData.activedTextColor}`:"";let i="",s="";i=t.uid>0?t.avatar:t.img,s=t.uid>0?t.nickname:t.title,n+=`<div class="float_window_act_rank_item float_window_flex" style="${e}">\n                    <div class="float_window_act_rank_index">${t.order}</div>\n                    <img class="float_window_act_cp_header_item" style="border:2px solid ${this.modalData.avatarColor};margin:0 10px 0 20px" src="${i}">\n                    <div>\n                        <div class="float_window_act_cp_name_content" title="${s}">${s}</div>\n                        <div>${o}:${this.calcDevote(t.devote)}</div>\n                    </div>\n                </div>`})),n}renderDragonList(t,e){let n="",i=t;e>1&&(i=e-2),this.resetNav(i);const o=this.ranklist[t].unit;return this.ranklist[t].list[0]&&this.ranklist[t].list[0].uid>0?window.$(".float_window_act_rank_title").html("用户昵称"):this.ranklist[t].list[0]&&!this.ranklist[t].list[0].uid?window.$(".float_window_act_rank_title").html("厅名"):window.$(".float_window_act_rank_title").html("用户昵称"),this.ranklist[t].list.forEach((t=>{const e=1==t.is_ower?`background:url(${this.modalData.activedBg});color:${this.modalData.activedTextColor}`:"";let i="",s="";i=t.user_info?t.user_info.avatar:t.room_info.pic,s=t.user_info?t.user_info.nickname:t.room_info.title,n+=`<div class="float_window_act_rank_item float_window_flex" style="${e}">\n                    <div class="float_window_act_rank_index">${t.rank}</div>\n                    <img class="float_window_act_cp_header_item" style="border:2px solid ${this.modalData.avatarColor};margin:0 10px 0 20px" src="${i}">\n                    <div>\n                        <div class="float_window_act_cp_name_content" title="${s}">${s}</div>\n                        <div>${o}:${this.calcDevote(t.score)}</div>\n                    </div>\n                </div>`})),n}commonArrow(t){"right"==t?++this.curIndex:--this.curIndex,this.curIndex<0?this.curIndex=this.list.length-1:this.curIndex==this.list.length&&(this.curIndex=0)}calcDevote(t){if(isNaN(1*t))return t;{let e="";return e=t<1e4?t:Math.floor(t/1e4*100)/100+"w",e}}upFixed(t,e){let n="0";if(Number(t)&&e>0)if(e=+e||2,/e/.test(t+=""))n=t;else if(/\./.test(t)){t+=`${Array(e+1).join("0")}`;let i=new RegExp(`-?\\d*\\.\\d{0,${e}}`),o=i.exec(t)[0];if(+o>=+t)n=o;else{let t=+o+ +`0.${Array(e).join("0")}1`,s=t+(/\./.test(t+"")?"":".")+`${Array(e+1).join("0")}`;n=i.exec(s)[0]}}else n=t;return Math.ceil(n)+"w"}dragonHeroRank(t){const{image:e,text:n,extra_params:i}=t;qt.get(`${Dt}/activity.window.dragon/heroRank?cid=${this.cid}&act_id=${t.act_id}`).then((t=>{const{rank_list:i,unit:o}=t.data;let s="";i.forEach((t=>{const i=1==t.is_ower?`background:url(${e.self_background.pic});color:${n.rank_text.color}`:"";s+=`<div class="float_window_act_rank_item float_window_flex" style="${i}">\n                        <div class="float_window_act_rank_index">${t.rank}</div>\n                        <img class="float_window_act_cp_header_item" style="border:2px solid ${n.head_frame.color};margin:0 10px 0 20px" src="${t.user_info.avatar}">\n                        <div>\n                            <div class="float_window_act_cp_name_content" title="${t.user_info.nickname}">${t.user_info.nickname}</div>\n                            <div>${o}:${this.calcDevote(t.score)}</div>\n                        </div>\n                    </div>`}));let a={html:`<div class="float_window_explain" style="color:${n.main.color}">${n.main.content}</div>\n                        <div class="float_window_flex float_window_nav_content" style="margin-top:40px">\n                            <div class="float_window_act_rank_index">排名</div>\n                            <div style="margin-left:80px">用户</div>\n                        </div>\n                        <div class="float_window_rank_content">${s}</div>`,bg:e.background.pic,color:n.main.color,pt:"160px"};this.renderContent(a)}))}womenleague(t){window.$(".act_womenleague").css({"background-image":"url('https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_vote_list_bg.png')",color:"#ffffff",width:"310px",height:"426px",top:`${window.$("#act_modal_content").offset().top}px`,left:window.$("#act_modal_content").offset().left-50+"px","padding-top":"5px"}),qt.get(Dt+`/match/getMatchLive?id=${t}`).then((e=>{const{team_list:n}=e.data;let i=`\n                <img class="act_womenleague_close ygb_cursor" src="https://res.tuwan.com/templet/play/rechargefirst/recharge_first_little_close.png" alt="" >\n\n                <div class="act_womenleague_teamnames">\n                    <div class="act_womenleague_teamname">${n.left_name}</div>\n                    <div class="act_womenleague_teamname">${n.right_name}</div>\n                </div>\n\n\n                <div class="act_womenleague_teaminfo_list">\n\n                    <div class="act_womenleague_teaminfo">\n                        ${n.left.map((e=>`<div class="act_womenleague_team_member">\n                                <div class="act_womenleague_team_member_info">\n                                    <div class="act_womenleague_avatar">\n                                        <img src="${e.avatar}">\n                                    </div>\n                                    <div class="act_womenleague_name">${e.nickname}</div>\n                                </div>\n                                <div class="act_womenleague_vote_info">\n                                    <div class="act_womenleague_vote_num">\n                                        人气：${e.num}\n                                    </div>\n                                    <div class="act_womenleague_vote_btn" data-actid="${t}" data-mid="${e.mid}" data-uid="${e.uid}" data-name="${e.nickname}" ></div>\n                                    <div class="act_womenleague_gift_btn" data-actid="${t}" data-mid="${e.mid}" data-uid="${e.uid}" data-name="${e.nickname}" ></div>\n                                </div>\n                            </div>`)).join("")}\n                    </div>\n\n                    <div class="act_womenleague_teaminfo">\n                        ${n.right.map((e=>`<div class="act_womenleague_team_member">\n                                <div class="act_womenleague_team_member_info">\n                                    <div class="act_womenleague_avatar">\n                                        <img src="${e.avatar}">\n                                    </div>\n                                    <div class="act_womenleague_name">${e.nickname}</div>\n                                </div>\n                                <div class="act_womenleague_vote_info">\n                                    <div class="act_womenleague_vote_num">\n                                        人气：${e.num}\n                                    </div>\n                                    <div class="act_womenleague_vote_btn" data-actid="${t}" data-mid="${e.mid}" data-uid="${e.uid}" data-name="${e.nickname}" ></div>\n                                    <div class="act_womenleague_gift_btn" data-actid="${t}" data-mid="${e.mid}" data-uid="${e.uid}" data-name="${e.nickname}" ></div>\n                                </div>\n                            </div>`)).join("")}\n                    </div>\n\n\n                </div>\n\n            `;window.$(".act_womenleague").html(i)}))}womenleaguevote(t,e,n,i){window.$(".act_womenleague_vote").css({"background-image":"url('https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_vote_modal_bg.png')",color:"#ffffff",width:"258.74px",height:"216px",top:`${window.$("#act_modal_content").offset().top}px`,left:window.$("#act_modal_content").offset().left-340+"px","padding-top":"50px"}),qt.get(Dt+`/Activity2021/getLeagueVoteNum?act_id=${t}`).then((o=>{if(0==o.error){const{gift_name:s,num:a}=o.data;let r=`\n                    <img class="act_womenleague_vote_close ygb_cursor" src="https://res.tuwan.com/templet/play/rechargefirst/recharge_first_little_close.png" alt="" >\n                    <div class="act_womenleague_vote_song_tips">送礼物增加人气值，1钻石=1人气值<br>${s}礼物额外增加50%人气值</div>\n                    <div class="act_womenleague_vote_song_content flex_sb">\n                        <div class="act_womenleague_vote_num_btn ygb_cursor flex_c" data-type="sub">\n                            -\n                        </div>\n                        <input type="number" value="1" class="act_womenleague_vote_input">\n                        <div class="act_womenleague_vote_num_btn ygb_cursor flex_c" data-type="add">\n                            +\n                        </div>\n                    </div>\n                    <div class="act_womenleague_vote_btn ygb_cursor" data-actid="${t}" data-mid="${i}" data-uid="${e}" data-name="${n}" ></div>\n                    <div class="act_womenleague_vote_song_rank">当前共有${a}人气值，每日赠送10人气值</div>\n                `;window.$(".act_womenleague_vote").html(r),window.$(".act_womenleague_gift").hide(),window.$(".act_womenleague_vote").show()}else-1==o.error?this.emitter.emit("showLoginWindow"):Vt(o.error_msg)}))}womenleaguegift(t,e,n,i){window.$(".act_womenleague_gift").css({"background-image":"url('https://asset.tuwan.com/activity/play/2021/womenleague/images/chatroom_gift_modal_bg.png')",color:"#ffffff",width:"218px",height:"261px",top:`${window.$("#act_modal_content").offset().top}px`,left:window.$("#act_modal_content").offset().left-340+"px","padding-top":"40px"}),qt.get(Dt+`/Activity2021/getLeagueVoteNum?act_id=${t}`).then((async o=>{if(0==o.error){const{gift_name:s,gift_id:a,num:r}=o.data,c=(await qt.get(Pt+`/Teacher/getGift?id=${a}`)).data;let l=`\n                    <img class="act_womenleague_gift_close ygb_cursor" src="https://res.tuwan.com/templet/play/rechargefirst/recharge_first_little_close.png" alt="" >\n                    <div class="act_womenleague_gift_song_tips">为<span>${n}</span>赠送${s}，人气值会额外增加50%哦</div>\n                    <div class="act_womenleague_gift_preview" >\n                        <img src="${c.pic}" />\n                        <div class="act_womenleague_gift_title" >\n                            ${c.title}\n                        </div>\n                        <div class="act_womenleague_gift_price" >\n                            ${c.diamond}钻\n                        </div>\n                    </div>\n                    <div class="act_womenleague_gift_content flex_sb">\n                        <label>输入礼物数量</label>\n\n                        <div class="act_womenleague_gift_num_btn ygb_cursor flex_c" data-type="sub">\n                            -\n                        </div>\n                        <input type="number" value="1" class="act_womenleague_gift_input">\n                        <div class="act_womenleague_gift_num_btn ygb_cursor flex_c" data-type="add">\n                            +\n                        </div>\n                    </div>\n                    <div  class="act_womenleague_gift_num_list">\n                        <div  class="act_womenleague_gift_num_item" data-num="10" >\n                            10\n                        </div>\n                        <div  class="act_womenleague_gift_num_item" data-num="66" >\n                            66\n                        </div>\n                        <div  class="act_womenleague_gift_num_item" data-num="520" >\n                            520\n                        </div>\n                        <div  class="act_womenleague_gift_num_item" data-num="888" >\n                            888\n                        </div>\n                        <div  class="act_womenleague_gift_num_item" data-num="1314" >\n                            1314\n                        </div>\n                    </div>\n\n                    <div class="act_womenleague_gift_btns" >\n                        <div class="act_womenleague_gift_send_btn ygb_cursor" data-actid="${t}" data-mid="${i}" data-uid="${e}" data-name="${n}" data-giftid="${a}" ></div>\n                        <div class="act_womenleague_gift_cancel_btn ygb_cursor" ></div>\n                    </div>\n\n\n                `;window.$(".act_womenleague_gift").html(l),window.$(".act_womenleague_vote").hide(),window.$(".act_womenleague_gift").show()}else-1==o.error?this.emitter.emit("showLoginWindow"):Vt(o.error_msg)}))}async sendgift(t,e,n,i){const o=(await qt.get(Pt+`/Teacher/getGift?id=${t}`)).data;this.emitter.emit("sendGift",o,e,n,i,(t=>{0==t.error&&window.$(".act_womenleague_gift").hide()}))}singrank(t){const{pcurl:e}=t;qt.get(`${Dt}/activity2021/recreationFloatingWindowList?act_id=${t.act_id}&cid=${this.cid}`).then((t=>{let n={html:`\n                <div class="act_singrank_userlist">\n                        ${t.data.map(((t,e)=>`<div class="act_singrank_userinfo">\n                                <div class="act_singrank_idx">\n                                    ${e+1}\n                                </div>\n                                <div class="act_singrank_avatar">\n                                    <img src="${t.avatar}">\n                                </div>\n                                <div class="act_singrank_name">${t.nickname}</div>\n                                <div class="act_singrank_num">\n                                    ${t.num}\n                                </div>\n                            </div>`)).join("")}\n                </div>\n                <a class="gopage" href="${e}" target="_blank" ></a>\n            `,bg:"https://asset.tuwan.com/activity/play/2021/2021singrank/images/chatroom_vote_rank_bg.png",color:"#ffffff",pt:"90px"};this.renderContent(n)}))}musicrank(t){const{pcurl:e}=t;qt.get(`${Dt}/Department2022/singerWindow?id=9&cid=${this.cid}`).then((t=>{let n={html:`<div class="act_musicrank">\n                            ${t.data.map(((t,n)=>`<div class="act_musicrank_userinfo">\n                                    <div class="act_musicrank_idx">\n                                        ${n+1}\n                                    </div>\n                                    <div class="act_musicrank_avatar">\n                                        <img src="${t.avatar}">\n                                    </div>\n                                    <div class="act_musicrank_name">${t.nickname}</div>\n                                    <a href="${e}&share_uid=${t.uid}" target="_blank" class="act_musicrank_btn">\n                                        听ta的歌\n                                    </a>\n                                </div>`)).join("")}\n                        </div>\n                `,bg:"https://asset.tuwan.com/activity/play/2022/musicrank/images/chatroom_bg_new.png",color:"#ffffff",pt:"90px"};this.renderContent(n)}))}wolfgaming(t){qt.get(`${Dt}/activity2023/wolfMatch?cid=${this.cid}`).then((t=>{const e=t.data;let n="";if(-1==e.start_time)return;if(!(e.start_time-e.now_time>0))return;{this.countDown(e.now_time,e.start_time,!0);const t=e.uid,i=e.user_list.find((t=>t.user_info.uid==e.uid));let o=[];o=null!=i?[i,...e.user_list.filter((t=>t.user_info.uid!=e.uid))]:e.user_list;let s="";o.map((e=>{let n=t==e.user_info.uid?'<div class="mine"></div>':"";s+=`<div class="wolf_item" data-uid="${e.user_info.uid}" > <div class="wolf_header">\n                                     <img src="${e.user_info.avatar}" />\n                                     ${n}\n                                </div>\n                     <div class="wolf_name">${e.user_info.nickname}</div></div>`})),n=`<div class="wolf_container">\n                <div class="wolf_countdonw"><span style="margin-right: 10px;">距离比赛开始剩余</span><span class="dragon_time" >00:00:00</span></div>\n                <div class="flex flex-c">\n                    <div class="wolf_title"></div>\n                 </div>\n                 <div class="wolf_warpper ">\n                        <div class="wolf_content">\n                            ${s}\n                        </div>\n                 </div>\n                 <div class="wolf_bottom"><div></div></div>\n            </div>`}let i={html:n,bg:"https://res.tuwan.com/activity/wolfmatch/wolf_match_pc_bg.png?v1",color:"#ffffff",pt:"0px"};this.renderContent(i)}))}renderFlowerProcess(t,e,n,i,o,s){return`<div class="float_flower_progress_bg" style="background: url(${t});height:${s}px">\n                    <div class="float_flower_progress_val" style="width:calc(230px*${n}/100);background: url(${e});height:${s}px"></div>\n                    <div class="float_flower_progress_rate" style="${o};height:${s}px;line-height:${s}px">${i}</div>\n                </div>`}renderFlowerDetail(t,e){let n=this.list[t];this.list[t-1];let i=this.task_list[e],o=this.task_list[e-1],s=o?o.num:0,a=i.num,r=0;r=this.flower_data.flower_num>=a?100:this.flower_data.flower_num<s?0:(this.flower_data.flower_num-s)/(a-s)*100;let c=this.renderFlowerProcess(this.images.progress_background.pic,this.images.progress_cover.pic,r,"","font-size:12px;",14);window.$(".flower_title").html(n.name),window.$(".flower_detail_content .flower_name img").attr("src",this.images[`rose_${n.stage}`].pic),window.$(".flower_detail_content .flower_progress_content").html(c),window.$(".flower_detail_content .flower_progress_data .minval span").html(s),window.$(".flower_detail_content .flower_progress_data .maxval span").html(a)}flowerData(t){const{pcurl:e,image:n,text:i,extra_params:o}=t;qt.get(`${Dt}/activity2023/getWaterFlowerWindow?act_id=${t.act_id}&cid=${this.cid}`).then((t=>{const{stage_list:o,flower_data:s,task_list:a}=t.data,r=i.progress_text.content.split(",");this.images=n,this.list=o,this.task_list=a,this.flower_data=s;let c=this.list.find((t=>this.flower_data.used_water_num<t.num)),l=this.task_list.find((t=>this.flower_data.flower_num<t.num));this.curIndex=this.list.indexOf(c)>=0?this.list.indexOf(c):0,this.curTaskIndex=this.task_list.indexOf(l)>=0?this.task_list.indexOf(l):this.task_list.length-1;let d={html:`\n                        <div class="float_window_explain" style="color:${i.main.color}">${i.main.content}</div>\n                        <div class="float_window_collect_title flower_title" style="margin-top:8px;font-weight:bold;font-size:${i.progress_text.size}px;color:${i.progress_text.color}"></div>\n                        <div class="flower_content">\n                            \x3c!--<img class="flower_arrow_item" data-type="left" src="${n.left_arrow.pic}">--\x3e\n                            <div class="flower_detail_content float_window_flex_c" style="color:${i.main.color};position: relative;width:240px;height:163px;">\n                                <div>\n                                    <div style="font-size:12px;" >我的${r[0]}：${s.own_water_num}</div>\n                                    <div class="flower_name">\n                                        <img>\n                                    </div>\n                                    <div style="font-size:12px;">已浇灌${r[1]}：${s.flower_num}朵</div>\n\n                                    <div class="flower_progress" style="font-size:12px;color:${i.main.color}">\n                                        <div class="flower_progress_content"></div>\n                                        <div class="flower_progress_data">\n                                            <div class="minval"><span></span>朵</div>\n                                            <div class="maxval" style="margin-left:auto;" ><span></span>朵</div>\n                                        </div>                  \n                                    </div>                                 \n                                </div>       \n                            </div>\n                            \x3c!--<img class="flower_arrow_item" data-type="right" src="${n.right_arrow.pic}">--\x3e\n                        </div>\n                        <img style="margin-top:14px;" src="${n.button_pic.pic}" class="float_window_jump" data-url="${e}"> \n                        `,bg:n.background.pic,color:i.main.color,pt:"146px"};this.renderContent(d).then((()=>{this.renderFlowerDetail(this.curIndex,this.curTaskIndex)}))}))}roseGodness(t){const{image:e,text:n,extra_params:i,pcurl:o}=t;this.images=e,this.jumpUrl=o,Promise.all([qt.get(`${Dt}/activity/roomWindow?cid=${this.cid}&id=${t.act_id}`),qt.get(`${Dt}/activity.window.rose/getRoseActivityList?cid=${this.cid}&act_id=${t.act_id}`)]).then((t=>{let i=t[0],o=t[1].data.list;const{max_score:s,score:a,rate:r}=i;let c="",l="";if(e.progress_background.pic){let t=`font-size:${n.progress_text.size}px;color:${n.progress_text.color}`,i=`${r}%`;c=this.renderProcess(e.progress_background.pic,e.progress_cover.pic,r,i,t,14)}l=`\n                <div class="rose_tablist">\n                    ${o.map(((t,n)=>`<div data-id="${t.act_id}" class="float_window_tab_item ${0==n?"actived":""}" style="background-image:url(${e.navigation01.pic});" >${t.title}</div>`)).join("")}\n                </div>\n                <div class="rose_tips" style="font-size:14px;margin-top:10px;color:${n.main.color}">达到指定魅力值即可领取</div>\n                <div class="rose_content" style="margin-top:8px;color:${n.main.color}"></div>\n            `;let d={html:`${c}\n            <div class="float_window_explain" style="margin-top:6px;color:${n.main.color}">${n.main.content}</div>\n            ${l}`,bg:e.background.pic,color:n.main.color,pt:"154px"};this.renderContent(d),this.roseGodnessTask(o[0].act_id)}))}roseGodnessTask(t){qt.get(`${Dt}/activity.window.rose/getUserTask?cid=${this.cid}&act_id=${t}`).then((t=>{if(0==t.error){let e="",n="",i=t.data.score,o=t.data.unit;t.data.buy_auth;let s=t.data.task_list.find((t=>2==t.status));s||(s=t.data.task_list.find((t=>1==t.status))),s||(s=t.data.task_list[t.data.task_list.length-1]);let a=s.award_list;a.forEach(((t,n)=>{let i="";i=t.pic.endsWith("svga")?`<div class="float_window_common_gift_svga float_window_common_img rose_svga_${n}"></div>`:`<img src="${t.pic}" class="float_window_common_img">`,e+=`<div style="background: url(${this.images.gift_bg.pic}) center center no-repeat;width:61px;height:61px;margin:2px 10px;" class="float_window_flex_c">\n                                        ${i}\n                                    </div>`})),n=`\n                    <div class="rose_awardlist num_${a.length}">${e}</div>\n                    <a class="rose_btn" style="background-image:url(${2==s.status?this.images.take.pic:1==s.status?this.images.will_take.pic:this.images.upgrade.pic})" target="_blank" href="${this.jumpUrl}" >\n                        ${1==s.status?`${i}/${s.num}${o}`:""}\n                    </a>\n                `,window.$(".rose_content").html(n),window.$(".rose_tips").html(`达到指定${o}即可领取`),a.forEach(((t,e)=>{t.pic.endsWith("svga")&&Zt.getInstance().loadParser(`.rose_svga_${e}`,t.pic,0,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}))}else window.$(".rose_content").html(""),Vt(t.error_msg)}))}renderMasterRankList(){let t="";for(let e=0;e<3;e++){let n=this.ranklist[e],i="",o="";i=n.user_info.avatar,o=n.user_info.nickname,t+=`<div class="float_window_act_rank_item float_window_flex" >\n                <div class="float_window_act_rank_index" style="color:#effcff;">第${n.rank}名</div>\n                <img class="float_window_act_cp_header_item" style="border:2px solid ${this.modalData.avatarColor};margin:0 10px 0 20px;width:40px;height:40px;" src="${i}">\n                <div style="color:#effcff;" >\n                    <div class="float_window_act_cp_name_content" title="${o}">${o}</div>\n                    <div>星运值:${this.calcDevote(n.score)}</div>\n                </div>\n            </div>`}return t}starMaster(t){const{image:e,text:n,extra_params:i,activityid:o}=t;o!=(1==Ct.getQueryString("env")?955:970)?qt.get(`${Dt}/activity.window.star_master/data?cid=${this.cid}&act_id=${t.act_id}`).then((i=>{if(0==i.error){const{rank_list:o,score:s,level:a}=i.data;if(this.ranklist=o,this.ranklist.length<4)for(let t=0;t<3;t++)this.ranklist[t]||(this.ranklist[t]={user_info:{uid:0,nickname:"虚位以待",avatar:"https://uc.tuwan.com/images/noavatar_1.jpg"},rank:t+1,score:0});this.modalData={activedBg:e.background.pic,navBg:e.button_unselect?e.button_unselect.pic:"",navTextColor:n.button_text?n.button_text.color:"",activedNavBg:e.button_select?e.button_select.pic:"",activedNavTextColor:n.button_text?n.button_text.color:"",heart:e.cp_avatar_heart?e.cp_avatar_heart.pic:"",type:6==t.extra_params.rank_id?0:1};let r="";r=`<div class="float_window_nav_content float_window_flex_c" style="margin-top:5px;font-size:18px;color:#fffbd5;">LV${a}</div>\n                           <div class="float_window_nav_content float_window_flex_c" style="margin-top:5px;font-size:14px;color:#effcff;">星运总值：${s}</div>`;let c={html:`${""}\n                            <div class="float_window_explain" style="color:${n.main.color}">${n.main.content}</div>\n                            ${r}\n                            <div class="float_window_rank_content"></div>`,bg:e.background.pic,color:n.main.color,pt:"160px"};this.renderContent(c).then((()=>{o.length>1&&window.$(".float_window_nav_item").css({width:"100px",height:"26px",margin:"0 5px"});let t=this.renderMasterRankList();window.$(".float_window_rank_content").html(t)}))}})):this.qjcSpecialRank(t)}}let Sd;const Td={create:function(t){Sd=new window.Swiper(".autoroom-swiper-container",{threshold:20,slidesPerView:t.slidesPerView,slidesPerColumn:t.slidesPerColumn,slidesPerGroup:t.slidesPerGroup,grid:{rows:uu.isAutoRoom()?2:1},pagination:{el:".carauto-pagination-caraudo",clickable:!0,renderBullet:function(t,e){return'<span class="'+e+'">'+(t+1)+"</span>"}},navigation:{nextEl:".carauto-button-next",prevEl:".carauto-button-prev"}})},update:function(){if(Sd)try{Sd.update()}catch(t){}},drop:function(){if(Sd)try{Sd.destroy(!0,!0),Sd=null}catch(t){}finally{Sd=null}}};function Rd(t,e){t&&window.$.DialogByZ.Alert({Title:"提示",Content:t,BtnL:"确定",FunL:function(){window.$.DialogByZ.Close(),e&&e()}})}function Md(t,e,n,i,o="取消"){n=n||"确定",i=i||"",window.$.DialogByZ.Confirm({Title:i,Content:t,BtnL:o,BtnR:n,FunL:function(){window.$.DialogByZ.Close()},FunR:function(){e(),window.$.DialogByZ.Close()}})}const Ad=cs.getInstance();class Pd{constructor(){this.startRecordTimestamp=0,this.mineMaxVolume=0,this.othersMaxVolume=0,this.collectVolumes=[],this.reportRecordTime=0,this.reportStack=[],this.captainVolumeCollect=null}static getInstance(){return this.instance||(this.instance=new Pd),this.instance}onReset(){this.startRecordTimestamp=0,this.mineMaxVolume=0,this.othersMaxVolume=0,this.collectVolumes=[],this.reportRecordTime=0,this.reportStack=[],this.captainVolumeCollect=null}onResetTips(){this.startRecordTimestamp=0,this.mineMaxVolume=0,this.othersMaxVolume=0,this.collectVolumes=[]}captainCollectStart(){this.captainVolumeCollect=[]}captainCollectStop(){this.captainVolumeCollect=null}onCheck(t){if(this.captainVolumeCollect&&this.captainVolumeCollect.length<10){const e=t.find((t=>t.uid==uu.getMeid()));e&&this.captainVolumeCollect.push(Math.round(e.level))}const e=uu.getRoomInfo();if(1==e.volume_tips){if(uu.getAnchoringUserId()==uu.getMeid())if(0==this.startRecordTimestamp&&(this.startRecordTimestamp=(new Date).getTime()/1e3),(new Date).getTime()/1e3-this.startRecordTimestamp>=e.volume_time)this.mineMaxVolume>e.volume_low_num?qt.get(Ot.getReportVolume(uu.getCid(),2)).then((t=>{})):this.othersMaxVolume>e.volume_low_num?qt.get(Ot.getReportVolume(uu.getCid(),4)).then((t=>{})):qt.get(Ot.getReportVolume(uu.getCid(),3)).then((t=>{})),1==e.volume_log&&qt.get(Ot.getReportVolumeLog(uu.getCid(),this.collectVolumes.join(","))).then((t=>{})),this.onResetTips();else{let n=t.find((t=>t.uid==uu.getMeid()));n||(n={level:0}),1==e.volume_log&&this.collectVolumes.push(Math.round(n.level)),this.mineMaxVolume=Math.max(this.mineMaxVolume,n.level),this.mineMaxVolume>e.volume_normal_num?(this.onResetTips(),Pd.getInstance().closeTip()):(t.filter((t=>t.uid!=uu.getMeid())).forEach((t=>{this.othersMaxVolume=Math.max(this.othersMaxVolume,t.level)})),this.othersMaxVolume>e.volume_normal_num&&(this.onResetTips(),Pd.getInstance().closeTip()))}else this.onResetTips()}else this.onResetTips();if(1==e.volume_log)if(uu.isInAnchors(uu.getMeid()))if(0==this.reportRecordTime&&(this.reportRecordTime=(new Date).getTime()/1e3),(new Date).getTime()/1e3-this.reportRecordTime>=30)this.reportMineData();else{let e=t.find((t=>t.uid==uu.getMeid()));this.reportStack.push(e?{vol:Math.round(e.level),vad:Ad.currentVad>.5?1:0}:{vol:0,vad:0})}else this.reportStack.length>0&&this.reportMineData()}reportMineData(){(new Image).src=Ot.getReportMineVolume(uu.getCid(),uu.getMeid(),JSON.stringify(this.reportStack)),this.reportStack=[],this.reportRecordTime=0}showMessage(t){if(t.uid==uu.getMeid()&&t.uid_msg&&t.uid_msg.length){const e=uu.getAnchorKengUser(t.uid);if(e&&e.position>0){const n=window.$(`.seat-item-empty[data-aposition=${e.position}] .seat-head`);if(n.length>0){const e=n[0].getBoundingClientRect();window.$(".volumeTip").remove(),window.$("body").append(`\n                        <div class="volumeTip" style="position: absolute; z-index: 100000; top: ${e.top-43}px; left: ${e.left+e.width/2}px; opacity: 1; transform: translateX(-50%); padding: 5px;">\n                            <div style="font-size: 12px; padding: 5px 10px; pointer-events: none; color: #fff; text-align: left; background-color: #fff; color: #666; border-radius: 3px; box-shadow: 0 7px 21px #0000001a; line-height: 20px;">${t.uid_msg}</div>\n                            <div style="position: absolute; bottom: -1px; left: 50%; transform: translate(-50%); width: 12px; height: 6px; background: url(https://res.tuwan.com/templet/play/chat/v10/images/tooltip.png?v=1) no-repeat 0 0; z-index: 3;"></div>\n                        </div>\n                    `)}}}}closeTip(){window.$(".volumeTip").remove()}showInstructionModal(t){function e({title:t,imgUrl:e,desc:n}){return`\n                <div class="card">\n                    <p class="card_title">${t}</p>\n                    <img style="width: 282px; height: 182px; margin-top: 22px;" src="${e}"/>\n                    <p class="card_desc" style="margin-top: 13px;">${n}</p>\n                </div>\n            `}const n=window.$(`\n            <div class="volumeDetection_instruction_modal">\n                <div class="volumeDetection_instruction_modal-body">\n                    <p class="title">音量调节</p>\n                    <div class="volume_block">\n                        <div class="left_block">\n                            <p>1、右键右下角<img style="width: 20px; height: 20px; margin: 0 5px 0 10px;" src="https://res.tuwan.com/chatroom/images/icon_instruction_horn.png"/>打开音量的窗口，点击“打开声音设置”</p>\n                            <img style="width: 166px; height: 134px;" src="https://res.tuwan.com/chatroom/images/instruction_volume_1.png"/>\n                            <p style="margin-top: 13px;">2、在弹出的窗口中找到“输出”，点击“设备属性”</p>\n                            <img style="width: 317px; height: 131px;" src="https://res.tuwan.com/chatroom/images/instruction_volume_2.png"/>\n                        </div>\n                        <div class="right_block">\n                            <p>3、在“设备属性”窗口中，调节音量的大小</p>\n                            <img style="width: 275px; height: 119px;" src="https://res.tuwan.com/chatroom/images/instruction_volume_3.png"/>\n                        </div>\n                    </div>\n                    <div class="soundcard_block hide">\n                        ${e({title:"无机架用户",imgUrl:"https://res.tuwan.com/chatroom/images/instruction_sound_card_1.png",desc:"提示：声卡不同位置可能不同，可根据声卡<br/>品牌和型号调节话筒按钮的大小"})}\n                        ${e({title:"机架用户",imgUrl:"https://res.tuwan.com/chatroom/images/instruction_sound_card_2.png",desc:"提示：机架用户调节有些复杂，如果有条件可<br/>联系专业调音师进行调节。如果自行操作，不<br/>同声卡位置可能不同，可根据声卡品牌和型号<br/>调节录音输出的高低"})}\n                    </div>\n                    <p class="switchBtn">声卡调节说明</p>\n                    <p class="concatBtn">联系客服</p>\n                    <div class="closeBtn"/>\n                </div>\n            </div>\n        `);window.$("body").append(n),n.find(".volumeDetection_instruction_modal").on("click",(t=>{t.stopPropagation()})),n.find(".switchBtn").on("click",(t=>{t.stopPropagation();!n.find(".volume_block").hasClass("hide")?(n.find(".volume_block").addClass("hide"),n.find(".soundcard_block").removeClass("hide"),n.find(".title").text("声卡说明"),n.find(".switchBtn").text("返回音量调节")):(n.find(".volume_block").removeClass("hide"),n.find(".soundcard_block").addClass("hide"),n.find(".title").text("音量调节"),n.find(".switchBtn").text("声卡调节说明"))})),n.find(".concatBtn").on("click",(e=>{e.stopPropagation(),t()})),n.find(".closeBtn").on("click",(t=>{t.stopPropagation(),n.remove()}))}}let jd,Dd=0;function Ld(){const t=uu.getCid(),e=uu.getMeid(),n=(new Date).getTime();Ed(t,e,++Dd,n).then((t=>{}))}async function Ed(t,e,n,i,o){let s;const a=Pd.getInstance().captainVolumeCollect;a&&a.length&&(s=a.join(","),Pd.getInstance().captainVolumeCollect=[]);const r=Ot.uploadVoiceLog(t,e,n,i,s);qt.get(r).then((s=>-99==s.error&&(bt.addVoiceLog({cid:t,uid:e,timer:n,time:i}),o)?"fail":"success"))}function Bd(){jd&&(clearInterval(jd),jd=null,Pd.getInstance().captainCollectStop())}const Fd=Ct.getQueryString("log");function Ud(t,...e){if("1"==Fd){t=t||"info";const n=new Date,i=Ct.dateFormat(n,"-");"error"==t?console.error(i,e[0]||"",e[1]||"",e[2]||"",e[3]||""):"info"==t?console.info(i,e[0]||"",e[1]||"",e[2]||"",e[3]||""):"log"==t?console.log(i,e[0]||"",e[1]||"",e[2]||"",e[3]||""):"warn"==t&&console.warn(i,e[0]||"",e[1]||"",e[2]||"",e[3]||"")}}function zd(){return uu.getRoomInfo().typeid}function Od(t,e,n,i){const o={uid:t,position:n,cid:e,state:i,typeid:zd()};uu.globalDDSocket.send("setwheat",o)}function Nd(t,e,n){var i={uid:t,position:1,cid:e,state:n,typeid:zd()};uu.globalDDSocket.send("setwheat",i)}function qd(t,e,n){var i={state:e,passport:Ct.readCookie("Tuwan_Passport"),uid:n,cid:uu.getCid(),channel:uu.getChannel(),typeid:zd()};uu.globalDDSocket.send(t,i)}function Gd(t,e,n){var i={state:e,passport:Ct.readCookie("Tuwan_Passport"),uid:n,cid:uu.getCid(),channel:uu.getChannel(),typeid:zd()};uu.globalDDSocket.send(t,i)}function Vd(t,e,n,i){Ud("info","getSocketMessage","setZhuchiWheat");const o={uid:t,position:i||2,cid:e,state:n,typeid:zd()};(uu.isDrawTempRoom()||uu.isDrawRoom())&&(o.subType=1),uu.globalDDSocket.send("setwheat",o)}function Hd(t,e,n,i){i=i||zd();var o={uid:t,position:3,cid:e,state:n,typeid:zd()};(uu.isDrawTempRoom()||uu.isDrawRoom())&&(o.subType=1),uu.globalDDSocket.send("setwheat",o)}function Wd(t,e,n,i){let o={cid:t,gameMode:e,desc:i,gold:n};const s=Ct.readCookie("Tuwan_Passport");o.passport=s,uu.globalDDSocket.send("publishBombCat",o)}function Kd(t,e,n,i,o){o=o||0,uu.globalDDSocket.send("setfleet",{cid:n,fid:i,uid:e,state:0,position:t,ftype:o})}function Yd(t,e,n,i=[]){i.push("setchannel"),i.push("wheatlist");let o={cid:t,uid:e,typeid:n,method:i=[...new Set(i)]};19==uu.getRoomInfo().live&&(o={cid:t,uid:e,typeid:n,method:i,subType:19}),uu.globalDDSocket.send("initlist",o)}function Jd(t,e,n){var i={cid:t,uid:e,typeid:n};uu.globalDDSocket.send("initGameTruth",i)}function Qd(t,e){const n=JSON.parse(e+"");n.to=t,n.version="1";Zd(JSON.stringify(n))}async function Xd(t,e){const n={message:kd.messageFormat(t,e,fe.getInstance().getAtUser())};uu.globalDDSocket.send("message",n)}async function Zd(t){const e=JSON.parse(t+"");e.version="1";const n={message:JSON.stringify(e)};uu.globalDDSocket.send("message",n)}function tm(t,e,n,i,o){const s={cid:n,fid:i,uid:e,state:-1,position:t,ftype:o=o||0};uu.globalDDSocket.send("setfleet",s)}function em(t,e,n){const i={state:t,cid:e,uid:n};uu.globalDDSocket.send("setqueue",i)}function nm(t,e){const n=kd.Type,i=t.areaname,o=t.levelname,s=t.cid,a=t.giftid,r=t.giftnum,c=t.giftpath,l=t.sports||0,d=t.tagname||"",m=9==t.live?2:t.fleetnum,h=t.mode||"",u='"teaminfo":{"fleetnum":'+m+',"giftpath":"'+c+'","cid":"'+s+'","giftid":"'+a+'","giftnum":"'+r+'","desc":"'+t.desc+'","areaname":"'+i+'","levelname":"'+o+'","avatar":"'+uu.getSelfInfo().avatar+'","fid":"'+e+'","sports":"'+l+'","mode":"'+h+'","tagname":"'+d+'"}';Zd(kd.messageFormat(n.autoteamyaoqing,u))}function im(t,e){const n=kd.Type;Zd(kd.messageFormat(n.delautocarcard,t))}class om{constructor(){this.instance=null,this.intervalInt=0,this.timeoutlInt=0,this.intervalFlag=!1,this.intervalnums=[]}static getIntance(){return this.instance||(this.instance=new om),this.instance}delayInterval(t,e){this.intervalInt=window.setInterval(e,t),this.intervalnums.push(this.intervalInt)}delayTimeout(t){return new Promise(((e,n)=>{window.setTimeout(e,t)}))}setFlag(t){if(t)for(let e=0;e<this.intervalnums.length;e++)window.clearInterval(this.intervalnums[e]);this.intervalFlag=t}destroy(){if(0!=this.intervalInt)for(let t=0;t<this.intervalnums.length;t++)window.clearInterval(this.intervalnums[t]);this.intervalInt=0,this.intervalFlag=!1}}class sm{constructor(){this.flag=!1}setFlag(t){this.flag=t}exec(){return new Promise(((t,e)=>{this.flag?e():(this.flag=!0,t())}))}}const am=new sm,rm=new sm,cm=new sm,lm=990;let dm=null;function mm(t){return Math.floor(t)===t}function hm(t,e){window.$.ajax({url:t,type:"get",dataType:"jsonp",success:function(t){e(t)}})}const um=new class{constructor(){this.channelRoomId="",this.nickname="",this.avatar="",this.roomTypeId=-1,this.getMoneyCB=function(t,e,n,i){const o=uu.getSelfInfo();var s=o.money+t;if(o.money=s,bt.setSelfUser(o),window.$("#font-my-yue").text((1*s).toFixed(2)),0!=i){let s="";s=1==e?kd.messageFormat($d.getredmoneywang,o.nickname,n,t,i):kd.messageFormat($d.getredmoney,o.nickname,n,i),Zd(s)}},this.noLoginCB=du,this.init()}initData(t){this.channelRoomId=t.channelRoomId,this.nickname=t.nickname,this.avatar=t.avatar,this.sendPacketCB=t.sendPacketCB,this.sendpacketCloseCB=t.sendpacketCloseCB,this.roomTypeId=t.roomTypeId}setRoomTypeId(t){this.roomTypeId=t}init(){this.initAll((function(t){t.initEvent(t)}))}initAll(t){var e='<div style="background:url(http://res.tuwan.com/templet/play/chat/images/redpackbgshadow.png) no-repeat -17px -17px; left:0; top:0;position:absolute; width:372px; height:474px; z-index:-1"></div>',n=`<div class="sendPacketModal" style="display: none;">\n                    <div class="sendPacket-content">\n                    ${e}\n                        <div class="tipsinfo">\n                            <span class="sendpacket-close"></span>\n                            <ul class="packet-title">\n                                <li data-selectid="0" class="selectedli">所有人</li>\n                                <li data-selectid="1">送队长</li>\n                                <li data-selectid="2">送老板</li>\n                            </ul>\n                            <div class="packet-types">\n                                <div class="packet-type active" data-type="rain" >红包雨</div>\n                                <div class="packet-type" data-type="normal" >拼手气红包</div>\n                            </div>\n                            <div class="packet-rain">\n                                <div class="rain-num-tips">选择金额</div> \n\n                                <div class="rain-num-list">\n                                                                                                   \n                                </div>\n\n                                <div class="packect-tips" style="margin-top:60px">\n                                    <span style="display: inline-block;width:10%;border-top:.5px solid #ccc;padding-bottom:5px;margin-right:5px;"></span>\n                                    我的\n                                    <span><img src="https://asset.tuwan.com/chatroom/images/icon_diamond_1.png" class="icon-diamond" /><span class="my-money"></span>钻</span>\n                                    <span><img src="https://asset.tuwan.com/chatroom/images/icon_amethyst.png" class="icon-amethyst" /><span class="my-amethyst"></span>紫晶</span>\n                                    <span style="display: inline-block;width:10%;border-top:.5px solid #ccc;padding-bottom:5px;margin-left:5px;"></span>\n                                </div>\n\n\n                                <div class="flex" style="padding: 0 30px;"><p style="flex: 1; font-size: 13px; color: #999999;text-align:center;">紫晶不足扣钻石，赠送后3秒会掉落红包雨</p></div>\n\n                            </div>\n                            <div class="packet-normal"  style="display:none;">\n                                <div class="packet-tips">发给当前聊天室所有用户</div>\n                                <div class="packet-money">\n                                    <span>金额</span>\n                                    <input type="text" value="10" class="packet-money-input" placeholder="填写金额" maxlength="10"/>\n                                    <span>钻石</span>\n                                </div>\n                                <div class="packet-num">\n                                    <span>个数</span>\n                                    <input type="text" value="3" class="packet-num-input" placeholder="填写个数" />\n                                    <span>个</span>\n                                </div>\n                                <input type="text" class="packet-desc" placeholder="随意玩耍，我买单">\n                                <div class="packet-num-big"></div>\n                                <div class="packect-tips">\n                                    <span style="display: inline-block;width:10%;border-top:.5px solid #ccc;padding-bottom:5px;margin-right:5px;"></span>\n                                    <span>钻石余额：<span class="my-money"></span>钻石</span>\n                                    <span style="display: inline-block;width:10%;border-top:.5px solid #ccc;padding-bottom:5px;margin-left:5px;"></span>\n                                </div>\n                                <div class="flex" style="padding: 0 30px;"><p style="font-size: 13px; color: #999999;">备注：</p><p style="flex: 1; font-size: 13px; color: #999999;">每人每次最低10钻石，最高990钻石，单日最高5000钻石</p></div>\n                            </div>\n                            <button class="inputpacket">塞进红包</button>\n                        </div>\n                    </div>\n                </div>\n                <div class="willopenModal" style="display: none;">\n                    <div class="willopen-content">\n                    ${e}\n                        <div class="canGrap">\n                            <span class="willopen-close"></span>\n                            <img class="ownerPic" src="" alt="">\n                            <div class="whospacket"><span class="packet-nickname"></span>发了一个红包</div>\n                            <div class="red_packet_desc">恭喜你完成厅1星任务<br>可参与拼手气红包</div>\n                            <div class="ownerpacket-desc"></div>\n                            <button class="grabPacket">抢</button>\n                            <div class="packetType"></div>\n                        </div>\n                    </div>\n                </div>\n                <div class="willopenModal-hunli" style="display: none;">\n                    <div class="willopen-content hunli" style="width:290px;height:410px">\n                        <div class="canGrap">\n                            <span class="willopen-close-hunli"></span>\n                            <div class="flex flex-jc redpack-newrens">\n                            </div>\n                            <button class="grabPacket-hunli"></button>\n                            <div class="packetType-hunli"></div>\n                        </div>\n                    </div>\n                </div>\n                <div class="hasopenModal" style="display: none;">\n                    <div class="hasopen-content">\n                    ${e}\n                        <div>\n                            <span class="hasopen-close"></span>\n                            <img class="ownerPic-1" src="" alt="">\n                            <div class="whospacket-1"></div>\n                            <div class="ownerpacket-desc-1"></div>\n                            <div class="grapTips">\n                                <div style=" font-size: 34px;color:#ff224f;" class="grapAmount"></div>\n                                <div style=" font-size: 24px;color:#ff224f;" class="failTips"></div>\n                                <div class="successTips">已添加到钻石</div>\n                            </div>\n                            <div class="leftTips">\n                                <div style="float:left">已领取<span class="leftNum"></span>个</div>\n                                <div style="float:right">剩余<span class="leftMoney"></span><span class="red_packet_unit"></span></div>\n                            </div>\n                            <ul class="whoGrapPacket">\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n                <div id="tui-tips" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);padding:5px 20px;background:rgba(51,51,51,0.96);color:#fff;font-size:16px;border-radius:4px;z-index:999"> </div>`;window.$("head").append('<style>\n        .sendPacketModal,.willopenModal,.willopenModal-hunli,.hasopenModal{position:fixed;display:flex;top:0;left:0;width:100%;height:100%;z-index:120;align-items:center;justify-content:center;}\n        .sendPacket-content,.willopen-content,.hasopen-content{width:338px;position:relative;}\n        .redpack-new-tag{position:absolute; padding:0 6px;z-index:9; white-space:nowrap; bottom:-4px;left:50%;transform:translateX(-50%); border-radius:32px;background:#F74848; color:#FEE53D;font-size:12px}\n        .willopenModal-hunli .redpack-newrens{ display:flex; margin-top:50px; }\n        .willopenModal-hunli .redpack-newren{ margin:0 10px }\n        .willopenModal-hunli .redpack-newren img.readpack-new-avatar{width: 48px;height:48px; border-radius:100%}\n        .sendPacket-content{border-top-left-radius: 12px; border-top-right-radius: 12px; background:url("https://res.tuwan.com/templet/play/chat/images/inputredpacket.png"); background-repeat: no-repeat; background-color: rgba(242, 242, 243, 1);}\n        .willopen-content{text-align:center;height:440px;background:url("https://res.tuwan.com/templet/play/chat/images/packetwillopen.png");}\n        .willopen-content.hunli{text-align:center;background:url("http://asset.tuwan.com/chatroom/images/hunlibaobg.png");}\n        .hasopen-content{text-align:center;height:440px;background:url("https://res.tuwan.com/templet/play/chat/images/packethasopen.png");}\n        .willopen-close,.willopen-close-hunli,.hasopen-close{position:absolute;width:30px;height:30px;right:0;top:0;border-radius:30 px;z-index:9;cursor:pointer;background:url("http://res.tuwan.com/templet/play/chat/images/packetclose.png")}\n        .sendpacket-close{position:absolute;width:30px;height:30px;right:0px;top:0px;z-index:9;cursor:pointer;background:url("https://asset.tuwan.com/chatroom/images/white-guanbi.png");background-size: 100% 100%;}\n        .packet-title{display:flex;width:300px;height:44px;color:white;font-weight:bold;list-style:none;margin:0 auto;justify-content:space-around;margin-top:23px;}\n        .packet-title li{cursor:pointer; width:100px;height:34px;text-align:center;line-height:34px;font-size:18px;border-top-right-radius:10px;border-top-left-radius:10px;}\n        .selectedli{font-size:20px!important;background:#ffd727;color:#fd1b4e;}\n        .packet-types{display:flex;aligen-items:center;justify-content:center;}\n        .packet-type{font-size:24px;color:#999999;width: 125px;height:30px;text-align: center;line-height: 30px;margin-top:10px;cursor:pointer;}\n        .packet-type.active{color:#ff224f;cursor:auto;}\n        .packet-tips{color: #999;font-size:14px;width:155px;height:20px;line-height:20px;text-align:center;margin:5px auto 0;}\n        .packet-rain{min-height:296px;}\n        .rain-num-tips{padding:0 24px;font-size:14px;color:#727272;margin-top:20px;}\n        .rain-num-list{display:flex;flex-wrap:wrap;justify-content: space-between;margin-top:20px;padding:0 24px;}\n        .rain-num-item{display:flex;align-items:center;justify-content:center;margin: 10px 0;width:140px;height:42px;border:2px solid #ffffff;background:#ffffff;box-sizing:border-box;cursor:pointer;border-radius:6px;font-size:14px;color:#999999;}\n        .rain-num-item.active{border-color:#fc597a;color:#ff224f;background:transparent;}\n        .icon-diamond{margin: 0 4px;margin-bottom:2px;}\n        .icon-amethyst{margin: 0 4px;margin-bottom:4px;}\n        .packet-money,.packet-num,.packet-desc{display:flex; padding-right:20px; width:270px;height:40px;border:none;margin:15px auto 0;border-radius:40px;line-height:40px;outline:none;font-size:14px;background:white;color:#666;padding-left:20px;}\n        .packet-money-input,.packet-num-input{flex:1 auto; margin-right:10px; height:40px;border:none;line-height:40px;outline:none;font-size:14px;background:white;color:#666;text-align:right}\n        .inputpacket{width:290px;height:40px;border:none;border-radius:40px;outline:none;background:#ff224f;font-size:22px;color:#fff000;margin: 10px auto 20px auto; display: block;}\n        .packet-money-input::-webkit-input-placeholder,.packet-num-input::-webkit-input-placeholder{color:#ccc;text-align:right}\n        .packet-money-input::-moz-placeholder,.packet-num-input::-moz-placeholder{color:#ccc;opacity:1;text-align:right}\n        .packet-num-big{width:290px;height:50px;line-height:50px;text-align:center;margin:10px auto 0;color:#ff224f;font-size:30px;}\n        .packect-tips{width:290px;height:30px;line-height:30px;text-align:center;color:#666;margin:0 auto;font-size:14px;overflow:hidden;}\n        .ownerPic{width:72px;height:72px;border-radius:72px;margin-top:70px;border:3px solid #fff55b;}\n        .ownerPic-1{width:50px;height:50px;border-radius:50px;border:3px solid #fff55b;margin-top:15px;}\n        .whospacket,.whospacket-1,.red_packet_desc{width:338px;height:20px;font-size:14px;line-height:20px;text-align:center;color:white;}\n        .red_packet_desc{display:none;font-size:18px;margin-top:10px}\n        .whospacket{margin-top:15px}\n        .failTips{display:none}\n        .whospacket-1{margin-top:5px}\n        .packet-nickname{color:#fff55b}\n        .ownerpacket-desc,.ownerpacket-desc-1{width:338px;height:50px;font-size:20px;line-height:50px;text-align:center;}\n        .ownerpacket-desc{color:white;margin-top:10px;}\n        .ownerpacket-desc-1{color:#666;margin-top:10px;}\n        .grabPacket{position:absolute;top:287px;left:122px;width:95px;height:95px;border-radius:95px;background:#ffd727;color:#d50015;outline:none;border:2px solid #ffd727;font-size:45px;font-weight:bold;padding:0}\n        .grabPacket-hunli{ background:transparent; border:none; position:absolute;width:70px;height:70px; bottom:72px;z-index:2;left:50%;transform: translateX(-50%); outline:none; border-radius:100%}\n        .packetType,.packetType-hunli{position:absolute;bottom:20px;width:100%;height:20px;line-height:20px;text-align:center;font-size:14px;color:#ffd727}\n        .grapTips{width:338px;height:75px;display:flex;flex-direction:column;text-align:center;}\n        .successTips{font-size:14px;margin-top:5px;color:#666666;}\n        .leftTips{width:320px;height:20px;margin:20px auto 0;color:#666;font-size:14px;}\n        .whoGrapPacket{width:338px;height:150px;list-style:none;margin:15px auto;overflow:auto;}\n        .whoGrapPacket li{display:flex;position:relative;width:320px;margin:0 auto;height:70px;border-radius:10px;align-items:center;background:white}\n        .whoGrapPacket li:not(:first-child){margin-top:10px;}\n        .whoGrapPacket li img{width:48px;height:48px;border-radius:48px;border:2px solid #ffd727;margin-left:15px;}\n        .graperInfo{color:#666;font-size:14px;margin-left:10px;width:160px;overflow:hidden;text-align:left}\n        .graperNum{color:#666;font-size:14px;margin-left:10px;overflow:hidden;text-align:center}\n        .whoGrapPacket::-webkit-scrollbar-track{background-color:transparent;}\n        .whoGrapPacket::-webkit-scrollbar {width:5px;}\n        .whoGrapPacket::-webkit-scrollbar-thumb{background-color:#ccc;}</style>'),window.$("body").append(n),t(this)}initEvent(t){var e=window.$(".sendpacket-close"),n=window.$(".willopen-close"),i=window.$(".hasopen-close"),o=window.$(".packet-money-input"),s=window.$(".inputpacket"),a=window.$(".packet-num-input"),r=window.$(".packet-title"),c=window.$(".grabPacket"),l=window.$(".willopenModal-hunli"),d=window.$(".packet-type"),m=window.$(".rain-num-list");l.on("click",".grabPacket-hunli",(function(){const e=this.dataset.tradeno,n=this.dataset.desc;e&&hm(Ot.giveWeddingAward(e),(function(e){0==e.error?(t.grabChannelPacketHunli(e,n),window.$(".willopenModal-hunli").hide()):Vt(e.error_msg)}))})),l.on("click",".willopen-close-hunli",(function(){l.hide()})),e.on("click",(function(){window.$(".sendPacketModal").hide()})),c.on("click",(function(){let e=this.dataset.type;if(0==e){var n=window.$(this).attr("nickname"),i=window.$(this).attr("avatar"),o=window.$(this).attr("desc"),s=window.$(this).attr("tradeno");window.$(this).attr("redTypeid"),t.grapPacket(n,i,o,s)}else if(1==e){let e=this.dataset.cid;t.grabChannelPacket(e)}})),n.on("click",(function(){window.$(".willopenModal").hide(),window.$(".channel_task_common_modal").hide()})),i.on("click",(function(){window.$(".hasopenModal").hide(),window.$(".channel_task_common_modal").hide()})),s.on("click",(function(){if(dm)return;let e=window.$(".packet-type.active").data("type");if(console.info("packetType",e),"rain"==e){let e=window.$(".rain-num-item.active").data("id");t.sendPacketRain(e,t.channelRoomId)}else t.sendPacket(t.channelRoomId,t.nickname,t.avatar,t.sendPacketCB)})),o.on("keyup",(function(){var t=o.val();window.$(".packet-num-big").html(t+"钻石")})),o.on("blur",(function(){var e=o.val();let n=10;21==t.roomTypeId&&(n=200),""==e?(o.val(n),window.$(".packet-num-big").html(`${n}钻石`)):parseFloat(e)<n?Vt("最低金额为"+n+"钻石"):mm(parseFloat(e))?parseFloat(e)>lm&&(Vt("单笔最大金额990钻石"),o.val(lm),window.$(".packet-num-big").html(lm+"钻石"),dm=setTimeout((()=>{dm=null}),500)):Vt("请输入整数")})),a.on("blur",(function(){var t=a.val();""==t||(parseFloat(t)<3?(Vt("发送个数最低为3个"),a.val("3")):mm(parseFloat(t))?parseFloat(t)>100&&(Vt("最多为100个"),a.val("100")):Vt("请输入整数"))})),r.on("click",(function(t){var e=1*window.$(t.target).attr("data-selectid");0==e?(window.$(".packet-title li").removeClass(),window.$('.packet-title li[data-selectid = "0"]').removeClass().addClass("selectedli"),window.$(".packet-tips").text("发给当前聊天室所有用户"),window.$('.packet-type[data-type="rain"]').show(),window.$('.packet-type[data-type="rain"]').click()):1==e?(window.$(".packet-title li").removeClass(),window.$('.packet-title li[data-selectid = "1"]').removeClass().addClass("selectedli"),window.$(".packet-tips").text("发给当前聊天室所有队长"),window.$('.packet-type[data-type="rain"]').hide(),window.$('.packet-type[data-type="normal"]').click()):2==e&&(window.$(".packet-title li").removeClass(),window.$('.packet-title li[data-selectid = "2"]').removeClass().addClass("selectedli"),window.$(".packet-tips").text("发给当前聊天室所有老板"),window.$('.packet-type[data-type="rain"]').hide(),window.$('.packet-type[data-type="normal"]').click())})),d.on("click",(function(t){var e=window.$(t.target).attr("data-type");window.$(t.target).addClass("active").siblings().removeClass("active"),"rain"==e?(window.$(".packet-rain").show(),window.$(".packet-normal").hide()):(window.$(".packet-rain").hide(),window.$(".packet-normal").show())})),m.on("click",".rain-num-item",(function(t){window.$(t.target).addClass("active").siblings().removeClass("active")})),hm(`${Pt}/Redpacket/getRainConf`,(t=>{if(0==t.error){let e=[];for(let n=0;n<t.data.length;n++)e.push(`<div class="rain-num-item ${0==n?"active":""}" data-id="${t.data[n].id}" >${t.data[n].total}紫晶</div>`);window.$(".rain-num-list").html(e.join(""))}else Vt(t.error_msg)})),window.$(".chat-center-redpacket").on("click",(function(t){t.stopPropagation();uu.getMeid()>Mt.maxUID?du():(gloabPacket.openPacket(),window.$(".chat-center-gift-content").hide(),window.$(".chat-emoji-list").hide())})),window.$(".chat-center-main").on("click",".redpacket-message",(function(){var t=window.$(this).attr("nickname"),e=window.$(this).attr("avatar"),n=window.$(this).attr("desc"),i=window.$(this).attr("tradeno"),o=window.$(this).attr("typeid"),s=uu.getSelfInfo(),a=s.uid,r=s.teacher,c=!1,l="";a>Mt.maxUID?du():0==o?c=!0:1==o?1==r?c=!0:l="这个红包只有队长才可以抢哦~":0==r?c=!0:l="这个红包只有老板才可以抢哦~",c?gloabPacket.openGrap(t,e,n,i,o):Vt(l)}))}openPacket(){const t=this;hm(Ot.getMoney(),(function(e){21==t.roomTypeId?window.$(".packet-money-input").val("200"):window.$(".packet-money-input").val("10"),window.$(".packet-num-input").val("3"),window.$(".packet-desc").val(""),window.$(".packet-num-big").html(""),window.$(".sendPacket-content li").removeClass(),window.$('.sendPacket-content li[data-selectid = "0"]').removeClass().addClass("selectedli"),window.$(".sendPacketModal").show(),window.$(".my-money").text(e.diamond),window.$(".my-amethyst").text(e.number),window.$(".packet-tips").text("发给当前聊天室所有用户")}))}sendPacket(t,e,n,i){var o=1*window.$(".packet-money-input").val(),s=window.$(".packet-num-input").val(),a=window.$(".packet-desc").val();if(!o)return Vt("请输入金额"),!1;if(o>2e3)return Vt("红包限额2000钻石"),!1;if(parseFloat(s)<3)return Vt("最低为3个"),!1;if(o<10)return Vt("最低金额为10钻石"),!1;if(!mm(parseFloat(o))||!mm(parseFloat(s)))return Vt("请输入整数"),!1;if(parseFloat(s)>100)return Vt("最多为100个"),!1;if(!s)return Vt("请输入个数"),!1;{if(o<200&&21==this.roomTypeId)return Vt("最低金额为200钻石"),!1;a||(a="随意玩耍，我买单");const r=window.$(".packet-title li[class='selectedli']").attr("data-selectid");hm(Pt+"/Diamond/sendRed?typeid="+r+"&cid="+t+"&diamond="+o+"&num="+s+"&desc="+a,(function(t){var s=t.error;if(-2==s){let s=t.data.tradeno;const c={typeid:2014,money:s};Hi.payQRCode(c,10*o,(t=>{window.$(".sendPacketModal").hide(),Vt("发送成功！"),i&&i({nickname:e,avatar:n,desc:a,tradeno:s,typeid:r,money:o})}),(()=>'<p class="pay-title">需要支付<span id="pay-needmoney">'+o+"</span> 钻石</p>"))}else if(0==s){window.$(".sendPacketModal").hide(),Vt("发送成功！");let s=t.data.tradeno;i&&i({nickname:e,avatar:n,desc:a,tradeno:s,typeid:r,money:o})}else Vt(t.error_msg)}))}}sendPacketRain(t,e){hm(`${Pt}/Redpacket/rainSend?id=${t}&cid=${e}`,(function(t){0==t.error?(window.$(".sendPacketModal").hide(),Vt("发送成功！")):Vt(t.error_msg)}))}openGrap(t,e,n,i,o){var s,a,r=(a=new RegExp("(^| )"+i+"=([^;]*)(;|$)"),(s=document.cookie.match(a))?unescape(s[2]):null);"yes"==r?this.grapPacket(t,e,n,i,r):(window.$(".grabPacket").attr("nickname",t),window.$(".grabPacket").attr("avatar",e),window.$(".grabPacket").attr("desc",n),window.$(".grabPacket").attr("tradeno",i),window.$(".grabPacket").attr("data-type",0),window.$(".grabPacket").attr("redTypeid",o),window.$(".packet-nickname").text(t),window.$(".ownerPic").attr("src",e),window.$(".ownerpacket-desc").text(n),0==o?window.$(".packetType").text("全部用户红包"):1==o?window.$(".packetType").text("导师红包"):2==o&&window.$(".packetType").text("老板红包"),window.$(".willopenModal").show())}openGrapHunli(t,e,n,i,o){window.$(".willopenModal-hunli").show()}setHunliRed(t,e){const n=e.img_head,i=e.desc,o=e.tradeno,s=e.userinfo,a=e.userinfo2,r='<div class="flex flex-ac flex-dir-col redpack-newren lang">\n                    <div style="position:relative;width:48px;height:48px">\n                        <img class="readpack-new-avatar" src="'+s.avatar+'" />\n                        \n                        <div data-svga="'+n+'" class="redpack-head-svga" style="width:72px;height:72px;position:absolute;top: -12px;left: -12px;"></div>\n                        <div class="redpack-new-tag">新郎</div>\n                    </div>\n                    <p style="color:#FEE53D; margin-top:8px">'+s.nickname+'</p>\n                </div>\n                <div class="flex flex-ac flex-dir-col redpack-newren niang">\n                    <div style="position:relative;width:48px;height:48px">\n                        <img class="readpack-new-avatar" src="'+a.avatar+'" />\n                        \n                        <div data-svga="'+n+'" class="redpack-head-svga" style="width:72px;height:72px;position:absolute;top: -12px;left: -12px;"></div>\n                        <div class="redpack-new-tag">新娘</div>\n                    </div>\n                    <p style="color:#FEE53D;margin-top:8px">'+a.nickname+"</p>\n                </div>";window.$(".redpack-newrens").html(r),window.$(".packetType-hunli").text(i),window.$(".grabPacket-hunli").attr("data-cid",t).attr("data-tradeno",o).attr("data-desc",i),window.$(".redpack-newrens").find(".redpack-head-svga").each((function(){Zt.getInstance().playEver(this,this.dataset.svga,"svga_hunli_redbag")})),window.$(".willopenModal-hunli").show()}grabChannelPacketHunli(t,e="随意玩耍，我买单"){var n=t.data,i=n.list,o=n.money,s=n.giveNum,a=n.totalNum,r=n.giveMoney,c=n.totalMoney,l=[];n.best;for(var d=0;d<i.length;d++){var m="";1==i[d].best&&(m='<div style="color:red">捧花天使</div>'),l.push('<li>\n                            <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\';" src="'+i[d].avatar+'" alt="">\n                            <div class="graperInfo">\n                                <div>'+i[d].name+'</div>\n                                <div style="font-size:12px; color:#999;">'+i[d].time+'</div>\n                            </div>\n                            <div class="graperNum">\n                                <div>'+i[d].money+"钻石</div>"+m+"\n                            </div>\n                        </li>")}window.$(".whospacket-1").text(n.title),window.$(".ownerpacket-desc-1").text(e),window.$(".ownerPic-1").attr("src",n.pic),window.$(".red_packet_unit").html("钻石"),window.$(".failTips").css("display","none"),window.$(".grapAmount").css({fontSize:"34px"}),window.$(".successTips").css("display","block"),window.$(".grapAmount").html(o+"钻石"),window.$(".grapAmount").css("display","block"),window.$(".leftNum").html(s+"/"+a),window.$(".leftMoney").html(c-r+"钻石/"+c),window.$(".whoGrapPacket").html(l.join("")),window.$(".willopenModal").hide(),window.$(".hasopenModal").show()}grabChannelPacket(t){var e=this;hm(Pt+`/Chatroomtask/award?cid=${t}&star=1`,(function(t){if(0==t.error){const{cname:o,avatar:s,record:a,arard_money:r,award_left_money:c,award_num:l,award_left_num:d,rank:m,award:h,uid:u,star:p}=t.data;let g="";for(var n=0;n<a.length;n++){var i="";const{uname:t,rank:e,update_time:o,arard_money:s,avatar:r}=a[n];1==e&&(i='<div style="color:red">人气王</div>'),g+=`<li>\n                                <img onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg';" src="${r}" alt="">\n                                <div class="graperInfo">\n                                    <div>${t}</div>\n                                    <div style="font-size:12px; color:#999;">${o}</div>\n                                </div>\n                                <div class="graperNum">\n                                    <div>${s}钻石</div>`+i+"\n                                </div>\n                            </li>"}window.$(".whospacket-1").text(o),window.$(".ownerpacket-desc-1").text("随意玩耍，我买单"),window.$(".ownerPic-1").attr("src",s),window.$(".failTips").css("display","none"),window.$(".grapAmount").css({fontSize:"34px"}),window.$(".successTips").css("display","block"),window.$(".grapAmount").html(h+"钻石"),window.$(".grapAmount").css("display","block"),window.$(".red_packet_unit").html("钻石"),window.$(".leftNum").html(l+"/"+(d+l)),window.$(".leftMoney").html(c+"/"+(c+r)),window.$(".whoGrapPacket").html(g),window.$(".willopenModal").hide(),window.$(".hasopenModal").show(),e.getMoneyCB&&e.getMoneyCB(h,m,`${p}星钻石`,1)}else Vt(t.error_msg)}))}grapPacket(t,e,n,i,o){var s=this;hm(Pt+"/Diamond/giveRed?token="+i,(function(o){var a,r,c,l,d=o.error;if(0==d||2==d||3==d){for(var m=o.data.list,h=o.data.diamond,u=o.data.giveNum,p=o.data.totalNum,g=o.data.giveDiamond,f=o.data.totalDiamond,w=[],v=o.data.best,_=0;_<m.length;_++){var y="";1==m[_].best&&(y='<div style="color:red">人气王</div>'),w.push('<li>\n                                    <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\';" src="'+m[_].avatar+'" alt="">\n                                    <div class="graperInfo">\n                                        <div>'+m[_].name+'</div>\n                                        <div style="font-size:12px; color:#999;">'+m[_].time+'</div>\n                                    </div>\n                                    <div class="graperNum">\n                                        <div>'+m[_].diamond+"钻石</div>"+y+"\n                                    </div>\n                                </li>")}window.$(".whospacket-1").text(t),window.$(".ownerpacket-desc-1").text(n),window.$(".ownerPic-1").attr("src",e),window.$(".red_packet_unit").html("钻石"),window.$(".failTips").css("display","none"),3==d?(window.$(".grapAmount").css({fontSize:"22px"}),window.$(".grapAmount").html("手速慢了，红包已被抢完了"),window.$(".successTips").css("display","none")):(window.$(".grapAmount").css({fontSize:"34px"}),window.$(".successTips").css("display","block"),window.$(".grapAmount").html(h+"钻石")),window.$(".grapAmount").css("display","block"),window.$(".leftNum").html(u+"/"+p),window.$(".leftMoney").html(f-g+"/"+f),window.$(".whoGrapPacket").html(w.join("")),window.$(".willopenModal").hide(),window.$(".hasopenModal").show(),0==d&&s.getMoneyCB&&s.getMoneyCB(h,v,t,0),a=i,r="yes",c=30,(l=new Date).setTime(l.getTime()+24*c*60*60*1e3),document.cookie=a+"="+escape(r)+";expires="+l.toGMTString()}else-1==d?s.noLoginCB():(window.$(".failTips").text(o.msg),window.$(".failTips").css("display","block"),window.$(".successTips").css("display","none"),window.$(".grapAmount").css("display","none"))}))}};let pm=new Map,gm=new Map;const fm={kapianInterval:0,intervalWave:0,gloabIsBindPhone:0,gloabBindPhone:null,g_musiclist:null,mycarteamChannel:"",isHaveShangGift:!1,globalUid:"",globalOrderType:"",isWithoutChange:!1,isNewUser:!1,gloabJingpaiState:-1,anchorSeatsHistory:[],isChangeRoomUseRequest:!1};class wm{constructor(){this.snabbt=window.snabbt,this.isAnimate=!1,this.giftBox=[],this.bigGiftBox=[]}static getInstance(){return this.instance||(this.instance=new wm),this.instance}init(){const t=this;this.mountEle=window.$(".chat-center-left"),this.boxElement=window.$("#baoboxmessagefly"),this.initStyle(),document.querySelector("#baoboxmessagefly").addEventListener("webkitAnimationEnd",(function(e){window.$(this).removeClass("animation11");null!=t.getJson()&&setTimeout((()=>t.show()),1e3)}))}initStyle(){window.$("head").append("<style>\n\t\t\t\n\t\t\t.baoboxmessage-main p{\n\t\t\t\tmargin:0;\n\t\t\t\tpadding:0\n\t\t\t}\n\t\t\t.baoboxmessage-content{\n\t\t\t\tdisplay:flex;\n\t\t\t\talign-items: center;\n\t\t\t}\n\t\t\t.baoboxmessage-head img{\n\t\t\t\twidth:61px;\n\t\t\t\theight:61px;\n\t\t\t\tborder-radius:100%;\n\t\t\t}\n\t\t\t.baoboxmessage-info{\n\t\t\t\tflex:1;\n\t\t\t\tmargin:0 10px;\n\t\t\t}\n\t\t\t.baoboxmessage-info p{\n\t\t\t\tmargin:3px 0;\n\t\t\t\tcolor:#fff;\n\t\t\t}\n\t\t\t.baoboxmessage-info p font{\n\t\t\t\tcolor:#fff373\n\t\t\t}\n\t\t\t.baoboxmessage-openuser-info{\n\t\t\t\tline-height:0;\n\t\t\t\tdisplay:flex;\n\t\t\t\talign-items:center\n\t\t\t}\n\t\t\t.baoboxmessage-openuser-info span{\n\t\t\t\tmargin-right:5px;\n\t\t\t}\n\t\t\t.baoboxmessage-openuser-info img{\n\t\t\t\theight: 20px;\n\t\t\t}\n\t\t\t.baoboxmessage-info p.baoboxmessage-roomname{\n\t\t\t\tbackground:url(https://res.tuwan.com/templet/play/chat/chatv2/images/roomicon.png) no-repeat 0 center;\n\t\t\t\tpadding-left:18px;\n\t\t\t\tfont-size:12px;\n\t\t\t\tcolor:rgba(255,255,255,0.7);\n\t\t\t}\n\t\t\t.baoboxmessage-gift{\n\t\t\t\tmargin-left:50px;\n\t\t\t}\n\t\t\t.baoboxmessage-gift img{\n\t\t\t\twidth:84px;\n\t\t\t}\n\t\t\t</style>")}createHtml(t){const e=this.getBoxInHtml(t);this.boxElement.html(e)}getBoxInHtml(t){const e=t.avatar,n=t.vipicon,i=t.metal,o=t.toUsername,s=t.diamondnum,a=t.openUsername,r=t.boxType,c=t.roomName,l=t.boxNum,d=t.self,m=t.giftnum,h=t.gifttitle;let u="";""==i||null==i||null==i||"null"==i||"undefined"==i||(u='<span><img src="'+i+'" /></span>');let p="";return 1==d?p="开启 <font>"+r+"x"+l+"</font>获得":0==d?p="<font>赠送</font> "+o+" <font>"+r+"x"+l+"</font>获得":3==d?p=`补满${o}获得 <font>${s}</font>和`:2==d?p=`<font>领取${r}</font>获得 <font>${h}x${l}</font>`:100==d&&(p="<font>赠送</font> "+o),'<div class=\'baoboxmessage-content\'>\n\t\t\t\t\t<div class="baoboxmessage-head">\n\t\t\t\t\t\t<img src="'+e+'" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="baoboxmessage-info">\n\t\t\t\t\t\t<p class="baoboxmessage-openuser-info">\n\t\t\t\t\t\t\t<span><img src="'+n+'" /></span>\n\t\t\t\t\t\t\t'+u+"\n\t\t\t\t\t\t\t<span>"+a+"</span>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t"+p+'\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p class="baoboxmessage-roomname">\n\t\t\t\t\t\t\t'+c+'\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="baoboxmessage-gift">\n\t\t\t\t\t\t<img src="'+t.giftpic+'" /><span style="color:#fff;font-size:26px;margin-left:10px;font-weight:900;">x'+m+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>"}show(){this.boxElement.addClass("animation11")}add(t){if(1==t.queue?(this.bigGiftBox.push(t),this.bigGiftBox.sort(((t,e)=>e.giftprice-t.giftprice))):this.giftBox.push(t),!this.isAnimate){this.isAnimate=!0;null==this.getJson()?this.isAnimate=!1:this.show()}}getJson(){let t=null;if(this.bigGiftBox.length>0?t=this.bigGiftBox.shift():this.giftBox.length>0&&(t=this.giftBox.shift()),null==t)return this.isAnimate=!1,t;const e=this.getBoxInHtml(t);return this.boxElement.html(e),t}play(){null!=this.getJson()?this.show():this.isAnimate=!1}clear(){this.bigGiftBox=[],this.giftBox=[]}}function vm(t){if(uu.isJiamianRoom()||uu.isSpecialSongRoom())return;const e=t.data,n=t.cid;if(0==n||n==uu.getCid()){if(document.hidden)return;const{userinfo:t,giftUsername:n,boxname:i,diamondnum:o,gift:s,chatname:a,boxnum:r,self:c,giftnum:l,queue:d}=e,{avatar:m,vipicon:h,medal:u,nickname:p}=t,{pic:g,title:f,diamond:w}=s;wm.getInstance().add({avatar:m,vipicon:h,metal:u,openUsername:p,toUsername:n,boxType:i,diamondnum:o,giftpic:g,gifttitle:f,giftprice:w,roomName:a,boxNum:r,self:c,giftnum:l,queue:d||0})}}let _m=null;function ym(t){const e=t.data,n=e.uid,i=e.show_type,o=e.brand_url_v2||"",s=e.is_show,a={uid:n,nickname:e.nickname||"游客"+n,medal:e.medal,vipicon:e.vipicon,color:e.color||"#666",avatar:e.avatar||"https://uc.tuwan.com/images/noavatar_1.jpg",vip:e.playvip||0,teacher:e.teacher||0,dtid:e.services||[],share_nickname:e.share_nickname||"",share_desc:e.share_desc||"",share_color:e.share_color||"#666",name_color:(e.color?e.color:e.name_color)||"#666",brand_url:o};1==uu.roomInfo.at&&e.nickname&&(fe.getInstance().joinUser.push({name:e.nickname,uid:n,avatar:e.avatar}),fe.getInstance().onActionJoin()),function(t){let e="",n="";const i=t.uid;t.medal,i<Mt.maxUID&&(e='&nbsp;<img class="iconvip" src="'+t.vipicon+'" />&nbsp;');t.brand_url&&(e+='&nbsp;<img class="iconvip" src="'+t.brand_url+'" />&nbsp;');let o="",s=t.name_color;"#ffe14c"==s?(o="ygb_title",s=""):uu.isCanWhiteFont()?s="#ccc":"#666"!=s||!uu.isTempCarteamRoom()||uu.isTruthSmallRoom()||uu.isLoveTempRoom()||uu.isVideoTempRoom()||(s="#ccc");let a="";a=t.share_nickname?'<div class="flex getredbag-message" style="margin:10px 0;">\n                                <div account="'+i+'" class="flex welcome-get-message" style="align-items: center;color:'+(uu.isMusicTempRoom()?"#ccc":"#999")+'">'+e+n+`${t.share_desc.replace("window.$1",`<span class="${o}" style="color:${t.name_color}">${Ct.replaceGuan(t.nickname)}</span>`).replace("window.$2",`<span style="color:${t.share_color}">${Ct.replaceGuan(t.share_nickname)}</span>`)}</div>\n                            </div>`:'<div class="flex getredbag-message" style="margin:10px 0;">\n                                <div account="'+i+'" class="flex welcome-get-message" style="align-items: center;color:'+(uu.isMusicTempRoom()?"#ccc":"#999")+'">欢迎'+e+n+"<span>"+Ct.replaceGuan(t.nickname)+"</span>进入房间</div>\n                            </div>";kd.appendMessage(a)}(a),function(t,e,n){const i=uu.getChannel(),o=uu.getMeid();if(t!=o)if(uu.isTempCarteamRoom());else{1==uu.getRoomInfo().party_set.listshow&&(n?(he.addChannelUser(i,n,!0,uu.roomInfo.cap_role),bt.addUserInfo(n)):qt.getUserInfo(t,"channelUserJoinedCB").then((t=>{he.addChannelUser(i,t,!0,uu.roomInfo.cap_role)})))}}(n,0,a);const r=uu.getRoomInfo().party_set;if(r){const t=r.gif_uids.map((t=>1*t)),e=uu.getMeid();if(t&&t.includes(1*e))return}if(!(Si.getInstance().getFullScreenStatus()||Ti.getInstance().getFullScreenStatus()||Mi.getInstance().getFullScreenStatus()||uu.isCocosH5Room()||document.hidden||1!=s)){const t=e.svga_pc,o=e.vap_pc_url;if(""==t&&""==o)document.hidden||function(t){const e=t.uid;if(window.$(".boss-comein-"+t.uid).length>0)return;let n=uu.nameFormat(t.nickname);t.vip<5?window.$("#bossComein").prepend('<div class="flex boss-comein-'+e+' boss-comein-item boss-comein-item-low"><div class="boss-comein-item-low-content"><img class="border_this"  onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+t.avatar+'">'+n+"<span>进入房间</span></div></div>"):t.vip<8?window.$("#bossComein").prepend('<div class="flex boss-comein-'+e+' boss-comein-item boss-comein-item-middle"><img  onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" class="middle-avatar" src="'+t.avatar+'"><img class="middle-level" src="'+t.vipicon+'" />'+n+"<span>进入房间</span></div>"):window.$("#bossComein").prepend('<div class="flex boss-comein-'+e+' boss-comein-item boss-comein-item-height"><img  onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" class="height-avatar" src="'+t.avatar+'"><img class="height-level" src="'+t.vipicon+'" />'+n+"<span>进入房间</span></div>");window.$(".boss-comein-"+e).animate({opacity:1},200,(function(){setTimeout((function(){window.$(".boss-comein-"+e).animate({opacity:0},200,(function(){window.$(".boss-comein-"+e).remove()}))}),5e3)}))}(a);else{_m||(_m=new Zt(window.SVGA));const o=(new Date).getTime();let s,a;0==i?(s="bosscomein_"+n+"_"+o,a=window.$('<div class="bosscomein-new" id="'+s+'"></div>'),window.$("#bossComeinNew").append(a)):1==i&&(s="svga"+o,a=window.$('<div id="'+s+'" class="canvassvga-fullscreen" data-type="bosscommin"></div>'),window.$("body").append(a));const r=document.querySelector("#"+s);_m.addComin({svgaele:r,vapele:r,path:t,attrs:e.attr,clearsAfterStop:!0,vap_pc_url:e.vap_pc_url,vap_pc_config:e.vap_pc_config})}}}function xm(){const t=navigator.userAgent.toLowerCase().match(/(chrome).*?([\d.]+)/);if(t){const e=t[2].split(".")[0];parseInt(e)<60&&window.$(".preinfotips").show()}}function bm(t){1==t?uu.globalRtcClient.publish():uu.globalRtcClient.unpublish()}function $m(t){uu.globalRtcClient.muteLocalAudio(t)}function km(t,e,n){window.$("#yaoqingsm_new .item[account='"+e+"']").length>0||("none"==$("#yaoqingsm_new").css("display")&&$('.seat-item-empty[data-aposition="2"]').data().uid==uu.getMeid()&&$("#yaoqingsm_new").show(),window.$("#yaoqingsm_new .listCtn").prepend('<div class="item yqshangmai-item" account="'+e+'">\n                <div class="leftCtn">'+t+'</div>\n                <div class="rightCtn">\n                    <span class="agree btn active" data-status="1" position="'+n+'" account="'+e+'">接受</span>\n                    <span class="reject btn" data-status="2" account="'+e+'">拒绝</span>\n                </div>\n            </div>'),qt.get(Ot.getCanSearchCidList()).then((t=>{(t.data.list||[]).findIndex((t=>t==uu.getCid()))>=0?$("#yaoqingsm_new .limitCtn").show():($("#yaoqingsm_new .limitCtn").hide(),$("#yaoqingsm_new .limitCtn .checkCtn").removeClass("active"))})))}function Cm(t,e){const n=kd.Type;new Promise(((t,e)=>{qt.get(Ot.getOrderRoomList()).then((n=>{if(0==n.error){const e=n.data;if(e&&e.length>0){const n=[];for(let t=0;t<e.length;t++){const i=e[t],o=i.id,s=i.channel,a=i.num,r=i.title;n.push('<option data-cid="'+o+'" data-channel="'+s+'" value="'+s+'" style="color:'+(a>0?"red":"#000")+'">'+r+"("+a+"人)</option>")}t(n.join(""))}}else e(n.error_msg)}))})).then((i=>{window.$.DialogByZ.Confirm({Title:"请选择要加入的房间",Content:'\n\t\t\t\t<div>\n\t\t\t\t\t<select id="selectChannelJoin">\n\t\t\t\t\t\t'+i+"\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t",BtnL:"取消",BtnR:"确定",FunL:function(){Im(uu.getCid(),0,t,uu.getMeid(),e),window.$.DialogByZ.Close()},FunR:function(){const i=uu.getCid();qt.get(Pt+"/Chatroom/holding?cid="+i+"&uid="+t).then((i=>{if(0==i.error){const i=window.$("#selectChannelJoin option:selected");if(i.length>0){const o=i.get(0).dataset,s=o.channel,a=o.cid,r=1,c=kd.messageFormat(n.gochat,t,s,r,a);Qd(t,c),window.$.DialogByZ.Close();const l=uu.getMeid(),d=uu.getCid();em(-1,d,t),setTimeout((function(){ou(a,(function(){window.$(".boss-will .boss_"+t).remove(),window.$(".chat-center-message .boss_"+t).remove()}))}),1e3),Im(d,1,t,l,e)}}else Rd(i.error_msg)}))}})}))}function Im(t,e,n,i,o){const s="?cid="+t+"&success="+e+"&uid="+n+"&teacherid="+i+"&platforms="+o;(new Image).src=Pt+"/Chatroom/clickOrderLog/"+s}function Sm(t){const e=t.max_num,n=t.now_num;let i=n>=e?"100%":100*(n/e).toFixed(2)+"%";window.$(".room-buttons").find(".select_heart").css("height",i)}function Tm(){return uu.getRoomInfo().typeid}async function Rm(t){const e=Zt.getInstance();e.loadParser("#newBannerSvga",t,0,!1).then((t=>{const{videoItem:n,player:i}=t;i.setVideoItem(n),i.startAnimation(),i.setContentMode("AspectFill"),e.playersMap.set("svga_banner",i)}),(t=>{}))}function Mm(){uu.getMeid()>Mt.maxUID?du():window.ysf("open")}function Am(){if(window.$(".play-again-conatiner").addClass("hide"),0==uu.roomInfo.game_type&&1!=uu.roomInfo.fleet_type&&1==uu.roomInfo.is_hall_captain&&uu.isAnchoringUser(uu.getMeid())&&5!=uu.roomInfo.live&&6!=uu.roomInfo.live)if([16].includes(uu.getRoomInfo().live)){let t=$($(".play-again-conatiner")[0]).clone();t.removeClass("hide"),$(".centerBtnGroupCtn").append(t[0])}else window.$(".play-again-conatiner").removeClass("hide")}function Pm(t,e){if(!e)return;if(0==t||t>Mt.maxUID)return;const n=uu.getMycarData();if(n){n.persons.has(t)&&uu.globalRtcClient.subscribe(e)}}function jm(){const t=uu.getRoomInfo(),e=t.socketDomain,n=t.socketPort,i=uu.getMeid();let o="";o=""==n?"wss://"+e:"wss://"+e+":"+n;const s=t.time,a=t.socketToken;uu.globalDDSocket.connect(o,i,s,a)}function Dm(){qt.get(Ot.getMoney()).then((t=>{const e=t.money,n=t.number,i=t.number_show,o=t.diamond;window.$("#font-my-crystal").text(Ct.getFormatMoney(n)).attr("data-value",n),window.$("#font-my-diamond").text(Ct.getFormatMoney(o)).attr("data-value",o),window.$("#font-my-yue").text(Ct.getFormatMoney(e,2)).attr("data-value",(1*e).toFixed(2)),1==i?$(".font-my-crystal-content").css("display","flex"):$(".font-my-crystal-content").hide(),0!=e&&$(".gift-my-money-content").css("display","flex");let s=uu.getSelfInfo();s.money=e,s.diamond=o,s.number=n,bt.setSelfUser(s)}))}function Lm(t,e,n){qt.get(Et+"/Agora/ban?uid="+e+"&typeid=2&time=1&cid="+uu.getCid()).then((i=>{if(0==i.error){const i=kd.messageFormat(t,n);Qd(e,i)}else Rd(i.error_msg)}))}function Em(t,e,n){qt.get(Ot.kicking(uu.getChannel(),e)).then((i=>{if(0==i.error){const i=kd.messageFormat(t,n);Qd(e,i),Hd(e,uu.getCid(),-1);const o=uu.getInCarTeamUsers();let s=null;o.forEach((t=>{s=t.find((t=>t.uid==e))})),null!=s&&1==s.position&&Bm()}else Rd(i.error_msg)}))}function Bm(t,e=!1){const n=kd.Type,i=uu.getRoomInfo().pchannel,o=uu.getCid(),s=uu.getRoomInfo().socketPort,a=uu.isDrawTempRoom()?1:0;let r=uu.getAnchorKengUsers();const c=uu.roomInfo.ptype,l=uu.roomInfo.pcid;if(!uu.isDrawTempRoom())for(let m of r.keys()){Qd(m,kd.messageFormat(n.gochat,m,i,c,l))}const d=e?Ot.backFleet(uu.getCid()):Ot.dismissFleet(o,s,a);qt.get(d).then((t=>{const e=t.error,n=t.error_msg;0==e||(9==t.error?window.$.DialogByZ.Confirm({Title:"提示",Content:n,BtnL:"取消",BtnR:"确定",FunL:function(){qt.get(Ot.dismissFleet(o,s,a,0)),window.$.DialogByZ.Close()},FunR:function(){qt.get(Ot.dismissFleet(o,s,a,1)),window.$.DialogByZ.Close()}}):Rd(n))}))}function Fm(t){return new Promise(((e,n)=>{qt.get(Pt+"/Chatroom/getCid?channel="+t).then((t=>{0==t.error?e(t.cid):n(0)}))}))}async function Um(t){qt.get(Pt+"/Chatroom/checkCollect?cid="+t).then((t=>{if(0==t.error){1==t.collect?(window.$(".chatroom-guanzhu").addClass("current"),window.$(".chatroom-guanzhu .textCtn").text("已关注")):(window.$(".chatroom-guanzhu").removeClass("current"),window.$(".chatroom-guanzhu .textCtn").text("关注")),window.$(".chatroom-guanzhu").css("display","flex")}}))}function zm(t){const e=uu.getCid();qt.get(Pt+"/redpacket/getChatroomListV2?cid="+e+"&page=1&format=jsonp").then((e=>{const n=e.error;if(t&&t(),0==n){const t=e.data;if(t.length>0){let e=[];for(let n=0;n<t.length;n++){let i=t[n],o=i.title,s=i.uname,a=i.best_uname,r=i.ctime,c=i.num,l=i.best_uid,d=i.use_num,m=(i.best_money/100).toFixed(2),h=(i.money/100).toFixed(2),u="";u=0==l?'<p class="redpacket-jilu-wang redpacket-jilu-no-wang">还剩 '+d+"个 未领取</p>":'<p class="redpacket-jilu-wang">'+a+'<span style="color:#666">领取了</span>'+s+'<span style="color:#666">的红包</span>('+m+"点点币), 成为人气王</p>",e.push('<li>\n                                        <p class="redpacket-jilu-title">'+o+"</p>\n                                        "+u+'\n                                        <p class="redpacket-jilu-info"> '+h+"点点币 /"+c+"人  发布时间："+r+"</p>\n                                    </li>")}window.$(".redpacket-jilu-content .redpacket-jilu-list ul").html(e.join(""))}else window.$(".redpacket-jilu-content ul").html('<li style="text-align:center; color:#999;">暂无数据</li>')}else{const t=e.error_msg;window.$(".redpacket-jilu-content ul").html('<li style="text-align:center; color:#999;">'+t+"</li>")}}))}async function Om(t){(function(t){return new Promise(((e,n)=>{if(uu.isTempCarteamRoom())e(null);else{let n="";if(uu.getCid()==t){const e=uu.getMeid();n=Pt+"/Chatroom/getChatUserList?cid="+t+"&format=jsonp&uid="+e}else n=Pt+"/Chatroom/getChatUserList?cid="+t+"&format=jsonp&uid=0";qt.get(n).then((t=>{e(t)}))}}))})(t).then((t=>{if(null!=t)if(0==t.error){const e=t.data||[];e.map((t=>String(t))).includes(String(uu.getMeid()))||e.push(uu.getMeid()),function(t,e){const n=uu.getChannel();he.addChannelUsers(t,n,uu.roomInfo.anchor_ids,uu.roomInfo.waiter_ids,uu.roomInfo.cap_role),(uu.isAutoRoom()||uu.isShengyouFreeRoom()||uu.isBattleRoom())&&function(t){const e=uu.getCid();qt.get(Ot.getFleetUsers(e,0,uu.roomInfo.fleet_type)).then((t=>{if(0==t.error){t.pcid;!async function(t,e,n=0,i=null){const o=uu.getMeid();if(t.includes(o)&&1==n&&!uu.isTempCarteamRoom()){if(uu.isMyCarDuiZhang(uu.getMeid())){let n="";t.map((t=>{t!=uu.getMeid()&&(n+=uu.getMycarInfoForUid(t).nickname+"、")})),de.getInstance().show("提示",n+"正在您的车上,快去服务他吧。",!1,"","进入车队",(()=>{""!=e&&(fm.mycarteamChannel=e,Nm(uu.getMeid()))}))}else{const t=uu.getMycarInfoForUid(uu.getMycarDuizhangUid());de.getInstance().show("提示","您正在"+t.nickname+"队长的车里,进入车队？",!1,"离开车队","进入车队",(()=>{""!=e&&(fm.mycarteamChannel=e,Nm(uu.getMeid()))}),(()=>{if(null!=i){const t=uu.getMycarData().fid;tm(uu.getMycarInfoForUid(uu.getMeid()).position,uu.getMeid(),uu.getCid(),t,1)}else de.getInstance().hide()}))}return}const s="我的车队";(uu.isAutoRoom()||uu.isShengyouFreeRoom()||uu.isBattleRoom())&&(t.includes(o)&&""!=e?(fm.mycarteamChannel=e,ci.show(1,ci.type.myteam,s),ci.hide(2),ci.hide(3)):"发车"!=window.$(".carauto-create").text()&&"退出车队"!=window.$(".carauto-create").text()&&window.$(".carauto-create").text("创建车队"))}(t.data.map((t=>1*t)),t.channel,t.fleet_type,t)}}))}()}(e)}else Rd(t.error_msg)}))}function Nm(t){if(""!=fm.mycarteamChannel){const e=uu.getChannel();qm(e,((n,i,o)=>{if(n.includes(t+"")||n.includes(t))Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",e),ou(o);else{fm.mycarteamChannel="";const t="创建"+uu.getCarButtonStr();ci.show(1,ci.type.creatteam,t),Rd("您的小队已经解散")}}))}}function qm(t,e){const n=uu.getCid();qt.get(Ot.getFleetUsers(n,0,uu.roomInfo.fleet_type)).then((t=>{if(0==t.error){const n=t.data,i=t.channel;e(n,i,t.pcid)}}))}function Gm(t,e,n){const i=uu.getCid();qt.get(Ot.songOrder(e,i,t)).then((t=>{0==t.error?(Vt("点歌成功"),window.localStorage.setItem("musiclist_click",n)):Vt(t.error_msg)}))}function Vm(){const t=5==uu.roomInfo.typeid?0:uu.getMycarFid();qt.get(Ot.getInviteUserList(t,uu.getCid())).then((t=>{0==t.error?(window.$(".invite-modal").removeClass("hide"),window.$(".invite-modal-container").empty(),t.data.length>0?(t.data.map((t=>{t.age=0==t.age?"":t.age;const e=t.age?6:2,n=1==t.sex?'<span class="sex sex-man" style="padding: 0 '+e+'px;">♂ '+t.age+"</span>":'<span class="sex sex-girl" style="padding: 0 '+e+'px;">♀ '+t.age+"</span>";window.$(".invite-modal-container").append('<div class="invite-modal-item-container flex flex-ac">\n                                    <div class="invite-modal-avatar">\n                                        <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\';" data-src="'+t.avatar+'" src="https://uc.tuwan.com/images/noavatar_1.jpg">\n                                    </div>\n                                    <div class="flex flex-dir-col flex-1 invite-modal-info-context">\n                                        <div class="invite-modal-name">'+t.nickname+n+' </div>\n                                        <div><img style="height:18px;" src="'+t.vipicon+'"></div>\n                                    </div>\n                                    <div class="invite-modal-invite-button flex flex-ac flex-jc" data-uid="'+t.uid+'">邀请</div>\n                                </div>')})),window.lazyload(window.$(".invite-modal-avatar img"))):window.$(".invite-modal-container").append('<div class="invite-modal-empty flex flex-dir-col flex-ac flex-jc">\n                                        <img src="https://asset.tuwan.com/chatroom/images/icon_empty.png"/>\n                                        <span>新朋友还未到，多来看看哦~</span>\n                                    </div>')):(Vt(t.error_msg),window.$(".invite-modal").addClass("hide"),window.$(".invite-modal-container").empty())}))}function Hm(t,e){uu.getMeid()>Mt.maxUID?du():qt.get(Ot.joinMeeting(t,e)).then((n=>{if(0==n.error||4==n.error){window.$(".meeting-mask").css("display","flex");let n=`https://y${isChatTest?"-test":""}.tuwan.com/meeting?id=${t}&groupId=${e}`;setTimeout((function(){window.$(".meeting-mask").find("iframe").attr("async",!0),window.$(".meeting-mask").find("iframe").attr("defer",!0),window.$(".meeting-mask").find("iframe").attr("src",n)}),100),uu.globalRtcClient.leave(),uu.globalDDSocket.leave(),uu.globalDDSocket.close()}else Vt(n.error_msg)}))}async function Wm(t,e,n){const i={type:t,giftid:e.giftid,uid:e.uid,teacherid:Array.isArray(e.teacherid)?JSON.stringify(e.teacherid):e.teacherid,cid:uu.getCid(),selfuid:e.selfuid,url:e.url||""};n&&(i.msg=encodeURIComponent(JSON.stringify(n)));let o=[];for(let s in i)o.push(s+"="+i[s]);(new Image).src="https://report.tuwan.com/v.gif?"+o.join("&")}function Km(t,e,n="#666",i,o,s){let a=Wo.getInstance();if(o=o||0,null==i&&(i=a.currentTab),"none"!=window.$(".chat-center-gift-content").css("display"))window.$(".chat-center-gift-content").hide();else{a.resetInputGiftCount(),3==i||7==i?a.getBaoguo(o,i):a.getGiftsNew(uu.getCid(),o,s,i);uu.getSelfInfo().teacher&&window.$(".gift-my-money-content").css("display","flex"),window.$(".chat-center-gift-content").css("display","flex"),kd.chatGiftTeachersList(t,e,n,uu.getChannel()),window.$(".chat-emoji-list").hide()}uu.getMeid()<Mt.maxUID&&Dm()}class Ym{constructor(){this.stage_list=[],this.actData={},this.inited=!1,this.extra_data={},this.successData={},this.timer=null,this.timeStart=!1,this.emitter=new Ht,this.leaveTimer=null,this.initEvents()}static getInstance(){return this.instance||(this.instance=new Ym),this.instance}onReset(){this.inited=!1,this.timeStart=!1,clearInterval(this.timer),clearInterval(this.leaveTimer),this.emitter.off("showGiftWindow",Km),this.emitter.off("leaveRoom",ou),window.$(".room-seats-main").html(""),window.$(".marry_mask").remove()}loadRoomStage(t){this.emitter.on("showGiftWindow",Km),this.emitter.on("leaveRoom",ou),window.$(".room-seats-main").html(Fi.initMarryRoomSeatHtml(t)),this.initStyle(),this.initHtml()}initStyle(){window.$("head").append("<style>\n                        .marry_flex{display:flex}\n                        .marry_flex_c{display:flex;align-items:center;justify-content:center;}\n                        .marry_flex_sb{display:flex;align-items:center;justify-content:space-between;}\n                        .marry_text_over{overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}\n                        .marry_main{height:450px}\n                        .host_seats_content{position:absolute;top:40;left:-190px}\n                        .marry_host_btn{position:absolute;left:-126px;display:none;height:142px;top:-38px;justify-content: flex-end;}\n                        .marry_host_btn_item{width:122px;height:34px;border-radius:17px;background:rgba(255,255,255,.3);color:#fff;cursor: pointer;margin:0 0 10px}\n                        .marry_next_stage{display:none}\n                        .couple_seats{position:relative;width:284px;margin:0 auto;padding-top:60px}\n                        .couple_heart{width:61px;height:55px;margin-top:18px}\n                        .marry_common_seats_content{margin-top:20px}\n                        .marry_common_seats{width:260px;height:260px;flex-wrap:wrap}\n                        .marry_que{position:relative;width:284px;height:248px;color:#fff;font-size:14px;box-sizing:border-box;padding:18px;background:url(https://asset.tuwan.com/activity/marry/que_bg.png?v=1);background-repeat:no-repeat}\n                        .marry_title{font-size:16px;text-align:center}\n                        .marry_desc{line-height:24px;margin-top:4px;}\n                        .marry_extra{margin-top:6px;cursor: pointer;}\n                        .marry_extra_item{display:none}\n\n                        /* 猜唇印 */\n                        .marry_guess_item{position:relative;width:40px;height:40px;background:#fff;border-radius:6px;margin:0 2px;overflow:hidden}\n                        .marry_guess_pic{width:100%;height:100%}\n                        .marry_guess_status{position:absolute;width:12px;height:12px;bottom:2px;right:2px}\n                        .open_guess_modal{position:absolute;bottom:20px;width:242px;height:32px;line-height:32px;text-align:center;cursor: pointer;}\n                        .open_guess_modal.normal{background: url(https://asset.tuwan.com/activity/marry/btn_bg_1.png?v=1);color:#fee6ff}\n                        .open_guess_modal.groom{background: url(https://asset.tuwan.com/activity/marry/btn_bg.png);color:#fff}\n\n                        /* 你说我猜 */\n                        .marry_guess_word,.marry_bless{position:absolute;bottom:20px;width:242px;height:32px;line-height:32px;text-align:center;cursor: pointer;background: url(https://asset.tuwan.com/activity/marry/btn_bg_1.png?v=1);color:#fee6ff;padding:0 10px;box-sizing:border-box}\n                        .marry_bless{padding:0 5px 0 10px}\n\n                        /* 收集祝福 */\n                        .marry_bless_btn{width:60px;height:24px;line-height:24px;background:url(https://asset.tuwan.com/activity/marry/bless.png?v=2);font-size:14px;color:#fff;cursor: pointer;}\n\n\n                        /* 大圣娶亲公共弹窗 */\n                        .marry_common_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .marry_close{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_close.png) no-repeat center center;right: 4px;top: 10px;cursor: pointer;}\n                        .marry_common_content{position:relative;width:430px;background:#fff;border-radius:10px;text-align:center;padding:30px 25px 40px}\n                        .marry_common_title{color:#666666;font-size:24px;line-height:1}\n                        .marry_common_desc{color:#999999;font-size:14px;margin-top:10px;line-height:1}\n\n                        /* 情侣上麦弹窗 */\n                        .marry_couple_content{flex-wrap:wrap;max-height:370px;margin-top:30px}\n                        .marry_couple_item{width:210px;flex-direction: column;margin-bottom:20px}\n                        .marry_couple_item_detail{position:relative;width:105px;}\n                        .marry_couple_item_avatar{width:90px;height:90px;border-radius:50%}\n                        .marry_couple_item_tag{width:32px;height:16px;border-radius:6px;background:#f459a3;color:#fff;font-size:12px;line-height:16px;margin:-10px auto 0}\n                        .marry_couple_item_name{width:100%;color:#666;font-size:14px;margin-top:6px;}\n                        .marry_couple_item_isonline{display:none;position:absolute;top:0px;right:-2px;background:#999999;margin:0}\n                        .couple_item_btn{width:182px;height:40px;border-radius:20px;color:#fff;line-height:40px;background:#ff6691;font-size:18px;margin-top:10px;cursor: pointer;}\n                        .couple_item_btn.disable{color:#fff;line-height:40px;background:#ffb2c8;}\n\n                        /* 猜唇印弹窗 */\n                        .marry_guess_content{flex-wrap:wrap;margin-top:20px;align-items:center;justify-content:space-between;}\n                        .marry_modal_guess_item{position:relative;width:136px;height:136px;background:#f6f6f6;border-radius:10px;margin-bottom:20px;cursor: pointer;box-sizing:border-box;overflow:hidden}\n                        .marry_modal_guess_item.active{border:2px solid #ffb0c6}\n                        .marry_modal_guess_item .marry_modal_guess_item_pic{width:136px;height:136px;}\n                        .marry_modal_guess_status{position:absolute;with:30px;height:30px;bottom:5px;right:5px}\n                        .marry_modal_guess_btn{width:244px;height:40px;border-radius:20px;color:#fff;line-height:40px;background:#ff6691;margin:0 auto;cursor: pointer;}\n\n                        /* 闯关完成确认弹窗 */\n                        .marry_finish_content{margin-top:20px;}\n                        .finish_couple_content{margin:0 auto}\n                        .finish_couple_heart{width:33px;height:29px;margin:0 10px}\n                        .marry_finish_btn{font-size:18px;color:#7d7d7d;background:#e0e0e0;width:156px;height:40px;margin:20px 10px 0;line-height:40px;border-radius:20px;cursor: pointer;}\n                        .marry_finish_sure{color:#fff;background:#ff6691}\n\n                        /* 闯关成功通知弹窗 */\n                        .marry_success_content{position:relative}\n                        .marry_success_svga{width:380px;height:388px;margin:20px auto 0}\n                        .marry_success_couple{text-align:center;font-size:14px;margin-top:-15px;justify-content:center;}\n                        .marry_success_couple_detail{position:relative;width:150px}\n                        .marry_success_couple_avatar{position:relative;width:70px;height:70px;margin:0 auto}\n                        .marry_success_couple_avatar img{width:70px;height:70px;border-radius:50%;}\n                        .marry_success_couple_heart{width:52px;height:47px;margin:14px -20px}\n                        .marry_success_common_svga{position:absolute;width:130%;height:130%;left: 50%;top: 50%;transform: translate(-50%, -50%);}\n                        .marry_success_couple_name{width:100%;color:#fff;margin-top:6px;line-height:18px;}\n                        .marry_success_btn{width:245px;height:40px;background:url(https://asset.tuwan.com/activity/marry/success_bless.png?v=1);font-size:18px;color:#fff;line-height:40px;text-align:center;cursor: pointer;margin:10px auto 0}\n                        .marry_success_couple_gift{display:none;text-align:center;color:#fff;}\n                        .marry_success_couple_gift_list{margin:10px auto 0;justify-content: center;}\n                        .marry_success_couple_gift_item{width:85px;margin:0;font-size:14px;}\n                        .marry_success_couple_gift_pic{width:70px;height:70px;background:url(https://asset.tuwan.com/activity/marry/gift_bg.png);background-size:100% 100%;margin:0 auto;}\n                        .marry_success_couple_gift_pic_item{max-width:90%;max-height:90%}\n                        .marry_success_couple_title{width:228px;height:41px;}\n                        .marry_success_couple_close{position: absolute;width: 40px;height: 40px;background: url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png) no-repeat center center;right: 0;top: 0;cursor: pointer;z-index:100}\n                    </style>")}initHtml(){window.$("body").append('<div class="marry_mask marry_common_mask">\n                        <div class="marry_common_content">\n                            <div class="marry_close marry_common_close"></div>\n                            <div class="marry_common_title"></div>\n                            <div class="marry_common_desc"></div>\n                            <div class="marry_couple_content scroll marry_common_item"></div>\n                            <div class="marry_guess_content marry_common_item"></div>\n                            <div class="marry_finish_content marry_common_item"></div>\n                        </div>\n                    </div>\n                    <div class="marry_success_mask marry_common_mask">\n                        <div class="marry_success_content">\n                            <div class="marry_success_couple_close"></div>\n                            <div class="marry_success_svga"></div>\n                            <div class="marry_success_couple marry_flex"></div>\n                            <div class="marry_success_couple_gift">\n                                <img  class="marry_success_couple_title" src="https://asset.tuwan.com/activity/marry/gift_title.png">\n                                <div class="marry_success_couple_gift_list marry_flex"></div>\n                            </div>\n                            <div class="marry_success_btn"></div>\n                        </div>\n                    </div>')}initMarryStageSocket(){if(this.inited)return;const t={cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid};uu.globalDDSocket.send("initWeddingStage",t),uu.globalDDSocket.send("orderlist",t),uu.globalDDSocket.send("queuelist",t),this.inited=!0}renderStageData(t){const{stage:e,stage_type:n,title:i,desc:o,button_title:s,button_title2:a,extra_data:r}=t;this.actData=t,this.extra_data=r,window.$(".marry_extra_item").hide(),window.$(".marry_operate").html(s),window.$(".marry_reset").html(a),window.$(".marry_title").html(i),window.$(".marry_desc").html(o),0==e&&this.timer&&(clearInterval(this.timer),this.timeStart=!1),2==n?(window.$(".marry_next_stage").hide(),this.renderGuessData(r),window.$(".marry_que").css("background-image","url(https://asset.tuwan.com/activity/marry/que_bg_2.png)")):3==n?(this.renderWordData(r),window.$(".marry_que").css("background-image","url(https://asset.tuwan.com/activity/marry/que_bg_2.png)")):4==n?(uu.getMeid()==t.groom_uid?window.$(".marry_bless_btn").text("红包"):window.$(".marry_bless_btn").text("祝福"),window.$(".marry_next_stage").hide(),window.$(".marry_bless").css("display","flex"),window.$(".marry_bless_num span").html(r.num),window.$(".marry_que").css("background-image","url(https://asset.tuwan.com/activity/marry/que_bg_2.png)")):(window.$(".marry_next_stage").hide(),window.$(".marry_que").css("background-image","url(https://asset.tuwan.com/activity/marry/que_bg.png?v=1)"))}btnOperate(){qt.get(`${At}/wedding/nextStep?cid=${uu.getCid()}`).then((t=>{0==t.error&&t.data?1==t.data.type?this.renderCoupleList(t.data.list):2==t.data.type&&this.renderFinish(t.data):Vt(t.error_msg)}))}renderFinish(t){window.$(".marry_common_item").hide(),window.$(".marry_finish_content").show(),window.$(".marry_mask").css("display","flex"),window.$(".marry_common_title").html(t.content),window.$(".marry_common_desc").html("");let e=`<div class="finish_couple_content marry_flex_c">\n                        ${this.renderCoupleInfo(t.bride_info,0)}\n                        <img class="finish_couple_heart" src="https://asset.tuwan.com/activity/marry/heart_1.png">\n                        ${this.renderCoupleInfo(t.groom_info,1)}\n                    </div>\n                    <div class="marry_finish_btn_content marry_flex_c">\n                        <div class="marry_common_close marry_finish_btn">取消</div>\n                        <div class="marry_finish_sure marry_finish_btn">确认</div>\n                    </div>`;window.$(".marry_finish_content").html(e)}renderCoupleList(t){window.$(".marry_common_item").hide(),window.$(".marry_couple_content").css("display","flex"),window.$(".marry_mask").css("display","flex"),window.$(".marry_common_title").html("新郎新娘"),window.$(".marry_common_desc").html("点击邀请上麦可直接将用户抱到新郎新娘位");let e="";for(let n=0,i=t.length;n<i;n++){const i=t[n];let o="",s="";1==i.status?s="邀请上麦":2==i.status?(o="disable",s="正在闯关"):3==i.status&&(o="disable",s="已结束"),e+=`<div class="marry_couple_item marry_flex_c">\n                        <div class="marry_couple_item_info marry_flex_sb">\n                            ${this.renderCoupleInfo(i.bride_info,0)}\n                            ${this.renderCoupleInfo(i.groom_info,1)}\n                        </div>\n                        <div class="couple_item_btn ${o}" data-status="${i.status}" data-id="${i.id}">${s}</div>\n                    </div>`}window.$(".marry_couple_content").html(e)}renderCoupleInfo(t,e){return`<div class="marry_couple_item_detail">\n                        <img class="marry_couple_item_avatar" src="${t.avatar}">\n                        <div class="marry_couple_item_tag">${0==e?"新娘":"新郎"}</div>\n                        <div class="marry_couple_item_name marry_text_over">${t.nickname}</div>\n                        <div class="marry_couple_item_isonline marry_couple_item_tag" style="display:${0==t.is_online?"block":"none"}">离线</div>\n                    </div>`}renderGuessData(t){window.$(".marry_guess_lips").show();const{list:e,guess_status:n}=t;let i='<div class="marry_guess_lips_content marry_flex_c">',o="",s="";for(let r=0,c=e.length;r<c;r++){const t=e[r];let n="";0!=t.status&&(n=`<img class="marry_guess_status" src="https://asset.tuwan.com/activity/marry/${1==t.status?"right":"wrong"}.png">`),i+=`<div class="marry_guess_item marry_flex_c">\n                        <img class="marry_guess_pic" src="${t.pic}">\n                        ${n}\n                    </div>`}let a=uu.getMeid()==this.actData.groom_uid;1==n?(o=a?"开始选择":"新郎选择中",s=a?"groom":"normal"):2==n?(o=a?"本轮猜错，重新选择":"本轮猜错",s="normal"):3==n&&(s="normal",o="恭喜新郎，猜对唇印"),i+=`</div>\n                <div class="open_guess_modal ${s}">${o}</div>`,window.$(".marry_guess_lips").html(i)}renderGuessModal(){let t=uu.getMeid()==this.actData.groom_uid;window.$(".marry_common_item").hide(),window.$(".marry_guess_content").css("display","flex"),window.$(".marry_mask").css("display","flex"),window.$(".marry_common_title").html("猜唇印"),window.$(".marry_common_desc").html(t?"请选出新娘的唇印":"等待新郎选择唇印");let e="",n=this.extra_data.list;for(let i=0,o=n.length;i<o;i++){const t=n[i];let o="";0!=t.status&&(o=`<img class="marry_modal_guess_status" src="https://asset.tuwan.com/activity/marry/${1==t.status?"right":"wrong"}.png">`),e+=`<div class="marry_modal_guess_item marry_flex_c" data-number="${t.number}"  data-status="${t.status}">\n                        <img class="marry_modal_guess_item_pic" src="${t.pic}">\n                        ${o}\n                    </div>`}uu.getMeid()==this.actData.groom_uid&&(e+='<div class="marry_modal_guess_btn">提交<div>'),window.$(".marry_guess_content").html(e)}renderWordData(t){window.$(".marry_guess_word").css("display","flex");let e="";if(0==t.end_time?(e="你说我猜 即将开始",window.$(".marry_guess_word_time").html(`${t.countdown}秒`)):e=uu.getAnchoringUserId()==uu.getMeid()||uu.getMeid()==this.actData.bride_uid?`描述词：${t.word}`:"新娘正在描述中...",window.$(".marry_guess_word_info").html(e),0!=t.end_time&&!this.timeStart){let e=t.end_time-t.now_time;this.setCountDown(e,t.countdown)}}setCountDown(t,e){this.timeStart=!0,this.timer&&clearInterval(this.timer);let n=t>e?e:t;n<=0?window.$(".marry_guess_word_time").html(""):(uu.getAnchoringUserId()==uu.getMeid()&&window.$(".marry_next_stage").css("display","flex"),window.$(".marry_guess_word_time").html(`${n}秒`),this.timer=setInterval((()=>{if(n--,n<=0){clearInterval(this.timer),this.timeStart=!1;let t=this.actData.total<=this.actData.stage?"闯关完成":"下一关";window.$(".marry_operate").html(t),window.$(".marry_guess_word_time").html("0秒"),window.$(".marry_next_stage").hide()}else window.$(".marry_guess_word_time").html(n+"秒")}),1e3))}renderSuccessModal(t){this.successData=t,window.$(".marry_success_mask").css("display","flex"),window.$(".marry_success_content").css({"background-image":`url(${t.bg_pc})`,"background-size":"100% 100%",width:"395px","padding-bottom":"20px"}),Zt.getInstance().playLoop({ele:window.$(".marry_success_svga")[0],path:t.svga_pc});let e=`<div class="marry_success_couple_detail">\n                        <div class="marry_success_couple_avatar">\n                            <div class="marry_success_bride_svga marry_success_common_svga"></div>\n                            <img src="${t.bride_info.avatar}">\n                        </div>\n                        <div class="marry_success_couple_name">${t.bride_info.nickname}</div>\n                        <div class="marry_success_couple_name marry_success_couple_birdge_uid" data-uid="${t.bride_info.uid}">ID:${t.bride_info.uid}</div>\n                    </div>\n                    <img class="marry_success_couple_heart" src="https://asset.tuwan.com/activity/marry/heart.png">\n                    <div class="marry_success_couple_detail">\n                        <div class="marry_success_couple_avatar">\n                            <div class="marry_success_groom_svga marry_success_common_svga"></div>\n                            <img src="${t.groom_info.avatar}">\n                        </div>\n                        <div class="marry_success_couple_name">${t.groom_info.nickname}</div>\n                        <div class="marry_success_couple_name">ID:${t.groom_info.uid}</div>\n                    </div>`;window.$(".marry_success_couple").html(e),Zt.getInstance().playLoop({ele:window.$(".marry_success_bride_svga")[0],path:t.bride_info.avatar_frame}),Zt.getInstance().playLoop({ele:window.$(".marry_success_groom_svga")[0],path:t.groom_info.avatar_frame});let n=uu.getMeid();if(n==t.bride_info.uid||n==t.groom_info.uid){window.$(".marry_success_btn").html(`<span>${t.countdown/1e3}</span>s后 自动进入蜜月厅`);let e=n==t.bride_info.uid?t.bride_award:t.groom_award,i="",o=[];for(let t=0,n=e.length;t<n;t++){const n=e[t];let s="";n.pic.endsWith("svga")?(s=`<div class="marry_success_couple_gift_pic_item marry_success_svga_${t}"></div>`,o.push(t)):s=`<img class="marry_success_couple_gift_pic_item" src="${n.pic}">`,i+=`<div class="marry_success_couple_gift_item">\n                                <div class="marry_success_couple_gift_pic marry_flex_c">\n                                    ${s}\n                                </div>\n                                <div>${n.title}</div>\n                            </div>`}window.$(".marry_success_couple_gift_list").html(i),window.$(".marry_success_couple_gift").show(),o.forEach((t=>{Zt.getInstance().playLoop({ele:window.$(`.marry_success_svga_${t}`)[0],path:e[t].pic})}));let s=t.countdown/1e3;s--,this.leaveTimer=setInterval((()=>{0==s?(clearInterval(this.leaveTimer),window.$(".marry_success_mask").hide(),this.emitter.emit("leaveRoom",t.room_info.cid)):(window.$(".marry_success_btn span").html(s),s--)}),1e3)}else window.$(".marry_success_couple_gift").hide(),window.$(".marry_success_btn").html("为他们送上祝福")}initEvents(){const t=window.$(".chat-center-main"),e=this;t.on("click",".marry-queue-tab",(function(t){t.stopPropagation(),window.$(".marry-queue-tab").removeClass("active"),window.$(".marry-common-orderlist").addClass("hide"),window.$(".marry-common-queuelist").addClass("hide");const e=t.currentTarget.dataset.tab;1==e?(window.$(".marry-queue-tab[data-tab='1']").addClass("active"),window.$(".marry-common-queuelist").removeClass("hide")):2==e&&(window.$(".marry-queue-tab[data-tab='2']").addClass("active"),window.$(".marry-common-orderlist").removeClass("hide"))})),window.$(document).on("click",".marry_operate",(function(){e.btnOperate()})),window.$(document).on("click",".marry_reset",(function(){Ct.Confirm("确认后会将所有人下麦，重新开始活动",(function(){qt.get(`${At}/wedding/clearWheat?cid=${uu.getCid()}`).then((t=>{Vt(t.error_msg)}))}))})),window.$(".marry_mask").on("click",".marry_common_close",(function(){window.$(".marry_mask").hide()})),window.$(".marry_success_mask").on("click",".marry_success_couple_close",(function(){window.$(".marry_success_mask").hide()})),window.$(document).on("click",".couple_item_btn",(function(){const{status:t,id:e}=this.dataset;1==t&&qt.get(`${At}/wedding/setCoupleWheat?id=${e}&cid=${uu.getCid()}`).then((t=>{0==t.error?window.$(".marry_mask").hide():Vt(t.error_msg)}))})),window.$(document).on("click",".marry_finish_sure",(function(){qt.get(`${At}/wedding/finish?cid=${uu.getCid()}`).then((t=>{window.$(".marry_mask").hide(),Vt(t.error_msg)}))})),window.$(document).on("click",".marry_next_stage",(function(){qt.get(`${At}/wedding/nextStage?cid=${uu.getCid()}`).then((t=>{Vt(t.error_msg)}))})),window.$(document).on("click",".marry_guess_lips",(function(){const t=e.extra_data.guess_status;uu.getMeid()==e.actData.groom_uid?1==t?e.renderGuessModal():2==t&&Vt("表演节目后，邀请主持点击 重新选择 按钮，即可再次进行选择"):e.renderGuessModal()})),window.$(document).on("click",".marry_bless_btn",(function(t){t.stopPropagation();const n=uu.getMeid();if(e.actData.groom_uid==n)return void um.openPacket();let i=null;i=e.actData.bride_uid==n?bt.getUserInfo(1*e.actData.groom_uid):bt.getUserInfo(1*e.actData.bride_uid),e.emitter.emit("showGiftWindow",i.uid,i.nickname,i.color,0,0,0)})),window.$(document).on("click",".marry_modal_guess_item",(function(){if(uu.getMeid()!=e.actData.groom_uid)return;if(0!=this.dataset.status)return;let t=window.$(this).index();window.$(".marry_modal_guess_item").removeClass("active"),window.$(".marry_modal_guess_item").eq(t).addClass("active"),window.$(".marry_modal_guess_btn").attr("data-number",this.dataset.number)})),window.$(document).on("click",".marry_success_btn",(function(t){if(t.stopPropagation(),e.successData.bride_info.uid!=uu.getMeid()&&e.successData.groom_info.uid!=uu.getMeid()){let t=window.$(".marry_success_couple_birdge_uid")[0].dataset.uid;window.$(".marry_success_mask").hide();const n=bt.getUserInfo(1*t);e.emitter.emit("showGiftWindow",n.uid,n.nickname,n.color,0,0,0)}})),window.$(document).on("click",".marry_modal_guess_btn",(function(){if(uu.getMeid()==e.actData.groom_uid){const{number:t}=this.dataset;t?qt.get(`${At}/wedding/guessLip?number=${t}&cid=${uu.getCid()}`).then((t=>{window.$(".marry_mask").hide(),Vt(t.error_msg)})):Vt("请选择唇印")}else window.$(".marry_mask").hide()}))}}class Jm{static show(){window.$("#werewolfGameList").length?this.hide():qt.get(Ot.getGameTypeList()).then((t=>{0==t.error?(window.$(".chat-center-window").append(`\n                    <div id="werewolfGameList" style="position: absolute; right: 90px; bottom: 80px; z-index: 10;">\n                        ${t.data.map((t=>`<img src="${t.itemBackground}" data-roomtype="${t.roomType}" style="display: block; width: 132px; margin-bottom: 10px; cursor: pointer;"/>`)).join("")}\n                    </div>\n                `),window.$("#werewolfGameList img").bind("click",(function(){Jm.joinGame({roomType:this.dataset.roomtype})}))):Vt(t.error_msg)}))}static joinGame({roomType:t,roomId:e}){const n=uu.getAnchoringUserFromPosition(2),i=uu.getAnchoringUserFromPosition(3);n&&i?qt.get(Ot.meteRoomByTeam(t,e,n.uid,i.uid)).then((t=>{0!=t.error&&Vt(t.error_msg)})):Vt("麦位上的人已下麦")}static hide(){window.$("#werewolfGameList").remove()}}class Qm extends Ht{constructor(){super(),this.initStyled=!1,this.init(),this.goTuwanGame=null,this.refreshEle=null}static getInstance(){return this.instance||(this.instance=new Qm),this.instance}init(){this.showed=!1}onReset(){window.$(".werewolf-team-room").remove(),this.init(),this.removeRefreshBtn(),this.removeAllListener("updatecar")}initTemplate(t){this.initStyled||(this.initStyle(),this.initStyled=!0),this.showed||(this.initHtml(t),this.showed=!0)}updateCarList(){const t=24==uu.roomInfo.pgameid?Ot.getUcList(uu.getCid()):Ot.getKillList(uu.getCid());qt.get(t).then((t=>{0==t.error&&this.emit("updatecar",{typeid:18,cid:uu.getCid(),data:t.data||[]})}))}checkJoinedMineRoomOrGame(){const t=this;qt.get(Ot.getGameStatus(uu.getCid())).then((e=>{[1,2].includes(e.error)&&de.getInstance().show("提示",e.data.msg,!1,"取消","前往",(()=>{1==e.error?ou(e.data.cid):2==e.error&&t.goTuwanGame&&t.goTuwanGame(e.data.fid,e.data.game_type)}),null,{desAlign:"center"})}))}initHtml(t){let e=`\n            <div class="werewolf-team-room flex flex-jc flex-ac">\n                <div id="werewolf-team-svgaBg" style="position: absolute; width: 100%; height: 100%; top:0; z-index: -1"></div>\n                <div class="werewolf-team-wrapper flex flex-jc flex-ac">\n                    ${Fi._initSeatData(2,120,135,100,100,"队长")}\n                    ${Fi._getOtherAnchorSeatHtml({position:3,role:"嘉宾",index:0,pwidth:120,pheight:135,width:100,height:100})}\n                </div>\n            </div>\n        `;window.$(".room-seats-main").html(e),window.$(".room-seats-main .seat-item-empty .seat-close").remove();let n=""!=t.skin?t.skin:""!=t.skin_active?t.skin_active:"";if(""!=n)if(-1!=n.indexOf(".svga")){const t=Zt.getInstance();t.loadParser("#werewolf-team-svgaBg",n,0,!1).then((({player:e})=>{e.setContentMode("AspectFill"),t.playersMap.set("werewolf-team-svgaBg",e)}),(t=>{}))}else window.$(".werewolf-team-room").css("background",'rgba(0, 0, 0, 0) url("'+n+'") no-repeat scroll 50% 50% / 100% 100% padding-box border-box');ci.show(2,ci.type.leaveConfirm)}addRefreshBtn(){const t=this;this.refreshEle||(this.refreshEle=window.$('<span style="position:absolute; left: 10px; top: 10px; background:#ff5588; font-size: 14px; color: white; border-radius:4px;padding:0 6px">刷新</span>'),this.refreshEle.click((function(){t.updateCarList()})),window.$(".autoroom-teams").append(this.refreshEle))}removeRefreshBtn(){this.refreshEle&&(this.refreshEle.remove(),this.refreshEle=null)}initStyle(){window.$("head").append("\n            <style>\n                .werewolf-team-room {\n                    height: 350px;\n                }\n\n                .werewolf-team-wrapper {\n                    width: 530px;\n                    height: 218px;\n                    background: rgba(255, 255, 255, 0.3);\n                    border-radius: 30px;\n                }\n\n                .werewolf-team-wrapper .seat-item-empty:nth-child(1) {\n                    margin-right: 50px;\n                }\n    \t\t</style>\n        ")}}class Xm{static async track(t){t.isdev=It?"true":"false";let e="web_chatroom";"page_name"in t&&(e=t.page_name);const n={user_id:t.user_id,device_model:"pc_web",event_detail:t,device_num:"",last_channel_name:"",parent_page:"",page_name:e,session_id:"",client_version:"",client_id:11,client_source:"",device_version:"",client_mac:"",device_type:"1",operate_time:(new Date).getTime()};if(window.jQuery){const t="https://app-diandian-report.tuwan.com";window.jQuery.ajax({url:t,type:"POST",data:JSON.stringify(n),dataType:"json",xhrFields:{withCredentials:!0},success:function(t){}})}}static track2(t){t.isdev=It?"true":"false";let e="web_chatroom";"page_name"in t&&(e=t.page_name);const n={user_id:t.user_id,device_model:"pc_web",event_detail:t,device_num:"",last_channel_name:"",parent_page:"",page_name:e,session_id:"",client_version:"",client_id:11,client_source:"",device_version:"",client_mac:"",device_type:"1",operate_time:(new Date).getTime()};return new Promise(((t,e)=>{if(window.jQuery){const i="https://app-diandian-report.tuwan.com";window.jQuery.ajax({url:i,type:"POST",data:JSON.stringify(n),dataType:"json",xhrFields:{withCredentials:!0},success:function(e){t(e)},error:function(){e()}})}}))}static track3(t="web_chatroom",e){const{uid:n}=uu.getRoomInfo(),i={user_id:n,device_model:"pc_web",event_detail:e,device_num:"",last_channel_name:"",parent_page:"",page_name:t,session_id:"",client_version:"",client_id:11,client_source:"",device_version:"",client_mac:"",device_type:"1",operate_time:(new Date).getTime()};return new Promise(((t,e)=>{if(window.jQuery){const n="https://app-diandian-report.tuwan.com";window.jQuery.ajax({url:n,type:"POST",data:JSON.stringify(i),dataType:"json",xhrFields:{withCredentials:!0},success:function(e){t(e)},error:function(){e()}})}}))}}class Zm{constructor(){this.instance=null,this.timer=null,this.currentInfo=null,this.uuid=0,this.joinGameFn=null,this.jumping=!1,this.gameFid=0}static getInstance(){return this.instance||(this.instance=new Zm,this.instance.onEvent(),this.uuid=this.instance.getUUID()),this.instance}onEvent(){const t=this;sn.closeClick=()=>{t.setHideModal(),t.updateLog("close",-1,(()=>{si.hide(".room_invite_modal")}))},sn.acceptClick=e=>{const n=e.target.dataset,i=n.uid,o=n.type,s=n.cid,a=n.fid;2==o?null!=this.joinGameFn&&ou(s,(()=>{Zm.getInstance().jumping=!0,Zm.getInstance().gameFid=a})):qt.get(Ot.imAccept(i)).then((e=>{0==e.error?(t.setHideModal(),t.updateLog("redirect",0,(()=>{si.hide(".room_invite_modal")})),ou(e.data.cid||e.data.data.cid)):Vt(e.error_msg)}))},sn.imClick=e=>{const n=e.target.dataset.uid;document.getElementById("iframeim").contentWindow.postMessage({uid:n},"*"),window.$("#div-im-content").show(),qt.get(Ot.imClick(n)),t.setHideModal(),t.updateLog("redirect",1,(()=>{si.hide(".room_invite_modal")}))}}show(t){const e=this;if(""!=t.url){const n=t.url.substring(t.url.indexOf("data=")+5,t.url.length),i=JSON.parse(decodeURIComponent(n));this.currentInfo=i,si.show(".room_invite_modal"),window.$(".room_invite_userinfo_nickname").text(i.nickname),window.$(".room_invite_game_icon").html("<img src='"+i.icon+"' />"),window.$(".room_invite_userinfo_avatar").html("<img src='"+i.avatar+"' />"),window.$(".room_invite_game span").text(i.areas),window.$(".room_invite_action_accept").attr("data-uid",i.capid),window.$(".room_invite_action_accept").attr("data-type",i.fleet_type),window.$(".room_invite_action_accept").attr("data-fid",i.fid),window.$(".room_invite_action_accept").attr("data-cid",i.cid),window.$(".room_invite_action_im").attr("data-uid",i.capid),this.timer=setTimeout((()=>{e.updateLog("close",-1,(()=>{si.hide(".room_invite_modal")})),e.setHideModal(),e.timer=clearTimeout(this.timer),e.timer=null}),1e4),this.updateLog("open")}}hide(){}getUUID(){let t=[],e="0123456789abcdef";for(let n=0;n<36;n++)t[n]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}updateLog(t,e=-1,n){let i={areas:this.currentInfo.areas,capid:this.currentInfo.capid,event:0,init_time:(new Date).getTime(),nickname:this.currentInfo.nickname,popupid:0,pushid:0,refuse:1,response_time:0,timeout:!1,type:"13",uuid:this.uuid,windowtype:t,operate_time:(new Date).getTime(),page_name:"window"};-1!=e&&(i.action=e),i.user_id=uu.getMeid(),Xm.track2(i).then((()=>{null!=n&&n()})).catch((()=>{null!=n&&n()}))}setHideModal(){clearTimeout(this.timer),this.timer=null,setTimeout((()=>{si.hide(".room_invite_modal")}),2e3)}onCheckGameJumpStatus(){null!=this.joinGameFn&&this.jumping&&(this.jumping=!1,this.joinGameFn(this.gameFid,uu.isSpyRoom()?4:1))}}class th{constructor(){this.instance=null,this.joinGameFn=null}static getInstance(){return this.instance||(this.instance=new th),this.instance}show(t){const e=t.matchStepType;if(3==e||6==e){const{cid:e,fid:n,uid:i,game_type:o,uname:s,avatar:a}=t;window.$(".jump_game_affirm").off("click"),window.$(".jump_game_close").off("click"),window.$(".jump_game_modal").remove(),window.$("body").append(`\n                <div class="jump_game_modal" style="z-index: 1000">\n                        <div class="jump_game_content">\n                            <div class="jump_game_close"></div>\n                            <div class="jump_game_title"></div>\n                            <div class="jump_game_header">\n                                <img src="${a}" />\n                            </div>\n                            <div class="jump_game_name">${s}</div>\n                            <div class="jump_game_info">你是否立即进入比赛桌 </div>\n                            <div class="jump_game_affirm">确定</div>\n                        </div>\n                </div>`),window.$(".jump_game_modal").css("display","flex"),window.$(".jump_game_affirm").on("click",(()=>{window.$(".jump_game_modal").css("display","none"),this.joinGameFn&&this.joinGameFn(n,o,1)})),window.$(".jump_game_close").on("click",(()=>{window.$(".jump_game_modal").css("display","none")}))}}}class eh{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new eh),this.instance}show(t){const{cid:e,title:n,content:i}=t;window.$(".jump_room_affirm").off("click"),window.$(".jump_room_close").off("click"),window.$(".jump_room_modal").remove(),window.$("body").append(`\n            <div class="jump_room_modal" style="z-index: 1000">\n                    <div class="jump_room_content">\n                        <div class="jump_room_close"></div>\n                        <div class="jump_room_title">${n}</div>\n                        <div class="jump_room_desc">${i} </div>\n                        <div class="jump_room_affirm">进入大厅</div>\n                    </div>\n            </div>`),window.$(".jump_room_modal").css("display","flex"),window.$(".jump_room_affirm").on("click",(()=>{window.$(".jump_room_modal").css("display","none"),ou(e)})),window.$(".jump_room_close").on("click",(()=>{window.$(".jump_room_modal").css("display","none")}))}}class nh{constructor(){this.instance=null,this.levelUpData=null,this.initCss(),this.initHtml()}static getInstance(){return this.instance||(this.instance=new nh),this.instance}initCss(){window.$("head").append("<style>\n                    .modal_f_c{display:flex;align-items:center;justify-content:center;}\n                    .modal_f_sb{display:flex;align-items:center;justify-content: space-between;}\n                    .user_level_up_mask,.other_level_up_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;top: 0;left: 0;z-index: 99999;position: fixed;}\n                    .other_level_up_mask{pointer-events: none;}\n                    .user_level_up_mask{background: rgba(0, 0, 0, 0.6);}\n                    .user_level_up_content,.other_level_up_content{position:relative;width:448px;text-align:center;padding-bottom:40px}\n                    .user_level_up_content{background:rgba(31, 21, 77,0.9);border-radius:15px;display: flex;justify-content: center;flex-direction: column;align-items: center;}\n                    .common_level_up_svga{position:relative;left:50%;transform:translateX(-50%);width:1000px;height:480px;pointer-events: none;top:-78px}\n                    .level_up_svga_1{top:-230px;position:absolute;}\n                    .level_up_gift_content{width:405px;flex-wrap: wrap;max-height: 340px;overflow-y: auto;display:flex;align-items:center;}\n                    .level_up_gift_content::-webkit-scrollbar {width: 0px !important;}\n                    .level_up_gift_item{width:135px;text-align:center;color:#fff;font-size:14px}\n                    .level_up_gift_item span{color:#F6FF00}\n                    .level_up_gift_pic{width:120px;height:120px;position:relative;}\n                    .level_up_gift_pic img{max-width:70%;max-height:70%}\n                    .level_up_take_gift{width: 260px;height: 66px;background: #FF6691;border-radius: 33px;color:#fff;font-size:24px;line-height:66px;text-align:center;margin:30px auto 0;cursor: pointer;}\n                    .level_up_user_avatar{width:74px;height:74px;border-radius:50%;border:2px solid #FF6691;margin-top:-240px}\n                    .level_up_user_name{font-size:16px;color:#FF6691;margin-top:-80px;font-weight:bold}\n                    .level_up_tips{font-weight: 400;color: #FFFFFF;line-height: 33px;font-size: 24px;margin-top: 170px;}\n                </style>")}initHtml(){window.$("body").append('<div class="user_level_up_mask common_level_mask">\n                        <div class="user_level_up_content">\n                            <div class="level_up_svga_1 common_level_up_svga"></div>\n                            <div class="level_up_tips" >您获得了以下奖励和特权</div>\n                            <div class="level_up_gift_content"></div>\n                            <div class="level_up_take_gift"></div>\n                        </div>\n                    </div>\n                    <div class="other_level_up_mask common_level_mask">\n                        <div class="other_level_up_content">\n                            <div class="level_up_svga_0 common_level_up_svga"></div>\n                            <img class="level_up_user_avatar">\n                            <div class="level_up_user_name"></div>\n                        </div>\n                    </div>'),this.initEvent()}async showModal(t,e){await _s.getInstance().notInGame(),this.levelUpData=t;const{reward:n,svga_pc:i,frame:o,left_frame:s,nickname:a,avatar:r,playvip:c,sysFrom:l}=t;if(window.$(".common_level_mask").hide(),1==e){let a=t.is_show_new;if(0==l){const t=await qt.get(Ot.checkGrade(c));if(0!=t.error||2==t.data.is_show)return;0==t.data.is_show&&Vt(t.error_msg),a=t.data.is_show}if(1==a){let t="";n.forEach(((e,n)=>{const i=0==e.num?`<div>${e.name}</div>`:` <div>${e.name}<span>x${e.num}</span>${e.unit}</div>`;let o=`<div class="level_up_gift_pic modal_f_c">\n                        <img src="${e.icon}">\n                    </div>`;-1!=(e.icon+"".toLocaleLowerCase()).indexOf(".svga")&&(o=`<div class="level_up_gift_pic modal_f_c "><div class="level_up_show_svga" data-url=${e.icon} style="max-width:70%;max-height:70%;text-align: left;"></div></div>`),t+='<div class="level_up_gift_item">\n                                '+o+i+"\n                            </div>"})),window.$(".level_up_gift_content").html(t),window.$(".level_up_take_gift").html("领取奖励"),window.$(".level_up_take_gift").attr("data-type","take"),window.$(".user_level_up_mask").css("display","flex"),window.$(".level_up_tips").text("您获得了以下奖励和特权"),this.levelSvgaPlayer(e,i,o,s);const a=window.$(".level_up_show_svga");if(a.length){let t=[];for(let e=0;e<a.length;e++){const n=a[e],i=n.dataset.url;t.push({el:n,url:i})}t.forEach((t=>{Zt.getInstance().playLoop({ele:t.el,path:t.url})}))}}else 2==a&&(window.$(".level_up_gift_content").html(""),window.$(".level_up_take_gift").html("我知道了"),window.$(".level_up_tips").text(""),window.$(".level_up_take_gift").attr("data-type","close"),window.$(".user_level_up_mask").css("display","flex"),this.levelSvgaPlayer(e,i,o,s))}else window.$(".level_up_user_avatar").attr("src",r),window.$(".level_up_user_name").html(a),window.$(".other_level_up_mask").css("display","flex"),this.levelSvgaPlayer(e,i,o,s)}levelSvgaPlayer(t,e,n,i){function o(t){setTimeout((()=>{window.$(".common_level_mask").hide()}),3e3)}window.addEventListener("error",o),setTimeout((()=>{let s=new window.SVGA.Player(`.level_up_svga_${t}`),a=new window.SVGA.Parser(`.level_up_svga_${t}`);s.loops=1,a.load(e,(function(e){s.setVideoItem(e),s.startAnimation(),s.onFinished((()=>{1==t?s.startAnimationWithRange({location:n,length:i},!1):window.$(".common_level_mask").hide()}))})),setTimeout((()=>{window.removeEventListener("error",o)}),2e3)}),0)}initEvent(){let t=this;window.$(".user_level_up_mask").on("click",".level_up_take_gift",(function(){"take"==this.dataset.type?qt.get(Ot.takeGradeReward(t.levelUpData.playvip)).then((t=>{0==t.error&&(Vt(t.error_msg),window.$(".common_level_mask").hide())})):window.$(".common_level_mask").hide()})),window.$(".user_level_up_mask").mouseup((function(t){var e=window.$(".user_level_up_content");e.is(t.target)||0!==e.has(t.target).length||window.$(".common_level_mask").hide()}))}}const ih="src/js/components/countdownAlert.svelte";function oh(t,e,n){const i=t.slice();return i[7]=e[n],i}function sh(t){let e,n,i,o,s,a,r=t[7].title+"",c=t[7].countdown>0&&0!=t[4]?`(${t[4]})`:"";const l={c:function(){e=_("p"),n=M(r),i=M(c),y(e,"class",o=R(t[7].class)+" s-gIz0lxBmN2b4"),rt(e,"disable",t[7].countdown>0&&0!=t[4]),x(e,ih,50,16,1232)},m:function(o,r){b(o,e,r),I(e,n),I(e,i),s||(a=E(e,"click",(function(){H(t[5].bind(null,t[7]))&&t[5].bind(null,t[7]).apply(this,arguments)}),!1,!1,!1,!1),s=!0)},p:function(s,a){t=s,8&a&&r!==(r=t[7].title+"")&&P(n,r),24&a&&c!==(c=t[7].countdown>0&&0!=t[4]?`(${t[4]})`:"")&&P(i,c),8&a&&o!==(o=R(t[7].class)+" s-gIz0lxBmN2b4")&&y(e,"class",o),24&a&&rt(e,"disable",t[7].countdown>0&&0!=t[4])},d:function(t){t&&C(e),s=!1,a()}};return p("SvelteRegisterBlock",{block:l,id:sh.name,type:"each",source:"(50:12) {#each btns as data}",ctx:t}),l}function ah(t){let e,n,i,o,s,a,r,c,l,d,m,h;i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let u=t[3];v(u);let g=[];for(let p=0;p<u.length;p+=1)g[p]=sh(oh(t,u,p));const f={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),a=M(t[1]),r=T(),c=_("p"),l=M(t[2]),d=T(),m=_("div");for(let t=0;t<g.length;t+=1)g[t].c();y(s,"class","title s-gIz0lxBmN2b4"),x(s,ih,46,8,1092),y(c,"class","desc s-gIz0lxBmN2b4"),x(c,ih,47,8,1129),y(m,"class","btns s-gIz0lxBmN2b4"),x(m,ih,48,8,1164),y(n,"class","body s-gIz0lxBmN2b4"),x(n,ih,44,4,949),y(e,"class","countdown_alert s-gIz0lxBmN2b4"),x(e,ih,43,0,915)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,u){b(t,e,u),I(e,n),z(i,n,null),I(n,o),I(n,s),I(s,a),I(n,r),I(n,c),I(c,l),I(n,d),I(n,m);for(let e=0;e<g.length;e+=1)g[e]&&g[e].m(m,null);h=!0},p:function(e,[n]){if(t=e,(!h||2&n)&&P(a,t[1]),(!h||4&n)&&P(l,t[2]),56&n){let e;for(u=t[3],v(u),e=0;e<u.length;e+=1){const i=oh(t,u,e);g[e]?g[e].p(i,n):(g[e]=sh(i),g[e].c(),g[e].m(m,null))}for(;e<g.length;e+=1)g[e].d(1);g.length=u.length}},i:function(t){h||(q(i.$$.fragment,t),h=!0)},o:function(t){O(i.$$.fragment,t),h=!1},d:function(t){t&&C(e),G(i),S(g,t)}};return p("SvelteRegisterBlock",{block:f,id:ah.name,type:"component",source:"",ctx:t}),f}function rh(t,e,n){let{$$slots:i={},$$scope:o}=e;f("CountdownAlert",i,[]);let{closeModal:s}=e,{title:a=""}=e,{desc:r=""}=e,{btns:c=[{title:"知道了",class:"dark",cb:s}]}=e;const l=c.find((t=>t.countdown>0));let d=l?l.countdown:0;function m(t){t.countdown>0&&d>0||t.cb&&t.cb()}w((()=>{let t=null;return d>0&&(t=setInterval((()=>{n(4,d-=1),0==d&&clearInterval(t)}),1e3)),()=>clearInterval(t)})),t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<CountdownAlert> was created without expected prop 'closeModal'")}));const h=["closeModal","title","desc","btns"];return Object.keys(e).forEach((t=>{~h.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<CountdownAlert> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"title"in t&&n(1,a=t.title),"desc"in t&&n(2,r=t.desc),"btns"in t&&n(3,c=t.btns)},t.$capture_state=()=>({onMount:w,Img:ye,closeModal:s,title:a,desc:r,btns:c,countdownBtn:l,seconds:d,btnClick:m}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"title"in t&&n(1,a=t.title),"desc"in t&&n(2,r=t.desc),"btns"in t&&n(3,c=t.btns),"seconds"in t&&n(4,d=t.seconds)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r,c,d,m]}class ch extends h{constructor(t){super(t),u(this,t,rh,ah,g,{closeModal:0,title:1,desc:2,btns:3}),p("SvelteRegisterComponent",{component:this,tagName:"CountdownAlert",options:t,id:ah.name})}get closeModal(){throw new Error("<CountdownAlert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<CountdownAlert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get title(){throw new Error("<CountdownAlert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(t){throw new Error("<CountdownAlert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get desc(){throw new Error("<CountdownAlert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set desc(t){throw new Error("<CountdownAlert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get btns(){throw new Error("<CountdownAlert>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set btns(t){throw new Error("<CountdownAlert>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function lh(t){let e,n;e=new ye({props:{class:"close",src:"https://dynamics-share.tuwan.com/activity/e717e13211f7a06180a83b4043b71344.png"},$$inline:!0}),e.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(e,n){t=e},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:lh.name,type:"if",source:"(24:4) {#if showClose && canShowClose}",ctx:t}),i}function dh(t){let e,n,i,o,s,a;n=new ye({props:{class:"trumpet",src:"https://dynamics-share.tuwan.com/activity/c4f38815cdeee740965d2a52bcfd5dd5.png"},$$inline:!0}),o=new Br({props:{text:t[1]},$$inline:!0});let r=t[2]&&t[3]&&lh(t);const c={c:function(){e=_("div"),U(n.$$.fragment),i=T(),U(o.$$.fragment),s=T(),r&&r.c(),y(e,"class","compliance_notice flex flex-ac s-B8YqfXaWyB0x"),x(e,"src/js/compliance/notice.svelte",20,0,421)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,c){b(t,e,c),z(n,e,null),I(e,i),z(o,e,null),I(e,s),r&&r.m(e,null),a=!0},p:function(t,[n]){const i={};2&n&&(i.text=t[1]),o.$set(i),t[2]&&t[3]?r?(r.p(t,n),12&n&&q(r,1)):(r=lh(t),r.c(),q(r,1),r.m(e,null)):r&&(W(),O(r,1,1,(()=>{r=null})),N())},i:function(t){a||(q(n.$$.fragment,t),q(o.$$.fragment,t),q(r),a=!0)},o:function(t){O(n.$$.fragment,t),O(o.$$.fragment,t),O(r),a=!1},d:function(t){t&&C(e),G(n),G(o),r&&r.d()}};return p("SvelteRegisterBlock",{block:c,id:dh.name,type:"component",source:"",ctx:t}),c}function mh(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Notice",i,[]);let{closeModal:s}=e,{text:a}=e,{showClose:r=!0}=e,{showCloseDelay:c=0}=e,l=!1;w((()=>{setTimeout((()=>{n(3,l=!0)}),c)})),t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<Notice> was created without expected prop 'closeModal'"),void 0!==a||"text"in e||t.$$.bound[t.$$.props.text]||console.warn("<Notice> was created without expected prop 'text'")}));const d=["closeModal","text","showClose","showCloseDelay"];return Object.keys(e).forEach((t=>{~d.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Notice> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"text"in t&&n(1,a=t.text),"showClose"in t&&n(2,r=t.showClose),"showCloseDelay"in t&&n(4,c=t.showCloseDelay)},t.$capture_state=()=>({onMount:w,Img:ye,Marquee:Br,closeModal:s,text:a,showClose:r,showCloseDelay:c,canShowClose:l}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"text"in t&&n(1,a=t.text),"showClose"in t&&n(2,r=t.showClose),"showCloseDelay"in t&&n(4,c=t.showCloseDelay),"canShowClose"in t&&n(3,l=t.canShowClose)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r,l,c]}class hh extends h{constructor(t){super(t),u(this,t,mh,dh,g,{closeModal:0,text:1,showClose:2,showCloseDelay:4}),p("SvelteRegisterComponent",{component:this,tagName:"Notice",options:t,id:dh.name})}get closeModal(){throw new Error("<Notice>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<Notice>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get text(){throw new Error("<Notice>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set text(t){throw new Error("<Notice>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showClose(){throw new Error("<Notice>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showClose(t){throw new Error("<Notice>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get showCloseDelay(){throw new Error("<Notice>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set showCloseDelay(t){throw new Error("<Notice>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class uh{constructor(){this.danmuDom=null,this.danmuCompCloseCb=null,this.taskCompCloseCb=null}static getInstance(){return this.instance||(this.instance=new uh),this.instance}onReset(){$(".chat-center-message").removeClass("compliance_notice"),this.danmuDom&&(this.danmuDom.remove(),this.danmuDom=null,this.danmuCompCloseCb&&this.danmuCompCloseCb(),this.danmuCompCloseCb=null),this.taskCompCloseCb&&this.taskCompCloseCb(),this.taskCompCloseCb=null}checkDanmuNoticeVisible(){let t=uu.getRoomInfo().broadcast_msg;if(t&&t.length){$(".chat-center-message").addClass("compliance_notice"),this.danmuDom=$(`<div class="complianceNoticeContainer ${uu.isTempCarteamRoom()?"isSmallRoom":""}"></div>`),$(".chat-center-window-main-container").append(this.danmuDom);const{closeModal:e}=we(hh,{text:t,showCloseDelay:1e4},this.danmuDom[0]);this.danmuCompCloseCb=e}}showTaskNotice(t){const{closeModal:e}=we(hh,{text:t,showClose:!1},$(".captain_task .task_content .task_compliance_notice")[0]);this.taskCompCloseCb=e}}class ph{constructor(){this.instance=null,this.initCss(),this.totalDay=null,this.arrowIsBottom=0,this.takeawayMsg=null,this.globalGiftPic=null,this.globalGiftName=null,this.globalNowLevel=null,this.globalMenuName=null,this.globalMenuType=null,this.emitter=new Ht,this.cid=null,this.ruleTimer=null,this.yaoqingmalib=null,this.level=0}static getInstance(){return this.instance||(this.instance=new ph),this.instance}onReset(){window.$(".captain_task").remove()}onCaptionWithdraw(){const t=`${Mt.domain}`+(uu.getSelfInfo().teacher?"/home/advisor/":"/home/msg/");window.open(t,"_blank")}onCloseCaptionDialog(){window.$("#div-captain-content").hide()}onMessageToCaptain(t){window.$("#div-captain-content").hide(),bh(t.uid,t.nickname)}onEventListener(){let t;window.$("#newCaptain").on("click",(function(){window.$("#div-captain-content").show(),window.$("#div-captain-content").unbind("click"),clearTimeout(t),t=setTimeout((()=>{window.$("#div-captain-content").bind("click",(function(){window.$("#div-captain-content").hide()}))}),500)}))}checkTrainer(t){let e=this;qt.get(Ot.checkTrainer(uu.getCid())).then((n=>{0==n.error?1==n.showtab||2==n.showtab?uu.isPaidanAnchor(t)&&(window.$("#newCaptain").text(1==n.showtab?"新队长任务":"培训师任务"),window.$("#iframecaptain").attr("src",n.url+(-1!=n.url.indexOf("?")?"&cid="+uu.getCid():"?cid="+uu.getCid())),window.$("#newCaptain").show(),e.onEventListener()):(window.$("#newCaptain").hide(),uu.isTempCarteamRoom()||uu.isLiveRoom()?window.$(".captain_task").hide():uu.isPaidan2(t)&&(window.$(".captain_task").length>0?window.$(".captain_task").show():this.loadCaptainTask(0))):(window.$("#newCaptain").hide(),window.$(".captain_task").hide())}))}initCaptain(t,e){this.cid=t,this.checkTrainer(e)}initCss(){window.$("head").append("<style>\n                            .ygb_flex{display:flex}\n                            .captain_task{position:absolute;top:40px;right:10px;width:368px;z-index:7}\n                            .captain_task .tab_content{display:flex;align-items:center;justify-content:space-between}\n                            .captain_task .task_history_content{display:flex;align-items:center;justify-content:space-between;border:2px solid #fee5eb;border-top-left-radius:6px;border-top-right-radius:6px;}\n                            .captain_task .tab_item{padding:0 5px;font-size:14px;text-align:center;color:#999999;cursor:pointer;border-left:2px solid #fee5eb;background:#fff}\n                            .captain_task .tab_item:first-child{border-left:none}\n                            .captain_task .yesterday_summary{font-size:14px;color:#ff6691;cursor:pointer;}\n                            .captain_task .current{background:#fee5eb;color:#ff6691}\n                            .captain_task .task_content{border:2px solid #fee5eb;border-radius:6px;margin-top:-2px;background:#fff;border-top-left-radius:0px;}\n                            .captain_task .task_content_detail{overflow:auto;height:160px;position:relative; padding-bottom: 10px;}\n                            .captain_task .task_content .task_compliance_notice { margin-right: 16px; margin-top: 4px; }\n                            .common_title{font-size:14px;color:#ff5588;font-weight:bold;margin-left:7px;margin-top:10px;position:relative}\n                            .common_title span{font-size:12px;cursor:pointer;color:#ff6691;position:absolute;right:18px;font-weight:normal}\n                            .captain_task .task_bottom{width:364px;background:#fee5eb;height:40px;border-bottom-left-radius:6px;border-bottom-right-radius:6px;display:flex;align-items:center}\n                            .captain_task .task_bottom .captain_signIn{width:72px;height:28px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:14px;color:#fff;cursor:pointer;margin-left:14px;}\n                            .captain_task .task_bottom .arrow_control{cursor:pointer;margin-right:6px;}\n                            .captain_task .task_item_list,.captain_task .boss_item_list{width:340px;height:26px;margin-left:10px;background:#f7f7f7;border-radius:6px;font-size:14px;color:#333333;line-height:26px;display:flex;margin-top:9px;}\n                            .captain_task .task_item_list.big_line { height: 46px; }\n                            .captain_task .task_name{flex:1;text-align:left;text-indent:14px;}\n                            .captain_task .task_process,.captain_task .user_status{min-width:52px;max-width:80px;height:26px;text-align:center;color:#ff5588;background:#fee5eb;border-top-right-radius:6px;border-bottom-right-radius:6px;}\n                            .captain_task .task_item_list.big_line .task_process { height: 46px; line-height: 46px; }\n                            .captain_task .task_item_list .task_process.has_reward{background:url('https://asset.tuwan.com/chatroom/images/licao_active.png') #fee5eb;background-size:29px 28px;background-position:center;background-repeat:no-repeat}\n                            .captain_task .task_item_list .task_process.no_reward{background:url('https://asset.tuwan.com/chatroom/images/libao_unactive.png') #fee5eb;background-size:29px 28px;background-position:center;background-repeat:no-repeat}\n                            .captain_task .task_item_list.big_line .task_name img { width: 20px; margin-left: 5px; }\n                            .captain_task .task_item_list.big_line .progressBar { background-color: #EAEAEA; width: 90%; border-radius: 10px; overflow: hidden; margin-left: 15px; }\n                            .captain_task .task_item_list.big_line .progressBar .progress { background-color: #D3D3D3; height: 8px; }\n                            .captain_task .user_status,.act_cur{cursor:pointer;}\n                            .captain_task .task_finished{color:#9a9a9a;background:#EDEDED}\n                            .captain_task .task_status_btn {display: none; width:102px;height:34px;border-radius:6px;font-size:14px;cursor:pointer;margin-left:12px;display:flex; flex-direction: column; align-items:center;justify-content:center;background:#ff5588; animation: scale_small 1.6s infinite;}\n                            .captain_task .task_status_btn .title{font-size:14px; color: white;}\n                            .captain_task .task_status_btn .desc{font-size:10px; color: white; opacity: 0.8; margin-top: -4px; display: none;}\n                            .captain_task .task_status_btn.disable{opacity: 0.6; animation: none;}\n                            .captain_task .title_item{opacity:0;display:flex;align-items:center;justify-content:center;}\n                            .captain_task .title_name_item{font-weight:bold;color:#666666;font-size:18px;margin-left:14px;margin-right:14px;}\n                            .captain_task .captain_rank_info{height:54px;display:flex;align-items:center;background:#fee5eb;width:100%;}\n                            .captain_task .captain_rank_info .captain_avatar,.captain_level_avatar{width:44px;height:44px;border-radius:44px;border:3px solid #f5f5f5;margin-left:8px;}\n                            .captain_task .captain_desc_content{text-align:left;margin-left:6px;font-size:14px;width:210px;color:#666666;font-weight:bold;}\n                            .captain_task .captain_desc_content span{color:#ff5588;}\n                            .captain_task .captain_desc_info{color:#999999;font-weight:normal;font-size:12px}\n                            .captain_salary_detail{overflow:auto}\n                            .captain_week_rank_detail,.captain_salary_detail{height:138px}\n                            .captain_week_rank_detail .title_nav{width:334px;height:26px;background:#f5f5f5;border-radius:4px;font-size:12px;color:#666666;margin:0 auto;line-height:26px;text-align:left;margin-top:-24px;}\n                            .captain_week_rank_detail .captain_rank_list{width:349px;height:113px;margin-left:15px;overflow:auto;font-size:12px;}\n                            .captain_week_rank_detail .captain_rank_list li{display:flex;align-items:center;width:334px;height:44px;border-bottom:1px dashed #e0e0e0;}\n                            .captain_week_rank_detail .captain_rank_list .captain_rank_list_name{margin-left:8px;width:76px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}\n                            .captain_week_rank_detail .captain_rank_list .captain_rank_list_score{width:30px;text-align:center;margin-left:6px;}\n                            .captain_week_rank_detail .top_1{width:32px;height:24px;background:url('https://res.tuwan.com/templet/play/2019qixi/rank_1.png');background-size:100% 100%;margin-left:18px;}\n                            .captain_week_rank_detail .top_2{width:32px;height:24px;background:url('https://res.tuwan.com/templet/play/2019qixi/rank_2.png');background-size:100% 100%;margin-left:18px;}\n                            .captain_week_rank_detail .top_3{width:32px;height:24px;background:url('https://res.tuwan.com/templet/play/2019qixi/rank_3.png');background-size:100% 100%;margin-left:18px;}\n                            .captain_week_rank_detail .top,.captain_week_rank_detail .top_else{display:flex;justify-content:center;align-items:center;width:32px;height:24px;margin-left:18px;color:#999;}\n                            .captain_week_rank_detail .top span{display:inline-block;text-align:center;width:18px;height:18px;line-height:18px;background:#fee5eb;border-radius:18px;}\n                            .ygb_common_scroll::-webkit-scrollbar-track{background-color:transparent;}\n                            .ygb_common_scroll::-webkit-scrollbar{width:5px;}\n                            .ygb_common_scroll::-webkit-scrollbar-thumb{border-radius:10px;background-color:#cdcdcd;}\n                            .captain_rule_content{position:relative;background:#fff;border-radius:10px;padding:0 32px 20px 32px}\n                            .rule_title{font-size:20px;color:#595959;text-align:center;font-weight:bold;margin-top:42px;}\n                            .rule_info{margin:0 auto;margin-top:25px;margin-bottom:9px;font-size:12px;color:#595959}\n                            .rule_info>div{margin-top:5px;}\n                            .rule_alaso{width:200px;height:46px;color:#fff;background:#ff5588;border-radius:8px;font-size:14px;text-align:center;line-height:46px;margin:0 auto;cursor:pointer;}\n                            .rule_close{position:absolute;width:12px;height:12px;top:10px;right:10px;background:url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png);cursor:pointer;}\n                            .captain_rule_tips{cursor:pointer;position:absolute;top:20px;right:20px;opacity:0;}\n                            .new_boss_que{cursor:pointer;position:absolute;top:0px;right:20px;display:flex;}\n                            .task_rule_tips{cursor:pointer;position:absolute;top:12px;left:330px;z-index:10}\n                            .captain_salary_content{margin-top:-24px;}\n                            .captain_salary_content .captain_salary_item{display:flex;align-items:center;margin-bottom:8px;margin-left:15px;}\n                            .captain_salary_content .captain_salary_item .item_common{padding:10px 0 10px 14px;display:flex;width:278px;border-radius:5px;border:1px solid #e6e6e6;align-items:center;font-size:12px;}\n                            .captain_salary_content .captain_salary_item .item_common .item_task_detail{margin-left:20px;width:160px;text-align:right}\n                            .captain_salary_content .captain_salary_item .level_desc{width:30px;text-align:center;font-size:12px;margin-right:15px;}\n                            .captain_salary_level{padding-top:8px;display:none;position:relative}\n                            .captain_salary_level .refresh_control{cursor:pointer;margin-left:23px;}\n                            .captain_free_gift_modal,.task_finished_modal,.receive_gift_modal,.yesterday_summary_modal,.captain_rule_modal{position:fixed;display:none;background:rgba(51,51,51,0.8);top:0;left:0;width:100%;height:100%;z-index:100;align-items:center;justify-content:center;}\n                            .captain_free_gift_modal .captain_free_gift_content{color:#333333;font-size:16px;text-align:center;width:340px;height:366px;position:relative;background:url(https://dynamics-share.tuwan.com/activity/dc976b1a0a1d8cdc91bca78cbbaa0aea.png);}\n                            .captain_free_gift_modal .captain_free_gift_content img,.receive_gift_modal .receive_gift_content img{margin-bottom:10px}\n                            .captain_free_gift_modal .captain_free_gift_rule,.receive_gift_modal .receive_gift_info{margin-top:80px;margin-bottom:20px;}\n                            .captain_free_gift_modal .takeaway_free_gift{cursor:pointer;width:240px;height:40px;background:url(https://dynamics-share.tuwan.com/activity/25a012b3067bab9dbaea97400395216e.png);margin:0 auto;margin-top:15px;}\n                            .captain_free_gift_modal .free_gift_close,.task_finished_modal .gift_box_close,.receive_gift_modal .receive_gift_close{cursor:pointer;width:12px;height:12px;background:url(https://res.tuwan.com/templet/play/chat/auto/images/modal_close.png);position:absolute;top:15px;right:12px;}\n                            .task_finished_modal .task_finished_content{text-align:center;width:340px;height:366px;position:relative;background:url(https://res.tuwan.com/templet/play/chat/auto/images/finish_task_bg.png);}\n                            .task_finished_modal .task_finished_info{margin-top:80px;margin-bottom:20px;color:#333333;font-size:16px;}\n                            .task_finished_modal .task_finished_info span{color:#ff6691}\n                            .task_finished_modal .open_gift_box{cursor:pointer;width:240px;height:40px;background:url(https://res.tuwan.com/templet/play/chat/auto/images/open_box.png);margin:0 auto;margin-top:20px;}\n                            .receive_gift_modal .receive_gift_content{color:#333333;font-size:16px;text-align:center;width:340px;height:346px;position:relative;background:url(https://res.tuwan.com/templet/play/chat/auto/images/receive_gift_bg.png);}\n                            .receive_gift_modal .receive_gift{cursor:pointer;width:240px;height:40px;background:url(https://res.tuwan.com/templet/play/chat/auto/images/receive_gift_btn_bg.png);margin:0 auto;margin-top:20px;}\n                            .yesterday_summary_modal .yesterday_summary_content{text-align:center;width:361px;height:493px;position:relative;background:url(https://res.tuwan.com/templet/play/chat/auto/images/yesterday_summary.png);}\n                            .yesterday_summary_modal .yesterday_summary_title{width:308px;margin:0 auto;margin-top:80px;}\n                            .yesterday_summary_modal .yesterday_summary_info{margin:0 auto;margin-top:15px;margin-bottom:6px;color:#666666;font-size:14px;width:285px;}\n                            .yesterday_summary_modal .yesterday_summary_info a{text-decoration:underline;color:#666 !important}\n                            .yesterday_summary_modal .yesterday_summary_task_content{display:flex;align-items:center;justify-content:space-around;}\n                            .yesterday_summary_modal .yesterday_summary_task_content>div{width:100px;text-align:center}\n                            .yesterday_summary_modal .yesterday_summary_task_content .task_name{color:#666;font-size:14px;margin-top:10px;}\n                            .yesterday_summary_modal .yesterday_summary_task_content .task_num{color:#ff6691;font-size:16px;}\n                            .yesterday_summary_modal .yesterday_summary_content .task_info{display:flex;align-items:center;justify-content:space-around;width:280px;margin:0 auto;margin-top:10px;}\n                            .yesterday_summary_modal .yesterday_summary_content .task_info .left_info{color:#666666;font-size:14px;width:200px;text-align:left}\n                            .yesterday_summary_modal .yesterday_summary_content .task_info .right_info{color:#ff6691;font-size:14px;width:80px;text-align:right}\n                            .yesterday_summary_modal .yesterday_summary_content .yesterday_summary_alaso{cursor:pointer;width:240px;height:40px;background:url(https://res.tuwan.com/templet/play/chat/auto/images/alaso.png?v=1);margin:0 auto;margin-top:12px;}\n                            .yesterday_summary_modal .yesterday_summary_content .yesterday_summary_close{cursor:pointer;width:12px;height:12px;background:url(https://res.tuwan.com/templet/play/chat/auto/images/modal_close.png);position:absolute;top:24px;right:15px;}\n                            .channel_rule_modal{position:fixed;display:none;background:rgba(51,51,51,0.8);top:0;left:0;width:100%;height:100%;overflow:auto;z-index:101;justify-content:center;align-items:center}\n                            .channel_rule_close{position:absolute;width:12px;height:12px;top:10px;right:10px;background:url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png);cursor:pointer;}\n                            .channel_rule_content{position:relative;width:450px;height:464px;background:#fff;border-radius:10px;padding:0 35px;box-sizing:border-box;}\n                            .common_modal_title{font-size:20px;color:#333333;text-align:center;font-weight:bold;margin-top:26px;}\n                            .channel_rule_btn{font-size:14px;color:#ff5588;margin-left:20px;cursor:pointer;text-align: right;margin-right: 20px;}\n                            .channel_rule_sure{width:200px;height:46px;color:#fff;background:#ff5588;border-radius:10px;font-size:18px;text-align:center;line-height:46px;margin:0 auto;cursor:pointer;}\n                            .channel_rule_info{height:320px;margin-top:30px;overflow:auto;}\n                            .rule_info_item_title{font-size:16px;color:#333333;font-weight:bold;margin-bottom:10px;}\n                            .rule_info_item_content{font-size:14px;color:#666666;margin-bottom:10px;}\n                            .channel_rule_info::-webkit-scrollbar-track{background-color:transparent;}\n                            .channel_rule_info::-webkit-scrollbar{width:5px;height:5px;}\n                            .channel_rule_info::-webkit-scrollbar-thumb{border-radius:5px;background-color:#999999;}\n                            .captain_new_boss{display:none;font-size:14px;color:#666;}\n                            .captain_new_boss .text{padding:12px 34px 0;box-sizing:border-box}\n                            .common_captain_new_item{display:none;height:160px}\n                            .captain_text_item{line-height:20px}\n                            .captain_new_common_btn, .captain_new_common_btn_jiangli{font-size:14px;color:#fff;width:102px;height:28px;margin-left:12px;border-radius:15px;line-height:28px;text-align:center;cursor: pointer;background:#ff6691}\n                            .captain_new_boss .captain_readed_rule{margin-top:21px}\n                            .captain_new_boss .close_service{background:#999}\n                            .captain_new_rule .captain_new_rule_title{font-size:16px;margin-bottom:6px}\n                            .captain_new_boss .unabled_click{background:#ccc}\n                            .boss_item_list{padding-right:4px;box-sizing:border-box;}\n                            .boss_item_list .user_name{text-align: left;text-indent: 14px;width:180px}\n                            .boss_item_list .reward_info{flex:1;text-align:right;font-size:12px}\n                            .boss_item_list span{color:#ff6691}\n                            .captian_new_boss_task_content{display:none;height:160px;padding-top:10px;box-sizing:border-box;flex-direction: column;}\n                            .boss_content_list{overflow:auto;margin-bottom:6px}\n                            .new_boss_list{height:270px;list-style:none;overflow:auto}\n                            .new_boss_list li{align-items:center;width:320px;color:#999999;height:60px;font-size:12px;border-radius:10px;background:#f7f7f7;margin:0 auto;margin-bottom:10px;padding-left:10px;box-sizing:border-box}\n                            .new_boss_list li img{width:53px;height:53px;border-radius:50%;margin-right:16px;}\n                            .new_boss_list li .boss_name{color:#666;margin-right:10px;margin-bottom:4px;display:inline-block}\n\n                            .captain_new_jiangli{\n                                max-height:\n                            }\n                            .captain_jianli_box{\n                                display:flex;\n                                flex-direction: column;\n                                justify-content: center;\n                                align-items: center;\n                                border:solid 1px #ccc;\n                                border-radius:8px;\n                                width:336px;\n                                margin:0 auto;\n                                margin-top:10px;\n                                padding:10px 0\n                            }\n                            .captain_jianli_item{\n                                display:flex;\n                                justify-content: center;\n                                align-items: center;\n                                border:solid 1px #ccc;\n                                border-radius:8px;\n                                width:336px;\n                                margin:0 auto;\n                                margin-top:10px;\n                                padding:10px;\n                                box-sizing: border-box;\n                            }\n                            .captain_jianli_box.select{\n                                border:solid 1px #ff5588;\n                            }\n                            .captain_fengceng_bili{font-size:14px;color:#ff5588; text-align:center; font-weight:bold;}\n                            .captain_yestoday_liushui{text-align:center; color:#999;font-size:12px;}\n                            .captain_jianli_box_list{margin-bottom:10px;}\n                            .task_sign{cursor: pointer}\n                            .captain_sign_modal{position:fixed;display:none;;background:rgba(51,51,51,0.8);top:0;left:0;width:100%;height:100%;overflow:auto;z-index:101;justify-content:center;align-items:center}\n                            .captain_sign_content{position:relative;width:380px;;background:#fff;border-radius:10px;padding:0 35px;box-sizing:border-box;text-align:center}\n                            .captain_sign_title{font-size:24px;color:#333;margin:30px auto 50px}\n                            .captain_sign_info{font-size:16px;color:#666;margin-bottom:58px}\n                            .captain_sign_close{position:absolute;width:12px;height:12px;top:10px;right:10px;background:url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png);cursor:pointer;}\n                            .captain_sign_sure{cursor: pointer;width: 260px;height: 65px;margin:0 auto 30px;background: #FF6691;color:#fff;font-size:24px;text-align:center;line-height:65px;border-radius: 44px;}\n                            .task_name span{background:#FF6691;width:30px;height:20px;border-radius:4px;color:#fff;margin-left:4px;padding:0 4px;font-size:12px;cursor: pointer;}\n\n\n                            .captain_gift_modal{position:fixed;display:none;background:rgba(51,51,51,0.8);top:0;left:0;width:100%;height:100%;overflow:auto;z-index:101;justify-content:center;align-items:center}\n                            .captain_gift_content {position:relative;width: 552px;height: 608px;background: #FFFFFF;border-radius: 16px;display: flex;flex-direction: column;align-items: center;overflow: hidden;position: relative;text-align: center;}\n                            .captain_gift_modal .captain_gift_title {color: #FA7399;font-size: 40px;margin-top: 30px;font-weight:bold}\n                            .captain_gift_modal .captain_gift_desc {color: #333333;margin: 50px auto 70px;font-size:26px}\n                            .captain_gift_modal .captain_gift_sure {cursor: pointer;width: 324px;height: 80px;background: #FF6691;border-radius: 40px;display: flex;align-items: center;justify-content: center;color: #ffffff;font-size: 32px;margin: 80px auto 0;}\n                            .captain_gift_modal .captain_gift_detail_content {display: flex;align-items: center;justify-content: center;}\n                            .captain_gift_modal .captain_gift_item {position:relative;width: 142px;height: 169px;background: url(https://asset.tuwan.com/chatroom/images/captain_gift_item.png);margin: 0 12px;color: #333333;font-size: 20px;}\n                            .captain_gift_modal .gift_item_pic {position:absolute;top:50%;left:50%;transform: translate(-50%, -50%);width: 130px;height: 130px;margin: 0 auto 10px;display: flex;align-items: center;justify-content: center;}\n                            .captain_gift_modal .gift_item_text {position:absolute;bottom:10px;left:50%;transform: translateX(-50%);width: 130px;text-align:center}\n                            .captain_gift_modal .gift_item_pic img {width:100%;}\n                            .captain_gift_close{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_close.png) no-repeat center center;right: 4px;top: 10px;cursor: pointer;}\n                            .captain_gift_icon{margin:-4px 0 0 10px;cursor: pointer;}\n                    </style>")}getListHtml(t){let e="";return t.forEach((t=>{const{msg:n,total:i,process:o,dblock:s,unit:a,type:r,h5msg:c,h5url:l,open_type:d,progress_bar:m=0,title_toast:h="",welcomeTypeid:u,buttonType:p,redDotState:g,buttonState:f,buttonTitle:w}=t,v=2==r?1==s?o+a:c:`${o}/${i+a}`,_=2!=r;let y="";y=3==r?`<div style="width:52px" data-type="${u}" data-state="${f}" class="task_process take_task_gift captain_taks_item ${1==f?"act_cur":"task_finished"}">${w}</div>`:"load"===d?`<div style="width:52px" data-href="${l}" class="task_process task_sign open_iframe captain_taks_item">${v}</div>`:1===p?`<div style="width:52px" data-href="${l}" class="task_process task_sign open_iframe ${1===g?"has_reward":"no_reward"}"></div>`:`<a href="${2==r?l:"javascript:void(0)"}" ${2==r?'target="_blank"':""} style="width:52px;" class="task_process captain_taks_item ${1==s?"task_finished":""}">${1==s?"已完成":"进行中"}</a>`,e+=`<div class="task_item_list big_line">\n                            <div class="task_name">\n                                <div class="flex flex-ac" style="margin-top: ${_?"4px":"0px"}">\n                                    <p style="line-height: ${_?"inherit":"46px"};">${n}${_?`(${v})`:""}</p>\n                                    ${h&&h.length?`<img class="info" src="https://dynamics-share.tuwan.com/activity/bd4cb44c24bb548185b5642d987450a5.png" original-title="${h}"/>`:""}\n                                </div>\n                                ${_?`<div class="progressBar"><div class="progress" style="width: ${m/1e3*100}%;"></div></div>`:""}\n                            </div>\n                            ${y}\n                        </div>`})),e}getLrlistHtml(t,e){let n="";return t&&t.length&&(n+=`<div class="common_title" style="margin-top:10px;display:${1==e?"none":"flex"}">周薪队长任务</div>`,t.forEach((t=>{const{msg:i,total:o,process:s,dblock:a,unit:r,progress_bar:c=0,title_toast:l=""}=t;n+=`<div class="task_item_list big_line" style="display:${1==e?"none":"flex"}">\n                                <div class="task_name">\n                                    <div class="flex flex-ac" style="margin-top: 4px;">\n                                        <p>${i}(${`${s}/${o+r}`})</p>\n                                        ${l&&l.length?`<img class="info" src="https://dynamics-share.tuwan.com/activity/bd4cb44c24bb548185b5642d987450a5.png" original-title="${l}"/>`:""}\n                                    </div>\n                                    <div class="progressBar"><div class="progress" style="width: ${c/1e3*100}%;"></div></div>\n                                </div>\n                                <div style="width:52px;" class="task_process captain_week_task ${1==a?"task_finished":""}">${1==a?"已完成":"进行中"}</div>\n                            </div>`}))),n}loadCaptainTask(t){qt.get(Pt+`/Captain/infonew?cid=${this.cid}&ver=3`).then((e=>{if(0==e.error){let{list:n,lrlist:i,dlist:o,num:s,msg:a,giftPic:r,giftName:c,captain_type:l,button:d,guidance_task:m,guagua_type:h,money_pack_state:u,broadcast_msg:p}=e.data;if(this.totalDay=s,this.takeawayMsg=a,this.globalGiftPic=r,this.globalGiftName=c,0==t){let t=`<div class="captain_task">\n                                        <div class="tab_content">\n                                            <div class="task_history_content">\n                                                <p class="tab_item current">任务</p>\n                                                <p style="display:${2==l?"none":"block"}" class="tab_item captain_salary_item">时薪</p>\n                                                <p style="display:${2==l||1==h?"none":"block"}" class="tab_item"></p>\n                                                <p class="tab_item" style="display:${1==m?"block":"none"}">新人</p>\n                                                <p class="tab_item tab-jiangli-text" style="display:none" data-type="jiangli">奖励</p>\n                                            </div>\n                                        </div>\n                                        <div class="task_content">\n                                            <div class="task_compliance_notice"></div>\n                                            <div class="task_list nav_item">\n                                                <div class="task_content_detail ygb_common_scroll">\n                                                    <img class="task_rule_tips tips_item" data-ranktype="task" src="https://res.tuwan.com/templet/play/chat/auto/images/question.png">`;if(o&&(t+='<div class="common_title">值班期打卡</div>',o.forEach((e=>{const{msg:n,dblock:i,is_first_sign:o,title_toast:s=""}=e;let a=1==i?"已打卡":"打卡";t+=`<div class="task_item_list big_line">\n                                            <div class="task_name">\n                                                <div class="flex flex-ac">\n                                                    <p style="line-height: 46px;">${n}</p>\n                                                    ${s&&s.length?`<img class="info" src="https://dynamics-share.tuwan.com/activity/74590843ab875802a16bd4b419372e66.png" original-title="${s}"/>`:""}\n                                                </div>\n                                            </div>\n                                            <div style="width:${a.length>5?"100px":"52px"}" data-is_first_sign="${o?1:0}" data-issign="${i}" class="task_process task_sign ${1==i?"task_finished":""}">${a}</div>\n                                        </div>`}))),t+=`<div class="common_title">队长每日任务<img class="captain_gift_icon" style="display:${1==u?"inline-block":"none"}" src="https://asset.tuwan.com/chatroom/images/gift_box_icon.png"></div>`,t+='<div class="list_and_lrlist_container">',t+=this.getListHtml(n),t+=this.getLrlistHtml(i,l),t+="</div>",t+='<div class="common_title">历史队友</div>\n                                <div class="history_user_list"></div>\n                                </div>\n                                <div class="task_bottom">\n                                    <div class="task_status_btn">\n                                        <p class="title"></p>\n                                        <p class="desc"></p>\n                                    </div>\n                                    <img class="refresh_btn" style="margin-left:10px; width: 16px; cursor: pointer;" src="https://res.tuwan.com/templet/play/chat/chatv2/images/shuaxin.png">\n                                    <div class="channel_rule_btn">规章制度</div>\n                                    <img class="arrow_control" src="https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png">\n                                </div>\n                            </div>\n                            <div class="captain_salary_level nav_item">\n                                <div class="captain_salary_detail ygb_common_scroll">\n                                    <div class="title_day title_item">\n                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/left_bg.png">\n                                        <div class="title_name_item captain_salary_title">时薪升级任务</div>\n                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/right_bg.png">\n                                    </div>\n                                    <div class="captain_salary_content"></div>\n                                </div>\n                                <div class="captain_rank_info">\n                                    <a href="/home/captaininfo" target="_blank" style="display:flex;align-items:center;">\n                                        <img class="captain_level_avatar" src="">\n                                        <div class="captain_desc_content">\n                                            <div>点亮任务会增加下周时薪哦~</div>\n                                            <div class="captain_next_week_salary captain_desc_info"></div>\n                                        </div>\n                                    </a>\n                                    <img class="refresh_control" src="https://res.tuwan.com/templet/play/chat/chatv2/images/level_refresh.png">\n                                    <img class="arrow_control" style="margin-left:10px;cursor: pointer" src="https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png">\n                                </div>\n                            </div>\n                            <div class="captain_week_score_list nav_item" style="padding-top:8px;display:none;text-align:center;position:relative"></div>\n                            <div class="captain_new_boss nav_item">\n                                <div class="captian_new_boss_rule_content"></div>\n                                <div class="captian_new_boss_task_content"></div>\n                                <div class="task_bottom">\n                                    <div class="captain_new_common_btn"></div>\n                                    <img class="arrow_control" style="margin-left:216px" src="https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png">\n                                </div>\n                            </div>\n                            <div class="captain_new_jiangli nav_item" style="display:none;">\n                                <div class="captain_new_jiangli_scroll ygb_common_scroll" style="height:192px; overflow-y:auto; ">\n                                    <div class="captain_jianli_box captain_jianli_box_select select">\n                                        <p class="captain_fengceng_bili"></p>\n                                        <p class="captain_yestoday_liushui"></p>\n                                    </div>\n                                    <div class="captain_jianli_box_list">\n\n                                    </div>\n                                </div>\n\n                                <div class="task_bottom">\n                                    <div class="captain_new_common_btn_jiangli yesterday_summary_1">昨日总结</div>\n                                    <img class="arrow_control" style="margin-left:216px" src="https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png">\n                                </div>\n                            </div>\n                        </div>\n                    </div>',window.$(".chat-center-window").append(t),p&&p.length&&uh.getInstance().showTaskNotice(p),(new Date).getTime()<new Date("2021-03-28 23:59:59").getTime()||window.$(".channel_rule_btn").css("flex",1),window.$(".captain_task").length>1&&window.$(".captain_task")[0].remove(),this.loadHistoryUserList(),this.yesterdaySummary(),this.initCaptainSalaryInfo(),this.loadNewBossTask(),this.loadNewBossInfo(),this.loadJiangliData(),1==h)return;this.initCaptainRankData(),this.updateTaskBtnStatus(),window.$(".captain_task .task_item_list .info").tooltip({align:"top",html:!0})}else $(".captain_task .list_and_lrlist_container").html(this.getListHtml(n)+this.getLrlistHtml(i))}}))}loadBossHis(){qt.get(Pt+"/Newpersonguidance/history?platform=1").then((t=>{if(0==t.error){const e=t.data;let n='<ul class="new_boss_list ygb_common_scroll">';e.forEach((t=>{n+=`<li class="ygb_flex">\n                                <img src="${t.avatar}" />\n                                <div>\n                                    <div>\n                                        <span class="boss_name">${t.nickName}</span>\n                                        <span class="take_boss_time">${t.date}</span>\n                                    </div>\n                                    <div> 礼物收入：${t.giftIncome}，奖励${t.award}</div>\n                                </div>\n                            </li>`})),n+="</ul>",window.$(".rule_info").html(n),window.$(".rule_title").html("引导新人开黑记录"),window.$(".captain_rule_modal").css("display","flex")}}))}loadNewBossInfo(){qt.get(Pt+`/Newpersonguidance/user?cid=${this.cid}&platform=1`).then((t=>{0==t.error&&this.renderNewBossInfo(t)}))}loadNewBossTask(){qt.get(Pt+"/Newpersonguidance/tasks?platform=1").then((t=>{if(0==t.error){const{enrollStatus:e,codeStatus:n,noteContent:i,noteTitle:o,introduceContent:s,introduceTitle:a,user:r,userTitle:c,taskCompleteNum:l,taskNum:d,taskTitle:m}=t.data;if(0==e){let t=`<div class="captain_new_begin text common_captain_new_item">\n                                            <div>${a} </div>\n                                            ${this.renderRuleList(s)}\n                                        </div>\n                                        <div class="captain_new_rule text common_captain_new_item">\n                                            <div class="captain_new_rule_title">${o}</div>\n                                            ${this.renderRuleList(i)}\n                                        </div>`;window.$(".captian_new_boss_rule_content").html(t),window.$(".captain_new_common_btn").html("立即参与"),window.$(".captain_new_common_btn").attr("data-type","joinNow"),window.$(".captain_new_begin").show()}this.renderNewBossList(t.data,e)}}))}renderNewBossInfo(t){const{uid:e,nickname:n,avatar:i,inviteid:o,gname:s,time:a,title:r,introduce:c}=t.data;if(!e)return;let l=` <div style="color: #666666; font-size: 18px; text-align: center;margin:10px 0">${r}</div>\n                        <div style="text-align: center;">\n                            <img class="newuser-header" src="${i}" />\n                        </div>\n                        <div class="flex newuser-info">\n                            <div class="newuser-name">${n}</div>\n                            <div class="flex newuser-other">\n                                <span>${a}</span>\n                                <span>${s}</span>\n                            </div>\n                        </div>\n                        <div class="flex newuser-op-button">\n                            <span class="hulue new_boss_btn_item" data-type="2" data-uid="${e}" data-inviteid="${o}">忽略</span>\n                            <span class="yaoqing new_boss_btn_item" data-type="1" data-uid="${e}" data-inviteid="${o}">邀请</span>\n                        </div>\n                        <ul class="newuser-introl">`;c.forEach((t=>{l+=`<li>${t}</li>`})),l+="</ul>",window.$(".teamer-to-newuser").html(l),window.$(".teamer-daixin").css("display","flex"),window.$(".new_msg_tips")[0].play()}captainInviteid(t,e,n){qt.get(Pt+`/Newpersonguidance/invite?platform=1&status=${t}&uid=${e}&inviteid=${n}`).then((t=>{0==t.error?(window.$(".teamer-to-newuser").html(""),window.$(".teamer-daixin").hide()):(0==t.code?uu.isAutoRoom()&&this.emitter.emit("creatTeam",e):(window.$(".teamer-to-newuser").html(""),window.$(".teamer-daixin").hide()),Vt(t.error_msg))}))}renderNewBossList(t,e){const{codeStatus:n,user:i,userTitle:o,taskCompleteNum:s,taskNum:a,taskTitle:r,taskContent:c}=t;let l=` <div class="common_title" style="margin-top:0px">\n                        ${r}\n                        <img class="new_boss_que tips_item" data-ranktype="boss" src="https://res.tuwan.com/templet/play/chat/auto/images/question.png">\n                    </div>\n                    <div class="task_item_list">\n                        <div class="task_name">${c}</div>\n                        <div class="task_process week_task ${s==a?"task_finished":""}">${s}/${a}</div>\n                    </div>\n                    <div class="common_title" style="margin-top:10px;">${o}<span class="new_boss_his">历史记录</span></div><div class="boss_content_list ygb_common_scroll">`;i.length>0?(i.forEach((t=>{l+=`<div class="boss_item_list">\n                            <div class="user_name">${t.nickName}</div>\n                            <div class="reward_info">礼物${t.giftIncome}，<span>奖励${t.award}</span></div>\n                        </div>`})),l+="</div>"):l+='<div style="text-align:center">暂无记录</div>',0==e?window.$(".captian_new_boss_task_content").hide():(window.$(".captian_new_boss_rule_content").remove(),window.$(".captian_new_boss_task_content").css("display","flex"),this.renderChangeStatus(n)),window.$(".captian_new_boss_task_content").html(l)}changeCaptainStatus(t){qt.get(Pt+`/Newpersonguidance/code?platform=1&status=${t}`).then((e=>{0==e.error?this.renderChangeStatus(t):Vt(e.error_msg)}))}renderChangeStatus(t){1==t?(window.$(".captain_new_common_btn").addClass("close_service"),window.$(".captain_new_common_btn").attr("data-type","close"),window.$(".captain_new_common_btn").html("关闭服务")):0==t&&(window.$(".captain_new_common_btn").removeClass("close_service"),window.$(".captain_new_common_btn").attr("data-type","open"),window.$(".captain_new_common_btn").html("开启服务"))}captainEnroll(){qt.get(Pt+"/Newpersonguidance/enroll?platform=1").then((t=>{0==t.error?(window.$(".captian_new_boss_rule_content").remove(),this.loadNewBossTask()):Vt(t.error_msg)}))}renderRuleList(t){let e="";return t.forEach((t=>{e+=`<div class="captain_text_item">${t}</div>`})),e}initCaptainSalaryInfo(){qt.get(Pt+`/Chatroomcaptain/taskShow5?cid=${this.cid}`).then((t=>{if(0==t.error){const{level:e,now_level_pc:n,avatar:i,captainLevel:o}=t;this.globalNowLevel=n;let s="";for(let t=0;t<e.length;t++){let i,o="";t==n?(i="https://res.tuwan.com/templet/play/chat/chatv2/images/now_level.png",o="#ff5588"):t<n?(i="https://res.tuwan.com/templet/play/chat/chatv2/images/pre_level.png",o="#cccccc"):t>n&&(i="https://res.tuwan.com/templet/play/chat/chatv2/images/next_level.png",o="#999999"),s+=`<div class="captain_salary_item">\n                                            <div class="level_desc">\n                                                <img style="margin-top:3px;" src='${i}'>\n                                                <div style="color:${o}">${e[t].salaryname}</div>\n                                            </div>\n                                            <div class='item_common item_${t+1}' style="color:${o}"><div><span style="font-size:24px;">${e[t].salary}点点币</span>/时薪</div>\n                                            <div class="item_task_detail">`;let a=e[t].taskinfo;for(let t=0;t<a.length;t++){const{taskname:e,taskunit:n,nowtaskcount:i,typeid:o,taskcount:r,tasktotalcount:c}=a[t];s+=1==o?`<div style="color:${c>i?"#ff5588":""}">${e+i+n}/${r}</div>`:2==o?`<div style="color:${c>i?"":"#ff5588"}">${e}</div>`:`<div style="color:${c==i?"#ff5588":""}">${e+i+n}/${c+n}</div>`}s+="</div></div></div>"}window.$(".captain_salary_content").html(s),window.$(".captain_level_avatar").attr("src",i),window.$(".captain_next_week_salary").html(`<span style="color:#999">已达到${o[n]}队长</span><span style="color:#ff5588">下周时薪为${e[n].salary}点点币/小时</span>`)}}))}initCaptainRankData(){qt.get(zt+"/captain/getUserScore?format=jsonp&type=week&ver=1&prev=0").then((t=>{if(0==t.error){const{score:e,rank:n,avatar:i,desc:o,diffsocre:s}=t.data,a=`<div class="captain_week_rank_detail">\n                                                <div class="title_week title_item">\n                                                    <img src="https://res.tuwan.com/templet/play/chat/auto/images/left_bg.png">\n                                                    <div class="title_name_item captain_week_rank_title"></div>\n                                                    <img src="https://res.tuwan.com/templet/play/chat/auto/images/right_bg.png">\n                                                </div>\n                                                <img class="captain_rule_tips tips_item" data-ranktype="week" src="https://res.tuwan.com/templet/play/chat/auto/images/question.png">\n                                                <div>\n                                                    <div class="title_nav">\n                                                        <span style="margin-left:24px">排名</span>\n                                                        <span style="margin-left:20px">队长昵称</span>\n                                                        <span style="margin-left:18px">得分</span>\n                                                        <span style="margin-left:70px">奖励</span>\n                                                    </div>\n                                                    <ul class="captain_rank_list ygb_common_scroll"></ul>\n                                                </div>\n                                            </div>\n                                            <div class="captain_rank_info">\n                                                <a href="https://y.tuwan.com/home/captainrank/" target="_blank" style="display:flex;align-items:center;">\n                                                    <img class="captain_avatar" style="" src="${i}">\n                                                    <div class="captain_desc_content">\n                                                        <div>我的周榜<span>${e}</span>分，排名<span>${n}</span>名</div>\n                                                        <div class="captain_desc_info">${o}</div>\n                                                    </div>\n                                                </a>\n                                                <img class="arrow_control" style="margin-left:57px;" src="https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png">\n                                            </div>`;window.$(".captain_week_score_list").html(a),this.renderRankList()}}))}renderRankList(){qt.get(zt+"/captain/getScoreRank?format=jsonp&ver=1&limit=10&type=week&prev=0").then((t=>{if(0==t.error){const e=t.data.list,n=t.data.list_type,i=t.data.menu_name;this.globalMenuName=i,this.globalMenuType=n;const o=this.renderDataList(e);window.$(".captain_week_rank_detail .captain_rank_list").html(o),window.$(".tab_item").eq(2).html(`${i}周榜`),window.$(".tab_item").eq(1).html(`${i}时薪`),window.$(".captain_salary_title").html(`${i}时薪升级任务`),window.$(".captain_week_rank_title").html(`${i}排行榜-周榜`)}}))}renderDataList(t){let e="",n="",i="",o="";for(let s=0;s<t.length;s++){let a="";s<=2?(n=`top_${s+1}`,i="",o="#ff5588"):(n="top",i=t[s].rank,o="#999"),a=`<div style="color:${o};flex:1;text-align:left;margin-left:16px;">${t[s].prize?t[s].prize.join("+"):""}</div>`,e+=`<li>\n                        <div class="${n}"><span>${i}</span></div>\n                        <div class="captain_rank_list_name" style="color:${o};">${t[s].nickname}</div>\n                        <div class="captain_rank_list_score" style="color:${o};">${t[s].score}</div>${a}\n                    </li>`}return e}loadHistoryUserList(){qt.get(Pt+"/Captain/history").then((t=>{if(0==t.error){const e=t.data;let n="";for(let t=0;t<e.length;t++){const i=e[t].zpack_typeid>0?`<span data-uid="${e[t].uid}">老板</span>`:"";n+=`<div class="task_item_list">\n                                        <div class="task_name">${e[t].name+i}</div>\n                                        <div class="user_status ${0==e[t].online?"task_finished":""}" data-username="${e[t].name}" data-userid="${e[t].uid}">私信</div>\n                                    </div>`}0==e.length?window.$(".history_user_list").prev().hide():window.$(".history_user_list").html(n)}}))}yesterdaySummary(){qt.get(Pt+"/Captain/summary").then((t=>{if(0==t.error){const{giftAllDiamond:e,fleetNum:n,userNum:i,giftBothDiamond:o,giftImDiamond:s,giftFleetDiamond:a,newMsg:r}=t.data;let c=`<div class="yesterday_summary_modal">\n                                            <div class="yesterday_summary_content">\n                                                <img class="yesterday_summary_title" src="https://res.tuwan.com/templet/play/chat/auto/images/yesterday_summary_title.png">\n                                                <div class="yesterday_summary_info">\n                                                    ${r}\n                                                    <a target="_blank" href="https://y.tuwan.com/home/captainrank/">查看排行榜</a></p>\n                                                </div>\n                                                <div class="yesterday_summary_task_content">\n                                                    <div>\n                                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/diamond_icon.png">\n                                                        <p class="task_name">礼物</p>\n                                                        <p class="task_num">${e}钻</p>\n                                                    </div>\n                                                    <div>\n                                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/drive_car_icon.png">\n                                                        <p class="task_name">开车数</p>\n                                                        <p class="task_num">${n}次</p>\n                                                    </div>\n                                                    <div>\n                                                        <img src="https://res.tuwan.com/templet/play/chat/auto/images/take_boss.png">\n                                                        <p class="task_name">带老板</p>\n                                                        <p class="task_num">${i}次</p>\n                                                    </div>\n                                                </div>\n                                                <div class="task_info">\n                                                    <p class="left_info">送过礼物的好友礼物</p>\n                                                    <p class="right_info">${o}钻</p>\n                                                </div>\n                                                <div class="task_info">\n                                                    <p class="left_info">私聊过的好友礼物</p>\n                                                    <p class="right_info">${s}钻</p>\n                                                </div>\n                                                <div class="task_info">\n                                                    <p class="left_info">开过车的队友礼物</p>\n                                                    <p class="right_info">${a}钻</p>\n                                                </div>\n                                                <div class="yesterday_summary_alaso"></div>\n                                                <div class="yesterday_summary_close"></div>\n                                            </div>\n                                        </div>\n                                        <div class="captain_free_gift_modal">\n                                            <div class="captain_free_gift_content">\n                                                <div class="captain_free_gift_rule">${this.takeawayMsg}</div>\n                                                <img src="${this.globalGiftPic}">\n                                                <div>${this.globalGiftName}</div>\n                                                <div class="takeaway_free_gift"></div>\n                                                <div class="free_gift_close"></div>\n                                            </div>\n                                        </div>\n                                        <div class="task_finished_modal">\n                                            <div class="task_finished_content">\n                                                <div class="task_finished_info">\n                                                    本月已连续<span>${this.totalDay}天</span>完成任务\n                                                </div>\n                                                <img src="https://res.tuwan.com/templet/play/chat/auto/images/gift_box.png?v=1">\n                                                <div class="open_gift_box"></div>\n                                                <div class="gift_box_close"></div>\n                                            </div>\n                                        </div>\n                                        <div class="receive_gift_modal">\n                                            <div class="receive_gift_content">\n                                                <div class="receive_gift_info"></div>\n                                                <img src="">\n                                                <div class="receive_gift"></div>\n                                                <div class="receive_gift_close"></div>\n                                            </div>\n                                        </div>\n                                        <div class="captain_rule_modal">\n                                            <div class="captain_rule_content">\n                                                <div class="rule_close"></div>\n                                                <div class="rule_title"></div>\n                                                <div class="rule_info">\n                                                </div>\n                                                <div class="rule_alaso">知道了</div>\n                                            </div>\n                                        </div>\n                                        <div class="channel_rule_modal">\n                                            <div class="channel_rule_content">\n                                                <div class="channel_rule_close"></div>\n                                                <div class="common_modal_title">规章制度</div>\n                                                <div class="channel_rule_info">\n\n                                                </div>\n                                                <div class="channel_rule_sure">知道了</div>\n                                            </div>\n                                        </div>\n                                        <div class="captain_sign_modal">\n                                            <div class="captain_sign_content">\n                                                <div class="captain_sign_close"></div>\n                                                <div class="captain_sign_title">打卡提醒</div>\n                                                <div class="captain_sign_info">\n                                                </div>\n                                                <div class="captain_sign_sure">知道了</div>\n                                            </div>\n                                        </div>\n                                        <div class="captain_gift_modal">\n                                            <div class="captain_gift_content">\n                                                <div class="captain_gift_close"></div>\n                                                <div class="captain_gift_title"></div>\n                                                <div class="captain_gift_desc"></div>\n                                                <div class="captain_gift_detail_content">\n                                                </div>\n                                                <div class="captain_gift_sure"></div>\n                                            </div>\n                                        </div>`;window.$("body").append(c),this.initCaptainEvents(),this.getRuleInfo()}}))}getRuleInfo(){qt.get(Pt+`/chatroomrule/ruleinfo?cid=${this.cid}`).then((t=>{if(0==t.error){let e="";t.data.forEach((t=>{e+=`<div class="rule_info_item_title">${t.type}</div>\n                            <div class="rule_info_item_content">`,0!==t.content.length&&t.content.forEach(((t,n)=>{e+=`<div>${n+1}、${t}</div>`})),e+="</div>"})),window.$(".channel_rule_info").html(e)}}))}loadJiangliData(){qt.get(Pt+"/captain/isaward?test=1").then((t=>{if(0==t.error&&1==t.data.is_award){const e=t.data.title;window.$(".tab-jiangli-text").text(e),this.loadJiangliList(),window.$(".tab-jiangli-text").show()}}))}loadJiangliList(){qt.get(Pt+"/captain/getAwardList").then((t=>{if(0==t.error){const e=t.data,n=e.today_award,i=e.task_list||[];let o=n?'\n                <p class="captain_fengceng_bili">'+n.title+'</p>\n                <p class="captain_yestoday_liushui">'+n.text+"</p>":"";o&&o.length?(window.$(".captain_jianli_box_select").html(o),window.$(".captain_jianli_box_select").show()):window.$(".captain_jianli_box_select").hide();let s=[];i.forEach((t=>{s.push('<div class="flex captain_jianli_item">\n                                <img style="width:25px;height:26px; margin-right:5px;" src="https://res.tuwan.com/templet/play/images/liushuiicon.png" />\n                                <div class="flex flex-1 flex-dir-col">\n                                    <div class="flex flex-ac" style="color:'+(1==t.is_finish?"red":"#666")+'">\n                                        <div class="flex-1" style="font-size:14px;color:#666;">'+t.title+'</div>\n                                        <div style="font-size:12px;color:#666;">'+t.progress+'</div>\n                                    </div>\n                                    <div style="font-size:12px;color:#999;">'+t.text+"</div>\n                                </div>\n                            </div>")})),window.$(".captain_jianli_box_list").html(s.join(""))}}))}showSignModal(t){window.$(".captain_sign_info").html(t),window.$(".captain_sign_modal").css("display","flex")}captainGiftModal(){qt.get(Pt+"/usernew/getMoneyPack").then((t=>{if(0==t.error){window.$(".captain_gift_modal").css("display","flex"),window.$(".captain_gift_title").html(t.data.title),window.$(".captain_gift_desc").html(t.data.desc);let e="",n="";t.data.reward.forEach((t=>{e+=`<div class="captain_gift_item">\n                            <div class="gift_item_pic">\n                                <img src="${t.icon}">\n                            </div>\n                            <div class="gift_item_text">${t.title}</div>\n                        </div>`})),1==t.data.state?n="未完成":2==t.data.state?n="领取奖励":3==t.data.state&&(n="已发放"),this.level=t.data.level,2!=t.data.state?window.$(".captain_gift_sure").css("background","rgba(255, 102, 145, .5)"):window.$(".captain_gift_sure").css("background","#FF6691"),window.$(".captain_gift_sure").attr("data-state",t.data.state),window.$(".captain_gift_sure").html(n),window.$(".captain_gift_detail_content").html(e)}}))}updateTaskBtnStatus(){qt.get(Pt+`/captain/getsignstate?cid=${this.cid}`).then((t=>{const e=window.$(".task_status_btn");e.find(".title").text(t.data.content1);const n=t.data.state,i=t.data.content2;this.is_first_sign=t.data.is_first_sign,i&&i.length?e.find(".desc").text(i).show():e.find(".desc").hide(),e.data("type",n),3==n||5==n?e.removeClass("disable"):e.addClass("disable"),e.css({display:"flex"})}))}dakaReq(){const t=this;qt.get(`${Pt}/captainsign/dosign?cid=${t.cid}`).then((e=>{0==e.error?t.loadCaptainTask(0):Vt(e.error_msg)}))}initCaptainEvents(){const t=window.$(".captain_task"),e=window.$(".captain_free_gift_modal"),n=window.$(".task_finished_modal"),i=window.$(".captain_sign_modal"),o=window.$(".receive_gift_modal"),s=window.$(".yesterday_summary_modal"),a=window.$(".captain_rule_modal"),r=window.$(".channel_rule_modal"),c=window.$(".captain_gift_modal"),l=window.$(".captain_new_boss"),d=window.$(".teamer-daixin"),m=this;t.on("click",".history_user_list .task_name span",(function(){qt.get(`${Pt}/usernew/getZPack?uid=${this.dataset.uid}`).then((t=>{0==t.error&&Vi.getInstance().showModal(t.data)}))})),t.on("click",".task_history_content .tab_item",(function(){window.$(".task_history_content .tab_item").removeClass().addClass("tab_item"),window.$(".task_content .nav_item").hide();const t=window.$(this).index();window.$(".task_content .nav_item").eq(t).show(),window.$(".task_history_content .tab_item").eq(t).addClass("current"),1==t&&m.globalNowLevel>0&&window.$(".captain_salary_detail").scrollTop(52)})),t.on("click",".task_status_btn",(function(){switch($(this).data("type")){case 3:e.css("display","flex");break;case 5:n.css("display","flex")}})),t.on("click",".refresh_btn",(function(){m.loadCaptainTask(1)})),t.on("click",".user_status",(function(){const t=this.dataset.userid;this.dataset.username,bh(t)})),t.on("click",".refresh_control",(function(){m.initCaptainSalaryInfo()})),t.on("click",".arrow_control",(function(){0==m.arrowIsBottom?(window.$(".title_day").animate({opacity:1}),window.$(".title_week").animate({opacity:1}),window.$(".captain_rule_tips").animate({opacity:1}),window.$(".arrow_control").attr("src","https://res.tuwan.com/templet/play/chat/chatv2/images/top_arrow.png"),window.$(".task_content_detail").animate({height:"250px"}),window.$(".title_nav").animate({"margin-top":"17px"}),window.$(".captain_salary_content").animate({"margin-top":"17px"}),window.$(".captain_week_score_list").animate({"padding-top":"18px"}),window.$(".captain_rank_list").animate({height:"144px"}),window.$(".captain_week_rank_detail").animate({height:"224px"}),window.$(".captian_new_boss_rule_content").animate({height:"250px"}),window.$(".captian_new_boss_task_content").animate({height:"250px"}),window.$(".captain_salary_detail").animate({height:"224px"}),window.$(".captain_new_jiangli_scroll").animate({height:"250px"}),m.arrowIsBottom=1):1==m.arrowIsBottom&&(window.$(".title_day").animate({opacity:0}),window.$(".title_week").animate({opacity:0}),window.$(".captain_rule_tips").animate({opacity:0}),window.$(".arrow_control").attr("src","https://res.tuwan.com/templet/play/chat/chatv2/images/bottom_arrow.png"),window.$(".task_content_detail").animate({height:"152px"}),window.$(".title_nav").animate({"margin-top":"-24px"}),window.$(".captain_salary_content").animate({"margin-top":"-24px"}),window.$(".captain_week_score_list").animate({"padding-top":"8px"}),window.$(".captain_rank_list").animate({height:"113px"}),window.$(".captain_salary_detail").animate({height:"138px"}),window.$(".captain_week_rank_detail").animate({height:"138px"}),window.$(".captian_new_boss_rule_content").animate({height:"160px"}),window.$(".captian_new_boss_task_content").animate({height:"160px"}),window.$(".captain_new_jiangli_scroll").animate({height:"192px"}),m.arrowIsBottom=0)})),t.on("click",".yesterday_summary_1",(function(){s.css("display","flex")})),t.on("click",".task_sign",(function(){const t=this.dataset.issign,e=this.dataset.is_first_sign;if(0==t)if(1==e){let t=function(){e.$destroy()};const e=new ch({target:document.body,props:{closeModal:t,title:"打卡提醒",desc:"打卡后需在档期内完成队长每日任务，否则可能被淘汰，是否确认？",btns:[{title:"取消",cb:t},{title:"确定",class:"dark",countdown:5,cb:()=>{t(),m.dakaReq()}}]}})}else m.dakaReq()})),e.on("click",".takeaway_free_gift",(function(){if(1==m.is_first_sign){let e=function(){n.$destroy()};const n=new ch({target:document.body,props:{closeModal:e,title:"打卡提醒",desc:"打卡后需在档期内完成队长每日任务，否则可能被淘汰，是否确认？",btns:[{title:"取消",cb:e},{title:"确定",class:"dark",countdown:5,cb:()=>{e(),t()}}]}})}else t();function t(){qt.get(Pt+"/Captainsign/doSignnew?cid="+uu.getCid()).then((t=>{e.hide(),0==t.error?(m.updateTaskBtnStatus(),m.is_first_sign=!1):Ct.Alert(t.error_msg)}))}})),e.on("click",".free_gift_close",(function(){e.hide()})),n.on("click",".gift_box_close",(function(){n.hide()})),n.on("click",".open_gift_box",(function(){qt.get(Pt+"/Captain/prize").then((t=>{if(0==t.error){const{icon:e,name:n,tips:i}=t.data;window.$(".task_finished_modal").hide(),window.$(".receive_gift_modal").css("display","flex"),window.$(".receive_gift_info").html(i),window.$(".receive_gift_name").html(n),window.$(".receive_gift_content img").attr("src",e),m.updateTaskBtnStatus()}}))})),o.on("click",".receive_gift,.receive_gift_close",(function(){o.hide()})),s.on("click",".yesterday_summary_close,.yesterday_summary_alaso",(function(){s.hide()})),t.on("click",".tips_item",(function(){const t=this.dataset.ranktype;let e="";"week"==t?(e=`<div style="font-size:14px;font-weight:bold">注意事项：</div>\n                                <div>1. 如恶意刷榜会导致清空积分和解除队长权限；</div>\n                                <div>2. 迟到、早退、被投诉、骂老板等违规事项会减分；</div>\n                                <div style="display:${"端游队长"==m.globalMenuName?"block":"none"}">3. 端游各类官方游戏厅队长参与；</div>\n                                <div style="display:${"手游队长"==m.globalMenuName?"block":"none"}">3. 手游王者荣耀、绝地求生厅队长参与；</div>\n                                <div>4.如果存在开假车行为系统将清空当日排行榜所有积分；</div>\n                                <div style="font-size:14px;font-weight:bold;margin-top:15px;">计分方式：</div>\n                                <div>1.唱歌游戏分:</div>\n                                <div>不足1分钟按1分钟计算，不区分是否在值班期，每天上限900分;满分: 6300分;每分钟计3分;</div>\n                                <div>2.送老板礼物:</div>\n                                <div>每送1位老板礼物增加30分 (每日去重)，每天上限300分;满分:2100分;每送1个老板+30分;</div>\n                                <div>3.活跃时间:</div>\n                                <div>在聊天室中发弹幕、送礼物、开车、上麦位上语音等都算活跃事件，每5分钟统计1次，每天上限300分;满分:2100分;活跃5分钟增加5分:</div>\n                                <div>4.收礼物数:</div>\n                                <div>按导师的实际流水金额计算，每天上限3000分:满分:21000分;队长礼物流水2元=1分;</div>\n                                <div>5.送礼物数:</div>\n                                <div>按导师的实际送出礼物金额计算，每天上限1200分;满分:8400分;送出礼物额度2元=1分;</div>\n                                <div>6.完成任务:</div>\n                                <div>完成每日任务增加300分，日分数上限300分;满分:2100分;</div>\n                                <div>7.陪档:</div>\n                                <div>每日在陪档位开麦活跃，每活跃5分钟/15分，每天上限300分;</div>\n                                <div>满分:2100分;</div>\n                                <div>*统计算法会动态调整，按最新公布的为准;</div>\n                                `,window.$(".rule_info").html(e),window.$(".rule_title").html(`${m.globalMenuName}排行榜周榜规则`)):"task"==t?(e='<div style="font-size:14px;font-weight:bold">任务要求：</div>\n                                <div>任务每30分钟更新进度；</div>\n                                <div>1. 除娱乐厅外值班期间带老板开车超过10分钟为有效车次，完成任务需要带不同的老板开车;</div>\n                                <div>2. 娱乐厅值班期间带老板开车超过20分钟为有效车次，完成任务需要带不同的老板开车；</div>\n                                <div>3. 送老板礼物任务，需送不同的老板（不限制是否在厅）；</div>\n                                <div>4. 收礼物任务，需收不同人的礼物才进行计数（不限制是否在厅）；</div>\n                                <div>5. 私聊老板任务需不的同老板且老板回复；</div>\n                                <div>6. 值班活跃时间：活跃时间达到值班时间的75%即算完成，时间为值班时长x75%；</div>\n                                <div>&nbsp;&nbsp;&nbsp;&nbsp;值班活跃规则：值班期间有任意活跃动作即判断本时段活跃；</div>\n                                <div>&nbsp;&nbsp;&nbsp;&nbsp;活跃时间：每30分钟更新一次；</div>\n                                <div>&nbsp;&nbsp;&nbsp;&nbsp;活跃动作：发弹幕/表情、送礼物、上下麦位、私聊、开车、在麦位上说话；</div>',window.$(".rule_info").html(e),window.$(".rule_title").html("队长任务规则")):"boss"==t&&(e='<div style="font-size:14px;font-weight:bold">引导新用户开黑奖励：</div>\n                                <div>只有开启引导新人开车的队长才可获得额外奖励</div>\n                                <div>1. 引导新人开车20次本周直升银牌待遇；</div>\n                                <div>A. 队长想达到金牌依旧要从时薪任务实习>铜牌>银牌>金牌逐步达成；</div>\n                                <div>B. 每天最多只记录5次带新用户开车；</div>\n                                <div>2. 引导新人开车后，7天内获得这位新人给自己赠送礼物70%分成；</div>\n                                <div>3. 用户主动上队长车队，队长带新人开车，都算引导新人；</div>\n                                <div style="font-size:14px;font-weight:bold;margin-top:20px">淘汰：</div>\n                                <div>收到开黑过的新人礼物低于200点点币，取消本周直升银牌队长待遇;</div>',window.$(".rule_info").html(e),window.$(".rule_title").html("引导新人开黑规则")),a.css("display","flex")})),a.on("click",".rule_close,.rule_alaso",(function(){a.hide()})),r.on("click",".channel_rule_close,.channel_rule_sure",(function(){r.hide()})),t.on("click",".channel_rule_btn",(function(){r.css("display","flex")})),d.on("click",".new_boss_btn_item",(function(){const t=this.dataset.type,e=this.dataset.uid,n=this.dataset.inviteid;m.captainInviteid(t,e,n)})),d.on("click",".newuser-close",(function(){window.$(".teamer-daixin").hide()})),d.on("click",".daixin_btn",(function(){"none"!==window.$(".teamer-to-newuser").css("display")?window.$(".teamer-to-newuser").hide():window.$(".teamer-to-newuser").show()})),l.on("click",".new_boss_his",(function(){m.loadBossHis()})),i.on("click",".captain_sign_close,.captain_sign_sure",(function(){window.$(".captain_sign_modal").hide()})),c.on("click",".captain_gift_close",(function(){window.$(".captain_gift_modal").hide()})),c.on("click",".captain_gift_sure",(function(){2==this.dataset.state?qt.get(`${Pt}/usernew/receiveMoneyPack?level=${m.level}`).then((t=>{Vt(t.error_msg),window.$(".captain_gift_modal").hide()})):window.$(".captain_gift_modal").hide()})),t.on("click",".captain_gift_icon",(function(){m.captainGiftModal()})),t.on("click",".open_iframe",(function(){const t={url:this.dataset.href,iframeWidth:"375px",iframeHeight:"700px"};Ct.createIframe(t)})),t.on("click",".take_task_gift",(function(){let t=this.dataset.type;1==this.dataset.state&&qt.get(`${Pt}/welcome/receiveTaskReward?typeid=${t}&format=jsonp`).then((t=>{window.$(".captain_gift_modal").css("display","flex"),window.$(".captain_gift_title").html("恭喜获得"),window.$(".captain_gift_sure").html("确定");let e=`<div class="captain_gift_item">\n                                    <div class="gift_item_pic">\n                                        <img src="${t.data.icon}">\n                                    </div>\n                                </div>`;window.$(".captain_gift_detail_content").html(e),m.loadCaptainTask(0)}))})),l.on("click",".captain_new_common_btn",(function(){let t=this.dataset.type;if("joinNow"==t){window.$(".common_captain_new_item").hide(),window.$(".captain_new_common_btn").addClass("unabled_click"),window.$(".captain_new_common_btn").html("我知道啦  5秒"),window.$(".captain_new_common_btn").attr("data-type","re");let t=4;m.ruleTimer=setInterval((()=>{t>0?(window.$(".captain_new_common_btn").html(`我知道啦  ${t}秒`),--t):(clearInterval(m.ruleTimer),window.$(".captain_new_common_btn").html("我知道啦"),window.$(".captain_new_common_btn").removeClass("unabled_click"))}),1e3),window.$(".captain_new_rule").show()}else if("re"==t){if(window.$(this).hasClass("unabled_click"))return;m.captainEnroll()}else"close"==t?m.changeCaptainStatus(0):"open"==t&&m.changeCaptainStatus(1)}))}}class gh{constructor(){this.instance=null,this.emitter=new Ht,this.currentTab=0,this.currentGiftId=0,this.initModalCss(),this.initModalHtml()}static getInstance(){return this.instance||(this.instance=new gh),this.instance}initModalCss(){window.$("head").append("<style>\n                        .modal-f{display:flex}\n                        .modal-f-c{display:flex;align-items:center;justify-content:center;}\n                        .svip-mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .svip-content{display:none;position: relative;width:510px;height:544px;background:#fff;border-radius:10px;padding-top:34px;box-sizing:border-box;text-align:center}\n                        .svip-close{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_close.png) no-repeat center center;right: 4px;top: 10px;cursor: pointer;}\n                        .svip-que{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/gold_box_que.png) no-repeat center center;left: 27px;top: 15px;cursor: pointer;}\n                        .svip-title{color:#FF6691;font-size:36px}\n                        .svip-power-content{width:420px;flex-wrap:wrap;margin:0 auto;margin-top:32px;justify-content: space-around;color:#4B4D7A;font-size:24px;margin-bottom:60px}\n                        .svip-item .svip-item-content{width:160px;height:160px;background:rgba(255, 102, 145, .1);border-radius:12px;margin:40px 0 28px}\n                        .svip-item .svip-item-content img{max-width:80%;max-height:80%}\n                        .svip-pic-content{width:310px;height:310px;margin:16px auto 5px;}\n                        .svip-pic-content img{width:80%;max-height:80%}\n                        .svip-levelup-content{display:none;position: relative;width:460px;height:667px;background:url(https://asset.tuwan.com/chatroom/images/svip_levelup_bg.png);text-align:center;padding-top:18px;box-sizing:border-box;color:#fff;font-size:26px;}\n                        .svip-levelup-close{position: absolute;width: 40px;height: 40px;background: url(https://asset.tuwan.com/chatroom/images/svip_levelup_close.png) no-repeat center center;right: 4px;top: 10px;cursor: pointer;}\n                        .svip-levelup-tips{font-size:28px;margin-top:50px}\n                        .svip-levelup-power-title{font-size:20px;color:#000;font-weight:500;margin-top:84px}\n                        .svip-levelup-power-title img{margin:0 5px;}\n                        .svip-levelup-power-content{width:300px;flex-wrap:wrap;margin:0 auto;margin-top:32px;justify-content: space-around;}\n                        .svip-power-item{width:80px;color:#6A432C;font-size:18px;margin-bottom:30px}\n                        .svip-power-item img{width:66px;height:66px;margin-bottom:6px}\n                        .svip-levelup-sure,.svip-sure{color:#fff;font-size:24px;width:260px;height:66px;text-align:center;background:#FF6691;border-radius:33px;margin:0 auto;line-height:66px;margin-top:20px;cursor: pointer;}\n                    </style>")}initModalHtml(){window.$("body").append('<div class="svip-mask">\n                        <div class="svip-content">\n                            <div class="svip-close svip-common-close"></div>\n                            <div class="svip-title">特权卡包</div>\n                            <div class="svip-power-content modal-f-c"></div>\n                            <div class="svip-sure svip-common-close">确定</div>\n                            </div>\n                        <div class="svip-levelup-content">\n                            <div class="svip-levelup-close svip-common-close"></div>\n                            <div class="svip-levelup-title">至尊权限</div>\n                            <div class="svip-levelup-tips">恭喜您荣升至尊爵位</div>\n                            <div class="svip-levelup-power-title modal-f-c">\n                                <img src="https://asset.tuwan.com/chatroom/images/svip_levelup_left.png">\n                                <div>已为您开通至尊专享特权</div>\n                                <img src="https://asset.tuwan.com/chatroom/images/svip_levelup_right.png">\n                            </div>\n                            <div class="svip-levelup-power-content modal-f"></div>\n                            <div class="svip-levelup-sure svip-common-close">确定</div>\n                        </div>\n                    </div>'),this.initModalEvent()}svipLevelUpPower(t){let e="";t.forEach((t=>{e+=`<div class="svip-power-item">\n                        <img src="${t.img}">\n                        <div>${t.title}</div>\n                    </div>`})),window.$(".svip-levelup-power-content").html(e)}svipPower(t){let e="";t.forEach((t=>{e+=`<div class="svip-item">\n                        <div class="svip-item-content modal-f-c">\n                            <img src="${t.img}">\n                        </div>\n                        <div>${t.title}</div>\n                    </div>`})),window.$(".svip-power-content").html(e)}showGoldBox(){qt.get(Ot.goldBoxInfo()).then((t=>{if(0==t.error){const{num:e,process:n,total:i,diamond:o,intro:s,pic:a}=t.data;window.$(".svip-result").hide(),window.$(".gold-common-dis").show(),window.$(".svip-title").html("开启宝箱"),window.$(".svip-open").html("开启宝箱"),window.$(".svip-open").attr("data-type","open"),window.$(".svip-progress").attr("value",n/i*100),window.$(".svip-pic").attr("src",a),window.$(".svip-price span").html(o),window.$(".svip-max-tips").html(s),window.$(".svip-left-num").html(`剩余${e}个`),window.$(".svip-mask").css("display","flex"),window.$(".svip-pic").removeClass("bounceIn").addClass("shake")}}))}initModalEvent(){window.$(".svip-mask").on("click",".svip-common-close",(function(){window.$(".svip-mask").hide()}))}}class fh{constructor(){this.instance=null,this.que="",this.queList=[],this.ansData=[],this.nowAnsData=null,this.queType=0,this.positionType=0,this.emitter=new Ht,this.initTrueCss(),this.initTrueHtml()}static getInstance(){return this.instance||(this.instance=new fh),this.instance}initTrueCss(){window.$("head").append(' <style>\n                        .modal-f{display:flex}\n                        .ygb_cursor{cursor:pointer;}\n                        .modal-f-c{display:flex;align-items:center;justify-content:center;}\n                        .true_words_modal{display:none;align-items:center;justify-content:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 12000;position: fixed;}\n                        .true_words_que_content{display:none;position: relative;  width: 414px;height: 569px;background: url(https://asset.tuwan.com/officialsite/truewords/true_content_1.png);position: relative;box-sizing: border-box;padding-top: 50px;text-align: center;}\n                        .true_common_close{position:absolute;width:44px;height:44px;background: url(https://asset.tuwan.com/officialsite/truewords/true_close.png);top:-22px;right:-22px}\n                        .true_tips{color:rgba(255,255,255,.9);font-size:16px;line-height:30px}\n                        .true_ques_list{margin-top:20px}\n                        .true_que_item{position:relative;cursor:pointer;width: 350px;height: 46px;background: #FFFFFF;border-radius: 8px;opacity: 0.95;margin:0 auto 14px;text-align:left;box-sizing:border-box;padding-left:12px;color:#FF6691;font-size:14px;line-height:46px;}\n                        .choese_que{position:absolute;display:none;top:50%;right:13px;transform: translateY(-50%);}\n                        .true_operate_content{width:350px;margin:14px auto;justify-content:space-between;color:rgba(255,255,255,.8);font-size:14px;}\n                        .true_open_content{height:20px;color:#fff;}\n                        .true_open_btn {display:none}\n                        .true_open_btn+label::before {content: "";display: inline-block;vertical-align: middle;width: 14px;height: 14px;background: #EB5982;border-radius: 2px;margin-right:4px;margin-top:-1px;}\n                        .true_open_btn:checked+label::before {content: url(https://asset.tuwan.com/officialsite/truewords/right_1.png);display: inline-block;vertical-align: middle;width: 14px;height: 14px;background: #EB5982;border-radius: 2px;margin-right:4px;margin-top:-1px;}\n                        .true_operate_btn{width:350px;margin:0 auto;justify-content:space-between;}\n                        .no_que_gift{width:160px;height:52px;background: url(https://asset.tuwan.com/officialsite/truewords/true_pass_btn.png);font-size:20px;color:#fff;line-height:48px}\n                        .send_true_words,.ans_now{width:160px;height:52px;background: url(https://asset.tuwan.com/officialsite/truewords/true_btn.png);font-size:20px;color:#A25B00;font-weight:bold;line-height:48px}\n                        .send_true_words:hover,.ans_now:hover{background: url(https://asset.tuwan.com/officialsite/truewords/true_btn_h.png);}\n                        .true_words_custom_content,.true_words_ans_content{display:none;position: relative;  width: 414px;height: 439px;background: url(https://asset.tuwan.com/officialsite/truewords/true_content_2.png);position: relative;box-sizing: border-box;padding-top: 50px;text-align: center;}\n                        .true_words_ans_content{display:block;height: 474px;background: url(https://asset.tuwan.com/officialsite/truewords/true_content_5.png);}\n                        .custom_que_content{position:relative}\n                        #queText,#ansText {width: 350px;height: 120px;border-radius: 8px;display: block;padding: 9px;margin: 20px auto 14px;outline: none;resize: none;box-sizing:border-box;border:unset}\n                        .que_text_num,.ans_text_num{position:absolute;bottom: 6px;right: 50px;color:#999999;font-size:14px}\n                        .ans_que_content{ width: 280px;height:70px;margin: 0 auto;line-height: 34px;font-size: 22px;color: #fff;}\n                        .ans_que_tips{width: 348px;background: #F45582;border-radius: 8px;font-size: 16px;color: #fff;margin: 0 auto;margin-top: 10px;text-align: center;padding: 14px 0;}\n                        .ans_que_tips span{ color: #FFE776;}\n                        .ans_text_tips{display:none;position:absolute;bottom:6px;right:100px;color:#999999;font-size:14px}\n                    </style>')}initTrueHtml(){window.$("body").append('<div class="true_words_modal">\n                        <div class="true_words_que_content true_common_content">\n                            <div class="true_que_close true_common_close ygb_cursor"></div>\n                            <img src="https://asset.tuwan.com/officialsite/truewords/paper_title_1.png">\n                            <div class="true_tips">收到礼物需要回答指定问题～</div>\n                            <div class="true_tips">24小时未回答问题，系统会退回60%钻石</div>\n                            <div class="true_ques_list"></div>\n                            <img class="custom_que ygb_cursor" src="https://asset.tuwan.com/officialsite/truewords/custom_que.png">\n                            <div class="true_operate_content modal-f">\n                                <div class="true_open_content ygb_cursor modal-f-c">\n                                    <input type="checkbox" id="true_open_btn" class="true_open_btn">\n                                    <label for="true_open_btn" class="ygb_cursor">显示在厅内表白墙</label>\n                                </div>\n                                <div class="ygb_cursor refresh_que">\n                                    <img src="https://asset.tuwan.com/officialsite/truewords/refresh.png">\n                                    刷新问题\n                                </div>\n                            </div>\n                            <div class="true_operate_btn modal-f">\n                                <div class="no_que_gift ygb_cursor">不提问直接送</div>\n                                <div class="send_true_words ygb_cursor">发布真心话</div>\n                            </div>\n                        </div>\n                        <div class="true_words_custom_content true_common_content">\n                            <div class="true_que_custom_close true_common_close ygb_cursor"></div>\n                            <img src="https://asset.tuwan.com/officialsite/truewords/paper_title_1.png">\n                            <div class="true_tips">收到礼物需要回答指定问题～</div>\n                            <div class="true_tips">24小时未回答问题，系统会退回60%钻石</div>\n                            <div class="custom_que_content">\n                                <textarea type="text" placeholder="请输入您的问题" maxlength="24" class="text_in text_ing" id="queText"></textarea>\n                                <div class="que_text_num"><span>0</span>/24</div>\n                            </div>\n                            <div class="true_open_content ygb_cursor modal-f-c" style="margin: 0 auto;width: 350px;justify-content: flex-start;">\n                                <input type="checkbox" id="true_open_btn_1" class="true_open_btn">\n                                <label for="true_open_btn_1" class="ygb_cursor">显示在厅内表白墙</label>\n                            </div>\n                            <div class="send_true_words ygb_cursor" style="margin:14px auto 0">发布真心话</div>\n                        </div>\n                    </div>'),this.getTrueQues(),this.initTrueEvent()}openQueModal(t){window.$(".true_words_modal").css("display","flex"),window.$(".true_words_que_content").show(),window.$(".choese_que").hide(),window.$(".true_que_item").eq(0).find(".choese_que").show(),this.getTrueQues(),this.que=this.queList[0],this.positionType=t,1==this.queType&&(this.queType=0)}openAnsModal(t){this.ansData.push(t),window.$(".true_words_modal").css("display","flex"),this.appendAnsModal()}appendAnsModal(){if(window.$(".true_words_ans_content").length>0||"none"!==window.$(".true_words_custom_content").css("display")||"none"!==window.$(".true_words_que_content").css("display"))return;const t=this.ansData.shift();this.nowAnsData=t;let e=`<div class="true_words_ans_content">\n                        <div class="true_ans_custom_close true_common_close ygb_cursor"></div>\n                        <img src="https://asset.tuwan.com/officialsite/truewords/paper_title_2.png">\n                        <div class="modal-f-c ans_que_content">${t.content}</div>\n                        <div class="ans_que_tips"><span>${Ct.dateFormat(new Date(1e3*t.deadline),"text")}</span>之前回答即可获得此礼物分成</div>\n                        <div class="custom_que_content">\n                            <textarea type="text" placeholder="请输入您的答案" maxlength="24" class="text_in text_ing" id="ansText"></textarea>\n                            <div class="ans_text_num"><span>0</span>/24</div>\n                            <div class="ans_text_tips" style="diaplay:${1*t.open==1?"block":"none"}">会显示在厅内表白墙</div>\n                        </div>\n                        <div class="ans_now ygb_cursor" style="margin:14px auto 0">立即回答</div>\n                    </div>`;window.$(".true_words_modal").append(e)}getTrueQues(){qt.get(Ot.getTrueQues()).then((t=>{if(0==t.error){const e=t.data;this.queList=e;let n="";e.forEach(((t,e)=>{n+=`<div class="true_que_item ygb_cursor">${t}<img style="display:${0==e?"block":"none"}" class="choese_que" src="https://asset.tuwan.com/officialsite/truewords/right.png"></div>`})),this.que=e[0],window.$(".true_ques_list").html(n)}}))}ansNow(){const t=window.$("#ansText").val();qt.get(Ot.ansTrueQue(this.nowAnsData.suid,encodeURIComponent(t),this.nowAnsData.giftuserid)).then((t=>{Vt(t.error_msg),0==t.error&&this.resetTrue()}))}resetTrue(){window.$(".true_words_ans_content").length>0&&window.$(".true_words_ans_content").remove(),window.$(".true_common_content").hide(),this.ansData.length>0?this.appendAnsModal():(window.$(".true_words_modal").hide(),window.$("#queText").val(""),window.$(".que_text_num span").html(0))}initTrueEvent(){let t=this;window.$(".true_words_modal").on("click",".true_que_close,.true_ans_custom_close",(function(){t.resetTrue()})),window.$(".true_words_modal").on("click",".true_que_custom_close",(function(){window.$(".true_words_que_content").show(),window.$(".true_words_custom_content").hide(),t.que=t.queList[0],t.queType=0})),window.$(".true_words_modal").on("click",".refresh_que",(function(){t.getTrueQues()})),window.$(".true_words_modal").on("click",".custom_que",(function(){window.$(".true_words_que_content").hide(),window.$(".true_words_custom_content").show(),t.queType=1,t.que=""})),window.$(".true_words_modal").on("click",".send_true_words",(function(){let e=0,n="";1==t.queType?(e=window.$("#true_open_btn_1").is(":checked")?1:0,n=window.$("#queText").val()):(e=window.$("#true_open_btn").is(":checked")?1:0,n=t.que),""!=n?0==t.positionType?t.emitter.emit("sendGift",e,encodeURIComponent(n)):t.emitter.emit("sendImGift",e,encodeURIComponent(n)):Vt("请输入您的问题")})),window.$(".true_words_modal").on("click",".ans_now",(function(){""!=window.$("#ansText").val()?t.ansNow():Vt("请输入您的答案")})),window.$(".true_words_modal").on("click",".no_que_gift",(function(){0==t.positionType?t.emitter.emit("sendGift"):t.emitter.emit("sendImGift"),t.resetTrue()})),window.$(".true_words_modal").on("click",".true_que_item",(function(){window.$(".choese_que").hide();let e=window.$(this).text();t.que=e,window.$(this).find(".choese_que").show()})),window.$(".true_words_modal").on("input propertychange","#queText",(function(){let t=window.$(this).val().length;t>24||window.$(".que_text_num span").html(t)})),window.$(".true_words_modal").on("input propertychange","#ansText",(function(){let t=window.$(this).val().length;t>24||window.$(".ans_text_num span").html(t)}))}}class wh{constructor(){this.instance=null,this.levelUpData=null,this.initCss(),this.initHtml(),this.timer=null}static getInstance(){return this.instance||(this.instance=new wh),this.instance}initCss(){window.$("head").append("<style> \n        .meeting_modal_mask{\n            display: none;\n            justify-content: center;\n            align-items: center;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.6);\n            top: 0;\n            left: 0;\n            z-index: 9999999;\n            position: fixed;\n        }\n        .meeting_modal_content {\n            position: relative;\n            background: #F6F7F9;\n            box-shadow: 0px 2px 4px 0px rgba(140,140,140,0.2);\n            border-radius: 10px;\n            display: flex;\n            align-items: center;\n            padding: 30px;\n        }\n        .meeting_modal_avatar {\n            width: 72px;\n            height: 72px;\n            overflow: hidden;\n            border-radius: 100%;\n        }\n        .meeting_modal_avatar img{\n            width:100%;\n            height:100%;\n        }\n        \n        .meeting_modal_desc{\n            width: 300px;\n            flex-direction: column;\n            padding: 0 20px;\n        }\n        .meeting_action_ringup {\n            width: 50px;\n            height: 50px;\n            background: url(https://asset.tuwan.com/officialsite/im/images/icon_meeting_ringup.png);\n            background-size: 100% 100%;\n        }\n        .meeting_action_hangup {\n            width: 50px;\n            height: 50px;\n            background: url(https://asset.tuwan.com/officialsite/im/images/icon_meeting_hangup.png);\n            background-size: 100% 100%;\n        }\n        .meeting_modal_desc {\n            width: 180px;\n            flex-direction: column;\n            padding: 0 20px;\n            white-space: nowrap;\n            overflow: hidden;\n            display: flex;\n            justify-content: center;\n            text-overflow: ellipsis;\n        }\n        .meeting_modal_desc span{\n            text-overflow: ellipsis;\n            width: 180px;\n            overflow: hidden;\n        }\n        \n        .meeting_modal_action {\n            display:flex;\n            width: 120px;\n            align-items: flex-end;\n            justify-content: space-between;\n            cursor: pointer;\n        }\n        <style> \n        ")}initHtml(){window.$("body").append("<div class=\"meeting_modal_mask\">\n            <div class=\"meeting_modal_content\">\n                <div class='meeting_modal_avatar'>\n                   \n                </div>\n                <div class='flex meeting_modal_desc'>\n                    <span style='color: #333333;\n                    font-size: 16px;\n                    font-weight: 500;}'>精灵美少女姐姐群邀请你加入语音会议</span>\n                    <span style='color: #999999;\n                    font-size: 14px;\n                    ;}'>邀请你加入语音会议邀请你加入语音会议</span>\n                </div>\n                <div class='meeting_modal_action'> \n                    <div class='meeting_action_ringup'></div>\n                    <div class='meeting_action_hangup'></div>\n                </div>\n            </div>\n        </div>\n    "),this.initEvent()}initEvent(){window.$(document).on("click",".meeting_action_hangup",(()=>{window.$(".meeting_modal_mask").hide()}))}async showModal(t){const e=JSON.parse(t);window.$(".meeting_modal_avatar").html(`<img src='${e.avatar}'/>`),window.$(".meeting_modal_desc span").eq(0).text(e.subject),window.$(".meeting_action_ringup").attr("data-id",e.meeting_id),window.$(".meeting_action_ringup").attr("data-cid",e.cid),window.$(".meeting_modal_mask").css("display","flex"),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{window.$(".meeting_modal_mask").hide(),this.timer=null}),45e3)}}let vh=0,_h=0,yh="";function xh(){document.getElementById("div-im-content").style.display="none",vh=0}function bh(t,e,n="p2p"){const i=document.getElementById("iframeim");function o(){i.contentWindow.postMessage({uid:t,scene:n},"*")}window.$(i).attr("src")?o():(hn.getInstance().setSrc(!0),setTimeout((()=>{o()}),2e3)),vh=0,$h(),Ct.dragComp("div-im-content"),i.contentWindow.postMessage({type:"getWdith"},"*"),window.$("#div-im-content").show()}function $h(){const t=parseInt(window.$("#div-im-content").css("left"));if("none"==window.$("#div-im-content").css("display")&&isNaN(t)){let t=(document.documentElement.clientHeight-640)/2,e=(document.documentElement.clientWidth-980)/2;window.$("#div-im-content").css({left:e+"px",top:t+"px"})}}function kh(){document.getElementById("wolf_iframe").contentWindow.postMessage({imUnread:_h},"*")}function Ch(t,e,n=0,i=""){const o=uu.getCid(),s=uu.getRoomInfo().pcid,a=Ct.readCookie("Tuwan_Passport"),r=uu.getSelfInfo().uid,c=uu.getSelfInfo().nickname,l=uu.getSelfInfo().avatar;new Promise(((d,m)=>{let h="";if(2==e||1==e||21==e)if(2==e||21==e){if(2!=e)return h=It?"https://y-test.tuwan.com/amongusTest?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i:"https://y.tuwan.com/amongus?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i,void d(h);qt.get(Ot.gameSourceRunGame(t,uu.getCid())).then((n=>{if(0==n.error){let s=n.data;if(1==s.canJoin)return h=It?"https://y-test.tuwan.com/amongusTest?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i:"https://y.tuwan.com/amongus?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i,void d(h);2==s.canJoin?window.$.DialogByZ.Confirm({Title:"提示",Content:`${s.title}`,BtnL:"取消",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){window.$.DialogByZ.Close(),h=It?"https://y-test.tuwan.com/amongusTest?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i:"https://y.tuwan.com/amongus?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l+"&gameArea="+i,d(h)}}):Vt(s.content)}else Vt(n.error_msg)}))}else qt.post(Ot.canJoinroom(o,e,t,r,n),null,"application/json").then((n=>{0==n.code&&1==n.data.canJoin?(h=It?"https://y-test.tuwan.com/langrentest?cid="+o+"&pcid="+s+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l:"https://y.tuwan.com/langren?cid="+o+"&pcid="+s+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l,h=Ct.changeDianDianKaiHeiToTuYan(h),d(h)):0==n.code&&2==n.data.canJoin?window.$.DialogByZ.Confirm({Title:"提示",Content:`您正在[${1==e?"狼人":"乐园"}杀]游戏中，是否继续游戏`,BtnL:"取消",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){window.$.DialogByZ.Close(),Ch(n.data.gamingRoomId,e)}}):Vt(n.data.message||n.message)}));else if(200==e)h=It?"https://y-test.tuwan.com/tuwangame_test?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l:"https://y.tuwan.com/tuwangame?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l,d(h);else if(4==e)h=It?"https://y-test.tuwan.com/spytest?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l:"https://y.tuwan.com/spy?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l,d(h);else{if(7!=e)return;h=It?"https://y-test.tuwan.com/drawSome?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l:"https://y.tuwan.com/drawSome?cid="+o+"&roomId="+t+"&token="+a+"&game_type="+e+"&userId="+r+"&userName="+c+"&userImg="+l,d(h)}})).then((t=>{window.$(".game-mask").css("display","flex"),window.$(".game-mask .game-mask-close").css("display",2==e?"none":"block"),setTimeout((function(){window.$(".game-mask").find("iframe").attr("async",!0),window.$(".game-mask").find("iframe").attr("defer",!0),window.$(".game-mask").find("iframe").attr("src",t)}),100),setTimeout((()=>{kh()}),1e3),uu.globalRtcClient.leave(),uu.globalDDSocket.leave(),uu.globalDDSocket.close(),uu.isBattleRoom()&&Si.getInstance().destroyPlayer()}))}window.onresize=function(){$h()},window.addEventListener("message",(function(t){if("game"!=t.data.page)if("meeting"!=t.data.page){if(t.data.refresh&&window.$.fancybox.open([{src:t.data.refresh}],{loop:!1,toolbar:"auto",buttons:["close"]}),t.data.video&&window.$.fancybox.open([{src:t.data.video,opts:{videoFormat:"video/mp4"}}],{loop:!1,toolbar:"auto",buttons:["close"],type:"video"}),t.data.replay){const e=JSON.parse(t.data.data);if(e.vap_pc_url){const t=window.$('<div class="replay_vap_gift" ></div>');window.$("body").append(t);(new Xt).play({url:e.vap_pc_url,ele:t.get(0),config:e.vap_pc_config}).then((()=>{})).catch((t=>{}))}else{const t=e.video_pc_url,n=window.$('<div id="gift_replay_canvas" class=\'canvassvga-fullscreen\' style="z-index:99999999" ></div>');if(t){const e=`videoAlphaGift_${(new Date).getTime()}`;window.$(".replay_video_gift").append(`<canvas class="video_canvas" id="${e}"></canvas>`);const n=document.querySelector("#"+e);Qt.getInstance().initVideo({canvas:n,url:t,loop:!1})}window.$("body").append(n);const i=new window.SVGA.Player("#gift_replay_canvas"),o=new window.SVGA.Parser("#gift_replay_canvas");i.fillMode="Forward",i.loops=1,o.load(e.svga_pc,(n=>{for(let t=0;t<e.attr.length;t++){const n=e.attr[t],o=n.typeid,s=n.skey;if(1==o){const t=n.data.pic;i.setImage(t,s)}else if(2==o){const t=n.data.title,e=n.data.size+"px",o=n.data.color;i.setText({text:t,size:e,color:o,family:"Microsoft YaHei"},s)}}i.setVideoItem(n),i.startAnimation(),i.onFinished((()=>{t&&window.$(".replay_video_gift").empty(),window.$("#gift_replay_canvas").remove()}))}))}}if(t.data.giftpic&&function(t,e,n){if(t.match(".svga")){let n;n=105==e?window.$('<div id="svgaCanvas" class="canvassvga-chat"></div>'):window.$('<div id="svgaCanvas" class="canvassvga-chat-fullscreen"></div>'),window.$("body").append(n);const i=new window.SVGA.Player("#svgaCanvas"),o=new window.SVGA.Parser("#svgaCanvas");i.loops=1,i.clearsAfterStop=!0,i.fillMode="Forward",o.load(t,(function(t){i.setVideoItem(t),i.startAnimation(),i.onFinished((function(){n.remove()}))}))}else{let e;e=window.$('<div class="gift-gif"><img src="'+t+'"></div>'),window.$("body").append(e),setTimeout((function(){e.remove()}),n)}}(t.data.giftpic,t.data.gid,t.data.ptime),t.data.giftuserid&&fh.getInstance().openAnsModal(t.data),t.data.close&&(window.$("#svgaCanvas").remove(),window.$(".gift-gif").remove()),t.data.closeImWindow&&xh(),t.data.biaobai&&setTimeout((function(){si.show(".div-biaobai","block"),window.$(".span-biaobai-name").text(t.data.teacherName),window.$(".span-biaobai-name").attr("account",t.data.touid),window.$(".span-biaobai-name").attr("account1",t.data.touid),$(".div-biaobai").css("z-index","9999998")}),t.data.giftTime),t.data.guanming&&qe.addGuanmingData(t.data.touid,t.data.giftTime,"9999998"),t.data.from){const{fromNick:e,from:n,msg:i,scene:o}=t.data;!function(t,e,n,i){if(vh=e,yh=i,""==n)return;if(e==(window.$("#chatHeadNickname").attr("account")||0))return;window.$(".newimmessage-tips p").html(n);const o=window.$(".user-own-message .newimmessage-tips");o.snabbt({position:[0,5,0],fromOpacity:0,opacity:1,duration:500,start:function(){o.show()}}).snabbt({position:[0,0,0],fromOpacity:1,opacity:0,duration:500,delay:3e3,complete:function(){o.hide()}})}(0,n,i,o)}var e;if(t.data.unReadCount&&(_h=t.data.unReadCount,0==(e=t.data.unReadCount)?window.$(".user-own-message em").hide():(window.$(".user-own-message em").text(e>99?99:e),window.$(".user-own-message em").show()),"flex"==window.$(".game-mask").css("display")&&kh()),t.data.type)if("meeting"==t.data.type){const e=JSON.parse(t.data.data).type;36==e?wh.getInstance().showModal(t.data.data):37==e&&(Vt("会议结束!"),window.exitMeetingPage())}else if("joinMeeting"==t.data.type){xh();const e=JSON.parse(t.data.data);window.joinMeeting(e.id,e.groupId)}else if("diamond2gold"==t.data.type)xe.showModal();else if("buyEmoji"==t.data.type)Me.getInstance().showModal(JSON.parse(t.data.data),t.data.typeid);else if("svip"==t.data.type){let e=t.data.content.data;window.$(".svip-mask").css("display","flex"),window.$(".svip-content").hide(),window.$(".svip-levelup-content").show(),gh.getInstance().svipLevelUpPower(e)}else if("power"==t.data.type){let e=t.data.content.data;window.$(".svip-mask").css("display","flex"),window.$(".svip-levelup-content").hide(),window.$(".svip-content").show(),gh.getInstance().svipPower(e)}else if("newBoss"==t.data.type)Vi.getInstance().showModal(t.data.content);else if("level"==t.data.type)nh.getInstance().showModal(t.data.content,1);else if("report"==t.data.type)xs.getInstance().showReportModal(2,t.data.content);else if("withdraw"==t.data.type)ph.getInstance().onCaptionWithdraw();else if("captainclose"==t.data.type)ph.getInstance().onCloseCaptionDialog();else if("captainmessage"==t.data.type){let e=t.data.content;ph.getInstance().onMessageToCaptain(e)}else if("5"==t.data.type)window.open(Ot.getRechargeUrl());else if("guessClose"==t.data.type)setTimeout((()=>{document.getElementById("div-inner-guess-content").style.display="none"}),1500);else if("invite"==t.data.type){if(1==t.data.content.typeid)Zm.getInstance().show(t.data.content);else if(2==t.data.content.typeid){const e={url:t.data.content.url,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(e)}else if(3==t.data.content.typeid)uu.showDayGiftModal();else if(4==t.data.content.typeid){const e={url:t.data.content.url,iframeWidth:"375px",iframeHeight:"700px"};Ct.createIframe(e)}}else if("logout"==t.data.type)qt.get(Ot.regUserinfo()).then((t=>{if(0!=t.code){Vt("登录失效");const t=window.location.href.substring(window.location.href.lastIndexOf("/")+1,-1==window.location.href.indexOf("?")?window.location.href.length:window.location.href.lastIndexOf("?"));ou(t)}}));else if("jumpGame"==t.data.type){let e=t.data.content.data.h5,n=t.data.content.data.join_room;if(1==e){const e={url:t.data.content.data.url,iframeWidth:"375px",iframeHeight:"700px"};Ct.createIframe(e)}else 1==n?eh.getInstance().show(t.data.content.data):th.getInstance().show(t.data.content)}else if("dragArea"==t.data.type){let e=t.data.userWidth,n=t.data.configWidth;window.$(".drag_mask_2").css("width",e+"px"),window.$(".drag_mask_3").css({left:295+e+"px",width:649-e-n+"px"})}else if("joinRoomModal"==t.data.type);else if("glodMagic"==t.data.type){const e=t.data.content;866==e&&Vo.initFn(1),873==e&&(Vt("黄金魔法只支持在厅内开启.."),Vo.initFn(2)),window.$("#div-im-content").hide()}else if("open_h5_modal"==t.data.type)try{const e={url:JSON.parse(t.data.data).data.url,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(e)}catch(n){console.log(n)}if(t.data.que&&(fh.getInstance().openQueModal(1),fh.getInstance().emitter.on("sendImGift",(function(t,e){document.getElementById("iframeim").contentWindow.postMessage({giftType:"que",open:t||0,que:e||""},"*")}))),t.data.gameUrl){let e=t.data.gameUrl;if("iframe"==t.data.type){let t=e+"&token="+Ct.readCookie("Tuwan_Passport");window.$(".game-mask").css("display","flex"),window.$(".game-mask .game-mask-close").css("display","block"),setTimeout((function(){window.$(".game-mask").find("iframe").attr("async",!0),window.$(".game-mask").find("iframe").attr("defer",!0),window.$(".game-mask").find("iframe").attr("src",t)}),100)}else window.open(e+"&token="+Ct.readCookie("Tuwan_Passport"),"_self")}if(t.data.actUrl){let e=t.data.actUrl,n=t.data.type;if(0==n)uu.showIframe(e);else if(1==n){const t={url:e,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(t)}}t.data.openIm&&(1==t.data.openIm?bh():window.$("#div-im-content").hide()),t.data.closeIframe&&Ct.destroyIframe(t.data.id),t.data.openWebView&&window.open(t.data.url,"_blank"),t.data.openUserIM&&(bh(t.data.uid),window.$(".iframe-mask")&&window.$(".iframe-mask").remove())}else window.exitMeetingPage();else window.exitGamePage()}));class Ih{constructor(t){this.choiceCreateCarData=null,this.tabIndex=0,this.request=qt,this.common=uu,this.initHtml(t),this.initEvent(),this.bgSwiper=null,this.publishGameRoom=null}initHtml(t){window.$("head").append("<style>\n        .carauto-create-mask {\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.6);\n            top: 0;\n            left: 0;\n            z-index: 2000;\n            position: fixed;\n            display: none;\n        }\n\n        .carauto-create-mask .carauto-create-content {\n            position: absolute;\n            width: 300px;\n            /*height: 410px;*/\n            background: #fff;\n            border-radius: 10px;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%, -50%);\n            padding: 0 32px;\n            padding-bottom: 10px;\n        }\n\n        .carauto-create-mask .carauto-create-title {\n            font-size: 22px;\n            color: #333;\n            text-align: center;\n            padding: 20px 0\n        }\n\n        .carauto-create-mask .carauto-create-title span {\n            color: #b2b2b2;\n            font-size: 20px;\n            margin: 5px;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-title span.current {\n            color: #333333;\n            font-size: 22px;\n        }\n\n        .carauto-create-mask .carauto-create-select {\n            height: 40px;\n            background: #f0f0f0;\n            border-radius: 8px;\n            flex: 1;\n            margin-left: 16px;\n            padding-left: 10px;\n\n        }\n\n        .carauto-create-mask .carauto-create-item {\n            height: 40px;\n            align-items: center;\n            margin-bottom: 10px;\n        }\n\n        .carauto-create-mask .carauto-create-item.yaoqiu {\n            height: 76px;\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang {\n            height: 90px;\n        }\n\n        .carauto-create-mask .carauto-create-selected {\n            line-height: 40px;\n            background: url(https://res.tuwan.com/templet/play/chat/images/clickslectbg.png) no-repeat right 10px center;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask textarea.carauto-create-input-yaoqiu {\n            background: #f0f0f0;\n            border: none;\n            border-radius: 8px;\n            width: 100%;\n            height: 70px;\n            outline: none;\n            padding: 10px;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            /* Firefox */\n            -webkit-box-sizing: border-box;\n            /* Safari */\n            resize: none;\n\n        }\n\n        .carauto-create-mask input.bind-nickname-input {\n            background: #f0f0f0;\n            border: none;\n            border-radius: 8px;\n            width: 100%;\n            height: 40px;\n            outline: none;\n            padding: 10px;\n            box-sizing: border-box;\n            -moz-box-sizing: border-box;\n            /* Firefox */\n            -webkit-box-sizing: border-box;\n            /* Safari */\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang .carauto-create-xuanshang-gift ul.shang-gift-list {\n            list-style: none;\n            display: flex;\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang .carauto-create-xuanshang-gift ul.shang-gift-list li {\n            width: 48px;\n            height: 48px;\n            border: solid 1px #f0f0f0;\n            background: #f0f0f0;\n            margin-right: 10px;\n            border-radius: 8px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang .carauto-create-xuanshang-gift ul.shang-gift-list li.current {\n            border: solid 1px #ff5588;\n            background: url(https://res.tuwan.com/templet/play/chat/images/selectedicon.png) right bottom no-repeat #fff;\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang .carauto-create-xuanshang-gift ul.shang-gift-list li img {\n            width: 35px;\n        }\n\n        .carauto-create-mask .carauto-create-item.xuanshang .carauto-create-xuanshang-gift ul.shang-gift-list li.default img {\n            width: 35px;\n            filter: grayscale(100%);\n            -webkit-filter: grayscale(100%);\n            -moz-filter: grayscale(100%);\n            -ms-filter: grayscale(100%);\n            -o-filter: grayscale(100%);\n            filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);\n            -webkit-filter: grayscale(1)\n        }\n\n        .carauto-create-mask .carauto-create-gift-num {\n            position: relative;\n            width: 170px;\n            height: 40px;\n            border-radius: 8px;\n            margin-top: 6px;\n            align-items: center;\n            background: url(https://res.tuwan.com/templet/play/chat/images/clickslectbg.png) no-repeat right 10px center #f0f0f0;\n            font-size: 14px;\n            cursor: pointer;\n\n        }\n\n        .carauto-create-mask .carauto-create-gift-num input {\n            width: 30px;\n            height: 26px;\n            border: none;\n            background: transparent;\n            text-indent: 10px;\n            outline: none;\n            text-align: center;\n            /*padding-left: 10px;*/\n        }\n\n        .carauto-create-mask .carauto-create-gift-num span {\n            margin-right: 32px;\n            flex: 1;\n            text-align: right;\n            color: #999\n        }\n\n        .carauto-create-mask .carauto-create-gift-num em {\n            font-style: normal;\n            color: #333;\n        }\n\n        .carauto-create-mask .carauto-create-gift-num ul {\n            position: absolute;\n            width: 100%;\n            background: #f0f0f0;\n            border-bottom-right-radius: 8px;\n            border-bottom-left-radius: 8px;\n            z-index: 9;\n            top: 35px;\n            left: 0;\n            padding-top: 5px;\n            border-top: solid 1px #d9d9d9;\n            display: none;\n        }\n\n        .carauto-create-mask .carauto-create-gift-num ul li {\n            line-height: 32px;\n            padding: 0 15px;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-gift-num ul li:hover {\n            background: #e0e0e0;\n        }\n\n        .carauto-create-mask .carauto-create-gift-num ul li span {\n            flex: 1;\n            margin-right: 0\n        }\n\n        .carauto-create-mask .carauto-create-sure {\n            margin-left: 16px;\n            margin-top:10px\n        }\n\n        .carauto-create-mask .carauto-create-sure button {\n            width: 202px;\n            height: 40px;\n            background: #ff5588;\n            border-radius: 8px;\n            color: #fff;\n            font-size: 18px;\n            border: none;\n            outline: none;\n            margin-top: 6px;\n        }\n\n        .carauto-create-mask .carauto-create-qu,\n        .carauto-create-mask .carauto-create-tags,\n        .carauto-create-mask .carauto-create-duanwei {\n            position: relative;\n        }\n\n        .carauto-create-mask .carauto-create-select-list,\n        .carauto-create-mask .carauto-create-tag-list,\n        .carauto-create-mask .carauto-create-duanwei-select-list,\n        .carauto-create-mask .jingji-create-select-money {\n            position: absolute;\n            z-index: 2;\n            background: #f0f0f0;\n            width: 100%;\n            left: 0;\n            top: 36px;\n            border-top: solid 1px #d9d9d9;\n            padding-bottom: 10px;\n            border-bottom-right-radius: 8px;\n            border-bottom-left-radius: 8px;\n            display: none;\n        }\n\n        .carauto-create-mask .carauto-create-select-list ul,\n        .carauto-create-mask .carauto-create-tag-list ul,\n        .carauto-create-mask .jingji-create-select-money ul {\n            list-style: none;\n            margin-top: 5px;\n        }\n        .carauto-create-mask .carauto-create-tag-list ul{\n            max-height: 100px;\n            overflow:auto;\n        }\n\n        .carauto-create-mask .carauto-create-select-list ul li,\n        .carauto-create-mask .carauto-create-tag-list ul li,\n        .carauto-create-mask .jingji-create-select-money ul li {\n            line-height: 36px;\n            font-size: 14px;\n            color: #999;\n            padding-left: 16px;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-select-list ul li:hover,\n        .carauto-create-mask .carauto-create-tag-list ul li:hover,\n        .carauto-create-mask .jingji-create-select-money ul li:hover {\n            color: #333\n        }\n\n        .carauto-create-mask .carauto-create-duanwei-select-list ul {\n            list-style: none;\n            margin-top: 5px;\n        }\n\n        .carauto-create-mask .carauto-create-duanwei-select-list ul li {\n            line-height: 36px;\n            font-size: 14px;\n            color: #999;\n            padding-left: 16px;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-duanwei-select-list ul li:hover {\n            color: #333\n        }\n\n        .carauto-create-mask .carauto-create-select-list div.other-qu {\n            width: 210px;\n            height: 34px;\n            line-height: 34px;\n            text-align: center;\n            background: #fff;\n            color: #666;\n            margin: 10px auto;\n            border-radius: 8px;\n            cursor: pointer;\n        }\n\n        .carauto-create-mask .carauto-create-close {\n            position: absolute;\n            width: 40px;\n            height: 40px;\n            background: url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png) no-repeat center center;\n            right: 0;\n            top: 0;\n            cursor: pointer;\n        }\n\n        .carauto-create-content .jingji-intro {\n            font-size: 14px;\n            color: #666;\n            margin-bottom: 12px;\n            display: none;\n        }\n\n        .carauto-create-content .create-jingji-shangjin {\n            align-items: center;\n            margin-bottom: 10px;\n            display: none;\n        }\n\n        .carauto-create-content .create-xtitle {\n            width: 48px;\n            text-align: right;\n        }\n        .car_rec_content{\n            margin-left:16px;\n            font-size:14px;\n            color:#999\n        }\n        .car_rec_check{\n            padding:0;\n            height:20px;\n            align-items:center;\n            margin:0 6px 0;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .titleCtn{\n            display: flex;\n            justify-content: space-around;\n            width: 200px;\n            margin: 0 auto;\n            margin-top: 10px;\n        }    \n        .carauto-create-mask .meetNewPersonTeamContainer .rightCtn{\n            cursor: pointer;\n            width: 40px;\n            height: 20px;\n            background: #ff5588;\n            border-radius: 18px;\n            position: relative;\n            background: #e1dfdf;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .rightCtn.active{\n            background: #ff5588;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .rightCtn.active .circleCtn{\n            right: 0;\n            left: auto;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .circleCtn{\n            position: absolute;\n            width: 20px;\n            height: 20px;\n            background: white;\n            border-radius: 50%;\n            border: 1px solid #cdc7c7;\n            box-sizing: border-box;\n            left: 0;\n        }    \n        .carauto-create-mask .meetNewPersonTeamContainer .radioContainer{\n            display: flex;\n            justify-content: space-around;\n            width: 200px;\n            margin: 0 auto;\n            margin-top: 8px;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .subRadioCtn{\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .radioImgCtn{\n            display: inline-block;\n            width: 18px;\n            height: 18px;\n            background: #d0d0d0;\n            border-radius: 50%;\n            margin-right: 5px;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .active .radioImgCtn{\n            background: url(https://asset.tuwan.com/chatroom/images/bgselect.png);\n            background-size: cover;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .radioImgCtn{\n            display: inline-block;\n            width: 18px;\n            height: 18px;\n            background: #d0d0d0;\n            border-radius: 50%;\n            margin-right: 5px;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .priceCtn{\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin-top: 3px;\n            margin-bottom: 5px;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .priceImg{\n            width: 17px;\n            height: 17px;\n            margin-left: 3px;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .bigTipsContainer{\n            font-size: 14px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        }\n        .carauto-create-mask .meetNewPersonTeamContainer .tipsImg{\n            width: 16px;\n            height: 16px;\n            margin-left: 5px;\n            cursor: pointer;\n        }\n        </style>"),window.$(`.${t}`).append('<div class="carauto-create-content">\n        <p class="carauto-create-title">创建车队</p>\n        <div class="carauto-create-content-item__container">\n            <div class="carauto-create-type-select__container flex flex-jc" data-mode="choice" style="margin-bottom: 20px;display: none" >\n\n            </div>\n            <div class="jingji-mode jingji-intro">\n                每人投入固定钻石，游戏结束后第一名获得全部。\n            </div>\n            <div class="flex create-area-qu carauto-create-item" data-mode="choice">\n                <div class="create-xtitle create-area-qu-title">大区</div>\n                <div class="carauto-create-select carauto-create-qu">\n                    <p class="carauto-create-selected carauto-create-selected-qu" areaid="-1">请选择大区</p>\n                    <div class="carauto-create-select-list">\n                        <ul>\n\n                        </ul>\n                        <div class="other-qu">其它大区</div>\n                    </div>\n\n                </div>\n            </div>\n            <div class="flex create-duanwei-qu carauto-create-item">\n                <div class="create-xtitle">段位</div>\n                <div class="carauto-create-select carauto-create-duanwei">\n                    <p class="carauto-create-selected carauto-create-selected-duan" levelid="-1">请选择段位</p>\n                    <div class="carauto-create-duanwei-select-list">\n                        <ul>\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="flex carauto-create-item bind-nickname" style="display: none;">\n                <div class="create-xtitle">昵称</div>\n                <div style="flex: 1; margin-left: 16px;">\n                    <input class="bind-nickname-input" maxlength="20" placeholder="下次开车就不用输入昵称啦" />\n                </div>\n            </div>\n            <div class="flex carauto-create-item yaoqiu" data-mode="choice">\n                <div class="create-xtitle">要求</div>\n                <div style="flex: 1; margin-left: 16px;">\n                    <textarea class="carauto-create-input-yaoqiu" maxlength="15" placeholder="最多输入15个文字"></textarea>\n                </div>\n            </div>\n            <div class="flex carauto-create-item xuanshang carauto-create-item-xuanshang">\n                <div style="margin-bottom: 30px;" class="create-xtitle">悬赏</div>\n                <div class="carauto-create-xuanshang-gift" style="flex: 1; margin-left: 16px;">\n                    <ul class="shang-gift-list"></ul>\n                    <div class="flex carauto-create-gift-num">\n                        <input type="number" value="0"><em>个</em><span class="shang-need-diamond"></span>\n                        <ul>\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="flex create-room-tags carauto-create-item carauto-create-item-tag" data-mode="choice">\n                <div class="create-xtitle create-room-tags-title">标签</div>\n                <div class="carauto-create-select carauto-create-tags">\n                    <p class="carauto-create-selected carauto-create-selected-tag" tagid="7"></p>\n                    <div class="carauto-create-tag-list">\n                        <ul>\n\n                        </ul>\n                    </div>\n\n                </div>\n            </div>\n            <div class="create-music-bgs" data-mode="choice">\n                <div class="swiper music-temproom-bgs">\n                    <div class="swiper-wrapper">\n                        <div class="swiper-slide flex">\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="meetNewPersonTeamContainer">\n                <div class="titleCtn">\n                    <span class="leftTitle">设置为迎新车队:</span>\n                    <div class="rightCtn" data-active="0">\n                        <div class="circleCtn"></div>\n                    </div>\n                </div>\n                <div class="subContainer" style="display: none;">\n                    <div class="radioContainer">\n                        <div class="subRadioCtn active" data-mode="1">\n                            <span class="radioImgCtn"></span>\n                            <span class="radioWordCtn">一带一</span>\n                        </div>\n                        <div class="subRadioCtn" data-mode="2">\n                            <span class="radioImgCtn"></span>\n                            <span class="radioWordCtn">多带一</span>\n                        </div>\n                    </div>\n                    <div class="priceCtn">\n                        <span class="priceValue priceValue1"></span>\n                        <span class="priceValue priceValue2" style="display: none"></span>\n                        <img class="priceImg" alt="" src="https://asset.tuwan.com/chatroom/images/icon_new_crystal.png" />\n                    </div>\n                    <div class="bigTipsContainer">\n                        流量扶持 付费创建 开车成功返还 <img class="tipsImg" alt="" src="https://asset.tuwan.com/chatroom/images/learnMoreIcon.png" />\n                    </div>\n                </div>\n            </div>\n\n            <div class="flex create-jingji-shangjin" style="display:none">\n                <div class="create-xtitle create-area-qu-title">参赛金</div>\n                <div class="carauto-create-select carauto-create-qu">\n                    <p class="carauto-create-selected jingji-select-money" money="100">请选择赏金</p>\n                    <div class="jingji-create-select-money">\n                        <ul>\n\n                        </ul>\n                    </div>\n                </div>\n            </div>\n            <div class="flex carauto-create-item carauto-create-item-live" style="display:none" data-mode="choice">\n                <div style="margin-bottom: 30px;" class="create-xtitle"></div>\n                <div class="car_rec_content flex">\n                    <input type="checkbox" id="live_checkbox" class="car_live_check">\n                    <label for="live_checkbox">开启视频歌房<label>\n                </div>\n            </div>\n            <div class="flex carauto-create-item carauto-create-item-game-live" style="display:none" data-mode="choice">\n                <div style="margin-bottom: 30px;" class="create-xtitle"></div>\n                <div class="car_rec_content flex">\n                    <input type="checkbox" id="game_live_checkbox" class="car_game_live_check">\n                    <label for="game_live_checkbox">开启游戏直播<label>\n                </div>\n            </div>\n            <div class="flex carauto-create-item carauto-create-item-rec" style="display:none">\n                <div style="margin-bottom: 30px;" class="create-xtitle"></div>\n                <div class="car_rec_content flex">\n                    <input type="checkbox" id="rec_checkbox" class="car_rec_check">\n                    <label for="rec_checkbox">开启推荐<label>\n                </div>\n            </div>\n\n            <div class="flex carauto-create-item carauto-create-item-solo" style="display:none" data-mode="choice">\n                <div style="margin-bottom: 30px;" class="create-xtitle"></div>\n                <div class="car_rec_content flex">\n                    <input type="checkbox" id="solo_checkbox" class="car_solo_check">\n                    <label for="solo_checkbox">Solo车队<label>\n                </div>\n            </div>\n\n            <div class="flex carauto-create-item carauto-create-sure" data-mode="choice">\n                <div class="create-xtitle" style="opacity: 0">确认</div>\n                <button>确认</button>\n            </div>\n        </div>\n        <div class="carauto-create-close"></div>\n        </div>')}showTeamInfo(t,e,n){if(1==$(".opbutton.show[data-type=creatteam]").attr("data-num")&&"创建车队"==$(".opbutton.show[data-type=creatteam]").text())this.request.get(Ot.checkPublish(uu.getCid())).then((i=>{if(0==i.error){let i="创建车队",o="确定";1==t?(i=uu.isShengyouFreeRoom()?"创建歌房":"创建车队",o="确定",window.$(".carauto-create-item-xuanshang").css("display","flex"),window.$(".create-duanwei-qu").show(),window.$(".carauto-create-content .yaoqiu").show()):2==t&&(i="更新车队信息",o="更新",window.$(".carauto-create-item-xuanshang").hide(),window.$(".create-duanwei-qu").show(),window.$(".carauto-create-content .yaoqiu").show()),window.$(".carauto-create-type-select__container").css("display","none"),window.$(".carauto-create-content .jingji-intro").hide(),3==t?(i="绑定昵称",window.$(".bind-nickname").css("display","flex"),window.$(".create-duanwei-qu").hide(),window.$(".carauto-create-content .yaoqiu").hide(),window.$(".carauto-create-item-xuanshang").hide(),window.$(".carauto-create-content .jingji-intro").html('比赛模式<span style="color:#ff0000;">必须使用绑定昵称的账号</span>，否则会导致无法确认获胜者；'),window.$(".carauto-create-content .jingji-intro").show(),o="确定",window.$(".carauto-create-select-list li[areatag='1']").hide()):window.$(".bind-nickname").css("display","none"),2==t&&(i="更新车队信息",o="更新"),window.$(".carauto-create-title").html(i),window.$(".carauto-create-sure button").text(o);const s=uu.getRoomInfo().area_name;window.$(".create-area-qu .create-area-qu-title").text(s),window.$(".carauto-create-selected-qu").text("请选择"+s),this.loadLOLChannel(t,e,n)}else Vt(i.error_msg)}));else if(uu.isBattleRoom()||uu.isPaidanAnchor(uu.getMeid())||uu.getSelfInfo().vip>=5||1==uu.getCid()){let i="创建车队",o="确定";1==t?(i=uu.isShengyouFreeRoom()?"创建歌房":"创建车队",o="确定",window.$(".carauto-create-item-xuanshang").css("display","flex"),window.$(".create-duanwei-qu").show(),window.$(".carauto-create-content .yaoqiu").show()):2==t&&(i="更新车队信息",o="更新",window.$(".carauto-create-item-xuanshang").hide(),window.$(".create-duanwei-qu").show(),window.$(".carauto-create-content .yaoqiu").show()),window.$(".carauto-create-type-select__container").css("display","none"),window.$(".carauto-create-content .jingji-intro").hide(),3==t?(i="绑定昵称",window.$(".bind-nickname").css("display","flex"),window.$(".create-duanwei-qu").hide(),window.$(".carauto-create-content .yaoqiu").hide(),window.$(".carauto-create-item-xuanshang").hide(),window.$(".carauto-create-content .jingji-intro").html('比赛模式<span style="color:#ff0000;">必须使用绑定昵称的账号</span>，否则会导致无法确认获胜者；'),window.$(".carauto-create-content .jingji-intro").show(),o="确定",window.$(".carauto-create-select-list li[areatag='1']").hide()):window.$(".bind-nickname").css("display","none"),2==t&&(i="更新车队信息",o="更新"),window.$(".carauto-create-title").html(i),window.$(".carauto-create-sure button").text(o);const s=uu.getRoomInfo().area_name;window.$(".create-area-qu .create-area-qu-title").text(s),window.$(".carauto-create-selected-qu").text("请选择"+s),this.loadLOLChannel(t,e,n)}else uu.getSelfInfo().vip<5&&Vt("等级达到侯爵才可以创建哦")}showChoiceCreateCarDialog(){const t=this.choiceCreateCarData.data[this.tabIndex];"唱歌"==t.title?(window.$(".create-area-qu-title").text("分类"),window.$(".carauto-create-title").html("创建歌房"),window.$(".carauto-create-selected.carauto-create-selected-qu").text("请选择分类")):(window.$(".create-area-qu-title").text("模式"),window.$(".carauto-create-title").html("创建车队"),window.$(".carauto-create-selected.carauto-create-selected-qu").text("请选择模式"));const e=t.infos,n=e.welcome_fleet;let i=!1;n&&(i=n.can_create||!1);const o=e.areas,s=e.tags,a=e.live,r=e.desc,c=e.newrec,l=e.levels,d=e.areaid,m=e.levelid,h=e.solo_fleet,u=e.bgs;"游戏"==t.title&&i?(window.$(".carauto-create-content .meetNewPersonTeamContainer").show(),console.log(n),window.$(".priceValue.priceValue1").html(n.price[0].value),window.$(".priceValue.priceValue2").html(n.price[1].value)):window.$(".carauto-create-content .meetNewPersonTeamContainer").hide(),window.$(".carauto-create-item-live").hide(),window.$(".carauto-create-item-game-live").hide(),window.$(".carauto-create-item-solo").hide(),window.$(".car_live_check").prop("checked",!1),window.$(".car_game_live_check").prop("checked",!1),window.$(".car_solo_check").prop("checked",!1),window.$(".other-qu").hide(),1==a&&("唱歌"==window.$(".carauto-create-type-select-item.select")[0].dataset.title?window.$(".carauto-create-item-live").show():window.$(".carauto-create-item-game-live").show()),1==h&&window.$(".carauto-create-item-solo").show(),1==c?(window.$(".carauto-create-item-rec").show(),window.$(".car_rec_check").prop("checked",!0)):window.$(".carauto-create-item-rec").hide(),l.length>1?(this._setLolLevel(l,m),window.$(".create-duanwei-qu").show()):window.$(".create-duanwei-qu").hide(),window.$(".carauto-create-selected.carauto-create-selected-qu").attr("areaid",-1),window.$(".carauto-create-selected-tag").text(s[0].value).attr("tagid",s[0].id),window.$(".carauto-create-input-yaoqiu").val(r),this._setDefaultAreas(o,d,e.area_title||"");let p=[];for(let w=0;w<s.length;w++){const t=s[w];p.push('<li tagid="'+t.id+'">'+t.value+"</li>")}window.$(".carauto-create-tag-list ul").html(p.join(""));let g=[];for(let w=0;w<u.length;w++){const t=u[w];g.push('<div class="temproom-thumb-p'+(0==w?" select":"")+'" data-id="'+t.id+'">\n                        <img class="temproom-thumb" src="'+t.icon+'" />\n                        <div class="temproom-thumb-select-point"></div>\n                    </div>')}window.$(".music-temproom-bgs .swiper-slide").html(g.join("")),window.$(".carauto-create-item-tag").css("display","flex"),window.$(".create-music-bgs").css("display","block"),window.$(".carauto-create-type-select__container").css("display","flex");try{this.bgSwiper&&this.bgSwiper.destroy()}catch(f){}setTimeout((()=>{this.bgSwiper=new window.Swiper(".music-temproom-bgs",{threshold:20,direction:"horizontal",slidesPerView:"auto",freeMode:!0,mousewheel:!0})}),20)}loadLOLChannel(t,e,n){const i=uu.getCid(),o=this;this.request.get(Ot.getPublishInfoV4(i,n)).then((t=>{0==t.error?(window.$(".carauto-create-content-item__container>div").hide(),window.$(".carauto-create-content-item__container>div[data-mode='choice']").show(),o.choiceCreateCarData=t.data,window.$(".carauto-create-type-select__container").empty(),o.tabIndex=0,o.choiceCreateCarData.data.map(((t,e)=>{window.$(".carauto-create-type-select__container").append('<div data-title="'+t.title+'" data-typeid="'+t.typeid+'" class="carauto-create-type-select-item '+(0==e?"select":"")+'" data-tab="'+e+'"><div class="createcar-select-point"></div>'+t.title+"</div>")})),o.showChoiceCreateCarDialog(),window.$(".carauto-create-mask").show()):-99!=t.error&&Ct.Alert("获取信息错误")}))}_setDefaultAreas(t,e,n){const i=[];let o="";for(let s=0;s<t.length;s++)t[s].id==e&&(o=t[s].value);for(let s=0;s<t.length;s++){const e=t[s].id,n=t[s].value;i.push('<li areatag="'+(0==e||99==e?1:0)+'" areaid="'+e+'">'+n+"</li>")}window.$(".carauto-create-select-list ul").html(i.join("")),""==o?setTimeout((()=>{let t="不限大区",e=$(".carauto-create-type-select-item.select").attr("data-typeid");"1"==e?t="不限分类":"0"==e&&(t="不限大区");const n=t;window.$(".carauto-create-selected-qu").text(n).attr("areaid",0)}),0):window.$(".carauto-create-selected-qu").text(o).attr("areaid",e)}_setLolLevel(t,e){const n=[];let i="";for(let o=0;o<t.length;o++)t[o].id==e&&(i=t[o].value);for(let o=0;o<t.length;o++){const e=t[o].id,i=t[o].value;n.push('<li levelid="'+e+'">'+i+"</li>")}window.$(".carauto-create-duanwei-select-list ul").html(n.join("")),""==i?window.$(".carauto-create-selected-duan").text(t[0].value).attr("levelid",t[0].id):window.$(".carauto-create-selected-duan").text(i).attr("levelid",e)}_setLolChannel(t,e){const n=[];let i=0;for(let s=0;s<t.length;s++){const e=t[s].typeid;n.push('<span class="'+(0==s?"current":"")+'" channelid="'+e+'">'+t[s].value+"</span>"),0==s&&(i=e)}window.$(".lolqu-channel").html(n.join(""));const o=[];for(let s=0;s<e.length;s++){const t=e[s].typeid;o.push('<li style="display:'+(i==t?"block":"none")+'" channelid="'+t+'" areaid="'+e[s].id+'">'+e[s].value+"</li>")}window.$(".lolqu-list").html(o.join("")),window.$(".lolqu-list li[channelid='"+i+"']").eq(0).addClass("current")}_setGiftShang(t,e,n){const i=[];let o=null;for(let s=0;s<t.length;s++){const n=t[s],a=n.icon,r=n.diamond,c=n.id,l=n.nums,d=n.unit,m=n.title;i.push('<li title="'+m+"\" nums='"+l.join(",")+"' diamond=\""+r+'" class="" giftid="'+c+'" unit="'+d+'">\n\t\t\t\t\t\t\t<img src="'+a+'">\n\t\t\t\t\t\t</li>'),c==e&&(o=n)}window.$(".carauto-create-xuanshang-gift ul.shang-gift-list").html(i.join("")),n>0&&(window.$(".carauto-create-gift-num input").val(n),window.$(".carauto-create-xuanshang-gift li[giftid='"+e+"']").addClass("current"),this.setShangGiftList(o.nums,o.diamond,o.unit,n))}_setRewards(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n],o=i.id,s=i.name;e.push('<li money="'+o+'">'+s+"</li>"),0==n&&(window.$(".jingji-select-money").attr("money",o),window.$(".jingji-select-money").text(s))}window.$(".jingji-create-select-money ul").html(e.join(""))}getGamename(t,e){const n=Pt+"/Sports/getGamename?format=jsonp&gameid=31540&areaid="+t;this.request.get(n).then((t=>{0==t.error?e&&e(t.data):-99!=t.error&&Ct.Alert(t.error_msg)}))}setShangGiftList(t,e,n,i){const o=['<li num="0" diamond="0" class="flex">\n\t\t\t\t\t\t\t<div>0'+n+"</div><span>不使用悬赏</span>\n\t\t\t\t\t\t</li>"];let s=uu.getRoomInfo().fleetnum-1;for(let a=0;a<t.length;a++){const i=t[a];o.push('<li num="'+i+'" diamond="'+e+'" class="flex">\n\t\t\t\t\t\t\t<div>'+i+n+"</div><span>消耗"+i*e*s+"钻</span>\n\t\t\t\t\t\t</li>")}window.$(".carauto-create-gift-num ul").html(o.join("")),window.$(".carauto-create-gift-num span.shang-need-diamond").text("消耗"+i*e*s+"钻"),window.$(".carauto-create-gift-num em").text(n)}initEvent(){let t=this;window.$(".carauto-create-selected-qu").on("click",(function(t){t.stopPropagation();const e=window.$(".carauto-create-mask .carauto-create-select-list");return window.$(".carauto-create-mask .carauto-create-duanwei-select-list").hide(),window.$(".carauto-create-mask .carauto-create-tag-list").hide(),"none"==e.css("display")?e.show():e.hide(),!1})),window.$(".carauto-create-selected-tag").on("click",(function(t){t.stopPropagation();const e=window.$(".carauto-create-mask .carauto-create-tag-list");return"none"==e.css("display")?e.show():e.hide(),!1})),window.$(".jingji-select-money").on("click",(function(t){t.stopPropagation();const e=window.$(".carauto-create-mask .jingji-create-select-money");return"none"==e.css("display")?e.show():e.hide(),!1})),window.$(".carauto-create-title").on("click","span",(function(){if(window.$(this).hasClass("current"))return;window.$(".carauto-create-title span").removeClass("current"),window.$(this).addClass("current");const t=window.$(this).attr("type");if("1"==t)window.$(".carauto-create-item-xuanshang").css("display","flex"),window.$(".jingji-intro").hide(),window.$(".carauto-create-select-list li[areatag='1']").show(),window.$(".carauto-create-select-list li[areatag='3']").hide();else if("2"==t){window.$(".carauto-create-item-xuanshang").hide(),window.$(".jingji-intro").text("每人投入固定钻石，游戏结束后第一名获得全部。"),window.$(".jingji-intro").show(),window.$(".carauto-create-select-list li[areatag='1']").hide();const t=window.$(".carauto-create-selected-qu").attr("areaid");if(0!=t&&99!=t);else{0==window.$(".carauto-create-select-list li[areatag='0']").length&&window.$(".carauto-create-select-list ul").append('\n                            <li areatag="3" areaid="1">艾欧尼亚</li>\n                            <li areatag="3" areaid="14">黑色玫瑰</li>\n                            <li areatag="3" areaid="7">皮尔特沃夫</li>');let t=window.$(".carauto-create-select-list li[areatag='0']").eq(0);0==t.length&&(t=window.$(".carauto-create-select-list li[areatag='3']").eq(0));const e=t.attr("areaid"),n=t.text();window.$(".carauto-create-selected-qu").attr("areaid",e),window.$(".carauto-create-selected-qu").text(n)}}})),window.$(".carauto-create-selected-duan").on("click",(function(t){t.stopPropagation();const e=window.$(".carauto-create-mask .carauto-create-duanwei-select-list");return window.$(".carauto-create-mask .carauto-create-select-list").hide(),"none"==e.css("display")?e.show():e.hide(),!1})),window.$(".carauto-create-mask").on("click",".other-qu",(function(){si.show(".lolqu-mask","block")})),window.$(".carauto-create-mask ul.shang-gift-list").on("click","li",(function(){if(window.$(this).hasClass("current"))window.$(this).removeClass("current"),window.$(".carauto-create-gift-num input").val("0"),window.$(".carauto-create-gift-num span.shang-need-diamond").text("消耗0钻");else{window.$(".carauto-create-xuanshang-gift ul li").removeClass("current"),window.$(this).removeClass("default").addClass("current");const e=window.$(this).attr("nums").split(","),n=window.$(this).attr("diamond"),i=window.$(this).attr("unit");let o=window.$(".carauto-create-gift-num input").val();if(0==o){let e=t.common.getRoomInfo().fleetnum-1;o=1,window.$(".carauto-create-gift-num input").val("10"),window.$(".carauto-create-gift-num span.shang-need-diamond").text("消耗"+n*e*10+"钻")}t.setShangGiftList(e,n,i,o)}})),window.$(".carauto-create-mask").on("click",".carauto-create-close",(function(){window.$(".carauto-create-mask").hide()})),window.$(".carauto-create-mask").on("click",".music-temproom-bgs .temproom-thumb-p",(function(){window.$(this).parent().find("div.temproom-thumb-p").removeClass("select"),window.$(this).addClass("select")})),window.$(".carauto-create-select-list ul").on("click","li",(function(e){e.stopPropagation();const n=window.$(this).attr("areaid"),i=window.$(this).text();window.$(".carauto-create-selected-qu").attr("areaid",n),window.$(".carauto-create-selected-qu").text(i),window.$(".carauto-create-select-list").hide(),t.common.isTempCarteamRoom()&&t.getGamename(n,(t=>{window.$(".bind-nickname input.bind-nickname-input").val(t.nickname||"")}))})),window.$(".carauto-create-tag-list ul").on("click","li",(function(t){t.stopPropagation();const e=window.$(this).attr("tagid"),n=window.$(this).text();window.$(".carauto-create-selected-tag").text(n).attr("tagid",e),window.$(".carauto-create-tag-list").hide()})),window.$(".jingji-create-select-money ul").on("click","li",(function(t){t.stopPropagation();const e=window.$(this).attr("money"),n=e+"钻";window.$(".jingji-select-money").attr("money",e),window.$(".jingji-select-money").text(n),window.$(".jingji-create-select-money").hide()})),window.$(".carauto-create-duanwei-select-list ul").on("click","li",(function(t){t.stopPropagation();const e=window.$(this).attr("levelid"),n=window.$(this).text();window.$(".carauto-create-selected-duan").attr("levelid",e),window.$(".carauto-create-selected-duan").text(n),window.$(".carauto-create-duanwei-select-list").hide()})),window.$(".carauto-create-content").on("click",(function(){window.$(".carauto-create-select-list").hide(),window.$(".carauto-create-duanwei-select-list").hide(),window.$(".carauto-create-gift-num ul").hide(),window.$(".carauto-create-mask .jingji-create-select-money").hide(),window.$(".carauto-create-mask .carauto-create-tag-list").hide()})),window.$(".carauto-create-mask").on("click","#game_live_checkbox",(function(){1==window.$(".car_game_live_check").prop("checked")&&window.$(".car_live_check").prop("checked",!1)})),window.$(".carauto-create-mask").on("click","#live_checkbox",(function(){1==window.$(".car_live_check").prop("checked")&&window.$(".car_game_live_check").prop("checked",!1)})),window.$(".carauto-create-sure").on("click","button",(async function(e){t.handleClickConfirm(this)})),window.$(".meetNewPersonTeamContainer .rightCtn").on("click",(function(t){0==t.currentTarget.dataset.active?($(t.currentTarget).addClass("active"),$(t.currentTarget).attr("data-active",1),$(".meetNewPersonTeamContainer .subContainer").show()):($(t.currentTarget).removeClass("active"),$(t.currentTarget).attr("data-active",0),$(".meetNewPersonTeamContainer .subContainer").hide())})),window.$(".meetNewPersonTeamContainer .subRadioCtn").on("click",(function(t){1==t.currentTarget.dataset.mode?($('.meetNewPersonTeamContainer .subRadioCtn[data-mode="1"]').addClass("active"),$('.meetNewPersonTeamContainer .subRadioCtn[data-mode="2"]').removeClass("active"),$(".priceValue.priceValue1").show(),$(".priceValue.priceValue2").hide()):($('.meetNewPersonTeamContainer .subRadioCtn[data-mode="2"]').addClass("active"),$('.meetNewPersonTeamContainer .subRadioCtn[data-mode="1"]').removeClass("active"),$(".priceValue.priceValue2").show(),$(".priceValue.priceValue1").hide())})),window.$(".meetNewPersonTeamContainer .tipsImg").on("click",(function(t){Ct.Alert('\n                <p>流量扶持规则</p>\n                <p style="text-align: left;">迎新车队创建后，平台将自动推送新用户上车，最多不超过5个；超过5个未成功开车，车队自动解散</p>\n                <p>费用返还规则</p>\n                <p style="text-align: left;">迎新车队开够20分钟且新用户上车超过15分钟，返还20紫晶</p>\n                <p style="text-align: left;">车队解散时，上车新用户不足5个，返还20紫晶</p>\n                <p>【多带一】激励政策</p>\n                <p style="text-align: left;">多带一，即多个队长带领一名新用户开黑；选择多带一并且有效开车场次，可以同步计算给被邀请的其他队长</p>\n            ',null,"迎新车队说明")})),Je.disposeNickname=function(){const e=window.$(".lolqu-list").find("li.current"),n=e.attr("areaid"),i=e.text();window.$(".carauto-create-selected-qu").attr("areaid",n),window.$(".carauto-create-selected-qu").text(i),si.hide(".lolqu-mask"),t.common.isTempCarteamRoom()&&t.getGamename(n,(t=>{window.$(".bind-nickname input.bind-nickname-input").val(t.nickname||"")}))},window.$(".carauto-create-gift-num").on("click",(function(t){t.stopPropagation();if(0==window.$(".shang-gift-list").find("li.current").length)return;const e=window.$(this).find("ul");"none"==e.css("display")?e.show():e.hide()})),window.$(".carauto-create-gift-num").on("click","li",(function(t){t.stopPropagation();const e=window.$(this).attr("num"),n=window.$(this).attr("diamond");window.$(".carauto-create-gift-num input").val(e);let i=uu.getRoomInfo().fleetnum-1;window.$(".carauto-create-gift-num span.shang-need-diamond").text("消耗"+e*n*i+"钻"),window.$(".carauto-create-gift-num ul").hide()})),window.$(".carauto-create-gift-num input").on("focus",(function(t){t.stopPropagation()})),window.$(".carauto-create-gift-num input").on("keyup",(function(t){t.stopPropagation();const e=window.$(this).val();let n=uu.getRoomInfo().fleetnum-1;const i=window.$(".shang-gift-list").find("li.current").attr("diamond");window.$(".carauto-create-gift-num span.shang-need-diamond").text("消耗"+e*i*n+"钻")})),window.$(document).on("click",".carauto-create-type-select-item",(function(e){const n=e.currentTarget.dataset.tab;window.$(".carauto-create-type-select-item").removeClass("select"),window.$(".car_solo_check").prop("checked",!1),window.$(this).addClass("select"),t.tabIndex=n,t.showChoiceCreateCarDialog()}))}async handleClickConfirm(t,e=!1){console.log("this----0-----"),console.log(this);const n=this,i=window.$(".car_game_live_check").prop("checked")||window.$(".carauto-create-type-select-item.select").length&&"小游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title&&309!=window.$(".carauto-create-selected-qu").attr("areaid")?1:0;let o=window.$(".car_live_check").prop("checked")?1:0;window.$(".car_solo_check").prop("checked")&&(o=9);const s=uu.getCid(),a=window.$(".carauto-create-selected-qu").attr("areaid"),r=window.$(".carauto-create-selected-duan").attr("levelid"),c=window.$(".carauto-create-item.yaoqiu textarea").val().replace(/[\n\r]/g,"");let l=window.$(".carauto-create-gift-num input").val();if(a<0)return void("小游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title||"游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title?Vt("请选择模式"):"唱歌"==window.$(".carauto-create-type-select-item.select")[0].dataset.title?Vt("请选择分类"):Vt("请选择大区"));if(n.common.isTempCarteamRoom())return;if(""==window.$.trim(c))return void Vt("请填写您的要求");if(window.$.trim(c).length<5)return void Vt("要求内容不得少于5个字符");let d="";if("游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title&&1==window.$(".meetNewPersonTeamContainer .rightCtn")[0].dataset.active){if(d=window.$(".subRadioCtn.active").data().mode,!e){const e=await qt.get(Ot.getWelcomeFleetPayInfo(d));return console.log(e),0!=e.error?(Vt("余额不足,请充值~"),void setTimeout((()=>{window.location.href="https://y.tuwan.com/activity/511C3b42ff#/"}),1e3)):void window.$.DialogByZ.Confirm({Title:"提示",Content:`创建迎新车队需支付${e.data.price}${e.data.payTypeStr}，是否确认支付创建`,BtnL:"取消",BtnR:"确认",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){window.$.DialogByZ.Close(),n.handleClickConfirm(t,!0)}})}}else d="";let m=0,h="";const u=window.$(".carauto-create-xuanshang-gift ul").find("li.current");u.length>0&&(m=u.attr("giftid"),h=u.find("img").attr("src")),0==m&&(l=0);let p={},g=window.$(".car_rec_check").is(":checked")?100:0,f=0,w=0;const v=window.$(".carauto-create-type-select-item.select")[0].dataset.typeid;uu.isShengyouFreeRoom()||uu.isLiveRoom()?(f=window.$(".create-music-bgs").find(".select").attr("data-id"),w=window.$(".carauto-create-selected-tag").attr("tagid"),p={cid:s,areaid:a,desc:c,sports:0,tagid:1*w,bgid:1*f,levelid:r,guidance:g,live:o,ftype:uu.roomInfo.fleet_type,typeid:v,mode:d}):(f=window.$(".create-music-bgs").find(".select").attr("data-id"),w=window.$(".carauto-create-selected-tag").attr("tagid"),p={cid:s,areaid:a,levelid:r,giftid:m,giftnum:l,desc:c,sports:0,guidance:g,live:o,tagid:1*w,bgid:1*f,ftype:uu.roomInfo.fleet_type,typeid:v,mode:d}),window.$(".carauto-create-mask").hide(),1==uu.getRoomInfo().new_chat_mode||uu.isBattleRoom()||window.$(".yaoqing-float").css("display","flex");const _=window.$(".carauto-create-selected-tag").text();bs.createAutoCarDataGloab={cid:s,areaid:a,levelid:r,giftid:m,giftnum:l,fleetnum:uu.roomInfo.fleetnum,desc:c,sports:0,giftpath:h,areaname:window.$(".carauto-create-selected-qu").text(),levelname:uu.isShengyouFreeRoom()?_:window.$(".carauto-create-selected-duan").text(),live:o,mode:d};let y=Ot.runGameLive(s,a,1*w,1*f,c);if("确定"==window.$(t).text())if(1==i)if(y+="&typeid="+v,2==v&&n.choiceCreateCarData.data[2].infos.gameType>0){const t={buildTypeId:1,roomInfo:{cid:uu.getCid(),roomName:c,roomType:a,roomBgImg:f,gameType:n.choiceCreateCarData.data[2].infos.gameType}};n.publishGameRoom&&n.publishGameRoom(t)}else qt.get(y).then((t=>{0==t.error?"游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title?Ti.getInstance().joinRoom(t.data):"小游戏"==window.$(".carauto-create-type-select-item.select")[0].dataset.title&&Le.getInstance().joinRoom(t.data):(window.$(".yaoqing-float").hide(),Vt(t.error_msg))})).catch((t=>{Vt("网络错误,请稍后再试..")}));else n.publishFleet(p);else n.updatepublishFleet(p)}sendBordCast(t,e){this.sendSocketBordCast(t,e)}async sendSocketBordCast(t,e){const n={message:kd.messageFormat(t,e)};uu.globalDDSocket.send("message",n)}updatepublishFleet(t){t.fid=window.$(".carauto-teams-persons").attr("fid"),uu.globalDDSocket.send("updatePublishInfo",t)}publishFleet(t){const e=Ct.readCookie("Tuwan_Passport");t.passport=e,uu.globalDDSocket.send("publishFleet",t)}}class Sh{constructor(t,e){this.instance=null,this.buildTypeInfos=null,this.roomInfo=null,this.chooseRoom=null,this.goTuwanGame=e,this.pay=t,this.rooms=[]}static getInstance(t,e){return this.instance||(this.instance=new Sh(t,e)),this.instance}initTemplate(){0==window.$(".create_self_room_mask").length?(this.initCss(),this.initHtml()):this.initModalData()}initCss(){window.$("head").append("<style>\n                        .self_flex_c{\n                            display:flex;\n                            align-items:center;\n                            justify-content:center;\n                        }\n\n                        .create_self_room_mask{\n                            display:none;\n                            justify-content:center;\n                            align-items:center;\n                            width: 100%;\n                            height: 100%;\n                            background: rgba(0, 0, 0, 0.6);\n                            top: 0;\n                            left: 0;\n                            z-index: 2000;\n                            position: fixed;\n                        }\n\n                        .create_self_room_common_content{\n                            display:none;\n                            position: relative;\n                            width: 300px;\n                            background: #fff;\n                            border-radius: 10px;\n                            padding: 0 32px;\n                            padding-bottom: 10px;\n                        }\n\n                        .create_self_room_close{\n                            position: absolute;\n                            width: 40px;\n                            height: 40px;\n                            background: url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png) no-repeat center center;\n                            right: 0;\n                            top: 0;\n                            cursor: pointer;\n                        }\n\n                        .self_room_title{\n                            font-size: 22px;\n                            color: #333;\n                            text-align: center;\n                            padding: 20px 0;\n                        }\n\n                        .self_room_type_list{\n                            margin-top:20px;\n                        }\n\n                        .self_room_type_item{\n                            width:130px;\n                            height:30px;\n                            border-radius:5px;\n                            border:1px solid #ccc;\n                            background:#fff;\n                            color:#999;\n                            font-size:16px;\n                            text-align:center;\n                            line-height:30px;\n                            margin:0 10px;\n                            cursor: pointer;\n                        }\n\n                        .self_room_type_item.actived{\n                            border:1px solid #f66692;\n                            color:#f66692;\n                        }\n\n                        .choose_self_room_type_btn, .create_self_room_type_btn{\n                            width: 200px;\n                            height: 40px;\n                            background: #ff5588;\n                            border-radius: 8px;\n                            color: #fff;\n                            font-size: 18px;\n                            cursor: pointer;\n                            text-align:center;\n                            line-height:40px;\n                            margin:20px auto 4px;\n                        }\n\n                        .choose_self_room_type_desc{\n                            font-size:14px;\n                            color:#999;\n                            text-align:center\n                        }\n\n                        .create_input_content {\n                            position: relative;\n                            display: flex;\n                            align-items: center;\n                            margin-bottom: 20px;\n                            color:#999\n                        }\n\n                        .create_common_input{\n                            width: 210px;\n                            height: 40px;\n                            line-height: 40px;\n                            background-color: #f4f4f6;\n                            border-radius: 5px;\n                            border: none;\n                            outline: none;\n                            margin-left: 20px;\n                            font-size: 14px;\n                            color: #999;\n                            padding-left: 10px;\n                            box-sizing:border-box;\n                        }\n\n                        .wolf_reward_select_type{\n                            width:60px\n                        }\n\n                        .wolf_reward_select_num{\n                            width:130px\n                        }\n\n                        .create_self_room_mask .room_bg_content .room_bg_item img {\n                            border-radius: 10px;\n                            overflow: hidden;\n                        }\n                        .create_self_room_mask .room_bg_content .room_bg_item.selected img {\n                            border:1px solid #f66692;\n                        }\n                    }\n                    window.$('.').html(roomBgHtml)\n\n                    </style>")}initHtml(){window.$("body").append('<div class="create_self_room_mask">\n                        <div class="choose_self_room_content create_self_room_common_content">\n                            <div class="create_self_room_close" data-type="0"></div>\n                            <div class="self_room_title">创建专属房间</div>\n                            <div class="self_room_type_list self_flex_c"></div>\n                            <div class="choose_self_room_type_btn">确定</div>\n                            <div class="choose_self_room_type_desc"></div>\n                        </div>\n                        <div class="create_self_room_content create_self_room_common_content">\n                            <div class="create_self_room_close" data-type="1"></div>\n                            <div class="create_self_room_title self_room_title"></div>\n                            <div class="create_input_content">\n                                房间名称:<input class="wolf_room_name create_common_input" type="text" maxlength="13">\n                            </div>\n                            <div class="create_input_content luxury_room_item">\n                                <span>房间奖励:</span>\n                                <select class="wolf_reward_select_type create_common_input" autocomplete="off">\n                                    <option value="1">钻石</option>\n                                    <option value="2">金币</option>\n                                </select>\n                                <select class="wolf_reward_select_num create_common_input" autocomplete="off"></select>\n                            </div>\n                            <div class="create_input_content game_type">\n                                <span>游戏类型:</span>\n                                <select class="wolf_game_select_type create_common_input" autocomplete="off"></select>\n                            </div>\n                            <div class="create_input_content">\n                                <span>游戏模式:</span>\n                                <select class="wolf_game_select_mode create_common_input" autocomplete="off"></select>\n                            </div>\n                            <div class="create_input_content">\n                                <span>场景主题</span>\n                            </div>\n                            <div class="room_bg_content scroll-horizontal flex" style="overflow-x: scroll;"></div>\n                            <div class="create_self_room_type_btn">创建</div>\n                            <div class="notice_captain flex flex-jc flex-ac" style="display: none;">\n                                <input type="checkbox" style="margin: 0; margin-right: 3px;" checked/>\n                                <p style="font-size: 14px;">通知队长</p>\n                            </div>\n                        </div>\n                    </div>'),this.initEvent(),this.initModalData()}initModalData(){qt.get(Ot.getCreateSpyRoomInfoV2(uu.getCid())).then((t=>{if(0==t.code||0==t.error){this.rooms=t.data.data,this.chooseRoom=this.rooms[0],this.chooseGame=this.rooms[0].data[0],window.$(".create_self_room_common_content").hide(),window.$(".create_self_room_mask").css("display","flex"),window.$(".choose_self_room_content").show();let e="";for(let t=0,n=this.rooms.length;t<n;t++){const n=this.rooms[t];e+=`<div class="self_room_type_item ${0==t?"actived":""}" data-type="${n.typeId}">${n.typeName}</div>`}window.$(".self_room_type_list").html(e),window.$(".choose_self_room_type_desc").html(this.getCostDesc())}else Vt(t.message)}))}getCostDesc(){return this.chooseRoom.data[0].buildTypeInfos.costDesc}renderSelectNum(t){let e="",n=this.chooseGame.roomInfo.rewardInfo.limits[1==t?"diamondLimits":"coinLimits"];for(let i=0,o=n.length;i<o;i++){const t=n[i];e+=`<option value='${t}'>${t}</option>`}window.$(".wolf_reward_select_num").html(e)}initEvent(){let t=this;function e(){const e=t.chooseGame.roomInfo;let n="";for(let t=0,a=e.roomTypes.length;t<a;t++){const i=e.roomTypes[t];n+=`<option value='${i.id}'>${i.name}</option>`}window.$(".wolf_game_select_mode").html(n);const i=t.chooseGame.buildTypeInfos.imageAttachments,o=i.findIndex((t=>t.id==e.roomBgImg));-1===o&&(e.roomBgImg=i[0].id);let s="";for(let t=0,a=i.length;t<a;t++){const n=i[t];s+=`<div class="room_bg_item ${n.id==e.roomBgImg?"selected":""}" style="margin-right: 10px;" data-id="${n.id}">\n                                    <img src="${n.fileName}" style="width: 100px; height: 217px;">\n                                    <div class="room_bg_select_doit"></div>\n                                </div>`}window.$(".room_bg_content").html(s),o>0&&window.$(".room_bg_content").scrollLeft(110*o)}window.$(".create_self_room_mask").on("click",".create_self_room_close",(function(){0==this.dataset.type?window.$(".create_self_room_mask").hide():(window.$(".create_self_room_content").hide(),window.$(".choose_self_room_content").show())})),window.$(".create_self_room_mask").on("click",".self_room_type_item",(function(){let e=window.$(this).index();t.chooseRoom=t.rooms[e],t.chooseGame=t.rooms[e].data[0],window.$(".self_room_type_item").removeClass("actived"),window.$(".self_room_type_item").eq(e).addClass("actived"),window.$(".choose_self_room_type_desc").html(t.getCostDesc())})),window.$(".create_self_room_mask").on("click",".choose_self_room_type_btn",(function(){const n=t.chooseGame.roomInfo;window.$(".create_self_room_common_content").hide(),window.$(".create_self_room_content").show(),window.$(".create_self_room_title").html(`房间设置-${t.chooseRoom.typeName}`),window.$(".wolf_room_name").val(n.roomName);let i="";for(let e=0,o=t.chooseRoom.data.length;e<o;e++){const n=t.chooseRoom.data[e];i+=`<option value='${n.gameType}'>${n.gameTitle}</option>`}window.$(".wolf_game_select_type").html(i),window.$(".create_input_content.game_type").css("display",t.chooseRoom.data.length>1?"flex":"none"),e(),2==t.chooseRoom.typeId?(window.$(".create_self_room_mask .notice_captain").show(),window.$(".luxury_room_item").css("display","flex"),t.renderSelectNum(1)):(window.$(".create_self_room_mask .notice_captain").hide(),window.$(".luxury_room_item").hide()),window.$(".create_self_room_mask .notice_captain input").prop("checked",n.pushTeacher)})),window.$(".create_self_room_mask").on("click",".create_self_room_type_btn",(function(){const e={buildTypeId:t.chooseRoom.typeId,roomInfo:{cid:uu.getCid(),roomName:window.$(".create_self_room_mask .wolf_room_name").val(),roomType:window.$(".create_self_room_mask .wolf_game_select_mode").val(),roomBgImg:window.$(".create_self_room_mask .room_bg_content .room_bg_item.selected").data("id"),gameType:t.chooseGame.gameType}};2==t.chooseRoom.typeId&&(e.roomInfo.rewardInfo={money:window.$(".create_self_room_mask .wolf_reward_select_num").val(),costType:window.$(".create_self_room_mask .wolf_reward_select_type").val()},e.roomInfo.pushTeacher=window.$(".create_self_room_mask .notice_captain input").prop("checked")),t.publishRoom(e)})),window.$(".wolf_reward_select_type").on("change",(function(){let e=window.$(this).val();t.renderSelectNum(e)})),window.$(".wolf_game_select_type").on("change",(function(){let n=window.$(this).val();t.chooseGame=t.chooseRoom.data.find((t=>t.gameType==n)),e()})),window.$(".create_self_room_mask").on("click",".room_bg_content .room_bg_item",(function(){window.$(".room_bg_content .room_bg_item").removeClass("selected"),window.$(this).addClass("selected")}))}publishRoom(t){qt.post(Ot.postCreateSpyRoom(),JSON.stringify(t),"application/json").then((t=>{if(0==t.code||0==t.error)Vt("创建成功"),window.$(".create_self_room_mask").hide(),this.goTuwanGame(t.data.roomId,t.data.gameType);else if(-2==t.code||-2==t.error){const e=t.data.rechargeDiamonds;this.pay.payQRCodeWithDiamond((e/10).toFixed(1),(()=>{}),(()=>'<p class="pay-title">还需要支付<span id="pay-needmoney">'+e+"</span> 钻石</p>"),(()=>""))}else t.error_msg?Vt(t.error_msg):Vt(t.message)})).catch((t=>{Vt("网络错误,请稍后再试..")}))}static showInviteModal(t,e){const n=`\n            <div class="flex flex-ac flex-jc" style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; background-color: rgba(0, 0, 0, 0.6); z-index: 2000;">\n                <div style="padding: 20px; width: 260px; background-color: white; border-radius: 10px;">\n                    <p style="text-align: center; font-size: 16px;">奖励房间</p>\n                    <p style="margin-top: 10px;">\n                        <span><img style="height: 20px;" src="${t.vipicon}" /></span>\n                        <span style="color: ${t.nickname_color};">${t.nickname}</span>\n                        <span>${t.desc}</span>\n                    </p>\n                    ${0==t.roomRewardCostType?"":`<div class="flex flex-jc flex-ac" style="margin-top: 10px;">\n                        ${function(){let e="";return 1==t.roomRewardCostType?e='<img style="width: 20px; margin-right: 5px;" src="https://res.tuwan.com/templet/teach/play/recharge/images/jewel_hover.png?3="/>':2==t.roomRewardCostType&&(e='<img style="width: 20px; margin-right: 5px;" src="https://asset.tuwan.com/chatroom/images/wolf_gold.png"/>'),e}()}\n                        <p>${t.roomRewardCosts}</p>\n                    </div>`}\n                    <div class="flex flex-jc" style="margin-top: 10px;">\n                        <p class="selfwolfroom_invite_btn" data-type="1" data-fid="${t.fid}" style="margin-right: 20px; width: 100px; line-height: 40px; border-radius: 40px; border: 1px solid #C3C4D6; text-align: center; font-size: 16px; font-weight: 500; color: #C3C4D6; cursor: pointer;">忽略</p>\n                        <p class="selfwolfroom_invite_btn" data-type="2" data-fid="${t.fid}" data-gameid="${t.gameid}" style="width: 100px; line-height: 40px; border-radius: 40px; background: #FF6691; text-align: center; font-size: 16px; font-weight: 500; color: white; cursor: pointer;">同意</p>\n                    </div>\n                </div>\n            </div>\n        `,i=window.$(n);window.$("body").append(i),i.on("click",".selfwolfroom_invite_btn",(function(){qt.get(Ot.getReportKillInvite(this.dataset.fid,this.dataset.type)).then((t=>{})),2==this.dataset.type&&e(this.dataset.fid,this.dataset.gameid),i.remove()}))}}function Th(t,e,n,i,o,s){const a=kd.Type,r=e*i,c={typeid:2103,money:t+"|"+n+"|"+e+"|0|100|"+uu.getCid()};Hi.payQRCode(c,r,(t=>{Rh(a.giftall,o)}))}async function Rh(t,e){if(e){const t=e.touserinfo,n=1*e.tipstype,i=1*e.giftime+1e3;if(2==n){if(t.length){const e=Pt+"/Teacher/checkConfessionV1?teacher_id="+t.map((t=>t.userid)).join(",")+"&format=jsonp";setTimeout((()=>{qt.get(e).then((e=>{let n="";0==e.error&&(n=e.data.confession_desc),t.length>1?setTimeout((function(){if(0==e.error){const i=si.show(".div-biaobai","block");i.find(".span-biaobai-name").text("“全麦”"),i.find(".span-biaobai-name").attr("name","全麦"),i.find(".span-biaobai-name").attr("account",e.data.ids),i.find(".span-biaobai-name").attr("account1",t.map((t=>t.userid)).join(",")),n.length>0&&i.find(".biaobai-desc").text(n).css("margin-top","-10px")}else Vt(e.error_msg)}),i):qt.getUserInfo(t[0].userid,"sendCommondMessage").then((o=>{setTimeout((function(){if(0==e.error){const i=si.show(".div-biaobai","block"),s=o.nickname;i.find(".span-biaobai-name").text("“"+s+"”"),i.find(".span-biaobai-name").attr("name",s),i.find(".span-biaobai-name").attr("account",e.data.ids),i.find(".span-biaobai-name").attr("account1",t[0].userid),n.length>0&&i.find(".biaobai-desc").text(n).css("margin-top","-10px")}else Vt(e.error_msg)}),i)}))}))}),2e3)}}else 1==n&&qe.addGuanmingData(t,i);const o={gift_price:e.price,gift_id:e.giftid,gift_num:e.count};375==e.giftid||340==e.giftid||484==e.giftid?Xm.track(uu.getAnalyticsData("send_mengxin_gift",o)):Xm.track(uu.getAnalyticsData("send_no_mengxin_gift",o))}else Rd("请输入要发送的消息")}function Mh(t,e,n,i){const o={cid:t,fid:e,type:n,passport:Ct.readCookie("Tuwan_Passport")};uu.globalDDSocket.send("publishOper",o),2==n&&im(i)}function Ah(t,e,n,i=!1){uu.getMeid()>Mt.maxUID?du():Zd(kd.messageFormat($d.image,t,e,n,i))}let Ph,jh=null,Dh=0;function Lh(){if(uu.getMeid()>Mt.maxUID)return void du();if(0==uu.getRoomInfo().speaking||0==uu.getRoomInfo().access)return;if(0==fm.gloabIsBindPhone)return fm.gloabBindPhone||(fm.gloabBindPhone=BindPhone.getInstance(window.jQuery,qt),fm.gloabBindPhone.emitter.on("success",(function(){Vt("手机绑定成功"),fm.gloabIsBindPhone=1}))),void fm.gloabBindPhone.show();let t=window.$.trim(window.$(".chat-input-text textarea").val());if(""!=t){if(t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/<\/?[^>]*>/g,""),t=t.replace(/\r\n/g,"<br>"),t=t.replace(/\n/g,"<br>"),t=t.replace(//g,""),""!=t){let e=Math.round((new Date).getTime()/1e3);t==jh?e-Dh>3?(jh=t,Dh=e,Xd($d.text,t)):Vt("您说的太快，请稍微休息一下~"):(jh=t,Dh=e,Xd($d.text,t))}window.$(".chat-input-text textarea").val("")}else Rd("请输入要发送的消息")}class Eh{constructor(){this.initStyle(),this.initLevelModal(),this.navSwiper=null,this.pc_max_money=0,this.up_need_money=0}static getInstance(){return this.instance||(this.instance=new Eh),this.instance}initStyle(){window.$("head").append("<style>\n                        .ygb_flex{display:flex}\n                        .ygb_f_c{display:flex;align-items:center;justify-content:center}\n                        .ygb_f_sb{display:flex;align-items:center;justify-content:space-between}\n                        .level_content{position:relative;width: 888px;height: 583px;background: #FFFFFF;border-radius: 10px;user-select:none}\n                        .level_content_close{position: absolute;width: 40px;height: 40px;background: url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png) no-repeat center center;background-size:16px 16px;right: 0;top: 0;cursor: pointer;}\n                        .level_content_title{text-align:center;font-size:26px;color:#333333;margin:24px auto}\n                        .level_tab_content{margin: auto; overflow: hidden;display:flex !important;height:60px !important;width:800px !important;border:1px solid #D8D8D8;}\n                        .level_tab_item{border-left:1px solid #D8D8D8;box-sizing:border-box;font-weight:bold;color:rgba(51,51,51,.3);cursor: pointer;}\n                        .level_tab_item:first-child{border-left:unset}\n                        .level_tab_item img{width:30px;margin-right:6px;opacity:.5}\n                        .level_tab_current{background: rgba(255, 140, 173, 1);color:#fff}\n                        .level_tab_current img{width:38px;opacity:1}\n                        .level_content .swiper-button-next-custom, .level_content .swiper-button-prev-custom { position: absolute !important; background-repeat: no-repeat !important; top: 86px !important; transform: none !important; }\n                        .level_content .swiper-button-next-custom{width: 16px;height: 60px;right:34px;top: 24%;transform: translateY(-50%);background-image: url(https://asset.tuwan.com/officialsite/images/level_right.png);background-size:16px 23px;background-position: center right;cursor: pointer;outline: none;z-index: 1000;}\n                        .level_content .swiper-button-next-custom.swiper-button-disabled{background-image: url(https://asset.tuwan.com/officialsite/images/level_right_dis.png);opacity:1}\n                        .level_content .swiper-button-prev-custom{width: 16px;height:60px;top: 24%;left:34px;background-size:16px 23px;transform: translateY(-50%);background-image: url(https://asset.tuwan.com/officialsite/images/level_left.png);background-position: center left;cursor: pointer;outline: none;z-index: 1000;}\n                        .level_content .swiper-button-prev-custom.swiper-button-disabled{background-image: url(https://asset.tuwan.com/officialsite/images/level_left_dis.png);opacity:1}\n                        .level_detail_content{width: 800px;height: 358px;background: #FFFFFF;border: 1px solid #D8D8D8;margin:0 auto;margin-top:10px;box-sizing:border-box}\n                        .level_detail_left{width:340px;height:314px;background:url(https://asset.tuwan.com/officialsite/images/level_icon_bg.png)}\n                        .level_detail_left img{max-width:60%;max-height:60%}\n                        .level_line{height: 292px;border-left:1px solid rgba(216, 216, 216, 1);margin:0 25px}\n                        .level_detail_right{width:400px}\n                        .level_power_content{width:400px;height:300px;flex-wrap:wrap;margin-top:20px}\n                        .level_detail_title{color:#333333;font-size:18px;font-weight:bold}\n                        .level_detail_title span,.level_up_desc span{color:#FF6691;font-weight:bold}\n                        .level_detail_item{width:130px;flex-direction: column;font-size:14px;color:rgba(51,51,51,.3);margin-bottom:30px}\n                        .level_power_title.actived{color:#FF6691}\n                        .level_detail_item_img{width:54px;height:54px;margin-bottom:10px}\n                        .level_up_content{width:800px;height:60px;margin:0 auto;font-size:18px;color:#333333}\n                        .level_progress{width:210px;height:8px;border-radius:4px;display:block;margin:0 10px}\n                        progress.level_progress::-webkit-progress-bar {background: #EAEAEA;border-radius:4px}\n                        progress.level_progress::-webkit-progress-value {background:linear-gradient(to right, #FFDBE8 ,#FFB2C9, #FF6691); border-radius: 4px}\n                        .level_up_desc{font-size:12px;color:#999999}\n                        .level_has_arr{color:#999}\n                        .level_up_now{width: 120px;height: 42px;background: #FF6691;border-radius: 6px;color:#fff;line-height:42px;text-align:center;font-size:18px;cursor: pointer;}\n                    </style>")}initLevelModal(){qt.get(`${Pt}/user/userGrade?grade=&platform=0`).then((t=>{const{grade:e,pc_max_money:n}=t.data;this.pc_max_money=n;window.$("body").append('<div class="mask level_modal ygb_f_c">\n                            <div class="level_content">\n                                <div class="level_content_close"></div>\n                                <div class="level_content_title">贵族特权</div>\n                                <div class="level_tab_content swiper-container swiper-no-swiping">\n                                    <div class="swiper-wrapper level_tab_list"></div>\n                                </div>\n                                <div class="swiper-button-next-custom"></div>\n                                <div class="swiper-button-prev-custom"></div>\n                                <div class="level_detail_content ygb_f_c"></div>\n                                <div class="level_up_content ygb_f_sb"></div>\n                            </div>\n                        </div>'),this.renderLevelContent(t.data),this.renderNavContent(t.data),this.navSwiper=new window.Swiper(".level_tab_content",{initialSlide:e-1,slidesPerView:8,navigation:{nextEl:".swiper-button-next-custom",prevEl:".swiper-button-prev-custom"}}),this.initLevelEvent()}))}loadLevelContent(t){qt.get(`${Pt}/user/userGrade?grade=${t||""}&platform=0`).then((t=>{this.renderLevelContent(t.data),this.renderNavContent(t.data),this.navSwiper.update()}))}renderNavContent(t){let e="";const{grade_list:n,grade:i}=t;n.forEach(((t,n)=>{e+=`<div class="swiper-slide level_tab_item ygb_f_c ${n==i-1?"level_tab_current":""}">\n                        <img src="${t.icon}">\n                        <div>${t.title}</div>\n                    </div>`})),window.$(".level_tab_list").html(e)}renderLevelContent(t){const{reward_list:e,icon:n,reward_num:i,title:o,is_up:s,up_need_devote:a,up_need_money:r,next_title:c,up_rate:l,grade_list:d,grade:m}=t;this.up_need_money=r;let h=`<div class="level_detail_left ygb_f_c">\n                        <img src="${n}">\n                    </div>\n                    <div class="level_line"></div>\n                    <div class="level_detail_right">\n                        <div class="level_detail_title">专属特权：<span>${i}</span>/${e.length}</div>\n                        <div class="level_power_content ygb_flex scroll">`;e.forEach((t=>{h+=`<div class="level_detail_item ygb_f_c">\n                        <img class="level_detail_item_img" src="${t.icon}">\n                        <div class="level_power_title ${1==t.is_have?"actived":""}">${t.title}</div>\n                    </div>`})),h+="</div></div>",window.$(".level_detail_content").html(h);let u="";u=1==s?'<div class="level_up_left ygb_f_c">\n                        <div class="level_has_arr">（已达到当前爵位）</div>\n                    </div>':`<div class="level_up_left ygb_f_c">\n                            ${o}\n                            <progress class="level_progress" value="${l}" max="100"></progress>\n                            ${c}\n                            <div class="level_up_desc">（升级还需<span>${a}</span>贡献值）</div>\n                        </div>`,0!==r&&(u+='<div class="level_up_now">立即升级</div>'),window.$(".level_up_content").html(u)}initLevelEvent(){let t=this;window.$(".level_modal").on("click",".level_tab_item",(function(){let e=window.$(this).index();window.$(".level_tab_item").removeClass("level_tab_current"),window.$(this).addClass("level_tab_current"),t.loadLevelContent(e+1)})),window.$(".level_modal").on("click",".level_up_now",(function(){if(t.up_need_money>t.pc_max_money)Vt("大额充值请联系客服");else{const e={typeid:2001,money:t.up_need_money};Hi.payQRCode(e,100*t.up_need_money,(t=>{}))}})),window.$(".level_modal").on("click",".level_content_close",(function(){window.$(".level_modal").hide()}))}}function Bh(){let t=uu.getMusicCarList(),e=window.$(".autoroom-teamlist>.autoroom-team-item"),n={};0!=e.length&&e.map(((t,e)=>{let i=e.dataset;n[i.fid]=i.fid}));let i=window.$(".chat-center-main");t.forEach((t=>{if(!t.vip)if(1==t.state){if(t.total==t.size)return;i.find(".autoroom-team-item[data-fid='"+t.fid+"']").find(".autocarteam-li-top").show()}else{const e=i.find(".autoroom-team-item[data-fid='"+t.fid+"']");e.find(".autocarteam-li-top").show(),e.find(".autocarteam-li-close").show()}})),Object.keys(n).forEach((e=>{if(!t.has(e)){const t=i.find(".autoroom-team-item[data-fid='"+e+"']");t.find(".autocarteam-li-top").show(),t.find(".autocarteam-li-close").show()}}))}function Fh(){const t=uu.getMycarData(),e=uu.getMeid();if(t){const n=t.persons.get(e).position,i=t.fid,o=window.$(".chat_center_match_list[data-fid='"+i+"']");1==n?o.find(".seat-item-empty[data-uid!='0']").find(".seat-close").show():o.find(".seat-item-empty[data-uid='"+e+"']").find(".seat-close").show()}else window.$(".seat-close").hide();uu.isAnchoringUser(e)&&window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show()}function Uh(){Ph&&Ph.setFlag(!0)}function zh(t){Ph||(Ph=om.getIntance()),Ph.delayInterval(100,(()=>{cm.exec().then((()=>{am.setFlag(!1);const e=uu.isKillerBattleRoom()?uu.getRoomInfo().ptype:uu.getRoomInfo().typeid;Yd(uu.getCid(),uu.getMeid(),e,t),uu.isTruthRoom()&&Jd(uu.getCid(),uu.getMeid(),uu.getRoomInfo().typeid)}),(()=>{var t,e,n;Uh(),(uu.isDrawRoom()||uu.isDrawTempRoom())&&Le.getInstance().sendWheatListSocket(),t=uu.getCid(),e=uu.getMeid(),n=1,uu.globalDDSocket.send("setchannel",{cid:t,uid:e,first:n})}))}))}function Oh(t,e,n=0){let i=uu.getSelfInfo();const o=1*window.$("#font-my-diamond").attr("data-value"),s=1*window.$("#font-my-yue").attr("data-value"),a=1*window.$("#font-my-crystal").attr("data-value");let r=a;n&&(r=a-n);let c=o-t,l=s-e;c<=0&&(c=0),l<=0&&(l=0),r<=0&&(r=0),window.$("#font-my-diamond").text(Ct.getFormatMoney(c)).attr("data-value",c),window.$("#font-my-yue").text(Ct.getFormatMoney(l,2)).attr("data-value",l),window.$("#font-my-crystal").text(Ct.getFormatMoney(r)).attr("data-value",r),i.money=l,i.diamond=c,i.number=r,bt.setSelfUser(i)}function Nh(t,e,n){let i=[];uu.isShengyouFreeRoom()?i=["wheatlist","publishList","fleetScoreList"]:uu.isShengyouRoom()||uu.isHuodongRoom()||uu.isJiamianRoom()?i=["wheatlist"]:uu.isSongPkRoom()?i=["wheatlist","queuelist"]:uu.isJingPaiRoom()?i=["wheatlist","orderlist","queuelist"]:uu.isKtvRoom()?i=["wheatlist","orderlist"]:uu.isAutoRoom()?i=["wheatlist","publishList","fleetScoreList"]:uu.isDrawRoom()?Le.getInstance().sendWheatListSocket():uu.isMarryRoom()?(i=["wheatlist"],Ym.getInstance().initMarryStageSocket()):uu.isTruthRoom()?(i=["wheatlist"],Jd(uu.getCid(),uu.getMeid(),uu.getRoomInfo().typeid)):uu.isSongTempRoom()?i=["wheatlist","getSongLrc"]:uu.isSquidGame()||uu.isH5ActiveRoom()||uu.isSpyActiveRoom()?i=["wheatlist"]:uu.isCocosH5Room()?(i=["wheatlist"],_s.getInstance().sendGetSubscribeList()):i=(uu.isGameRace()||uu.isBattleRoom()||uu.isSpecialSongRoom()||uu.isLangrenSmallRoom(),["wheatlist"]),i&&i.length&&(!uu.isShengyouFreeRoomWithPType()&&!uu.isAutoRoomWithPType()||i.includes("publishList")||i.push("publishList"),Yd(t,e,n,i))}function qh(t,e,n=0,i=""){uu.getMeid()>Mt.maxUID?du():uu.isWerewolfTeamRoom()?Jm.joinGame({roomId:t}):Ch(t,e,n,i)}function Gh(t){fm.isHaveShangGift?si.show(".temp-autocar-shang-mask","block"):Bm()}let Vh=null;function Hh(){return Vh||(Vh=new Ih("carauto-create-mask"),Vh.publishGameRoom=Wh),Vh}function Wh(t){Sh.getInstance(Hi,Ch).publishRoom(t)}function Kh(t,e){const n=uu.getMycarData();if(n){const e=n.fid,i=n.persons.get(t).position;if(1==i)Yh();else{tm(i,t,uu.getCid(),e,1)}window.$(".yaoqing-float").css("display","none")}}function Yh(){const t=uu.getMeid(),e=uu.getCid(),n=uu.getMycarFid();n>0&&Mh(e,n,2,t)}function Jh(t){uu.isAnchoringUser(t)?Rd("主持不能创建车队"):Hh().showTeamInfo(1)}function Qh(){1==uu.getAnchorKengUsers().size?Bm(uu.getMeid(),!0):Vt("服务老板后再离开")}function Xh(){if(uu.isLangrenSmallRoom())return;const t=window.$(".game-mask");t.find("iframe").attr("src",""),t.css("display","none"),ou(uu.getCid())}function Zh(){const t=window.$(".meeting-mask");t.find("iframe").attr("src",""),t.css("display","none"),function(){am.setFlag(!1),Ph&&Ph.destroy();fm.isWithoutChange||cm.setFlag(!1);jm()}()}function tu(t){let e=0==t?xt.getInstance().getMainVolume():0,n=0==t?0:xt.getInstance().getMainVolume(),i=Math.abs(e-n)/50,o=setInterval((()=>{0==t&&e>0?e-=i:1==t&&e<n&&(e+=i),(e<=0&&0==t||e>=n&&1==t)&&clearInterval(o),eu(1*e)}),40)}function eu(t){window.SVGA.volume=t/100,uu.globalRtcClient.setAudioVolume(t,pm)}let nu=null;function iu(){uu.getMeid()>Mt.maxUID?du():nu?(nu.loadLevelContent(),window.$(".level_modal").css("display","flex")):nu=Eh.getInstance()}const ou=pt((async function(t,e,n,i){const o=Id.getInstance();uu.globalRtcClient.leave().then((()=>{window.$(".chat-center-gift-content").hide();const n=uu.getMeid();uu.getCid(),ci.hide(),uu.isTempCarteamRoom()||(uu.isTempCarteamRoom()||1!=uu.roomInfo.fleet_type)&&(uu.isKtvRoom()||uu.isAutoRoom())&&(Hd(uu.getMeid(),uu.getCid(),-1),qd("setorder",-1,n)),o.destroy(),Bd(),fm.isWithoutChange=!1,bt.removeVoiceLog(),Zt.getInstance().clearAllPlayer(),Td.drop(),window.$(".autoroom-swiper-container").empty(),i?au(t):su(t),uu.globalDDSocket.leave(),uu.globalDDSocket.close(),he.requestRoomInfo(t),window.$(".chat-center-message").html(""),e&&e()}),(()=>{i?au(t):su(t),he.requestRoomInfo(t)})),t>0&&n&&(i?au(t):su(t),he.requestRoomInfo(t))}),10);function su(t){const e={cid:t};mn.getInstance().onCheck((function(){ou(uu.getCid(),(function(){window.$("#divLogin").show(),window.$("#divNoLogin").hide(),Bn.closeLoginWindow()}))})),window.history.pushState(e,"",ru(t))}function au(t){const e={cid:t};window.history.replaceState(e,"",ru(t))}function ru(t){return window.location.origin+"/"+Mt.urlapi+"/"+t+window.location.search}function cu(t){const e=uu.getCid(),n=uu.roomInfo.pcid;Hd(t,e,-1),ou(n)}function lu(t,e){if(bs.wishListEnterObj=null,$("#wishEnterCtn").empty(),Uh(),"1"==e)if(0==uu.getSelfInfo().teacher){uu.getRoomInfo().cid==t?Rd("老板，请在本厅点单。"):Rd("老板，请到点单厅进行点单。",(function(){ou(22060)}))}else ou(t);else ou(t)}function du(t){Bn.openLoginWindow((function(){ou(uu.getCid(),(function(){window.$("#divLogin").show(),window.$("#divNoLogin").hide(),Bn.closeLoginWindow()}))}))}window.addEventListener("popstate",(function(t){const e=t.state.cid;if(e){const t=window.$(".game-mask");t.find("iframe").attr("src",""),t.css("display","none"),ou(e),window.$(".chat-center-message").html("")}}));class mu{constructor(){this.styleDom=null,this.htmlDom=null,this.lyricsPlayer=null,this.lyricTimestamp=0,this.stageData=null,this.seatData=null}static getInstance(){return this.instance||(this.instance=new mu),this.instance}onReset(){this.stageData=null,this.seatData=null,this.lyricsPlayer=null,this.lyricTimestamp=0,this.styleDom&&this.styleDom.remove(),this.styleDom=null,this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null}initTemplate(t){this.initStyle(),this.initHtml(t),this.initEvents()}setSeatData(t){this.seatData=t}isAnchoringUser(t){if(this.seatData){const e=this.seatData.find((t=>2==t.position));return e&&e.uid==t}return!1}getAnchorKengUser(t){return this.seatData?this.seatData.find((e=>e.uid==t)):null}isInAnchors(t){return this.seatData?this.seatData.find((e=>e.uid==t)):null}getAnchoringUser(){return this.getAnchoringUserFromPosition(2)}getAnchoringUserId(){const t=this.getAnchoringUserFromPosition(2);return t?t.uid:0}getAnchoringUserFromPosition(t){let e=null;return this.seatData&&(e=this.seatData.find((e=>e.position==t))),e}mineInJudgeSeat(t){for(var e=5;e<=7;e++){const n=this.getAnchoringUserFromPosition(e);if(n&&n.uid==t)return n}return null}updateData(t){const e=(this.stageData||{}).voted_uid_list,n=(this.stageData||{}).voted_list;this.stageData=t,void 0===t.voted_uid_list&&(t.voted_uid_list=e),void 0===t.voted_list&&(t.voted_list=n),this.commonUpdate(),1==this.stageData.popup_rank&&this.showResultModal(),window.$(".songpk-room-content .songpk-stage-desc").text(t.desc);const i=this.stageData.rank_list||[];for(var o=0;o<3;o++){const t=i[o];this.disposeRankItemWidthNumber(o,t)}const s=i.find((t=>t.user_info.uid==uu.getMeid()));this.disposeRankItemWidthNumber(-1,s)}seatsUpdate(){this.isAnchoringUser(uu.getMeid())?ci.show(1,ci.type.queueListManager):ci.hide(1,ci.type.queueListManager),this.checkMineInSeatPosition(3)||this.checkMineInSeatPosition(4)?(window.$(".songpk-but-quku").removeClass("hide"),window.$(".song-play-wrapper").removeClass("hide"),window.$(".song-order-resource-list").css("height","390px")):(window.$(".songpk-but-quku").addClass("hide"),window.$(".song-play-wrapper").addClass("hide"),window.$(".song-order-resource-list").css("height","440px"),Cd.getInstance().onStopLocalAudioMixin(),window.$(".song-queuelist").hide()),this.commonUpdate()}checkMineInSeatPosition(t){const e=this.getAnchoringUserFromPosition(t);return e&&e.uid==uu.getMeid()}commonUpdate(){const t=this.stageData;if(!t)return null;window.$(".songpk-room-content .songpk-singer-count").text(t.waiting_desc||"");const e=window.$(".songpk-room-content .songpk-room-anchor-container"),n=e.find(".songpk-anchor-btn"),i=e.find(".songpk-audience-desc"),o=t.next_group_list;if(this.isAnchoringUser(uu.getMeid())?(i.addClass("hide"),t.button_title&&t.button_title.length?(n.removeClass("hide"),n.text(t.button_title)):n.addClass("hide")):(o&&o.length?i.removeClass("hide"):i.addClass("hide"),n.addClass("hide")),o&&o.length){e.find(".songpk-next-group").removeClass("hide");try{e.find(".songpk-next-group_item_0").text(o[0].user_info.nickname),o.length>1?e.find(".songpk-next-group_item_1").text(o[1].user_info.nickname):e.find(".songpk-next-group_item_1").text("")}catch(s){}}else e.find(".songpk-next-group").addClass("hide");this.disposeSeatPosition(3),this.disposeSeatPosition(4),uu.isSongPkKingRoom()&&(window.$(".songpk-room-content .songpk-judge-des").text(t.judges_desc||""),this.disposeJudgeSeatPosition(5),this.disposeJudgeSeatPosition(6),this.disposeJudgeSeatPosition(7))}disposeSeatPosition(t){const e=this.getAnchoringUserFromPosition(t),n=window.$(`.songpk-room-content .songpk-player-item[data-seat="${t}"]`),i=n.find(".rank-label"),o=n.find(".songpk-player-vote"),s=n.find(".songpk-player-consume"),a=n.find(".flower-num");if(e){if(o.removeClass("songpk-disabled"),uu.isSongPkKingRoom()){const t=this.mineInJudgeSeat(uu.getMeid());if(t){const e=this.stageData.judges_ticket.find((e=>e.position==t.position));e&&e.remain_ticket>0?o.removeClass("songpk-disabled"):o.addClass("songpk-disabled")}else{(this.stageData&&this.stageData.voted_uid_list?this.stageData.voted_uid_list:[]).find((t=>t==e.uid))?o.addClass("songpk-disabled"):o.removeClass("songpk-disabled")}}if(this.stageData){const t=this.stageData.rank_list.find((t=>t.user_info.uid==e.uid));if(t)if(i.removeClass("hide").text(`第${t.order}名`),a.text(t.score),uu.isSongPkKingRoom()){if(this.mineInJudgeSeat(uu.getMeid()))s.text("");else{let t=this.stageData.default_gift_desc||"";if(this.stageData.voted_list){const n=this.stageData.voted_list.find((t=>t.uid==e.uid));n&&(t=n.gift_desc||"")}s.text(t)}}else s.text("消耗10钻")}else i.addClass("hide"),a.text(0),s.text("")}else o.addClass("songpk-disabled"),i.addClass("hide"),s.text(""),a.text(0)}disposeJudgeSeatPosition(t){const e=window.$(`.songpk-room-content .songpk-room-judge[data-seat="${t}"]`).find(".songpk-room-judge_ticket"),n=this.stageData.judges_ticket.find((e=>e.position==t));n?e.text(n.remain_ticket_desc||""):e.text("")}disposeRankItemWidthNumber(t,e){const n=window.$(`.songpk-room-content .rank-container .rank-row-${t+1}`),i=n.find(".number-label"),o=n.find(".name-label"),s=n.find(".count-label");o.text(e?e.user_info.nickname:"  --"),s.text(e?e.score:"--");let a=e?e.order:t+1;const r=this.stageData.rank_list||[];2===r.length&&2==t&&1==r[1].order&&(a=2),i.text(a),i.css("color",this.getNumberColor(a)),-1===t&&(e?n.removeClass("hide"):n.addClass("hide"))}getNumberColor(t){return 1==t?"#FFDB00":2==t?"#C1CBDD":3==t?"#CB7990":"#FFE6E6"}setLyrics(t){const e=this,{song_code:n,url:i,singer_uid:o,play:s}=t;this.destoryLyricsPlayer(),1==s?Promise.all([qt.getBinary(i),Ct.loadScript("https://asset2.tuwan.com/script/moment.min.js"),Ct.loadScript("https://asset2.tuwan.com/script/fxparser.js")]).then((([t])=>{null!=t&&(this.lyricsPlayer=new fl("#songpk-lyric"),this.lyricsPlayer.setInitData(Ct.byteToString(t),i.indexOf(".xml")>=0?"xml":"lrc"),this.lyricsPlayer.renderWord(),this.lyricsPlayer.setIsPause(!0))})).catch((t=>{Vt("网络错误,请稍后再试..")})):e.onSongFinishHandle()}destoryLyricsPlayer(){null!=this.lyricsPlayer&&(this.lyricsPlayer.destroy(),this.lyricsPlayer=null)}onSongFinishHandle(){window.$(".songpk-lyric-empty").removeClass("hide"),window.$(".songpk-lyric-wrapper").addClass("hide"),this.destoryLyricsPlayer()}_onStopLocalAudioMixin(){this.onSongFinishHandle()}onInterruptSinging(){Cd.getInstance().onStopLocalAudioMixin()}onListenerLyricsOffSets(t){this.lyricTimestamp=Date.parse(new Date)/1e3;let e=!1;null!=this.lyricsPlayer&&(this.lyricsPlayer.isPause&&(this.lyricsPlayer.setIsPause(!1),e=!0),this.lyricsPlayer.setOffSets(parseInt(t.time),e),window.$(".songpk-lyric-empty").addClass("hide"),window.$(".songpk-lyric-wrapper").removeClass("hide"))}setLyricsOffSets(t){let e=!1;null!=this.lyricsPlayer&&(this.lyricsPlayer.isPause&&(this.lyricsPlayer.setIsPause(!1),e=!0),this.lyricsPlayer.setOffSets(1e3*t,e),window.$(".songpk-lyric-empty").addClass("hide"),window.$(".songpk-lyric-wrapper").removeClass("hide"))}showResultModal(){if(window.$(".songpk-result-modal").length>0)return;const t=`\n            <div class="songpk-result-modal flex flex-jc flex-ac">\n                <div class="songpk-result-modal_body scroll scrollbar-transparent" style="padding-bottom: 15px;  background-image: url(https://asset.tuwan.com/chatroom/images/icon_songpk_rank_bg.png); background-size: 100%;">\n                    <p style="line-height: 70px; font-size: 22px; font-weight: 600; color: #FFFFFF; text-align: center;">排行榜</p>\n                    ${(this.stageData.rank_list||[]).map((t=>function(t){const e=t.order;return`\n                <div class="flex flex-ac" style="height: 70px; padding-right: 20px;">\n                    <div class="flex flex-jc" style="width: 50px;">\n                        ${e>3?`<p style="width: 20px; line-height: 20px; border-radius: 100%; background-color: #F6F6F6; color: #999999; font-size: 14px; font-weight: 600; text-align: center;">${e}</p>`:`<img style="width: 25px; height: 25px;" src="https://asset.tuwan.com/chatroom/images/icon_songpk_tag_${e}.png">`}\n                    </div>\n                    <img style="width: 46px; height: 46px; border-radius: 100%;" src="${t.user_info.avatar}"/>\n                    <p class="flex-1" style="margin-left: 15px; font-size: 14px; color: rgba(255, 255, 255, 0.9);">${t.user_info.nickname}</p>\n                    <p style="width: 60px; font-size: 14px; color: rgba(255, 255, 255, 0.9); text-align: right;">${t.score} 票</p>\n                </div>\n            `}(t))).join("")}\n                </div>\n            </div>\n        `;window.$("body").append(t)}initHtml(t){if(this.htmlDom)return;function e(t){return`<p class="songpk-next-group_item_${t}" style="font-weight: 500; font-size: 14px; color: white; line-height: 20px; width: 100px; height: 20px; text-align: center; overflow: hidden;"></p>`}const n=`\n            <div class="songpk-room-anchor-container">\n                ${Fi._initSeatData(2,158,135,80,80,"主持",!1,!1,"add")}\n                <div style="margin-top: 10px; height: 30px;">\n                    <p class="songpk-anchor-btn common-btn hide" style="width: 100px; line-height: 30px; border-radius: 30px;"></p>\n                    <p class="songpk-audience-desc hide" style="margin: auto; width: 100px; line-height: 30px; color: rgba(255, 255, 255, 0.8); font-size: 15px; text-align: center;">下一组</p>\n                </div>\n                <div class="songpk-next-group flex flex-dir-col flex-ac flex-jc hide" style="margin: auto; margin-top: 10px; width: 110px; height: 73px; background-color: rgba(255, 255, 255, 0.2); border-radius: 10px;">\n                    ${e(0)}\n                    <img style="width: 22px; height: 13px; margin: 3px 0;" src="https://res.tuwan.com/chatroom/images/icon_songpk_pk.png"/>\n                    ${e(1)}\n                </div>\n                <p class="songpk-singer-count" style="text-align: center; font-size: 14px; color: rgba(255, 255, 255, 0.8); margin-top: 14px;"></p>\n            </div>\n        `,i=new Array(2).fill(0).map(((t,e)=>Fi._getOtherAnchorSeatHtml({position:3+e,shouhutype:1,index:0,pwidth:100,pheight:120,defaultbg:"add",width:90,height:90,isshowmeili:!1,closeHide:!0}))).map(((t,e)=>`\n            <div class="songpk-player-item" data-seat="${e+3}">\n                ${t}\n                <div class="flex flex-ac flex-jc" style="position: absolute; left: 50%; top: 80px; height: 15.5px; border-radius: 15.5px; z-index: 10; transform: translateX(-50%); padding: 0 5px; background-color: #6A00ED;">\n                    <img src="https://asset.tuwan.com/chatroom/images/icon_truth_meigui.png" style="width: 10px; height: 9.5px;"/>\n                    <p class="flower-num" style="font-size: 10px; color: white;">0</p>\n                </div>\n                <p class="songpk-player-vote common-btn ${1===e?"blue":""}" data-seat="${e+3}">投票</p>\n                <p class="songpk-player-consume" style="font-size: 12px; color: rgba(255, 255, 255, 0.6); line-height: 20px; text-align: center;"></p>\n                <p class="rank-label hide">第1名</p>\n            </div>\n        `)),o=`\n            <div class="songpk-room-jiabin">\n                ${Fi._getOtherAnchorSeatHtml({position:1,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:158,pheight:135,width:80,height:80,isshowmeili:!1})}\n            </div>\n        `;const s=this;function a(t){return`\n                <div class="rank-row rank-row-${t+1} flex ${-1===t?"hide":""}">\n                    <p class="number-label" style="width: 60px; text-align: center; font-size: 16px; color: ${s.getNumberColor(t+1)};">${t+1}</p>\n                    <p class="name-label flex-1">  --</p>\n                    <p class="count-label" style="width: 68px; text-align: center;">--</p>\n                </div>\n            `}const r=`\n            <div class="rank-container">\n                \n                <div class="rank-section flex">\n                    <p style="width: 60px; text-align: center;">排名</p>\n                    <p class="flex-1">昵称</p>\n                    <p style="width: 68px; text-align: center;">票数</p>\n                </div>\n            \n                ${new Array(3).fill(0).map(((t,e)=>a(e))).join("")}\n                ${a(-1)}\n            </div>\n        `;let c="";if(uu.isSongPkKingRoom()){c=`\n                <div style="margin-top: 10px; width: 260px; height: 130px; padding-top: 5px; background-color: #AD6BFF; border-radius: 10px;">\n                    <p class="songpk-judge-des" style="font-size: 12px; color: #FFFFFF; margin-left: 10px; color: rgba(255, 255, 255, 0.6); height: 17px;"></p>\n                    <div class="songpk-room-judges flex" style="margin-top: 5px; justify-content: space-around;">\n                        ${new Array(3).fill(0).map(((t,e)=>`\n                <div class="songpk-room-judge" data-seat="${5+e}">\n                    ${Fi._getOtherAnchorSeatHtml({position:5+e,shouhutype:1,index:0,pwidth:70,pheight:90,width:60,height:60,role:"评委",defaultbg:"add",isshowmeili:!1})}\n                    <p class="songpk-room-judge_ticket" style="margin-top: -10px; font-size: 12px; color: #FFFFFF; line-height: 22px; text-align: center;"></p>\n                </div>\n            `)).join("")}\n                    </div>\n                </div>\n            `}this.htmlDom=window.$(`\n            <div class="songpk-room-content flex" style="height: ${uu.isSongPkKingRoom()?"500px":"400px"};">\n                <div id="songpk-room-svgaBg" style="position: absolute; width: 100%; height: 100%; top:0;z-index: -1"></div>\n                <div class="songpk-room__wrapper flex flex-jc" style="align-items: start; margin-left: ${uu.isSongPkKingRoom()?"125px":"116px"};">\n                    ${n}\n                    <div class="flex flex-dir-col flex-ac" style="width: 300px;">\n                        <div style="height: 120px; position: relative;">\n                            <div class="songpk-lyric-empty flex flex-ac flex-dir-col">\n                                 <div>欢迎来唱歌</div>\n                                 <div class="flex flex-jc ">\n                                    <i class="songpk-note songpk-note-left"></i>\n                                        唱歌请带耳机避免回音\n                                    <i class="songpk-note songpk-note-right"></i>\n                                </div>\n                            </div>\n                            <div class="songpk-lyric-wrapper hide">\n                                <canvas id="songpk-lyric" width="400px" height="84px"></canvas>\n                            </div>\n                            <p class="songpk-stage-desc" style="position: absolute; left: 0; bottom: 0; width: 100%; text-align: center; color: rgba(255, 255, 255, 0.6); font-size: 16px; font-weight: 600;"></p>\n                        </div>\n                        <div class="songpk-room-players flex flex-jb" style="width: 220px; padding-top: 20px;">\n                            ${i}\n                        </div>\n                        ${c}\n                    </div>\n                    ${o}\n                    ${r}\n                    <div class="songpk-menus" style="position: absolute; left: 30px; top: 35px;">\n                        <div class="song-but songpk-but-rule flex flex-jc flex-ac">玩法</div>\n                        <div class="song-but songpk-but-quku flex flex-jc flex-ac hide">曲库</div>\n                    </div>\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom);let l=""!=t.skin?t.skin:""!=t.skin_active?t.skin_active:"";if(""!=l)if(-1!=l.indexOf(".svga")){const t=Zt.getInstance();t.loadParser("#songpk-room-svgaBg",l,0,!1).then((e=>{const{videoItem:n,player:i}=e;i.setVideoItem(n),i.startAnimation(),i.setContentMode("AspectFill"),t.playersMap.set("songpk-room-svgaBg",i)}),(t=>{}))}else window.$(".songpk-room-content").css("background",'rgba(0, 0, 0, 0) url("'+l+'") repeat')}initEvents(){const t=this;window.$(".songpk-room-content").on("click",".songpk-but-rule",(function(t){t.stopPropagation(),ze.show({desc:uu.roomInfo.rule_desc.replace(/\/r\/n/g,"<br />").replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")})})),window.$(".songpk-room-content").on("click",".songpk-player-vote",(function(e){if(e.stopPropagation(),uu.getMeid()>Mt.maxUID)return void du();if(window.$(this).hasClass("songpk-disabled"))return;const n=t.getAnchoringUserFromPosition(this.dataset.seat);if(n){let t="";if(uu.isSongPkKingRoom())t=Ot.songVote(uu.getCid(),n.uid);else{const e="id=34&uids="+n.uid+"&cid="+uu.getCid();t=Ot.payDiamond(e)}qt.get(t).then((t=>{0==t.error||Ct.Alert(t.error_msg)}))}}));const e=Ct.preventQuickClick(500);window.$(".songpk-room-content").on("click",".songpk-room-anchor-container .songpk-anchor-btn",(function(t){t.stopPropagation(),e((()=>{var t;(t=qt.get(uu.isSongPkKingRoom()?Ot.getSongPkKingButton(uu.getCid()):Ot.getSongPkButton(uu.getCid())),t.then((t=>(0!=t.error&&t.error_msg&&Vt(t.error_msg),t)))).then((t=>{}))}))})),window.$(document).on("click",".songpk-result-modal",(function(t){t.stopPropagation(),window.$(".songpk-result-modal").remove()})),window.$(".songpk-room-content").on("click",".songpk-but-quku",(function(t){t.stopPropagation(),Cd.getInstance().showQukuModal()}))}initStyle(){if(this.styleDom)return;this.styleDom=window.$('\n            <style>\n                .songpk-room-content {\n                    position: relative;\n                }\n                .songpk-room__wrapper {\n                    padding-top: 30px;\n                }\n\n                .songpk-room-content .common-btn {\n                    margin: auto;\n                    color: rgba(255, 255, 255, 1);\n                    font-size: 16px;\n                    text-align: center;\n                    font-weight: bold;\n                    border: 1px solid #F3A4C0;\n                    cursor: pointer;\n                    background: linear-gradient(to bottom,#FB789D, #E85B83);\n                    cursor: pointer;\n                    user-select: none;\n                }\n\n\n                .songpk-room-jiabin .seat-role-tag {\n                    background: #963FFF !important;\n                }\n\n                .songpk-player-vote {\n                    width: 70px;\n                    line-height: 30px;\n                    border-radius: 50px;\n                    color: rgba(255, 255, 255, 1);\n                    font-size: 16px;\n                }\n\n                .songpk-player-vote.blue {\n                    background: linear-gradient(to bottom,#6572fd, #4c35e0);\n                    border: 1px solid #b0b7ff;\n                }\n\n                .songpk-player-vote.songpk-disabled {\n                    opacity: 0.6;\n                }\n\n                .songpk-player-item {\n                    position: relative;\n                    height: 175px;\n                }\n\n                .songpk-player-item .rank-label {\n                    position: absolute;\n                    z-index: 4;\n                    top: 4px;\n                    line-height: 16px;\n                    border-radius: 16px;\n                    padding: 0 5px;\n                    font-size: 12px;\n                    font-weight: 500;\n                    color: #FFFFFF;\n                    background-color: #FF6691;\n                }\n\n                .songpk-player-item[data-seat="3"] .rank-label {\n                    left: 0;\n                }\n\n                .songpk-player-item[data-seat="4"] .rank-label {\n                    right: 0;\n                }\n\n                .songpk-room-content .rank-container {\n                    margin-top: 50px;\n                    width: 250px;\n                    height: auto;\n                    background-color: #7F41BD;\n                    border-radius: 10px;\n                    overflow: hidden;\n                }\n\n                .songpk-room-content .rank-container p {\n                    color: white;\n                }\n                .songpk-room-content .rank-section p {\n                    line-height: 40px;\n                    font-size: 14px;\n                }\n                .songpk-room-content .rank-row p {\n                    line-height: 40px;\n                    font-size: 12px;\n                }\n                .songpk-room-content .rank-row.rank-row-0 {\n                    background-color: #8d49df;\n                }\n\n                .songpk-result-modal {\n                    position: fixed;\n                    left: 0;\n                    top: 0;\n                    right: 0;\n                    bottom: 0;\n                    background-color: rgba(0, 0, 0, 0.6);\n                    z-index: 999;\n                }\n                .songpk-result-modal_body {\n                    width: 350px;\n                    min-height: 300px;\n                    max-height: 400px;\n                    overflow-y: auto;\n                    background-color: white;\n                }\n\n                /* 歌词部分 */\n                .songpk-lyric-empty {\n                    font-size: 18px;\n                    line-height: 28px;\n                    color: #FFFFFF;\n                    height: 60px;\n                    margin-top: 10px;\n                }\n                .songpk-note-left {\n                    background: url(https://res.tuwan.com/chatroom/images/icon_song_note.png);\n                    background-size: 100% 100%;\n                }\n                .songpk-note {\n                    display: block;\n                    content: " ";\n                    width: 20px;\n                    height: 20px;\n                    margin: 2px 10px;\n                }\n                .songpk-note-right {\n                    background: url(https://res.tuwan.com/chatroom/images/icon_song_note_right.png);\n                    background-size: 100% 100%;\n                }\n                .songpk-lyric-wrapper {\n                    height: 60px;\n                }\n\n                /*歌王争霸赛*/\n                .songpk-room-judges .seat-item p.seat-user-name {\n                    font-size: 12px;\n                }\n    \t\t</style>\n        '),window.$("head").append(this.styleDom)}}class hu{constructor(t){this.instance=null,this.sessionStore=t,this.nowAnchors=[],this.nowWaiters=[],this.managers=[],this.roomInfo=null,this.myCarInfo=null,this.inCarAllUsers=new Map,this.inAllCar=[],this.queueList=new Map,this.orderList=new Map,this.musicCarList=new Map,this.anchorUsers=new Map,this._ddwebsocket=null,this._rtcclient=null}static getInstance(t){return this.instance||(this.instance=new hu(t)),this.instance}get globalRtcClient(){if(!this._rtcclient)throw Error("请先确保调用common.setCommonRtc");return this._rtcclient}get globalDDSocket(){if(!this._ddwebsocket)throw Error("请先确保调用common.setGlobalDdSocket");return this._ddwebsocket}isTempCarteamRoom(t){return t||(t=this.roomInfo.typeid),5==t&&18!=this.roomInfo.live}isKtvRoom(t){return t||(t=this.roomInfo.typeid),7==t}isShengyouRoom(t){return t||(t=this.roomInfo.typeid),18==t||30==t||31==t||32==t||36==t||39==t||44==t}isLive16AndStageNot1(){let t=this.roomInfo.live,e=this.roomInfo.team_stage;return 16==t&&1!=e}isPartyGame(){let t=!1,e=this.roomInfo.game_info.gameid,n=this.roomInfo.live;return t=8==e||9==e||17==n||18==n,t}isLive17And18(){let t=this.roomInfo.live;return 17==t||18==t}isShengyouFreeRoom(t){return t||(t=this.roomInfo.typeid),30==t||31==t||32==t||36==t||39==t||44==t}isDefaultColorRooms(t){return t||(t=this.roomInfo.typeid),30==t||32==t||39==t||44==t}isShengyouFreeRoomWithPType(){return 5!=this.roomInfo.typeid&&this.roomInfo.typeid!=this.roomInfo.ptype&&this.isShengyouFreeRoom(this.roomInfo.ptype)}isSongRoom(t){return t||(t=this.roomInfo.typeid),39==t}isSongPkRoom(t){return t||(t=this.roomInfo.typeid),41==t||42==t}isSongPkKingRoom(t){return t||(t=this.roomInfo.typeid),42==t}isSquidGame(t){return t||(t=this.roomInfo.typeid),43==t}isPtype5(){return 5==this.roomInfo.ptype}isSpyRoom(t){return t||(t=this.roomInfo.typeid),44==t}isSpyActiveRoom(t){return t||(t=this.roomInfo.typeid),46==t}isSubRoomGameType(){let t=this.roomInfo.typeid,e=this.roomInfo.live;return 5==t&&(17==e||18==e)}isLive18(){let t=this.roomInfo.typeid,e=this.roomInfo.live;return 5==t&&18==e}isSongTempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&6==this.roomInfo.live}isLOLMatchRoom(t){return t||(t=this.roomInfo.typeid),20==t}isHuodongRoom(t){return t||(t=this.roomInfo.typeid),21==t}isJiamianRoom(t){return t||(t=this.roomInfo.typeid),23==t}is1v7TempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&(8==this.roomInfo.seats||9==this.roomInfo.seats)&&6!=this.roomInfo.live&&5!=this.roomInfo.live&&0==this.roomInfo.live}isKingTeamRoom(t){return t||(t=this.roomInfo.typeid),5==t&&15==this.roomInfo.live}isPeaceTeamRoom(t){return t||(t=this.roomInfo.typeid),5==t&&16==this.roomInfo.live}isJinChanchanRoom(){return 5==this.roomInfo.typeid&&(21==this.roomInfo.live||22==this.roomInfo.live)}isAutoRoom(t){return t||(t=this.roomInfo.typeid),11==t||16==t||17==t||22==t||24==t||27==t}isAutoRoomWithPType(){return 5!=this.roomInfo.typeid&&this.isAutoRoom(this.roomInfo.ptype)}isMusicTempRoom(t){return this.isTempCarteamRoom(t)&&(24==this.roomInfo.ptype||27==this.roomInfo.ptype||30==this.roomInfo.ptype||31==this.roomInfo.ptype||39==this.roomInfo.ptype)&&8!=this.roomInfo.live&&13!=this.roomInfo.live&&17!=this.roomInfo.live&&18!=this.roomInfo.live&&19!=this.roomInfo.live&&20!=this.roomInfo.live}isLiveTempRoom(t){return this.isTempCarteamRoom(t)&&(24==this.roomInfo.ptype||27==this.roomInfo.ptype||31==this.roomInfo.ptype||30==this.roomInfo.ptype||39==this.roomInfo.ptype)&&1==this.roomInfo.live}isLoveTempRoom(t){return this.isTempCarteamRoom(t)&&3==this.roomInfo.live}isWerewolfTeamRoom(t){return this.isTempCarteamRoom(t)&&10==this.roomInfo.live}isGameRoom(t){return t||(t=this.roomInfo.typeid),25==t}isHunLiRoom(t){return t||(t=this.roomInfo.typeid),26==t}isCanCreateTeam(t){return t||(t=this.roomInfo.typeid),24==t||27==t}isJingPaiRoom(t){return t||(t=this.roomInfo.typeid),28==t}isBattleRoom(t){return t||(t=this.roomInfo.typeid),29==t||45==t}isKillerBattleRoom(t){return t||(t=this.roomInfo.typeid),(29==t||45==t)&&32==this.roomInfo.ptype}isBattleMainSeatNotPromise(t){return t||(t=this.roomInfo.typeid),45==t}isH5ActiveRoom(t){return t||(t=this.roomInfo.typeid),47==t}isQueQiaoRoom(){return this.isH5ActiveRoom()&&-1!==this.roomInfo.game_custom.h5_url.indexOf("qixi2023m")}isGameRace(t){return t||(t=this.roomInfo.typeid),48==t}isSpecialSongRoom(t){return this.isChorusRoom(t)||this.isKtvSmallRoom(t)}isChorusRoom(t){t||(t=this.roomInfo.typeid);let e=this.roomInfo.live;return 49==t||50==t||52==t||53==t||55==t||20==e}isBallCollisionChorusRoom(){return 55==this.roomInfo.typeid}isNewChorusRoom(t){t||(t=this.roomInfo.typeid);let e=this.roomInfo.live;return 52==t||53==t||20==e||55==t}isChorusMoreRoom(t){return this.isChorusRoom(t)&&2==this.roomInfo.is_single_chorus}isYinSuDa(){return 3==this.roomInfo.yjx_song_switch}isCocosH5Room(t){return t||(t=this.roomInfo.typeid),51==t}isSameMusicRoom(t){return t||(t=this.roomInfo.typeid),24==t&&this.roomInfo.vip_pack}isLiveRoom(t){return t||(t=this.roomInfo.typeid),31==t}isKillerFreeRoom(t){return t||(t=this.roomInfo.typeid),32==t}isLeyuanshaRoom(t){return this.isKillerFreeRoom(t)&&21==this.roomInfo.gameid}isMarryRoom(t){return t||(t=this.roomInfo.typeid),38==t}isVideoTempRoom(t){return 2==this.roomInfo.live}isTakeMeRoom(t){return t||(t=this.roomInfo.typeid),33==t||37==t}isSpecialTakeMeRoom(t){return t||(t=this.roomInfo.typeid),37==t}isPListType2(t){return t||(t=this.roomInfo.pListType),(2!=t||![12517,23236,21908,11399].find((t=>t==this.roomInfo.cid)))&&2==t}isCanWhiteFont(){return this.isHunLiRoom()||this.isJiamianRoom()||this.isMarryRoom()}isSameMusicTempRoom(t){return this.isTempCarteamRoom(t)&&24==this.roomInfo.ptype&&this.roomInfo.vip_pack}isCanChoiceCreateCar(t){return t||(t=this.roomInfo.typeid),30==t}isCanChoiceCreateCarTempRoom(t){return t||(t=this.roomInfo.ptype),30==t}isDrawRoom(t){return t||(t=this.roomInfo.typeid),35==t}isDrawTempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&(4==this.roomInfo.live||this.isNewDrawTempRoom())}isNewDrawTempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&5==this.roomInfo.live}isSoloTempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&9==this.roomInfo.live}isGameTempRoom(t){return t||(t=this.roomInfo.typeid),5==t&&0==this.roomInfo.game_type&&1==this.roomInfo.new_chat_mode&&3!=this.roomInfo.live&&10!=this.roomInfo.live}isTruthRoom(t){return t||(t=this.roomInfo.typeid),40==t||5===t&&8==this.roomInfo.live}isYearCelebration(t){return t||(t=this.roomInfo.typeid),54==t}isSeventhMonth(){return 44===this.roomInfo.tpl_id}isTruthSmallRoom(){return 5==this.roomInfo.typeid&&8==this.roomInfo.live}isLangrenSmallRoom(t,e){return t||(t=this.roomInfo.typeid),e||(e=this.roomInfo.live),5==t&&11==e}isKtvSmallRoom(t,e){return t||(t=this.roomInfo.typeid),e||(e=this.roomInfo.live),5==t&&13==e}isManagers(t){return uu.getRoomInfo().manage_uid.split(",").map((t=>1*t)).includes(t)}isAdminUids(t){return(this.roomInfo.admin_user||[]).map((t=>1*t)).includes(1*t)}isAdmin_spe_user(t){return(this.roomInfo.admin_spe_user||[]).map((t=>1*t)).includes(1*t)}isInAnchors(t){return this.isSongPkRoom()?mu.getInstance().isInAnchors(t):this.anchorUsers.has(1*t)}inInNotStartedCar(t){let e=!1,n=$("#free-team-container .seat-item-empty")||[];if(n.length)for(let i=0;i<n.length;i++)if(n[i].getAttribute("data-uid")==t){e=!0;break}return e}isAnchoringUser(t){if(this.isSongPkRoom())return mu.getInstance().isAnchoringUser(t);const e=this.anchorUsers.get(1*t);return 5!=this.roomInfo.typeid||39!=this.roomInfo.ptype||5!=this.roomInfo.live&&6!=this.roomInfo.live?e&&2==e.position:null!=e&&1==e.owner}isOwnerUser(t){const e=this.anchorUsers.get(1*t);return e&&1==e.owner}isVeRtc(){return 1==this.roomInfo.voice_type}isTRTC(){return 3==this.roomInfo.voice_type}isRoomManage(t){return this.roomInfo.room_manage==t}currentRtcType(){return this.roomInfo?this.roomInfo.voice_type:0}isZegoRTC(){return 2==this.currentRtcType()}isAgoraRTC(){return 0==this.currentRtcType()}getAnchoringUserFromPosition(t){if(this.isSongPkRoom())return mu.getInstance().getAnchoringUserFromPosition(t);for(let e of this.anchorUsers.values())if(e.position==t)return e;return null}getAnchoringUser(){if(this.isSongPkRoom())return mu.getInstance().getAnchoringUser();let t=null;for(let e of this.anchorUsers.values())if(2==e.position){t=e;break}return t}getAnchoringUserId(){if(this.isSongPkRoom())return mu.getInstance().getAnchoringUserId();let t=null;for(let e of this.anchorUsers.values())if(2==e.position){t=e;break}return t?t.uid:0}getBossUid(){let t=null;for(let e of this.anchorUsers.values())if(1==e.position){t=e;break}return t?t.uid:0}getBossInfo(){let t=null;for(let e of this.anchorUsers.values())if(1==e.position){t=e;break}return t}getAnchorKengUser(t){if(this.isSongPkRoom())return mu.getInstance().getAnchorKengUser(t);return this.anchorUsers.get(1*t)}getAnchorKengUsers(){return this.anchorUsers}getSelfInfo(){return bt.getSelfUser()}setGlobalDdSocket(t){this._ddwebsocket=t}setCommonRtc(t){this._rtcclient=t}setAnchors(t){this.nowAnchors=t.map((t=>1*t))}setWaiters(t){this.nowWaiters=t.map((t=>1*t))}setManagers(t){this.managers=t.map((t=>1*t))}setRoomInfo(t){this.roomInfo=t}getRoomInfo(){return this.roomInfo}getMeid(){return this.roomInfo.uid}getCid(){return this.roomInfo.cid}getRoomId(){return this.roomInfo.roomid}getBossUids(){return this.roomInfo.boss_ids.map((t=>1*t))}getJiamianRoomBossUids(){return this.roomInfo.boss_ids.map((t=>1*t))}getChannel(){return this.roomInfo.channel}setAnchorsMap(t){t.forEach((t=>{const e=t.uid;this.anchorUsers.set(e,t)}))}async setInCarTeamUsers(t){this.inCarAllUsers.clear();let e=new Map;for(let n=0;n<t.length;n++){const i=t[n],o=1*i.fid,s=i.data;s.live=i.live,e.set(o,s)}this.inCarAllUsers=e}async updateInAllCar(t){this.inAllCar=[];let e=[];[...t].forEach((t=>{e.push({uid:t.uid,name:t.nickname,avatar:t.avatar})})),this.inAllCar=e}async setInAllCar(t){this.inAllCar=t}inInAllCar(t){return!!this.inAllCar.find((e=>t==e.uid))}getInAllCar(){return this.inAllCar}async updateInCarTeamUser(t,e){t<=0||(e.length>0?this.inCarAllUsers.set(1*t,e):this.inCarAllUsers.delete(1*t))}getInCarTeamUsers(){return this.inCarAllUsers}getInCarTeamUser(t){return this.inCarAllUsers.size>0?this.inCarAllUsers.find(((e,n)=>n==t)):null}clearIncarTeamUsers(){this.inCarAllUsers.clear()}clearMycarTeam(){this.myCarInfo=null}setMycarData(t,e){this.clearMycarTeam();const n=new Map;for(let i=0;i<e.length;i++){let o=e[i],s=1*o.uid;o.fid=t,n.set(s,o)}this.myCarInfo={fid:t,persons:n}}getMycarFid(){const t=this.getMycarData();return t?t.fid:0}setInAutocarTeamUsers(t){}setAutoroomTuijianMyTeamData(t,e,n){this.myCarInfo=null;0!=e.filter((t=>t.uid==n)).length&&this.setMycarData(t,e)}isMyCarDuiZhang(t){let e=!1;const n=this.getMycarData();if(n){const i=n.persons;for(let[n,o]of i)n==t&&1==o.position&&(e=!0)}return e}isNormalRoom(){return this.roomInfo.typeid==this.roomInfo.ptype}getMycarInfoForUid(t){let e=null;const n=this.getMycarData();if(n){e=n.persons.get(t)}return e}getMycarDuizhangUid(){let t=0;const e=this.getMycarData();if(e){const n=e.persons;for(let[e,i]of n)1==i.position&&(t=e)}return t}getMycarData(){return this.myCarInfo}setQueueList(t){this.queueList.clear();const e=new Map;for(let n=0;n<t.length;n++){const i=t[n],o=1*i.uid;e.set(o,i)}this.queueList=e}setMusicCarList(t){this.musicCarList.clear();const e=new Map;for(let n=0;n<t.length;n++){const i=t[n],o=i.fid.toString();e.set(o,i)}this.musicCarList=e}seOrderList(t){this.orderList.clear();const e=new Map;for(let n=0;n<t.length;n++){const i=t[n],o=1*i.uid;e.set(o,i)}this.orderList=e}getMusicCarList(){return this.musicCarList}getQueueList(){return this.queueList}getOrderList(){return this.orderList}isAnchors2(t){return this.nowAnchors.includes(1*t)}isPaidan2(t){return this.nowWaiters.includes(1*t)}isLive19And20(){let t=this.roomInfo.live;return 19==t||20==t}getTeacherValue(){return JSON.parse(sessionStorage.getItem("selfuser")||"{}").value.teacher}isManager(t){return this.managers.includes(1*t)}isPaidanAnchor(t){return this.roomInfo.waiter_ids.map((t=>1*t)).includes(t)}isNarratorAnchor(t){return this.roomInfo.narrator_ids.map((t=>1*t)).includes(t)}isAnchor(t){return this.roomInfo.anchor_ids.map((t=>1*t)).includes(t)}isAnchors(t,e){const n=this.sessionStore.getChannels()[t];if(!n)return this.nowAnchors.includes(e);let i=[];return i=1==n.typeid?this.roomInfo.waiter_ids.map((t=>1*t)):n.anchors.map((t=>1*t)),i.includes(e)}isPaidan(t,e){const n=this.sessionStore.getChannels()[t];if(!n)return this.nowWaiters.includes(e);let i=[];return i=1==n.typeid?this.roomInfo.waiter_ids.map((t=>1*t)):n.waiters.map((t=>1*t)),i.includes(e)}isSonger(t){const e=bt.getUserInfo(t);if(e&&e.dtid){return e.dtid.findIndex((t=>1*t==20002))>-1}return!1}getRoomUserIdentity(t,e){if(this.roomInfo)return this.nowAnchors.includes(1*t)?this.isTempCarteamRoom()?this.isMusicTempRoom()&&24!=this.roomInfo.ptype?this.isSonger(t)?"歌手":"队长":this.roomInfo.cap_role:"主持":this.nowWaiters.includes(1*t)?this.roomInfo.cap_role:1==e?"队长":"老板"}getUrlCidParam(){const t=window.location.pathname;if(t=="/"+Mt.urlapi+"/"||t=="/"+Mt.urlapi)return"";const e=t.charAt(t.length-1);let n=t;"/"==e&&(n=t.substr(0,t.length-1));const i=n.split("/");return i[i.length-1]}nameFormat(t){let e=t.replace("♕",'<img style="width:24px;height:24px;margin-top:-7px" src="https://res.tuwan.com/templet/play/fanli4/nianguan.gif?v=1">');return e=e.replace("♔",'<img style="width:24px;height:24px;margin-top:-7px" src="https://res.tuwan.com/templet/play/fanli4/yueguan.gif?v=1">'),e}nameColor(t,e){return this.isJiamianRoom()&&"#666"==t&&(t="#e3dadc"),'<font style="color:'+t+'">'+e+"</font>"}showEditJingpaiContent(t,e,n){const i=window.$('<div class="mask jingpai-edit-mask">\n                        <div class="mask-content qianshou-success">\n                            <p class="qs-successtext">编辑拍卖内容</p>\n                            <div class="flex flex-ac flex-jc">\n                                <textarea maxlength="30" class="jiangpai-edit-textarea">'+n+'</textarea>\n                            </div>\n                            <div style="text-align:center;margin-top:20px;">\n                                <button class="submit-edit-content" data-id="'+t+'" data-cid="'+e+'">提交</button>\n                            </div>\n                            <div class="mask-close"></div>\n                        </div>\n                    </div>');window.$("body").append(i);const o=i.find(".mask-close"),s=i.find(".submit-edit-content");o.on("click",(function t(){o.off("click",t),i.remove()})),s.on("click",(function t(){const{id:e,cid:n}=this.dataset,o=i.find(".jiangpai-edit-textarea").val();qt.get(Ot.auctionUpdate(e,n,encodeURIComponent(o))).then((e=>{const{error:n,error_msg:o}=e;0==n?(s.off("click",t),i.remove()):-99!=n&&Ct.Alert(o)}))}))}showIframe(t){const e=window.$('<div class="mask iframe-mask">\n                        <div class="mask-content iframe-url">\n                            <iframe class="iframeurl" style="width:100%;height:100%" src="'+t+'"></iframe>\n                            <div class="mask-close"></div>\n                        </div>\n                    </div>');window.$("body").append(e);const n=e.find(".mask-close");n.on("click",(function t(){n.off("click",t),e.remove()}))}showUnsealModal(t){const{title:e,content:n,button:i}=t,o=window.$(`<div class="mask" style="z-index:110014">\n                                    <div class="mask-content unseal_content flex flex-dir-col">\n                                        <div class="unseal_title">${e}</div>\n                                        <div class="unseal_desc">${n}</div>\n                                        <div class="unseal_close"></div>\n                                        <div class="unseal_question"></div>\n                                        <div class="unseal_btn">${i}</div>\n                                    </div>\n                                </div>`);window.$("body").append(o);const s=o.find(".unseal_close"),a=o.find(".unseal_btn"),r=o.find(".unseal_question");function c(){s.off("click",c),r.off("click",l),o.remove()}function l(){r.off("click",l),window.open("https://t.tuwan.com/view/?aid=415005","_blank"),c()}s.on("click",c),a.on("click",(function t(){qt.get(Ot.buyFrozen()).then((e=>{Vt(e.error_msg),a.off("click",t),c()}))})),r.on("click",l)}showBackGiftModal(){qt.get(Ot.getBackPack()).then((t=>{if(t.data){const{title:e,reward:n,state:i,desc:o}=t.data;if(1==i){let t=function(){qt.get(Ot.giveBackPack()).then((e=>{Vt(e.error_msg),c.off("click",t),i()}))},i=function(){r.off("click",i),a.remove()},s="";n.forEach(((t,e)=>{s+=` <div class="back_user_gift_item" >\n                                        <div class="back_user_gift_item_pic">\n                                            <img src="${t.icon}" alt="">\n                                        </div>\n                                        <div class="back_user_gift_item_text">${t.title}</div> \n                                    </div>`}));const a=window.$(`<div class="mask">\n                                    <div class="mask-content back_user_gift_content">\n                                        <div class="back_user_gift_title">${e}</div>\n                                        <div class="back_user_gift_desc">${o}</div>\n                                        <div class="back_user_gift_close"></div>\n                                        <div class="back_user_gift_detail_content">\n                                            ${s}\n                                        </div>\n                                        <div class="back_user_gift_btn">领取</div>\n                                    </div>\n                                </div>`);window.$("body").append(a);const r=a.find(".back_user_gift_close"),c=a.find(".back_user_gift_btn");r.on("click",i),c.on("click",t)}}}))}showDayGiftModal(){qt.get(Ot.getDayPack()).then((t=>{if(t.data){const{title:e,reward:n,state:i,desc:o}=t.data;if(1==i){let t=function(){qt.get(Ot.giveDayPack()).then((e=>{Vt(e.error_msg),c.off("click",t),i()}))},i=function(){r.off("click",i),a.remove()},s="";n.forEach(((t,e)=>{s+=` <div class="back_user_gift_item" >\n                                        <div class="back_user_gift_item_pic" style="width:100px;height:100px;">\n                                            <img src="${t.icon}" alt="">\n                                        </div>\n                                        <div class="back_user_gift_item_text" style="bottom:2px">${t.title}</div> \n                                    </div>`}));const a=window.$(`<div class="mask">\n                                    <div class="mask-content back_user_gift_content" style="width:680px">\n                                        <div class="back_user_gift_title">${e}</div>\n                                        <div class="back_user_gift_desc">${o}</div>\n                                        <div class="back_user_gift_close"></div>\n                                        <div class="back_user_gift_detail_content">\n                                            ${s}\n                                        </div>\n                                        <div class="back_user_gift_btn">领取</div>\n                                    </div>\n                                </div>`);window.$("body").append(a);const r=a.find(".back_user_gift_close"),c=a.find(".back_user_gift_btn");r.on("click",i),c.on("click",t)}}}))}showDeductModal(t,e,n){qt.get(Ot.getDeductType(n,this.getCid())).then((i=>{let o="",s=i.tips;i.data.forEach(((t,e)=>{o+=`<div class="deduct_item">\n                                <input type="radio" id="deduct_${e}" class="deduct_text" value="${t.typeid}" name="deductText" ${0==e?"checked":""}>\n                                <label for="deduct_${e}" class="ygb_cursor">${t.title}</label>\n                            </div>`}));const a=window.$(`<div class="mask">\n                            <div class="mask-content deduct_content">\n                                <div class="mask_title">提示</div>\n                                <div class="common-gift-close dedcut-close"></div>\n                                ${o}\n                                <div class="deduct_btn">确定</div>\n                            </div>\n                        </div>`);window.$("body").append(a);const r=a.find(".dedcut-close"),c=a.find(".deduct_btn");function l(){r.off("click",l),a.remove()}r.on("click",l),c.on("click",(function i(){const o=window.$("input[name='deductText']:checked").val(),a=s||"确定要对“"+e+"”操作吗？";Ct.Confirm(a,(()=>{qt.get(Ot.deduct(t,n,o)).then((t=>{Vt(t.error_msg),c.off("click",i),l()}))}))}))}))}showNewUserGiftModal(t){const e=window.$('<div class="mask">\n                        <div class="mask-content new_user_gift_content">\n                            <div class="mask_title">提示</div>\n                            <div class="mask_tips">领取后，请送给队长享受开黑服务吧~</div>\n                            <div class="flex flex-ac flex-jc new_user_gift_item_container">\n                                <div class="new_user_gift_item_content flex flex-jc flex-ac flex-dir-col">\n                                    <img class="shake" src="https://img3.tuwandata.com/uploads/play/1374021603954759.png">\n                                    <span>玫瑰花 *5</span>\n                                </div>\n                                 <div class="new_user_gift_item_content flex flex-jc flex-ac flex-dir-col">\n                                    <img class="shake" src="https://img3.tuwandata.com/uploads/play2/gift/1007201630136515.png">\n                                    <span>爱情鸟 *5</span>\n                                </div>\n                            </div>\n                            <div class="take_new_user_gift">领取</div>\n                        </div>\n                    </div>');window.$("body").append(e);const n=e.find(".take_new_user_gift");n.on("click",(function i(o){o.stopPropagation(),n.off("click",i),e.remove(),t&&t()}))}getAnalyticsData(t,e={}){const{uid:n,cid:i,typeid:o}=this.roomInfo,s={user_id:n,room_cid:i,room_typeid:o,action:t};return Object.assign(s,e)}getCarButtonStr(){let t="车队";return this.isShengyouFreeRoom()&&(t=this.isPListType2()?"歌房":"车队"),t}}const uu=hu.getInstance(bt);class pu{constructor(t,e,n,i,o){this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.canvasHeight=n,this.canvasWidth=e,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,this.barrageList=[],this.textList=[],this.fontSize=o,this.context.font=`${this.fontSize}px STheiti, SimHei`,this.highwayAmount=[],this.initTop(i),this.draw=!1}initTop(t){const e=parseInt(this.canvasHeight/(this.fontSize+20));e<t&&(t=e);for(let n=1;n<=t;n++)this.highwayAmount.push((this.fontSize+20)*n)}drawBarrage(){this.context.clearRect(0,0,this.canvasWidth,this.canvasHeight);for(let t=0;t<this.barrageList.length;t++)this.barrageList[t].left+this.barrageList[t].width<=0&&this.barrageList.splice(t,1);this.barrageList.forEach((t=>{this.context.fillStyle=t.color,this.context.fillText(`${t.value} `,t.left,t.top),t.occupation&&t.left+t.width<=this.canvasWidth&&this.consumeText(t),t.left-=2})),0==this.barrageList.length?this.draw=!1:requestAnimationFrame(this.drawBarrage.bind(this))}consumeText(t){t.occupation=!1,setTimeout((()=>{this.highwayAmount.push(t.top),0!=this.textList.length&&this.barrageList.push(this.initTest(this.textList.splice(0,1)[0]))}),500)}addTest(t){if(this.draw){if(0!=this.highwayAmount.length){let e=t.splice(0,this.highwayAmount.length);for(const t of e)this.barrageList.push(this.initTest(t))}this.textList.push(...t)}else this.textList.push(...t),this.draw=!0,this.runBarrage()}initTest(t){let e=t;const n="^"==t[t.length-1];return n&&(e=t.slice(0,t.length-1)),{value:e,isSelf:n,top:this.highwayAmount.splice(0,1)[0],left:this.canvasWidth,color:n?"#F3C1FF":"#ffffff",offset:Math.ceil(3*Math.random()),width:Math.ceil(this.context.measureText(e).width),occupation:!0}}runBarrage(){this.textList.splice(0,this.highwayAmount.length).forEach((t=>{this.barrageList.push(this.initTest(t))})),this.drawBarrage()}}function gu(t,e={}){let n=JSON.stringify(e);n=n.replace(/\?/g,"^"),n=n.replace(/&/g,"~"),qt.get(Ot.getQueqiaoMaidian(uu.getCid(),t,n)).then((t=>{}))}class fu{constructor(){this.htmlDom=null,this.iframeId=null,this.queue=[]}static getInstance(){return this.instance||(this.instance=new fu),this.instance}onReset(){window.$(".chat-center-window").show(),window.$(".free-team-content").show(),window.$("#act_modal_content").show(),this.htmlDom&&(this.htmlDom.remove(),this.htmlDom=null),this.iframeId=null,this.queue=[]}initTemplate(t){this.initHtml(t),window.$(".chat-center-window").hide(),window.$(".free-team-content").hide(),window.$("#act_modal_content").hide()}initHtml(t){const e=`\n            <div class="queqiao-anchor">\n                ${Fi._initSeatData(2,158,135,90,90,"主持",!1,!1,"add")}\n            </div>\n        `,n=`\n            <div class="queqiao-jiabin">\n                ${new Array(3).fill(0).map(((t,e)=>Fi._getOtherAnchorSeatHtml({position:3+e,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:100,pheight:135,width:65,height:65,isshowmeili:!1}))).join("")}\n            </div>\n        `;this.htmlDom=window.$(`\n            <div class="queqiao-content flex" style="height: ${window.$(".chat-center-left").height()}px;">\n                <div class="activity_banner"></div>\n                <div class="queqiao-seats">  \n                    ${e}\n                    ${n}\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom),this.htmlDom.click((function(t){t.stopPropagation()})),_u.getInstance().getActivityData(uu.getCid())}pushTeamData(t){if(this.htmlDom)if(_u.getInstance().activityData){if(0==t.status){if(this.queue.findIndex((e=>e.uid==t.uid))>=0)return}0!=t.status&&1!=t.status||(1==t.status&&this.clearQueue(),this.queue.push(t),this.checkShowTeamModal())}else gu(21)}checkShowTeamModal(){const t=this.queue[0];t&&!t._visible&&this.showTeamModal(t)}removeLastModal(){this.queue.shift(),this.checkShowTeamModal()}clearQueue(){this.queue=[],this.htmlDom&&this.htmlDom.find(".teamModal").remove()}showTeamModal(t){const e=this,n=_u.getInstance(),i=1==t.status;t._visible=!0;const o=window.$(`\n            <div class="teamModal">\n                <div class="teamModal-body">\n                    <p class="teamModal-body-title">CP组队邀请</p>\n                    <div class="teamModal-body-heads">\n                        ${i?s(n.activityData.user_info):""}\n                        ${i?'<img class="teamModal-body-heads-heart" src="https://asset.tuwan.com/activity/queqiao2023/image/team_heart.png"/>':""}\n                        ${s(t)}\n                    </div>\n                    <p class="teamModal-body-desc">${i?"恭喜你们组队成功":"邀请您一起参与彩虹桥活动"}</p>\n                    <div class="teamModal-body-btns">\n                        ${i?"":a(0,t)}\n                        ${a(1,t)}\n                    </div>\n                </div>\n            </div>\n        `);function s(t){return`\n                <div class="teamModal-body-head">\n                    <img src="${t.avatar}"/>\n                    <p>${t.name}</p>\n                </div>\n            `}function a(t=0,e){return`\n                <img data-type="${t}" data-success="${1==e.status?1:0}" data-teamid="${e.team_id}" src="${0==t?"https://asset.tuwan.com/activity/queqiao2023/image/team_cancel.png":"https://asset.tuwan.com/activity/queqiao2023/image/team_confirm.png"}"/>\n            `}this.htmlDom.append(o),o.on("click",".teamModal-body-btns img",(function(){if(0==this.dataset.success){let t=this.dataset.teamid;n.agreeOrDisagree(0==this.dataset.type?2:1,t,(()=>{o.remove(),e.removeLastModal()}))}else o.remove(),e.removeLastModal()}))}}class wu{constructor(){this.timeCounter=null}parse(t){if(/^\d{10}$/.test(t))return new Date(1e3*t);if(/^\d{13}$/.test(t))return new Date(1*t);let e=(t=this.trim(t)).match(/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/);if(e){let t=e[1],n=parseInt(e[2]-1,10),i=parseInt(e[3],10),o=parseInt(e[4],10),s=parseInt(e[5],10),a=parseInt(e[6],10);return new Date(t,n,i,o,s,a)}return""}trim(t){return t.replace(/(^\s*)|(\s*$)/g,"")}getTimeObject(t){let e=1e3,n=6e4,i=60*n,o=24*i,s=parseInt(t/o),a=parseInt((t-s*o)/i),r=parseInt((t-s*o-a*i)/n),c=parseInt((t-s*o-a*i-r*n)/e),l=t-s*o-a*i-r*n-c*e,d=s,m=a,h=r,u=c,p=l<10?"0"+l:""+l;p=l<100?"0"+p:""+p;let g={};return g.day=d,g.hour=m,g.minute=h,g.second=u,g.millisecond=p,g.total=t,g.timeStr=(g.day>0?g.day+"天":"")+(g.day>0&&g.hour>=0||g.hour>0?g.hour+"小时":"")+(g.hour>0&&g.minute>=0||g.minute>0?g.minute+"分":"")+(g.second>=0?g.second+"秒":""),g}countDown(t){let e,n,i=t.nowTime,o=t.startTime,s=t.endTime,a=i&&this.parse(i),r=s&&this.parse(s),c=t.interval||1e3,l=this,d=0,m=0;if(o=(new Date).getTime(),a||(a=new Date),!r)return;e=r.getTime()-a.getTime(),e<0&&(e=0),clearTimeout(this.timeCounter);let h=()=>{d++;let i=(new Date).getTime()-(o+d*c);i>1e4&&(m=~~(i/c),d+=m,e-=m*c);let s=c-i;s<0&&(s=0),n=l.getTimeObject(e),t.tickCallback&&t.tickCallback(n),e-=c,e<0?(clearTimeout(this.timeCounter),t.endCallback&&t.endCallback()):this.timeCounter=setTimeout(h,s)};return e>=0&&h(),{stopCountDown:()=>{clearTimeout(this.timeCounter)}}}}const vu=t=>(new wu).countDown(t);class _u{constructor(){this.initStyle(),this.emitter=new Ht,this.size=875,this.lineWidth=15,this.ctx=null,this.position=null,this.radius=null,this.gradient=null,this.pervLeft=-532,this.prevTop=-32,this.prog=30,this.prog1=0,this.plan=0,this.activityTimer=null,this.animation=null,this.timer=null,this.timeCountHandler=null,this.newTimer=null,this.ansTimer=null,this.cid=null,this.activityData=null,this.pushdata=null,this.audioContext=new AudioContext,this.captureTimer=null,this.captureAudioVolumn=0,this.agoraClient=null,this.agoraLocalAudio=null,this.soundDomMap=null,this.selfUid=null,this.partnerUid=null,this.usersInfo=null,this.isGiveUp=!1,this.bridgeData=[],this.allUserData=[],this.preMaxScore={},this.stage1=!1,this.stage2=!1,this.stage3=!1,this.prevTopTeamid=0,this.animateHandler=null,this.stageProg=[0,.155,.43,1],this.svgaUrl=["https://img3.tuwandata.com/uploads/play2/gift/1939911675755858.svga","https://img3.tuwandata.com/uploads/play/8054051597807515.svga"],this.arr=[],this.time=0,this.stageRequestTag={stage0:!1,stage1:!1,stage2:!1},this.mineScore=0}static getInstance(){return this.instance||(this.instance=new _u),this.instance}onReset(){this.activityData=null,this.pushdata=null,this.selfUid=null,this.partnerUid=null,this.usersInfo=null,this.isGiveUp=!1,this.bridgeData=[],this.allUserData=[],this.preMaxScore={},this.stage1=!1,this.stage2=!1,this.stage3=!1,this.clearCaptureTimer(),this.closeAudioContext(),this.clearSubChannelRoom(),this.soundDomMap=null,this.barrage=null,null!=this.timeCountHandler&&(this.timeCountHandler.stopCountDown(),this.timeCountHandler=null),window.clearInterval(this.newTimer),this.stageRequestTag={stage0:!1,stage1:!1,stage2:!1},this.mineScore=0}initStyle(){window.$("head").append('<style>\n                        .ygb_flex{display:flex}\n                        .ygb_flex_align_c{display:flex;align-items:center}\n                        .ygb_flex_c{display:flex;align-items:center;justify-content:center}\n                        .ygb_cursor{cursor: pointer;}\n                        .ygb_hide{display:none !important;}\n                        .text_over {overflow: hidden;text-overflow: ellipsis;white-space: nowrap}\n                        .ygb_scroll_list { overflow-y: auto}\n                        .ygb_scroll_list::-webkit-scrollbar { width: 6px; background-color: transparent; }\n                        .ygb_scroll_list::-webkit-scrollbar-thumb { border-radius: 10px; background-color: #9D4CF5; }\n                        .ygb_scroll_list::-webkit-scrollbar-button { background: 0 0; height: 2px }\n                        .chatroom-guanzhu{z-index:100}                        \n                        .main-zhuci {position: relative;z-index: 102;}\n                        .carteam_zhuchi_header_content {z-index: 102;position: relative;}\n                        .activity_rule{position: absolute;width: 34px;height: 34px;background: url(https://asset.tuwan.com/chatroom/images/activity_qx_rule.png);z-index:113;right:170px;top:20px;}\n                        .stage_common_content{position: relative; width: 1259px;height: 100%;padding:0 6px;box-sizing:border-box;z-index:111;position:absolute;max-width:100%;max-height:100%}\n                        .stage_0_content{position: absolute;width: 1259px;height: 100%;z-index: 110;border-radius:10px}\n                        .stage_0_content_bg {position: absolute; width: 2000px; height: 100%; left: 50%; top: 0; transform: translateX(-50%); background-color: rgba(0, 0, 0, 0.6); z-index: -1;}\n                        .activity_progress_line{ position: absolute;top: 268px;left: 50%;width: 880px;height: 450px;text-align:center;margin-left: -440px;}\n                        .boat_team_content {position: absolute;left: 50%;transform: translateX(-50%);bottom: 40px;width:64px;height:64px;z-index:107}\n                        .activity_canvas {position:absolute;top: 270px;left: 50%;transform:translateX(-50%);z-index: 100;width:875px;height:875px;}\n                        .boat_team_item{position:absolute; width: 1px; height: 1px; left: 0; top: 0;}\n                        .boat_team_item img.self_img{width: 70px;height: 70px;border: 2px solid #FFBDDC;border-radius: 50%;box-sizing: border-box;}\n                        .boat_team_item img.other_img{width: 50px;height: 50px;border: 2px solid #FFBDDC;border-radius: 50%;box-sizing: border-box;}\n                        .boat_team_item.self_big img.other_img {width: 70px; height: 70px; margin-left: -15px;}\n                        .give_content{position:absolute;transform:translate3d(-480px,0px,0);z-index: 100;}\n                        .accept_content{position:absolute;transform:translate3d(480px,0px,0);z-index: 100;}\n                        .give_content.self,.accept_content.self{z-index: 101;}\n                        .level_line_common{position:relative;margin:0 auto;z-index:106;font-size:14px;color:rgb(254, 248, 155);justify-content: space-around;}\n                        .level_1_line{margin-left: -24px;width:928px;height:108px;margin-top:30px;background:url(https://asset.tuwan.com/chatroom/images/level_line_1.png?v=1); background-repeat: no-repeat;}\n                        .level_2_line{width:778px;height:108px;margin-top:17px;background:url(https://asset.tuwan.com/chatroom/images/level_line_2.png?v=1); background-repeat: no-repeat;}\n                        .level_3_line{width:137px;height:43px;margin-top:-40px;background:url(https://asset.tuwan.com/chatroom/images/level_line_3.png?v=1)}\n                        .level_line_common .text_left, .level_line_common .text_right { margin-top: 20px; }\n                        .activity_bird{margin-top:-103px; width: 124px; height: 112px;}\n                        .level_common_score{font-size:14px;color:#cf8aff;margin-top:0px;position:relative}\n                        .stage_gift_item{position:absolute;width:100px;height:100px;left:50%;transform:translateX(-50%);top:-100px;z-index:110; opacity: 0;}\n                        .level_3_score{margin-top:0px}\n                        .activity_time_countdown{width:255px;height:40px;background:url(https://asset.tuwan.com/chatroom/images/activity_countdown_bg.png);margin:0 auto; margin-top: 10px;font-size:20px;color:#fff1ad;text-align:center;line-height:40px;background-repeat: no-repeat;background-position: center;}\n                        .activity_time_desc{font-size: 14px; color: #F3C1FF; text-align: center; line-height: 15px;}\n                        .singup_team_info_content{position:relative;width:700px;justify-content:space-between;margin:0 auto;margin-top:20px;}\n                        .activity_user_info_content{width:210px;height:130px;}\n                        .stage_0_header {position: relative; width:86px;height:86px;margin:6px auto 10px;}\n                        .stage_0_header img{width:80px;height:80px;border-radius:50%;border:3px solid #EBA5FF}\n                        .stage_0_header .headSvga { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 130%; height: 130%; pointer-events: none; }\n                        .stage_0_nick{font-size:16px;color:#F3C1FF;text-align:center}\n                        .acticity_stage_0_countdown{text-align:center;width:378px;height:45px;background:url(https://asset.tuwan.com/activity/queqiao2023/image/stage_0_countdown.png);position:absolute;top:27px;left:50%;color:#ffe9a9;transform:translateX(-50%)}\n                        .team_time_title{font-size:16px;margin-top:-30px;opacity: 0;}\n                        .team_time_detail{font-size:20px;margin-top:16px}\n                        .singup_team_detail_content{width:548px;margin:0 auto; margin-top: 10px;}\n                        .activity_other_invite{background:url(https://asset.tuwan.com/activity/queqiao2023/image/activity_tab_0.png)}\n                        .activity_other_invite.actived{background:url(https://asset.tuwan.com/activity/queqiao2023/image/activity_tab_0_s.png)}\n                        .activity_my_invite{margin-left:-14px;background:url(https://asset.tuwan.com/activity/queqiao2023/image/activity_tab_1.png)}\n                        .activity_my_invite.actived{background:url(https://asset.tuwan.com/activity/queqiao2023/image/activity_tab_1_s.png)}\n                        .common_invite_list{width: 548px; height:322px;box-sizing:border-box; }\n                        .common_invite_list .invite_list_item{height:64px;margin:0 auto;font-size:14px;color:#F3C1FF;}\n                        .common_invite_list .invite_list_item .search_nick{width:216px; font-size: 16px;}\n                        .common_invite_list .invite_list_item img.invite_header{width:40px;height:40px;border:2px solid #F6B6D2;border-radius:100%;margin-right:10px;margin-left:43px}\n                        .other_invite_btn{width:60px;height:21px;justify-content:space-between;}\n                        .search_result_btn{align-items: center;}\n                        .activity_invite_rule{font-size:14px;color:#E5B4FF;margin-top:3px; white-space: nowrap;}\n                        .invite_waiting{color:#F3C1FF}\n                        .invite_refuse{color:#a18949}\n                        .activity_search_box{width:306px;height:49px;background:url(https://asset.tuwan.com/activity/queqiao2023/image/activity_search_box.png)}\n                        .activity_search_little_box{display:flex; align-items: center;}\n                        .activity_search_input{width: 390px; height: 36px; padding: 0; line-height: 36px; background-color: rgba(104, 22, 190, 0.8); border-radius:36px; border: 1px solid #E49EFA; outline: none; text-align: left; color: #F3C1FF; font-size: 18px; padding-left: 20px;}\n                        .activity_search_little_input::placeholder {color: #CA87FF}\n                        .activity_search_input::placeholder {color: #F3C1FF}\n                        .activity_search_fail{font-size: 14px;color: #b4d6ff;text-align:center;margin-top:10px}\n                        .gift_plan_item{width:398px;height:46px;padding-left:64px;box-sizing:border-box;background:url(https://res.tuwan.com/templet/play/2020/2020qixi/activity_plan.png);font-size:14px;color:#fff;margin-left:14px;flex-shrink: 0;}\n                        .gift_plan_item span{color:#fff9a3;display:inline-block;max-width:80px;margin:0 4px}\n                        .gift_plan_item img{width：30px;height:30px}\n                        .activity_little_btn{display: flex; align-items: center;}\n                        .activity_little_btn img {width: 40px; height: 39px;}\n                        .activity_little_btn p {margin-left: 2px; width: 32px; font-size: 14px; color: #F3C1FF; text-align: center;}\n                        .activity_big_btn_content,.activity_big_btn_content_1{margin:0 auto;display:flex;opacity:0;bottom:0}\n                        .activity_big_btn_content_1{opacity:1;position:absolute;left:50%;transform:translateX(-50%);z-index:120}\n                        .activity_big_btn_content {display: flex; justify-content: center;margin-top: 50px;}\n                        .common_confirm_modal{display:none;position: absolute;width: 1259px;height: 100%;background: rgba(0,0,0,.6);z-index: 150;overflow:hidden;border-radius:10px}\n                        .ans_confirm_modal{z-index:151}\n                        .team_confirm_content,.manifesto_content,.ans_exit_content{width:493px;height:307px;background:url(https://asset.tuwan.com/chatroom/images/activity_text_content.png);text-align:center;font-size:22px;color:#F3C1FF; flex-direction: column;margin-bottom:26px}\n                        .team_confirm_content span{color:#ffe9a9}\n                        .team_confirm_content div{margin-top:10px}\n                        .team_confirm_btn_content{width:344px;justify-content:space-between;margin:0 auto;}\n                        .activity_modal_btn_item{width:166px;height:55px;}\n                        .activity_blue_btn{background:url(https://asset.tuwan.com/chatroom/images/qx_btn_cancel.png);}\n                        .activity_yellow_btn{background:url(https://asset.tuwan.com/chatroom/images/qx_btn_confirm.png);}\n                        .activity_common_big_btn,.common_save_pic{width:166px;height:55px;margin:0 auto}\n                        .activity_common_big_btn{background:url(https://asset.tuwan.com/chatroom/images/qx_btn_confirm.png); background-repeat: no-repeat;}\n                        .activity_common_big_btn[data-stage="2"]{padding-left: 30px;}\n                        .common_save_pic{background:url(https://asset.tuwan.com/chatroom/images/qx_btn_save_img.png);}\n                        .common_save_pic{display:block}\n                        .common_text_input{width:280px;height:30px;outline:none;border:none;background:transparent;color:#F3C1FF;font-size:16px;text-align:center;border-bottom:1px solid rgba(232,208,255,0.4);}\n                        .common_text_input::placeholder { color: #F3C1FF}\n                        .activity_common_modal_content,.activity_exit_ans_content{position:relative}\n                        .activity_common_close{position:absolute;right:-24px;top:-24px;width: 37px;}\n                        .activity_willanswer_close{position:absolute;right:-20px;top:-40px;z-index:150;width: 37px;}\n                        .activity_answered_close{position:absolute;right:0px;top:-20px}\n                        .header_text_content{width:173px;height:33px;position:absolute;font-size:14px;color:#e8d8ff;text-align:center;line-height:30px;top:-36px}\n                        .header_text_left{background:url(https://res.tuwan.com/templet/play/2020/2020qixi/header_text_left_content.png);left:-104px;}\n                        .header_text_right{background:url(https://res.tuwan.com/templet/play/2020/2020qixi/header_text_right_content.png);left:-4px;}\n                        .answer_begin_content{padding-top:113px;box-sizing:border-box;width:523px;height:447px;background:url(https://asset.tuwan.com/chatroom/images/ans_begin_bg.png)}\n                        .ans_save_pic{display:block;position:relative;width:166px;height:56px;background:url(https://asset.tuwan.com/chatroom/images/qx_btn_save_img.png);margin:0 auto;z-index:150}\n                        .ansed_img{z-index:149;position:relative}\n                        .user_left_info{font-size:16px;color:#fff;text-align:center;width:200px}\n                        .answer_users_info{position:relative}\n                        .ans_begin_nick{margin-top:6px; font-size: 14px; color: #F3C1FF;}\n                        .ans_begin_countdown{width:144px;height:38px;line-height:38px;text-align:center;color:#f3c1ff;font-size:18px;margin:0 auto;background-color:#6F1ECA;margin-top:18px; border-radius: 38px;}\n                        .ans_begin_avatar{width:100px;height:100px;margin:0 auto}\n                        .ans_begin_avatar img{width:100px;height:100px;border-radius:50%;border:2px solid #F29DFF;box-sizing:border-box}\n                        .answer_info_content{justify-content: center;text-align:center;width:750px;height:440px;background:url(https://asset.tuwan.com/chatroom/images/ans_bg.png)}\n                        .common_ans_info{width:130px;height:300px;font-size:14px;color: #F3C1FF;margin-top:120px}\n                        .common_ans_user_avatar{width:70px;height:70px;margin:0 auto;margin-bottom:10px}\n                        .common_ans_user_avatar img{width:70px;height:70px;border-radius:50%;border:2px solid #F29DFF;box-sizing:border-box}\n                        .common_choose_item{font-size:60px;font-weight:bold;margin-top:50px;font-family:Microsoft YaHei}\n                        .left_choose_item{color:#ff8bae}\n                        .right_choose_item{color:#8ae5ff}\n                        .que_ans_content{width:370px;color:#F3C1FF;font-size:14px;margin-top:50px;position:relative}\n                        .ans_countdown{width:123px;height:33px;line-height: 33px;margin:0 auto;margin-top:10px;color:white;background-color: #6F1ECA;border-radius: 33px;}\n                        .que_content{width: 370px; white-space: nowrap; overflow: hidden;margin:0 auto;margin-top:60px;font-size:20px;text-align:center;line-height:20px;color: #F3C1FF;}\n                        .common_ans_btn{width:260px;height:41px;background:url(https://asset.tuwan.com/chatroom/images/qx_ans.png);margin:0 auto;margin-top:20px;font-size:16px;line-height:41px;text-align:center}\n                        .common_ans_btn.actived{background:url(https://asset.tuwan.com/chatroom/images/qx_ans_s.png);color:#fff}\n                        .common_ans_tips{color:white;font-size:16px;margin-top:20px;display:none}\n                        .ans_total_score{position:absolute;bottom:33px;left:50%;transform:translateX(-50%)}\n                        .activity_wish_text_content{width:530px;height:392px;background:url(https://asset.tuwan.com/chatroom/images/stage_1_text_bg.png);margin-bottom:16px}\n                        .activity_nick_text_content{width:550px;height:392px;background:url(https://asset.tuwan.com/chatroom/images/stage_2_text_bg.png);margin-bottom:16px}\n                        .activity_three_gift_content,.activity_two_gift_content{margin-left:20px;margin-top:20px}\n                        .activity_three_gift_info{width:143px;height:374px;background:url(https://asset.tuwan.com/chatroom/images/stage_gift_content.png);margin-bottom:16px}\n                        .activity_two_gift_info{width:143px;height:374px;background:url(https://asset.tuwan.com/chatroom/images/stage_gift_content.png);margin-bottom:16px}\n                        .common_gift_content{font-size:14px;color:#F3C1FF;padding-top:10px;box-sizing:border-box;}\n                        .activity_common_gift_content{display:none}\n                        .wish_input, .nick_input{margin-top:-70px}\n                        .common_gift_item{margin-top:5px;text-align:center}\n                        .common_gift_bg{width:82px;height:82px;background:url(https://asset.tuwan.com/chatroom/images/stage_gift_bg.png);margin:0 auto;margin-bottom:4px; background-size: 100%;}\n                        .common_gift_bg img{width:80%}\n                        .activity_stage_gift_common>img{margin-bottom:16px;}\n                        .line_1_text{margin-top:20px}\n                        .activity_search_content{position:relative}\n                        .activity_search_modal {position: absolute; left: 0; top: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.6); z-index: 999;}\n                        .left_text,.right_text{ background: url(https://res.tuwan.com/templet/play/2020/2020qixi/left_opening.png) no-repeat left,url(https://res.tuwan.com/templet/play/2020/2020qixi/right_opening.png) no-repeat right;padding:0 20px}\n                        .activity_rule_content{width:5000px;height:100%;background-color:#690DD1;position:absolute;z-index:9000;left: 50%; top: 0; transform: translateX(-50%); }\n                        .activity_rule_close{position:absolute;left: calc(50% + 500px);top:20px;width: 27px;}\n                        @keyframes ruleFadeIn {0% {opacity: 0.6; }25% {opacity: 0.8; }50% {opacity: 1; }75% {opacity: .8; }100% {opacity: .6; }}\n                        .activity_title{width:241px;height:58px;margin:0 auto;}\n                        .activity_open_time{margin-top: 20px; height:20px;background:url(https://asset.tuwan.com/chatroom/images/activity_open_time.png);color:#FFF1AD;font-size:20px;text-align:center;line-height:20px;background-size: 368px 14px; background-repeat: no-repeat; background-position: center;}\n                        #activity_danmu_container{z-index: 111; position: absolute; left: 50%; top: 90px; width: 800px; transform: translateX(-50%); height: 80px; pointer-events: none;}\n                        .activity_gift_limit { color: #cf8aff; }\n                        .activity_stage_desc { font-size: 16px; color: #F3C1FF; text-align: center; margin-top: 10px;}\n                        .activity_stage_gift_modal_1, .activity_stage_gift_modal_2, .activity_stage_gift_modal_3 {display: flex; position: relative;}\n                    </style>')}initHtml(){window.$(".activity_banner").html('\n            <div class="activity_rule ygb_cursor"></div>\n            <div class="stage_0_content stage_common_content"></div>\n            <div class="stage_1_content stage_common_content"></div>\n            <canvas id="activity_danmu_container"></canvas>\n        '),window.$(".queqiao-content").append('\n            <div class="common_confirm_modal ans_confirm_modal ygb_flex_c">\n                <div class="activity_exit_ans_content">\n                    <div class="ans_exit_content ygb_flex_c"></div>\n                    <div class="team_confirm_btn_content ygb_flex">\n                        <div class="activity_modal_btn_item ygb_cursor activity_blue_btn" data-type="continue"></div>\n                        <div class="activity_modal_btn_item ygb_cursor activity_yellow_btn" data-type="cancleAns"></div> \n                    </div>\n                </div>\n            </div>\n            <div class="common_confirm_modal team_ans_modal ygb_flex_c">\n                <div class="activity_common_modal_content activity_answer_begin_content"></div>\n                <div class="activity_common_modal_content activity_answered_content"></div>\n                <div class="activity_common_modal_content activity_answer_info_content"></div>\n            </div>\n            <div class="common_confirm_modal stage_gift_modal_1 ygb_flex_c">\n                <div class="activity_stage_gift_modal_1">\n                    <img class="activity_common_close ygb_cursor wish_close" data-stage="1" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                    <div class="activity_stage_text_1 activity_stage_gift_common">\n                        <div class="activity_wish_text_content ygb_flex_c">\n                            <input class="wish_input common_text_input" maxLength="10" data-text="送上你对TA的祝福吧，限10个字" placeholder="送上你对TA的祝福吧，限10个字">\n                        </div>\n                        <div class="activity_common_big_btn ygb_cursor" data-stage="1" data-type="wish"></div>\n                        <p class="activity_stage_desc">填写祝福语后即可领取奖励</p>\n                    </div>\n                    <div class="activity_three_gift_content activity_common_gift_content">\n                        <div class="activity_three_gift_info gift_content_1 common_gift_content">\n                            <p style="text-align: center; color: #F3C1FF;">奖励</p>\n                            <div class="gift_list"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="common_confirm_modal stage_gift_modal_2 ygb_flex_c">\n                <div class="activity_stage_gift_modal_2">\n                        <img class="activity_common_close ygb_cursor wish_close" data-stage="2" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                        <div class="activity_stage_text_2 activity_stage_gift_common">\n                            <div class="activity_nick_text_content ygb_flex_c">\n                                <input class="nick_input common_text_input" maxLength="5" data-text="对TA怎么称呼？大猪蹄子？限5字" placeholder="对TA怎么称呼？大猪蹄子？限5字">\n                            </div>\n                            <div class="activity_common_big_btn ygb_cursor" data-stage="2" data-type="nick"></div>\n                            <p class="activity_stage_desc" style="padding-right: 33px;">填写爱心昵称后即可领取奖励</p>\n                        </div>\n                        <div class="activity_three_gift_content activity_common_gift_content">\n                            <div class="activity_three_gift_info gift_content_2 common_gift_content">\n                                <p style="text-align: center; color: #F3C1FF;">奖励</p>\n                                <div class="gift_list"></div>\n                            </div>\n                        </div>\n                    </div>\n            </div>\n            <div class="common_confirm_modal stage_gift_modal_3 ygb_flex_c">\n                <div class="activity_stage_gift_modal_3">\n                        <img class="activity_common_close ygb_cursor wish_close" data-stage="3" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                        <div class="activity_stage_finish_3 activity_stage_gift_common">\n                            <img src="" style="width: 620px; height: 400px;">\n                            <div class="flex flex-ac flex-jc">\n                                <a class="common_save_pic" href="" download="cp.png" style="margin: initial;"></a>\n                                <div class="activity_common_big_btn ygb_cursor" style="margin: initial; margin-left: 40px;" data-stage="3" data-type="receiveGift"></div>\n                            </div>\n                            <p class="activity_stage_desc">点击确定后即可领取奖励</p>\n                        </div>\n                        <div class="activity_two_gift_content activity_common_gift_content">\n                            <div class="activity_two_gift_info gift_content_3 common_gift_content">\n                                <p style="text-align: center; color: #F3C1FF;">奖励</p>\n                                <div class="gift_list"></div>\n                            </div>\n                        </div>\n                    </div>\n            </div>\n        '),this.barrage=new pu("activity_danmu_container",800,80,2,16)}pushBarrage(t){this.barrage&&1==t.type&&this.barrage.addTest([`${t.userinfo.nickname}：${t.message}${t.userinfo.uid==uu.getMeid()?"^":""}`])}getActivityData(t){this.cid=t,this.selfUid=uu.getMeid(),qt.get(Pt+`/bridge/startinfo?cid=${t}`).then((e=>{if(0==e.error){const n=e.data;this.activityData=n;let{stage:i,team_finish:o}=n;if(-1==i)return;this.initHtml(),-1!==i&&(0==i&&0==o?this.activeStage0(n):this.activeStage1(n),this.updateStageDesc()),this.initEvents(t),this.loadSoundStageHtml(n)}}))}updateStage0(){qt.get(Pt+`/bridge/startinfo?cid=${uu.getCid()}`).then((t=>{0==t.error&&(this.activityData=t.data,window.$(".activity_search_modal").remove(),this.activeStage1(this.activityData,!0),this.updateStageDesc())}))}updateStageDesc(){let t="";if(this.activityData){const e=this.activityData.stage;0==e?1==this.activityData.team_finish&&(t="准备阶段：等待开始"):1==e?t="第一阶段：玫瑰祝福":2==e?t="第二阶段：爱心昵称":(3==e||4==e)&&(t="第三阶段：彩虹桥约定")}window.$(".activity_time_desc").text(t)}updateStageScoreProgress(t){if(this.activityData){const e=this.activityData.stage;for(let n=1;n<=4;n++)if(e>=n){const e=window.$(`.level_${n}_score .score`);e.text(t+"/"+this.activityData[`part${n}_love_value`]+"情缘值"),e.css("color","white")}else window.$(`.level_${n}_score .score`).text(this.activityData[`part${n}_love_value`]+"情缘值")}}initEvents(t){let e=this,n=window.$(".queqiao-content"),i=window.$(".stage_0_content"),o=window.$(".common_confirm_modal"),s=window.$(".ans_confirm_modal"),a=window.$(".stage_1_content");n.off("click"),i.off("click"),a.off("click"),n.off("focus"),n.off("blur"),n.off("keyup"),o.off("click"),n.on("click",".activity_recommend_list",(function(t){t.stopPropagation()})),a.on("click",".stage_gift_item",(function(){if(0==e.activityData.team_finish)return;let t=this.dataset.stage;e.loadStageModalInfo(t,!0),gu(13,{level:t})})),n.on("click",".activity_common_btn",(function(t){if(t.stopPropagation(),!e.checkLoginState())return;let n=this.dataset.type,i=this.dataset.uid,o=this.dataset.nick;"smallGift"==n?e.sendDestGift(0,i):"bigGift"==n?e.sendDestGift(1,i):"gift"==n?e.emitter.emit("showGiftWindow",i,o):"showSearch"==n&&e.showSearchModal()})),n.on("focus",".common_text_input",(function(){window.$(this).removeAttr("placeholder")})),n.on("blur",".common_text_input",(function(){let t=this.dataset.text;window.$(this).attr("placeholder",t)})),n.on("click",".activity_rule",(function(){let t=new Date(e.activityData.start_time);const n=window.$(`\n                <div class="activity_rule_content">\n                    <p style="font-size: 42px; color: #F3C1FF; line-height: 42px; margin-top: 19px; text-align: center;">玩法说明</p>\n                    <div class="activity_open_time">开启时间：${t.getHours()}时${t.getMinutes()}分</div>\n                    <img class="activity_rule_close ygb_cursor" src="https://asset.tuwan.com/chatroom/images/qx_rule_close.png">\n                    <div class="scroll-bar-hide" style="position: absolute; top: 120px; left: 50%; bottom: 0; width: 972px; transform: translateX(-50%); overflow-y: scroll; padding-bottom: 50px;"><img src="https://asset.tuwan.com/chatroom/images/qx_rule_content.png?a=4" style="width: 100%;"/></div>\n                </div>\n            `);window.$(".queqiao-content").append(n),n.on("click",".activity_rule_close",(function(){n.remove()}))})),o.on("click",".activity_modal_btn_item",(function(t){t.stopPropagation();let n=this.dataset.type;"cancleAns"!=n?"continue"!=n||s.hide():e.giveUpAnw()})),o.on("click",".wish_close",(function(t){t.stopPropagation();let e=this.dataset.stage;window.$(`.stage_gift_modal_${e}`).hide()})),o.on("click",".activity_common_big_btn",(function(t){t.stopPropagation();let n=this.dataset.type,i=this.dataset.stage,o="";if("wish"==n)o=window.$(".wish_input").val();else if("nick"==n)o=window.$(".nick_input").val();else if("receiveGift"==n)return void qt.get(Pt+`/bridge/award?cid=${e.cid}&stage=3`).then((t=>{0==t.error&&(window.$(".stage_gift_modal_3").hide(),e.updateStageEffect()),Vt(t.error_msg)}));e.uploadText(i,o)})),o.on("click",".common_answer_close",(function(t){t.stopPropagation();let n=this.dataset.type;"answer_finish"==n?window.$(".team_ans_modal").hide():e.answerConfirm(n)})),o.on("click",".common_ans_btn",(function(t){if(t.stopPropagation(),""!=window.$(`.user_info_${e.selfUid} .common_choose_item`).html())return;let n=this.dataset.type,i=window.$(".ans_progress .now_que").html();e.uploadAns(i,n),window.$(".common_ans_btn").removeClass("actived"),window.$(this).addClass("actived"),window.$(`.user_info_${e.selfUid} .common_choose_item`).html(n)})),n.on("click",".activity_show_ranklist",(function(t){t.stopPropagation(),e.showRankList()}))}checkLoginState(){return!(uu.getMeid()>Mt.maxUID)||(this.emitter.emit("showLoginWindow"),!1)}sendDestGift(t,e){const n=0==t?this.activityData.small_gift_id:this.activityData.big_gift_id;qt.get(Ot.payDiamond(`format=jsonp&id=${n}&giftid=${n}&platform=0&num=1&cid=${uu.getCid()}&uids=${e}`)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}checkAnsProgress(){qt.get(Pt+`/bridge/progress?cid=${this.cid}`).then((t=>{if(0==t.error){const{number:e,countdown:n,list:i}=t.data;if(i.length>0)if(this.question=i,0==e){let t={question:i,pre_answer_time:n};this.beginAnswer(t)}else this.renderAnswerProgress(i),this.showAnswerModal(e-1,n)}})),gu(7)}loadStageModalInfo(t,e=!1){qt.get(Pt+`/bridge/stageinfo?cid=${this.cid}&stage=${t}`).then((n=>{if(0==n.error){let{img_url:i,award_info:o,text:s,is_award:a}=n.data;if(0==e&&1==a)return;if(t>=3&&""==i)return;let r="";if(1==this.activityData.is_official?(window.$(`.stage_gift_modal_${t} .activity_common_gift_content`).css("display","flex"),o.forEach((t=>{r+=`<div class="common_gift_item">\n                                        <div class="common_gift_bg ygb_flex_c">\n                                            <img src="${t.icon}">\n                                        </div>\n                                        <div>${t.name}</div>\n                                    </div>`})),window.$(`.gift_content_${t} .gift_list`).html(r)):window.$(`.stage_gift_modal_${t} .activity_common_gift_content`).hide(),3==t){window.$(".activity_stage_finish_3 img").attr("src",i);let t=".activity_stage_finish_3 .common_save_pic";this.getBase64(t,i)}else window.$(`.activity_stage_text_${t} input`).val(s);window.$(`.stage_gift_modal_${t}`).css("display","flex"),this[`stage${t}`]=!0}else e&&Vt(n.error_msg)}))}searchChannelUser(){let t=window.$(".activity_search_input").val();const e=this;qt.get(Pt+`/bridge/search?cid=${this.cid}&kw=${t}`).then((t=>{if(0==t.error){const n=window.$(".activity_search_list .common_invite_list");0==t.data.length?n.html('<div class="activity_search_fail">没有相关的搜索结果</div>'):n.html(this.renderList(t.data)),n.off("click"),n.on("click",".activity_common_btn",(function(t){t.stopPropagation();let n=this.dataset.type,i=this.dataset.uid;"smallGift"==n?e.sendDestGift(0,i):"bigGift"==n&&e.sendDestGift(1,i)}))}else t.error_msg&&t.error_msg.length&&Vt(t.error_msg)}))}uploadAns(t,e){qt.get(Pt+`/bridge/answer?cid=${this.cid}&number=${t}&answer=${e}`).then((t=>{if(0==t.error){const{is_finish:e}=t.data;1==e&&this.updateAnsModal(t.data)}}))}updateAnsModal(t){const{love_value:e,total_love_value:n,teammate_answer:i}=t;window.$(`.user_info_${this.partnerUid} .common_choose_item`).html(i),window.$(".ans_total_score span").html(n),e>0?(window.$(".ans_right_tips").css("display","flex"),window.$(".ans_right_tips span").html(`+${e}`)):window.$(".ans_false_tips").css("display","flex"),window.$(".common_ans_tips").snabbt({scale:[1.2,1.2],duration:50}).snabbt({scale:[1,1],duration:300})}giveUpAnw(){qt.get(Pt+`/bridge/giveup?cid=${this.cid}`).then((t=>{0==t.error?(window.$(".team_ans_modal").hide(),window.$(".ans_confirm_modal").hide(),this.isGiveUp=!0):Vt(t.error_msg)}))}uploadText(t,e){e?qt.get(Pt+`/bridge/text?cid=${this.cid}&type=${t}&text=${e}`).then((n=>{if(0==n.error){const{user_info:n}=this.activityData;let i=n.is_left;switch(t){case"0":break;case"1":let t="";if(1==i){let n=`<div class="left_text line_1_text"><span>${e}</span></div>`;window.$(".level_1_line .text_left").html(n),t=window.$(".level_1_line .text_right").html()}else{let n=`<div class="right_text line_1_text"><span>${e}</span></div>`;window.$(".level_1_line .text_right").html(n),t=window.$(".level_1_line .text_left").html()}window.$(".wish_input").attr("readonly","readonly"),""!=t&&this.playSvga(0);break;case"2":let n="";if(1==i){let t=`<div class="left_text"><span>${e}</span></div>`;window.$(".level_2_line .text_left").html(t),n=window.$(".level_2_line .text_right").html()}else{let t=`<div class="right_text"><span>${e}</span></div>`;window.$(".level_2_line .text_right").html(t),n=window.$(".level_2_line .text_left").html()}window.$(".nick_input").attr("readonly","readonly"),""!=n&&this.playSvga(1)}1!=t&&2!=t||window.$(`.stage_gift_modal_${t}`).hide(),this.updateStageEffect()}else Vt(n.error_msg)})):Vt("输入内容不能为空")}agreeOrDisagree(t,e,n){qt.get(Pt+`/bridge/invite?cid=${this.cid}&agree=${t}&team_id=${e}`).then((t=>{0==t.error||Vt(t.error_msg),n&&n()}))}renderList(t){let e="";return t.forEach((t=>{e+=this.renderInviteItem(t)})),e}renderInviteItem(t){const{small_gift_pic:e,big_gift_pic:n}=this.activityData;return`<div class="invite_list_item activity_search_item ygb_cursor ygb_flex_align_c" data-nick="${t.name}" data-uid="${t.uid}" data-teamid="${t.team_id}">\n            <img class="invite_header" src="${t.avatar}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n            <div class="search_nick text_over">${t.name}</div>\n            <div class="search_result_btn flex">\n                <div class="activity_little_btn activity_common_btn ygb_cursor" data-type="smallGift" data-uid="${t.uid}">\n                    <img src="${e}"/>\n                    <p>邀请CP</p>\n                </div>\n                <div class="activity_little_btn activity_common_btn ygb_cursor" style="margin-left: 25px;" data-type="bigGift" data-uid="${t.uid}">\n                    <img src="${n}"/>\n                    <p>霸王抢亲</p>\n                </div>\n            </div>\n        </div>`}renderTeamData(){return'\n                            <div class="stage_0_header ygb_cursor ygb_flex_c">\n                                <img src="https://asset.tuwan.com/activity/queqiao2023/image/activity_add.png">\n                                <div class="headSvga"/>\n                            </div>\n                            <div class="stage_0_nick">添加CP</div>'}showSearchModal(){const t=window.$('\n            <div class="activity_search_modal">\n                <div class="activity_search_content">\n                    <div class="activity_search_little_box ygb_flex_c">\n                        <input class="activity_search_input activity_search_little_input" type="text" data-type="else" placeholder="请输入用户昵称或ID">\n                        <img class="activity_search_btn activity_common_btn ygb_cursor" style="margin-left:13px; width: 121px; height: 41px;" src="https://asset.tuwan.com/activity/queqiao2023/image/qx_btn_search.png">\n                    </div>\n                    <div class="activity_search_list activity_common_content activity_search_little_list" style="margin-top: 15px; padding: 2px; width: 550px; height: 328px; background:url(https://asset.tuwan.com/activity/queqiao2023/image/recommend_bg.png); background-repeat: no-repeat; background-size: 100%;">\n                        <div class="common_invite_list ygb_scroll_list"></div>\n                    </div>\n                </div>\n            </div>\n        ');window.$(".queqiao-content").append(t);const e=this;t.on("click",(function(){t.remove()})),t.find(".activity_search_content").on("click",(function(t){t.stopPropagation()})),t.find(".activity_search_btn").on("click",(function(t){t.stopPropagation(),e.searchChannelUser()})),t.find(".activity_search_input").on("keyup",(function(t){t.stopPropagation(),13==t.which&&e.searchChannelUser()}))}updateText(t){const{stage:e,text:n}=t,{user_info:i}=this.activityData;let o=i.is_left,s="";if(0==e);else if(1==e)if(1==o){let t=`<div class="right_text line_1_text"><span>${n}</span></div>`;window.$(".level_1_line .text_right").html(t),s=window.$(".level_1_line .text_left").html()}else{let t=`<div class="left_text line_1_text"><span>${n}</span></div>`;window.$(".level_1_line .text_left").html(t),s=window.$(".level_1_line .text_right").html()}else if(2==e)if(1==o){let t=`<div class="right_text"><span>${n}</span></div>`;window.$(".level_2_line .text_right").html(t),s=window.$(".level_2_line .text_left").html()}else{let t=`<div class="left_text"><span>${n}</span></div>`;window.$(".level_2_line .text_left").html(t),s=window.$(".level_2_line .text_right").html()}""!=s&&this.playSvga(e-1,"updateText")}recommendOnline(t){if(t.user_info.uid==uu.getMeid())return;const e=window.$(".activity_recommend_list .common_invite_list");e.children().length>=10&&(t.friend_uid_list=t.friend_uid_list||[],!t.friend_uid_list.map((t=>String(t))).includes(String(uu.getMeid())))||(window.$(`.activity_recommend_list .common_invite_list .activity_search_item[data-uid="${t.user_info.uid}"]`).remove(),e.prepend(this.renderInviteItem(t.user_info)))}recommendTeamSuccess(t){for(const e of t.success_uid_list)window.$(`.activity_recommend_list .common_invite_list .activity_search_item[data-uid="${e}"]`).remove()}refreshRecommend(){qt.get(Pt+`/bridge/startinfo?cid=${uu.getCid()}`).then((t=>{if(0==t.error){window.$(".activity_recommend_list .common_invite_list").html(this.renderList(t.data.default_search))}}))}activeStage0(t){window.$(".stage_common_content").hide(),window.$(".stage_0_content").show();const{countdown:e,team_finish:n,user_info:i,default_search:o,small_gift_name:s,big_gift_name:a}=t;let r=window.$(`\n            <div class="stage_0_content_bg"/>\n            <p style="font-size: 18px; color: #F3C1FF; text-align: center; margin-top: 80px;">准备阶段：CP组队</p>\n            <div class="singup_team_info_content flex">\n                <div class="activity_user_info_content">\n                    <div class="stage_0_header ygb_flex_c">\n                        <img src="${i.avatar}"/> \n                        <div class="headSvga"/>\n                    </div>\n                    <div class="stage_0_nick">${i.name}</div>\n                </div>\n                <div class="acticity_stage_0_countdown">\n                    <div class="team_time_title">${1==n?"组队成功":"组队倒计时"}</div>\n                    <div class="team_time_detail"></div>\n                </div>\n                <div class="activity_user_info_content other">\n                    ${this.renderTeamData()}\n                </div>\n            </div>\n            <div class="singup_team_detail_content">\n                <div class="activity_recommend_list" style="padding: 2px; width: 550px; height: 328px; background:url(https://asset.tuwan.com/activity/queqiao2023/image/recommend_bg.png); background-repeat: no-repeat; background-size: 100%;">\n                    <div class="common_invite_list ygb_scroll_list">${this.renderList(o)}</div>\n                </div>\n                <div class="activity_invite_content" style="margin-top: 15px;">\n                    <div class="activity_invite_rule">1.每人都可组成一个攀爬爱情彩虹桥的队伍；</div>\n                    <div class="activity_invite_rule">2.送出【${s}】发起组队邀请，对方同意后组队成功；</div>\n                    <div class="activity_invite_rule">3.送出【${a}】直接组队成功，不需要对方同意哦~</div>\n                    <div class="activity_invite_rule">4.活动开后，也可以送出【${a}】直接和未组队用户组队~</div>\n                </div>\n            </div>\n        `);window.$(".stage_0_content").html(r),this.countdownTimer(e,".team_time_detail");const c=this;r.find(".activity_user_info_content.other").on("click",(function(t){t.stopPropagation(),c.checkLoginState()&&c.showSearchModal()})),document.querySelectorAll(".headSvga").forEach((t=>{Zt.getInstance().loadParser(t,"https://activity-static.tuwan.com/static/svga/202210/30/d49eb8a928bd8c7f947476b0fa037bc3.svga",0,!0).then((t=>{const{videoItem:e,player:n}=t;n.setVideoItem(e),n.startAnimation()}),(t=>{}))}))}countdownTimer(t,e){if(null!=this.timeCountHandler&&(this.timeCountHandler.stopCountDown(),this.timeCountHandler=null),t>0){let n=Math.round((new Date).getTime()/1e3);this.timeCountHandler=vu({interval:1e3,nowTime:n,endTime:n+t,tickCallback:t=>{window.$(e).html(t.timeStr)},endCallback:()=>{}})}else window.$(e).html("0秒")}updateStage(t){this.activityData&&t.stage!=this.activityData.stage&&(t=c(c({},this.activityData),t),this.activityData=t,1==t.stage&&fu.getInstance().clearQueue(),0==window.$(".stage_1_content").children().length||1==t.stage?this.activeStage1(t,!0):this.commonUpdateStage(t),this.updateStageDesc(),this.updateStageScoreProgress(this.mineScore),gu(5,t))}activeStage1(t,e){window.$(".stage_common_content").hide(),window.$(".stage_1_content").show();const{user_info:n,teammate_info:i,team_finish:o}=this.activityData;let s=1==n.is_left?n.text_1?`<div class="left_text line_1_text"><span>${n.text_1}</span></div>`:"":i.text_1?`<div class="left_text line_1_text"><span>${i.text_1}</span></div>`:"",a=1==n.is_left?i.text_1?`<div class="left_text line_1_text"><span>${i.text_1}</span></div>`:"":n.text_1?`<div class="left_text line_1_text"><span>${n.text_1}</span></div>`:"",r=`<div class="activity_title"></div>\n                        <div class="activity_time_countdown">\n                            <span></span>\n                            <p class="activity_time_desc"></p>\n                        </div>\n                        <div class="activity_score_rank">\n                            <p class="activity_show_ranklist ygb_cursor">彩虹排行榜 &gt;</p>\n                            <div class="activity_ranklist_container"> \n                                <div class="top3"></div>\n                                <div class="mine"></div>\n                            </div>\n                        </div>\n                        <div class="activity_progress_line">\n                            <div class="level_3_line level_line_common" style="z-index: 108;">\n                                <img class="activity_bird" src="https://asset.tuwan.com/chatroom/images/qx_brid.png">\n                            </div>\n                            <div class="level_3_score level_common_score"><img src="https://asset.tuwan.com/activity/queqiao2023/image/activity_stage_effect.gif" data-stage="3" class="stage_gift_item ygb_cursor"></img><div class="score" style="height: 20px;"></div></div>\n                            <div class="level_2_line level_line_common ygb_flex_c">\n                                <div class="text_left">${1==n.is_left?n.text_2?`<div class="left_text"><span>${n.text_2}</span></div>`:"":i.text_2?`<div class="left_text"><span>${i.text_2}</span></div>`:""}</div>\n                                <div class="text_right">${1==n.is_left?i.text_2?`<div class="left_text"><span>${i.text_2}</span></div>`:"":n.text_2?`<div class="left_text"><span>${n.text_2}</span></div>`:""}</div>\n                            </div>\n                            <div class="level_2_score level_common_score"><img src="https://asset.tuwan.com/activity/queqiao2023/image/activity_stage_effect.gif" data-stage="2" class="stage_gift_item ygb_cursor"></img><div class="score" style="height: 20px;"></div><p class="activity_gift_limit">(本阶段情缘值最高到此上限)</p></div>\n                            <div class="level_1_line level_line_common ygb_flex_c">\n                                <div class="text_left">${s}</div>\n                                <div class="text_right">${a}</div>\n                            </div>\n                            <div class="level_1_score level_common_score"><img src="https://asset.tuwan.com/activity/queqiao2023/image/activity_stage_effect.gif" data-stage="1" class="stage_gift_item ygb_cursor"></img><div class="score" style="height: 20px;"></div><p class="activity_gift_limit">(本阶段情缘值最高到此上限)</p></div>\n                            <div class="boat_team_content"></div> \n                            <div class="activity_big_btn_content_1 flex">\n                                ${1==o?`<img class="sendGift activity_big_btn activity_common_btn ygb_cursor" data-nick="${i.name}" data-uid="${i.uid}" data-type="gift" src="https://asset.tuwan.com/chatroom/images/qx_btn_send_gift.png">`:'<img class="showSearch activity_big_btn activity_common_btn ygb_cursor" data-type="showSearch" src="https://asset.tuwan.com/activity/queqiao2023/image/qx_btn_find_cp.png">'}\n                            </div>\n                        </div>`;window.$(".stage_1_content").html(r),this.renderBridgeUser(e),this.commonUpdateStage(t),this.updateRankData(),0==t.team_finish&&this.updateStageScoreProgress(0)}commonUpdateStage(t){this.countdownTimer(t.countdown,".activity_time_countdown span")}beginAnswer(t){if("flex"==window.$(".team_ans_modal").css("display"))return;const{question:e,pre_answer_time:n}=t;if(this.question=e,0==this.activityData.team_finish)return;fu.getInstance().clearQueue(),window.$(".team_ans_modal .activity_common_modal_content").hide(),window.$(".team_ans_modal").css("display","flex");let i=`<img class="activity_willanswer_close common_answer_close ygb_cursor" data-type="willans" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                           <div class="answer_begin_content">\n                                <div class="answer_users_info ygb_flex_c">\n                                    <div class="user_left_info">\n                                        <div class="ans_begin_avatar ygb_flex_c">\n                                            <img src="${this.usersInfo.avatar1}">\n                                        </div>\n                                        <div class="ans_begin_nick text_over">${this.usersInfo.name1}</div>\n                                    </div>\n                                    <div class="user_left_info">\n                                        <div class="ans_begin_avatar ygb_flex_c">\n                                            <img src="${this.usersInfo.avatar2}">\n                                        </div>\n                                        <div class="ans_begin_nick text_over">${this.usersInfo.name2}</div>\n                                    </div>\n                                </div>\n                                <div class="ans_begin_countdown">距离开启:<span></span>秒</div>\n                            </div>`;window.$(".activity_answer_begin_content").html(i),window.$(".ans_begin_countdown span").html(n),this.ansCountDown(".ans_begin_countdown span",n-1,0),window.$(".activity_answer_begin_content").show(),this.renderAnswerProgress(e)}renderAnswerProgress(t){let e=`<img class="activity_answered_close common_answer_close ygb_cursor" data-type="answered" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                                <div class="answer_info_content ygb_flex">\n                                    <div class="user_info_${this.usersInfo.uid1} common_ans_info">\n                                        <div class="common_ans_user_avatar ygb_flex_c">\n                                            <img src="${this.usersInfo.avatar1}">\n                                        </div>\n                                        <div class="common_ans_user_nick">${this.usersInfo.name1}</div>\n                                        <div class="left_choose_item common_choose_item"></div>\n                                    </div>\n                                    <div class="que_ans_content">\n                                        <div class="ans_progress">第<span class="now_que"></span>题·共${t.length}题</div>\n                                        <div class="ans_countdown"><span></span>s</div>\n                                        <div class="que_content">由唐代诗人贾岛和韩愈斟酌诗句引申而来的词语是：</div>\n                                        <div class="ans_a common_ans_btn ygb_cursor" data-type="A"></div>\n                                        <div class="ans_b common_ans_btn ygb_cursor" data-type="B"></div>\n                                        <div class="ans_right_tips ygb_flex_c common_ans_tips">\n                                            <img src="https://asset.tuwan.com/chatroom/images/qx_right_heart.png" style="width: 47px;">\n                                            <div style="color: #FFF995;">真是默契！情缘值 <span></span></div>\n                                        </div>\n                                        <div class="ans_false_tips ygb_flex_c common_ans_tips">\n                                            <img src="https://asset.tuwan.com/chatroom/images/qx_false_heart.png" style="width: 34px;">\n                                            <div>默契有待提升哦~ </div>\n                                        </div>\n                                        <div class="ans_total_score">累计考验获得情缘值：<span></span></div>\n                                    </div>\n                                    <div class="user_info_${this.usersInfo.uid2} common_ans_info">\n                                        <div class="common_ans_user_avatar ygb_flex_c">\n                                            <img src="${this.usersInfo.avatar2}">\n                                        </div>\n                                        <div class="common_ans_user_nick">${this.usersInfo.name2}</div>\n                                        <div class="right_choose_item common_choose_item"></div>\n                                    </div>\n                                </div>`;window.$(".activity_answer_info_content").html(e);window.$(".activity_answered_content").html('<img class="activity_willanswer_close common_answer_close ygb_cursor" data-type="answer_finish" src="https://asset.tuwan.com/chatroom/images/box_close.png">\n                           <img class="ansed_img" src="" style="width: 400px; height: 341px;">\n                           <a class="ans_save_pic"  href="" download="ans.png"></a>')}showAnswerModal(t,e){const{number:n,question:i,answer_A:o,answer_B:s,countdown:a}=this.question[t];let r=e||a;window.$(".common_ans_tips").hide(),window.$(".ans_progress .now_que").html(n),window.$(".que_content").html(i),window.$(".ans_a").html(`A.${o}`),window.$(".ans_b").html(`B.${s}`),window.$(".ans_countdown span").html(r),this.ansCountDown(".ans_countdown span",r-1,t+1),window.$(".common_choose_item").html(""),window.$(".common_ans_btn").removeClass("actived"),window.$(".team_ans_modal .activity_common_modal_content").hide(),window.$(".team_ans_modal").css("display","flex"),window.$(".activity_answer_info_content").show(),gu(8,{number:n})}showAnsedModal(){window.$(".team_ans_modal .activity_common_modal_content").hide(),window.$(".team_ans_modal").hide(),window.$(".activity_qx_ans").remove(),qt.get(Pt+`/bridge/getresult?cid=${this.cid}`).then((t=>{if(0==t.error){const e=t.data,n=window.$(`\n                    <div class="activity_qx_ans">\n                        <div class="stage_end">\n                            <div class="row">\n                                <div class="ps">\n                                    <p>${this.activityData.user_info.name}</p>\n                                </div>\n                                <div class="heads">\n                                    ${this.getSoundStageHeadNameHtml(this.activityData.user_info,!1)}\n                                    ${this.getSoundStageHeadNameHtml(this.activityData.teammate_info,!1)}\n                                </div>\n                                <div class="ps">\n                                    <p>${this.activityData.teammate_info.name}</p>\n                                </div>\n                            </div>\n                            <img src="https://asset.tuwan.com/activity/queqiao2023/image/ans_end_desc_${e.total_love_value>=1800?"success":"fail"}.png" class="desc">\n                            <p class="ans_right_num">考验通过${e.pass_num}道题</p>\n                            <p class="love_value">情缘值+${e.total_love_value}</p>\n                            <img src="https://asset.tuwan.com/chatroom/images/box_close.png" class="close ygb_cursor">\n                        </div>\n                    </div>\n                `);window.$(".activity_banner").append(n),setTimeout((()=>{window.$(".activity_qx_ans").remove()}),1e4),n.find(".close").on("click",(function(){window.$(".activity_qx_ans").remove()}))}})),gu(9)}renderBridgeUser(t){qt.get(Pt+`/Bridge/bridgePushdata?cid=${this.cid}`).then((e=>{if(0==e.error){const n=e.data.list;this.updateBridgeInfo(n,"init"),1!=this.activityData.is_official||t||1!=this.activityData.team_finish||this.checkAnsProgress(),this.pushdata=e.data,this.loadSoundStageHtml(this.activityData)}}))}activeRunningTeamedStatus(t){this.pushdata&&this.pushdata.list||(this.pushdata={list:[]}),this.pushdata.list.push(t),this.updateBridgeInfo([t],"init",!0),window.$(".activity_big_btn_content_1 .sendGift").css("display","flex"),window.$(".activity_big_btn_content_1 .showSearch").css("display","none")}updateBridgeInfo(t,e,n=!1){if(!this.activityData)return;const{part1_love_value:i,part2_love_value:o,part3_love_value:s,team_id:a}=this.activityData,r=[0,i,o,s];let c="",l=this;if(!t)return;const d=t.find((t=>t.teamid==this.activityData.team_id));if(d){let t;this.mineScore=d.score,d.score>=s?t=3:d.score>=o?t=2:d.score>=i&&(t=1),t>0&&this.updateStageEffect(t)}if(t.forEach(((t,n)=>{const{uid1:i,uid2:o,teamid:s,avatar1:d,avatar2:m,score:h,text1:u,text2:p,order:g}=t;let f="",w="",v="",_="",y="",x="";s==a?(window.$(".activity_self_score span").html(h),this.updateStageScoreProgress(h),f="self",w="self_img",v=u?`<div class="header_text_content header_text_left">${u}</div>`:"",_=p?`<div class="header_text_content header_text_right">${p}</div>`:"",this.usersInfo=t,this.partnerUid=this.selfUid==i?o:i,y="z-index:100",x="z-index:100",h>=r[1]&&0==this.stage1&&(e||(this.loadStageModalInfo(1),gu(15,{type:1}))),h>=r[2]&&0==this.stage2&&(e||(this.loadStageModalInfo(2),gu(15,{type:2}))),h>=r[3]&&0==this.stage3&&(e||setTimeout((()=>{l.loadStageModalInfo(3),gu(15,{type:3})}),3e3))):(f="other",w="other_img",v="",_="",y=`transform:translate(-${510+g%8*10}px,0px);z-index:1`,x=`transform:translate(${510+g%8*10}px,0px);z-index:1`);const b=this.allUserData.findIndex((e=>e.teamid==t.teamid)),$=this.allUserData.find((e=>e.teamid==t.teamid)),k={teamid:s,endPro:this.calcPersonProg(h,e),nowPro:"init"==e?0:$&&$.nowPro||0,order:"init"==e?g:1};-1!==b?this.allUserData[b]=k:this.allUserData.push(k),"init"==e?(k.nowPro=k.endPro,c+=`<div class="boat_team_item" data-teamid="${s}" style="z-index:${s==this.activityData.teamid?"99999":g}"> \n                                        <div class="give_content ygb_flex_c ${f}" style="${y}">\n                                            ${v}\n                                            <img class="${w}" src="${d}" alt="">\n                                        </div>\n                                        <div class="accept_content ygb_flex_c ${f}" style="${x}">\n                                            ${_}\n                                            <img class="${w}" src="${m}" alt="">\n                                        </div>\n                                    </div>`):-1==b&&(c+=`<div class="boat_team_item" data-teamid="${s}" style="z-index:${s==this.activityData.teamid?"99999":g}"> \n                                        <div class="give_content ygb_flex_c ${f}" style="${y}">\n                                            ${v}\n                                            <img class="${w}" src="${d}" alt="">\n                                        </div>\n                                        <div class="accept_content ygb_flex_c ${f}" style="${x}">\n                                            ${_}\n                                            <img class="${w}" src="${m}" alt="">\n                                        </div>\n                                    </div>`,this.pushdata&&this.pushdata.list||(this.pushdata={list:[]}),this.pushdata.list.push(t))})),"init"==e?(n?window.$(".boat_team_content").append(c):window.$(".boat_team_content").html(c),this.allUserData.forEach(((t,e)=>{this.drawHeader(t.endPro,t.teamid,t.order)}))):(c.length&&window.$(".boat_team_content").append(c),this.drawPersonProgress()),!e)if(this.activityData){if(t){const e=t.filter((t=>t.score>=this.activityData.part3_love_value)).map((t=>({teamid:t.teamid,score:t.score})));e.length>0&&gu(16,e)}}else gu(20)}ansCountDown(t,e,n){if(n>5)return;clearInterval(this.ansTimer);let i=this;this.ansTimer=setInterval((()=>{e>0?(window.$(t).html(e),--e):(clearInterval(i.ansTimer),0==i.isGiveUp&&(n<5?i.showAnswerModal(n):i.showAnsedModal()))}),1e3)}answerConfirm(t){let e="";"willans"==t?e="<div>你确定放弃默契挑战环节吗？</div>":"answered"==t&&(e="<div>您已经在答题过程中，现在取消</div>\n                        <div>之前答题进度将不保存，是否离开？</div>"),window.$(".ans_exit_content").html(e),window.$(".ans_confirm_modal").css("display","flex")}loadSoundStageHtml(t){if(1==this.activityData.is_official&&(!this.activityData||!this.activityData.team_finish||window.$(".activity_qx_soundbox").length>0))return;const e=Number(t.pre_shout_countdown),n=Number(t.shout_countdown);e>0?(fu.getInstance().clearQueue(),this.showPrepareStage(e,n)):n>0&&(fu.getInstance().clearQueue(),this.showStartStage(n))}registerBtnClick(t){const e=this;t.find(".buttons .sendgift").on("click",(function(t){t.stopPropagation();const{uid:n,name:i}=e.activityData.teammate_info;e.emitter.emit("showGiftWindow",n,i)})),t.find(".buttons .contact").on("click",(function(t){t.stopPropagation();const{uid:n,name:i}=e.activityData.teammate_info;bh(n)}))}getSoundStageHeadNameHtml(t,e=!0){return`\n            <div class="headName">\n                <img src="${t.avatar}" class="headImg">\n                ${e?`<p>${t.name}</p>`:""}\n            </div>\n        `}showPrepareStage(t,e){window.$(".team_ans_modal").hide(),window.$(".activity_qx_soundbox").remove();const n=window.$(`\n            <div class="activity_qx_soundbox">\n                <div class="stage_prepare">\n                    <div class="heads">\n                        ${this.getSoundStageHeadNameHtml(this.activityData.user_info)}\n                        ${this.getSoundStageHeadNameHtml(this.activityData.teammate_info)}\n                    </div>\n                    <p class="countdown">距离开启：0s</p>\n                </div>\n            </div>\n        `);window.$(".activity_banner").append(n),this.registerBtnClick(n);const i=n.find(".countdown");this.startCountDown(t,(t=>{i.html(`距离开启：${t}s`)})),setTimeout((()=>{this.showStartStage(e)}),1e3*t),gu(10)}showStartStage(t){try{gu(11,{tag:"一个标记"})}catch(o){}if(!this.pushdata)return;function e(){return`\n                <div class="blocks">\n                    ${new Array(10).fill(0).map((()=>'<div class="block" style="background-color: rgba(255, 255, 255, 0.2);"></div>')).join("")}\n                </div>\n            `}window.$(".team_ans_modal").hide(),window.$(".activity_qx_soundbox").remove();const n=window.$(`\n            <div class="activity_qx_soundbox">\n                <div class="stage_start">\n                    <p class="countdown">0s</p>\n                    <div class="block1">\n                        <div class="soundHead mine">\n                            ${this.getSoundStageHeadNameHtml(this.activityData.user_info)}\n                            ${e()}\n                            <p class="volumeP">当前音量：0</p>\n                        </div>\n                        <div class="block1-center">\n                            <div class="content"/>\n                            <p class="desc">音量越大，获得情缘值越多</p>\n                        </div>\n                        <div class="soundHead teammate">\n                            ${this.getSoundStageHeadNameHtml(this.activityData.teammate_info)}\n                            ${e()}\n                            <p class="volumeP">当前音量：0</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `);window.$(".activity_banner").append(n),this.registerBtnClick(n);const i=n.find(".countdown");this.startCountDown(t,(t=>{i.html(`${t}s`)})),this.joinSubchannelRTC(),this.startAudioCapture(),setTimeout((()=>{this.clearSubChannelRoom(),this.stopAudioCapture(),this.soundDomMap=null,this.showEndStage()}),1e3*t),gu(11)}joinSubchannelRTC(){const t=this;if(this.pushdata&&this.activityData&&this.pushdata.list){const e=uu.getMeid(),n=this.pushdata.list.find((t=>[t.uid1,t.uid2].includes(e)));if(n){const i=n.uid1==this.activityData.user_info.uid?n.sub_channel_key1:n.sub_channel_key2,o=n.sub_channel;if(o&&i){const n=window.AgoraRTC.createClient({mode:"live",codec:"vp8"});this.agoraClient=n,window.AgoraRTC.getMicrophones().then((s=>{if(s.length>0)for(let a=0;a<s.length;a++){if("audioinput"==s[a].kind){n.join(Mt.appid,o,i,1*e).then((e=>{window.AgoraRTC.createMicrophoneAudioTrack({AEC:!1,AGC:!1,ANS:!1,encoderConfig:"standard_stereo"}).then((e=>{t.agoraLocalAudio=e,n.setClientRole("host").then((()=>{n.publish(e).then((()=>{Vt("已为您开启麦克风，大声喊出告白吧")})).catch((t=>{}))})).catch((t=>{}))})).catch((t=>{}))})).catch((t=>{}));break}}})).catch((t=>{}))}}}}clearSubChannelRoom(){this.agoraClient&&(this.agoraClient.leave().then((()=>{this.agoraLocalAudio&&this.agoraLocalAudio.isPlaying&&(this.agoraLocalAudio.stop(),this.agoraLocalAudio.close()),this.agoraLocalAudio=null})).catch((t=>{})),this.agoraClient=null)}updateVolumeProgress(t,e=!0){if(!this.soundDomMap){const t=window.$(".activity_qx_soundbox .stage_start");if(0==t.length)return;this.soundDomMap={mineBlocks:t.find(".mine .blocks .block"),teammateBlocks:t.find(".teammate .blocks .block"),mineVolume:t.find(".mine .volumeP"),teammateVolume:t.find(".teammate .volumeP")}}var n,i;!function(t,e){const n=Math.ceil(Number(e)/10);t.toArray().forEach(((t,e)=>window.$(t).css("background-color",`rgba(255, 255, 255, ${e<=n?.8:.2})`)))}(e?this.soundDomMap.mineBlocks:this.soundDomMap.teammateBlocks,t),n=e?this.soundDomMap.mineVolume:this.soundDomMap.teammateVolume,i=t,n.text(`当前音量：${i}`)}startAudioCapture(){const t=this;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}}).then((e=>{const n=window.AudioContext||window.webkitAudioContext;this.audioContext=new n;const i=this.audioContext.createMediaStreamSource(e),o=this.audioContext.createGain();i.connect(o);const s=this.audioContext.createScriptProcessor(2048,1,1);function a(){qt.get(Ot.getBridgeReportVolume(uu.getCid(),t.captureAudioVolumn)).then((t=>{})),t.captureAudioVolumn=0}s.onaudioprocess=Ct.throttle((function(e){for(var n=e.inputBuffer.getChannelData(0),i=0,o=0;o<n.length;o++)i<n[o]&&(i=n[o]);const s=Math.round(100*i);t.captureAudioVolumn=Math.max(s,t.captureAudioVolumn),t.updateVolumeProgress(s)}),50),o.connect(s),s.connect(this.audioContext.destination),clearInterval(this.captureTimer),this.captureTimer=setInterval(a,1e3),setTimeout(a,200)})).catch((t=>{console.log(t)}))}stopAudioCapture(){this.clearCaptureTimer(),this.closeAudioContext()}clearCaptureTimer(){this.captureTimer&&(window.clearInterval(this.captureTimer),this.captureTimer=null)}closeAudioContext(){"closed"!==this.audioContext.state&&this.audioContext.close()}showEndStage(){window.$(".team_ans_modal").hide(),window.$(".activity_qx_soundbox").remove(),qt.get(Ot.getShoutResult(uu.getCid())).then((t=>{if(0==t.error){const e=t.data,n=window.$(`\n                    <div class="activity_qx_soundbox">\n                        <div class="stage_end">\n                            <div class="row">\n                                <div class="ps">\n                                    <p>${this.activityData.user_info.name}</p>\n                                    <p>最大音量:${e.my_volume||0}</p>\n                                </div>\n                                <div class="heads">\n                                    ${this.getSoundStageHeadNameHtml(this.activityData.user_info,!1)}\n                                    ${this.getSoundStageHeadNameHtml(this.activityData.teammate_info,!1)}\n                                </div>\n                                <div class="ps">\n                                    <p>${this.activityData.teammate_info.name}</p>\n                                    <p>最大音量:${e.teammate_volume||0}</p>\n                                </div>\n                            </div>\n                            <img src="https://asset.tuwan.com/chatroom/images/sound_end_desc_${e.total_love_value>=1800?"success":"fail"}.png" class="desc">\n                            <p class="love_value">情缘值+${e.total_love_value}</p>\n                            <img src="https://asset.tuwan.com/chatroom/images/box_close.png" class="close ygb_cursor">\n                        </div>\n                    </div>\n                `);window.$(".activity_banner").append(n),this.registerBtnClick(n),setTimeout((()=>{window.$(".activity_qx_soundbox").remove()}),1e4),n.find(".close").on("click",(function(){window.$(".activity_qx_soundbox").remove()}))}})),gu(12)}startCountDown(t,e,n){const i=this;window.clearInterval(i.newTimer),t>0&&(i.newTimer=setInterval((()=>{if(e&&e(--t),t<=0)return n&&n(),clearInterval(i.newTimer),void(i.newTimer=null)}),1e3),e&&e(t))}showRankList(){qt.get(Ot.getBridgeRank(uu.getCid())).then((t=>{if(0==t.error){let e=function(t){var e=new Date(t);return e.getFullYear()+"年"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"月")+((e.getDate()<10?"0"+e.getDate():e.getDate())+"日")+((e.getHours()<10?"0"+e.getHours():e.getHours())+":")+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())},n=function(t){var e=new Date(t);return(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())};if(window.$(".activity_qx_rank_list").length>0)return;const i=t.data;let o=i.rank_list||[];const s=o.slice(0,3),a=o.slice(3);let r="";for(let t=0;t<3;t++){const e=s[t];r+=e?`\n                            <div class="top3 ${[e.uid1,e.uid2].includes(uu.getMeid())?"isMine":""} ${t>0?"small":""}">\n                                <div class="number" style="background-image: url(https://asset.tuwan.com/chatroom/images/rank_no_${t+1}.png); background-repeat: no-repeat; background-size: 100%;"></div>\n                                <div class="heads">\n                                    <div class="headName">\n                                        <img src="${e.avatar1}" class="headImg">\n                                        <p>${e.name1}</p>\n                                    </div>\n                                    <div class="headName">\n                                        <img src="${e.avatar2}" class="headImg">\n                                        <p>${e.name2}</p>\n                                    </div>\n                                </div>\n                                <p class="score">彩虹值：${e.score}</p>\n                            </div>\n                        `:'\n                            <div class="top3" style="opacity: 0;">\n                            </div>\n                        '}const c=window.$(` \n                    <div class="activity_qx_rank_list">\n                        <div class="bodyContainer">\n                            <img class="title" src="https://asset.tuwan.com/chatroom/images/rank_title.png">\n                            <img class="close ygb_cursor" src="https://asset.tuwan.com/chatroom/images/btn_close_rank.png">\n                            <div class="scrollContainer scroll-bar-hide">\n                                <p style="color: #f3c1ff; font-size: 18px; padding-left: 250px; padding-top: 40px;">时间${e(1e3*i.start_time)}至${n(1e3*i.end_time)}分，本部门所有参加活动的CP排行;<br/>绑定CP关系后互赠礼物即可提升彩虹值，互赠1钻礼物增加1点彩虹值;</p>\n                                ${0==s.length?'<p style="margin-top: 100px; color: #F3C1FF; font-size: 20px; text-align: center;">期待您的登顶呦~</p>':""}\n                                <div class="top3Container">\n                                    ${r}\n                                </div>\n                                ${a.map((t=>`\n                                    <div class="other ${[t.uid1,t.uid2].includes(uu.getMeid())?"isMine":""}">\n                                        <div class="number">第${t.order}名</div>\n                                        <div class="heads">\n                                            <div class="headName">\n                                                <img src="${t.avatar1}" class="headImg">\n                                            </div>\n                                            <div class="headName">\n                                                <img src="${t.avatar2}" class="headImg">\n                                            </div>\n                                            <img class="heart" src="https://asset.tuwan.com/chatroom/images/rank_other_heart.png">\n                                        </div>\n                                        <div class="ps">\n                                            <p>${t.name1}</p>\n                                            <p>${t.name2}</p>\n                                        </div>\n                                        <p class="score">彩虹值：${t.score}</p>\n                                    </div>\n                                `)).join("")}\n                            </div>\n                        </div>\n                    </div>\n                `);window.$(".queqiao-content").append(c),c.find(".close").on("click",(function(){window.$(".activity_qx_rank_list").remove()}))}}))}getRankItemHtml(t){return`\n            <div class="rank_item">\n                <p class="order">${t.order}</p>\n                <div class="crown"></div>\n                <div class="avatar">\n                    <img src="${t.avatar1}">\n                </div>\n                <div class="avatar">\n                    <img src="${t.avatar2}">\n                </div>\n                <p class="value">${t.score}彩虹值</p>\n            </div>\n        `}updateRankData(){qt.get(Ot.getBridgeRank(uu.getCid(),3)).then((t=>{if(0==t.error){const e=t.data,n=e.rank_list||[];this.updateRankList(n.slice(0,3)),this.updateRankMine(e.self_data)}}))}updateRankList(t=[]){const e=window.$(".activity_banner .activity_ranklist_container .top3"),n=`\n            ${t.map((t=>this.getRankItemHtml(t))).join("")}\n        `;e.html(n)}updateRankMine(t){const e=window.$(".activity_banner .activity_ranklist_container .mine");t.order>3?e.html(this.getRankItemHtml(t)):e.html("")}updateStageEffect(t){null!=t&&this.stageRequestTag[`stage${t}`]||(null!=t&&(this.stageRequestTag[`stage${t}`]=!0),qt.get(Ot.getUserAwardData(uu.getCid())).then((t=>{if(0==t.error)for(let e=1;e<=3;e++)window.$(`.level_${e}_score .stage_gift_item`).css("opacity",1==t.data[`stage${e}`]?1:0)})))}checkShowTopTeam(t){const e=this.allUserData.find((t=>t.teamid==this.activityData.team_id&&t.endPro>=1));if(e)return e.teamid==t;{let e={score:-1};return this.allUserData.forEach(((t,n)=>{t.endPro>=1&&(e=e.score>=t.score?e:t)})),!!e.teamid&&e.teamid==t}}drawHeader(t,e){if(t>=1){window.$(".activity_bird").fadeOut(),this.checkShowTopTeam(e)?(window.$(`.boat_team_item[data-teamid="${e}"]`).css("opacity",1).removeClass("self_big").addClass("self_big"),this.allUserData.forEach(((t,n)=>{t.teamid!=e&&t.endPro>=1&&window.$(`.boat_team_item[data-teamid="${t.teamid}"]`).css("opacity",0).removeClass("self_big")}))):window.$(`.boat_team_item[data-teamid="${e}"]`).css("opacity",0).removeClass("self_big");try{e==this.activityData.team_id?gu(18):gu(17,{teamid:e})}catch(s){}}t>.97&&(t=.97);let n=0;e!=this.activityData.team_id?n=10:(n=0,window.$(`.boat_team_item[data-teamid="${e}"]`).css("z-index","99999"));const i=460*Math.cos(Math.PI*(.5*t))-n,o=-460*Math.sin(Math.PI*(.5*t))+32;window.$(`.boat_team_item[data-teamid="${e}"] .give_content`).css("transform",`translate3d(${-i}px,${o}px,0)`),window.$(`.boat_team_item[data-teamid="${e}"] .accept_content`).css("transform",`translate3d(${i+(e!=this.activityData.team_id?20:0)}px,${o}px,0)`)}drawPersonProgress(){this.animateHandler&&cancelAnimationFrame(this.animateHandler);let t=()=>{let e=1;this.animateHandler=requestAnimationFrame(t),this.allUserData.forEach(((t,n)=>{if(null==t.nowPro&&(t.nowPro=0),!(t.nowPro>=t.endPro)){e=0;let i=t.nowPro+.005;i>t.endPro&&(i=t.endPro),this.drawHeader(i,t.teamid,t.order);const o={teamid:t.teamid,endPro:t.endPro,nowPro:i,order:t.order};this.allUserData[n]=o}})),1==e&&cancelAnimationFrame(this.animateHandler)};t()}calcPersonProg(t,e){const{part1_love_value:n,part2_love_value:i,part3_love_value:o}=this.activityData,s=[0,n,i,o];let a=1;t<=s[1]?a=1:s[1]<t&&t<=s[2]?a=2:s[2]<t&&(a=3),t==s[3]&&"init"!==e&&this.emitter.emit("renderBridgeData");let r=this.stageProg[a-1],c=(1e3*this.stageProg[a]-1e3*r)/1e3,l=s[a-1],d=r+c*((t-l)/(s[a]-l));return d>=1?1:d}getBase64(t,e){window.URL=window.URL||window.webkitURL;var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="blob",n.onload=function(){if(200==this.status){var e=this.response;let n=new FileReader;n.onloadend=function(t){t.target.result},n.readAsDataURL(e);let i=window.URL.createObjectURL(e);window.$(t).attr("href",i)}},n.send()}playSvga(t){let e=(new Date).getTime(),n=window.$('<div id="svga'+e+'" class="canvassvga-fullscreen"></div>');window.$("body").append(n);const i=new window.SVGA.Player("#svga"+e),o=new window.SVGA.Parser("#svga"+e);i.loops=1,i.clearsAfterStop=!1,i.fillMode="Forward",o.load(this.svgaUrl[t],(function(t){i.setVideoItem(t),i.startAnimation(),i.onFinished((function(){n.remove()}))})),gu(3,{stage:t})}}class yu{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new yu),this.instance}show(){si.show(".authentication-mask","block")}}class xu{constructor(){this.instance=null,this.resColor=new Map,this.resSubLineColor=new Map}static getInstance(){return this.instance||(this.instance=new xu),this.instance}getResourceColor(t,e,n,i){let o=null,s=null,a=69,r=29,c=137,l=69,d=29,m=137,h=null;if(1==n?(h=i,t.height=h.height,t.width=h.width,o=t.getContext("2d"),o.drawImage(h,0,0,t.width,t.height),s=o.getImageData(0,0,h.width,h.height).data):2==n&&(h=t,o=t.getContext("2d"),s=o.getImageData(0,0,t.width,t.height).data),null==s||null==h)return"rgba("+a+","+r+","+c+",0.4)";for(let u=0;u<h.height;u++)for(let t=0;t<h.width;t++)u==h.height-1&&(l+=s[4*(h.width*u+t)],d+=s[4*(h.width*u+t)+1],m+=s[4*(h.width*u+t)+2]),0==u?(a+=s[h.width*u+t],r+=s[h.width*u+t+1],c+=s[h.width*u+t+2]):(a+=s[4*(h.width*u+t)],r+=s[4*(h.width*u+t)+1],c+=s[4*(h.width*u+t)+2]);if(a/=h.width*h.height,r/=h.width*h.height,c/=h.width*h.height,l/=h.width,d/=h.width,m/=h.width,l=Math.round(l),d=Math.round(d),m=Math.round(m),a=Math.round(a),r=Math.round(r),c=Math.round(c),2==n&&i.stopAnimation(),0==a&&0==r&&0==c){const t=this.resColor.get(e);null!=t&&t.r==a&&t.g==r&&t.b==c&&(this.resColor.set(e,{r:a,g:r,b:c}),this.resSubLineColor.set(e,{sr:l,sg:d,sb:m}))}else this.resColor.set(e,{r:a,g:r,b:c}),this.resSubLineColor.set(e,{sr:l,sg:d,sb:m});this.checkSkinColorMapWithStyle(e)}_rgbToHsl(t,e,n){t/=255,e/=255,n/=255;var i,o,s=Math.min(t,e,n),a=Math.max(t,e,n),r=(s+a)/2,c=a-s;if(a==s)i=0,o=0;else{switch(o=r>.5?c/(2-a-s):c/(a+s),a){case t:i=(e-n)/c+(e<n?6:0);break;case e:i=2+(n-t)/c;break;case n:i=4+(t-e)/c}i=Math.round(60*i)}return{h:i,s:(o=Math.round(100*o))+"%",l:((r=Math.round(100*r))+20>100?100:r+20)+"%"}}_getColor(t){const e=this,n=t.toLowerCase();return new Promise(((i,o)=>{if(-1!=n.indexOf(".svga")){let o=new window.SVGA.Player("#skin-svga-canvas");new window.SVGA.Parser("#skin-svga-canvas").load(t,(function(t){o.setVideoItem(t),o.startAnimation(),o.loops=1,o.onFinished((()=>{})),o.onFrame((()=>{setTimeout((()=>{i(e.getResourceColor(document.getElementById("skin-svga-canvas").getElementsByTagName("canvas")[0],n,2,o))}),200)}))}))}else if(-1!=n.indexOf(".jpeg")||-1!=n.indexOf(".bmp")||-1!=n.indexOf(".jpg")||-1!=n.indexOf(".png")||-1!=n.indexOf(".gif")||-1!=n.indexOf(".webp")){let o=new Image;o.src=t,o.crossOrigin="Anonymous",o.complete&&i(e.getResourceColor(document.getElementById("skin-canvas"),n,1,o)),o.onload=function(){i(e.getResourceColor(document.getElementById("skin-canvas"),n,1,o))},o.onerror=function(t){}}}))}readResourceColor(t){return this._getColor(t)}getSkinColorMap(t){const e=t.toLowerCase();return{color:this.resColor.get(e),subColor:this.resSubLineColor.get(e)}}getSkinColorMapWithSubStyle(t,e=.4){const n=this.getSkinColorMap(t).subColor;return null!=n&&null!=n.sr&&null!=n.sg&&null!=n.sb?"style=background:rgba("+n.sr+","+n.sg+","+n.sb+","+e+"); ":""}getSkinColorMapWithStyle(t,e=.4){const n=this.getSkinColorMap(t).color;if(null!=n&&null!=n.r&&null!=n.g&&null!=n.b){const t=this._rgbToHsl(n.r,n.g,n.b);return"style=background:hsla("+t.h+","+t.s+","+t.l+","+e+"); "}return""}checkSkinColorMapWithStyle(t){const e=null!=t?t:uu.roomInfo.skin_active||uu.roomInfo.skin,n=this.getSkinColorMap(e);n.color;const i=n.subColor;null!=i&&null!=i.sr&&null!=i.sg&&null!=i.sb&&(window.$(".free-team-container").css("background","rgba("+i.sr+","+i.sg+","+i.sb+",1)"),i.sr>191&&i.sb>191&&i.sg>191&&window.$(".autoroom-teams").addClass("light"))}}const bu=window.$(".free-team-content");class $u extends Ht{constructor(){super(),this.instance=null}static getInstance(){return this.instance||(this.instance=new $u,this.instance.isOpen=!0,this.instance.onEventListener()),this.instance}initTemplate(t){if(this.onReset(),uu.isShengyouFreeRoom()||uu.isWerewolfTeamRoom()){const t=xu.getInstance().getSkinColorMapWithSubStyle(uu.roomInfo.skin_active||uu.roomInfo.skin,1),e=Fi._getTeamsHtml();bu.html('<div id="free-team-container" class="free-team-container new-kaihei-teams flex" '+t+'>\n                        <div class="room-seats-all-room  free-team-info-container flex flex-ac hide flex-1">\n\n                        </div>\n                        '+e+"\n                 </div>")}}showContent(t,e=null){if(null!=t&&9==t.live){const t=Fi._getAutoroomSoloSeatsHtml(uu.roomInfo);return window.$(".free-team-info-container").html(t),window.$(".free-team-content .autoroom-teams").addClass("hide"),void window.$(".free-team-info-container").removeClass("hide")}if(null!=t){const t=Fi._getAutoroomTuijianSeatsHtml(uu.roomInfo);return window.$(".free-team-info-container").html(t),window.$(".free-team-content .autoroom-teams").addClass("hide"),void window.$(".free-team-info-container").removeClass("hide")}if(null!=e&&0!=e.length){const t=uu.inCarAllUsers.get(e[0].fid);if(null!=t&&9==t.live){const t=Fi._getAutoroomTuijianSeatsHtml(uu.roomInfo);return window.$(".free-team-info-container").html(t),window.$(".free-team-content .autoroom-teams").addClass("hide"),void window.$(".free-team-info-container").removeClass("hide")}}}hideContent(t=!0){t&&uu.getMycarData()||(window.$(".free-team-content .autoroom-teams").removeClass("hide"),window.$(".free-team-info-container").addClass("hide"))}onEventListener(){const t=this;window.$(".chat-center-main").on("click",".free-team-slider",(function(){t.isOpen?(window.$(".free-team-content").addClass("hide"),window.$(".free-team-slider div").removeClass("close").addClass("open"),t.isOpen=!1):(window.$(".free-team-content").removeClass("hide"),window.$(".free-team-slider div").removeClass("open").addClass("close"),t.isOpen=!0,t.emit("update"))}))}onReset(){bu.empty()}onDestroy(){}}class ku{constructor(){this.showed=!1}static getInstance(){return this.instance||(this.instance=new ku),this.instance}register(t){const e=this;document.addEventListener("visibilitychange",(function(){document.hidden||e.showed||qt.get(Ot.getUid()).then((n=>{if(0==n.error){if(n.data.uid>Mt.maxUID&&uu.getMeid()>Mt.maxUID)return;uu.getMeid()!=n.data.uid&&(e.showed=!0,t&&t(),uu.globalDDSocket.leave(),uu.globalDDSocket.close(),window.$.DialogByZ.Alert({Title:"提示",Content:"当前窗口登录的账号发生改变，需要进行重新连接",BtnL:"同意",FunL:function(){window.location.reload()}}))}}))}))}}async function Cu(){return(await la((()=>import("./main-08e2031d.js")),["assets/main-08e2031d.js","assets/vendor-a26d429a.js","assets/vendor.1725411945463.b63fc2a0.css","assets/main.1725411945463.397c04cd.css"])).default}const Iu="activeTaskSvgKeyBorder",Su="activeTaskSvgKey";class Tu{static initFn(t){if(console.log("resData======="),console.log(t),this.initEvent(t),!t.has_task)return Zt.getInstance().clearPlayer(Iu),Zt.getInstance().clearPlayer(Su),$(".pc_background_svga").html(""),$(".pc_background_small_svga").html(""),void $(".activeTaskCtn").hide();let{delay:e=0,desc:n,desc_color:i,open_type:o,finish_num:s,pc_background_img:a,pc_background_small_img:r,pc_background_svga:c,pc_icon:l,pc_icon_background_svga:d,pc_url:m,prize_num:h,status:u,title:p,total_num:g,prize_num_font_border_color:f,pc_background_small_svga:w}=t;setTimeout((()=>{$(".activeTaskCtn .pc_background_img").css("background",`url(${a})`),$(".activeTaskCtn .pc_background_small_img").css("background",`url(${r})`),$(".activeTaskCtn .pc_icon .jb_icon").attr("src",l),$(".activeTaskCtn .leftIconCtn .wordCtn").text(h),$(".activeTaskCtn .rightCtn .subTitle").text(p),$(".activeTaskCtn .wordCtn").css("text-shadow",`0 -2px ${f}, 2px -2px ${f}, 2px 0 ${f}, 2px 2px ${f}, 0 2px ${f}, -2px 0 ${f}, -2px -2px ${f}`),u?($(".activeTaskCtn .rightCtn .innerChildCtn").html(`(<span class="finishedWord" style="color: ${i}">完成</span>)`),Zt.getInstance().playEver(".pc_background_svga",c,Iu),Zt.getInstance().playEver(".pc_background_small_svga",w,Iu)):(Zt.getInstance().clearPlayer(Iu),$(".pc_background_svga").html(""),$(".pc_background_small_svga").html(""),n?g>1&&$(".activeTaskCtn .rightCtn .innerChildCtn").html(`(<span class="" style="color: ${i}">${n}</span>)`):$(".activeTaskCtn .rightCtn .innerChildCtn").html("")),Zt.getInstance().playEver(".pc_icon_background_svga",d,Su),$(".activeTaskCtn").show()}),1e3*e)}static initEvent(t){$(".activeTaskCtn").off("click").on("click",(function(){if(!$(".activeTaskCtn").hasClass("close")){let{pc_url:e,open_type:n,status:i}=t,o="www.diandiankaihei.com",s="www-test.diandiankaihei.com";if(window.location.host==o&&(e=e.replaceAll("y.tuwan.com",o)),window.location.host==s&&(e=e.replaceAll("y-test.tuwan.com",s)),e.indexOf("open_store=true")>-1)kd.emitter.emit("showGiftWindow",0,"送麦上所有人","#666",0,0,0),setTimeout((()=>{window.$(".chat-center-gift-content").css("display","flex")}),500);else if(0==n)window.open(e);else if(1==n){let t={url:e,iframeWidth:"100%",iframeHeight:"100%"};i&&(t.iframeWidth="375px",t.iframeHeight="700px"),Ct.createIframe(t)}}})),$(".closeIcon").off("click").on("click",(function(){$(".activeTaskCtn").addClass("close"),$(".activeTaskCtn .closeIcon").hide()})),$(".leftIconCtn").off("click").on("click",(function(){setTimeout((()=>{$(".activeTaskCtn").removeClass("close")}),100),setTimeout((()=>{$(".activeTaskCtn .closeIcon").show()}),250)}))}}let Ru=0;class Mu{static canShowRooms(){return uu.isShengyouFreeRoom()||uu.isChorusRoom()||uu.isTruthRoom()||uu.isJiamianRoom()||uu.isHunLiRoom()||uu.isKtvSmallRoom()}static mineCanShow(){return uu.isKtvSmallRoom()?ad.getInstance().mineIsOwner():uu.isAnchoringUser(uu.getMeid())}static getAllFaceDom(){return uu.isKtvSmallRoom()?ad.getInstance().getAllFacesDom():window.$(".seat-item-empty[data-aposition=2]").find(".all_faces")}static checkVisible(){this.canShowRooms()&&this.mineCanShow()?qt.get(Ot.getAllFaces(uu.getCid())).then((t=>{if(0==t.error&&t.data.length>0){const e=this.getAllFaceDom();this.mineCanShow()&&(e&&0==e.children().length&&(e.append(t.data.map((t=>`<img src="${t.url}" data-name="${t.title}" data-id="${t.id}"/>`)).join("")),e.on("click","img",(function(t){t.stopPropagation();let e=(new Date).getTime();if(e-Ru>=1e3){const n=t.target.dataset.id,i=t.target.dataset.name;Xm.track3("emo_click",{emo_name:i,emo_id:n,all_microphone:"yes"}),qt.get(Ot.sendAllFaces(n,uu.getCid())),Ru=e}}))),e.removeClass("hide"))}})):this.getAllFaceDom().addClass("hide")}static showTextFace(t){const e=t.pic_list||[];Promise.all(e.map(((t,n)=>{const i=window.$(".seat-item-empty[data-aposition="+(n+2)+"] .seat-face-svga");return Zt.getInstance().loadParser(i[0],t,n==e.length-1?1:0,!0,"Forward",!1)}))).then((e=>{for(let n=0;n<e.length;n++){const{videoItem:i,player:o}=e[n];setTimeout((()=>{o.setVideoItem(i),o.startAnimation(),o.onFinished((()=>{e.forEach((({player:t})=>{t.stopAnimation(),t.clear()}))}))}),n*t.interval)}}))}}const{console:Au}=et,Pu="src/js/components/wishListEnter/index.svelte";function ju(t,e,n){const i=t.slice();return i[7]=e[n],i[9]=n,i}function Du(t){let e,n;function i(t,e){return t[2].length?Lu:Eu}let o=i(t),s=o(t);const a={c:function(){e=_("div"),n=_("div"),s.c(),y(n,"class","swiper-wrapper"),x(n,Pu,48,8,1371),y(e,"class","wishSwiperCtn swiper s-7p1Q8Fh9nUT4"),x(e,Pu,47,4,1306)},m:function(i,o){b(i,e,o),I(e,n),s.m(n,null),t[5](e)},p:function(t,e){o===(o=i(t))&&s?s.p(t,e):(s.d(1),s=o(t),s&&(s.c(),s.m(n,null)))},d:function(n){n&&C(e),s.d(),t[5](null)}};return p("SvelteRegisterBlock",{block:a,id:Du.name,type:"if",source:"(47:0) {#if visible}",ctx:t}),a}function Lu(t){let e,n=t[2];v(n);let i=[];for(let s=0;s<n.length;s+=1)i[s]=Bu(ju(t,n,s));const o={c:function(){for(let t=0;t<i.length;t+=1)i[t].c();e=ht()},m:function(t,n){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,n);b(t,e,n)},p:function(t,o){if(4&o){let s;for(n=t[2],v(n),s=0;s<n.length;s+=1){const a=ju(t,n,s);i[s]?i[s].p(a,o):(i[s]=Bu(a),i[s].c(),i[s].m(e.parentNode,e))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d:function(t){S(i,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Lu.name,type:"else",source:"(57:12) {:else}",ctx:t}),o}function Eu(t){let e,n,i,o;const s={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),o.textContent="暂无心愿单",y(n,"class","empty-bg s-7p1Q8Fh9nUT4"),x(n,Pu,51,20,1494),y(o,"class","noDataCtn s-7p1Q8Fh9nUT4"),x(o,Pu,52,20,1543),y(e,"class","swiper-slide s-7p1Q8Fh9nUT4"),x(e,Pu,50,16,1447)},m:function(t,s){b(t,e,s),I(e,n),I(e,i),I(e,o)},p:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:Eu.name,type:"if",source:"(50:12) {#if !data.length}",ctx:t}),s}function Bu(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,R,A,j,D,E,B,F=t[7].title+"",U=t[7].finish_num+"",z=t[7].total_num+"";const O={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),a=_("div"),r=M(F),c=T(),l=_("div"),d=_("span"),m=M(U),h=T(),u=_("span"),g=M("/"),f=M(z),w=T(),v=_("div"),$=_("img"),S=T(),R=_("div"),A=_("div"),j=T(),D=_("div"),B=T(),y(n,"class","empty-bg s-7p1Q8Fh9nUT4"),x(n,Pu,59,24,1778),y(a,"class","title s-7p1Q8Fh9nUT4"),x(a,Pu,62,32,1936),y(d,"class","redWord s-7p1Q8Fh9nUT4"),x(d,Pu,64,36,2064),y(u,"class","totalWord s-7p1Q8Fh9nUT4"),x(u,Pu,65,36,2147),y(l,"class","wordCtn s-7p1Q8Fh9nUT4"),x(l,Pu,63,32,2006),y(s,"class","leftCtn s-7p1Q8Fh9nUT4"),x(s,Pu,61,28,1882),L($.src,k=t[7].img)||y($,"src",k),y($,"alt",""),y($,"class","s-7p1Q8Fh9nUT4"),x($,Pu,69,32,2353),y(v,"class","rightCtn"),x(v,Pu,68,28,2298),y(A,"class","bg s-7p1Q8Fh9nUT4"),x(A,Pu,72,32,2503),y(D,"class","line s-7p1Q8Fh9nUT4"),y(D,"style",E=`width: ${t[7].finish_num/t[7].total_num*100}%`),x(D,Pu,73,32,2558),y(R,"class","progressCtn s-7p1Q8Fh9nUT4"),x(R,Pu,71,28,2445),y(o,"class","item-ctn s-7p1Q8Fh9nUT4"),x(o,Pu,60,24,1831),y(e,"class","swiper-slide s-7p1Q8Fh9nUT4"),x(e,Pu,58,20,1727)},m:function(t,p){b(t,e,p),I(e,n),I(e,i),I(e,o),I(o,s),I(s,a),I(a,r),I(s,c),I(s,l),I(l,d),I(d,m),I(l,h),I(l,u),I(u,g),I(u,f),I(o,w),I(o,v),I(v,$),I(o,S),I(o,R),I(R,A),I(R,j),I(R,D),I(e,B)},p:function(t,e){4&e&&F!==(F=t[7].title+"")&&P(r,F),4&e&&U!==(U=t[7].finish_num+"")&&P(m,U),4&e&&z!==(z=t[7].total_num+"")&&P(f,z),4&e&&!L($.src,k=t[7].img)&&y($,"src",k),4&e&&E!==(E=`width: ${t[7].finish_num/t[7].total_num*100}%`)&&y(D,"style",E)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:O,id:Bu.name,type:"each",source:"(58:16) {#each data as item, index}",ctx:t}),O}function Fu(t){let e,n=t[0]&&Du(t);const i={c:function(){n&&n.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){n&&n.m(t,i),b(t,e,i)},p:function(t,[i]){t[0]?n?n.p(t,i):(n=Du(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){n&&n.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:Fu.name,type:"component",source:"",ctx:t}),i}function Uu(t,e,n){let{$$slots:i={},$$scope:o}=e;f("WishListEnter",i,[]);let s,a,r=!0,c=[];function l(t,e){console.log("open==-"),console.log(t),t&&t.length?(null==a||a.destroy(),n(0,r=!0),n(2,c=t),setTimeout((()=>{a=new window.Swiper(s,{centeredSlides:!0,loop:!0,autoplay:{delay:e,disableOnInteraction:!1}})}),0)):t?(null==a||a.destroy(),n(2,c=t)):null==a||a.destroy()}function d(){n(0,r=!1)}w((()=>()=>null==a?void 0:a.destroy()));const m=[];return Object.keys(e).forEach((t=>{~m.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||Au.warn(`<WishListEnter> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({onMount:w,request:qt,ChatUrls:Ot,visible:r,swiperRef:s,data:c,swiper:a,open:l,close:d}),t.$inject_state=t=>{"visible"in t&&n(0,r=t.visible),"swiperRef"in t&&n(1,s=t.swiperRef),"data"in t&&n(2,c=t.data),"swiper"in t&&(a=t.swiper)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,s,c,l,d,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class zu extends h{constructor(t){super(t),u(this,t,Uu,Fu,g,{open:3,close:4}),p("SvelteRegisterComponent",{component:this,tagName:"WishListEnter",options:t,id:Fu.name})}get open(){return this.$$.ctx[3]}set open(t){throw new Error("<WishListEnter>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get close(){return this.$$.ctx[4]}set close(t){throw new Error("<WishListEnter>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class Ou{constructor({title:t,cb:e,style:n}){this.title=t,this.cb=e,this.style=n,this.alert=null}}function Nu(t,e="拒绝",n=""){return new Ou({title:e,cb:function(){this.alert.close(),t&&t()},style:"margin-right: 20px; width: 100px; line-height: 40px; border-radius: 40px; border: 1px solid #C3C4D6; text-align: center; font-size: 16px; font-weight: 500; color: #C3C4D6; cursor: pointer;"+n})}function qu(t,e="同意",n=""){return new Ou({title:e,cb:function(){this.alert.close(),t&&t()},style:"width: 100px; line-height: 40px; border-radius: 40px; background: #FF6691; text-align: center; font-size: 16px; font-weight: 500; color: white; cursor: pointer;"+n})}class Gu{constructor({title:t="邀请组队",des:e="",tips:n="",buttons:i=[],zIndex:o=0,closeCb:s}){this.title=t,this.des=e,this.tips=n,this.buttons=i,this.closeCb=s,this.id=null,this.ele=null,this.zIndex=o,i.forEach((t=>t.alert=this))}show(){this.ele=window.$(`\n            <div class="flex flex-ac flex-jc" style="position: fixed; left: 0; top: 0; right: 0; bottom: 0; z-index: ${this.zIndex}; background-color: rgba(0, 0, 0, 0.6);">\n                <div style="padding: 15px 22px; width: 275px; background: #FFFFFF; border-radius: 10px;">\n                    <p style="line-height: 28px; text-align: center; font-size: 20px; font-weight: 600; color: #FA7399;">${this.title}</p>\n                    <p style="margin-top: 35px; font-size: 15px; font-weight: 400; color: #666666; line-height: 21px;">${this.des}</p>\n                    <div class="buttons flex flex-jc" style="margin-top: 26px;">\n                        ${this.buttons.map((t=>`<p style="${t.style}" data-title="${t.title}">${t.title}</p>`)).join("")}\n                    </div>\n                    ${this.tips?`<p style="text-align: center; margin-top: 6px; font-size: 12px; color: #999999;">${this.tips}</p>`:""}\n                </div>\n            </div>\n        `),window.$("body").append(this.ele);const t=this;this.ele.on("click",".buttons p",(function(){const e=t.buttons.find((t=>t.title===this.dataset.title));e&&e.cb&&e.cb()}))}close(t=!0){this.ele.remove(),t&&this.closeCb&&this.closeCb(this)}}class Vu{constructor(){this.queue=[]}static getInstance(){return this.instance||(this.instance=this.newClass()),this.instance}static newClass(){return new Vu}getButtons(t){return[]}push(t){let{title:e,content:n,user_icon:i,user_name:o,user_name_color:s,tips:a}=t;n=n.replace("user_icon user_name","");const r=new Gu({title:e,des:`${i?`<img style="height: 16px; margin-right: 4px;" src="${i}"/>`:""}<span style="color: ${s};">${o}</span>${n}`,tips:a,buttons:this.getButtons(t)});r.closeCb=this.closeAlert.bind(this),r.show(),this.show(),this.queue.push(r),this.updateZIndex()}updateZIndex(){for(var t=0;t<this.queue.length;t++){const e=this.queue[t];window.$(e.ele[0]).css("z-index",`${1e3+t}`)}}closeAlert(t){const e=this.queue.findIndex((e=>e===t));e>=0&&this.queue.splice(e,1)}onReset(){for(var t of this.queue)t.close(!1);this.queue=[]}}class Hu extends Vu{static newClass(){return new Hu}show(){Xm.track(uu.getAnalyticsData("new_user_beInvite_alert",{windowtype:"open"}))}getButtons(t){return[qu(this.onButtonClick,"确定","width: 260px;")]}onButtonClick(){Xm.track(uu.getAnalyticsData("new_user_beInvite_alert",{windowtype:"close"}))}}class Wu{constructor(){this.queue=[]}static getInstance(){return this.instance||(this.instance=new Wu),this.instance}push(t){const{invite_uid:e,title:n,msg:i,nickname:o}=t,s=this.queue.findIndex((t=>t.id===e));if(s>=0){const t=this.queue[s];this.queue.splice(s,1),this.queue.push(t)}else{const t=new Gu({title:n,des:`<span style="color: #FF6691;">“${o}”</span>${i}`,buttons:[Nu(a.bind(null,"2")),qu(a.bind(null,"1"))]});t.id=e,t.closeCb=this.closeAlert.bind(this),t.show(),this.queue.push(t)}function a(t){qt.get(Ot.groupOperating(uu.getCid(),e,t)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}this.updateZIndex()}updateZIndex(){for(var t=0;t<this.queue.length;t++){const e=this.queue[t];window.$(e.ele[0]).css("z-index",`${1e3+t}`)}}closeAlert(t){const e=this.queue.findIndex((e=>e===t));e>=0&&this.queue.splice(e,1)}onReset(){for(var t of this.queue)t.close(!1);this.queue=[]}}class Ku{constructor(){this.instance=null,this.cp_info={},this.initModalCss(),this.initModalHtml()}static getInstance(){return this.instance||(this.instance=new Ku),this.instance}initModalCss(){window.$("head").append("<style>\n                        .love_modal_f{display:flex}\n                        .love_modal_f_c{display:flex;align-items:center;justify-content:center;}\n                        .love_bind_mask{display:none;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.6);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .love_bind_content{position: relative;width:623px;height:496px;background:url(https://asset.tuwan.com/activity/2022vday/love_day_invite_modal.png);text-align:center;font-size:22px;color:#ffbfff}\n                        .love_bind_close{position: absolute;width: 58px;height: 57px;background: url(https://asset.tuwan.com/activity/2021sparty/up_close.png) no-repeat center center;right: -50px;top: -30px;cursor: pointer;}\n                        .km_cp_content {align-items: center;margin-top:100px}\n                        .km_common_info {text-align: center;font-size: 16px;}\n                        .km_common_header {width: 200px;height: 200px;position: relative;text-align: center;}\n                        .km_avatar_bg {width: 210px;position: absolute;z-index: 9;}\n                        .km_avatar {width: 174px;height: 174px;border-radius: 50%;z-index: 1;}\n                        .km_heart {margin: 0 20px;}\n                        .km_cp_name {font-size: 22px;font-weight: bold;margin-bottom: 4px;}\n                        .love_bind_tips{margin:30px auto}\n                        .love_agree_btn{cursor: pointer;}\n                    </style>")}initModalHtml(){window.$("body").append('<div class="love_bind_mask">\n                        <div class="love_bind_content">\n                            <div class="love_bind_close"></div>\n                            <div class="km_cp_content love_modal_f_c"></div>\n                            <div class="love_bind_tips">对方向你发起了爱情日CP绑定申请</div>\n                            <img class="love_agree_btn " src="https://asset.tuwan.com/activity/2022vday/agree_btn.png">\n                        </div>\n                    </div>'),this.initModalEvent()}openBindCp(t){window.$(".love_bind_mask").css("display","flex");const e=t.custom.cp_info;this.cp_info=e;let n=`<div class="km_common_info">\n                    <div class="km_common_header love_modal_f_c" style="width: 150px;height: 150px;">\n                        <img class="km_avatar_bg" src="https://activity-static.tuwan.com/static/png/20211230/00a75d982c801ccda0894a17cae5ddbe.png" style="width: 150px;height: 150px;">\n                        <img class="km_avatar" src="${e[0].avatar}" style="width: 110px;height: 110px;">\n                    </div>\n                    <div class="km_cp_name">${e[0].nickname}</div>\n                </div>\n                <div class="love_img_content love_modal_f_c">\n                    <img class="km_heart" style="width: 50px;margin-top:30px" src="https://asset.tuwan.com/activity/2022vday/cp_heart.png">\n                </div>\n                <div class="km_common_info">\n                    <div class="km_common_header love_modal_f_c" style="width: 150px;height: 150px;">\n                        <img class="km_avatar_bg" src="https://activity-static.tuwan.com/static/png/20211230/4daec65e37e61d6dd460abc76255b9e2.png" style="width: 150px;height: 150px;">\n                        <img class="km_avatar" src="${e[1].avatar}" style="width: 110px;height: 110px;">\n                    </div>\n                    <div class="km_cp_name">${e[1].nickname}</div>\n                </div>`;window.$(".km_cp_content").html(n)}initModalEvent(){let t=this;window.$(".love_bind_mask").on("click",".love_bind_close",(function(){window.$(".love_bind_mask").hide()})),window.$(".love_bind_mask").on("click",".love_agree_btn",(function(){qt.get(`${Dt}/activity2022/agreeBindCp?id=401&cp_uid=${t.cp_info[0].uid}`).then((t=>{0==t.error&&window.$(".love_bind_mask").hide(),Vt(t.error_msg)}))}))}}class Yu{constructor(t,e,n){this.giftCount=t,this.key=e,this.currentIndex=1,this.currentCycle=0,this.cycles=2,this.speed=120,this.classPrefix=n,this.timer=0}start(){return new Promise(((t,e)=>{this.resolve=t,this.reject=e,this.init()}))}init(){window.$(`${this.classPrefix}`).removeClass("active"),window.$(`${this.classPrefix}_${this.currentIndex}`).addClass("active"),this.upSpeed(),this.downSpeed(),this.currentIndex+=1,this.currentIndex=this.currentIndex>this.giftCount?1:this.currentIndex}upSpeed(){this.currentCycle<1&&this.speed>100&&(this.speed-=5*this.currentIndex,this.stop(),this.run())}downSpeed(){this.currentIndex===this.giftCount&&(this.currentCycle+=1),this.currentCycle>this.cycles-1&&this.speed<300&&(this.speed+=50,this.stop(),this.run()),this.currentCycle>this.cycles&&this.currentIndex==this.key&&(this.stop(),this.resolve(this.key))}stop(){clearInterval(this.timer)}run(){this.timer=setInterval((()=>{this.init()}),this.speed)}}class Ju{constructor(){this.initStyle(),this.initChannelStarAwardModal(),this.cid=null,this.star=null,this.award_star=null,this.emitter=new Ht,this.taskArr=[],this.awardId=[],this.timer=null,this.cilickTime=0,this.weekArr=["周一","周二","周三","周四","周五","周六","周日"],this.currentStar=0,this.popType=0,this.jumpUrl="",this.taskFrameId="",this.max_star=0}static getInstance(){return this.instance||(this.instance=new Ju),this.instance}initStyle(){window.$("head").append("<style>\n                        .ygb_flex{display:flex}\n                        .ygb_flex_align_c{display:flex;align-items:center}\n                        .ygb_flex_c{display:flex;align-items:center;justify-content:center}\n                        .channel_task_star{display:flex;position:absolute;top:12px;left:12px;justify-content:space-between;cursor:pointer;z-index:10}\n                        .channel_task_star img{margin-right: 4px}\n                        .channel_task_common_modal{width:100%;height:100%;background:rgba(0, 0, 0, 0.6);top:0;left:0;z-index:100;position:fixed;display:none;align-items:center;justify-content:center;}\n                        .channel_task_common_modal>div{box-sizing:border-box}\n                        .channel_common_content{ display: none;position:relative }\n                        .channel_star_lottery_content{display:none;flex-direction: column;align-items: center;}\n                        .channel_to_lottery{cursor:pointer;}\n                        .channel_common_star{display:none}\n                        .channel_star_close,.channel_task_close{position:absolute;right:-44px;top:-18px;cursor:pointer;}\n                        .channel_task_content{position:relative;}\n                        .channel_task_bg{position:absolute;z-index:100;pointer-events: none;display:none}\n                        .channel_task_detail{position:relative;background:#fff;border-radius:20px;padding:18px;left:21px;top:17px}\n                        .channel_task_top_content{width:506px;height:94px;margin:0 auto;border-radius:6px;border:2px solid #ffe5eb;justify-content:space-around;margin-bottom:10px;text-align:center;color:#808080;}\n                        .channel_task_top_content .today_content{color: #333}\n                        .channel_task_bottom_content{width:506px;height:532px;margin:0 auto;border-radius:6px;border:2px solid #ffe5eb;}\n                        .channel_task_top_item{width:60px;height:48px;border-radius:8px;background:#ececec;color:#808080;font-size:14px;line-height:48px}\n                        .channel_task_top_item.active{background:#ff677f url(https://res.tuwan.com/templet/play/chat/chatv2/images/white_star.png) no-repeat 10px 4px;color:#ff6079}\n                        .channel_task_top_item.pass{background:#ff677f;color:#fff}\n                        .channel_task_bottom_title{font-size:16px;color:#333333;font-weight:bold;margin:16px 0;}\n                        .channel_task_bottom_title .line{width:178px;height:1px;background:#cecece;margin:0 20px;}\n                        .channel_task_star_nav{font-size:12px;color:#fff}\n                        .channel_task_star_nav .nav_star_content{width:52px;height:52px;background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/pink_big_star.png) no-repeat center center;background-size:42px 40px;text-align:center;line-height:50px;cursor:pointer;}\n                        .channel_task_star_nav .nav_star_content.select{background-size:52px 50px}\n                        .channel_task_star_nav .short_line{width:26px;height:1px;background:#ffe5eb;margin:0 16px}\n                        .channel_task_star_nav .long_line{width:66px;height:1px;background:#ffe5eb;margin:0 16px}\n                        .channel_task_star_title{color:#333;font-size:14px;text-indent:6px;margin-left:22px;margin-top:18px;font-weight:bold}\n                        .channel_task_star_title .channel_task_icon{background:#ff5588;width:3px;height:15px;margin-right:2px}\n                        .common_progress_item{width:340px;height:12px;border-radius:6px;display:block;overflow:hidden;margin-top:2px}\n                        .task_content_progress{width:372px;margin-top:36px}\n                        .common_progress_item::-webkit-progress-bar{background-color:#ddd;border-radius:6px}\n                        .common_progress_item::-webkit-progress-value{background:#ff669a;border-radius:6px}\n                        .common_progress_item::-moz-progress-bar{background:#ddd;border-radius:6px}\n                        .channel_task_info{margin-top:24px;font-size:14px;color:#666;margin-bottom:32px}\n                        .channel_task_info_item .task_icon{width:40px;margin:0 12px 0 22px }\n                        .channel_task_info_item{margin-bottom:12px;align-items: flex-end;}\n                        .channel_task_info_item .channel_task_progress_info{margin-left:8px}\n                        .channel_task_star_content{position:relative;justify-content:center;width:460px;height:110px;box-sizing:border-box;margin:0 auto;margin-top:14px;background:#f2f2f2;border-radius:6px}\n                        .channel_task_gift_content{position:absolute;top:0;left:0;color:#ff669a;font-size:14px;width:100%;height:100%;justify-content: flex-end;}\n                        .channel_task_gift_content .max_gift_pic{width:60px;height:60px}\n                        .channel_task_gift_content .max_gift_pic img{width:60px;}\n                        .channel_task_gift_content>div{width:30%;flex-direction: column;}\n                        .channel_lottery_content{width:479px;height:643px;padding-top:160px;}\n                        .channel_lottery_content .channel_lottery_detail{height:470px;overflow-y:auto}\n                        .channel_lottery_detail::-webkit-scrollbar-track{background-color: transparent;}\n\t                    .channel_lottery_detail::-webkit-scrollbar{width: 8px;}\n                        .channel_lottery_detail::-webkit-scrollbar-thumb{border-radius: 8px;background-color: #b769f7;}\n                        .channel_lottery_close{position:absolute;right:-33px;top:56px;cursor:pointer;}\n                        .channel_lottery_info_content{width:466px;height:394px;background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/channel_lottery_info_content.png);margin:0 auto;padding-top:30px;padding-bottom:60px;box-sizing:border-box;flex-wrap:wrap}\n                        .channel_lottery_rule{width:428px;background:#fff;color:#666666;font-size:12px;padding:15px;margin:0 auto;border-radius:15px;margin-top:10px;box-sizing:border-box}\n                        .channel_lottery_rule_title{font-size:16px;color:#333333}\n                        .channel_lottery_rule_title span{margin:0 10px}\n                        .lottery_rule_index{width:14px;height:14px;background:#ffc0cf;border-radius:14px;text-align:center;line-height:14px;color:#fff;margin-right:10px}\n                        .channel_lottery_rule_content>div{margin-top:10px}\n                        .lottery_rule_text{width:370px;}\n                        .channel_lottery_gift_item{width:128px;height:100px;background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/channel_gift_item_bg.png);color:#ff7c61;font-size:12px;flex-direction: column;}\n                        .channel_lottery_gift_item .lottery_gift_icon {width:60px;height:60px}\n                        .channel_lottery_gift_item .lottery_gift_icon img {max-width:60px;max-height:60px}\n                        .channel_lottery_gift_item.active{background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/channel_gift_item_active_bg.png?v=1);}\n                        .channel_lottery_draw_btn{width:128px;height:100px;background:url(https://res.tuwan.com/templet/play/chat/chatv2/images/channel_lottery_draw_btn.png) no-repeat center top;color:#ff5588;font-size:12px;cursor:pointer;background-size:76%;line-height:116px;text-align: center;font-weight:bold}\n                        .channel_lottery_user_win{width:428px;height:100px;background:#fff;border-radius:15px;font-size:14px;color:#666666;margin:0 auto;margin-top:-30px;box-sizing:border-box;padding-left:22px;padding-top:1px;overflow:hidden}\n                        .channel_lottery_user_win div{height:20px;margin-top:10px}\n                        .channel_lottery_user_win span{color:#ff6691}\n                        </style>")}initChannelStar(t,e){this.cid=t,this.channel=e,qt.get(`${Dt}/chatroomstar/nowStar?cid=${t}`).then((t=>{0==t.error?(this.max_star=t.data.max_star,this.updateChannelStar(t.data),window.$(".channel_task_star").css("display","flex")):window.$(".channel_task_star").hide()}))}updateChannelStar(t,e){let{star:n,award_star:i,starup_time:o,h5_popup_type:s,pc_url_new:a,new_star:r}=t;this.star=n,this.award_star=i,this.currentStar=0==n?1:1==n?3:5;let c="";for(let d=0;d<this.max_star;d++)c+=d<r?'<img src="https://res.tuwan.com/templet/play/chat/chatv2/images/task_star_active.png">':'<img src="https://res.tuwan.com/templet/play/chat/chatv2/images/task_star.png">';if(window.$(".channel_task_star").html(c),this.popType=s,"push"!=e&&(this.jumpUrl=a),2==s)return;let l=null;switch(n){case 1:l=20;break;case 3:l=60;break;case 5:l=100}if(window.$(".task_content_progress").attr("value",l),window.$(".channel_common_content").hide(),1==i){if(window.$(".channel_star_5").hide(),window.$(".channel_star_3").hide(),window.$(".willopenModal").show(),window.$(".channel_star_red_content").show(),window.$(".willopenModal .ownerPic").attr("src",uu.getRoomInfo().img_cover),window.$(".whospacket").hide(),0==o)window.$(".grabPacket").html("抢"),window.$(".grabPacket").attr("data-type","1"),window.$(".grabPacket").attr("data-cid",this.cid);else{const t=this;window.$(".grabPacket").html(`${o}s`);let e=setInterval((function(){o-=1,0==o?(window.$(".grabPacket").html("抢"),window.$(".grabPacket").attr("data-type","1"),window.$(".grabPacket").attr("data-cid",t.cid),clearInterval(e)):window.$(".grabPacket").html(`${o}s`)}),1e3)}window.$(".red_packet_desc").show(),window.$(".packet-nickname").html(""),window.$(".channel_task_common_modal").css("display","flex")}else 3==i?(window.$(".channel_star_5").hide(),window.$(".willopenModal").hide(),window.$(".channel_star_3").show(),window.$(".channel_star_lottery_content").css("display","flex"),window.$(".channel_task_common_modal").css("display","flex"),window.$(".channel_to_lottery").attr("data-star","3")):5==i&&(window.$(".channel_star_3").hide(),window.$(".willopenModal").hide(),window.$(".channel_star_5").show(),window.$(".channel_star_lottery_content").css("display","flex"),window.$(".channel_task_common_modal").css("display","flex"),window.$(".channel_to_lottery").attr("data-star","5"))}initChannelStarAwardModal(){window.$("body").append('<div class="channel_task_common_modal">\n                                            <div class="channel_star_red_content channel_common_content"></div>\n                                            <div class="channel_star_lottery_content channel_common_content">\n                                                <img class="channel_close channel_star_close" src="https://res.tuwan.com/templet/play/chat/chatv2/images/channel_star_close.png">\n                                                <img class="channel_star_3 channel_common_star" src="https://res.tuwan.com/templet/play/chat/chatv2/images/channel_star_3.png">\n                                                <img class="channel_star_5 channel_common_star" src="https://res.tuwan.com/templet/play/chat/chatv2/images/channel_star_5.png">\n                                                <img class="channel_to_lottery" src="https://res.tuwan.com/templet/play/chat/chatv2/images/to_take_gift.png">\n                                                </div>\n                                            <div class="channel_task_content channel_common_content">\n                                                <img class="channel_task_bg" src="https://asset.tuwan.com/activity/ice/chat_task.png">\n                                                <img class="channel_close channel_task_close" src="https://res.tuwan.com/templet/play/chat/chatv2/images/channel_star_close.png">\n                                                <div class="channel_task_detail">\n                                                    <div class="channel_task_top_content ygb_flex_align_c"></div>\n                                                    <div class="channel_task_bottom_content">\n                                                        <div class="channel_task_bottom_title ygb_flex_c">\n                                                            <div class="line"></div>\n                                                            <div>厅任务</div>\n                                                            <div class="line"></div>\n                                                        </div>\n                                                        <div class="channel_task_star_nav ygb_flex_c">\n                                                            <div class="short_line"></div>\n                                                            <div class="nav_star_content" data-star="1">1星</div>\n                                                            <div class="long_line"></div>\n                                                            <div class="nav_star_content" data-star="3">3星</div>\n                                                            <div class="long_line"></div>\n                                                            <div class="nav_star_content" data-star="5">5星</div>\n                                                            <div class="short_line"></div>\n                                                        </div>\n                                                        <div class="channel_task_star_title ygb_flex_align_c">\n                                                            <div class="channel_task_title">3星任务</div>\n                                                        </div>\n                                                        <div class="channel_task_info">\n\n                                                        </div>\n                                                        <div class="channel_task_star_title ygb_flex_align_c">\n                                                            <div>任务奖励</div>\n                                                        </div>\n                                                        <div class="channel_task_star_content ygb_flex">\n                                                            <progress class="common_progress_item task_content_progress" max="100" value="50"></progress>\n                                                            <div class="channel_task_gift_content ygb_flex"></div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <div class="channel_lottery_content channel_common_content">\n                                                <img class="channel_lottery_close channel_close" src="https://res.tuwan.com/templet/play/chat/chatv2/images/channel_star_close.png">\n                                                <div class="channel_lottery_detail">\n                                                    <div class="channel_lottery_info_content ygb_flex_c">\n                                                        <div class="channel_lottery_gift_item_1 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_2 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_3 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_8 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_draw_btn"></div>\n                                                        <div class="channel_lottery_gift_item_4 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_7 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_6 channel_lottery_gift_item ygb_flex_c"></div>\n                                                        <div class="channel_lottery_gift_item_5 channel_lottery_gift_item ygb_flex_c"></div>\n                                                    </div>\n                                                    <div class="channel_lottery_user_win"></div>\n                                                    <div class="channel_lottery_rule">\n                                                        <div class="channel_lottery_rule_title ygb_flex_c">\n                                                            <img src="https://res.tuwan.com/templet/play/chat/chatv2/images/lottery_rule_title_1.png">\n                                                            <span>抽奖规则</span>\n                                                            <img src="https://res.tuwan.com/templet/play/chat/chatv2/images/lottery_rule_title.png">\n                                                        </div>\n                                                        <div class="channel_lottery_rule_content"></div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>'),this.initChannelEvents()}initChannelTask(){qt.get(`${Dt}/chatroomstar/weekStar?cid=${this.cid}`).then((t=>{const{week_star:e,today_index:n,task:i,award:o}=t;this.star=this.currentStar,this.taskArr=i;let s="",a="";e.forEach(((t,e)=>{const i=t.star;s+=`<div class="${e==n?"today_content":""}"><div class="channel_task_top_item ${e>n?"":0==i?"pass":"active"}">${e>n?"未开始":0==i?"未完成":`${i}星`}</div><div class="wee_info">${t.date_str}</div></div>`})),window.$(".channel_task_top_content").html(s),o.forEach((t=>{const{title:e,icon:n}=t;a+=`<div class="ygb_flex_c">\n                                    <div class="ygb_flex_c max_gift_pic">\n                                        <img src="${n}">\n                                    </div>\n                                    <div>${e}</div>\n                                </div>`})),window.$(".channel_task_gift_content").html(a),this.renderStarTaskInfo(i),window.$(".nav_star_content").removeClass("select");let r=0==this.star?1:this.star;window.$(`.nav_star_content[data-star="${r}"]`).addClass("select"),window.$(".channel_task_content .channel_task_title").html(`${r}星任务`)}))}renderStarTaskInfo(){let t="",e=null;switch(this.star){case 0:case 1:e=0;break;case 3:e=1;break;case 5:e=2}this.taskArr[e].forEach((e=>{const{max:n,now:i,progress:o,title:s,unit:a,icon:r}=e;0!==n&&(t+=`<div class="ygb_flex channel_task_info_item">\n                                        <div class="task_icon ygb_flex_c">\n                                            <img src="${r}">\n                                        </div>\n                                        <div>\n                                            <div>${s}</div>\n                                            <progress class="common_progress_item" max="100" value="${o}"></progress>\n                                        </div>\n                                        <div class="channel_task_progress_info">${i+a}/${n+a}</div>\n                                    </div>`)})),window.$(".channel_task_info").html(t)}renderLotteryInfo(t,e){qt.get(`${Dt}/Chatroomtask/awardlist?cid=${this.cid}&star=${t}`).then((t=>{const{award_num:n,award_left_num:i,arards:o,rule:s,record:a}=t.data;1!=e&&(this.renderLotteryRule(s),this.renderArardsData(o)),this.renderLotteryRecord(a)}))}renderArardsData(t){this.awardId=[],t.forEach(((t,e)=>{const{award_id:n,award_name:i,url:o}=t;this.awardId.push(n);let s=`<div class="lottery_gift_icon ygb_flex_c"><img src="${o}"></div><div>${i}</div>`;window.$(`.channel_lottery_gift_item_${e+1}`).html(s)}))}renderLotteryRule(t){let e="";t.forEach(((t,n)=>{e+=`<div class="ygb_flex">\n                            <div class="lottery_rule_index">${n+1}</div>\n                            <div class="lottery_rule_text">${t}</div>\n                        </div>`})),window.$(".channel_lottery_rule_content").html(e)}renderLotteryRecord(t){let e=window.$(".channel_lottery_user_win"),n="";t.forEach(((t,e)=>{const{uname:i,star:o,award_name:s,arawd_num:a}=t;n+=`<div>${i} 领取${o}星奖励 获得<span>${s}x${a}</span></div>`})),t.length>3?e.html(n+n):e.html(n),this.timer=setInterval((function(){e[0].scrollTop>=e[0].scrollHeight/2?e[0].scrollTop=0:e[0].scrollTop+=1}),100)}initChannelEvents(){const t=this,e=window.$(".channel_task_common_modal"),n=window.$(".channel_task_content"),i=window.$(".channel_common_content"),o=window.$(".channel_star_lottery_content"),s=window.$(".channel_lottery_content");window.$(".channel_task_star").on("click",(function(){if(1==t.popType)e.css("display","flex"),n.show(),t.initChannelTask();else{const e={url:t.jumpUrl,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(e).then((e=>{t.taskFrameId=e}))}})),e.on("click",".channel_close",(function(){i.hide(),e.hide(),clearInterval(t.timer)})),n.on("click",".nav_star_content",(function(){const e=this.dataset.star;e!=t.star&&(window.$(".nav_star_content").removeClass("select"),window.$(this).addClass("select"),t.star=1*e,t.renderStarTaskInfo(),n.find(".channel_task_title").html(`${e}星任务`))})),o.on("click",".channel_to_lottery",(function(){o.hide(),s.show();const e=this.dataset.star;s.css("background",`url(https://res.tuwan.com/templet/play/chat/chatv2/images/lottery_content_${e}.png)`),t.renderLotteryInfo(e),window.$(".channel_lottery_draw_btn").html((3==e?9.8:19.8)+"点点币")})),s.on("click",".channel_lottery_draw_btn",(function(){qt.get(`${Dt}/Chatroomtask/award?cid=${t.cid}&star=${t.award_star}`).then((e=>{if(0==e.error){const{award_id:n,id:i,uid:o,award:s,num:a}=e.data;let r=t.awardId.indexOf(n)+1;new Yu(8,r,".channel_lottery_gift_item").start().then((()=>{Vt(`获得了${s}x${a}`),t.renderLotteryInfo(t.award_star,1)}))}else if(-2==e.error){let e=3==t.award_star?9.8:19.8;const n={typeid:2001,money:e};Hi.payQRCode(n,100*e)}else Vt(e.error_msg)}))}))}}const Qu=0,Xu=1,Zu=2,tp="src/js/chorusRoom/musicLibrary/music.svelte";function ep(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g=t[0].name+"",f=t[0].singer+"";d=new ye({props:{src:"https://res.tuwan.com/chatroom/images/icon_song_playing.gif"},$$inline:!0});const w=t[3].default,v=ct(w,t,t[2],null),$={c:function(){e=_("div"),n=_("div"),i=_("p"),o=M(g),s=T(),a=_("div"),r=_("p"),c=M(f),l=T(),U(d.$$.fragment),m=T(),v&&v.c(),y(i,"class","name s-rC1O3fNyDHKV"),x(i,tp,9,8,163),y(r,"class","singer s-rC1O3fNyDHKV"),x(r,tp,11,12,242),y(a,"class","flex flex-ac"),x(a,tp,10,8,203),x(n,tp,8,4,149),y(e,"class",h="music "+t[1]+" s-rC1O3fNyDHKV"),x(e,tp,7,0,119)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,h){b(t,e,h),I(e,n),I(n,i),I(i,o),I(n,s),I(n,a),I(a,r),I(r,c),I(a,l),z(d,a,null),I(e,m),v&&v.m(e,null),u=!0},p:function(t,[n]){(!u||1&n)&&g!==(g=t[0].name+"")&&P(o,g),(!u||1&n)&&f!==(f=t[0].singer+"")&&P(c,f),v&&v.p&&(!u||4&n)&&lt(v,w,t,t[2],u?mt(w,t[2],n,null):dt(t[2]),null),(!u||2&n&&h!==(h="music "+t[1]+" s-rC1O3fNyDHKV"))&&y(e,"class",h)},i:function(t){u||(q(d.$$.fragment,t),q(v,t),u=!0)},o:function(t){O(d.$$.fragment,t),O(v,t),u=!1},d:function(t){t&&C(e),G(d),v&&v.d(t)}};return p("SvelteRegisterBlock",{block:$,id:ep.name,type:"component",source:"",ctx:t}),$}function np(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Music",i,["default"]);let{data:s={}}=e,{cls:a=""}=e;const r=["data","cls"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Music> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data),"cls"in t&&n(1,a=t.cls),"$$scope"in t&&n(2,o=t.$$scope)},t.$capture_state=()=>({Img:ye,data:s,cls:a}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"cls"in t&&n(1,a=t.cls)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,o,i]}class ip extends h{constructor(t){super(t),u(this,t,np,ep,g,{data:0,cls:1}),p("SvelteRegisterComponent",{component:this,tagName:"Music",options:t,id:ep.name})}get data(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get cls(){throw new Error("<Music>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set cls(t){throw new Error("<Music>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const op="src/js/chorusRoom/musicLibrary/musics.svelte";function sp(t,e,n){const i=t.slice();return i[8]=e[n],i}function ap(t){let e,n,i,o,s,a,r=t[8]._title+"";const c={c:function(){e=_("p"),n=M(r),o=T(),y(e,"class",i="btn "+t[8]._titleCls),x(e,op,68,12,1834)},m:function(i,r){b(i,e,r),I(e,n),b(i,o,r),s||(a=E(e,"click",(function(){H(t[0].bind(null,t[8]))&&t[0].bind(null,t[8]).apply(this,arguments)}),!1,!1,!1,!1),s=!0)},p:function(o,s){t=o,4&s&&r!==(r=t[8]._title+"")&&P(n,r),4&s&&i!==(i="btn "+t[8]._titleCls)&&y(e,"class",i)},d:function(t){t&&C(e),t&&C(o),s=!1,a()}};return p("SvelteRegisterBlock",{block:c,id:ap.name,type:"slot",source:"(68:8) <Music data={item} cls={item._muiscCls}>",ctx:t}),c}function rp(t){let e,n;e=new ip({props:{data:t[8],cls:t[8]._muiscCls,$$slots:{default:[ap]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.data=t[8]),4&n&&(i.cls=t[8]._muiscCls),2053&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:rp.name,type:"each",source:"(67:4) {#each realData as item}",ctx:t}),i}function cp(t){let e,n,i=t[2];v(i);let o=[];for(let r=0;r<i.length;r+=1)o[r]=rp(sp(t,i,r));const s=t=>O(o[t],1,1,(()=>{o[t]=null})),a={c:function(){for(let t=0;t<o.length;t+=1)o[t].c();e=ht()},m:function(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);b(t,e,i),n=!0},p:function(t,n){if(5&n){let a;for(i=t[2],v(i),a=0;a<i.length;a+=1){const s=sp(t,i,a);o[a]?(o[a].p(s,n),q(o[a],1)):(o[a]=rp(s),o[a].c(),q(o[a],1),o[a].m(e.parentNode,e))}for(W(),a=i.length;a<o.length;a+=1)s(a);N()}},i:function(t){if(!n){for(let t=0;t<i.length;t+=1)q(o[t]);n=!0}},o:function(t){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)O(o[e]);n=!1},d:function(t){S(o,t),t&&C(e)}};return p("SvelteRegisterBlock",{block:a,id:cp.name,type:"slot",source:'(66:0) <ScrollView class=\\"musics\\" {scrollBottomCb}>',ctx:t}),a}function lp(t){let e,n;e=new Va({props:{class:"musics",scrollBottomCb:t[1],$$slots:{default:[cp]},$$scope:{ctx:t}},$$inline:!0});const i={c:function(){U(e.$$.fragment)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){z(e,t,i),n=!0},p:function(t,[n]){const i={};2&n&&(i.scrollBottomCb=t[1]),2053&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:lp.name,type:"component",source:"",ctx:t}),i}function dp(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Musics",i,[]);const s=nw.getInstance();let{data:a}=e,{clickMuiscCb:r}=e,{menuType:c}=e,{scrollBottomCb:l}=e;function d(){n(6,m+=1)}let m=0,h=a;t.$$.on_mount.push((function(){void 0!==a||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Musics> was created without expected prop 'data'"),void 0!==r||"clickMuiscCb"in e||t.$$.bound[t.$$.props.clickMuiscCb]||console.warn("<Musics> was created without expected prop 'clickMuiscCb'"),void 0!==c||"menuType"in e||t.$$.bound[t.$$.props.menuType]||console.warn("<Musics> was created without expected prop 'menuType'"),void 0!==l||"scrollBottomCb"in e||t.$$.bound[t.$$.props.scrollBottomCb]||console.warn("<Musics> was created without expected prop 'scrollBottomCb'")}));const u=["data","clickMuiscCb","menuType","scrollBottomCb"];return Object.keys(e).forEach((t=>{~u.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Musics> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(3,a=t.data),"clickMuiscCb"in t&&n(0,r=t.clickMuiscCb),"menuType"in t&&n(4,c=t.menuType),"scrollBottomCb"in t&&n(1,l=t.scrollBottomCb)},t.$capture_state=()=>({Music:ip,MENU_TYPE_SELECTED:2,ORDER_TYPE_1:1,ChorusRoom:nw,ScrollView:Va,instance:s,data:a,clickMuiscCb:r,menuType:c,scrollBottomCb:l,forceUpdate:d,forceUpdateIndex:m,realData:h}),t.$inject_state=t=>{"data"in t&&n(3,a=t.data),"clickMuiscCb"in t&&n(0,r=t.clickMuiscCb),"menuType"in t&&n(4,c=t.menuType),"scrollBottomCb"in t&&n(1,l=t.scrollBottomCb),"forceUpdateIndex"in t&&n(6,m=t.forceUpdateIndex),"realData"in t&&n(2,h=t.realData)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{88&t.$$.dirty&&n(2,h=a.map((t=>{const e=s.actInfo.song_info.song_code==t.song_code;let n="",i="",o="";return n=e?"播放中":2==c?"切歌":1==t.order_status?"已点":"点歌",(e||2!=c&&1==t.order_status)&&(i="disable"),e&&(o="playing"),t._title=n,t._titleCls=i,t._muiscCls=o,t})))},[r,l,h,a,c,d,m]}class mp extends h{constructor(t){super(t),u(this,t,dp,lp,g,{data:3,clickMuiscCb:0,menuType:4,scrollBottomCb:1,forceUpdate:5}),p("SvelteRegisterComponent",{component:this,tagName:"Musics",options:t,id:lp.name})}get data(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clickMuiscCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set clickMuiscCb(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get menuType(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set menuType(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get scrollBottomCb(){throw new Error("<Musics>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set scrollBottomCb(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[5]}set forceUpdate(t){throw new Error("<Musics>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const hp="src/js/chorusRoom/musicLibrary/index.svelte";function up(t){let e,n,i,o,s;function a(e){t[14](e)}let r={};void 0!==t[2]&&(r.value=t[2]),e=new Uc({props:r,$$inline:!0}),Y.push((()=>X(e,"value",a)));let c=t[7]&&0==t[2].length&&pp(t);const l={c:function(){U(e.$$.fragment),i=T(),c&&c.c(),o=ht()},m:function(t,n){z(e,t,n),b(t,i,n),c&&c.m(t,n),b(t,o,n),s=!0},p:function(t,i){const s={};!n&&4&i&&(n=!0,s.value=t[2],Z((()=>n=!1))),e.$set(s),t[7]&&0==t[2].length?c?(c.p(t,i),132&i&&q(c,1)):(c=pp(t),c.c(),q(c,1),c.m(o.parentNode,o)):c&&(W(),O(c,1,1,(()=>{c=null})),N())},i:function(t){s||(q(e.$$.fragment,t),q(c),s=!0)},o:function(t){O(e.$$.fragment,t),O(c),s=!1},d:function(t){G(e,t),t&&C(i),c&&c.d(t),t&&C(o)}};return p("SvelteRegisterBlock",{block:l,id:up.name,type:"if",source:"(213:8) {#if menusIndex == 0}",ctx:t}),l}function pp(t){let e,n;e=new vc({props:{data:t[7],selectedIndex:t[3],changeCb:t[9]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};128&n&&(i.data=t[7]),8&n&&(i.selectedIndex=t[3]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:pp.name,type:"if",source:"(215:12) {#if category && searchText.length == 0}",ctx:t}),i}function gp(t){let e,n;e=new Ea({props:{desc:t[2]?"没有搜到该歌曲呢":"暂无歌曲内容"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.desc=t[2]?"没有搜到该歌曲呢":"暂无歌曲内容"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:gp.name,type:"if",source:"(221:45) ",ctx:t}),i}function fp(t){let e,n,i={menuType:t[1],data:t[5],clickMuiscCb:t[10],scrollBottomCb:t[11]};e=new mp({props:i,$$inline:!0}),t[15](e);const o={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.menuType=t[1]),32&n&&(i.data=t[5]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(n){t[15](null),G(e,n)}};return p("SvelteRegisterBlock",{block:o,id:fp.name,type:"if",source:"(219:8) {#if realMusicList?.length > 0}",ctx:t}),o}function wp(t){let e,n,i,o,s,a,r,c,l,d;i=new Na({props:{data:t[4],selectedIndex:t[1],changeCb:t[8]},$$inline:!0}),s=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),s.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let m=0==t[1]&&up(t);const h=[fp,gp],u=[];function g(t,e){var n,i;return(null==(n=t[5])?void 0:n.length)>0?0:0==(null==(i=t[5])?void 0:i.length)?1:-1}~(c=g(t))&&(l=u[c]=h[c](t));const f={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),U(s.$$.fragment),a=T(),m&&m.c(),r=T(),l&&l.c(),y(n,"class","body s-rjlpTYFV0gBP"),x(n,hp,209,4,7178),y(e,"class","music_library s-rjlpTYFV0gBP"),x(e,hp,208,0,7146)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,l){b(t,e,l),I(e,n),z(i,n,null),I(n,o),z(s,n,null),I(n,a),m&&m.m(n,null),I(n,r),~c&&u[c].m(n,null),d=!0},p:function(e,[o]){t=e;const s={};16&o&&(s.data=t[4]),2&o&&(s.selectedIndex=t[1]),i.$set(s),0==t[1]?m?(m.p(t,o),2&o&&q(m,1)):(m=up(t),m.c(),q(m,1),m.m(n,r)):m&&(W(),O(m,1,1,(()=>{m=null})),N());let a=c;c=g(t),c===a?~c&&u[c].p(t,o):(l&&(W(),O(u[a],1,1,(()=>{u[a]=null})),N()),~c?(l=u[c],l?l.p(t,o):(l=u[c]=h[c](t),l.c()),q(l,1),l.m(n,null)):l=null)},i:function(t){d||(q(i.$$.fragment,t),q(s.$$.fragment,t),q(m),q(l),d=!0)},o:function(t){O(i.$$.fragment,t),O(s.$$.fragment,t),O(m),O(l),d=!1},d:function(t){t&&C(e),G(i),G(s),m&&m.d(),~c&&u[c].d()}};return p("SvelteRegisterBlock",{block:f,id:wp.name,type:"component",source:"",ctx:t}),f}const vp=3;function _p(t,e,n){let i,{$$slots:o={},$$scope:s}=e;f("MusicLibrary",o,[]);let{closeModal:a}=e;const r=nw.getInstance();let d,m=["曲库","本厅唱过","歌单（0）"],h=0,u=t=>n(1,h=t),p={[Qu]:{},[Xu]:null,[Zu]:null,[vp]:null},g=null,v="";function _(){qt.get(r.isAgora?Ot.onSearchSongYinSuDa(v):Ot.getSearchZegoSongChorus(uu.getCid(),v)).then((t=>{if(0==t.error){const e=t.data||[];n(12,p=l(c({},p),{[vp]:e}))}}))}let y=null,x=-1,b=t=>n(3,x=t);function $(t=h,e=!1){if(0==t&&-1==x);else{let i=k(t,x);if(i&&i.length>0&&0==e);else{let e=0==t&&y?y[x].sub_type:void 0,i=null!=e?p[0][String(e)]:null;qt.get(Ot.getSongListWithType(uu.getCid(),t+1,e,i?i.page:void 0)).then((o=>{if(0==o.error){const s=o.data.list||[];if(0==t?(i?(i.page=i.page+1,i.list=i.list.concat(s)):i={page:2,list:s},n(12,p=l(c({},p),{[Qu]:l(c({},p[0]),{[String(e)]:i})}))):n(12,p=l(c({},p),{[t]:s})),2==t){const t=[...m];t[2]=`歌单（${s.length}）`,n(4,m=t)}}}))}}}function k(t=h,e=x){let n=null;if(0==t)if(v.length>0)n=p[3];else{let t=y?y[e].sub_type:void 0,i=p[0][String(t)];n=i?i.list:null}else n=p[t];return n}function C(t){if(2!=h&&1==t.order_status)return;const e=2==h?Ot.getChorusChangeSong:Ot.getChorusPickSong;qt.get(e(uu.getCid(),t.song_code)).then((e=>{0==e.error?(t.order_status=1,n(12,p=c({},p)),$(2,!0),d&&d.forceUpdate(),2==h&&a&&a()):Vt(e.error_msg)}))}function I(){if(0==h&&0==v.length){k().length%20==0&&$(0,!0)}}w((()=>{qt.get(Ot.getSongTypeList(uu.getCid())).then((t=>{0==t.error&&(n(13,y=t.data.sub_tab),(null==y?void 0:y.length)&&n(3,x=0))})),$(2)})),t.$$.on_mount.push((function(){void 0!==a||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<MusicLibrary> was created without expected prop 'closeModal'")}));const S=["closeModal"];return Object.keys(e).forEach((t=>{~S.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MusicLibrary> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,a=t.closeModal)},t.$capture_state=()=>({onMount:w,ChatUrls:Ot,common:uu,request:qt,MENU_TYPE_QUKU:0,MENU_TYPE_HISTORY:1,MENU_TYPE_SELECTED:2,ORDER_TYPE_1:1,ChorusRoom:nw,Img:ye,Category:vc,Empty:Ea,Menus:Na,Musics:mp,Search:Uc,showTips:Vt,closeModal:a,instance:r,SEARCH_TYPE:3,menus:m,menusIndex:h,menusChange:u,allData:p,realMusicList:g,searchText:v,musicsRef:d,requestSearchList:_,categoryData:y,categoryIndex:x,categoryChange:b,requestMuiscList:$,getMusicList:k,clickMuiscWithData:C,scrollBottomCb:I,category:i}),t.$inject_state=t=>{"closeModal"in t&&n(0,a=t.closeModal),"menus"in t&&n(4,m=t.menus),"menusIndex"in t&&n(1,h=t.menusIndex),"menusChange"in t&&n(8,u=t.menusChange),"allData"in t&&n(12,p=t.allData),"realMusicList"in t&&n(5,g=t.realMusicList),"searchText"in t&&n(2,v=t.searchText),"musicsRef"in t&&n(6,d=t.musicsRef),"categoryData"in t&&n(13,y=t.categoryData),"categoryIndex"in t&&n(3,x=t.categoryIndex),"categoryChange"in t&&n(9,b=t.categoryChange),"category"in t&&n(7,i=t.category)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{4&t.$$.dirty&&v.length&&_(),8192&t.$$.dirty&&n(7,i=y?y.map((t=>t.name)):null),10&t.$$.dirty&&(0==h&&-1==x||$()),4106&t.$$.dirty&&n(5,g=k())},[a,h,v,x,m,g,d,i,u,b,C,I,p,y,function(t){v=t,n(2,v)},function(t){Y[t?"unshift":"push"]((()=>{d=t,n(6,d)}))}]}class yp extends h{constructor(t){super(t),u(this,t,_p,wp,g,{closeModal:0}),p("SvelteRegisterComponent",{component:this,tagName:"MusicLibrary",options:t,id:wp.name})}get closeModal(){throw new Error("<MusicLibrary>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<MusicLibrary>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const xp="src/js/components/award.svelte";function bp(t){let e,n,i,o,s;const a=[kp,$p],r=[];function c(t,n){return 1&n&&(e=null),null==e&&(e=!!(t[0].indexOf(".svga")>=0)),e?0:1}n=c(t,-1),i=r[n]=a[n](t);const l={c:function(){i.c(),o=ht()},m:function(t,e){r[n].m(t,e),b(t,o,e),s=!0},p:function(t,e){let s=n;n=c(t,e),n===s?r[n].p(t,e):(W(),O(r[s],1,1,(()=>{r[s]=null})),N(),i=r[n],i?i.p(t,e):(i=r[n]=a[n](t),i.c()),q(i,1),i.m(o.parentNode,o))},i:function(t){s||(q(i),s=!0)},o:function(t){O(i),s=!1},d:function(t){r[n].d(t),t&&C(o)}};return p("SvelteRegisterBlock",{block:l,id:bp.name,type:"if",source:"(20:0) {#if src}",ctx:t}),l}function $p(t){let e,n;e=new ye({props:{class:"common_award",src:t[0]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src=t[0]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:$p.name,type:"else",source:"(23:4) {:else}",ctx:t}),i}function kp(t){let e;const n={c:function(){e=_("div"),y(e,"class","common_award type_svga s-nyxeS0lqTLr1"),x(e,xp,21,8,408)},m:function(n,i){b(n,e,i),t[2](e)},p:k,i:k,o:k,d:function(n){n&&C(e),t[2](null)}};return p("SvelteRegisterBlock",{block:n,id:kp.name,type:"if",source:'(21:4) {#if src.indexOf(\\".svga\\") >= 0}',ctx:t}),n}function Cp(t){let e,n,i=t[0]&&bp(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[0]?i?(i.p(t,n),1&n&&q(i,1)):(i=bp(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Cp.name,type:"component",source:"",ctx:t}),o}function Ip(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Award",i,[]);let s,{src:a}=e;w((()=>(s&&Zt.getInstance().playEver(s,a,a),()=>Zt.getInstance().clearPlayer(a)))),t.$$.on_mount.push((function(){void 0!==a||"src"in e||t.$$.bound[t.$$.props.src]||console.warn("<Award> was created without expected prop 'src'")}));const r=["src"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Award> was created with unknown prop '${t}'`)})),t.$$set=t=>{"src"in t&&n(0,a=t.src)},t.$capture_state=()=>({onMount:w,Img:ye,SvgaPlayer:Zt,src:a,svgaRef:s}),t.$inject_state=t=>{"src"in t&&n(0,a=t.src),"svgaRef"in t&&n(1,s=t.svgaRef)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,s,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class Sp extends h{constructor(t){super(t),u(this,t,Ip,Cp,g,{src:0}),p("SvelteRegisterComponent",{component:this,tagName:"Award",options:t,id:Cp.name})}get src(){throw new Error("<Award>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set src(t){throw new Error("<Award>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Tp="src/js/chorusRoom/rankModal/mineItem.svelte";function Rp(t){let e,n,i,o,s,a,r,c;i=new Sp({props:{src:t[0].award_list[0].pic},$$inline:!0});const l={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("div"),s.textContent="领取",y(n,"class","container s-SX3X7mGspBUR"),x(n,Tp,23,12,639),y(s,"class","btn s-SX3X7mGspBUR"),x(s,Tp,26,12,748),y(e,"class","award"),A(e,"opacity",t[1]?.5:1),x(e,Tp,22,8,569)},m:function(l,d){b(l,e,d),I(e,n),z(i,n,null),I(e,o),I(e,s),a=!0,r||(c=E(s,"click",t[2],!1,!1,!1,!1),r=!0)},p:function(t,n){const o={};1&n&&(o.src=t[0].award_list[0].pic),i.$set(o),(!a||2&n)&&A(e,"opacity",t[1]?.5:1)},i:function(t){a||(q(i.$$.fragment,t),a=!0)},o:function(t){O(i.$$.fragment,t),a=!1},d:function(t){t&&C(e),G(i),r=!1,c()}};return p("SvelteRegisterBlock",{block:l,id:Rp.name,type:"if",source:"(22:4) {#if data?.award_list?.length > 0}",ctx:t}),l}function Mp(t){var e,n;let i,o,s,a,r,c,l,d,m,h,u,g,f,w=t[0].self_data.room_info.title+"",v=t[0].self_data.score+"";o=new ye({props:{class:"head",src:t[0].self_data.room_info.pic},$$inline:!0});let $=(null==(n=null==(e=t[0])?void 0:e.award_list)?void 0:n.length)>0&&Rp(t);const k={c:function(){i=_("div"),U(o.$$.fragment),s=T(),a=_("div"),r=_("p"),c=M(w),l=T(),d=_("p"),m=_("span"),h=M(v),u=M("分"),g=T(),$&&$.c(),y(r,"class","name s-SX3X7mGspBUR"),x(r,Tp,18,8,391),y(m,"class","s-SX3X7mGspBUR"),x(m,Tp,19,26,470),y(d,"class","number s-SX3X7mGspBUR"),x(d,Tp,19,8,452),x(a,Tp,17,4,377),y(i,"class","mine_item s-SX3X7mGspBUR"),x(i,Tp,15,0,290)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,e){b(t,i,e),z(o,i,null),I(i,s),I(i,a),I(a,r),I(r,c),I(a,l),I(a,d),I(d,m),I(m,h),I(d,u),I(i,g),$&&$.m(i,null),f=!0},p:function(t,[e]){var n,s;const a={};1&e&&(a.src=t[0].self_data.room_info.pic),o.$set(a),(!f||1&e)&&w!==(w=t[0].self_data.room_info.title+"")&&P(c,w),(!f||1&e)&&v!==(v=t[0].self_data.score+"")&&P(h,v),(null==(s=null==(n=t[0])?void 0:n.award_list)?void 0:s.length)>0?$?($.p(t,e),1&e&&q($,1)):($=Rp(t),$.c(),q($,1),$.m(i,null)):$&&(W(),O($,1,1,(()=>{$=null})),N())},i:function(t){f||(q(o.$$.fragment,t),q($),f=!0)},o:function(t){O(o.$$.fragment,t),O($),f=!1},d:function(t){t&&C(i),G(o),$&&$.d()}};return p("SvelteRegisterBlock",{block:k,id:Mp.name,type:"component",source:"",ctx:t}),k}function Ap(t,e,n){let{$$slots:i={},$$scope:o}=e;f("MineItem",i,[]);let{data:s}=e,a=!1;function r(){n(1,a=!0),Vt("领取成功")}t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<MineItem> was created without expected prop 'data'")}));const c=["data"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MineItem> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({Img:ye,showTips:Vt,Award:Sp,data:s,received:a,click:r}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"received"in t&&n(1,a=t.received)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,a,r]}class Pp extends h{constructor(t){super(t),u(this,t,Ap,Mp,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"MineItem",options:t,id:Mp.name})}get data(){throw new Error("<MineItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<MineItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const jp="src/js/chorusRoom/components/top3Item.svelte";function Dp(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k,S,A,j=(t[0].room_info.title?t[0].room_info.title.substr(0,6):"虚位以待")+"",D=void 0===t[0].score?"--":`${t[0].score}分`;s=new ye({props:{class:"head_url",src:t[0].room_info.pic},$$inline:!0}),r=new ye({props:{class:"gold",src:`https://asset.tuwan.com/chatroom/chorus/rank_top3_gold_${t[0].rank}.png`},$$inline:!0}),l=new ye({props:{class:"no",src:`https://asset.tuwan.com/chatroom/chorus/rank_top3_no_${t[0].rank}.png`},$$inline:!0}),g=new ye({props:{class:"line",src:"https://asset.tuwan.com/chatroom/chorus/rank_top3_line.png"},$$inline:!0}),k=new ye({props:{class:"bg",src:"https://asset.tuwan.com/chatroom/chorus/rank_top3_bg.png"},$$inline:!0});const L={c:function(){e=_("div"),n=_("div"),i=_("p"),i.textContent="?",o=T(),U(s.$$.fragment),a=T(),U(r.$$.fragment),c=T(),U(l.$$.fragment),d=T(),m=_("p"),h=M(j),u=T(),U(g.$$.fragment),f=T(),w=_("p"),v=M(D),$=T(),U(k.$$.fragment),y(i,"class","empty s-HzWB9rzBItDm"),x(i,jp,8,8,169),y(n,"class","head s-HzWB9rzBItDm"),x(n,jp,7,4,142),y(m,"class","name s-HzWB9rzBItDm"),x(m,jp,13,4,476),y(w,"class","number s-HzWB9rzBItDm"),x(w,jp,15,4,657),y(e,"class",S=R(`top3Item no_${t[0].rank}`)+" s-HzWB9rzBItDm"),x(e,jp,6,0,97)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,p){b(t,e,p),I(e,n),I(n,i),I(n,o),z(s,n,null),I(n,a),z(r,n,null),I(n,c),z(l,n,null),I(e,d),I(e,m),I(m,h),I(e,u),z(g,e,null),I(e,f),I(e,w),I(w,v),I(e,$),z(k,e,null),A=!0},p:function(t,[n]){const i={};1&n&&(i.src=t[0].room_info.pic),s.$set(i);const o={};1&n&&(o.src=`https://asset.tuwan.com/chatroom/chorus/rank_top3_gold_${t[0].rank}.png`),r.$set(o);const a={};1&n&&(a.src=`https://asset.tuwan.com/chatroom/chorus/rank_top3_no_${t[0].rank}.png`),l.$set(a),(!A||1&n)&&j!==(j=(t[0].room_info.title?t[0].room_info.title.substr(0,6):"虚位以待")+"")&&P(h,j),(!A||1&n)&&D!==(D=void 0===t[0].score?"--":`${t[0].score}分`)&&P(v,D),(!A||1&n&&S!==(S=R(`top3Item no_${t[0].rank}`)+" s-HzWB9rzBItDm"))&&y(e,"class",S)},i:function(t){A||(q(s.$$.fragment,t),q(r.$$.fragment,t),q(l.$$.fragment,t),q(g.$$.fragment,t),q(k.$$.fragment,t),A=!0)},o:function(t){O(s.$$.fragment,t),O(r.$$.fragment,t),O(l.$$.fragment,t),O(g.$$.fragment,t),O(k.$$.fragment,t),A=!1},d:function(t){t&&C(e),G(s),G(r),G(l),G(g),G(k)}};return p("SvelteRegisterBlock",{block:L,id:Dp.name,type:"component",source:"",ctx:t}),L}function Lp(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Top3Item",i,[]);let{data:s=null}=e;const a=["data"];return Object.keys(e).forEach((t=>{~a.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Top3Item> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({Img:ye,data:s}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s]}class Ep extends h{constructor(t){super(t),u(this,t,Lp,Dp,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"Top3Item",options:t,id:Dp.name})}get data(){throw new Error("<Top3Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Top3Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Bp="src/js/chorusRoom/components/top3.svelte";function Fp(t,e,n){const i=t.slice();return i[2]=e[n],i}function Up(t){let e,n,i=t[1];v(i);let o=[];for(let r=0;r<i.length;r+=1)o[r]=zp(Fp(t,i,r));const s=t=>O(o[t],1,1,(()=>{o[t]=null})),a={c:function(){e=_("div");for(let t=0;t<o.length;t+=1)o[t].c();y(e,"class","top3 s-gRjdGWi9ThsY"),x(e,Bp,15,4,326)},m:function(t,i){b(t,e,i);for(let n=0;n<o.length;n+=1)o[n]&&o[n].m(e,null);n=!0},p:function(t,n){if(2&n){let a;for(i=t[1],v(i),a=0;a<i.length;a+=1){const s=Fp(t,i,a);o[a]?(o[a].p(s,n),q(o[a],1)):(o[a]=zp(s),o[a].c(),q(o[a],1),o[a].m(e,null))}for(W(),a=i.length;a<o.length;a+=1)s(a);N()}},i:function(t){if(!n){for(let t=0;t<i.length;t+=1)q(o[t]);n=!0}},o:function(t){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)O(o[e]);n=!1},d:function(t){t&&C(e),S(o,t)}};return p("SvelteRegisterBlock",{block:a,id:Up.name,type:"if",source:"(15:0) {#if data.length > 0}",ctx:t}),a}function zp(t){let e,n;e=new Ep({props:{data:t[2]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.data=t[2]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:zp.name,type:"each",source:"(17:8) {#each realData as item}",ctx:t}),i}function Op(t){let e,n,i=t[0].length>0&&Up(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[0].length>0?i?(i.p(t,n),1&n&&q(i,1)):(i=Up(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Op.name,type:"component",source:"",ctx:t}),o}function Np(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Top3",i,[]);let{data:s=[]}=e,a=[];const r=["data"];return Object.keys(e).forEach((t=>{~r.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Top3> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({Top3Item:Ep,data:s,realData:a}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data),"realData"in t&&n(1,a=t.realData)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(3&t.$$.dirty){n(1,a=s);for(let t=s.length;t<3;t++)a.push({room_info:{title:""},rank:t+1})}},[s,a]}class qp extends h{constructor(t){super(t),u(this,t,Np,Op,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"Top3",options:t,id:Op.name})}get data(){throw new Error("<Top3>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Top3>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Gp="src/js/chorusRoom/rankModal/rankItem.svelte";function Vp(t){let e,n,i,o,s,a,r,c,l,d=t[0].rank+"",m=t[0].room_info.title+"",h=t[0].score+"";const u={c:function(){e=_("div"),n=_("p"),i=M(d),o=T(),s=_("p"),a=M(m),r=T(),c=_("p"),l=M(h),y(n,"class","no s-5pQib01gpclj"),x(n,Gp,5,4,68),y(s,"class","name s-5pQib01gpclj"),x(s,Gp,6,4,102),y(c,"class","score s-5pQib01gpclj"),x(c,Gp,7,4,149),y(e,"class","rank_item s-5pQib01gpclj"),x(e,Gp,4,0,40)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,d){b(t,e,d),I(e,n),I(n,i),I(e,o),I(e,s),I(s,a),I(e,r),I(e,c),I(c,l)},p:function(t,[e]){1&e&&d!==(d=t[0].rank+"")&&P(i,d),1&e&&m!==(m=t[0].room_info.title+"")&&P(a,m),1&e&&h!==(h=t[0].score+"")&&P(l,h)},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:u,id:Vp.name,type:"component",source:"",ctx:t}),u}function Hp(t,e,n){let{$$slots:i={},$$scope:o}=e;f("RankItem",i,[]);let{data:s}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<RankItem> was created without expected prop 'data'")}));const a=["data"];return Object.keys(e).forEach((t=>{~a.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<RankItem> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({data:s}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s]}class Wp extends h{constructor(t){super(t),u(this,t,Hp,Vp,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"RankItem",options:t,id:Vp.name})}get data(){throw new Error("<RankItem>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<RankItem>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Kp="src/js/chorusRoom/rankModal/index.svelte";function Yp(t,e,n){const i=t.slice();return i[5]=e[n],i}function Jp(t){let e,n,i,o,s,a,r=t[1]&&Qp(t);const c={c:function(){e=_("div"),n=_("div"),i=_("div"),r&&r.c(),y(i,"class","scroll_view scroll_bar_gray s-MFX00sVMWvi3"),x(i,Kp,45,12,1329),y(n,"class","body s-MFX00sVMWvi3"),y(n,"role","presentation"),x(n,Kp,44,8,1253),y(e,"class","rank_modal s-MFX00sVMWvi3"),y(e,"role","presentation"),x(e,Kp,43,4,1178)},m:function(c,l){b(c,e,l),I(e,n),I(n,i),r&&r.m(i,null),o=!0,s||(a=[E(n,"click",B(t[4]),!1,!1,!0,!1),E(e,"click",(function(){H(t[0])&&t[0].apply(this,arguments)}),!1,!1,!1,!1)],s=!0)},p:function(e,n){(t=e)[1]?r?(r.p(t,n),2&n&&q(r,1)):(r=Qp(t),r.c(),q(r,1),r.m(i,null)):r&&(W(),O(r,1,1,(()=>{r=null})),N())},i:function(t){o||(q(r),o=!0)},o:function(t){O(r),o=!1},d:function(t){t&&C(e),r&&r.d(),s=!1,V(a)}};return p("SvelteRegisterBlock",{block:c,id:Jp.name,type:"if",source:"(43:0) {#if data}",ctx:t}),c}function Qp(t){let e,n,i,o,s,a,r,c,l,d,m,h,u=t[1].self_data.rank+"";r=new Pp({props:{data:t[1]},$$inline:!0}),l=new qp({props:{data:t[3]},$$inline:!0});let g=t[2];v(g);let f=[];for(let p=0;p<g.length;p+=1)f[p]=Xp(Yp(t,g,p));const w=t=>O(f[t],1,1,(()=>{f[t]=null})),$={c:function(){e=_("div"),n=_("p"),n.textContent="第",i=_("span"),o=M(u),s=_("p"),s.textContent="名",a=T(),U(r.$$.fragment),c=T(),U(l.$$.fragment),d=T();for(let t=0;t<f.length;t+=1)f[t].c();m=ht(),y(n,"class","s-MFX00sVMWvi3"),x(n,Kp,47,41,1439),y(i,"class","s-MFX00sVMWvi3"),x(i,Kp,47,49,1447),y(s,"class","s-MFX00sVMWvi3"),x(s,Kp,47,83,1481),y(e,"class","rank_no s-MFX00sVMWvi3"),x(e,Kp,47,20,1418)},m:function(t,u){b(t,e,u),I(e,n),I(e,i),I(i,o),I(e,s),b(t,a,u),z(r,t,u),b(t,c,u),z(l,t,u),b(t,d,u);for(let e=0;e<f.length;e+=1)f[e]&&f[e].m(t,u);b(t,m,u),h=!0},p:function(t,e){(!h||2&e)&&u!==(u=t[1].self_data.rank+"")&&P(o,u);const n={};2&e&&(n.data=t[1]),r.$set(n);const i={};if(8&e&&(i.data=t[3]),l.$set(i),4&e){let n;for(g=t[2],v(g),n=0;n<g.length;n+=1){const i=Yp(t,g,n);f[n]?(f[n].p(i,e),q(f[n],1)):(f[n]=Xp(i),f[n].c(),q(f[n],1),f[n].m(m.parentNode,m))}for(W(),n=g.length;n<f.length;n+=1)w(n);N()}},i:function(t){if(!h){q(r.$$.fragment,t),q(l.$$.fragment,t);for(let t=0;t<g.length;t+=1)q(f[t]);h=!0}},o:function(t){O(r.$$.fragment,t),O(l.$$.fragment,t),f=f.filter(Boolean);for(let e=0;e<f.length;e+=1)O(f[e]);h=!1},d:function(t){t&&C(e),t&&C(a),G(r,t),t&&C(c),G(l,t),t&&C(d),S(f,t),t&&C(m)}};return p("SvelteRegisterBlock",{block:$,id:Qp.name,type:"if",source:"(47:16) {#if data}",ctx:t}),$}function Xp(t){let e,n;e=new Wp({props:{data:t[5]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.data=t[5]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Xp.name,type:"each",source:"(51:20) {#each subList as item}",ctx:t}),i}function Zp(t){let e,n,i=t[1]&&Jp(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[1]?i?(i.p(t,n),2&n&&q(i,1)):(i=Jp(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Zp.name,type:"component",source:"",ctx:t}),o}function tg(t,e,n){let i,o,{$$slots:s={},$$scope:a}=e;f("RankModal",s,[]);let{closeModal:r}=e,c=null;w((()=>{let t=null;return qt.get(Ot.getChorusEndRank(uu.getCid())).then((e=>{0==e.error?0==e.data.self_data.rank||0==e.data.self_data.score?r&&r():(n(1,c=e.data),t=setTimeout(r,15e3)):Vt(e.error_msg)})),()=>window.clearTimeout(t)})),t.$$.on_mount.push((function(){void 0!==r||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<RankModal> was created without expected prop 'closeModal'")}));const l=["closeModal"];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<RankModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,r=t.closeModal)},t.$capture_state=()=>({onMount:w,MineItem:Pp,Top3:qp,RankItem:Wp,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,closeModal:r,data:c,subList:o,top3List:i}),t.$inject_state=t=>{"closeModal"in t&&n(0,r=t.closeModal),"data"in t&&n(1,c=t.data),"subList"in t&&n(2,o=t.subList),"top3List"in t&&n(3,i=t.top3List)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{var e,s;2&t.$$.dirty&&n(3,i=(null==(e=null==c?void 0:c.list)?void 0:e.length)>0?c.list.slice(0,3):[]),2&t.$$.dirty&&n(2,o=(null==(s=null==c?void 0:c.list)?void 0:s.length)>0?c.list.slice(3):[])},[r,c,o,i,function(e){F.call(this,t,e)}]}class eg extends h{constructor(t){super(t),u(this,t,tg,Zp,g,{closeModal:0}),p("SvelteRegisterComponent",{component:this,tagName:"RankModal",options:t,id:Zp.name})}get closeModal(){throw new Error("<RankModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<RankModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ng="src/js/chorusRoom/singModal/item.svelte";function ig(t){let e,n,i,o,s,a,r,c,l=t[0].nickname+"";n=new ye({props:{src:t[0].avatar},$$inline:!0});const d={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),s=M(l),a=T(),r=_("div"),y(o,"class","s-JjMWqRKfZbWH"),x(o,ng,8,4,157),y(r,"class","line s-JjMWqRKfZbWH"),x(r,ng,9,4,184),y(e,"class","sing_modal-item s-JjMWqRKfZbWH"),x(e,ng,6,0,94)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,l){b(t,e,l),z(n,e,null),I(e,i),I(e,o),I(o,s),I(e,a),I(e,r),c=!0},p:function(t,[e]){const i={};1&e&&(i.src=t[0].avatar),n.$set(i),(!c||1&e)&&l!==(l=t[0].nickname+"")&&P(s,l)},i:function(t){c||(q(n.$$.fragment,t),c=!0)},o:function(t){O(n.$$.fragment,t),c=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:d,id:ig.name,type:"component",source:"",ctx:t}),d}function og(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Item",i,[]);let{data:s}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Item> was created without expected prop 'data'")}));const a=["data"];return Object.keys(e).forEach((t=>{~a.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Item> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({Img:ye,data:s}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s]}let sg=class extends h{constructor(t){super(t),u(this,t,og,ig,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"Item",options:t,id:ig.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};const ag="src/js/chorusRoom/singModal/index.svelte";function rg(t,e,n){const i=t.slice();return i[3]=e[n],i}function cg(t){let e,n;e=new Ea({props:{desc:"暂无数据"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:cg.name,type:"if",source:"(36:12) {#if list && list.length == 0}",ctx:t}),i}function lg(t){let e,n;e=new sg({props:{data:t[3]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};2&n&&(i.data=t[3]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:lg.name,type:"each",source:"(39:12) {#each list || [] as item}",ctx:t}),i}function dg(t){let e,n,i,o,s,a,r,c,l;i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_gray.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let d=t[1]&&0==t[1].length&&cg(t),m=t[1]||[];v(m);let h=[];for(let p=0;p<m.length;p+=1)h[p]=lg(rg(t,m,p));const u=t=>O(h[t],1,1,(()=>{h[t]=null})),g={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),s.textContent="合唱人数",a=T(),r=_("div"),d&&d.c(),c=T();for(let t=0;t<h.length;t+=1)h[t].c();y(s,"class","title s-NqHu_O0hPB-0"),x(s,ag,33,8,900),y(r,"class","scroll_view scroll_bar_gray s-NqHu_O0hPB-0"),x(r,ag,34,8,934),y(n,"class","body s-NqHu_O0hPB-0"),x(n,ag,31,4,757),y(e,"class","sing_modal s-NqHu_O0hPB-0"),x(e,ag,30,0,728)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,m){b(t,e,m),I(e,n),z(i,n,null),I(n,o),I(n,s),I(n,a),I(n,r),d&&d.m(r,null),I(r,c);for(let e=0;e<h.length;e+=1)h[e]&&h[e].m(r,null);l=!0},p:function(e,[n]){if((t=e)[1]&&0==t[1].length?d?2&n&&q(d,1):(d=cg(t),d.c(),q(d,1),d.m(r,c)):d&&(W(),O(d,1,1,(()=>{d=null})),N()),2&n){let e;for(m=t[1]||[],v(m),e=0;e<m.length;e+=1){const i=rg(t,m,e);h[e]?(h[e].p(i,n),q(h[e],1)):(h[e]=lg(i),h[e].c(),q(h[e],1),h[e].m(r,null))}for(W(),e=m.length;e<h.length;e+=1)u(e);N()}},i:function(t){if(!l){q(i.$$.fragment,t),q(d);for(let t=0;t<m.length;t+=1)q(h[t]);l=!0}},o:function(t){O(i.$$.fragment,t),O(d),h=h.filter(Boolean);for(let e=0;e<h.length;e+=1)O(h[e]);l=!1},d:function(t){t&&C(e),G(i),d&&d.d(),S(h,t)}};return p("SvelteRegisterBlock",{block:g,id:dg.name,type:"component",source:"",ctx:t}),g}function mg(t,e,n){let{$$slots:i={},$$scope:o}=e;f("SingModal",i,[]);let{closeModal:s}=e,{code:a=""}=e,r=null;w((()=>{qt.get(Ot.getChorusChoirList(uu.getCid(),a)).then((t=>{var e;0==t.error?n(1,r=(null==(e=null==t?void 0:t.data)?void 0:e.user_list)||[]):Vt(t.error_msg)}))})),t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<SingModal> was created without expected prop 'closeModal'")}));const c=["closeModal","code"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<SingModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"code"in t&&n(2,a=t.code)},t.$capture_state=()=>({onMount:w,Item:sg,Empty:Ea,Img:ye,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,closeModal:s,code:a,list:r}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"code"in t&&n(2,a=t.code),"list"in t&&n(1,r=t.list)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,r,a]}class hg extends h{constructor(t){super(t),u(this,t,mg,dg,g,{closeModal:0,code:2}),p("SvelteRegisterComponent",{component:this,tagName:"SingModal",options:t,id:dg.name})}get closeModal(){throw new Error("<SingModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<SingModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get code(){throw new Error("<SingModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set code(t){throw new Error("<SingModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ug="src/js/chorusRoom/musicRankModal/item.svelte";function pg(t){let e,n,i,o=t[0].rank+"";const s={c:function(){e=_("p"),n=M(o),y(e,"class","no_p aaaaa s-5CKxs_-tFF4y"),y(e,"style",i=`font-size: ${(t[0].rank+"").length>2?"14px":"20px"};`),x(e,ug,12,8,346)},m:function(t,i){b(t,e,i),I(e,n)},p:function(t,s){1&s&&o!==(o=t[0].rank+"")&&P(n,o),1&s&&i!==(i=`font-size: ${(t[0].rank+"").length>2?"14px":"20px"};`)&&y(e,"style",i)},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:pg.name,type:"else",source:"(12:4) {:else}",ctx:t}),s}function gg(t){let e,n;e=new ye({props:{class:"no_img",src:"https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[0].rank+".png"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src="https://asset.tuwan.com/chatroom/chorus/music_rank_no_"+t[0].rank+".png"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:gg.name,type:"if",source:"(10:29) ",ctx:t}),i}function fg(t){let e;const n={c:function(){e=_("p"),e.textContent="?",y(e,"class","no_p zero s-5CKxs_-tFF4y"),x(e,ug,8,8,163)},m:function(t,n){b(t,e,n)},p:k,i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:fg.name,type:"if",source:"(8:4) {#if data.rank == 0}",ctx:t}),n}function wg(t){let e,n,i,o,s,a,r,c,l,d,m=t[0].room_info.title+"",h=0==t[0].rank?"即将揭晓":`${t[0].score} 分`;const u=[fg,gg,pg],g=[];function f(t,e){return 0==t[0].rank?0:t[0].rank<=3?1:2}n=f(t),i=g[n]=u[n](t);const w={c:function(){e=_("div"),i.c(),o=T(),s=_("p"),a=M(m),r=T(),c=_("p"),l=M(h),y(s,"class","name s-5CKxs_-tFF4y"),x(s,ug,14,4,469),y(c,"class","score s-5CKxs_-tFF4y"),x(c,ug,15,4,516),y(e,"class","muisc_rank_modal-item s-5CKxs_-tFF4y"),x(e,ug,6,0,94)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){b(t,e,i),g[n].m(e,null),I(e,o),I(e,s),I(s,a),I(e,r),I(e,c),I(c,l),d=!0},p:function(t,[s]){let r=n;n=f(t),n===r?g[n].p(t,s):(W(),O(g[r],1,1,(()=>{g[r]=null})),N(),i=g[n],i?i.p(t,s):(i=g[n]=u[n](t),i.c()),q(i,1),i.m(e,o)),(!d||1&s)&&m!==(m=t[0].room_info.title+"")&&P(a,m),(!d||1&s)&&h!==(h=0==t[0].rank?"即将揭晓":`${t[0].score} 分`)&&P(l,h)},i:function(t){d||(q(i),d=!0)},o:function(t){O(i),d=!1},d:function(t){t&&C(e),g[n].d()}};return p("SvelteRegisterBlock",{block:w,id:wg.name,type:"component",source:"",ctx:t}),w}function vg(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Item",i,[]);let{data:s}=e;t.$$.on_mount.push((function(){void 0!==s||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Item> was created without expected prop 'data'")}));const a=["data"];return Object.keys(e).forEach((t=>{~a.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Item> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,s=t.data)},t.$capture_state=()=>({Img:ye,data:s}),t.$inject_state=t=>{"data"in t&&n(0,s=t.data)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s]}let _g=class extends h{constructor(t){super(t),u(this,t,vg,wg,g,{data:0}),p("SvelteRegisterComponent",{component:this,tagName:"Item",options:t,id:wg.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}};class yg{constructor(){this.list=[],this.selfData=null}}const xg="src/js/chorusRoom/musicRankModal/index.svelte";function bg(t,e,n){const i=t.slice();return i[12]=e[n],i}function $g(t){let e,n,i,o;const s=[Cg,kg],a=[];function r(t,e){return t[2]&&t[2].length>0?0:t[2]&&0==t[2].length?1:-1}~(e=r(t))&&(n=a[e]=s[e](t));const c={c:function(){n&&n.c(),i=ht()},m:function(t,n){~e&&a[e].m(t,n),b(t,i,n),o=!0},p:function(t,o){let c=e;e=r(t),e===c?~e&&a[e].p(t,o):(n&&(W(),O(a[c],1,1,(()=>{a[c]=null})),N()),~e?(n=a[e],n?n.p(t,o):(n=a[e]=s[e](t),n.c()),q(n,1),n.m(i.parentNode,i)):n=null)},i:function(t){o||(q(n),o=!0)},o:function(t){O(n),o=!1},d:function(t){~e&&a[e].d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:c,id:$g.name,type:"if",source:"(104:8) {#if menusIndex == 0}",ctx:t}),c}function kg(t){let e,n;e=new Ea({props:{desc:"暂无数据"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:kg.name,type:"if",source:"(107:55) ",ctx:t}),i}function Cg(t){let e,n;e=new vc({props:{data:t[2].map(jg),selectedIndex:t[3],changeCb:t[7]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};4&n&&(i.data=t[2].map(jg)),8&n&&(i.selectedIndex=t[3]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Cg.name,type:"if",source:"(105:12) {#if category && category.length > 0}",ctx:t}),i}function Ig(t){let e,n,i,o,s;const a=[Tg,Sg],r=[];function c(t,e){return t[4].list.length>0?0:1}e=c(t),n=r[e]=a[e](t);let l=t[4].selfData&&Ag(t);const d={c:function(){n.c(),i=T(),l&&l.c(),o=ht()},m:function(t,n){r[e].m(t,n),b(t,i,n),l&&l.m(t,n),b(t,o,n),s=!0},p:function(t,s){let d=e;e=c(t),e===d?r[e].p(t,s):(W(),O(r[d],1,1,(()=>{r[d]=null})),N(),n=r[e],n?n.p(t,s):(n=r[e]=a[e](t),n.c()),q(n,1),n.m(i.parentNode,i)),t[4].selfData?l?(l.p(t,s),16&s&&q(l,1)):(l=Ag(t),l.c(),q(l,1),l.m(o.parentNode,o)):l&&(W(),O(l,1,1,(()=>{l=null})),N())},i:function(t){s||(q(n),q(l),s=!0)},o:function(t){O(n),O(l),s=!1},d:function(t){r[e].d(t),t&&C(i),l&&l.d(t),t&&C(o)}};return p("SvelteRegisterBlock",{block:d,id:Ig.name,type:"if",source:"(112:8) {#if renderList}",ctx:t}),d}function Sg(t){let e,n;e=new Ea({props:{desc:"暂无数据"},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Sg.name,type:"else",source:"(122:12) {:else}",ctx:t}),i}function Tg(t){let e,n,i,o=1==t[1]&&Rg(t),s=1==t[1]?t[4].list.slice(3):t[4].list;v(s);let a=[];for(let l=0;l<s.length;l+=1)a[l]=Mg(bg(t,s,l));const r=t=>O(a[t],1,1,(()=>{a[t]=null})),c={c:function(){e=_("div"),o&&o.c(),n=T();for(let t=0;t<a.length;t+=1)a[t].c();y(e,"class","scroll_view scroll_bar_gray s-jGVRO4eXucii"),x(e,xg,113,16,3437)},m:function(t,s){b(t,e,s),o&&o.m(e,null),I(e,n);for(let n=0;n<a.length;n+=1)a[n]&&a[n].m(e,null);i=!0},p:function(t,i){if(1==t[1]?o?(o.p(t,i),2&i&&q(o,1)):(o=Rg(t),o.c(),q(o,1),o.m(e,n)):o&&(W(),O(o,1,1,(()=>{o=null})),N()),18&i){let n;for(s=1==t[1]?t[4].list.slice(3):t[4].list,v(s),n=0;n<s.length;n+=1){const o=bg(t,s,n);a[n]?(a[n].p(o,i),q(a[n],1)):(a[n]=Mg(o),a[n].c(),q(a[n],1),a[n].m(e,null))}for(W(),n=s.length;n<a.length;n+=1)r(n);N()}},i:function(t){if(!i){q(o);for(let t=0;t<s.length;t+=1)q(a[t]);i=!0}},o:function(t){O(o),a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)O(a[e]);i=!1},d:function(t){t&&C(e),o&&o.d(),S(a,t)}};return p("SvelteRegisterBlock",{block:c,id:Tg.name,type:"if",source:"(113:12) {#if renderList.list.length > 0}",ctx:t}),c}function Rg(t){let e,n;e=new qp({props:{data:t[4].list.slice(0,3)},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};16&n&&(i.data=t[4].list.slice(0,3)),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Rg.name,type:"if",source:"(115:20) {#if menusIndex == 1}",ctx:t}),i}function Mg(t){let e,n;e=new _g({props:{data:t[12]},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};18&n&&(i.data=t[12]),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Mg.name,type:"each",source:"(118:20) {#each menusIndex == 1 ? renderList.list.slice(3) : renderList.list as item}",ctx:t}),i}function Ag(t){let e,n,i;n=new _g({props:{data:t[4].selfData},$$inline:!0});const o={c:function(){e=_("div"),U(n.$$.fragment),y(e,"class","mine_rank s-jGVRO4eXucii"),x(e,xg,125,16,3935)},m:function(t,o){b(t,e,o),z(n,e,null),i=!0},p:function(t,e){const i={};16&e&&(i.data=t[4].selfData),n.$set(i)},i:function(t){i||(q(n.$$.fragment,t),i=!0)},o:function(t){O(n.$$.fragment,t),i=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:o,id:Ag.name,type:"if",source:"(125:12) {#if renderList.selfData}",ctx:t}),o}function Pg(t){let e,n,i,o,s,a,r,c;i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_white.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)})),s=new Na({props:{data:t[5],selectedIndex:t[1],changeCb:t[6]},$$inline:!0});let l=0==t[1]&&$g(t),d=t[4]&&Ig(t);const m={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),U(s.$$.fragment),a=T(),l&&l.c(),r=T(),d&&d.c(),y(n,"class","body s-jGVRO4eXucii"),x(n,xg,99,4,2797),y(e,"class","muisc_rank_modal s-jGVRO4eXucii"),x(e,xg,98,0,2762)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,m){b(t,e,m),I(e,n),z(i,n,null),I(n,o),z(s,n,null),I(n,a),l&&l.m(n,null),I(n,r),d&&d.m(n,null),c=!0},p:function(e,[i]){t=e;const o={};2&i&&(o.selectedIndex=t[1]),s.$set(o),0==t[1]?l?(l.p(t,i),2&i&&q(l,1)):(l=$g(t),l.c(),q(l,1),l.m(n,r)):l&&(W(),O(l,1,1,(()=>{l=null})),N()),t[4]?d?(d.p(t,i),16&i&&q(d,1)):(d=Ig(t),d.c(),q(d,1),d.m(n,null)):d&&(W(),O(d,1,1,(()=>{d=null})),N())},i:function(t){c||(q(i.$$.fragment,t),q(s.$$.fragment,t),q(l),q(d),c=!0)},o:function(t){O(i.$$.fragment,t),O(s.$$.fragment,t),O(l),O(d),c=!1},d:function(t){t&&C(e),G(i),G(s),l&&l.d(),d&&d.d()}};return p("SvelteRegisterBlock",{block:m,id:Pg.name,type:"component",source:"",ctx:t}),m}const jg=t=>t.name;function Dg(t,e,n){let{$$slots:i={},$$scope:o}=e;f("MusicRankModal",i,[]);let{closeModal:s}=e,a=uu.isChorusMoreRoom()?["歌曲榜单","总榜单"]:["歌曲榜单"],r=0,c=t=>n(1,r=t),l=null,d=0,m=t=>n(3,d=t),h={},u=null;function p(){qt.get(Ot.getChorusTotalRank(uu.getCid())).then((t=>{var e,i;if(0==t.error){const o=new yg;o.list=(null==(e=null==t?void 0:t.data)?void 0:e.list)||[],o.selfData=null==(i=null==t?void 0:t.data)?void 0:i.self_data,n(9,u=o)}}))}function g(t){qt.get(Ot.getChorusSongRank(uu.getCid(),t)).then((e=>{var i,o;if(0==e.error){const s=new yg;s.list=(null==(i=null==e?void 0:e.data)?void 0:i.list)||[],s.selfData=null==(o=null==e?void 0:e.data)?void 0:o.self_data,n(8,h[t]=s,h),n(8,h)}else Vt(e.error_msg)}))}w((()=>{qt.get(Ot.getChorusPlaySongList(uu.getCid())).then((t=>{var e;0==t.error?n(2,l=(null==(e=null==t?void 0:t.data)?void 0:e.list)||[]):Vt(t.error_msg)}))}));let v=null;t.$$.on_mount.push((function(){void 0!==s||"closeModal"in e||t.$$.bound[t.$$.props.closeModal]||console.warn("<MusicRankModal> was created without expected prop 'closeModal'")}));const _=["closeModal"];return Object.keys(e).forEach((t=>{~_.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MusicRankModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal)},t.$capture_state=()=>({onMount:w,Category:vc,Item:_g,Empty:Ea,Img:ye,Menus:Na,Top3:qp,common:uu,request:qt,ChatUrls:Ot,showTips:Vt,ListItemData:yg,closeModal:s,menus:a,menusIndex:r,menusChange:c,category:l,categoryIndex:d,categoryChange:m,list_map:h,total_list:u,requestTotalRankList:p,requestRankList:g,renderList:v}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"menus"in t&&n(5,a=t.menus),"menusIndex"in t&&n(1,r=t.menusIndex),"menusChange"in t&&n(6,c=t.menusChange),"category"in t&&n(2,l=t.category),"categoryIndex"in t&&n(3,d=t.categoryIndex),"categoryChange"in t&&n(7,m=t.categoryChange),"list_map"in t&&n(8,h=t.list_map),"total_list"in t&&n(9,u=t.total_list),"renderList"in t&&n(4,v=t.renderList)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{782&t.$$.dirty&&(0==r?l&&l.length>0&&(h[l[d].song_code]||g(l[d].song_code)):u||p()),782&t.$$.dirty&&(0==r?l&&l.length&&n(4,v=h[l[d].song_code]):n(4,v=u))},[s,r,l,d,v,a,c,m,h,u]}class Lg extends h{constructor(t){super(t),u(this,t,Dg,Pg,g,{closeModal:0}),p("SvelteRegisterComponent",{component:this,tagName:"MusicRankModal",options:t,id:Pg.name})}get closeModal(){throw new Error("<MusicRankModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<MusicRankModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Eg="src/js/chorusRoom/prepare/index.svelte";function Bg(t){let e,n,i,o,s,a;const r={c:function(){e=_("div"),n=_("p"),i=M(t[1]),o=T(),s=_("p"),a=M(t[0]),y(n,"class","title s-QOTOxp_ZBF_U"),x(n,Eg,35,4,785),y(s,"class","countdown s-QOTOxp_ZBF_U"),A(s,"opacity",t[0]),x(s,Eg,36,4,818),y(e,"class","preload s-QOTOxp_ZBF_U"),x(e,Eg,34,0,759)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,r){b(t,e,r),I(e,n),I(n,i),I(e,o),I(e,s),I(s,a)},p:function(t,[e]){2&e&&P(i,t[1]),1&e&&P(a,t[0]),1&e&&A(s,"opacity",t[0])},i:k,o:k,d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:r,id:Bg.name,type:"component",source:"",ctx:t}),r}function Fg(t,e,n){let{$$slots:i={},$$scope:o}=e;function s(t,e=""){n(0,r=t),n(1,c=e),window.clearInterval(a.handle),a.handle=null,t>=0&&(a.handle=setInterval((()=>{n(0,r-=1),0==r&&(window.clearInterval(a.handle),a.handle=null)}),1e3))}f("Prepare",i,[]),ut((()=>{window.clearInterval(a.handle),a.handle=null}));let a={handle:null},r=0,c="合唱即将开始";const l=[];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Prepare> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({onDestroy:ut,startCountdown:s,timer:a,seconds:r,title:c}),t.$inject_state=t=>{"timer"in t&&(a=t.timer),"seconds"in t&&n(0,r=t.seconds),"title"in t&&n(1,c=t.title)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,c,s]}class Ug extends h{constructor(t){super(t),u(this,t,Fg,Bg,g,{startCountdown:2}),p("SvelteRegisterComponent",{component:this,tagName:"Prepare",options:t,id:Bg.name})}get startCountdown(){return this.$$.ctx[2]}set startCountdown(t){throw new Error("<Prepare>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const zg=1;let Og=10,Ng=[],qg=Math.floor(6*Math.random()),Gg=[{centerX:80,centerY:200,vx:4,vy:-4.5},{centerX:440,centerY:200,vx:-4.5,vy:-3.5},{centerX:80,centerY:100,vx:4,vy:1},{centerX:440,centerY:120,vx:-4,vy:-3.5},{centerX:80,centerY:20,vx:4,vy:2},{centerX:440,centerY:20,vx:-4,vy:4}],Vg=function(t,e){let n=this;if(!(n instanceof Vg))return new Vg(t,e);var i;e=function(t,e){for(let n in e)t[n]=e[n];return t}(Vg.Config,e),n.container=(i=t,document.getElementById(i)),n.ballSum=e.ballSum,n.diameter=80,n.radius=n.diameter/2,n.spring=e.spring,n.bounce=e.bounce,n.gravity=e.gravity,n.balls=[],n.timer=null,n.L_bound=0,n.R_bound=n.container.clientWidth,n.T_bound=0,n.B_bound=n.container.clientHeight};Vg.Config={ballSum:5,spring:.8,bounce:-.9,gravity:0},Vg.prototype={initialize:function(){let t=this;Ng=[],t.timer=setInterval((function(){t.hitBalls()}),15)},addBall:async function(t){let e=window.$(t).data().uid;if(!e)return;if(Ng.indexOf(e)>-1)return;if(Ng.length>=9)return;$(t).show(),t.big=!1,Ng.push(e);let n=this,i=document.createDocumentFragment();t.diameter=n.diameter,t.radius=n.radius;let o=Gg[qg%6];t.centerX=o.centerX,t.centerY=o.centerY,t.vx=o.vx,t.vy=o.vy,qg++,t.offsetLeft2=t.centerX+Og,t.offsetTop2=t.centerY,t.style.transform=`translate3d(${t.offsetLeft2}px, ${t.offsetTop2}px, 0)`,t.angle=0,t.isCircleRun=!1,setTimeout((()=>{t.vx=0,t.vy=0,t.isCircleRun=!0,t.centerX=t.offsetLeft2-Og,t.centerY=t.offsetTop2,t.angle=0}),1500),i.appendChild(t),n.balls.push(t),n.ballSum++,n.container.appendChild(i)},getCurrentArr:function(){return Ng},getCurrentBalls:function(){return this.balls},addBigBall:function(t,e){console.log("add big ball");const{bigBallTrans:n="",bigBallAngle:i=""}=e;this.balls.forEach((e=>{e.big&&$(e).data().uid!=$(t).data().uid&&this.removeBall(e)}));let o=window.$(t).data().uid;if(!o)return;if(Ng.indexOf(o)>-1)return;$(t).show(),Ng.push(o);let s=this,a=document.createDocumentFragment();t.diameter=120,t.radius=60,t.centerX=250,t.centerY=80,t.offsetLeft2=t.centerX+Og,t.offsetTop2=t.centerY,n?(t.style.transform=n,t.angle=i):(t.style.transform=`translate3d(${t.offsetLeft2}px, ${t.offsetTop2}px, 0)`,t.angle=0),t.vx=.5,t.vy=.5,t.big=!0,a.appendChild(t),s.balls.push(t),s.ballSum++,s.container.appendChild(a)},removeBall:async function(t){return new Promise(((e,n)=>{let i=window.$(t).data().uid;console.log("remove ball="+i);let o=Ng.indexOf(i);if(o>-1){Ng.splice(o,1),this.ballSum--;let t=[];this.balls.forEach((e=>{$(e).data().uid==i?$(e).hide():t.push(e)})),this.balls=t}e(1)}))},hitBalls:function(){let t,e=this,n=e.ballSum,i=e.balls,o=0;for(let s=0;s<n-1;s++){let i=e.balls[s];i.big?(i.x=i.offsetLeft2+58,i.y=i.offsetTop2+58,t=58):(i.x=i.offsetLeft2+i.radius,i.y=i.offsetTop2+i.radius,t=i.radius);for(let a=s+1;a<n;a++){let n=e.balls[a];n.big?(n.x=n.offsetLeft2+58,n.y=n.offsetTop2+58,o=58):(n.x=n.offsetLeft2+n.radius,n.y=n.offsetTop2+n.radius,o=n.radius);let s=n.x-i.x,r=n.y-i.y,c=t+o;if(Math.sqrt(s*s+r*r)<c){let t=null;(i.isCircleRun||n.isCircleRun)&&(t=i.isCircleRun?i:n,t.isCircleRun=!1,setTimeout((()=>{t.vx=0,t.vy=0,t.angle=0,t.centerX=t.offsetLeft2-Og,t.centerY=t.offsetTop2,t.angle=0,t.isCircleRun=!0}),1e3));let o=Math.atan2(r,s),a=i.x+Math.cos(o)*c,l=i.y+Math.sin(o)*c,d=(a-n.x)*e.spring,m=(l-n.y)*e.spring;i.vx-=d,i.vy-=m,n.vx+=d,n.vy+=m;let h=1.8;i.vx>0&&i.vx>h&&(i.vx=h),i.vy>0&&i.vy>h&&(i.vy=h),n.vx>0&&n.vx>h&&(n.vx=h),n.vy>0&&n.vy>h&&(n.vy=h),i.vx<0&&i.vx<-h&&(i.vx=-h),i.vy<0&&i.vy<-h&&(i.vy=-h),n.vx<0&&n.vx<-h&&(n.vx=-h),n.vy<0&&n.vy<-h&&(n.vy=-h)}}}for(let s=0;s<n;s++)e.moveBalls(i[s])},moveBalls:function(t){let e=this;if(t.big)t.angle+=.02,t.offsetLeft2=t.centerX+Og*Math.cos(t.angle),t.offsetTop2=t.centerY+Og*Math.sin(t.angle),t.style.transform=`translate(${t.offsetLeft2}px, ${t.offsetTop2}px)`;else if(1==t.isCircleRun)t.angle+=.02,t.offsetLeft2=t.centerX+Og*Math.cos(t.angle),t.offsetTop2=t.centerY+Og*Math.sin(t.angle),t.style.transform=`translate(${t.offsetLeft2}px, ${t.offsetTop2}px)`;else{let n=e.L_bound,i=e.R_bound,o=e.T_bound,s=e.B_bound,a=e.bounce;t.offsetLeft2<n?(t.offsetLeft2=n,t.style.transform=`translate(${n}px, ${t.offsetTop2}px)`,t.vx*=a):t.offsetLeft2+t.diameter>i?(t.offsetLeft2=i-t.diameter,t.style.transform=`translate(${i-t.diameter}px, ${t.offsetTop2}px)`,t.vx*=a):t.offsetTop2<o&&(t.offsetTop2=o,t.style.transform=`translate(${t.offsetLeft2}px, ${o}px)`,t.vy*=a),t.offsetTop2+t.diameter>s&&(t.offsetTop2=s-t.diameter,t.style.transform=`translate(${t.offsetLeft2}px, ${s-t.diameter}px)`,t.vy*=a),t.offsetLeft2=t.offsetLeft2+t.vx,t.offsetTop2=t.offsetTop2+t.vy,t.style.transform=`translate(${t.offsetLeft2}px, ${t.offsetTop2}px)`}}};const Hg="src/js/chorusRoom/seats/item.svelte";function Wg(t){let e,n;e=new ye({props:{src:t[0].user.avatar},$$inline:!0});const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src=t[0].user.avatar),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Wg.name,type:"if",source:"(71:12) {#if data.user}",ctx:t}),i}function Kg(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f=t[0].user&&Wg(t);const w={c:function(){e=_("div"),n=_("div"),i=_("div"),f&&f.c(),o=T(),s=_("div"),a=T(),r=_("div"),c=T(),l=_("div"),y(i,"class","seat-user-head mic_white"),x(i,Hg,69,8,1957),y(s,"class","wave s-tXgwh8LUvrRx"),x(s,Hg,74,8,2111),y(r,"class","seat-face-svga"),x(r,Hg,75,8,2139),y(l,"class","effect s-tXgwh8LUvrRx"),x(l,Hg,76,8,2182),y(n,"class","justInnerCtn s-tXgwh8LUvrRx"),x(n,Hg,68,4,1922),y(e,"class",d="seat-item seat-item-empty chorus_seats-seat forbidFloat no_"+t[0].no+" s-tXgwh8LUvrRx"),y(e,"data-uid",m=t[0].user?t[0].user.uid:0),rt(e,"speaking",t[0].speaking),x(e,Hg,62,0,1710)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(d,m){b(d,e,m),I(e,n),I(n,i),f&&f.m(i,null),I(n,o),I(n,s),I(n,a),I(n,r),I(n,c),I(n,l),t[4](l),h=!0,u||(g=E(e,"mouseenter",t[2],!1,!1,!1,!1),u=!0)},p:function(t,[n]){t[0].user?f?(f.p(t,n),1&n&&q(f,1)):(f=Wg(t),f.c(),q(f,1),f.m(i,null)):f&&(W(),O(f,1,1,(()=>{f=null})),N()),(!h||1&n&&d!==(d="seat-item seat-item-empty chorus_seats-seat forbidFloat no_"+t[0].no+" s-tXgwh8LUvrRx"))&&y(e,"class",d),(!h||1&n&&m!==(m=t[0].user?t[0].user.uid:0))&&y(e,"data-uid",m),(!h||1&n)&&rt(e,"speaking",t[0].speaking)},i:function(t){h||(q(f),h=!0)},o:function(t){O(f),h=!1},d:function(n){n&&C(e),f&&f.d(),t[4](null),u=!1,g()}};return p("SvelteRegisterBlock",{block:w,id:Kg.name,type:"component",source:"",ctx:t}),w}function Yg(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Item",i,[]);let s,a,{data:r}=e;function c(t){a||r.user&&t.map((t=>1*t)).includes(1*r.user.uid)&&(l(),Zt.getInstance().loadParser(s,"https://asset.tuwan.com/chatroom/chorus/perfect.svga",1,!1).then((({player:t,videoItem:e})=>{a=t,t.setVideoItem(e),t.startAnimation(),t.onFinished((()=>{a=null}))}),(t=>{})))}function l(){a&&(a.stopAnimation(),a.clear(),a=null)}function d(t){t.stopPropagation();const e=window.$(this),n=e.offset(),i=e.width(),o=e.height();kd.showUserFloatInfo({account:this.dataset.uid,roomChannel:uu.getChannel()}).then((t=>{t.css({top:n.top+o,left:n.left+(i-t.width())/2}),t.show()}))}ut((()=>{l()})),t.$$.on_mount.push((function(){void 0!==r||"data"in e||t.$$.bound[t.$$.props.data]||console.warn("<Item> was created without expected prop 'data'")}));const m=["data"];return Object.keys(e).forEach((t=>{~m.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Item> was created with unknown prop '${t}'`)})),t.$$set=t=>{"data"in t&&n(0,r=t.data)},t.$capture_state=()=>({onDestroy:ut,Img:ye,SvgaPlayer:Zt,gloabDDChatui:kd,common:uu,data:r,playPerfect:c,effectRef:s,playerHandle:a,clearPlayer:l,mouseenter:d}),t.$inject_state=t=>{"data"in t&&n(0,r=t.data),"effectRef"in t&&n(1,s=t.effectRef),"playerHandle"in t&&(a=t.playerHandle)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[r,s,d,c,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(1,s)}))}]}class Jg extends h{constructor(t){super(t),u(this,t,Yg,Kg,g,{data:0,playPerfect:3}),p("SvelteRegisterComponent",{component:this,tagName:"Item",options:t,id:Kg.name})}get data(){throw new Error("<Item>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set data(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playPerfect(){return this.$$.ctx[3]}set playPerfect(t){throw new Error("<Item>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{Map:Qg,console:Xg}=et,Zg="src/js/chorusRoom/seats/index.svelte";function tf(t,e,n){const i=t.slice();return i[18]=e[n],i}function ef(t,e,n){const i=t.slice();return i[21]=e[n],i[22]=e,i[23]=n,i}function nf(t){let e,n,i,o,s=uu.isBallCollisionChorusRoom()&&!t[0].length&&!t[3][2][2].user,a=t[3];v(a);let r=[];for(let m=0;m<a.length;m+=1)r[m]=sf(tf(t,a,m));const c=t=>O(r[t],1,1,(()=>{r[t]=null}));let l=s&&af(t);const d={c:function(){e=_("div");for(let t=0;t<r.length;t+=1)r[t].c();n=T(),l&&l.c(),i=ht(),y(e,"class","chorus_seats s-U04ddDiEPnoa"),y(e,"style","visibility: "+(uu.isBallCollisionChorusRoom()?"hidden":"visible")),x(e,Zg,240,4,9482)},m:function(t,s){b(t,e,s);for(let n=0;n<r.length;n+=1)r[n]&&r[n].m(e,null);b(t,n,s),l&&l.m(t,s),b(t,i,s),o=!0},p:function(t,n){if(12&n){let i;for(a=t[3],v(a),i=0;i<a.length;i+=1){const o=tf(t,a,i);r[i]?(r[i].p(o,n),q(r[i],1)):(r[i]=sf(o),r[i].c(),q(r[i],1),r[i].m(e,null))}for(W(),i=a.length;i<r.length;i+=1)c(i);N()}9&n&&(s=uu.isBallCollisionChorusRoom()&&!t[0].length&&!t[3][2][2].user),s?l||(l=af(t),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},i:function(t){if(!o){for(let t=0;t<a.length;t+=1)q(r[t]);o=!0}},o:function(t){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)O(r[e]);o=!1},d:function(t){t&&C(e),S(r,t),t&&C(n),l&&l.d(t),t&&C(i)}};return p("SvelteRegisterBlock",{block:d,id:nf.name,type:"if",source:"(240:0) {#if stage == ACT_STAGE_PLAYING || common.isNewChorusRoom()}",ctx:t}),d}function of(t,e){let n,i,o,s=e[21];const a=()=>e[13](i,s),r=()=>e[13](null,s);let c={data:e[21]};i=new Jg({props:c,$$inline:!0}),a();const l={key:t,first:null,c:function(){n=ht(),U(i.$$.fragment),this.first=n},m:function(t,e){b(t,n,e),z(i,t,e),o=!0},p:function(t,n){s!==(e=t)[21]&&(r(),s=e[21],a());const o={};8&n&&(o.data=e[21]),i.$set(o)},i:function(t){o||(q(i.$$.fragment,t),o=!0)},o:function(t){O(i.$$.fragment,t),o=!1},d:function(t){t&&C(n),r(),G(i,t)}};return p("SvelteRegisterBlock",{block:l,id:of.name,type:"each",source:"(244:16) {#each numbers as item, i (item?.user?.uid || i)}",ctx:e}),l}function sf(t){let e,n,i,o=[],s=new Qg,a=t[18];v(a);const r=t=>{var e,n;return(null==(n=null==(e=t[21])?void 0:e.user)?void 0:n.uid)||t[23]};gt(t,a,ef,r);for(let l=0;l<a.length;l+=1){let e=ef(t,a,l),n=r(e);s.set(n,o[l]=of(n,e))}const c={c:function(){e=_("div");for(let t=0;t<o.length;t+=1)o[t].c();n=T(),y(e,"class","chorus_seats-row s-U04ddDiEPnoa"),x(e,Zg,242,12,9645)},m:function(t,s){b(t,e,s);for(let n=0;n<o.length;n+=1)o[n]&&o[n].m(e,null);I(e,n),i=!0},p:function(t,i){12&i&&(a=t[18],v(a),W(),gt(t,a,ef,r),o=ft(o,i,r,1,t,a,s,e,wt,of,n,ef),N())},i:function(t){if(!i){for(let t=0;t<a.length;t+=1)q(o[t]);i=!0}},o:function(t){for(let e=0;e<o.length;e+=1)O(o[e]);i=!1},d:function(t){t&&C(e);for(let e=0;e<o.length;e+=1)o[e].d()}};return p("SvelteRegisterBlock",{block:c,id:sf.name,type:"each",source:"(242:8) {#each renderNumbers as numbers}",ctx:t}),c}function af(t){let e,n,i,o,s;const a={c:function(){e=_("div"),n=_("img"),o=T(),s=_("div"),s.textContent="合唱即将开始",y(n,"alt",""),A(n,"width","300px"),L(n.src,i="https://asset.tuwan.com/chatroom/chorus/hechang_nodata.png")||y(n,"src","https://asset.tuwan.com/chatroom/chorus/hechang_nodata.png"),x(n,Zg,251,12,10099),A(s,"margin-top","10px"),x(s,Zg,252,12,10211),A(e,"margin","0px auto"),A(e,"text-align","center"),A(e,"color","white"),A(e,"font-size","18px"),A(e,"padding-top","50px"),x(e,Zg,250,8,9989)},m:function(t,i){b(t,e,i),I(e,n),I(e,o),I(e,s)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:a,id:af.name,type:"if",source:"(250:4) {#if common.isBallCollisionChorusRoom() && !userList.length && !renderNumbers[2][2]['user']}",ctx:t}),a}function rf(t){let e,n,i=3==t[1]||uu.isNewChorusRoom(),o=i&&nf(t);const s={c:function(){o&&o.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){o&&o.m(t,i),b(t,e,i),n=!0},p:function(t,[n]){2&n&&(i=3==t[1]||uu.isNewChorusRoom()),i?o?(o.p(t,n),2&n&&q(o,1)):(o=nf(t),o.c(),q(o,1),o.m(e.parentNode,e)):o&&(W(),O(o,1,1,(()=>{o=null})),N())},i:function(t){n||(q(o),n=!0)},o:function(t){O(o),n=!1},d:function(t){o&&o.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:s,id:rf.name,type:"component",source:"",ctx:t}),s}const cf=1;function lf(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Seats",i,[]);let{userList:s=[]}=e,{stage:a=zg}=e,{voiceList:r=[]}=e;function c(t){for(const e of m)e&&e.playPerfect(t)}function l(){let t=[];for(const e of b)for(const n of e)n.user&&t.push(n.user);return t}let d=[];const m=[];let h=!1,u=null,p=!1,g=0,w=400,v=55==uu.roomInfo.typeid;function _(){console.log("forceUpdate"),n(12,g+=1)}function y(t){if(3==a){s.find((t=>t.uid==uu.getMeid()))&&n(11,p=t>0)}}const x=[[11,10,12],[8,6,7,9],[4,2,cf,3,5]].map((t=>t.map((t=>t+3))));let b=x.map((t=>t.map((t=>({no:t,user:null,speaking:!1})))));const $=["userList","stage","voiceList"];return Object.keys(e).forEach((t=>{~$.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||Xg.warn(`<Seats> was created with unknown prop '${t}'`)})),t.$$set=t=>{"userList"in t&&n(0,s=t.userList),"stage"in t&&n(1,a=t.stage),"voiceList"in t&&n(4,r=t.voiceList)},t.$capture_state=()=>({common:uu,ACT_STAGE_PREPARE:zg,ACT_STAGE_PLAYING:3,Screen:Vg,Item:Jg,userList:s,stage:a,voiceList:r,playPerfect:c,getSeats:l,originUserList:d,refs:m,isHaveInit:h,sc:u,mineSpeaking:p,forceUpateIndex:g,tempTime:w,isBallCollision:v,forceUpdate:_,updateMineVolume:y,BASE_NUMBER:3,ONE:cf,numberss:x,renderNumbers:b}),t.$inject_state=t=>{"userList"in t&&n(0,s=t.userList),"stage"in t&&n(1,a=t.stage),"voiceList"in t&&n(4,r=t.voiceList),"originUserList"in t&&(d=t.originUserList),"isHaveInit"in t&&n(9,h=t.isHaveInit),"sc"in t&&n(10,u=t.sc),"mineSpeaking"in t&&n(11,p=t.mineSpeaking),"forceUpateIndex"in t&&n(12,g=t.forceUpateIndex),"tempTime"in t&&n(15,w=t.tempTime),"isBallCollision"in t&&(v=t.isBallCollision),"renderNumbers"in t&&n(3,b=t.renderNumbers)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(7699&t.$$.dirty&&(uu.isBallCollisionChorusRoom()&&!h&&(n(10,u=new Vg("chorus-content-center_members",{ballSum:0,spring:.3,bounce:-.9,gravity:0})),u.initialize(),n(9,h=!0)),3==a||uu.isNewChorusRoom())){const t=new Map,e=new Map;for(const n of s)t.set(String(n.uid),n),e.set(String(n.position),n);const i=uu.getMeid(),o=t.get(String(i)),a=3+cf,c=e.get(String(a));if(o)null!=c&&c.uid==i||(c&&c.uid!=i?e.set(String(o.position),c):e.set(String(o.position),null),e.set(String(a),o));else if(0==s.length||null==c){const t=uu.getAnchoringUser();t&&e.set(String(a),t)}const l=r.map((t=>String(t)));p&&!l.includes(String(i))&&l.push(String(i));let d="",m=0;if(uu.isBallCollisionChorusRoom()){let t=window.$("#chorus-content-center_members .seat-item-empty"),n=u.getCurrentArr(),i=[];s.length&&(s.forEach((t=>{i.push(`${t.uid}`)})),Array.prototype.forEach.call(t,(t=>{let o=t.getAttribute("data-uid");u.getCurrentBalls().forEach((t=>{t.big&&(d=t.style.transform,m=t.angle)})),n.indexOf(parseInt(o))>-1&&-1==i.indexOf(o)&&e.get("4")&&e.get("4").uid!=o&&setTimeout((()=>{u.removeBall(t)}),w),0!=o&&(-1==i.indexOf(o)&&(window.$(t).hasClass("no_4")||window.$(t).find(".justInnerCtn").addClass("circleElementFadeOut")),e.get("4")&&o==e.get("4").uid&&!window.$(t).hasClass("no_4")?(console.log("hide big ball11"),u.removeBall(t),setTimeout((()=>{u.removeBall(t)}),w)):window.$(t).hasClass("no_4")&&e.get("4")&&o!=e.get("4").uid&&setTimeout((()=>{u.removeBall(t)}),w))})))}setTimeout((()=>{n(3,b=x.map((t=>t.map((t=>{const n=e.get(String(t));return{no:t,user:n,speaking:!!n&&l.includes(String(n.uid))}}))))),uu.isBallCollisionChorusRoom()&&setTimeout((()=>{let t=window.$("#chorus-content-center_members .seat-item-empty");Array.prototype.forEach.call(t,(t=>{window.$(t).hasClass("no_4")?u.addBigBall(t,{bigBallTrans:d,bigBallAngle:m}):window.$(t).data().uid&&u.addBall(t)}))}),50)}),w)}},[s,a,m,b,r,c,l,_,y,h,u,p,g,function(t,e){Y[t?"unshift":"push"]((()=>{m[e.no]=t,n(2,m)}))}]}class df extends h{constructor(t){super(t),u(this,t,lf,rf,g,{userList:0,stage:1,voiceList:4,playPerfect:5,getSeats:6,forceUpdate:7,updateMineVolume:8}),p("SvelteRegisterComponent",{component:this,tagName:"Seats",options:t,id:rf.name})}get userList(){throw new Error("<Seats>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set userList(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get stage(){throw new Error("<Seats>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set stage(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get voiceList(){throw new Error("<Seats>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set voiceList(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get playPerfect(){return this.$$.ctx[5]}set playPerfect(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get getSeats(){return this.$$.ctx[6]}set getSeats(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[7]}set forceUpdate(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get updateMineVolume(){return this.$$.ctx[8]}set updateMineVolume(t){throw new Error("<Seats>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const mf="src/js/chorusRoom/musicCountdown/index.svelte";function hf(t){let e,n,i,o,s,a;n=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/muisc_count_down.png"},$$inline:!0});const r={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),s=M(t[0]),y(o,"class","s-z5aFFsxtbdz5"),x(o,mf,37,4,877),y(e,"class","music_countdown s-z5aFFsxtbdz5"),x(e,mf,35,0,765)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,r){b(t,e,r),z(n,e,null),I(e,i),I(e,o),I(o,s),a=!0},p:function(t,[e]){(!a||1&e)&&P(s,t[0])},i:function(t){a||(q(n.$$.fragment,t),a=!0)},o:function(t){O(n.$$.fragment,t),a=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:r,id:hf.name,type:"component",source:"",ctx:t}),r}function uf(t){return String(parseInt(String(t/60))).padStart(2,"0")+":"+String(t%60).padStart(2,"0")}function pf(t,e,n){let i,{$$slots:o={},$$scope:s}=e;f("MusicCountdown",o,[]);let{seconds:a}=e,r=0;w((()=>{n(2,r=a||0),r<0&&n(2,r=0);let t=setInterval((()=>{n(2,r-=1),r<=0&&window.clearInterval(t)}),1e3);return()=>{window.clearInterval(t)}})),t.$$.on_mount.push((function(){void 0!==a||"seconds"in e||t.$$.bound[t.$$.props.seconds]||console.warn("<MusicCountdown> was created without expected prop 'seconds'")}));const c=["seconds"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MusicCountdown> was created with unknown prop '${t}'`)})),t.$$set=t=>{"seconds"in t&&n(1,a=t.seconds)},t.$capture_state=()=>({onMount:w,Img:ye,seconds:a,_seconds:r,formatTime:uf,textTime:i}),t.$inject_state=t=>{"seconds"in t&&n(1,a=t.seconds),"_seconds"in t&&n(2,r=t._seconds),"textTime"in t&&n(0,i=t.textTime)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{4&t.$$.dirty&&n(0,i=uf(r))},[i,a,r]}class gf extends h{constructor(t){super(t),u(this,t,pf,hf,g,{seconds:1}),p("SvelteRegisterComponent",{component:this,tagName:"MusicCountdown",options:t,id:hf.name})}get seconds(){throw new Error("<MusicCountdown>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set seconds(t){throw new Error("<MusicCountdown>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ff="src/js/chorusRoom/score/index.svelte";function wf(t){let e,n,i,o;const s={c:function(){e=_("div"),n=_("p"),n.textContent="得分",i=T(),o=_("p"),y(n,"class","name s-ybmcXo1qp4aV"),x(n,ff,21,4,384),y(o,"class","value s-ybmcXo1qp4aV"),x(o,ff,22,4,411),y(e,"class","shorus_score s-ybmcXo1qp4aV"),x(e,ff,20,0,353)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(s,a){b(s,e,a),I(e,n),I(e,i),I(e,o),t[3](o)},p:k,i:k,o:k,d:function(n){n&&C(e),t[3](null)}};return p("SvelteRegisterBlock",{block:s,id:wf.name,type:"component",source:"",ctx:t}),s}function vf(t,e,n){let{$$slots:i={},$$scope:o}=e;f("Score",i,[]);let s,a,{score:r=0}=e;w((()=>{n(2,a=new Al(s,r,{separator:""}))}));const c=["score"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Score> was created with unknown prop '${t}'`)})),t.$$set=t=>{"score"in t&&n(1,r=t.score)},t.$capture_state=()=>({onMount:w,CountUp:Al,score:r,valueDom:s,countup:a}),t.$inject_state=t=>{"score"in t&&n(1,r=t.score),"valueDom"in t&&n(0,s=t.valueDom),"countup"in t&&n(2,a=t.countup)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{6&t.$$.dirty&&r>0&&a&&a.update(r)},[s,r,a,function(t){Y[t?"unshift":"push"]((()=>{s=t,n(0,s)}))}]}class _f extends h{constructor(t){super(t),u(this,t,vf,wf,g,{score:1}),p("SvelteRegisterComponent",{component:this,tagName:"Score",options:t,id:wf.name})}get score(){throw new Error("<Score>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set score(t){throw new Error("<Score>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const yf="src/js/chorusRoom/mainButton/index.svelte";function xf(t){let e,n,i,o,s,a;const r={c:function(){e=_("div"),n=M(t[1]),i=T(),o=_("div"),y(o,"class","progressBar s-xFpMzi6A3c8-"),A(o,"width",Math.ceil(t[0]?82*t[2]:0)+"%"),x(o,yf,185,4,6079),y(e,"role","presentation"),y(e,"class","chorus_main_btn s-xFpMzi6A3c8-"),y(e,"style",`margin-top: ${uu.isBallCollisionChorusRoom()?"0":"40"}px;`),rt(e,"blue",t[1]==kf||t[3].mineIsChorus()),x(e,yf,180,0,5843)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(r,c){b(r,e,c),I(e,n),I(e,i),I(e,o),s||(a=E(e,"click",t[4],!1,!1,!1,!1),s=!0)},p:function(t,[i]){2&i&&P(n,t[1]),5&i&&A(o,"width",Math.ceil(t[0]?82*t[2]:0)+"%"),10&i&&rt(e,"blue",t[1]==kf||t[3].mineIsChorus())},i:k,o:k,d:function(t){t&&C(e),s=!1,a()}};return p("SvelteRegisterBlock",{block:r,id:xf.name,type:"component",source:"",ctx:t}),r}const bf="选择歌曲",$f="加入合唱",kf="离开合唱";function Cf(){}function If(t,e,n){let{$$slots:i={},$$scope:o}=e;f("MainButton",i,[]);let{stage:s=-1}=e,{download:a=!1}=e;function r(){n(10,d+=1)}function c(){(3==s||uu.isNewChorusRoom())&&qt.get(Ot.getChorusJoin(uu.getCid(),p.actInfo.song_info.song_code)).then((t=>{if(0!=t.error){if(uu.isNewChorusRoom()&&uu.isAnchors2(uu.getMeid()))return;p.destroyLoadMuisc(),Vt(t.error_msg)}}))}function l(t){t<.8&&0==u?u=(new Date).getTime():u>0&&(new Date).getTime()-u>30&&n(2,h=t)}let d=0,m="即将开始",h=0,u=0;const p=nw.getInstance();let g=null;function w(){switch(m){case bf:p.showMusicLibrary();break;case $f:if(uu.getMeid()>Mt.maxUID)return void(p.showLoginWindow&&p.showLoginWindow());if(g)return void Vt("不要频繁点击加入合唱");g=setTimeout((()=>{window.clearTimeout(g),g=null}),3e3),uu.isYinSuDa()?c():p.hasSong()?p.downloadSong(p.actInfo.song_info,!0):c();break;case kf:qt.get(Ot.getChorusQuit(uu.getCid(),p.actInfo.song_info.song_code)).then((t=>{0!=t.error?Vt(t.error_msg):p.chorusAutoCloseMicrophone()}))}}const v=["stage","download"];return Object.keys(e).forEach((t=>{~v.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MainButton> was created with unknown prop '${t}'`)})),t.$$set=t=>{"stage"in t&&n(5,s=t.stage),"download"in t&&n(0,a=t.download)},t.$capture_state=()=>({ACT_STAGE_PREPARE:zg,ACT_STAGE_COUNTDOWN:2,ACT_STAGE_PLAYING:3,ACT_STAGE_END:4,ChorusRoom:nw,common:uu,request:qt,ChatUrls:Ot,ChatConfig:Mt,showTips:Vt,stage:s,download:a,forceUpdate:r,checkIsJoinState:c,clearJoinLock:Cf,setPercent:l,forceUpdateIndex:d,title:m,percent:h,protectTime:u,instance:p,TITLE_CHOICE_MUSIC:bf,TITLE_JOIN:$f,TITLE_QUIT:kf,lockJoinTimer:g,btnClick:w}),t.$inject_state=t=>{"stage"in t&&n(5,s=t.stage),"download"in t&&n(0,a=t.download),"forceUpdateIndex"in t&&n(10,d=t.forceUpdateIndex),"title"in t&&n(1,m=t.title),"percent"in t&&n(2,h=t.percent),"protectTime"in t&&(u=t.protectTime),"lockJoinTimer"in t&&(g=t.lockJoinTimer)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(1057&t.$$.dirty)if(-1==s)n(1,m="即将开始");else if(a)n(1,m="伴奏加载中");else if(p.mineIsAnchor())uu.isChorusMoreRoom()?n(1,m=3==s?"合唱中":"即将开始"):n(1,m=bf);else if(uu.isNewChorusRoom())p.mineIsGuest()?n(1,m="合唱中"):p.mineIsChorus()?n(1,m=kf):n(1,m=$f);else switch(s){case zg:case 2:n(1,m="即将开始");break;case 3:p.mineIsGuest()?n(1,m="合唱中"):p.mineIsChorus()?n(1,m=kf):n(1,m=$f);break;case 4:n(1,m="即将开始")}1&t.$$.dirty&&0==a&&(n(2,h=0),u=0)},[a,m,h,p,w,s,r,c,Cf,l,d]}class Sf extends h{constructor(t){super(t),u(this,t,If,xf,g,{stage:5,download:0,forceUpdate:6,checkIsJoinState:7,clearJoinLock:8,setPercent:9}),p("SvelteRegisterComponent",{component:this,tagName:"MainButton",options:t,id:xf.name})}get stage(){throw new Error("<MainButton>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set stage(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get download(){throw new Error("<MainButton>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set download(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get forceUpdate(){return this.$$.ctx[6]}set forceUpdate(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get checkIsJoinState(){return this.$$.ctx[7]}set checkIsJoinState(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get clearJoinLock(){return Cf}set clearJoinLock(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get setPercent(){return this.$$.ctx[9]}set setPercent(t){throw new Error("<MainButton>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Tf="src/js/chorusRoom/handclap/index.svelte";function Rf(t){let e,n,i,o,s,a,r;n=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/guzhang.png"},$$inline:!0});const c={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("div"),y(o,"class","s-cMq4022kqWgX"),x(o,Tf,49,4,1543),y(e,"class","chorus_handclap s-cMq4022kqWgX"),x(e,Tf,47,0,1423)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(c,l){b(c,e,l),z(n,e,null),I(e,i),I(e,o),t[3](o),s=!0,a||(r=E(e,"click",t[1],!1,!1,!1,!1),a=!0)},p:k,i:function(t){s||(q(n.$$.fragment,t),s=!0)},o:function(t){O(n.$$.fragment,t),s=!1},d:function(i){i&&C(e),G(n),t[3](null),a=!1,r()}};return p("SvelteRegisterBlock",{block:c,id:Rf.name,type:"component",source:"",ctx:t}),c}function Mf(t,e,n){let i,{$$slots:o={},$$scope:s}=e;function a(){c.volume(xt.getInstance().getMainVolume()/100*.5),c.play()}f("Handclap",o,[]);const r=nw.getInstance();var c=new window.Howl({src:["https://asset.tuwan.com/chatroom/chorus/guzhang.mp3"],volume:xt.getInstance().getMainVolume()/100*.5});function l(){a(),r.mineIsAnchor()&&qt.get(Ot.getChorusReportHandClap(uu.getCid(),r.actInfo.song_info.song_code))}w((()=>{const t=setInterval((()=>{Zt.getInstance().loadParser(i,"https://asset.tuwan.com/chatroom/chorus/guzhang.svga",1,!1).then((({player:t,videoItem:e})=>{t.setVideoItem(e),t.startAnimation()}),(t=>{}))}),15e3);return()=>clearInterval(t)}));const d=[];return Object.keys(e).forEach((t=>{~d.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<Handclap> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({onMount:w,ChatUrls:Ot,common:uu,request:qt,ChorusRoom:nw,SvgaPlayer:Zt,Img:ye,SessionStorage:xt,playEffect:a,svgaDom:i,instance:r,sound:c,click:l}),t.$inject_state=t=>{"svgaDom"in t&&n(0,i=t.svgaDom),"sound"in t&&(c=t.sound)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[i,l,a,function(t){Y[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}class Af extends h{constructor(t){super(t),u(this,t,Mf,Rf,g,{playEffect:2}),p("SvelteRegisterComponent",{component:this,tagName:"Handclap",options:t,id:Rf.name})}get playEffect(){return this.$$.ctx[2]}set playEffect(t){throw new Error("<Handclap>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Pf="src/js/chorusRoom/chorusCount/index.svelte";function jf(t){let e,n,i,o,s,a,r,c,l,d=t[0].length+"";a=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/arrow.png"},$$inline:!0});const m={c:function(){e=_("div"),n=_("p"),i=M(d),o=M("人合唱"),s=T(),U(a.$$.fragment),y(n,"class","s-cI7rgzI-CUMg"),x(n,Pf,15,8,313),y(e,"class","chorus_count s-cI7rgzI-CUMg"),x(e,Pf,14,4,278)},m:function(d,m){b(d,e,m),I(e,n),I(n,i),I(n,o),I(e,s),z(a,e,null),r=!0,c||(l=E(n,"click",t[1],!1,!1,!1,!1),c=!0)},p:function(t,e){(!r||1&e)&&d!==(d=t[0].length+"")&&P(i,d)},i:function(t){r||(q(a.$$.fragment,t),r=!0)},o:function(t){O(a.$$.fragment,t),r=!1},d:function(t){t&&C(e),G(a),c=!1,l()}};return p("SvelteRegisterBlock",{block:m,id:jf.name,type:"if",source:"(14:0) {#if list && list.length > 0}",ctx:t}),m}function Df(t){let e,n,i=t[0]&&t[0].length>0&&jf(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[0]&&t[0].length>0?i?(i.p(t,n),1&n&&q(i,1)):(i=jf(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Df.name,type:"component",source:"",ctx:t}),o}function Lf(t,e,n){let{$$slots:i={},$$scope:o}=e;f("ChorusCount",i,[]);let{list:s=[]}=e;const a=nw.getInstance();function r(){a.showSingModal()}const c=["list"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<ChorusCount> was created with unknown prop '${t}'`)})),t.$$set=t=>{"list"in t&&n(0,s=t.list)},t.$capture_state=()=>({ChorusRoom:nw,Img:ye,list:s,instance:a,click:r}),t.$inject_state=t=>{"list"in t&&n(0,s=t.list)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,r]}class Ef extends h{constructor(t){super(t),u(this,t,Lf,Df,g,{list:0}),p("SvelteRegisterComponent",{component:this,tagName:"ChorusCount",options:t,id:Df.name})}get list(){throw new Error("<ChorusCount>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set list(t){throw new Error("<ChorusCount>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Bf="src/js/chorusRoom/musicName/index.svelte";function Ff(t){let e,n,i,o,s,a;n=new ye({props:{src:"https://asset.tuwan.com/chatroom/chorus/music_logo.png"},$$inline:!0});const r={c:function(){e=_("div"),U(n.$$.fragment),i=T(),o=_("p"),s=M(t[1]),y(o,"class","s-89sQqI6NLEB3"),x(o,Bf,24,8,650),y(e,"class","muisc_name s-89sQqI6NLEB3"),x(e,Bf,22,4,541)},m:function(t,r){b(t,e,r),z(n,e,null),I(e,i),I(e,o),I(o,s),a=!0},p:function(t,e){(!a||2&e)&&P(s,t[1])},i:function(t){a||(q(n.$$.fragment,t),a=!0)},o:function(t){O(n.$$.fragment,t),a=!1},d:function(t){t&&C(e),G(n)}};return p("SvelteRegisterBlock",{block:r,id:Ff.name,type:"if",source:"(22:0) {#if stage == ACT_STAGE_COUNTDOWN || stage == ACT_STAGE_PLAYING}",ctx:t}),r}function Uf(t){let e,n,i=(2==t[0]||3==t[0])&&Ff(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){2==t[0]||3==t[0]?i?(i.p(t,n),1&n&&q(i,1)):(i=Ff(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Uf.name,type:"component",source:"",ctx:t}),o}function zf(t,e,n){let{$$slots:i={},$$scope:o}=e;f("MusicName",i,[]);let{stage:s}=e;const a=nw.getInstance();let r="";t.$$.on_mount.push((function(){void 0!==s||"stage"in e||t.$$.bound[t.$$.props.stage]||console.warn("<MusicName> was created without expected prop 'stage'")}));const c=["stage"];return Object.keys(e).forEach((t=>{~c.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<MusicName> was created with unknown prop '${t}'`)})),t.$$set=t=>{"stage"in t&&n(0,s=t.stage)},t.$capture_state=()=>({Img:ye,ACT_STAGE_COUNTDOWN:2,ACT_STAGE_PLAYING:3,ChorusRoom:nw,stage:s,instance:a,title:r}),t.$inject_state=t=>{"stage"in t&&n(0,s=t.stage),"title"in t&&n(1,r=t.title)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{1&t.$$.dirty&&n(1,r=2==s||3==s?a.actInfo.song_info.name.substr(0,10):"")},[s,r]}class Of extends h{constructor(t){super(t),u(this,t,zf,Uf,g,{stage:0}),p("SvelteRegisterComponent",{component:this,tagName:"MusicName",options:t,id:Uf.name})}get stage(){throw new Error("<MusicName>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set stage(t){throw new Error("<MusicName>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function Nf(t){let e,n;e=new ye({props:{class:"chorus_origin_control_btn",src:"https://asset.tuwan.com/chatroom/chorus/"+(t[0]?"origin_open":"origin_close")+".png?a=1"},$$inline:!0}),e.$on("click",t[2]);const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:function(t,n){const i={};1&n&&(i.src="https://asset.tuwan.com/chatroom/chorus/"+(t[0]?"origin_open":"origin_close")+".png?a=1"),e.$set(i)},i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Nf.name,type:"if",source:"(41:0) {#if show}",ctx:t}),i}function qf(t){let e,n,i=t[1]&&Nf(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[1]?i?(i.p(t,n),2&n&&q(i,1)):(i=Nf(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:qf.name,type:"component",source:"",ctx:t}),o}function Gf(t,e,n){let{$$slots:i={},$$scope:o}=e;function s(){n(6,d+=1)}function a(){return c}f("OriginControl",i,[]);const r=nw.getInstance();let c=!1,l=!1,d=0;function m(){n(0,c=!c),r.loadMuisc&&(n(5,r.loadMuisc.defaultGain=c?1:0,r),8==r.loadMuisc.status&&r.loadMuisc.onTaggerGain())}const h=[];return Object.keys(e).forEach((t=>{~h.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<OriginControl> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({Img:ye,PLAY_STATUS_PLAYING:8,ChorusRoom:nw,forceUpdate:s,getOpenState:a,instance:r,open:c,show:l,forceUpdateIndex:d,btnClick:m}),t.$inject_state=t=>{"open"in t&&n(0,c=t.open),"show"in t&&n(1,l=t.show),"forceUpdateIndex"in t&&n(6,d=t.forceUpdateIndex)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{96&t.$$.dirty&&n(1,l=!r.mineIsAudience())},[c,l,m,s,a,r,d]}class Vf extends h{constructor(t){super(t),u(this,t,Gf,qf,g,{forceUpdate:3,getOpenState:4}),p("SvelteRegisterComponent",{component:this,tagName:"OriginControl",options:t,id:qf.name})}get forceUpdate(){return this.$$.ctx[3]}set forceUpdate(t){throw new Error("<OriginControl>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get getOpenState(){return this.$$.ctx[4]}set getOpenState(t){throw new Error("<OriginControl>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}function Hf(t){let e,n;e=new ye({props:{class:"chorus_adjust_volume_btn",src:"https://asset.tuwan.com/chatroom/chorus/adjust_volume.png"},$$inline:!0}),e.$on("click",t[1]);const i={c:function(){U(e.$$.fragment)},m:function(t,i){z(e,t,i),n=!0},p:k,i:function(t){n||(q(e.$$.fragment,t),n=!0)},o:function(t){O(e.$$.fragment,t),n=!1},d:function(t){G(e,t)}};return p("SvelteRegisterBlock",{block:i,id:Hf.name,type:"if",source:"(26:0) {#if show}",ctx:t}),i}function Wf(t){let e,n,i=t[0]&&Hf(t);const o={c:function(){i&&i.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,o){i&&i.m(t,o),b(t,e,o),n=!0},p:function(t,[n]){t[0]?i?(i.p(t,n),1&n&&q(i,1)):(i=Hf(t),i.c(),q(i,1),i.m(e.parentNode,e)):i&&(W(),O(i,1,1,(()=>{i=null})),N())},i:function(t){n||(q(i),n=!0)},o:function(t){O(i),n=!1},d:function(t){i&&i.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:o,id:Wf.name,type:"component",source:"",ctx:t}),o}function Kf(t,e,n){let{$$slots:i={},$$scope:o}=e;function s(){n(3,c+=1)}f("AdjustVolume",i,[]);const a=nw.getInstance();let r=!1,c=0;function l(){a.showAdjustVolumeModal()}const d=[];return Object.keys(e).forEach((t=>{~d.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<AdjustVolume> was created with unknown prop '${t}'`)})),t.$capture_state=()=>({Img:ye,ChorusRoom:nw,forceUpdate:s,instance:a,show:r,forceUpdateIndex:c,btnClick:l}),t.$inject_state=t=>{"show"in t&&n(0,r=t.show),"forceUpdateIndex"in t&&n(3,c=t.forceUpdateIndex)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{8&t.$$.dirty&&n(0,r=!a.mineIsAudience())},[r,l,s,c]}class Yf extends h{constructor(t){super(t),u(this,t,Kf,Wf,g,{forceUpdate:2}),p("SvelteRegisterComponent",{component:this,tagName:"AdjustVolume",options:t,id:Wf.name})}get forceUpdate(){return this.$$.ctx[2]}set forceUpdate(t){throw new Error("<AdjustVolume>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Jf="src/js/chorusRoom/adjustVolumeModal/index.svelte";function Qf(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,v,$,k;function S(e){t[4](e)}i=new ye({props:{class:"close_btn",src:"https://asset.tuwan.com/chatroom/chorus/close_white.png"},$$inline:!0}),i.$on("click",(function(){H(t[0])&&t[0].apply(this,arguments)}));let R={};void 0!==t[2]&&(R.value=t[2]),h=new ec({props:R,$$inline:!0}),Y.push((()=>X(h,"value",S))),h.$on("change",(function(){H(t[1])&&t[1].apply(this,arguments)}));const A={c:function(){e=_("div"),n=_("div"),U(i.$$.fragment),o=T(),s=_("p"),s.textContent="伴奏音量",a=T(),r=_("p"),c=M("当前："),l=_("span"),d=M(t[2]),m=T(),U(h.$$.fragment),g=T(),f=_("div"),w=_("p"),w.textContent="0",v=T(),$=_("p"),$.textContent="100",y(s,"class","title s-scULp_R7tXSp"),x(s,Jf,14,8,434),y(l,"class","s-scULp_R7tXSp"),x(l,Jf,15,30,490),y(r,"class","current s-scULp_R7tXSp"),x(r,Jf,15,8,468),y(w,"class","s-scULp_R7tXSp"),x(w,Jf,19,12,641),y($,"class","s-scULp_R7tXSp"),x($,Jf,20,12,662),y(f,"class","values flex flex-between s-scULp_R7tXSp"),x(f,Jf,18,8,590),y(n,"class","body s-scULp_R7tXSp"),x(n,Jf,12,4,290),y(e,"class","adjust_volume_modal s-scULp_R7tXSp"),x(e,Jf,11,0,252)},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,u){b(t,e,u),I(e,n),z(i,n,null),I(n,o),I(n,s),I(n,a),I(n,r),I(r,c),I(r,l),I(l,d),I(n,m),z(h,n,null),I(n,g),I(n,f),I(f,w),I(f,v),I(f,$),k=!0},p:function(e,[n]){t=e,(!k||4&n)&&P(d,t[2]);const i={};!u&&4&n&&(u=!0,i.value=t[2],Z((()=>u=!1))),h.$set(i)},i:function(t){k||(q(i.$$.fragment,t),q(h.$$.fragment,t),k=!0)},o:function(t){O(i.$$.fragment,t),O(h.$$.fragment,t),k=!1},d:function(t){t&&C(e),G(i),G(h)}};return p("SvelteRegisterBlock",{block:A,id:Qf.name,type:"component",source:"",ctx:t}),A}function Xf(t,e,n){let{$$slots:i={},$$scope:o}=e;f("AdjustVolumeModal",i,[]);let{closeModal:s=null}=e,{defaultValue:a=40}=e,{onChange:r=null}=e,c=a;const l=["closeModal","defaultValue","onChange"];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<AdjustVolumeModal> was created with unknown prop '${t}'`)})),t.$$set=t=>{"closeModal"in t&&n(0,s=t.closeModal),"defaultValue"in t&&n(3,a=t.defaultValue),"onChange"in t&&n(1,r=t.onChange)},t.$capture_state=()=>({Slider:ec,Img:ye,closeModal:s,defaultValue:a,onChange:r,value:c}),t.$inject_state=t=>{"closeModal"in t&&n(0,s=t.closeModal),"defaultValue"in t&&n(3,a=t.defaultValue),"onChange"in t&&n(1,r=t.onChange),"value"in t&&n(2,c=t.value)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,r,c,a,function(t){c=t,n(2,c)}]}class Zf extends h{constructor(t){super(t),u(this,t,Xf,Qf,g,{closeModal:0,defaultValue:3,onChange:1}),p("SvelteRegisterComponent",{component:this,tagName:"AdjustVolumeModal",options:t,id:Qf.name})}get closeModal(){throw new Error("<AdjustVolumeModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set closeModal(t){throw new Error("<AdjustVolumeModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get defaultValue(){throw new Error("<AdjustVolumeModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set defaultValue(t){throw new Error("<AdjustVolumeModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get onChange(){throw new Error("<AdjustVolumeModal>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set onChange(t){throw new Error("<AdjustVolumeModal>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class tw{constructor(){this._status=0,this.statusChangeCb=null,this.playMusicTickCb=null,this.downloadTickCb=null,this.downloadMuiscErrorCb=null,this.playendCb=null,this.code=null,this.defaultGain=0,this.autoPlay=!1,this.isSeeked=!1,this.volumeValue=100,this.volumeMultiple=1,this.zcm=null,this.tickTime=20,this.originalTrack=new Audio,this.accompaniedTrack=new Audio,this.resource_id=null}destroy(){console.log("44444 : "),9!=this.status&&(console.log("55555 : "),this.onStopLocalAudioMixin())}set status(t){this.statusChangeCb&&this.statusChangeCb(t),this._status=t}get status(){return this._status}preloadUrl(t){this.autoPlay=!1,this.extractAudio(t)}playWithUrl(t){this.autoPlay=!0,this.extractAudio(t)}async extractAudio(t){if(this.status=3,(t=String(t)).indexOf(".mp3")>=0){let n=t.split("|");try{const t=await Promise.all([nd({url:n[0]}),nd({url:n[1]})]);if(9==this.status)return;this.status=4;const e=URL.createObjectURL(new Blob([t[0]])),i=URL.createObjectURL(new Blob([t[1]]));await this.createCustomAudioTrack([i,e]),this.autoPlay&&8!=this.status&&await this.startPlay()}catch(e){this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb(e)}}else try{const e=await this.zcm.requestResource({songID:t,vendorID:2},1);if(0!==e.errorCode||0!==e.resource.code)return void(this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb());{const t=e.resource.data.resources[0].resource_id;this.resource_id=t;const{errorCode:n,urls:i}=await this.zcm.download(t);if(0!==n)return void(this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb());if(9==this.status)return;this.status=4,await this.createCustomAudioTrack(i),this.autoPlay&&await this.startPlay()}}catch(e){this.downloadMuiscErrorCb&&this.downloadMuiscErrorCb(e)}}async startPlay(){if(9!=this.status){if(this.autoPlay=!0,6!=this.status)throw new Error("startPlay失败，因为歌曲没加载好了");await this.playCustomAudioTrack(),this.status=8,this.startReportTimer()}}async createCustomAudioTrack(t){if(9==this.status)return;const[e,n]=t;this.originalTrack.src=n,this.originalTrack.volume=this.volumeValue/100,this.accompaniedTrack.src=e,this.accompaniedTrack.volume=this.volumeValue/100,this.status=6}async playCustomAudioTrack(){9!=this.status&&(this.status=7,this.originalTrack.muted=0==this.defaultGain,this.accompaniedTrack.muted=1==this.defaultGain,this.originalTrack.play(),this.accompaniedTrack.play())}onTaggerGain(){9!=this.status&&(1==this.defaultGain?this.originalTrack&&(this.accompaniedTrack.muted=!0,this.originalTrack.muted=!1):this.originalTrack&&(this.accompaniedTrack.muted=!1,this.originalTrack.muted=!0))}progressTick(t,e){this.downloadTickCb&&this.downloadTickCb(.5*t+.5*e)}seekOnce(t){if(6==this.status&&this.originalTrack&&this.accompaniedTrack&&!this.isSeeked)return this.isSeeked=!0,this.seek(t),!0}seek(t){9!=this.status&&this.originalTrack&&this.accompaniedTrack&&(this.originalTrack.currentTime=t,this.accompaniedTrack.currentTime=t)}pause(){this.originalTrack&&this.originalTrack.pause(),this.accompaniedTrack&&this.accompaniedTrack.pause()}resume(){this.originalTrack&&this.originalTrack.play(),this.accompaniedTrack&&this.accompaniedTrack.play()}currentTrack(){return 1==this.defaultGain?this.originalTrack:this.accompaniedTrack}startReportTimer(){const t=this.accompaniedTrack.duration;this.reportTimer=setInterval((()=>{let e=0;this.originalTrack&&1==this.defaultGain?e=this.originalTrack.currentTime:this.accompaniedTrack&&0==this.defaultGain&&(e=this.accompaniedTrack.currentTime),this.playMusicTick(e,t)}),this.tickTime)}playMusicTick(t,e){t>0&&this.playMusicTickCb&&this.playMusicTickCb(t,e),t>=e&&(this.onStopLocalAudioMixin(),this.playendCb&&this.playendCb())}changeVolume(t){this.originalTrack&&(this.originalTrack.volume=t/100),this.accompaniedTrack&&(this.accompaniedTrack.volume=t/100)}onStopLocalAudioMixin(){this.status=9,this.clearReportTimer(),this.destoryAudioTrack()}clearReportTimer(){this.reportTimer&&(window.clearInterval(this.reportTimer),this.reportTimer=null)}destoryAudioTrack(){this.originalTrack&&(this.originalTrack.pause(),this.originalTrack=null),this.accompaniedTrack&&(this.accompaniedTrack.pause(),this.accompaniedTrack=null)}}m(tw,"_decodeAudio",null);window.AgoraRTC.setParameter("WEBAUDIO_INIT_OPTIONS",{sampleRate:48e3},!0),window.AgoraRTC.setParameter("USE_XR",!0),window.AgoraRTC.setParameter("ENABLE_NTP_REPORT",!0),window.AgoraRTC.setParameter("NTP_DEFAULT_FIXED_OFFSET",80),window.AgoraRTC.setParameter("ENABLE_ENCODED_TRANSFORM",!0),window.AgoraRTC.setParameter("ENABLE_AUDIO_METADATA",!0);const ew=at((function(t,e){e(t)}),1e3);class nw{constructor(){m(this,"handleStreamMessage",((t,e)=>{const n=this.engine.messageHandler.handlerMessage(t,e),{cmd:i,time:o,duration:s,ntp:a}=n;if("setLrcTime"===i){let t=o;if(t<=0)return;if(this.loadMuisc&&8==this.loadMuisc.status){uu.globalRtcClient.client.getNtpWallTimeInMs();const e=1e3*this.loadMuisc.currentTrack().getCurrentTime();if(Math.abs(o-e)>50&&o<s){t=o;const e=this;ew(t/1e3,(function(t){e.loadMuisc.seek(t)}))}else t=e}const e=t/1e3;if(this.mineIsAudience()&&0==this.isForward){const e=t>1500?t-1500:0;this.lyricComp.setLyricOffset(e/1e3)}if(this.updateMusicCountdown(e),(this.mineIsChorus()||this.mineIsGuest())&&this.loadMuisc&&this.loadMuisc.seekOnce(e)){let t=function(){(e.mineIsChorus()&&e.loadMuisc&&8==e.loadMuisc.status||7==e.loadMuisc.status)&&(Vt("已自动开麦，开始演唱吧~ "),e.chorusAutoOpenMicrophone())};this.loadMuisc.startPlay();const e=this;if(this.joinMainChanned)t();else{let e=setInterval((()=>{this.joinMainChanned&&(window.clearInterval(e),e=null,t())}),300)}}}})),m(this,"handleAudioMessage",(async t=>{const e=Es(t),{ts:n,songId:i}=e;let o=n;if(o<=0)return;if(this.loadMuisc&&8==this.loadMuisc.status){this.loadMuisc.currentTrack().getCurrentTime();const t=this;ew(o/1e3,(function(e){var n;null==(n=t.loadMuisc)||n.seek(e)}))}const s=o/1e3;if(this.mineIsAudience()&&0==this.isForward){const t=o>1500?o-1500:0;this.lyricComp.setLyricOffset(t/1e3)}if(this.updateMusicCountdown(s),(this.mineIsChorus()||this.mineIsGuest())&&this.loadMuisc&&this.loadMuisc.seekOnce(s)){let t=function(){(e.mineIsChorus()&&e.loadMuisc&&8==e.loadMuisc.status||7==e.loadMuisc.status)&&(Vt("已自动开麦，开始演唱吧~ "),e.chorusAutoOpenMicrophone())};this.loadMuisc.startPlay();const e=this;if(this.joinMainChanned)t();else{let e=setInterval((()=>{this.joinMainChanned&&(window.clearInterval(e),e=null,t())}),300)}}})),this.htmlDom=null,this.lyricComp=null,this.prepareComp=null,this.seatsComp=null,this.musicCountdownComp=null,this.scoreComp=null,this.mainBtnComp=null,this.handclapComp=null,this.chorusCountComp=null,this.muiscNameComp=null,this.originControlComp=null,this.adjustVolumeComp=null,this.modals=new Map,this.loadMuisc=null,this.actInfo=null,this._engine=null,this.captureAudioHandle=null,this.subChannel=null,this.subChannelBgm=null,this.mainChannel=null,this.subscribeSet=new Set,this.setRole=null,this.huatongEle=null,this.seatsElements=null,this.anchorReportTimer=null,this.songReportTimer=null,this.newChorusCountdownTimer=null,this.evaluateScore=null,this.vocalScore=0,this.joinMainChanned=!1,this.showLoginWindow=null,this.bgmVolumeValue=100,this.isForward=!1,this.voiceList=[],this.recordPreviousVolume=-1,this.isAgora=!0,this.zcm=null,this.reportVolumeIndex=0,this.new_engine=new va,this.lyric=null,this.pitchData=null,this.firstTime=+new Date}static getInstance(){return this.instance||(this.instance=new nw),this.instance}onReset(t=""){1!=t&&(this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null),this.firstTime=+new Date,this.clearSvelteComp("lyricComp"),this.clearSvelteComp("seatsComp"),this.clearSvelteComp("musicCountdownComp"),this.clearSvelteComp("prepareComp"),this.clearSvelteComp("scoreComp"),this.clearSvelteComp("mainBtnComp"),this.clearSvelteComp("handclapComp"),this.clearSvelteComp("chorusCountComp"),this.clearSvelteComp("muiscNameComp"),this.clearSvelteComp("originControlComp"),this.clearSvelteComp("adjustVolumeComp");for(let e of this.modals.values())e.$destroy();this.modals.clear(),this.destroyLoadMuisc(),this.actInfo=null,this._engine&&(this._engine.destory(),this._engine=null),uu.globalRtcClient.emitter.off("stream-message",this.handleStreamMessage),uu.globalRtcClient.emitter.off("audio-metadata",this.handleAudioMessage),this.stopCaptureAudio(),this.destroyZcm(),this.leaveSubChannel(),this.leaveSubChannelBgm(),this.mainChannel&&(this.mainChannel.removeEvents(),this.mainChannel=null),this.joinMainChanned=!1,this.subscribeSet.clear(),this.setRole=null,this.huatongEle=null,this.seatsElements=null,this.clearAnchorReportTimer(),this.clearSongReportTimer(),this.destroyEvaluateScore(),this.clearNewChorusCountdownTimer(),this.vocalScore=0,this.showLoginWindow=null,this.isForward=!1,this.voiceList=[],this.resumePreviousVolume(),this.isAgora=!0,this.reportVolumeIndex=0}initTemplate(t){this.isAgora=0==uu.getRoomInfo().voice_type,this.isForward=1==uu.getRoomInfo().forward,this.initRTCParams(),this.huatongEle=$(".chat-huatong"),this.seatsElements=window.$(".chat-center-main"),this.initHtml(t),this.requestBaseData(),uu.globalRtcClient.emitter.on("stream-message",this.handleStreamMessage),uu.globalRtcClient.emitter.on("audio-metadata",this.handleAudioMessage),this.createMainChannel(),this.createOriginControl(),this.createAdjustVolume(),uu.isYinSuDa()||this.isAgora&&ra.init()}initHtml(t){const e=`\n            <div class="chorus-room-anchor-container">\n                ${Fi._initSeatData(2,158,120,80,80,"主持",!1,!1,"add")}\n                <p class="chorus-anchor-btn common-btn hide"></p>\n            </div>\n        `,n=`\n            <div class="chorus-room-jiabin">\n                ${Fi._getOtherAnchorSeatHtml({position:3,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:158,pheight:120,width:80,height:80,isshowmeili:!1})}\n\n                <p class="chorus-rank-btn">排行榜<p>\n            </div>\n        `;let i='\n            <div class="chorus-content-center flex flex-dir-col flex-ac">\n                <div class="chorus-content-center_music"></div>\n                <div class="chorus-content-center_members"></div>\n                <div class="chorus-content-center_btn"></div>\n            </div>\n        ';uu.isBallCollisionChorusRoom()&&(i='\n                <div class="chorus-content-center flex flex-dir-col flex-ac">\n                    <div class="chorus-content-center_music"></div>\n                    <div class="chorus-content-center_members" id="chorus-content-center_members"></div>\n                    <div class="chorus-content-center_btn"></div>\n                </div>\n            '),this.htmlDom=window.$(`\n            <div class="chorus-room-content flex flex-jc" style="height: 540px;">\n                <div class="chorus-background-img"></div>\n                <div class="chorus-room__wrapper flex flex-jc typeid_${uu.getRoomInfo().typeid}">\n                    ${e}\n                    ${i}\n                    ${n}\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom),this.createLyricComponent(),this.createSeats(),this.createMainBtn(),this.createChorusCount(),this.createMuiscName(),this.registerRankBtn()}updateSeats(){this.actInfo&&(console.log("this.actInfo==---"),console.log(this.actInfo),this.updateAnchorMicrophoneState(),this.updateMainButton(),this.updateChannelState(),this.updateMusicState(),this.checkReportVolume(),this.checkStreamTimer(),this.updateChorusRoleVolume(),this.mainBtnComp&&this.mainBtnComp.forceUpdate(),this.seatsComp&&this.seatsComp.forceUpdate(),this.originControlComp&&this.originControlComp.forceUpdate(),this.adjustVolumeComp&&this.adjustVolumeComp.forceUpdate())}updateSocketData(t){if(this.actInfo)switch(t.mark){case"stage":this.updateStage(t);break;case"download_song":this.mineIsAnchor()&&this.downloadSong(t.song_info);break;case"user_list":this.actInfo=l(c({},this.actInfo),{user_list:t.user_list}),this.updateUserList();break;case"voice_print":for(const e of t.volume_list){const t=this.voiceList.find((t=>t.uid==e.uid));t?t.volume=e.volume:this.voiceList.push(e)}this.checkUserShowOrHideWave(uu.getAnchoringUser(),this.voiceList),this.checkUserShowOrHideWave(uu.getAnchoringUserFromPosition(3),this.voiceList),3==this.actInfo.stage&&this.updateSeatsCompData({voiceList:this.voiceList.filter((t=>t.volume>=4)).map((t=>t.uid))});break;case"score":this.updateScore(t.total_score);break;case"hand_clap":this.mineIsAnchor()||this.handclapComp&&this.handclapComp.playEffect();break;case"perfect":this.seatsComp&&this.seatsComp.playPerfect(t.uid_list||[]);break;case"rank":this.playRankEffect(t.rank)}}mineIsAudience(){return!(this.mineIsAnchor()||this.mineIsGuest()||this.mineIsChorus())}mineIsGuest(){const t=uu.getAnchoringUserFromPosition(3);return!(!t||t.uid!=uu.getMeid())}mineIsAnchor(){return uu.isAnchoringUser(uu.getMeid())}mineIsChorus(){return!!this.actInfo&&this.actInfo.user_list.findIndex((t=>t.uid==uu.getMeid()))>=0}requestBaseData(){qt.get(Ot.getChorusBaseData(uu.getCid())).then((t=>{0==t.error?(this.actInfo=t.data,this.joinSubChannel(),this.updateStageState(),this.updateUserList(),this.updateChannelState(),this.createHandclap()):Vt(t.error_msg)}))}checkUserShowOrHideWave(t,e=[]){if(!t)return;const n=e.find((e=>e.uid==t.uid));n&&(n.volume>=4?this.showWaveWithUser(n):this.hideWaveWithUser(n))}showWaveWithUser(t){t&&t.uid&&this.seatsElements&&this.seatsElements.find(".seat-item-empty[data-uid='"+t.uid+"']").addClass("speaking")}hideWaveWithUser(t){t&&t.uid&&this.seatsElements&&this.seatsElements.find(".seat-item-empty[data-uid='"+t.uid+"']").removeClass("speaking")}updateStage(t){this.actInfo&&(this.actInfo=c(c({},this.actInfo),t),this.updateStageState(),4==this.actInfo.stage&&this.showRankModal())}async updateStageState(){this.updateMainButton(),this.updatePrepare(),this.updateMusicState(),this.updateScoreState(),this.updateEvaluateScoreState(),this.updateChorusRoleVolume();const t=this.actInfo.stage,e=this.actInfo.song_info.song_code+"";this.updateSeatsCompData({stage:t}),this.muiscNameComp.$set({stage:t}),this.mainBtnComp.$set({stage:t}),3!=t&&(this.stopCaptureAudio(),this.clearSvelteComp("musicCountdownComp"),this.clearSongReportTimer(),this.voiceList=[]),3==t?(uu.isYinSuDa()&&(this.loadMuisc||this.downloadSong(this.actInfo.song_info,!0),console.log("音速达好了 22222222"+e)),this.mainBtnComp.$set({download:!1})):(this.resetEngine(),this.mineIsAnchor()||this.mineIsGuest()||this.chorusAutoCloseMicrophone()),this.updateLyricState()}updateUserList(){const t=this.actInfo.user_list||[];this.updateSeatsCompData({userList:t}),this.updateMusicState(),this.checkReportVolume(),this.updateChannelState(),this.mainBtnComp.forceUpdate(),this.chorusCountComp&&this.chorusCountComp.$set({list:t}),this.updateEvaluateScoreState(),this.updateChorusRoleVolume(),this.originControlComp&&this.originControlComp.forceUpdate(),this.adjustVolumeComp&&this.adjustVolumeComp.forceUpdate()}async checkAnchorMusicLoaded(t=0){if(this.loadMuisc&&6==this.loadMuisc.status)if(0!=t&&this.loadMuisc.seek(t),this.loadMuisc.startPlay(),this.isAgora){const{host_bgm_channel_key:t,host_bgm_uid:e}=this.actInfo,n=new ws;n.join(uu.getRoomInfo().channel,t,e),n.joinChanneledCb=()=>{n.publishCustomAudioTrack(this.loadMuisc.originalTrack),n.publishCustomAudioTrack(this.loadMuisc.accompaniedTrack)},this.subChannelBgm=n}else if(this.joinMainChanned){const t=this.mainChannel.client.client;let e=new MediaStream;this.bgmStream=await t.createStream({custom:{source:e,audioBitrate:128}}),await t.startPublishingStream(`${uu.getMeid()}_chorus`,this.bgmStream,{isSEIStart:!0,SEIType:1,forceSynchronousNetworkTime:1,videoCodec:"H264"}),t.startMixingAudio(this.bgmStream,[this.loadMuisc.originalTrack,this.loadMuisc.accompaniedTrack]),this.setZegoBgmVolume(this.bgmVolumeValue)}else Vt("推bgm流失败，rtc为加入成功")}updateMusicState(){if(uu.isChorusMoreRoom()&&this.mineIsAnchor()&&4!=this.actInfo.stage&&!this.loadMuisc){if(!this.isAgora&&0==this.actInfo.song_info.song_code)return;this.downloadSong(this.actInfo.song_info,!0)}else 3==this.actInfo.stage?(this.mineIsAnchor()?this.checkAnchorMusicLoaded():this.mineIsChorus()||this.mineIsGuest()?this.loadMuisc||this.downloadSong(this.actInfo.song_info,!0):this.destroyLoadMuisc(),this.mineIsAnchor()||this.leaveSubChannelBgm()):2==this.actInfo.stage||(this.destroyLoadMuisc(),this.leaveSubChannelBgm())}updateMusicCountdown(t){if(!this.actInfo)return;const e=this.actInfo.song_info.duration-parseInt(t);3==this.actInfo.stage?this.musicCountdownComp||(this.musicCountdownComp=new gf({target:this.htmlDom.find(".chorus-room__wrapper")[0],props:{seconds:e}})):this.clearSvelteComp("musicCountdownComp")}updateScoreState(){3!=this.actInfo.stage&&this.clearSvelteComp("scoreComp")}updateEvaluateScoreState(){uu.isYinSuDa()||this.isAgora&&(3!=this.actInfo.stage||this.mineIsAudience()?this.evaluateScore&&this.evaluateScore.stop():this.evaluateScore?this.evaluateScore.resume():(this.evaluateScore=new ra,this.evaluateScore.start(this.engine)))}updateScore(t){3==this.actInfo.stage&&(this.scoreComp?this.scoreComp.$set({score:t}):this.scoreComp=new _f({target:this.htmlDom.find(".chorus-room__wrapper")[0],props:{score:t}}))}updatePrepare(){if(uu.isNewChorusRoom()){const t=this;if(this.clearNewChorusCountdownTimer(),this.actInfo.stage==zg)this.lyricComp.$set({defaultTitle:"一起来合唱",defaultDesc:"合唱即将开始",musicLogoShowLine:1});else if(2==this.actInfo.stage){let e=function(e){t.lyricComp.$set({defaultTitle:`即将演唱歌曲 《${t.actInfo.song_info.name.substr(0,10)}》`,defaultDesc:`合唱即将开始 ${e}s`,musicLogoShowLine:0})},n=function(i){e(i),i>0&&(t.newChorusCountdownTimer=setTimeout((()=>{n(i-1)}),1e3))};n(this.actInfo.countdown)}else 4==this.actInfo.stage?this.lyricComp.$set({defaultTitle:"一起来合唱",defaultDesc:0==this.actInfo.song_info.song_code?"合唱即将开始":"即将演唱下一首歌曲",musicLogoShowLine:1}):3==this.actInfo.stage&&uu.isYinSuDa()&&this.lyricComp.$set({playing:!0})}else this.actInfo.stage==zg?this.showPrepare(0):2==this.actInfo.stage?this.showPrepare(this.actInfo.countdown,`即将演唱歌曲 《${this.actInfo.song_info.name.substr(0,10)}》`):4==this.actInfo.stage?this.showPrepare(0,0==this.actInfo.song_info.song_code?void 0:"即将演唱下一首歌曲"):this.clearSvelteComp("prepareComp")}updateMainButton(){const t=this.htmlDom.find(".chorus-content-center_main-btn");this.mineIsAnchor()?t.show():t.hide()}updateChannelState(){if(this.actInfo){const t=this.actInfo.robot_uid;if(this.isAgora&&!this.subChannel)return;if(this.mineIsAudience())this.isAgora?(this.subChannel.subscribe(t),this.mainChannel.unsubscribeAll(),this.subscribeSet.clear()):(this.mainChannel.hasMuted(t)&&(this.mainChannel.unsubscribeAll(),this.subscribeSet.clear()),this.mainChannel.subscribe(t),this.mainChannel.unmute(t));else{if(this.isAgora?this.subChannel.unsubscribe(t):(this.mainChannel.subscribe(t),this.mainChannel.mute(t)),!this.mineIsAnchor()){const t=uu.getAnchoringUser();t&&this.mainChannel.subscribe(t.uid)}if(!this.mineIsGuest()){const t=uu.getAnchoringUserFromPosition(3);t&&this.mainChannel.subscribe(t.uid)}const e=vs(this.subscribeSet,new Set(this.actInfo.user_list.map((t=>t.uid))));for(const t of e)this.mainChannel.unsubscribe(t),this.subscribeSet.delete(t);const n=this.actInfo.user_list.map((t=>t.uid));for(const t of n){if(this.subscribeSet.size>=(this.isAgora?4:12))break;t==uu.getMeid()||this.subscribeSet.has(t)||(this.subscribeSet.add(t),this.mainChannel.subscribe(t))}}}}checkAnchorCanDisposeMicrophone(t=!0){return!!(uu.isChorusRoom()&&this.mineIsAnchor()&&this.joinMainChanned&&this.mainChannel.published)&&(this.mainChannel.setLocalAudioVolume(t?100:0),!0)}updateAnchorMicrophoneState(){if(this.mainChannel&&this.mineIsAnchor()&&!this.huatongIsOpen())if(this.joinMainChanned)this.mainChannel.published||(this.setRole(1),this.mainChannel.setLocalAudioVolume(0));else{let t=setInterval((()=>{this.joinMainChanned&&(window.clearInterval(t),t=null,this.updateAnchorMicrophoneState())}),300)}}updateChorusRoleVolume(){this.isAgora&&(3!=this.actInfo.stage&&4!=this.actInfo.stage||(3==this.actInfo.stage&&(this.mineIsAnchor()||this.mineIsChorus()||this.mineIsGuest())?-1==this.recordPreviousVolume&&(this.recordPreviousVolume=1*xt.getInstance().getMainVolume(),this.setVolumes(50,!0)):this.resumePreviousVolume()))}resumePreviousVolume(){this.isAgora&&this.recordPreviousVolume>0&&(this.setVolumes(this.recordPreviousVolume,!0),this.recordPreviousVolume=-1)}updatePreviousVolume(t){this.isAgora&&this.recordPreviousVolume>0&&(this.recordPreviousVolume=t,this.setVolumes(t))}setVolumes(t,e=!1){xt.getInstance().setMainVolume(1*t),this.setVolume(1*t),e&&window.$(".chat-voice-volume input[type='range']").val(1*t)}createMainBtn(){this.mainBtnComp=new Sf({target:this.htmlDom.find(".chorus-content-center_btn")[0]})}createHandclap(){this.handclapComp=new Af({target:this.htmlDom.find(".chorus-content-center")[0]})}createChorusCount(){this.chorusCountComp=new Ef({target:this.htmlDom.find(".chorus-room__wrapper")[0]})}createMuiscName(){this.muiscNameComp=new Of({target:this.htmlDom.find(".chorus-room__wrapper")[0]})}createOriginControl(){this.originControlComp||(this.originControlComp=new Vf({target:this.htmlDom.find(".chorus-content-center")[0]}))}createAdjustVolume(){this.adjustVolumeComp||(this.adjustVolumeComp=new Yf({target:this.htmlDom.find(".chorus-content-center")[0]}))}registerRankBtn(){this.htmlDom.find(".chorus-rank-btn").on("click",(()=>{this.showMusicRankModal()}))}async createMainChannel(){this.mainChannel=new ws(uu.globalRtcClient),this.mainChannel.initStreamedCb=async()=>{if(this.joinMainChanned=!0,!this.isAgora){this.mainChannel.userPublishedCallback({uid:`${this.actInfo.robot_uid}`,streamID:`${this.actInfo.robot_uid}`}),await Ct.loadScript("https://asset2.tuwan.com/chatroom/script/Zego-voice-changer-2.25.210.js"),await Ct.loadScript("https://asset2.tuwan.com/chatroom/script/Zego-copyrighted-music-2.25.210.js"),window.ZegoExpressEngine.use(window.CopyrightedMusic),window.ZegoExpressEngine.use(window.VoiceChanger);const t=this.mainChannel.client.client.createCopyrightedMusic();await t.initCopyrightedMusic({user:{userID:String(uu.getMeid())}}),this.zcm=t,this.zcm.on("downloadProgressUpdate",((t,e)=>{this.musicDownloadPercent(e)})),this.zcm.on("songLineScoreComplete",(({lineIndex:t,previousScore:e})=>{e>0&&qt.get(Ot.getChorusReportScore(uu.getCid(),this.actInfo.song_info.song_code,t+1,e)).then((t=>{}))})),3==this.actInfo.stage&&this.updateLyricState()}},this.mainChannel.receiveSeiCb=(t,e)=>{if(!this.actInfo)return;let n=0,i=0;n=e[i++]<<24,n|=e[i++]<<16,n|=e[i++]<<8,n|=e[i++];const o=e.slice(4,e.length),s=JSON.parse((new TextDecoder).decode(o));let a=s.LSK.LSP;if(a<=0)return;let r=s.LSK.NTP,c=+a,l=c/1e3;if(t==this.actInfo.robot_uid)this.mineIsAudience()&&this.lyricComp.setLyricOffset(l);else if(!this.mineIsAudience()){if(this.loadMuisc&&8==this.loadMuisc.status){c+=this.mainChannel.client.client.getNetworkTimeInfo().timestamp-r,l=c/1e3,Math.abs(this.loadMuisc.currentTrack().currentTime-l)>.1&&this.loadMuisc.seek(l)}if(this.loadMuisc&&this.loadMuisc.seekOnce(l)){let t=function(){(e.mineIsChorus()&&e.loadMuisc&&8==e.loadMuisc.status||7==e.loadMuisc.status)&&(Vt("已自动开麦，开始演唱吧~ "),e.chorusAutoOpenMicrophone())};this.loadMuisc.startPlay();const e=this;if(this.joinMainChanned)t();else{let e=setInterval((()=>{this.joinMainChanned&&(window.clearInterval(e),e=null,t())}),300)}}}this.updateMusicCountdown(l)},this.mainChannel.publisherSuccessCb=async t=>{if(!this.isAgora){const e=this.mainChannel.client.client;if(t.endsWith("_chorus"))this.bgmStream&&await e.zegoWebRTC.setStreamAlignmentProperty(this.bgmStream,1);else{const t=this.mainChannel.client.localAudio;t&&await e.zegoWebRTC.setStreamAlignmentProperty(t,1)}}},this.mainChannel.autoMixerSoundLevelUpdateCb=t=>{t=t.map((t=>l(c({},t),{volume:t.level}))),this.checkUserShowOrHideWave(uu.getAnchoringUser(),t),this.checkUserShowOrHideWave(uu.getAnchoringUserFromPosition(3),t),3==this.actInfo.stage&&this.updateSeatsCompData({voiceList:t.filter((t=>t.volume>=4)).map((t=>t.uid))})}}joinSubChannel(){if(!this.isAgora)return;const{sub_channel:t,sub_channel_key:e}=this.actInfo;this.subChannel=new ws,this.subChannel.join(t,e),this.subChannel.streamMessageCb=(t,e)=>{if(this.mineIsAudience()&&1==this.isForward){const n=this.engine.messageHandler.handlerMessage(t,e);if(!n.ver&&"setLrcTime"==n.cmd){let t=n.realTime;t/=1e3,t=t>0?t:0,this.lyricComp.setLyricOffset(t-.2)}}},this.subChannel.audioMessageCb=async t=>{const e=Es(t),{ts:n,songId:i}=e;let o=(n-Vs)/1e3;this.lyricComp.setLyricOffset(o)}}async createLoadMuisc(t){if(uu.isYinSuDa()){const n=t.song_code+"";if(uu.isAnchoringUser(uu.getMeid())&&!uu.isChorusMoreRoom()&&+new Date-this.firstTime<2e3)return;try{await this.new_engine.setUser(uu.getMeid()),this.lyric=await this.new_engine.getLyric(n,!0),this.pitchData=await this.new_engine.getPitchData(n),this.new_engine.prepare(),await this.new_engine.genBgmTracks(n,!0)}catch(e){console.log(e)}console.log("音速达好了 11111"+n),this.mainBtnComp.$set({download:!1}),2!=this.actInfo.stage&&this.setLyric({play:1}),uu.isAnchoringUser(uu.getMeid())||(await this.new_engine.justStartBgmTimer(),this.new_engine.setAudioTrack(uu.globalRtcClient.localAudio),this.new_engine.startProcessAudio())}uu.isYinSuDa()?this.loadMuisc=this.isAgora?new od(this.new_engine):new tw:this.loadMuisc=this.isAgora?new od:new tw,this.isAgora||(this.loadMuisc.zcm=this.zcm),this.loadMuisc.volumeValue=this.bgmVolumeValue,this.originControlComp&&(this.loadMuisc.defaultGain=this.originControlComp.getOpenState()?1:0),this.loadMuisc.code=t.song_code,!this.isAgora&&(this.loadMuisc.tickTime=100),this.loadMuisc.playMusicTickCb=this.muiscTick.bind(this),this.loadMuisc.statusChangeCb=this.musicStateChange.bind(this),this.loadMuisc.downloadTickCb=this.musicDownloadPercent.bind(this),this.loadMuisc.downloadMuiscErrorCb=()=>{Vt("歌曲加载失败，请稍后重试"),this.destroyLoadMuisc(),this.mainBtnComp.$set({download:!1})}}clearMainButtonLock(){this.mainBtnComp.clearJoinLock()}async downloadSong(t,e=!1){var n;if(this.isAgora){if(!uu.isYinSuDa()){const e=t.song_url;if(!e||""==e)return this.clearMainButtonLock(),void Vt("歌曲链接为空");if(!e)return this.clearMainButtonLock(),void Vt("歌曲有问题，链接为空");let n=e.split("|");if(2!=n.length)return this.clearMainButtonLock(),void Vt("歌曲有问题，缺少原唱或者伴奏");if(n[0].indexOf(".mp3")<0||n[1].indexOf(".mp3")<0)return this.clearMainButtonLock(),void Vt("歌曲类型有问题，返回了不是mp3的链接")}}else try{if(this.loadMuisc=new tw,this.mainBtnComp.$set({download:!0}),await this.waitZcmLoaded(),this.loadMuisc=null,e&&t.song_code!=this.actInfo.song_info.song_code)return void this.mainBtnComp.$set({download:!1})}catch(i){return this.destroyLoadMuisc(),this.mainBtnComp.$set({download:!1}),void Vt("zcm未初始化成功，暂时加入不了合唱，请稍后重试")}this.mainBtnComp.$set({download:!0}),uu.isYinSuDa()?await this.createLoadMuisc(t):this.createLoadMuisc(t),null==(n=this.loadMuisc)||n.preloadUrl(this.isAgora?t.song_url:t.song_code)}waitZcmLoaded(){return new Promise(((t,e)=>{if(this.zcm)return void t();let n=0;const i=setInterval((()=>{if(this.zcm)return t(),void window.clearInterval(i);n++,n>=100&&(e(),window.clearInterval(i))}),100)}))}playSong(t){this.createLoadMuisc(t),this.loadMuisc.playWithUrl(t.song_url)}createLyricComponent(){this.lyricComp=new Cl({target:this.htmlDom.find(".chorus-content-center_music")[0],props:{parseXmlCb:this.parseXmlCb.bind(this),defaultTitle:"一起来合唱",forceSync:!0,deviationValue:300,musicLogoShowLine:uu.isNewChorusRoom()?1:2}})}parseXmlCb(t){uu.isYinSuDa()?alert("parseXmlCb"):this.engine&&this.engine.setLyric(t)}updateLyricState(){this.setLyric({play:3==this.actInfo.stage?1:0,url:this.actInfo.song_info.lyric_url,code:this.actInfo.song_info.song_code})}async setLyric(t){1==t.play?this.isAgora?uu.isYinSuDa()?this.lyricComp.playYinSuDa(this.lyric):this.lyricComp.play(t.url):this.lyricComp.playZego(t.code,this.zcm):this.lyricComp.destoryLyricsPlayer()}get engine(){return this._engine||(this._engine=qs.getInstance(),this._engine.reset(),this.subscribeEngineEvents()),this._engine}subscribeEngineEvents(){this.engine.on("timeUpdate",(t=>{const{progress:e}=t;if(this.mineIsAnchor()){const{duration:t,song_code:n}=this.actInfo.song_info,i=1e3*e,o=Ls({cmd:"setLrcTime",type:1001,ts:parseInt(String(i),10),songId:String(n),forward:!0,uid:uu.getMeid()});uu.globalRtcClient.sendAudioMetadata({value:o}),uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({cmd:"setLrcTime",ntp:uu.globalRtcClient.client.getNtpWallTimeInMs()+Gs,duration:parseInt(String(1e3*t),10),time:parseInt(String(i- -190),10),realTime:parseInt(String(i),10),playerState:3,pitch:0,songIdentifier:String(n),forward:this.isForward,ver:2}),syncWithAudio:!0}),this.updateMusicCountdown(e)}this.lyricComp.setLyricOffset(e)})),uu.isAnchoringUser(uu.getMeid())||this.new_engine.on("lineChanged",(t=>{const{lineNumber:e,lineScore:n,totalScore:i}=t;let o=n,s=e;o>0&&qt.get(Ot.getChorusReportScore(uu.getCid(),this.actInfo.song_info.song_code,s+1,o)).then((t=>{})),console.log("lineChanged="+e+"-"+n+"-"+i)}))}musicStateChange(t){this.mainBtnComp&&(4!=t&&9!=t&&8!=t||(this.mainBtnComp.$set({download:!1}),4==t&&this.mainBtnComp.checkIsJoinState()),(uu.isNewChorusRoom()||this.mineIsAnchor())&&6==t&&(qt.get(Ot.getChorusDownload(uu.getCid(),this.loadMuisc.code)),uu.isChorusMoreRoom()&&3==this.actInfo.stage&&qt.get(Ot.getChorusMusicProgress(uu.getCid(),this.actInfo.song_info.song_code)).then((t=>{0==t.error&&this.checkAnchorMusicLoaded(t.data.play_duration)}))),this.isAgora&&!this.mineIsAudience()&&8==t&&(this.clearSongReportTimer(),this.songReportTimer=setInterval((()=>{uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({service:"audio_smart_mixer",version:"V1",payload:{cname:uu.getRoomInfo().channel,uid:uu.getMeid()+"",uLv:-1,specialLabel:0,audioRoute:3,vocalScore:this.vocalScore}}),syncWithAudio:!0})}),3e3)),!this.isAgora&&this.zcm&&(8==t?this.zcm.startScore({resourceID:this.loadMuisc.resource_id,localStream:this.mainChannel.client.localAudio,player:this.loadMuisc.accompaniedTrack,enableSongLineScoreCompleteEvent:!0}):this.zcm.stopScore()))}muiscTick(t){if(this.isAgora)this.mineIsAudience()||this.engine.setTime(t);else if(!this.mineIsAudience()&&(this.lyricComp.setLyricOffset(t),this.mineIsAnchor()&&this.loadMuisc&&this.loadMuisc.resource_id)){const e=this.mainChannel.client.client,n=e.getNetworkTimeInfo().timestamp,i={LSK:{NTP:Number(n),LSP:Number((1e3*t).toFixed(0))}};e.sendSEI(`${uu.getMeid()}_0`,(new TextEncoder).encode(JSON.stringify(i))),this.updateMusicCountdown(Math.floor(t))}}musicDownloadPercent(t){this.mainBtnComp.setPercent(t)}startCaptureAudio(t=!0){this.isAgora&&(this.captureAudioHandle||(this.captureAudioHandle=Ct.captureAudioVolume(null,(e=>{const n=this.huatongIsOpen()?Math.floor(2.55*e):0;this.seatsComp&&this.seatsComp.updateMineVolume(n),t&&this.reportVolumeIndex++%2&&setTimeout((()=>{qt.get(Ot.getChorusReportVolume(uu.getCid(),n,this.actInfo.song_info.song_code)).then((t=>{}))}),Math.floor(200*Math.random()))})),this.captureAudioHandle.start()))}stopCaptureAudio(){this.captureAudioHandle&&(this.captureAudioHandle.stop(),this.captureAudioHandle=null)}checkReportVolume(){const t=this.actInfo?this.actInfo.user_list.find((t=>t.uid==uu.getMeid())):null;this.mineIsAnchor()||this.mineIsGuest()||t&&t.is_report?this.startCaptureAudio(!0):t&&!t.is_report?this.startCaptureAudio(!1):this.stopCaptureAudio()}checkStreamTimer(){this.isAgora&&(this.mineIsAnchor()?this.anchorReportTimer||(this.anchorReportTimer=setInterval((()=>{uu.globalRtcClient.sendStreamMessage({payload:this.engine.messageHandler.genMessage({service:"audio_smart_mixer_status",version:"V1",payload:{Ts:uu.globalRtcClient.client.getNtpWallTimeInMs(),cname:uu.getRoomInfo().channel,status:1,bgmUID:String(this.actInfo.host_bgm_uid),leadsingerUID:String(uu.getMeid())}}),syncWithAudio:!0})}),200)):this.clearAnchorReportTimer())}playRankEffect(t){const e=$(`\n            <p class="chorus_rank_effect">第${t}名</p>\n        `);this.htmlDom.find(".chorus-content-center").append(e),e.snabbt({fromOpacity:0,position:[0,-50,0],opacity:1,duration:400}).snabbt({position:[0,-100,0],duration:400}).snabbt({opacity:0,position:[0,-150,0],duration:400,complete:()=>{e.remove()}})}createSeats(){this.seatsComp=new df({target:this.htmlDom.find(".chorus-content-center_members")[0]})}updateSeatsCompData(t){this.seatsComp&&this.seatsComp.$set(t)}showPrepare(t=0,e="演唱即将开始"){this.prepareComp||(this.prepareComp=new Ug({target:this.htmlDom.find(".chorus-content-center_members")[0]})),this.prepareComp.startCountdown(t,e)}showMusicLibrary(){this.commonShowModal(yp)}showRankModal(){this.commonShowModal(eg)}showAdjustVolumeModal(){this.commonShowModal(Zf,{defaultValue:this.bgmVolumeValue,onChange:t=>{const e=Number(t.target.value);this.bgmVolumeValue=e,this.loadMuisc&&this.loadMuisc.changeVolume(e),this.setZegoBgmVolume(e)}})}setZegoBgmVolume(t){if(!this.isAgora&&this.joinMainChanned&&this.loadMuisc&&this.loadMuisc.originalTrack){const e=this.mainChannel.client.client;e.setMixingAudioVolume(this.bgmStream,1.6*t,this.loadMuisc.originalTrack),e.setMixingAudioVolume(this.bgmStream,1.6*t,this.loadMuisc.accompaniedTrack)}}showSingModal(){var t;(null==(t=null==this?void 0:this.actInfo)?void 0:t.song_info)&&this.commonShowModal(hg,{code:this.actInfo.song_info.song_code})}showMusicRankModal(){this.commonShowModal(Lg)}commonShowModal(t,e){const n=this;let i=this.modals.get(t);if(!i){let o=function(){n.modals.delete(t),i.$destroy(),i=null};i=new t({target:document.body,props:c({closeModal:o},e)}),this.modals.set(t,i)}}huatongCheckChorus(){if(uu.isChorusRoom()&&this.mineIsChorus()){return this.huatongEle.hasClass("chat-huatong-jin")?(this.huatongEle.removeClass("chat-huatong-jin"),this.setRole&&this.setRole(1)):(this.huatongEle.addClass("chat-huatong-jin"),this.setRole&&this.setRole(0)),!0}return!1}huatongIsOpen(){return!this.huatongEle.hasClass("chat-huatong-jin")}chorusAutoOpenMicrophone(){this.huatongIsOpen()||(this.huatongEle.removeClass("chat-huatong-jin"),this.setRole&&this.setRole(1))}chorusAutoCloseMicrophone(){this.huatongIsOpen()&&(this.huatongEle.addClass("chat-huatong-jin"),this.setRole&&this.setRole(0))}handleStopProcessAudio(){this.new_engine.stopProcessAudio(),this.new_engine.stopTimer()}initRTCParams(){}getSeats(){if(this.seatsComp){const t=uu.getMeid();return this.seatsComp.getSeats().filter((e=>e.uid!=t))}return[]}setVolume(t){this.mainChannel&&this.mainChannel.setVolume(t),this.subChannel&&this.subChannel.setVolume(t)}hasSong(){return this.actInfo&&this.actInfo.song_info&&this.actInfo.song_info.name.length>0}clearSvelteComp(t){this[t]&&(this[t].$destroy(),this[t]=null)}destroyLoadMuisc(){this.loadMuisc&&(this.loadMuisc.destroy(),this.loadMuisc=null)}resetEngine(){this._engine&&this._engine.reset(),this.vocalScore=0}leaveSubChannel(){this.subChannel&&(this.subChannel.destroy(),this.subChannel=null)}async leaveSubChannelBgm(){if(this.subChannelBgm&&(this.subChannelBgm.leave(),this.subChannelBgm=null),!this.isAgora&&this.joinMainChanned&&this.bgmStream){const t=this.mainChannel.client.client;await t.stopPublishingStream(uu.getMeid()+"_chorus"),await t.destroyStream(this.bgmStream),this.bgmStream=null}}clearAnchorReportTimer(){this.anchorReportTimer&&(window.clearInterval(this.anchorReportTimer),this.anchorReportTimer=null)}clearSongReportTimer(){this.songReportTimer&&(window.clearInterval(this.songReportTimer),this.songReportTimer=null)}clearNewChorusCountdownTimer(){this.newChorusCountdownTimer&&(window.clearTimeout(this.newChorusCountdownTimer),this.newChorusCountdownTimer=null)}destroyEvaluateScore(){this.evaluateScore&&(this.evaluateScore.destroy(),this.evaluateScore=null)}destroyZcm(){var t,e,n;this.zcm&&(null==(n=null==(e=null==(t=null==this?void 0:this.mainChannel)?void 0:t.client)?void 0:e.client)?void 0:n.destroyCopyrightedMusic)&&(this.mainChannel.client.client.destroyCopyrightedMusic(this.zcm),this.zcm=null)}}const iw="https://res.tuwan.com/templet/play/chat/v2/images/empty.png";let ow=1250,sw=1e3,aw=1480,rw=!1,cw=!1,lw="https://asset.tuwan.com/cphead/exploding_point_1228_new.svga";class dw{static triggerCpHead(t,e,n){n&&n!=lw&&(lw=n),console.log("cp 动效触发函数===="),console.log(t),console.log(e);let i=this;if(cw)return cw&&setTimeout((()=>{i.triggerCpHeadDoubleTrigger(t,e)}),1600),!1;if(1===t.length&&1===e.length){if(0==$(`.seat-item[data-uid=${t[0]}]`).length||0==$(`.seat-item[data-uid=${e[0]}]`).length)return!1;let n=null,i=null;parseInt($(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer").css("left"))<parseInt($(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer").css("left"))?(n=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),i=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),t[0],e[0]):(n=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),i=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),e[0],t[0]);let o=parseInt(n.css("left")),s=parseInt(n.css("top")),a=parseInt(i.css("left")),r=parseInt(i.css("top")),c=$(`.seat-item[data-uid=${t[0]}]`).attr("data-aposition"),l=$(`.seat-item[data-uid=${e[0]}]`).attr("data-aposition");if(c>=3&&c<=6&&l>=3&&l<=6||c>=7&&c<=10&&l>=7&&l<=10){let t=.2,e=.9,r=(a-o)/2,l=80;c>=3&&c<=6?(n.css({"offset-path":`path('M 0,0 q${r*t},${l*e} ${r},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-r*t},${l*e} ${-r},${l}')`})):(n.css({"offset-path":`path('M 0,0 q${r*t},${-l*e} ${r},${-l}')`}),i.css({"offset-path":`path('M 0,0 q${-r*t},${-l*e} ${-r},${-l}')`})),n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=c>=3&&c<=6?s+80:s-80;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}else if(2==c){let t=.5,e=.8,c=(a-o)/2,l=(r-s)/2;n.css({"offset-path":`path('M 0,0 q${c*t},${-l*e} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-c*t},${l*e} ${-c},${-l}')`}),n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=s+(r-s)/2;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}else{let t=.8,e=1,c=(a-o)/2,l=(r-s)/2;if(Math.abs(o-a)>5)(r>s||r<s)&&(n.css({"offset-path":`path('M 0,0 q${c*t},${l*e} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-c*t},${-l*e} ${-c},${-l}')`}));else{let t=1,e=50;r>s?(n.css({"offset-path":`path('M 0,0 q${-e},${l*t} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${e},${-l*t} ${-c},${-l}')`})):r<s&&(n.css({"offset-path":`path('M 0,0 q${e},${l*t} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-e},${-l*t} ${-c},${-l}')`}))}n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=s+(r-s)/2;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}}if(1===t.length&&e.length>1){if(!$(`.seat-item[data-uid=${t[0]}]`).length)return!1;let n=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),i=parseInt(n.css("left")),o=parseInt(n.css("top")),s=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer");e.forEach((e=>{if(!$(`.seat-item[data-uid=${e}]`).length)return!1;rw=!0;let n=s.clone(),a=$(`.seat-item[data-uid=${e}]`).find(".cpContainer"),r=parseInt(a.css("left")),c=parseInt(a.css("top")),l=r-i,d=c-o;n.css({"offset-path":`path('M 0,0 L ${l},${d}')`}),n.addClass("active"),n.addClass("canRemove"),n.attr("data-uid",e),$(`.seat-item[data-uid=${t[0]}]`).append(n),setTimeout((()=>{let t=`fireworksCtn-${e}`;$(`.seat-item[data-uid=${e}]`).find(".seat-head").append(`<div class="fireworksCtn innerCtn ${t}"></div`),Zt.getInstance().playEver(`.${t}`,lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow)})),cw=!0,setTimeout((()=>{$(".canRemove").remove(),$(".cpContainer").each((function(){$(this).removeClass("active"),rw=!1}))}),aw)}if(t.length>1&&1===e.length){if(!$(`.seat-item[data-uid=${e[0]}]`).length)return!1;let n=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),i=parseInt(n.css("left")),o=parseInt(n.css("top"));$(".room-seats-content").find(".seat-item").each((function(){let e=$(this),n=this.dataset.uid;if(t.indexOf(n)>-1){if(!$(`.seat-item[data-uid=${n}]`).length)return!1;rw=!0;let t=e.find(".cpContainer"),s=parseInt(t.css("left")),a=parseInt(t.css("top")),r=i-s,c=o-a;e.find(".cpContainer").css({"offset-path":`path('M 0,0 L ${r},${c}')`}),e.find(".cpContainer").addClass("active")}})),cw=!0,rw&&(setTimeout((()=>{let t=`fireworksCtn-${e[0]}`;$(`.seat-item[data-uid=${e[0]}]`).find(".seat-head").append(`<div class="fireworksCtn innerCtn ${t}"></div`),Zt.getInstance().playEver(`.${t}`,lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active"),rw=!1}))}),aw))}}static triggerCpHeadDoubleTrigger(t,e){if(console.log("cp 动效触发函数===="),console.log(t),console.log(e),cw)return!1;if(1===t.length&&1===e.length){if(0==$(`.seat-item[data-uid=${t[0]}]`).length||0==$(`.seat-item[data-uid=${e[0]}]`).length)return!1;let n=null,i=null;parseInt($(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer").css("left"))<parseInt($(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer").css("left"))?(n=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),i=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),t[0],e[0]):(n=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),i=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),e[0],t[0]);let o=parseInt(n.css("left")),s=parseInt(n.css("top")),a=parseInt(i.css("left")),r=parseInt(i.css("top")),c=$(`.seat-item[data-uid=${t[0]}]`).attr("data-aposition"),l=$(`.seat-item[data-uid=${e[0]}]`).attr("data-aposition");if(c>=3&&c<=6&&l>=3&&l<=6||c>=7&&c<=10&&l>=7&&l<=10){let t=.2,e=.9,r=(a-o)/2,l=80;c>=3&&c<=6?(n.css({"offset-path":`path('M 0,0 q${r*t},${l*e} ${r},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-r*t},${l*e} ${-r},${l}')`})):(n.css({"offset-path":`path('M 0,0 q${r*t},${-l*e} ${r},${-l}')`}),i.css({"offset-path":`path('M 0,0 q${-r*t},${-l*e} ${-r},${-l}')`})),n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=c>=3&&c<=6?s+80:s-80;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}else if(2==c){let t=.5,e=.8,c=(a-o)/2,l=(r-s)/2;n.css({"offset-path":`path('M 0,0 q${c*t},${-l*e} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-c*t},${l*e} ${-c},${-l}')`}),n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=s+(r-s)/2;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}else{let t=.8,e=1,c=(a-o)/2,l=(r-s)/2;if(Math.abs(o-a)>5)(r>s||r<s)&&(n.css({"offset-path":`path('M 0,0 q${c*t},${l*e} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-c*t},${-l*e} ${-c},${-l}')`}));else{let t=1,e=50;r>s?(n.css({"offset-path":`path('M 0,0 q${-e},${l*t} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${e},${-l*t} ${-c},${-l}')`})):r<s&&(n.css({"offset-path":`path('M 0,0 q${e},${l*t} ${c},${l}')`}),i.css({"offset-path":`path('M 0,0 q${-e},${-l*t} ${-c},${-l}')`}))}n.addClass("active"),i.addClass("active"),cw=!0,setTimeout((()=>{let t=o+(a-o)/2,e=s+(r-s)/2;$(".room-seats-main").append(`<div class="fireworksCtn innerCtn" style="left: ${t}px; top: ${e}px; transform: translate(-50%, -80%);"></div`),Zt.getInstance().playEver(".fireworksCtn",lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active")}))}),aw)}}if(1===t.length&&e.length>1){if(!$(`.seat-item[data-uid=${t[0]}]`).length)return!1;let n=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer"),i=parseInt(n.css("left")),o=parseInt(n.css("top")),s=$(`.seat-item[data-uid=${t[0]}]`).find(".cpContainer");e.forEach((e=>{if(!$(`.seat-item[data-uid=${e}]`).length)return!1;rw=!0;let n=s.clone(),a=$(`.seat-item[data-uid=${e}]`).find(".cpContainer"),r=parseInt(a.css("left")),c=parseInt(a.css("top")),l=r-i,d=c-o;n.css({"offset-path":`path('M 0,0 L ${l},${d}')`}),n.addClass("active"),n.addClass("canRemove"),n.attr("data-uid",e),$(`.seat-item[data-uid=${t[0]}]`).append(n),setTimeout((()=>{let t=`fireworksCtn-${e}`;$(`.seat-item[data-uid=${e}]`).find(".seat-head").append(`<div class="fireworksCtn innerCtn ${t}"></div`),Zt.getInstance().playEver(`.${t}`,lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow)})),cw=!0,setTimeout((()=>{$(".canRemove").remove(),$(".cpContainer").each((function(){$(this).removeClass("active"),rw=!1}))}),aw)}if(t.length>1&&1===e.length){if(!$(`.seat-item[data-uid=${e[0]}]`).length)return!1;let n=$(`.seat-item[data-uid=${e[0]}]`).find(".cpContainer"),i=parseInt(n.css("left")),o=parseInt(n.css("top"));$(".room-seats-content").find(".seat-item").each((function(){let e=$(this),n=this.dataset.uid;if(t.indexOf(n)>-1){if(!$(`.seat-item[data-uid=${n}]`).length)return!1;rw=!0;let t=e.find(".cpContainer"),s=parseInt(t.css("left")),a=parseInt(t.css("top")),r=i-s,c=o-a;e.find(".cpContainer").css({"offset-path":`path('M 0,0 L ${r},${c}')`}),e.find(".cpContainer").addClass("active")}})),cw=!0,rw&&(setTimeout((()=>{let t=`fireworksCtn-${e[0]}`;$(`.seat-item[data-uid=${e[0]}]`).find(".seat-head").append(`<div class="fireworksCtn innerCtn ${t}"></div`),Zt.getInstance().playEver(`.${t}`,lw,"cpHead"),setTimeout((()=>{Zt.getInstance().clearPlayer("cpHead"),$(".fireworksCtn").remove(),cw=!1}),sw)}),ow),setTimeout((()=>{$(".cpContainer").each((function(){$(this).removeClass("active"),rw=!1}))}),aw))}}}class mw{constructor({language:t,accent:e,appId:n}={}){let i=this;this.status="null",this.language=t||"zh_cn",this.accent=e||"mandarin",this.appId=n||"7d583a06",this.audioData=[],this.resultText="",this.resultTextTemp="";const o={"https://y.tuwan.com":"https://y.tuwan.com/static/chatroom/worker/kdxf_worker.js","https://y-test.tuwan.com":"https://y-test.tuwan.com/events/kdxf_worker.js"},s=o[window.location.origin]?o[window.location.origin]:`${window.location.origin}/kdxf_worker.js`;this.transWorker=new Worker(s),this.transWorker.onmessage=function(t){i.audioData.push(...t.data)}}clearPool(){this.audioData=this.audioData.slice(0,200)}setStatus(t){this.onWillStatusChange&&this.status!==t&&this.onWillStatusChange(this.status,t),this.status=t}setResultText({resultText:t,resultTextTemp:e}={}){this.onTextChange&&this.onTextChange(e||t||""),void 0!==t&&(this.resultText=t),void 0!==e&&(this.resultTextTemp=e)}setParams({language:t,accent:e}={}){t&&(this.language=t),e&&(this.accent=e)}connectWebSocket(){return new Promise(((t,e)=>{var n="wss://iat-api.xfyun.cn/v2/iat",i="iat-api.xfyun.cn",o=(new Date).toGMTString(),s=`host: ${i}\ndate: ${o}\nGET /v2/iat HTTP/1.1`,a=window.CryptoJS.HmacSHA256(s,"ODQzNmViNDU3ZmUxYzNiMWE5MDk0MDRh"),r=window.CryptoJS.enc.Base64.stringify(a);t(n=`${n}?authorization=${btoa(`api_key="5984ebe5b789a38952b7f4ce91ec19b6", algorithm="hmac-sha256", headers="host date request-line", signature="${r}"`)}&date=${o}&host=${i}`)})).then((t=>{let e;if("WebSocket"in window)e=new WebSocket(t);else{if(!("MozWebSocket"in window))return void alert("浏览器不支持WebSocket");e=new window.MozWebSocket(t)}this.webSocket=e,this.setStatus("init"),e.onopen=t=>{console.error("科大讯飞：socket连接成功"),this.audioData=[],this.setStatus("ing"),window.clearTimeout(this.firstTimer),this.firstTimer=setTimeout((()=>{this.webSocketSend()}),100)},e.onmessage=t=>{console.error("科大讯飞：socket收到消息"),this.result(t.data)},e.onerror=t=>{console.error("科大讯飞：socket onerror"),this.recorderStop()},e.onclose=t=>{console.error("科大讯飞：socket onclose"),console.error(t),this.recorderStop()}}))}recorderInit(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}}).then((e=>{t(e)})).catch((t=>{e(t)}));else{if(!navigator.getUserMedia)return navigator.userAgent.toLowerCase().match(/chrome/)&&window.location.origin.indexOf("https://")<0?alert("chrome下获取浏览器录音功能，因为安全性问题，需要在localhost或127.0.0.1或https下才能获取权限"):alert("无法获取浏览器录音功能，请升级浏览器或使用chrome"),void(this.audioContext&&this.audioContext.close());navigator.getUserMedia({audio:!0,video:!1},(e=>{t(e)}),(function(t){e(t)}))}let t=t=>{this.audioContext=new AudioContext,this.scriptProcessor=this.audioContext.createScriptProcessor(0,1,1),this.scriptProcessor.onaudioprocess=t=>{"ing"===this.status&&this.transWorker.postMessage(t.inputBuffer.getChannelData(0))},this.mediaSource=this.audioContext.createMediaStreamSource(t),this.mediaSource.connect(this.scriptProcessor),this.scriptProcessor.connect(this.audioContext.destination),this.connectWebSocket()},e=t=>{console.log(t),this.audioContext&&this.audioContext.close(),this.audioContext=void 0,this.webSocket&&1===this.webSocket.readyState&&this.webSocket.close()}}recorderStart(){this.audioContext?(this.audioContext.resume(),this.connectWebSocket()):this.recorderInit()}recorderStop(){clearTimeout(this.firstTimer),clearInterval(this.handlerInterval),this.handlerInterval=null,this.audioData=[],this.audioContext&&this.audioContext.suspend&&this.audioContext.suspend(),this.setStatus("end")}toBase64(t){for(var e="",n=new Uint8Array(t),i=n.byteLength,o=0;o<i;o++)e+=String.fromCharCode(n[o]);return window.btoa(e)}webSocketSend(){if(1!==this.webSocket.readyState)return;if("ing"!=this.status)return;let t=this.audioData.splice(0,1280);var e={common:{app_id:this.appId,uid:"7d583a06"},business:{language:this.language,domain:"iat",accent:this.accent,vad_eos:1e4,dwa:"wpgs",res_id:"7d583a06"},data:{status:0,format:"audio/L16;rate=16000",encoding:"raw",audio:this.toBase64(t)}};this.webSocket.send(JSON.stringify(e)),console.error("科大讯飞：首帧"),this.idx=0,this.handlerInterval=setInterval((()=>{if(1===this.webSocket.readyState){if(0===this.audioData.length)return"end"===this.status&&(console.error("科大讯飞：结束帧"),this.webSocket.send(JSON.stringify({data:{status:2,format:"audio/L16;rate=16000",encoding:"raw",audio:""}})),clearInterval(this.handlerInterval)),!1;t=this.audioData.splice(0,1280),this.idx++%10==0&&console.error("科大讯飞：中间帧"+this.audioData.length),this.webSocket.send(JSON.stringify({data:{status:1,format:"audio/L16;rate=16000",encoding:"raw",audio:this.toBase64(t)}}))}else clearInterval(this.handlerInterval)}),40)}result(t){let e=JSON.parse(t);if(e.data&&e.data.result){let t=e.data.result,n="",i=t.ws;for(let e=0;e<i.length;e++)n+=i[e].cw[0].w;t.pgs?("apd"===t.pgs&&this.setResultText({resultText:this.resultTextTemp}),this.setResultText({resultTextTemp:this.resultText+n})):this.setResultText({resultText:this.resultText+n})}0===e.code&&2===e.data.status&&(this.webSocket.close(),console.error("科大讯飞：jsonData.data.status === 2")),0!==e.code&&(this.webSocket.close(),console.error("科大讯飞：jsonData.code !== 0"),console.error(`科大讯飞：${e.code}:${e.message}`))}start(){this.audioData=[],this.recorderStart(),this.setResultText({resultText:"",resultTextTemp:""})}stop(){this.webSocket&&(this.webSocket.close(),this.webSocket=null),this.recorderStop()}}class hw{constructor(){this.htmlDom=null,this.queue=[],this.isSearched=!1,this.agoraClient=null,this.agoraLocalAudio=null,this.small_gift_pic=null,this.big_gift_pic=null,this.timer=null,this.soundBlocksDom=null,this.captureAudioHandle=null,this.messageHandle=this.messageHandle.bind(this),this.words=null,this.iatRecorder=null,this.stage=-1,this.wordTimeout=null,this.teamInfo=null,this.agoraUserMap=new Map,this.kdxfTimeout=null}static getInstance(){return this.instance||(this.instance=new hw),this.instance}onReset(){this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null,this.queue=[],this.isSearched=!1,this.clearSubChannelRoom(),this.small_gift_pic=null,this.big_gift_pic=null,this.clearTimer(),this.soundBlocksDom=null,this.stopCaptureAudio(),window.removeEventListener("message",this.messageHandle),this.words=null,this.stage=-1,this.clearWordTimeout(),this.destoryKeDaXunFei(),this.teamInfo=null,this.agoraUserMap.clear(),this.clearKdxfTimeout()}initTemplate(t){this.initHtml(t),this.initEvents(),this.requestPageData(),window.addEventListener("message",this.messageHandle)}initHtml(t){const e=`\n            <div class="race-room-anchor-container" style="margin-top: 30px;">\n                ${Fi._initSeatData(2,158,135,80,80,"主持",!1,!1,"add")}\n                <p class="race-anchor-btn common-btn hide"></p>\n            </div>\n        `,n=`\n            <div class="race-room-jiabin" style="margin-top: 30px;">\n                ${Fi._getOtherAnchorSeatHtml({position:3,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:158,pheight:135,width:80,height:80,isshowmeili:!1})}\n            </div>\n        `;const i=uu.getCid(),o=Ct.readCookie("Tuwan_Passport"),s=Ct.readCookie("g_uid"),a=uu.getSelfInfo()||{},r=a.uid,c=a.nickname,l=window.encodeURIComponent(a.avatar),d=`\n            <div class="race-content-center flex flex-dir-col flex-ac">\n                <p class="race-content-center_title">\n                    <span></span>\n                    <img style="width: 20px; margin-left: 10px; cursor: pointer;" src="https://asset.tuwan.com/chatroom/images/race/rule_btn.png"/>\n                </p>\n                <p class="race-content-center_desc"><span class="span1"></span> <span class="span2"></span></p>\n                <div class="race-game-game">\n                    <iframe src="${uu.getRoomInfo().game_info.game_url+"&cid="+i+"&token="+o+"&userId="+r+"&userName="+c+"&userImg="+l+"&guid="+s}" frameborder="0" scrolling="no" allowtransparency="true"></iframe>\n                    <div class="race-game-tag">\n                        <p></p>\n                    </div>\n                    \n                <div class="blocks">\n                    ${new Array(10).fill(0).map((()=>'<div class="block" style="background-color: rgba(255, 255, 255, 0.2);"></div>')).join("")}\n                </div>\n            \n                </div>\n            </div>\n        `;this.htmlDom=window.$(`\n            <div class="race-room-content flex" style="height: 640px;">\n                <div class="race-room__wrapper flex flex-jc" style="align-items: start; margin-left: 150px;">\n                    ${e}\n                    ${d}\n                    ${n}\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom)}initEvents(){const t=this;this.htmlDom.on("click",".race-content-center .race-content-center_title img",(function(e){e.stopPropagation(),t.showRuleModal()}))}stopCaptureAudio(){this.captureAudioHandle&&(this.captureAudioHandle.stop(),this.captureAudioHandle=null)}requestPageData(){qt.get(Ot.getGameRaceBaseData(uu.getCid())).then((t=>{if(0==t.error){const e=t.data;if(this.stage=e.stage,e.team_info&&0!=e.team_info.team_id&&(this.teamInfo=e.team_info),this.updateCommonHead(e),3==this.stage&&this.isJoinGame()&&(this.words=e.word_data.word_list,this.showWord(e.word_data.now_word_index,1e3*e.word_data.word_countdown),this.openKeDaXunFei()),e.team_info){let t=e.team_info.sub_channel,n=null;const i=0==e.team_info.team_id;n=i||e.team_info.user_info.uid==uu.getMeid()?e.team_info.user_info.channel_key:e.team_info.teammate_info.channel_key,this.joinSubchannelRTC(t,n,i)}}}))}messageHandle(t){if(!this.htmlDom)return;const e=t.data;if("race"===e.type){const t=e.data;switch(t.type){case 1:this.showPlayersModal();break;case 2:this.showRankList();break;case 3:{const e=t.giftId;qt.get(Ot.payDiamond(`format=jsonp&id=${e}&giftid=${e}&platform=0&num=1&cid=${uu.getCid()}&uids=${t.toUid}`)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}break;case 4:this.showSearchModal();break;case 5:Vt(t.msg)}}}update(t){switch(t.mark){case"game_stage":this.stage=t.stage,this.disposeSubscribeAndUnsubscribe(),this.updateCommonHead(t),this.checkShowShoutWord(),1==this.stage&&5==this.stage||this.htmlDom.find(".search_modal").remove(),2==this.stage||3==this.stage||this.destoryKeDaXunFei(),this.clearKdxfTimeout(),this.isJoinGame()&&(2==this.stage?this.kdxfTimeout=setTimeout((()=>{this.openKeDaXunFei()}),1e3*(t.countdown-3)):3==this.stage&&(this.iatRecorder||this.openKeDaXunFei()));break;case"popup_rank_list":this.getResultRankModal();break;case"audience_join_channel":this.agoraUserMap.clear(),this.joinSubchannelRTC(t.sub_channel,t.channel_key,!0);break;case"invite":t.status=0,t.team_id=t.invite_id,t.uid=t.teammate_info.uid,this.pushTeamData(t);break;case"team_success":this.teamInfo=t,t.status=1,this.pushTeamData(t),this.htmlDom.find(".search_modal").remove(),this.joinSubchannelRTC(t.sub_channel,t.user_info.uid==uu.getMeid()?t.user_info.channel_key:t.teammate_info.channel_key),Vt("组队成功，已自动开麦");break;case"refresh":this.refreshRecommend();break;case"user_online":this.recommendOnline(t);break;case"notice_words":this.words=t.word_list,this.checkShowShoutWord();break;case"change_word":this.showWord(t.next_word_index,4e3)}}clearTimer(){window.clearInterval(this.timer),this.timer=null}clearWordTimeout(){this.wordTimeout&&(window.clearTimeout(this.wordTimeout),this.wordTimeout=null)}clearKdxfTimeout(){this.kdxfTimeout&&(window.clearTimeout(this.kdxfTimeout),this.kdxfTimeout=null)}updateCommonHead(t){const e=this.htmlDom.find(".race-content-center"),n=e.find(".race-content-center_desc");e.find(".race-content-center_title span").text(t.title),e.find(".race-game-tag p").text(t.text),this.isJoinGame()||3!=t.stage?this.isJoinGame()||4!=t.stage?n.find(".span1").text(t.intro):n.find(".span1").text("玩家正在呐喊"):n.find(".span1").text("玩家正在配合读词"),this.startCountdown({seconds:t.countdown,dom:n.find(".span2")}),this.clearWordTimeout(),this.modifyRaceGameTagColor("white"),4==t.stage?this.isJoinGame()&&(this.updateVolume(0),e.find(".race-game-game .blocks").show(),e.find(".race-game-tag").hide(),t.countdown>0&&(this.stopCaptureAudio(),this.captureAudioHandle=Ct.captureAudioVolume(this.updateVolume.bind(this),(t=>{t=Math.floor(1.26*t),qt.get(Ot.getGameRaceReportVolume(uu.getCid(),t)).then((t=>{}))})),this.captureAudioHandle.start())):(this.stopCaptureAudio(),e.find(".race-game-game .blocks").hide(),e.find(".race-game-tag").show())}updateVolume(t){if(!this.soundBlocksDom){const t=this.htmlDom.find(".race-content-center .race-game-game .blocks .block");if(0==t.length)return;this.soundBlocksDom=t}!function(t,e){const n=Math.ceil(Number(e)/10);t.toArray().forEach(((t,e)=>window.$(t).css("background-color",`rgba(255, 255, 255, ${e<=n?.8:.2})`)))}(this.soundBlocksDom,t)}startCountdown({seconds:t,dom:e,showS:n=!0}){function i(t){e&&e.text(String(t)+(n?"s":""))}this.clearTimer(),t>0?(i(t),this.timer=setInterval((()=>{i(--t),t<=0&&this.clearTimer()}),1e3)):i(0)}modifyRaceGameTagColor(t){this.htmlDom.find(".race-content-center").find(".race-game-tag p").css("color",t)}getTeammateUid(){return this.teamInfo?this.teamInfo.user_info.uid==uu.getMeid()?this.teamInfo.teammate_info.uid:this.teamInfo.user_info.uid:null}isJoinGame(){return!!this.teamInfo}checkShowShoutWord(){3==this.stage&&this.words&&this.isJoinGame()&&this.showWord(0,4e3)}showWord(t,e){if(this.modifyRaceGameTagColor("white"),this.clearWordTimeout(),3==this.stage&&this.words&&t<this.words.length){this.iatRecorder&&this.iatRecorder.clearPool(),this.currentWord=this.words[t];this.htmlDom.find(".race-content-center").find(".race-game-tag p").text(this.words[t]),this.wordTimeout=setTimeout((()=>{this.showWord(t+1,4e3)}),e)}}openKeDaXunFei(){Ct.loadScript("https://asset2.tuwan.com/chatroom/script/crypto-js.min.js").then((()=>{if(3==this.stage||2==this.stage){if(!this.iatRecorder){const t=this;this.iatRecorder=new mw,this.iatRecorder.onWillStatusChange=function(e,n){"end"==n&&3==t.stage&&setTimeout((()=>{console.error("科大讯飞：开始再次连接socket"),t.iatRecorder&&t.iatRecorder.start()}),500)},this.iatRecorder.onTextChange=function(e){console.error(`科大讯飞：${e}`),t.currentWord&&t.currentWord.length>0&&e.substring(e.length-t.currentWord.length)==t.currentWord&&(t.modifyRaceGameTagColor("#00FFFC"),qt.get(Ot.getGameRaceReportWord(uu.getCid(),t.currentWord)).then((t=>{})))}}this.iatRecorder.start()}}))}destoryKeDaXunFei(){this.iatRecorder&&this.iatRecorder.stop()}disposeSubscribeAndUnsubscribe(){if(this.agoraClient)if(this.isJoinGame())if(4==this.stage)for(let[t,e]of this.agoraUserMap)this.subscribeUser(e);else{const t=this.getTeammateUid();for(let[e,n]of this.agoraUserMap)e!=t&&this.agoraClient.unsubscribe(n,"audio")}else for(let[t,e]of this.agoraUserMap)3==this.stage||4==this.stage?this.subscribeUser(e):this.agoraClient.unsubscribe(e,"audio")}subscribeUser(t){t&&this.agoraClient.subscribe(t,"audio").then((()=>{t.audioTrack.play();const e=xt.getInstance().getMainVolume();t.audioTrack.setVolume(1*e)})).catch((t=>{}))}setVolume(t){if(uu.isGameRace())for(let[e,n]of this.agoraUserMap)n.audioTrack&&n.audioTrack.setVolume(1*t)}async joinSubchannelRTC(t,e,n=!1){if(await this.clearSubChannelRoom(),t&&e){const i=window.AgoraRTC.createClient({mode:"live",codec:"vp8"});this.agoraClient=i,i.on("user-published",((t,e)=>{this.agoraUserMap.set(t.uid,t),this.getTeammateUid()==t.uid&&this.subscribeUser(t),this.isJoinGame()?4==this.stage&&this.subscribeUser(t):3!=this.stage&&4!=this.stage||this.subscribeUser(t)})),i.join(Mt.appid,t,e,1*uu.getMeid()).then((t=>{if(!n){const t=this;window.AgoraRTC.getMicrophones().then((e=>{if(e.length>0)for(let n=0;n<e.length;n++){if("audioinput"==e[n].kind){const e={AEC:!1,AGC:!1,ANS:!1,encoderConfig:"standard_stereo"};window.AgoraRTC.createMicrophoneAudioTrack(e).then((e=>{t.agoraLocalAudio=e,i.setClientRole("host").then((()=>{i.publish(e).then((()=>{})).catch((t=>{}))})).catch((t=>{}))})).catch((t=>{}));break}}})).catch((t=>{}))}})).catch((t=>{}))}}async clearSubChannelRoom(){if(this.agoraClient){try{await this.agoraClient.leave()}catch(t){}this.agoraClient=null,this.agoraLocalAudio&&this.agoraLocalAudio.isPlaying&&(this.agoraLocalAudio.stop(),this.agoraLocalAudio.close()),this.agoraLocalAudio=null}}getCommonBtn(t="",e="fen",n="",i=""){return`\n            <div class="common-btn ${e} ${n}" style="${i}">\n                <p>${t}</p>\n            </div>\n        `}getCommonTitle(t=""){return`<p class="common-title">${t}</p>`}showSearchModal(){const t=window.$(`\n            <div class="search_modal">\n                <div class="race_search_content">\n                    <div class="search_little_box ygb_flex_c">\n                        <input class="race_search_input" type="text" placeholder="请输入用户昵称或ID">\n                        ${this.getCommonBtn("搜索","fen","search_btn common_btn ygb_cursor","margin-left:13px;")}\n                    </div>\n                    <div class="search_list">\n                        <div class="race_invite_list ygb_scroll_list"></div>\n                    </div>\n                </div>\n            </div>\n        `);this.htmlDom.append(t),this.refreshRecommend(t);const e=this;t.on("click",(function(){t.remove()})),t.find(".race_search_content").on("click",(function(t){t.stopPropagation()})),t.find(".search_btn").on("click",(function(t){t.stopPropagation(),e.searchChannelUser()})),t.find(".race_search_input").on("keyup",(function(t){t.stopPropagation(),13==t.which&&e.searchChannelUser()})),t.find(".race_search_input").on("input",(function(t){1==e.isSearched&&0==t.target.value.length&&(e.isSearched=!1,e.refreshRecommend())})),t.find(".race_invite_list").on("click",".giftBtn",(function(t){t.stopPropagation();const e=this.dataset.type,n=this.dataset.uid;qt.get(Ot.getGameRaceGiveGift(uu.getCid(),n,"smallGift"==e?1:2)).then((t=>{if(0!=t.error)Vt(t.error_msg);else{const e=t.data.gift_id;qt.get(Ot.payDiamond(`format=jsonp&id=${e}&giftid=${e}&platform=0&num=1&cid=${uu.getCid()}&uids=${n}`)).then((t=>{0!=t.error&&Vt(t.error_msg)}))}}))}))}searchChannelUser(){let t=this.htmlDom.find(".race_search_input").val();qt.get(Ot.getGameRaceSearch(uu.getCid(),t)).then((t=>{if(0==t.error){const e=window.$(".search_list .race_invite_list");0==t.data.length?e.html('<div class="race_search_fail">没有相关的搜索结果</div>'):e.html(this.renderList(t.data.list)),this.isSearched=!0}else t.error_msg&&t.error_msg.length&&Vt(t.error_msg)}))}renderList(t){let e="";return t.forEach((t=>{e+=this.renderInviteItem(t)})),e}renderInviteItem(t){return`<div class="search_item ygb_cursor ygb_flex_align_c" data-nick="${t.nickname}" data-uid="${t.uid}" data-teamid="${t.team_id}">\n            <img class="invite_header" src="${t.avatar}" onerror="this.src='https://uc.tuwan.com/images/noavatar_1.jpg'">\n            <div class="search_nick text_over">${t.nickname}</div>\n            <div class="search_result_btn flex">\n                <div class="giftBtn ygb_cursor" data-type="smallGift" data-uid="${t.uid}">\n                    <img src="${this.small_gift_pic}"/>\n                    <p>邀请组队</p>\n                </div>\n                <div class="giftBtn ygb_cursor" style="margin-left: 25px;" data-type="bigGift" data-uid="${t.uid}">\n                    <img src="${this.big_gift_pic}"/>\n                    <p>立即组队</p>\n                </div>\n            </div>\n        </div>`}checkEnableModifySearchList(){return!this.isSearched&&this.htmlDom.find(".search_modal").length>0}recommendOnline(t){if(this.checkEnableModifySearchList()){if(t.user_info.uid==uu.getMeid())return;const e=this.htmlDom.find(".search_list .race_invite_list");if(e.children().length>=10&&(t.friend_uid_list=t.friend_uid_list||[],!t.friend_uid_list.map((t=>String(t))).includes(String(uu.getMeid()))))return;this.htmlDom.find(`.search_list .race_invite_list .search_item[data-uid="${t.user_info.uid}"]`).remove(),e.prepend(this.renderInviteItem(t.user_info))}}refreshRecommend(t){this.checkEnableModifySearchList()&&qt.get(Ot.getGameRaceRecommendList(uu.getCid())).then((e=>{if(0==e.error){const n=e.data;this.small_gift_pic=n.small_gift_pic,this.big_gift_pic=n.big_gift_pic;this.htmlDom.find(".search_list .race_invite_list").html(this.renderList(n.list)),t&&t.append(`\n                            <p class="search_modal-notice">\n                                1.送出或收到组队礼物，即可组队成功。<br/>\n                                2.邀请组队：送给对方“${n.small_gift_name}”即可邀请对方组队，需要对方同意<br/>\n                                3.立即组队：送给对方“${n.big_gift_name}”即可立即组队，无需对方同意<br/>\n                            </p>\n                        `)}}))}pushTeamData(t){if(this.htmlDom){if(0==t.status){if(this.queue.findIndex((e=>e.uid==t.uid))>=0)return}0!=t.status&&1!=t.status||(1==t.status&&this.clearQueue(),this.queue.push(t),this.checkShowTeamModal())}}checkShowTeamModal(){const t=this.queue[0];t&&!t._visible&&this.showTeamModal(t)}removeLastModal(){this.queue.shift(),this.checkShowTeamModal()}clearQueue(){this.queue=[],this.htmlDom&&this.htmlDom.find(".teamModal").remove()}showTeamModal(t){const e=this,n=1==t.status;t._visible=!0;const i=window.$(`\n            <div class="teamModal">\n                <div class="teamModal-body">\n                    <p class="teamModal-body-title">CP组队邀请</p>\n                    <div class="teamModal-body-heads">\n                        ${n?o(t.user_info):""}\n                        ${n?'<img class="teamModal-body-heads-heart" src="https://asset.tuwan.com/activity/queqiao2023/image/team_heart.png"/>':""}\n                        ${o(t.teammate_info)}\n                    </div>\n                    <p class="teamModal-body-desc">${n?"恭喜你们组队成功":"邀请您一起参与速度与激情活动"}</p>\n                    <div class="teamModal-body-btns">\n                        ${n?"":s(0,t)}\n                        ${s(1,t)}\n                    </div>\n                </div>\n            </div>\n        `);function o(t){return`\n                <div class="teamModal-body-head">\n                    <img src="${t.avatar}"/>\n                    <p>${t.nickname}</p>\n                </div>\n            `}function s(t=0,e){return`\n                <img data-type="${t}" data-success="${1==e.status?1:0}" data-teamid="${e.team_id}" src="${0==t?"https://asset.tuwan.com/chatroom/images/race/invite_btn_cancel.png":"https://asset.tuwan.com/chatroom/images/race/invite_btn_confirm.png"}"/>\n            `}this.htmlDom.append(i),i.on("click",".teamModal-body-btns img",(function(){if(0==this.dataset.success){let t=this.dataset.teamid;qt.get(Ot.getGameRaceTeamOperate(t,0==this.dataset.type?2:1)).then((t=>{0==t.error||Vt(t.error_msg),i.remove(),e.removeLastModal()}))}else i.remove(),e.removeLastModal()}))}showRuleModal(){const t=window.$(`\n            <div class="race_rule_content">\n                ${this.getCommonTitle("玩法说明")}\n                <img class="close ygb_cursor" src="https://asset.tuwan.com/chatroom/images/qx_rule_close.png">\n                <div class="scroll-bar-hide" style="position: absolute; top: 80px; left: 50%; bottom: 0; width: 972px; transform: translateX(-50%); overflow-y: scroll; padding-bottom: 50px;">\n                    <img src="https://asset.tuwan.com/chatroom/images/race/pc_rule.png" style="width: 100%;"/>\n                    ${["点击立即组队按钮，绑定CP，参与速度与激情比赛。","组队时，选取想要一起参加速度与激情玩法的伙伴，赠送玫瑰花或巧克力~巧克力可以在收礼者未组队情况下直接组队成功！","组队成功后等待比赛开始，在倒计时3、2、1后比赛正式开始，让小车加速吧，在时间范围内，车跑的越远，获得名次越高。","配合阶段90秒，cp双方一起念屏幕上的四字成语，越快念出，小车加速越多。","冲刺阶段60秒，两人大声呐喊，每秒音量越大，加速越多，冲刺阶段可互送礼物，获得额外加速。","错过第一场游戏的玩家，可以在第二场游戏的等待开始环节组队，参与下一局游戏。"].map(((t,e)=>`\n                        <div style="display: flex; align-items: center; position: absolute; left: ${e%2==0?55:545}px; top: ${355*Math.floor(e/2)}px; width: 350px; height: 113px;">\n                            <p style="font-size: 16px; color: #efceff;">${t}</p>\n                        </div>\n                    `))}\n                </div>\n            </div>\n        `);this.htmlDom.append(t),t.on("click",".close",(function(){t.remove()}))}showPlayersModal(){qt.get(Ot.getGameRaceUserList(uu.getCid())).then((t=>{if(0==t.error){let e=function(t){return`\n                        <div class="team_item">\n                            <p class="name" style="text-align: right;">${t.user_info.nickname}</p>\n                            <img class="head" src="${t.user_info.avatar}"/>\n                            <img class="heart" src="https://asset.tuwan.com/activity/queqiao2023/image/team_heart.png"/>\n                            <img class="head" src="${t.teammate_info.avatar}"/>\n                            <p class="name">${t.teammate_info.nickname}</p>\n                        </div>\n                    `};if(this.htmlDom.find(".race_players_modal").length>0)return;const n=t.data.list,i=window.$(`\n                    <div class="race_players_modal">\n                        <div class="race_players_modal-body">\n                            <div class="scroll_view ygb_scroll_list">\n                                <p class="title">参赛选手</p>\n                                ${n.map(e).join("")}\n                            </div>\n                        </div>\n                    </div>\n                `);this.htmlDom.append(i),i.on("click",(function(){i.remove()})),i.on("click",".race_players_modal-body",(function(t){t.stopPropagation()}))}}))}getCommonTop3ItemHtml(t,e){return`\n            <div class="top3 ${[t.user_info.uid,t.teammate_info.uid].includes(uu.getMeid())?"isMine":""} ${e>0?"small":""}">\n                <div class="number" style="background-image: url(https://asset.tuwan.com/chatroom/images/rank_no_${e+1}.png); background-repeat: no-repeat; background-size: 100%;"></div>\n                <div class="heads">\n                    <div class="headName">\n                        <img src="${t.user_info.avatar}" class="headImg">\n                        <p>${t.user_info.nickname}</p>\n                    </div>\n                    <div class="headName">\n                        <img src="${t.teammate_info.avatar}" class="headImg">\n                        <p>${t.teammate_info.nickname}</p>\n                    </div>\n                    <img class="heart" src="https://asset.tuwan.com/chatroom/images/race/rank_heart.png">\n                </div>\n                <p class="score">心动距离:<span>${t.score}</span>米</p>\n            </div>\n        `}getCommonOtherItemHtml(t){return`\n            <div class="other ${[t.user_info.uid,t.teammate_info.uid].includes(uu.getMeid())?"isMine":""}">\n                <div class="number">第${t.order}名</div>\n                <div class="heads">\n                    <div class="headName">\n                        <img src="${t.user_info.avatar}" class="headImg">\n                    </div>\n                    <div class="headName">\n                        <img src="${t.teammate_info.avatar}" class="headImg">\n                    </div>\n                    <img class="heart" src="https://asset.tuwan.com/chatroom/images/race/rank_heart.png">\n                </div>\n                <div class="ps">\n                    <p>${t.user_info.nickname}</p>\n                    <p>${t.teammate_info.nickname}</p>\n                </div>\n                <p class="score">心动距离:<span>${t.score}</span>米</p>\n            </div>\n        `}showRankList(){qt.get(Ot.getGameRaceRankList(uu.getCid())).then((t=>{if(0==t.error){if(this.htmlDom.find(".race_rank_list").length>0)return;let e=t.data.rank_list||[];const n=e.slice(0,3),i=e.slice(3);let o="";for(let t=0;t<3;t++){const e=n[t];o+=e?this.getCommonTop3ItemHtml(e,t):`<div class="top3 ${t>0?"small":""}" style="opacity: 0;"/>`}const s=window.$(` \n                    <div class="race_rank_list">\n                        <div class="bodyContainer">\n                            ${this.getCommonTitle("心动榜")}\n                            <img class="close ygb_cursor" src="https://asset.tuwan.com/chatroom/images/btn_close_rank.png">\n                            <div class="scrollContainer scroll-bar-hide">\n                                ${0==n.length?'<p style="margin-top: 100px; color: #F3C1FF; font-size: 20px; text-align: center;">期待您的登顶呦~</p>':""}\n                                <div class="top3Container">\n                                    ${o}\n                                </div>\n                                ${i.map(this.getCommonOtherItemHtml).join("")}\n                                <div style="height: 50px;"/>\n                            </div>\n                        </div>\n                    </div>\n                `);this.htmlDom.append(s),s.find(".close").on("click",(function(){window.$(".race_rank_list").remove()}))}}))}getResultRankModal(){qt.get(Ot.getGameRaceRankList(uu.getCid(),3)).then((t=>{if(0==t.error){let e=function(t){return`\n                        <div class="gift_item"> \n                            <div class="img_container">\n                                ${t.pic.indexOf(".svga")>=0?`<div class="svga_gift" data-url="${t.pic}"/>`:`<img src="${t.pic}"/>`}\n                            </div>\n                            <p>${t.title}</p>\n                        </div>\n                    `},n=function(){d.find(".gifts_container .svga_gift").each((function(t,e){const n=e.dataset.url;Zt.getInstance().playEver(e,n,n)}))};const i=t.data,o=i.award_list||[];const s=(i.rank_list||[]).slice(0,3);let a="";for(let t=0;t<3;t++){const e=s[t];a+=e?this.getCommonTop3ItemHtml(e,t):`<div class="top3 ${t>0?"small":""}" style="opacity: 0;"/>`}const r=i.self_data.order,c=o.length>0,l=c?r<=3?"small":"":0==r?"small_small":"small",d=window.$(` \n                    <div class="race_result_rank">\n                        <div class="race_result_rank-body ${l}">\n                            <div class="top3Container">\n                                ${a}\n                            </div>\n                            ${r>3?this.getCommonOtherItemHtml(i.self_data):""}\n                            ${c?`\n                                <div class="gifts_container">\n                                    ${o.map(e).join("")}\n                                </div>\n                            `:""}\n                            <img class="race_result_rank-btn" style="" data-type="${c?1:0}" src="https://asset.tuwan.com/chatroom/images/race/result_btn_${c?"receive":"confirm"}.png"/>\n                            ${1==i.is_end_round?'<p class="race_result_rank-countdown">活动已结束，10秒后返回原厅</p>':""}\n                        </div>\n                    </div>\n                `);window.$("body").append(d),setTimeout((()=>{d.remove()}),1e4),n(),d.on("click",(function(){d.remove()})),d.on("click",".race_result_rank-body",(function(t){t.stopPropagation()})),d.on("click",".race_result_rank-btn",(function(t){t.stopPropagation();1==this.dataset.type?qt.get(Ot.getGameRaceGetAward(uu.getCid())).then((t=>{0==t.error?(Vt("领取成功"),d.remove()):Vt(t.error_msg)})):d.remove()}))}}))}}function uw(t="",e=""){am.exec().then((()=>{const n=uu.getRoomInfo();console.log("roomInfo=-="),console.log(n);const i=n.channelKey;uu.globalRtcClient.initChat(t||uu.getRoomInfo().uid,e||i)})).catch((()=>{}))}let pw;class gw{constructor(){}static getInstance(){return this.instance||(this.instance=new gw),this.instance}onReset(){clearInterval(pw)}toMatch(){qt.get(Ot.PeaceTeamMatch(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}countdown(){if(uu.roomInfo.team_countdown){let t=uu.roomInfo.team_countdown,e=$('.opbutton.show[data-type="pipei"]');e.html(Ct.formNumberToHourMinute(t)),clearInterval(pw),pw=setInterval((()=>{if(t<=1)return clearInterval(pw),e.html("匹配"),void(e=null);t--,e.html(Ct.formNumberToHourMinute(t))}),1e3)}}subscribe(t){t.typeid;const e=t.type;if(132!==e&&138!==e)return;t.data.cid;let n=t.data.team_stage;if(132===e){const e=t.data.cid;if(!uu.isPeaceTeamRoom())return void ou(e);console.log("global_team_stage=="+n),console.log(3==n),3==n?$(".peaceTeam-main-container .kingTeamVsLogoCtn").hasClass("hide")&&($(".peaceTeam-main-container .kingTeamVsLogoCtn").removeClass("hide"),$(".peaceTeam-main-container .kingTeamVsLogoCtn_static_img").addClass("hide"),setTimeout((()=>{}),0),setTimeout((()=>{Zt.getInstance().playEver(".kingTeamVsLogoCtn","https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamStartGame.svga","kingTeamVsLog")}),10),setTimeout((()=>{$(".peaceTeam-main-container .kingTeamVsLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("kingTeamVsLog")}),1600),setTimeout((()=>{ou(e)}),1700),setTimeout((()=>{n=null}),3e3)):ou(e)}else if(138===e){const e=t.cid;qt.get(Ot.PeaceTeamGetwheat(e)).then((t=>{let e=t.data.list||[],i=t.data.team_stage,o=t.data.team_countdown,s=t.data.list[0].is_pre,a=e[0].is_pre,r=0,c=e.length;if(n=i,e.forEach((t=>{1==t.is_pre&&r++})),o){let t=$(".peaceTeamMatchBottomCtn .timerCtn"),e=o||0;pw&&(clearInterval(pw),pw="");let n=$(".peaceTeam-main-container .kingTeamVsLogoCtn_static_img");pw=setInterval((()=>{if(e<=0)return clearInterval(pw),pw="",n.addClass("hide"),void t.html("");e--,r>=uu.getRoomInfo().min_member&&10==e&&n.removeClass("hide"),1==s&&e<=120&&$(".peaceTeam-main-container .pt_centerCtn").hasClass("white")&&($(".peaceTeam-main-container .pt_centerCtn").removeClass("white"),$(".peaceTeam-main-container .pt_centerCtn .timeSum").html("比赛倒计时：")),e>=0&&e<10&&n.html(`比赛倒计时 ${e}s`),t.html(Ct.formNumberToHourMinute(e))}),1e3)}3==i&&t.data.list[0].data[0].uid==uu.getMeid()&&$('.opbutton[data-type="matchCodeImg"]').trigger("click"),1==i&&ci.hide(-6),window.$(".peaceTeam-main-container .onlyPositinCtn").html(Fi.onlyPositionInitPeaceTeamVsTempSeats(t.data)),setTimeout((()=>{setTimeout((()=>{Fi.showPeaceTeamPositionFn(t.data),uu.anchorUsers.clear(),uu.setAnchorsMap(t.data.list[0].data),uw()}),50)}),50),window.$(".peaceTeamMatchBottomCtn .pt_leftCtn").html(`队伍：${c}支`),window.$(".peaceTeamMatchBottomCtn .subReadyNumsCtn").html(r),1==a?(window.$(".peaceTeamMatchBottomCtn .rightBtn").removeClass("readyStatusBtn"),window.$(".peaceTeamMatchBottomCtn .rightBtn").addClass("opt5")):(window.$(".peaceTeamMatchBottomCtn .rightBtn").removeClass("opt5"),window.$(".peaceTeamMatchBottomCtn .rightBtn").addClass("readyStatusBtn")),e[0].data[0].uid==uu.getMeid()?window.$(".peaceTeamMatchBottomCtn .flagCtn").removeClass("hide"):(window.$(".peaceTeamMatchBottomCtn .altCtn").removeClass("hide"),window.$(".peaceTeamMatchBottomCtn .pt_centerCtn").addClass("white"))}))}}loadRoomStage(t){const e=t,n=t.team_stage,i=t.img_wheat_pc,o=t.skin_active?iw:t.skin;let s=1*t.uid;ci.show(-1,ci.type.peaceTeamBtn),Zt.getInstance().clearPlayer("kingTeamVsLog"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamMatchSucess.svga"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamStartGame.svga"),$(".peaceTeam-main-container .kingTeamVsLogoCtn").addClass("hide"),1==n?(window.$(".room-seats-main").html(Fi.init1vs7TempSeats(e)),window.$(".room-seats-main").css("background","none"),""!=o&&o!=iw?window.$(".chat-center-left").css({background:"url("+o+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=i&&window.$(".troom1v7-container").css({background:"url("+i+") no-repeat","background-size":"cover"})):($(".play-again-conatiner").addClass("hide"),ci.hide(-5),setTimeout((()=>{pw&&clearInterval(pw),2==n&&(setTimeout((()=>{$(".peaceTeam-main-container .kingTeamWaitToStartTimerCtn").addClass("hide"),$('.seat-item[data-aposition="2"]').attr("data-uid")==uu.getMeid()||$('.seat-item[data-aposition="10"]').attr("data-uid")==uu.getMeid()?$(".peaceTeam-main-container .kingTeamWaitToStartTimerCtnFlexCtn").removeClass("hide"):($(".peaceTeam-main-container .kingTeamWaitToStartTimerCtnFlexCtn").removeClass("hide"),$(".kingTeamWaitToStartTimerCtnFlexCtn .leaveBtn").hide(),$(".kingTeamWaitToStartTimerCtnFlexCtn .title").hide()),$(".peaceTeam-main-container .kingTeamVsLogoCtn").removeClass("hide")}),1e3),setTimeout((()=>{Zt.getInstance().playEver(".kingTeamVsLogoCtn","https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamMatchSucess.svga","kingTeamVsLog")}),1010),setTimeout((()=>{$(".peaceTeam-main-container .kingTeamVsLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("kingTeamVsLog")}),2600));let i=t.cid,o=t.channelKey,a=e.match_mode,r=e.max_member;e.min_member,qt.get(Ot.PeaceTeamGetwheat(i)).then((t=>{window.$(".room-seats-main").html(Fi.initPeaceTeamVsTempSeats(t.data,a,r)),setTimeout((()=>{Fi.showPeaceTeamPositionFn(t.data),uu.anchorUsers.clear(),uu.setAnchorsMap(t.data.list[0].data),uw(s,o)}),50);let e=t.data.team_countdown,n=t.data.team_stage,i=t.data.list[0].is_pre;2==n||3==n&&t.data.list[0].data[0].uid==uu.getMeid()?3==n&&$('.opbutton[data-type="matchCodeImg"]').trigger("click"):ci.hide(-6);let c=t.data.list||[],l=0;if(c.forEach((t=>{1==t.is_pre&&l++})),e){let t=$(".peaceTeamMatchBottomCtn .timerCtn"),n=e||0;pw&&(clearInterval(pw),pw="");let o=$(".peaceTeam-main-container .kingTeamVsLogoCtn_static_img");pw=setInterval((()=>{if(n<=0)return clearInterval(pw),o.addClass("hide"),void t.html("");n--,l>=uu.getRoomInfo().min_member&&10==n&&o.removeClass("hide"),1==i&&n<=120&&$(".peaceTeam-main-container .pt_centerCtn").hasClass("white")&&($(".peaceTeam-main-container .pt_centerCtn").removeClass("white"),$(".peaceTeam-main-container .pt_centerCtn .timeSum").html("匹配倒计时：")),n>=0&&n<10&&o.html(`比赛倒计时 ${n}s`),t.html(Ct.formNumberToHourMinute(n))}),1e3)}let d=t.data.list||[];d.length&&setTimeout((()=>{d[0].data[0].uid==s?window.$(".peaceTeamMatchBottomCtn .flagCtn").removeClass("hide"):(window.$(".peaceTeamMatchBottomCtn .altCtn").removeClass("hide"),window.$(".peaceTeamMatchBottomCtn .pt_centerCtn").addClass("white")),uu.anchorUsers.clear(),uu.setAnchorsMap(t.data.list[0].data),uw()}),50)}))}),10),window.$(".room-seats-main").css("background","none"),""!=o&&o!=iw?window.$(".chat-center-left").css({background:"url("+o+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=i&&window.$(".troom1v7-container").css({background:"url("+i+") no-repeat","background-size":"cover"}))}}const fw="SVGA_LOOP_KEY";class ww{constructor(){this.timer=null,this.svgPlayerFlag="",this.vapPlayer=null}static getInstance(){return this.instance||(this.instance=new ww),this.instance}onReset(){$(".pet_container").remove(),this.clearLoopSvga(),this.vapPlayer&&(this.vapPlayer.destory(),this.vapPlayer=null)}getContainer(){let t=$(".pet_container");return 0==t.length&&(t=$('<div class="pet_container"></div>'),window.$(".room-seats-content").append(t),window.$('<div class="petParentCtn"></div>').insertBefore(t),t.on("click",(function(t){t.stopPropagation();const e=uu.getRoomInfo().pet;if(2==e.jumpType)window.open(e.url);else{const t={url:e.url,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(t)}}))),t}clearLoopSvga(){clearInterval(this.timer),Zt.getInstance().clearPlayer(fw)}canShowRooms(){return[7,30,32,39,44].includes(1*uu.getRoomInfo().typeid)}checkVisible(){const t=uu.getRoomInfo().pet,e=uu.getRoomInfo().pet.animateFlow,n=uu.getRoomInfo().pet.vapConfig||"";if(t&&this.canShowRooms()){this.vapPlayer&&(this.vapPlayer.destory(),this.vapPlayer=null);let t=0,i=e.length;this.getContainer();const o=$(".pet_container");e[0].indexOf("svga")>-1?(o.removeClass("vapCtn"),e.forEach((t=>{Zt.getInstance().preload(t)})),clearInterval(this.timer),Zt.getInstance().clearPlayer(this.svgPlayerFlag),this.svgPlayerFlag=fw+"index",Zt.getInstance().playEver(".pet_container",e[t],fw),t++,t%=i,1==i?Zt.getInstance().playEver(".pet_container",e[0],this.svgPlayerFlag):this.timer=setInterval((()=>{Zt.getInstance().clearPlayer(this.svgPlayerFlag),this.svgPlayerFlag=fw+"index",Zt.getInstance().playEver(".pet_container",e[t],this.svgPlayerFlag),t++,t%=i}),1e4)):(o.addClass("vapCtn"),o.html(""),this.vapPlayer=new Xt,n&&this.vapPlayer&&this.vapPlayer.play({url:e[0],ele:o.get(0),mute:!0,loop:!0,config:n}).then((t=>{})).catch((t=>{})))}else this.onReset()}showOnceSvga(t){const e=this.getContainer();Zt.getInstance().loadParser(e[0],t.src,1,!0,"Forward",!0).then((({videoItem:t,player:e})=>{e.setVideoItem(t),e.startAnimation(),e.onFinished((()=>{e.stopAnimation(),e.clear(),this.checkVisible()}))}))}update(t){this.clearLoopSvga(),t.animateFlow&&t.animateFlow.length>0?(uu.getRoomInfo().pet=t,this.checkVisible()):(uu.getRoomInfo().pet=null,this.onReset())}}class vw{constructor(){this.anchorThresholdValid=!1;const t=this;window.$(".chat-function-up-seat").on("click",(function(e){const n="1"==xt.getInstance().getUpSeatSwitch();xt.getInstance().setUpSeatSwitch(n?"0":"1"),t.updateUpSeatState()}))}static getInstance(){return this.instance||(this.instance=new vw),this.instance}onReset(){this.anchorThresholdValid=!1,this.updateThresholdValidValue(),this.updateUpSeatState()}updateThresholdValidValue(){const t=uu.getRoomInfo();this.anchorThresholdValid=1==t.is_redpacket&&uu.getAnchoringUserId()==uu.getMeid(),this.checkUpSeatVisiable(),this.checkRedpackageVisiable()}checkUpSeatVisiable(){const t=window.$(".chat-function-up-seat");this.anchorThresholdValid?t.show():t.hide()}checkRedpackageVisiable(){const t=window.$(".chatroom-redjilu");this.anchorThresholdValid?t.show():t.hide()}updateUpSeatState(){const t="1"==xt.getInstance().getUpSeatSwitch();window.$(".chat-function-up-seat").find(".chat-function-text").text(t?"取消屏蔽申请上麦":"屏蔽申请上麦")}}const _w={1:"shitou",2:"jiandao",3:"bu"},yw={1:"石头",2:"剪刀",3:"布"},xw={"石头":1,"剪刀":2,"布":3};class bw{constructor(){this.htmlDom=null,this.stageData=null,this.countdownTimer=null,this.countUpMap={},this.leftMyScore=0,this.rightMyScore=0,this.audioContext=null,this.isCapture=!1,this.captureTimer=null,this.captureAudioVolumn=0,this.agoraClient=null,this.agoraLocalAudio=null,this.unsubscribeRobot=function(){},this.showLoginWindow=function(){},this.soundToastIsShowed=!1,this.sub_channel=null,this.sub_channel_token=null,this.globalAgoraClient=null,this.doubleConfig=null,this.isJoinedRoom=!1,this.joinChanneledCallback=this.joinChanneledCallback.bind(this),this.mineData={}}static getInstance(){return this.instance||(this.instance=new bw),this.instance}onReset(){this.clearCountdownTimer(),this.clearCaptureTimer(),this.stageData=null,this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null,this.closeAudioContext(),this.isCapture=!1,this.sub_channel=null,this.sub_channel_token=null,this.mineData={},this.clearSubChannelRoom(),this.onGameReset(),this.destoryDoubleClient()}clearAllCountUp(){Object.values(this.countUpMap).forEach((t=>{t&&t.pauseResume()})),this.countUpMap={}}onGameReset(){this.clearAllCountUp(),this.leftMyScore=0,this.rightMyScore=0}initTemplate(t){this.initHtml(t),this.initEvents(),this.preloadImages(),1==uu.getRoomInfo().is_double_chatroom&&this.createDoubleClient()}preloadImages(){["left","right"].forEach((t=>["shitou","jiandao","bu"].forEach((e=>Ct.loadImage(`https://asset.tuwan.com/chatroom/images/icon_squid_${t}_${e}.png`)))))}updateData(t){const e=this.stageData;if(this.stageData=t,e&&2==e.game_id&&2==t.game_id&&null==t.team1.user_list[0].nickname&&(this.stageData.team1.user_list=e.team1.user_list,this.stageData.team2.user_list=e.team2.user_list),this.commonUpdate(),0==t.stage||0==t.game_state?(this.mineData.game_data=null,this.mineData.team1_score=0,this.mineData.team2_score=0,0==t.stage&&(this.onGameReset(),this.soundToastIsShowed=!1),4==t.game_id?this.gameGuessElementHtml():(this.gameTopNoticeHtml(),this.htmlDom.find(".squid-game-element").remove(),this.htmlDom.find(".squid-game-top").show(),this.htmlDom.find(".squid-game-buttom").show())):1==t.game_id?null!=this.mineData.my_team_id&&(this.mineData.game_data&&this.mineData.game_data.number==t.game_info.number||(this.mineData.game_data||(this.mineData.game_data={}),this.mineData.game_data.right_num=0),this.gameTopAnswerHtml()):2==t.game_id?null!=this.mineData.my_team_id&&this.stageData.game_info&&(this.getMineTeamGuess().length?this.gameTopGuessHtml():this.gameTopNoticeHtml()):3==t.game_id?this.gameTopSoundHtml():4==t.game_id?this.gameGuessElementHtml():this.gameTopNoticeHtml(),3==t.game_id){if(this.mineJoinedGame()&&(!this.sub_channel||!this.sub_channel_token)){const t=this.findTeamDataById(uu.getMeid());t&&t.sub_channel&&(this.sub_channel=t.sub_channel,this.sub_channel_token=t.sub_channel_token)}}else this.sub_channel=null,this.sub_channel_token=null;this.joinSubChannelRoom(),4==t.game_id||(this.updateRopePosition(),this.updatePeoplesInfo()),this.updateCardInfo("left"),this.updateCardInfo("right"),this.updateStage(),this.updateBottomBtns(),this.checkAudioCapture(),1==t.popup_award&&t.game_award&&this.showWinSideModal(t.game_award),1==t.popup_rank&&t.final_rank_data&&this.showResultModal(t.final_rank_data)}updateMineData(t){if(this.mineData=c(c({},this.mineData),t),this.stageData&&this.updateData(this.stageData),t.game_data&&t.game_data.toast_content){const e=window.$(".chat-center-window-main"),n=window.$(`\n                <p style="position: fixed; left: 1200px; bottom: 150px; line-height: 39px; text-align: center; padding: 0 15px; font-size: 15px; font-weight: bold; color: white; border-radius: 0px 30px 30px 30px; background-color: #FF6691;">${t.game_data.toast_content}</p>\n            `);e.append(n),n.snabbt({duration:1e3,position:[0,-100,0],fromOpacity:1,opacity:0,delay:1e3,complete:()=>{n.remove()}})}}seatsUpdate(){this.checkPublishDoubleAudio(),this.commonUpdate()}commonUpdate(){const t=this.stageData;if(!t||!this.htmlDom)return null;const e=window.$(".squid-room-content .squid-room-anchor-container").find(".squid-anchor-btn"),n=this.htmlDom.find(".squid-user-btn");if(uu.isAnchoringUser(uu.getMeid())){if(t.button_title&&t.button_title.length){const n=2==t.button_state?"disable":"",i=2==t.button_state?"":"disable";e.removeClass("hide").addClass(n).removeClass(i),e.text(t.button_title)}else e.addClass("hide");n.addClass("hide")}else e.addClass("hide"),0==t.stage?(n.text(this.mineJoinedGame()?"取消参与":"立即参与"),n.removeClass("hide")):n.addClass("hide")}updateStage(){const t=uu.getRoomInfo().game_custom.game_list,e=this.htmlDom.find(".squid-content-center_stage"),n=e.find("p");0==n.length&&e.append(t.map(((t,e)=>`<p data-stage="${e}">${t.game_name}</p>`)).join("")),n.removeClass("current");const i=t.findIndex((t=>t.game_id==this.stageData.game_id));if(0!=this.stageData.stage)for(var o=0;o<=i;o++)window.$(`.squid-content-center_stage p[data-stage="${o}"]`).addClass("current");const s=t[-1===i?0:i].game_desc;window.$(".squid-content-center_stage_desc").text(s)}updateBottomBtns(){const t=this.htmlDom.find(".squid-fighting-btns"),e=t.find('.squid-fighting-btn[data-type="left"]'),n=t.find('.squid-fighting-btn[data-type="right"]'),i=uu.getRoomInfo().game_custom;e.children(".title").text(i.team1_name+"加油"),n.children(".title").text(i.team2_name+"加油"),e.children(".desc").text(i.button_desc),n.children(".desc").text(i.button_desc),0==this.stageData.stage?t.addClass("hide"):(this.mineJoinedBlueTeam()?(n.addClass("hide"),e.removeClass("hide")):this.mineJoinedRedTeam()?(e.addClass("hide"),n.removeClass("hide")):(e.removeClass("hide"),n.removeClass("hide")),t.removeClass("hide"))}updateRopePosition(){const t=this.stageData.team1,e=this.stageData.team2,n=Math.min(t.score,e.score),i=Math.max(t.score,e.score);let o=0;o=0!=n?Math.abs(i-n)/n:0==i?0:1,o>1&&(o=1),this.htmlDom.find(".rope-peoples").css("transform",`translate(calc(-50% ${t.score>e.score?"-":"+"} ${50*o}px))`)}mineJoinedGame(){return 1==this.mineData.my_team_id||2==this.mineData.my_team_id}mineJoinedBlueTeam(){return 1==this.mineData.my_team_id}mineJoinedRedTeam(){return 2==this.mineData.my_team_id}mineJoinedTeamType(){return this.mineJoinedBlueTeam()?"left":"right"}getGameInfoById(t){return uu.getRoomInfo().game_custom.game_list.find((e=>e.game_id==t))}findTeamFriend(t){const e=this.stageData.team1.user_list||[],n=this.stageData.team2.user_list||[];return(this.mineJoinedBlueTeam()?n:e).find((e=>e.sub_team_id==t))}findTeamDataById(t){return[...this.stageData.team1.user_list||[],...this.stageData.team2.user_list||[]].find((e=>e.uid===t))}getMineTeamGuess(){const t=this.mineJoinedGame(),e=this.findTeamDataById(uu.getMeid());if(t&&e&&0!=e.sub_team_id){return[e,this.findTeamFriend(e.sub_team_id)]}return[]}countUpLabel(t,e,n,i){this.countUpMap[e]?0==n?(this.countUpMap[e]=null,t.innerText=i(n)):this.countUpMap[e].update(n):(this.countUpMap[e]=new Al(t,n,{separator:"",formattingFn:i}),this.countUpMap[e].start())}updateCardInfo(t){const e=this.stageData,n="left"==t?e.team1:e.team2,i=uu.getRoomInfo().game_custom,o="left"==t?i.team1_name:i.team2_name,s=this.htmlDom.find(`.squid-game-buttom .card-${t}`);s.find(".name").text(o);let a=null;if(4==e.game_id&&(a=this.htmlDom.find(".squid-game-element .score-con "+("left"==t?".left-con":".right-con"))),0!=e.stage){if(this.countUpLabel(s.find(".strength")[0],`strengthCountUp_${t}`,n.score,(t=>`力量值：${t}`)),a&&a.length){const e=a.find(".number")[0];try{this.countUpLabel(e,`elementStrengthCountUp_${t}`,n.score,(t=>`${t}`))}catch(m){}}}else s.find(".strength").text("力量值：0");const r=s.find(".my-strength")[0];let c=null;a&&a.length&&(c=a.find(".my-strength")[0]);const l="left"==t?this.leftMyScore:this.rightMyScore,d=("left"==t?this.mineData.team1_score:this.mineData.team2_score)||0;if((d>0||l>0)&&0!=e.stage){let e=d||l;if(this.countUpLabel(r,`myStrengthCountUp_${t}`,e,(t=>`(+${t})`)),c&&this.countUpLabel(c,`elementMyStrengthCountUp_${t}`,e,(t=>`(+${t})`)),l>0&&d-l>0){const e=window.$(`<p class="my-strength-effect">+${d-l}</p>`);a&&a.length?("left"==t?e.css("right","5px"):e.css("left","5px"),a.find(".strength-con").append(e)):(e.css("right","5px"),s.find(".strength-con").append(e)),e.snabbt({position:[0,-20,0],fromOpacity:1,opacity:0,duration:500,complete:function(){e.remove()}})}d&&("left"==t?this.leftMyScore=d:this.rightMyScore=d)}else r.innerText="",c&&(c.innerText="");if(0==e.stage)s.find(".gameScore").text("");else{const t=uu.getRoomInfo().game_custom.game_list,i=["game1_score","game2_score","game3_score"];s.find(".gameScore").text(`本局：${n[i[t.findIndex((t=>t.game_id==e.game_id))]]||0}`)}"left"==t&&this.mineJoinedBlueTeam()||"right"==t&&this.mineJoinedRedTeam()?s.find(".tag").removeClass("hide"):s.find(".tag").addClass("hide")}updatePeoplesInfo(){const t=this,e=this.htmlDom.find(".rope-peoples"),n=window.$(e.find(".rope-peoples-left .people").toArray().reverse()),i=e.find(".rope-peoples-right .people"),o=this.stageData;function s(e){const s="left"==e;let a=(s?o.team1.user_list:o.team2.user_list)||[];a=[...a];const r=a.findIndex((t=>t.uid==uu.getMeid()));if(-1!=r){const t=a.splice(r,1);a.unshift(t[0])}else(s&&t.mineJoinedBlueTeam()||!s&&t.mineJoinedRedTeam())&&a.unshift({avatar:uu.getSelfInfo().avatar});const c=s?n:i;o.stage;const l=a.length<3?3:a.length>5?5:a.length;for(let t=0;t<l;t++){const e=window.$(c[t]).css("opacity",1);a[t]?d(e.text("").css("border","1px solid #FFFFFF"),a[t].avatar):d(e.text("?").css("border","none"),`https://asset.tuwan.com/chatroom/images/icon_squid_card_people_${s?"blue":"red"}.png`)}for(let t=l;t<5;t++)window.$(c[t]).css("opacity",0);function d(t,e){t.css("backgroundImage").replace("url(","").replace(")","")!=`"${e}"`&&t.css({background:`url(${e}) no-repeat`,"background-size":"100%"})}}s("left"),s("right"),e.removeClass("hide")}gameTopNoticeHtml(){const t=this.stageData;let e="";function n(t){return`<p style="font-size: 16px;">${t}</p>`}const i=uu.getRoomInfo().game_custom;e=0!=t.stage&&1==t.game_state&&2==t.game_id?`\n                ${n(`${i.team1_name}胜：${t.team1.game2_win_num}场`)}\n                ${n(`${i.team2_name}胜：${t.team2.game2_win_num}场`)}\n            `:`\n                ${n(`${i.team1_name}人数：${t.team1.people_num}`)}\n                ${n(`${i.team2_name}人数：${t.team2.people_num}`)}\n            `;const o=this.getGameInfoById(t.game_id),s=0==t.game_state&&o?o.intro:"";this.setTopHtml(`\n            <p style="padding: 20px 0 15px 0; text-align: center; font-weight: 600; font-size: 17px; color: rgba(255, 255, 255, 0.5);">${t.waiting_title}</p>\n            <div class="flex flex-between" style="padding: 0 20px;">\n                ${e}\n            </div>\n            <p style="position: absolute; left: 50%; top: -26px; transform: translateX(-50%); white-space: nowrap;">${s}</p>\n        `)}gameTopAnswerHtml(){const t=this.stageData.game_info,e=this.mineData.game_data,n=t.number;if(this.htmlDom.find(`.squid-game-top .game-question[data-answer-id=${n}]`).length){const t=this.htmlDom.find(".squid-game-top");return t.find(".totalCount span").text(e.right_num||0),void t.find(".correctCount span").text(e.total_right_num||0)}const i=window.$(`\n            <div class="game-question" style="position: relative; height: 100%; padding: 0 10px; padding-top: 15px;" data-answer-id="${n}">\n                <p style="height: 50px; font-size: 16px;">${n}、${t.question}</p>\n                <p class="totalCount" style="text-align: right; font-size: 16px;">本题答对：<span>${e.right_num||0}</span>/${t.answer_num}种答案</p>\n                <div class="flex flex-ac flex-jc" style="position: absolute; left: 50%; top: -23px; transform: translateX(-50%); width: 320px;">\n                    <p style="margin-right: 20px;">共${t.total_number}题</p>\n                    <p class="correctCount">共答对：<span>${e.total_right_num||0}</span>种答案</p>\n                    <p class="countdownLabel" style="position: absolute; right: 0;"></p>\n                </div>\n            </div>\n        `);this.setTopHtml(i),this.startCountdown(t.countdown,i.find(".countdownLabel"))}gameTopGuessHtml(){const t=this,e=this.stageData,n=e.game_info;let i=this.mineData.game_data||{};i.number!=n.number&&(i.opponent_result=0,i.my_result=0,i.guess_result=0);const o=n.number||0,s=i.win_num||0,a=i.even_num||0,r=i.lose_num||0,c=i.opponent_result||0,l=i.my_result||0,d=i.guess_result||0;if(this.htmlDom.find(`.game-guess-tag-${o}-${d}`).length)return;const m="caidingke_left",h="caidingke_right";Zt.getInstance().clearPlayer(m),Zt.getInstance().clearPlayer(h);const[u,p]=this.getMineTeamGuess();function g(e="left",n){const i=t.mineJoinedTeamType()==e,o=!i,s=i?l:c;return`\n                <div class="flex flex-ac game-user user-${e}">\n                    ${o&&0==c?"":`\n                        <div class="tags flex">\n                            ${["石头","剪刀","布"].map((n=>function(e,n){const i=t.mineJoinedTeamType()==n?l:c;return`\n                <div class="tag flex flex-ac flex-jc ${i>0&&yw[i]!=e?"disable":""}" data-name="${e}">\n                    <p style="font-size: 12px; width: 12px; color: white;">${e}</p>\n                </div>\n            `}(n,e))).join("")}\n                        </div>\n                    `}\n                    <div class="user flex flex-dir-col flex-ac">\n                        <img class="head" src="${n.avatar}">\n                        <p class="name">${n.nickname}</p>\n                        <img class="bu hide" src="${0==s?"":`https://asset.tuwan.com/chatroom/images/icon_squid_${e}_${_w[s]}.png`}"/>\n                        <div id="bu-svga"/>\n                        <div class="win"></div>\n                    </div>\n                    ${o&&0==c?'<p class="selecting">选择中...</p>':""}\n                </div>\n            `}const f=this.mineJoinedBlueTeam()?u:p,w=this.mineJoinedBlueTeam()?p:u,v=uu.getRoomInfo().game_custom.game_list,_=window.$(`\n            <div class="game-guess game-guess-tag-${o}-${d}" style="position: relative; height: 100%; padding-top: 5px;">\n                <div class="flex flex-between" style="margin-top: 10px;">\n                    ${g("left",f)}\n                    ${g("right",w)}\n                    <p class="countdownLabel" style="position: absolute; top: 2px; left: 50%; transform: translateX(-50%);"></p>\n                </div>\n                <div class="flex flex-ac flex-jc" style="position: absolute; left: 50%; top: -23px; transform: translateX(-50%); width: 320px;">\n                    <p style="margin-right: 20px;">${v.find((t=>2==t.game_id)).intro}</p>    \n                    <p style="margin-right: 20px;">胜:${s}局</p>\n                    <p style="margin-right: 20px;">平:${a}局</p>\n                    <p>负:${r}局</p>\n                </div>\n            </div>\n        `);if(this.setTopHtml(_),0==d&&n.countdown&&this.startCountdown(n.countdown,_.find(".countdownLabel")),d>0){let t=function(t){t.snabbt({fromScale:[1.4,1.4],scale:[.8,.8],duration:100,complete:()=>{t.snabbt({scale:[1,1],duration:100})}})};l>0&&c>0&&setTimeout((()=>{t(_.find(".user-left .bu").removeClass("hide")),t(_.find(".user-right .bu").removeClass("hide"))}),100),3!=d&&setTimeout((()=>{const t=_.find(`.user-${this.mineJoinedTeamType()} .win`);2==d&&(this.mineJoinedBlueTeam()?t.css("left","74px"):t.css("left","-98px")),Zt.getInstance().loadParser(t[0],`https://asset.tuwan.com/chatroom/svga/icon_caidingke_result_${1==d?"win":"ping"}.svga`,1,!1).then((({player:t,videoItem:e})=>{t.setVideoItem(e),t.startAnimation()}),(t=>{}))}),1e3)}if(0==c&&(Zt.getInstance().playEver(_.find(".user-left #bu-svga")[0],"https://asset.tuwan.com/chatroom/svga/icon_left_caidingke.svga",m),Zt.getInstance().playEver(_.find(".user-right #bu-svga")[0],"https://asset.tuwan.com/chatroom/svga/icon_right_caidingke.svga",h)),0==l){const n=Ct.preventQuickClick(500);_.on("click",".tags .tag",(function(){if(0==l){const s=o,a=this.dataset.name,r=xw[a];n((()=>{t.disposeRequestErrorMsg(qt.get(Ot.getSquidGuess(uu.getCid(),e.base_id,s,r))).then((e=>{0==e.error&&2==t.stageData.game_id&&t.stageData.game_info.number==s&&(i.my_result=r,_.find(`.user-${t.mineJoinedTeamType()} .tag`).each((function(t,e){e.dataset.name!=a&&window.$(e).addClass("disable")})))}))}))}}))}}gameGuessElementHtml(t){const e=this.htmlDom.find(".squid-game-element");if(t){if(e.length>0)return;this.htmlDom.find(".squid-game-buttom").hide(),this.htmlDom.find(".squid-game-top").hide();const n=500,i="rgba(255, 255, 255, 0.5)",o=this.stageData,s=window.$(`\n                <div class="squid-game-element" style="width: ${n}px;" data-gamestate="${o.game_state}">\n                    <div class="topPs">\n                        <p class="wait" style="display: ${0==o.game_state?"block":"none"}">${o.waiting_title}</p>\n                        <p class="number" style="display: ${0==o.game_state?"none":"block"}">已找到<span>${this.mineJoinedGame()?o.game_info.player_find_num:o.game_info.audience_find_num}</span>/${o.game_info.total_num}种元素</p>\n                        <p class="countdownLabel" style="display: ${0==o.game_state?"none":"block"}"></p>\n                    </div>\n                    <div class="guess-content" style="height: ${n/t.width*t.height}px">\n                        <img class="guess-image" draggable="false" src="${t.pic}"/>\n                    </div>\n                    \n                    <div class="score-con">\n                        <div class="left-con">\n                            <p class="name">力量值</p>\n                            <div class="strength-con">\n                                <p class="number"></p>\n                                <p class="my-strength"></p>\n                            </div>\n                            <img src="https://asset.tuwan.com/chatroom/images/icon_squid_v.png"/>\n                        </div>\n                        <div class="right-con">\n                            <img src="https://asset.tuwan.com/chatroom/images/icon_squid_s.png"/>\n                            <div class="strength-con">\n                                <p class="my-strength"></p>\n                                <p class="number"></p>\n                            </div>\n                            <p class="name">力量值</p>\n                        </div>\n                    </div>\n                    <div class="guess-images">\n                        ${t.item_list.map((t=>`<img src="${t.img_url}" data-id="${t.id}" style="background-color: ${0==t.find_team||this.mineJoinedGame()&&-1==t.find_team?i:"#FF6691"}"/>`)).join("")}\n                    </div>\n                </div>\n            `);s.insertAfter(this.htmlDom.find(".squid-game-buttom")),this.startCountdown(o.game_info.countdown,s.find(".countdownLabel"));const a=s.find(".guess-content"),r=s.find(".guess-images"),c=a.find(".guess-image"),l=this.htmlDom[0].getBoundingClientRect(),d=this;c.on("click",(function(e){if(uu.getMeid()>Mt.maxUID)return void d.showLoginWindow();const n=c[0].getBoundingClientRect(),i=e.offsetX,o=e.offsetY,s=Math.ceil(i/e.target.width*t.width),m=Math.ceil(o/e.target.height*t.height);qt.get(Ot.getCommitElementPosition(uu.getCid(),s,m)).then((e=>{if(0==e.error){const s=e.data.id,a=t.item_list.find((t=>t.id==s));if(a){const t=30,e=30,c=n.left-l.left+i-t/2,m=n.top-l.top+o-e/2,h=window.$(`\n                                <img src="${a.img_url}" style="width: ${t}px; height: ${e}px; position: absolute; left: ${c}px; top: ${m}px"/>\n                            `);d.htmlDom.append(h);const u=r.find(`img[data-id="${s}"]`),p=u[0].getBoundingClientRect();d.flyToTargetElement(h,u,p.left-l.left-c,p.top-l.top-m)}}if(0==e.error||10==e.error){const t=window.$(`<div style="position: absolute; left: ${i-20}px; top: ${o-20}px; width: 40px; height: 40px;"/>`);a.append(t),Zt.getInstance().loadParser(t[0],`https://asset.tuwan.com/chatroom/images/guess_element_${10==e.error?"error":"right"}.svga`,1,!0).then((({player:e,videoItem:n})=>{e.setVideoItem(n),e.startAnimation(),e.onFinished((()=>{t.remove()}))}),(t=>{}))}else Vt(e.error_msg)}))})),this.updateData(this.stageData)}else if(e.length){const t=this.stageData;0==e.data("gamestate")&&1==t.game_state&&(e.data("gamestate",1),e.find(".topPs .wait").hide(),e.find(".topPs .number").show(),e.find(".topPs .countdownLabel").show(),this.startCountdown(t.game_info.countdown,e.find(".countdownLabel"))),1==t.game_state&&e.find(".topPs .number span").text((this.mineJoinedGame()?t.game_info.player_find_num:t.game_info.audience_find_num)||0)}}updateElementGuessImgState(t){if(t.find_uid==uu.getMeid())return;if(-1==t.find_team&&this.mineJoinedGame())return;this.htmlDom.find(`.squid-game-element .guess-images img[data-id="${t.id}"]`).css("background-color","#FF6691")}flyToTargetElement(t,e,n,i){t.snabbt({position:[n,i,0],duration:400,complete:()=>{t.remove(),e.css("background-color","#FF6691"),e.snabbt({scale:[1.3,1.3],duration:150}).snabbt({scale:[1,1],duration:150})}})}gameTopSoundHtml(){const t=this.stageData.team1,e=this.stageData.team2,n=this.stageData.game_info,i=this.htmlDom.find(".game-sound"),o=uu.getRoomInfo().game_custom;if(i.length)return s(i.find(".left-sound"),t,o.team1_name),void s(i.find(".right-sound"),e,o.team2_name);if(!n||!n.countdown)return;function s(t,e,n){t.find("p:first-child").text(a(e,n)),t.find("p:last-child").text(r(e,n))}function a(t,e){return`${e}音值：${t.game3_volume_num}`}function r(t,e){return`${e}加油：${t.game3_support_num}`}const c=window.$(`\n            <div class="game-sound" style="position: relative; height: 100%;">\n                <p style="text-align: center; padding: 10px 0; font-size: 18px;">本局战况</p>\n                <div class="volume-values flex flex-between">\n                    <div class="left-sound" style="display: inline-block;">\n                        <p>${a(t,o.team1_name)}</p>\n                        <p>${r(t,o.team1_name)}</p>\n                    </div>\n                    <div class="right-sound" style="display: inline-block;">\n                        <p>${a(e,o.team2_name)}</p>\n                        <p>${r(e,o.team2_name)}</p>\n                    </div>\n                </div>\n                <div class="flex flex-jc flex-ac" style="position: absolute; left: 50%; top: -35px; transform: translateX(-50%);">\n                    <p class="countdownLabel" style="font-size: 25px; font-weight: 600;"></p>\n                    <p style="font-size: 15px; font-weight: 600; margin-top: 7px; margin-left: 3px;">s</p>\n                </div>\n            </div>\n        `);this.setTopHtml(c),this.startCountdown(n.countdown,c.find(".countdownLabel"),!1),this.mineJoinedGame()&&1==this.stageData.game_state&&0==this.soundToastIsShowed&&(this.soundToastIsShowed=!0,Vt("您的麦克风已打开,开始呐喊助威吧！"))}checkAudioCapture(){const t=this;if(1==this.stageData.stage&&3==this.stageData.game_id&&1==this.stageData.game_state&&0==this.isCapture&&this.mineJoinedGame()){this.isCapture=!0;const e=this.htmlDom.find(`.card-${this.mineJoinedTeamType()} .sound-progress-bar`).removeClass("hide").find(".small-block");navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}}).then((n=>{if(1==t.stageData.stage&&3==t.stageData.game_id&&1==t.stageData.game_state&&1==t.isCapture){let i=function(){qt.get(Ot.getSquidReportVolume(uu.getCid(),t.stageData.base_id,t.mineJoinedBlueTeam()?1:2,t.captureAudioVolumn)).then((t=>{})),t.captureAudioVolumn=0};const o=window.AudioContext||window.webkitAudioContext;this.audioContext=new o;const s=this.audioContext.createMediaStreamSource(n),a=this.audioContext.createGain();s.connect(a);const r=this.audioContext.createScriptProcessor(2048,1,1);r.onaudioprocess=Ct.throttle((function(n){for(var i=n.inputBuffer.getChannelData(0),o=0,s=0;s<i.length;s++)o<i[s]&&(o=i[s]);const a=Math.round(100*o);t.captureAudioVolumn=Math.max(a,t.captureAudioVolumn),e.removeClass("full"),e.toArray().slice(0,1*Number(a/10<1?1:a/10).toFixed(0)).forEach((t=>window.$(t).addClass("full")))}),50),a.connect(r),r.connect(this.audioContext.destination),this.clearCaptureTimer(),this.captureTimer=setInterval(i,1e3),setTimeout(i,200)}})).catch((t=>{console.log(t)}))}else 3!=this.stageData.game_id&&this.isCapture&&(this.isCapture=!1,this.closeAudioContext(),this.clearCaptureTimer(),this.htmlDom.find(".sound-progress-bar").addClass("hide")),0==this.stageData.stage&&(this.clearCaptureTimer(),this.closeAudioContext())}clearSubChannelRoom(){this.agoraClient&&(this.agoraClient.leave().then((()=>{this.agoraLocalAudio&&this.agoraLocalAudio.isPlaying&&(this.agoraLocalAudio.stop(),this.agoraLocalAudio.close()),this.agoraLocalAudio=null})).catch((t=>{})),this.agoraClient=null)}isRobot(t){return!!uu.isSquidGame()&&Number(t)>1e8}clearRobot(){}joinSubChannelRoom(){const t=this,e=this.stageData;if(1!=e.stage||3!=e.game_id||1!=e.game_state||this.agoraClient)3==e.game_id&&1==e.game_state||(this.clearSubChannelRoom(),this.clearRobot());else if(this.sub_channel&&this.sub_channel_token){const e=window.AgoraRTC.createClient({mode:"live",codec:"vp8"});this.agoraClient=e,window.AgoraRTC.getMicrophones().then((n=>{if(n.length>0)for(let i=0;i<n.length;i++){const o=n[i].kind;if(n[i].deviceId,"audioinput"==o){e.join(Mt.appid,this.sub_channel,this.sub_channel_token,1*uu.getMeid()).then((n=>{window.AgoraRTC.createMicrophoneAudioTrack({AEC:!1,AGC:!1,ANS:!1,encoderConfig:"standard_stereo"}).then((n=>{t.agoraLocalAudio=n,e.setClientRole("host").then((()=>{e.publish(n).then((()=>{})).catch((t=>{}))})).catch((t=>{}))})).catch((t=>{}))})).catch((t=>{}));break}}})).catch((t=>{}))}}setTopHtml(t){this.clearCountdownTimer(),this.htmlDom.find(".squid-game-top").html(t)}clearCountdownTimer(){this.countdownTimer&&(window.clearInterval(this.countdownTimer),this.countdownTimer=null)}clearCaptureTimer(){this.captureTimer&&(window.clearInterval(this.captureTimer),this.captureTimer=null)}closeAudioContext(){this.audioContext&&"closed"!==this.audioContext.state&&(this.audioContext.close(),this.audioContext=null)}startCountdown(t,e,n=!0){let i=this;if(this.clearCountdownTimer(),t&&e.html(String(t)+(n?"s":"")),t>0){let o=t;this.countdownTimer=setInterval((()=>{e&&e.html(String(--o)+(n?"s":"")),o<=0&&i.clearCountdownTimer()}),1e3)}}getRewardHtml(t){return-1!=t.indexOf(".svga")?`<div class="reward-svga" data-url="${t}"></div>`:`<div class="reward-img"><img src="${t}"/></div>`}checkSvgaReward(){window.$(".squid-win-side-modal .reward-svga, .squid-result-modal .reward-svga").each((function(t,e){const n=e.dataset.url;Zt.getInstance().playEver(e,n,n)}))}showWinSideModal(t){window.$(".squid-win-side-modal").remove();const e=this.stageData.team1,n=this.stageData.team2,i=1==t.win_team?uu.getRoomInfo().game_custom.team1_name:uu.getRoomInfo().game_custom.team2_name,o=t.award_list[0]||{},s=-1!=t.award_uid_list.findIndex((t=>t==uu.getMeid())),a=this.stageData.base_id;function r(e){return e[`game${t.award_game_id}_score`]||0}const c=uu.getRoomInfo().game_custom.game_list,l=uu.getRoomInfo().game_custom,d=window.$(`\n            <div class="squid-win-side-modal flex flex-jc flex-ac">\n                <div class="squid-win-side-modal_body flex flex-dir-col flex-ac" style="padding-bottom: 15px;">\n                    <p class="title">${i}获胜</p>\n                    <p class="type">${c.find((e=>e.game_id==t.award_game_id)).game_name}游戏</p>\n                    <div class="user flex flex-dir-col flex-ac">\n                        ${this.getRewardHtml(o.pic)}\n                        <p>${o.title} ${o.title_suffix}</p>\n                    </div>\n                    ${s?'<p class="squid-receive-award-btn common-btn">立即领取</p>':""}\n                    <div class="desc flex flex-between">\n                        <p>${l.team1_name}力量：${r(e)}</p>\n                        <p>${l.team2_name}力量：${r(n)}</p>\n                    </div>\n                </div>\n            </div>\n        `);this.registerReceveRewardEvent(d,a,t.award_game_id,0),this.modalRemove(d),this.modalTenSecondsRemove(d),window.$("body").append(d),this.checkSvgaReward()}showResultModal(t){const e=this,n=this.stageData.team1,i=this.stageData.team2,o=1==t.win_team?n:i,s=this.mineData.my_team_id==t.win_team,a=1==t.win_team?uu.getRoomInfo().game_custom.team1_name:uu.getRoomInfo().game_custom.team2_name,r=e.stageData.base_id;let c=[];const l=t.rank_list.find((t=>t.user_info.uid==uu.getMeid()));l?c=l.award_list:s&&(c=t.common_award_list);const d=window.$(`\n            <div class="squid-result-modal flex flex-jc flex-ac">\n                <div class="squid-result-modal_body flex flex-dir-col flex-ac" style="height: auto; min-height: 200px">\n                    <p class="title">${a}获胜</p>\n                    <p class="type">总力量值: ${o.score}</p>\n                    <div class="users flex flex-dir-col flex-ac">\n                        ${t.rank_list.map((function(t){const e=t.order;return`\n                <div class="flex flex-ac" style="width: 320px; height: 70px; padding-right: 10px;">\n                    <div class="flex flex-jc" style="width: 50px;">\n                        ${e>3?`<p style="width: 20px; line-height: 20px; border-radius: 100%; background-color: #F6F6F6; color: #999999; font-size: 14px; font-weight: 600; text-align: center;">${e}</p>`:`<img style="width: 25px; height: 25px;" src="https://asset.tuwan.com/chatroom/images/icon_songpk_tag_${e}.png">`}\n                    </div>\n                    <img style="width: 46px; height: 46px; border-radius: 100%;" src="${t.user_info.avatar}"/>\n                    <p class="flex-1" style="margin-left: 15px; font-size: 14px; color: rgba(255, 255, 255, 0.9);">${t.user_info.nickname}</p>\n                    <p style="width: 100px; font-size: 14px; color: rgba(255, 255, 255, 0.9); text-align: right;">${t.score} 力量</p>\n                </div>\n            `})).join("")}\n                    </div>\n                    ${c.length?`\n                            <p class="rewardTitle">本轮奖励</p>\n                            <div class="rewards flex flex-jc">\n                                ${c.map((function(t){return`\n                <div class="reward-item flex flex-dir-col flex-ac">\n                    ${e.getRewardHtml(t.pic)}\n                    <p class="name">${t.title}</p>\n                    <p class="number">${t.title_suffix}</p>\n                </div>\n            `})).join("")}\n                            </div>\n                            <p class="squid-receive-award-btn common-btn">立即领取</p>\n                        `:""}\n                </div>\n            </div>\n        `);setTimeout((()=>{window.$(".squid-result-modal").remove(),this.registerReceveRewardEvent(d,r,"",1),this.modalRemove(d),this.modalTenSecondsRemove(d),window.$("body").append(d),this.checkSvgaReward()}),5e3)}registerReceveRewardEvent(t,e,n,i){const o=this,s=Ct.preventQuickClick(500);t.on("click",".squid-receive-award-btn",(function(t){t.stopPropagation(),s((()=>{window.$(this).hasClass("disable")||o.disposeRequestErrorMsg(qt.get(Ot.getSquidReward(uu.getCid(),e,n,i))).then((t=>{0==t.error&&(window.$(this).addClass("disable"),Vt("领取成功"))}))}))}))}modalRemove(t){t.click((function(){window.$(this).remove()}))}modalTenSecondsRemove(t){setTimeout((()=>{t.remove()}),1e4)}joinChanneledCallback(){this.isJoinedRoom=!0,this.checkPublishDoubleAudio()}createDoubleClient(){this.globalAgoraClient&&this.globalAgoraClient.emitter.on("joinChanneled",this.joinChanneledCallback)}destoryDoubleClient(){this.globalAgoraClient&&(this.globalAgoraClient.emitter.off("joinChanneled",this.joinChanneledCallback),this.doubleConfig=null,this.globalAgoraClient=null,this.isJoinedRoom=!1)}checkPublishDoubleAudio(){if(1==uu.getRoomInfo().is_double_chatroom&&this.isJoinedRoom)if(uu.isAnchoringUser(uu.getMeid())){if(this.doubleConfig)return;const t=window.AgoraRTC.createChannelMediaRelayConfiguration();this.doubleConfig=t;const e=uu.getRoomInfo();t.setSrcChannelInfo({channelName:e.channel,uid:1*uu.getMeid(),token:e.source_channel_key}),t.addDestChannelInfo({channelName:e.other_channel,uid:1*uu.getMeid(),token:e.other_channel_key}),this.globalAgoraClient.agoraRtc.client.startChannelMediaRelay(t)}else this.doubleConfig&&(this.doubleConfig.removeDestChannelInfo(uu.getRoomInfo().other_channel),this.doubleConfig=null,this.globalAgoraClient.agoraRtc.client.stopChannelMediaRelay())}initHtml(t){const e=`\n            <div class="squid-room-anchor-container">\n                ${Fi._initSeatData(2,158,135,80,80,"主持",!1,!1,"add")}\n                <p class="squid-anchor-btn common-btn hide"></p>\n            </div>\n        `,n=`\n            <div class="squid-room-jiabin">\n                ${Fi._getOtherAnchorSeatHtml({position:3,shouhutype:1,index:0,role:"嘉宾",defaultbg:"add",pwidth:158,pheight:135,width:80,height:80,isshowmeili:!1})}\n            </div>\n        `;function i(t="left"){return`\n                <div class="flex flex-dir-col flex-ac card card-${t}">\n                    <p class="tag hide">我方</p>\n                    <p class="gameScore"></p>\n                    <p class="name"></p>\n                    <div class="strength-con flex flex-jc flex-ac">\n                        <p class="strength"></p>\n                        <p class="my-strength"></p>\n                    </div>\n                    \n                <div class="sound-progress-bar flex hide">\n                    ${new Array(10).fill(0).map((t=>'<div class="small-block"/>')).join("")}\n                </div>\n            \n                </div>\n            `}function o(t="",e){return`\n                <div class="squid-fighting-btn common-btn ${t}" data-type="${e}">\n                    <p class="title" style="margin-top: 5px; line-height: 20px; font-size: 16px; color: white; font-weight: 600;"></p>\n                    <p class="desc" style="color: rgba(255, 255, 255, 0.5); font-size: 12px; line-height: 15px;"></p>\n                </div>\n            `}const s=`\n            <div class="squid-content-center flex flex-dir-col flex-ac">\n                <div class="squid-content-center_stage flex flex-jb">\n                </div>\n                <p class="squid-content-center_stage_desc"></p>\n                <div class="squid-game-top"></div>\n                <div class="squid-game-buttom flex" style="margin-top: 10px; position: relative;">\n                    ${i()}\n                    ${i("right")}\n                    ${function(){function t(t="left"){return`\n                    <div class="rope-peoples-${t} flex" style="position: relative; z-index: 1;">\n                        ${new Array(5).fill(0).map(((e,n)=>`<p class="people" style="z-index: ${"right"===t?3-n:0}; margin-left: ${0!==n?"-5px":0};">?</p>`)).join("")}\n                    </div>\n                `}return`\n                <div class="rope-peoples flex flex-between flex-ac hide">\n                    ${t()}\n                    <img class="red-scarf" src="https://asset.tuwan.com/chatroom/images/icon_squid_card_red_scarf.png"/>\n                    <img class="rope" src="https://asset.tuwan.com/chatroom/images/icon_squid_card_rope.png"/>\n                    ${t("right")}\n                </div>\n            `}()}\n                </div>\n                <p class="squid-user-btn common-btn blue hide">立即参与</p>\n                <div class="squid-fighting-btns flex flex-between hide" style="width: 500px;">\n                    ${o("blue","left")}\n                    ${o("","right")}\n                </div>\n            </div>\n        `;this.htmlDom=window.$(`\n            <div class="squid-room-content flex" style="height: 550px;">\n                <div class="squid-room__wrapper flex flex-jc" style="align-items: start; margin-left: 150px;">\n                    ${e}\n                    ${s}\n                    ${n}\n                    <div class="songpk-menus" style="position: absolute; left: 30px; top: 35px;">\n                        <div class="song-but songpk-but-rule flex flex-jc flex-ac">玩法</div>\n                    </div>\n                </div>\n            </div>\n        `),window.$(".room-seats-main").html(this.htmlDom)}disposeRequestErrorMsg(t){return t.then((t=>(0!=t.error&&t.error_msg&&Vt(t.error_msg),t)))}initEvents(){const t=this,e=Ct.preventQuickClick(500);window.$(".squid-room-content").on("click",".squid-room-anchor-container .squid-anchor-btn",(function(n){n.stopPropagation(),window.$(this).hasClass("disable")||e((()=>{t.disposeRequestErrorMsg(qt.get(Ot.getSquidButton(uu.getCid()))).then((t=>{}))}))}));const n=Ct.preventQuickClick(500);this.htmlDom.find(".squid-user-btn").click((function(){uu.getMeid()>Mt.maxUID?t.showLoginWindow():n((()=>{const e=t.mineJoinedGame()?Ot.getSquidCancelJoinGame(uu.getCid()):Ot.getSquidJoinGame(uu.getCid());t.disposeRequestErrorMsg(qt.get(e)).then((t=>{}))}))})),this.htmlDom.find(".squid-fighting-btn").click((function(){0!=window.$(this).css("opacity")&&(uu.getMeid()>Mt.maxUID?t.showLoginWindow():t.disposeRequestErrorMsg(qt.get(Ot.getSquidSupportTeam(uu.getCid(),"left"==this.dataset.type?1:2))).then((t=>{})))})),window.$(".squid-room-content").on("click",".songpk-but-rule",(function(t){t.stopPropagation(),ze.show({title:"玩法介绍",desc:uu.roomInfo.rule_desc.replace(/\/r\/n/g,"<br />").replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")})}))}}class $w{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new $w),this.instance}inWhiteList(){return[3025799,10408274,107714,2660763,4572050,1154003,1397557,13519683].includes(uu.getMeid())}}let kw=null;function Cw(t){if(document.hidden)return;const e=t.data,n=e.uid;if((Si.getInstance().getFullScreenStatus()||Ti.getInstance().getFullScreenStatus()||Mi.getInstance().getFullScreenStatus())&&n!=uu.getMeid())return;const i=Ct.UUIDNOCA();let o=null,s=null,a=null,r=null,c=null;if(e.vap_pc_url){const t=window.$('<div class="vap_gift" data-type="socket33_5"></div>');window.$("body").append(t),c=t.get(0)}else e.video_pc_url?(o=`svga_${i}`,window.$("body").append('<div id="'+o+'" style="z-index:1002" class="canvassvga-fullscreen" data-type="socket33_5"></div>'),a=`videoAlphaGift_${i}`,window.$(".video_gift").append(`<canvas class="video_canvas" id="${a}"></canvas>`)):(o=`svga_${i}`,window.$("body").append('<div id="'+o+'" class="canvassvga-fullscreen" data-type="socket33_5"></div>'));if(s=document.querySelector("#"+o),r=document.querySelector("#"+a),!kw){kw=new Zt(window.SVGA);const t=kw.emitter;t.on("onplayfinished",Iw),t.on("onloadfail",Sw)}kw.addComin({teacherid:e.teacherid,uid:n,svgaele:s,videoele:r,vapele:c,path:e.svga_pc,attrs:e.attr,clearsAfterStop:!1,giftid:e.giftid,video_pc_url:e.video_pc_url,video_sound:e.video_sound,video_type:e.video_type,vap_pc_url:e.vap_pc_url,vap_pc_config:e.vap_pc_config}),Wm("gift_all_receive",{giftid:e.giftid,uid:e.uid,teacherid:e.teacherid,cid:uu.getCid(),selfuid:uu.getMeid()})}function Iw(t){const e=t.teacherid,n=t.videoele,i=t.video_sound,o=t.vapele,s=t.vapPlayer,a=t.svgaele;o&&kd.giftFly(window.$(o),e,Tm(),{vapPlayer:s}),a&&kd.giftFly(window.$(a),e,Tm()),n&&(1==i&&tu(1),kd.giftFly(window.$(n),e,Tm())),Wm("gift_all_play",{giftid:t.giftid,uid:t.uid,teacherid:t.teacherid,cid:uu.getCid(),selfuid:uu.getMeid()})}function Sw(t,e){Wm("gift_load_fail",{giftid:t.giftid,uid:t.uid,teacherid:t.teacherid,cid:uu.getCid(),selfuid:uu.getMeid(),url:t.path||""},{err:e+""})}class Tw{constructor(){this.initStyle(),this.requested=!1}static getInstance(){return this.instance||(this.instance=new Tw),this.instance}initStyle(){window.$("head").append("<style>\n                        .birthday_mask{display:flex;justify-content:center;align-items:center;width: 100%;height: 100%;background: rgba(0, 0, 0, 0.5);top: 0;left: 0;z-index: 2000;position: fixed;}\n                        .birth_content{position:relative;text-align:center;margin-top:-90px;width:906px;height:780px}\n                        .birth_cake_content,.birth_cake_svga{width:906px;height:682px}\n                        .birth_cake_svga canvas {position: absolute;height: 100%;left: 50%;top: 50%;transform: translate(-50%, -50%) !important;pointer-events: none}\n                        .birth_avatar{position:absolute;width:68px;height:68px;border-radius:50%;top:17.3%;left:57%}\n                        .birth_desc{font-size:24px;color:#fff;margin-top:-40px}\n                        .birth_take{width: 200px;height: 62px;background: #FF6691;color:#fff;border-radius: 31px;font-size:28px;line-height:62px;margin:22px auto;cursor: pointer;}\n                    </style>")}getBirthInfo(){this.requested||(this.requested=!0,qt.get(`${Pt}/User/getBirthInfo`).then((t=>{if(0==t.error&&t.data.uid){const e=[{location:40,length:15},{location:24,length:31},{location:32,length:16}],{svga_url_pc:n,desc:i,avatar:o,svga_attr:s,typeid:a}=t.data;let r="";r=n.endsWith("svga")?'<div class="birth_cake_svga"></div>':`<div class="birth_cake_content">\n                                    <img class="birth_cake" src="${n}" alt="">\n                                    <img class="birth_avatar" src="${o}" alt="">\n                                </div>`;let c=`<div class="birthday_mask">\n                                <div class="birth_content">\n                                    ${r}\n                                    <div class="birth_desc">${i}</div>\n                                    <div class="birth_take">领取</div>\n                                </div>\n                            </div>`;if(window.$("body").append(c),n.endsWith("svga")){let t=new window.SVGA.Player(".birth_cake_svga"),i=new window.SVGA.Parser(".birth_cake_svga");t.loops=1,i.load(n,(function(n){t.setVideoItem(n),t.startAnimation(),a<3&&t.setImage(s[0].data.pic,s[0].skey),t.onFinished((()=>{t.startAnimationWithRange(e[a-1],!1)}))}))}this.initEvents()}})))}initEvents(){window.$(document).on("click",".birth_take",(function(){qt.get(`${Pt}/User/getBirthGift`).then((t=>{window.$(".birthday_mask").remove(),Vt(t.error_msg)}))}))}}const Rw="https://res.tuwan.com/templet/play/chat/v2/images/empty.png";class Mw{constructor(){this.styleLoaded=!1}static getInstance(){return this.instance||(this.instance=new Mw,this.instance.onEventListener()),this.instance}onReset(){this.hide()}show(){0===window.$("#changeSmallroom").length&&(this.initStyle(),this.initHtml()),qt.get(Ot.getSongFleetInfo()).then((t=>{if(0==t.error){let n="";for(var e of t.data.live_list)n+=`<p class="${e.live==t.data.live?"current":""}" data-desc="${e.desc}" data-live="${e.live}">${e.name}</p>`;let i="";const o=t.data.live_list.find((t=>11==t.live));if(o)for(var e of o.table_list||[])i+=`<p class="${1==e.is_selected?"current":""}" data-type="${e.table_type}">${e.title}</p>`;window.$("#changeSmallroom .row1 input").val(t.data.room_title||""),window.$("#changeSmallroom .row2 .select_img").attr("src",t.data.room_icon),window.$("#changeSmallroom .confirm").attr("data-id",t.data.id),window.$("#changeSmallroom .row4").html(n),window.$("#changeSmallroom .row6").html(i),"11"==t.data.live?window.$("#changeSmallroom .langren_container").removeClass("hide"):window.$("#changeSmallroom .langren_container").addClass("hide")}else Vt(t.error_msg)})).catch((t=>{Vt("网络错误,请稍后再试..")}))}hide(){window.$("#changeSmallroom").remove()}onEventListener(){let t=this;window.$(document).on("click","#changeSmallroom",(t=>{t.stopPropagation(),this.hide()})),window.$(document).on("click",".song-but-setting",(()=>{this.show()})),window.$(document).on("click","#changeSmallroom .changeSmallroom-body",(t=>{t.stopPropagation()})),window.$(document).on("change","#uploadImage",(function(t){Ct.uploadImageWithVerify(t.target,(function(t){window.$("#changeSmallroom .row2 .select_img").attr("src",t)}),500,500,500)})),window.$(document).on("click","#changeSmallroom .row4 p",(t=>{t.stopPropagation(),window.$("#changeSmallroom .row4 p").removeClass("current"),window.$(t.target).addClass("current"),window.$("#changeSmallroom .row3 span").html(t.target.dataset.desc),"11"==t.target.dataset.live?window.$("#changeSmallroom .langren_container").removeClass("hide"):window.$("#changeSmallroom .langren_container").addClass("hide")})),window.$(document).on("click","#changeSmallroom .row6 p",(t=>{t.stopPropagation(),window.$("#changeSmallroom .row6 p").removeClass("current"),window.$(t.target).addClass("current")})),window.$(document).on("click","#changeSmallroom .confirm",(e=>{e.stopPropagation();const n=window.$("#changeSmallroom .changeSmallroom-body"),i=n.find(".row1 input").val().trim();if(0==i.length)return void Vt("请填写房间标题");const o=n.find(".row2 .select_img").attr("src");if(o==Rw)return void Vt("请设置房间图标");const s=n.find(".row4 p.current")[0];if(!s)return void Vt("请选择房间类型");const a=s.dataset.live;if("11"==a){if(!n.find(".row6 p.current")[0])return void Vt("请选择游戏人数")}const r={id:e.target.dataset.id,room_live:a,room_title:i,room_icon:o};"11"==a&&(r.table_type=n.find(".row6 p.current")[0].dataset.type),qt.post(Ot.setSongFleetInfo(),r).then((e=>{0==e.error?(t.hide(),Vt("更新成功")):Vt(e.error_msg)})).catch((t=>{Vt("网络错误,请稍后再试..")}))}))}initHtml(){let t=`\n            <div id="changeSmallroom" class="changeSmallroom flex flex-ac flex-jc">\n                <div class="changeSmallroom-body">\n                    <p class="changeSmallroom-body-title">设置</p>\n                    <div class="row1 flex flex-ac">\n                        <p class="cs_common_title">房间标题</p>\n                        <input class="flex-1" placeholder="15个字以内" maxlength="15"/>\n                    </div>\n                    <div class="row2 flex">\n                        <p class="cs_common_title">房间图标</p>\n                        <div>\n                            <div style="border-radius: 4px; overflow: hidden; display: inline-block; position: relative; cursor: pointer;">\n                                <img class="select_img" src="${Rw}" style="width: 65px; height: 65px;"/>\n                                <p style="position: absolute; left: 0; bottom: 0; right: 0; background-color: rgba(0, 0, 0, 0.4); font-size: 12px; line-height: 16px; color: white; text-align: center;">替换</p>\n                                <input id="uploadImage" type="file" name=""/>\n                            </div>\n                            <p style="font-size: 12px; color: #8C8C8C; line-height: 16px;">*上传图片大小为：500*500px<br/>限500kb以下</p>\n                        </div>\n                    </div>\n                    <p class="row3 cs_common_title">选择房间类型<span></span></p>\n                    <div class="row4 flex"></div>\n                    <div class="langren_container hide">\n                        <p class="row5 cs_common_title">选择游戏人数</p>\n                        <div class="row6 flex"></div>\n                    </div>\n                    <p class="confirm">确定</p>\n                </div>\n            </div>\n        `;window.$("body").append(t)}initStyle(){if(this.styleLoaded)return;this.styleLoaded=!0;window.$("head").append("\n            <style>\n                .changeSmallroom {\n                    position: fixed;\n                    left: 0;\n                    top: 0;\n                    right: 0;\n                    bottom: 0;\n                    background-color: rgba(0, 0, 0, 0.5);\n                    z-index: 10020;\n                }\n\n                .changeSmallroom-body {\n                    width: 276px;\n                    background: #FFFFFF;\n                    border-radius: 10px;\n                    padding: 17px 20px 15px 20px;\n                }\n\n                .changeSmallroom-body .cs_common_title {\n                    font-size: 15px;\n                    font-weight: 400;\n                    color: #333333;\n                    line-height: 21px;\n                    margin-right: 11.5px;\n                }\n\n                .changeSmallroom-body .cs_common_title span {\n                    font-size: 12px;\n                    font-weight: 400;\n                    color: #999999;\n                    line-height: 16.5px;\n                }\n\n                .changeSmallroom-body-title {\n                    font-size: 17px;\n                    font-weight: 500;\n                    color: #333333;\n                    line-height: 21px;\n                    text-align: center;\n                }\n\n                .changeSmallroom-body .row1 {\n                    margin-top: 17px;\n                }\n                .changeSmallroom-body .row1 input {\n                    width: 164px;\n                    height: 30px;\n                    background: #F8F8F8;\n                    border-radius: 5px;\n                    border: none;\n                    padding-left: 10px;\n                }\n\n                .changeSmallroom-body .row2, .changeSmallroom-body .row3, .changeSmallroom-body .row4, .changeSmallroom-body .row5, .changeSmallroom-body .row6 {\n                    margin-top: 15px;\n                }\n\n                .changeSmallroom-body .row2 #uploadImage {\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    width: 100%;\n                    height: 100%;\n                    opacity: 0;\n                    cursor: pointer;\n                }\n\n                .changeSmallroom-body .row4, .changeSmallroom-body .row6 {\n                    flex-wrap: wrap;\n                }\n                .changeSmallroom-body .row4 p, .changeSmallroom-body .row6 p {\n                    padding: 0 11px;\n                    line-height: 25px;\n                    border-radius: 25px;\n                    border: 1px solid #EFEFEF;\n                    font-size: 12px;\n                    color: #999999;\n                    margin-right: 10px;\n                    cursor: pointer;\n                    flex-shrink: 0;\n                    margin-bottom: 10px;\n                }\n                .changeSmallroom-body .row4 p.current, .changeSmallroom-body .row6 p.current {\n                    background: rgba(255, 102, 145, 0.1);\n                    border: 1px solid rgba(255, 102, 145, 0.4);\n                    color: #FF6691;\n                }\n\n                .changeSmallroom-body .confirm {\n                    margin: auto;\n                    margin-top: 18px;\n                    width: 162px;\n                    line-height: 40px;\n                    background: #FF6691;\n                    border-radius: 40px;\n                    font-size: 16px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    text-align: center;\n                    cursor: pointer;\n                }\n            </style>\n        ")}}class Aw{constructor(){this.recordTimer=null,this.mediaRecorder=null,this.ossClient=null,this.isRecord=!1}static getInstance(){return this.instance||(this.instance=new Aw,this.instance.onEventListener()),this.instance}onReset(){this.isRecord=!1,this.recordTimer&&(clearTimeout(this.recordTimer),this.recordTimer=null)}async initOssClient(){if(!this.ossClient){await Ct.loadScript("https://asset1.tuwan.com/officialsite/script/aliyun-oss-sdk-6.0.1.js");const t=(await qt.get("https://u."+window.MAIN_DOMAIN+"/Oss/sts")).data;if(null!=t){const{AccessKeyId:e,AccessKeySecret:n,SecurityToken:i}=t;this.ossClient=new window.OSS({endpoint:"oss-cn-qingdao.aliyuncs.com",accessKeyId:e,accessKeySecret:n,bucket:"tuwanpicshare",stsToken:i,secure:!0})}}}update(){this.onCheckClockInHandle(),uu.isLangrenSmallRoom()||null!=uu.getAnchorKengUser(uu.getMeid())||this.onLevelSeatRecordUpload()}onLevelSeatRecordUpload(){this.isRecord&&null!=this.mediaRecorder&&(this.mediaRecorder.stop(),clearTimeout(this.recordTimer),this.recordTimer=null)}onCheckClockInHandle(){const t=uu.getAnchorKengUser(uu.getMeid());uu.isLangrenSmallRoom()||null!=t&&(uu.isSongTempRoom()&&1==t.live_rec||uu.isTruthSmallRoom()||uu.isNewDrawTempRoom()||uu.isKtvSmallRoom())?qt.get(Ot.checkClockIn(uu.getCid())).then((t=>{0==t.error||1==t.error?(window.$(".song-but-clockin").removeClass("hide"),window.$(".song-but-clockin").text("打卡")):window.$(".song-but-clockin").addClass("hide")})):(window.$(".song-but-clockin").addClass("hide"),null!=this.recordTimer&&(clearTimeout(this.recordTimer),this.recordTimer=null))}onClockIn(){const t=this;qt.get(Ot.onClockIn(uu.getCid())).then((e=>{1==e.error?(Vt(e.error_msg),t.isRecord||t.onRecordSound()):(t.isRecord=!1,Vt(e.error_msg))}))}onRecordSound(){const t=this;t.isRecord=!0,navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1}}).then((e=>{if(null!=e){t.mediaRecorder=new MediaRecorder(e);let n=[];t.mediaRecorder.ondataavailable=function(t){n.push(t.data)},t.mediaRecorder.onstop=e=>{var i=new Blob(n,{type:"audio/ogg; codecs=opus"});n=[],this.isRecord=!1,t.onPutRecordBlob(i)},t.mediaRecorder.onerror=e=>{this.isRecord=!1,Vt("打卡失败,请稍后再试！"),t.onCheckClockInHandle()},t.mediaRecorder.start(),t.recordTimer=setTimeout((()=>{t.mediaRecorder.stop(),t.recordTimer=null}),18e4)}}),(()=>{this.isRecord=!1,Vt("授权失败！"),t.onCheckClockInHandle()})):(this.isRecord=!1,Vt("您当前用的浏览器不支持录音.."),t.onCheckClockInHandle())}async onPutRecordBlob(t){await Ct.loadScript("https://asset1.tuwan.com/officialsite/script/aliyun-oss-sdk-6.0.1.js");const e=this;let n=new FileReader;n.readAsArrayBuffer(t),n.onload=function(t){let n=new window.OSS.Buffer(t.target.result);e.putObject(n,"musicRoomRecord/"+uu.getMeid()+"_"+(new Date).getTime()+".ogg")}}async putObject(t,e,n){const i=this;if(await this.initOssClient(),this.ossClient){let n=await this.ossClient.put(e,t);qt.get(Ot.uploadSongRecord(uu.getCid(),"https://dynamics-share.tuwan.com/"+n.name)).then((t=>{0==t.error||Vt(t.error_msg),i.onCheckClockInHandle()}))}}onEventListener(){const t=this;window.$(".chat-center-main").on("click",".song-but-clockin",(function(e){t.onClockIn()}))}}function Pw(t){let e=this;const n=t.id;let i=document.getElementById(n),o=!0,s=0,a=0,r=!1;i.onmousedown=function(t){s=(new Date).getTime();let n=t.clientX-i.offsetLeft,o=t.clientY-i.offsetTop,a=i.offsetWidth,c=i.offsetHeight;return document.onmousemove=function(t){r||(r=!0,requestAnimationFrame((()=>{i.direction="",i.style.transition="",i.style.left=t.clientX-n+"px",i.style.top=t.clientY-o+"px",i.style.right="unset",t.clientX-n<5&&(i.direction="left"),t.clientY-o<5&&(i.direction="top"),t.clientX-n>document.body.offsetWidth-a-5&&(i.direction="right"),t.clientY-o>document.body.offsetHeight-c-5&&(i.direction="bottom"),e._move(i),r=!1})))},!1},i.onmouseover=function(){e._move(this)},i.onmouseout=function(){e._move(this)},i.onmouseup=function(){document.onmousemove=null,a=(new Date).getTime(),o=!(a-s<300),e._move(this)},i.addEventListener("click",(function(t){o&&(t.stopPropagation(),o=!0)}),!0)}Pw.prototype={_move:function(t){"left"===t.direction?t.style.left="0px":"right"===t.direction&&(t.style.left=document.body.offsetWidth-t.offsetWidth+"px"),"top"===t.direction?t.style.top="0px":"bottom"===t.direction&&(t.style.top=document.body.offsetHeight-t.offsetHeight+"px")}};const jw="ddkaihei",Dw=`${At}/chatroom/getSaibaoGameStatus`,Lw=`${Pt}/saibao/unbind`,Ew=`${Pt}/saibao/checkUserBind`,Bw=`${Pt}/saibao/getExplatSecret`;let Fw,Uw,zw;const Ow=t=>new Promise((e=>setTimeout((()=>e()),t)));class Nw{constructor(){this.team_stage=1}static getInstance(){return this.instance||(this.instance=new Nw),this.instance}async loadRoomStage(t){var e,n,i;if(uu.isKingTeamRoom())if(Fw&&Ct.destroyIframe(Fw),this.team_stage=t.team_stage,1===t.team_stage){const t=await qt.get(`${Dw}?format=jsonp&cid=${uu.getCid()}`);if(Uw=(null==(e=t.data)?void 0:e.saibaoMatchId)||"",zw=null==(n=t.data)?void 0:n.limit_team,Uw)return ci.show(-9,{},"房间"),void setTimeout((()=>this.openSmobaRoom()),200);(null==(i=(await this.checkBind()).data)?void 0:i.is_bind)?ci.show(-9,{},"换绑"):ci.show(-9,{},"绑定")}else ci.show(-9,{},"换绑")}subscribe(t){uu.isKingTeamRoom()&&33===t.typeid&&(141!==t.type||console.log("msg.data.saibaoMatchId===",t.data.saibaoMatchId))}handleAction(){const t=ci.getNumButton(-9).text();"绑定"===t?this.requestBind():"换绑"===t?this.unBind().then((()=>this.requestBind())):this.openSmobaRoom()}checkBind(){return qt.get(`${Ew}?open_id=${uu.getMeid()}&plat_id=${jw}&format=jsonp`)}async checkBindStatus(t){var e;let n=0;for(;;){if(await Ow(3e3),!document.getElementById(t))return;n++;if(null==(e=(await this.checkBind()).data)?void 0:e.is_bind)return ci.show(-9,{},"换绑"),Ct.destroyIframe(t),!0;if(n>120)return Vt("操作超时，请重新开始绑定"),void Ct.destroyIframe(t)}}async unBind(){var t;const e=await qt.get(`${Bw}?format=jsonp`);if(0!==e.error)return void Vt(e.error_msg);const n={app_name:"wzry",mini_program_band:0,extplat_plat:jw,extplat_type:"bindcode",extplat_extra:"pc",extplat_data:null==(t=e.data)?void 0:t.extplatData},i=Object.keys(n).map((t=>`${t}=${n[t]}`)).join("&");return qt.get(`${Lw}?${i}&format=jsonp`)}async openSmobaRoom(){var t;const e=await qt.get(`${Bw}?format=jsonp`);if(0!==e.error)return void Vt(e.error_msg);const n=uu.getAnchorKengUser(uu.getMeid());let i=n.position>9?n.position-9:n.position-1;const o={app_name:"wzry",mini_program_band:0,extplat_plat:jw,extplat_type:"bindcode",extplat_extra:"pc",extplat_data:null==(t=e.data)?void 0:t.extplatData,seat_id:i,limit_team:zw,disable_seat:1,hide_share:1,hide_qrcode:0,disable_cancel_ready:1,auto_ready:1},s=Object.keys(o).map((t=>`${t}=${o[t]}`)).join("&"),a={url:`https://h5.nes.smoba.qq.com/pvpesport.web.user/#/room-quick/${Uw}?${s}`,iframeWidth:"375px",iframeHeight:"700px",closeIcon:"https://res.tuwan.com/templet/play/chat/v3/images/closeiconv2.png?v=1",closeTop:"10px",closeLeft:"338px"};console.log("config===",a),Fw=await Ct.createIframe(a),console.log("iframeid===",Fw)}async requestBind(){var t;const e=await qt.get(`${Bw}?format=jsonp`);if(0!==e.error)return void Vt(e.error_msg);const n={app_name:"wzry",mini_program_band:0,extplat_plat:jw,extplat_type:"bindcode",extplat_extra:"pc",extplat_data:null==(t=e.data)?void 0:t.extplatData},i={url:`https://h5.nes.smoba.qq.com/pvpesport.web.user/#/check-bind?${Object.keys(n).map((t=>`${t}=${n[t]}`)).join("&")}`,iframeWidth:"375px",iframeHeight:"700px",closeIcon:"https://res.tuwan.com/templet/play/chat/v3/images/closeiconv2.png?v=1",closeTop:"10px",closeLeft:"338px"};console.log("bindurl2===",i.url),Fw=await Ct.createIframe(i),this.checkBindStatus(Fw)}}let qw;class Gw{constructor(){}static getInstance(){return this.instance||(this.instance=new Gw),this.instance}onReset(){clearInterval(qw)}toMatch(){qt.get(Ot.ChartRoomMatch(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}countdown(){if(uu.roomInfo.team_countdown){let t=uu.roomInfo.team_countdown,e=$('.opbutton.show[data-type="pipei"]');e.html(Ct.formNumberToHourMinute(t)),clearInterval(qw),qw=setInterval((()=>{if(t<=1)return clearInterval(qw),e.html("匹配"),void(e=null);t--,e.html(Ct.formNumberToHourMinute(t))}),1e3)}}subscribe(t){t.typeid;const e=t.type;if(132!==e&&138!==e)return;t.data.cid;let n=t.data.team_stage;if(132===e){const e=t.data.cid;if(!uu.isKingTeamRoom())return void ou(e);console.log("global_team_stage=="+n),console.log(3==n),3==n?$(".peaceTeam-main-container .kingTeamVsLogoCtn").hasClass("hide")&&($(".peaceTeam-main-container .kingTeamVsLogoCtn").removeClass("hide"),$(".peaceTeam-main-container .kingTeamVsLogoCtn_static_img").addClass("hide"),setTimeout((()=>{}),0),setTimeout((()=>{Zt.getInstance().playEver(".kingTeamVsLogoCtn","https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamStartGame.svga","kingTeamVsLog")}),10),setTimeout((()=>{$(".peaceTeam-main-container .kingTeamVsLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("kingTeamVsLog")}),1600),setTimeout((()=>{ou(e)}),1700),setTimeout((()=>{n=null}),3e3)):ou(e)}else if(138===e){const e=t.cid;qt.get(Ot.PeaceTeamGetwheat(e)).then((t=>{let e=t.data.list||[],i=t.data.team_stage,o=t.data.team_countdown,s=t.data.list[0].is_pre,a=e[0].is_pre,r=0,c=e.length;if(n=i,e.forEach((t=>{1==t.is_pre&&r++})),o){let t=$(".peaceTeamMatchBottomCtn .timerCtn"),e=o||0;qw&&(clearInterval(qw),qw="");let n=$(".peaceTeam-main-container .kingTeamVsLogoCtn_static_img");qw=setInterval((()=>{if(e<=0)return clearInterval(qw),qw="",n.addClass("hide"),void t.html("");e--,r>=uu.getRoomInfo().min_member&&10==e&&n.removeClass("hide"),1==s&&e<=120&&$(".peaceTeam-main-container .pt_centerCtn").hasClass("white")&&($(".peaceTeam-main-container .pt_centerCtn").removeClass("white"),$(".peaceTeam-main-container .pt_centerCtn .timeSum").html("比赛倒计时：")),e>=0&&e<10&&n.html(`比赛倒计时 ${e}s`),t.html(Ct.formNumberToHourMinute(e))}),1e3)}3==i&&t.data.list[0].data[0].uid==uu.getMeid()&&$('.opbutton[data-type="matchCodeImg"]').trigger("click"),1==i&&ci.hide(-6),window.$(".peaceTeam-main-container .onlyPositinCtn").html(Fi.onlyPositionInitPeaceTeamVsTempSeats(t.data)),setTimeout((()=>{setTimeout((()=>{Fi.showPeaceTeamPositionFn(t.data),uu.anchorUsers.clear(),uu.setAnchorsMap(t.data.list[0].data),uw()}),50)}),50),window.$(".peaceTeamMatchBottomCtn .pt_leftCtn").html(`队伍：${c}支`),window.$(".peaceTeamMatchBottomCtn .subReadyNumsCtn").html(r),1==a?(window.$(".peaceTeamMatchBottomCtn .rightBtn").removeClass("readyStatusBtn"),window.$(".peaceTeamMatchBottomCtn .rightBtn").addClass("opt5")):(window.$(".peaceTeamMatchBottomCtn .rightBtn").removeClass("opt5"),window.$(".peaceTeamMatchBottomCtn .rightBtn").addClass("readyStatusBtn")),e[0].data[0].uid==uu.getMeid()?window.$(".peaceTeamMatchBottomCtn .flagCtn").removeClass("hide"):(window.$(".peaceTeamMatchBottomCtn .altCtn").removeClass("hide"),window.$(".peaceTeamMatchBottomCtn .pt_centerCtn").addClass("white"))}))}}loadRoomStage(t){const e=t,n=t.team_stage,i=t.img_wheat_pc,o=t.skin_active?iw:t.skin;t.uid;let s=t.team_countdown;Zt.getInstance().clearPlayer("kingTeamVsLog"),Zt.getInstance().preload("https://asset.tuwan.com/chartRoom/kingTeam/matchSucess2.svga"),Nw.getInstance().loadRoomStage(e),$(".troom5v5-container .kingTeamVsLogoCtn").addClass("hide"),1==n?(window.$(".room-seats-main").html(Fi.init1vs7TempSeats(e)),window.$(".room-seats-main").css("background","none"),""!=o&&o!=iw?window.$(".chat-center-left").css({background:"url("+o+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=i&&window.$(".troom1v7-container").css({background:"url("+i+") no-repeat","background-size":"cover"})):(ci.hide(-5),setTimeout((()=>{if(qw&&clearInterval(qw),2==n?setTimeout((()=>{$(".troom5v5-container .kingTeamWaitToStartTimerCtn").removeClass("hide"),$(".troom5v5-container .kingTeamWaitToStartTimerCtnFlexCtn").addClass("hide")}),1e3):3==n&&(setTimeout((()=>{$(".troom5v5-container .kingTeamWaitToStartTimerCtn").addClass("hide"),$('.seat-item[data-aposition="2"]').attr("data-uid")==uu.getMeid()||$('.seat-item[data-aposition="10"]').attr("data-uid")==uu.getMeid()?$(".troom5v5-container .kingTeamWaitToStartTimerCtnFlexCtn").removeClass("hide"):($(".troom5v5-container .kingTeamWaitToStartTimerCtnFlexCtn").removeClass("hide"),$(".kingTeamWaitToStartTimerCtnFlexCtn .leaveBtn").hide(),$(".kingTeamWaitToStartTimerCtnFlexCtn .title").hide()),$(".troom5v5-container .kingTeamVsLogoCtn").removeClass("hide")}),1e3),setTimeout((()=>{Zt.getInstance().playEver(".kingTeamVsLogoCtn","https://asset.tuwan.com/chartRoom/kingTeam/matchSucess2.svga","kingTeamVsLog")}),1010),setTimeout((()=>{$(".troom5v5-container .kingTeamVsLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("kingTeamVsLog")}),2510)),s){let t;t=16==uu.getRoomInfo().live?$(".peaceTeamMatchBottomCtn .timerCtn"):2==n?$(".kingTeamWaitToStartTimerCtn .timerCtn"):$(".kingTeamWaitToStartTimerCtnFlexCtn .timerCtn");let e=s||0;qw=setInterval((()=>{if(e<=0)return clearInterval(qw),void t.html("");e--,t.html(Ct.formNumberToHourMinute(e))}),1e3)}}),10),window.$(".room-seats-main").html(Fi.initKingTeamVsTempSeats(e)),window.$(".room-seats-main").css("background","none"),""!=o&&o!=iw?window.$(".chat-center-left").css({background:"url("+o+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=i&&window.$(".troom1v7-container").css({background:"url("+i+") no-repeat","background-size":"cover"}))}}class Vw{constructor(){this.htmlDom=null,this.leaveTempTeam=null}static getInstance(){return this.instance||(this.instance=new Vw),this.instance}onReset(){this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null,this.leaveTempTeam=null}initTemplate(t){this.initHtml(t)}initHtml(t){const e=uu.getCid(),n=Ct.readCookie("Tuwan_Passport"),i=uu.getSelfInfo().uid,o=uu.getSelfInfo().nickname,s=uu.getSelfInfo().avatar,a=uu.getRoomInfo().game_info.fleetid;let r="";r=It?"https://y-test.tuwan.com/spytest?cid="+e+"&roomId="+a+"&token="+n+"&game_type=4&userId="+i+"&userName="+o+"&userImg="+s:"https://y.tuwan.com/spy?cid="+e+"&roomId="+a+"&token="+n+"&game_type=4&userId="+i+"&userName="+o+"&userImg="+s,this.htmlDom=window.$(`\n            <div class="langren-small-mask">\n                <iframe async frameborder="0" scrolling="no" allowtransparency="true" src="${r}"></iframe>\n                <div class="langren-small-mask-close"></div>\n                <div style="position: absolute; left: 30px; top: 35px;">\n                    <div class="song-but song-but-setting flex flex-jc flex-ac ${uu.isRoomManage(uu.getMeid())?"":"hide"}">设置</div>\n                    <div class="song-but song-but-clockin flex flex-jc flex-ac hide">打卡</div>\n                </div>\n            </div>\n        `),window.$("body").append(this.htmlDom);const c=this;this.htmlDom.find(".langren-small-mask-close").on("click",(function(t){t.stopPropagation(),Aw.getInstance().onLevelSeatRecordUpload(),c.leaveTempTeam&&c.leaveTempTeam(uu.getMeid())}))}}class Hw{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new Hw,this.playerAli=null),this.instance}initLolMatchStart(){const t=this;qt.get(`${Pt}/Match/checkSub?cid=${uu.getCid()}`).then((e=>{if(0==e.error){const n=e.open;t.requestLiveUrl(n)}else t.requestLiveUrl(0)}))}requestLiveUrl(t){1==t?(window.$(".chat-center-match .chat-center-match-have").css("display","flex"),window.$(".chat-center-match-video-main").append('\n                <div class="lol-match-guodu" style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:538px; background:url(https://res.tuwan.com/templet/play/chat/kaihei/images/kaiheiimg.jpg) no-repeat center center;z-index:10000">\n                    <div class="lol-match-live-init" style="color:#fff; font-size:14px; border-radius:32px; border:solid 1px #fff; padding:6px 60px;">正在加载中...</div>\n                </div>\n            '),this._tempCheckLive()):(window.$(".chat-center-match .chat-center-match-have").css("display","flex"),window.$(".chat-center-match-video-main").append('\n                <div class="lol-match-guodu" style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:538px; background:url(https://res.tuwan.com/templet/play/chat/kaihei/images/kaiheiimg.jpg) no-repeat center center;z-index:10000">\n                    <div class="lol-match-live-init" style="color:#fff; font-size:14px; border-radius:32px; border:solid 1px #fff; padding:6px 60px;">暂无比赛</div>\n                </div>\n            '),this.playerAli&&this.playerAli.pause())}checkRoomState(){return new Promise(((t,e)=>{const n=uu.getRoomId();qt.get(Ot.liveRoomInfo(n)).then((n=>{0==n.Error?t(n.Data.State):e()}))}))}_tempCheckLive(){const t=this;this.checkRoomState().then((e=>{1==e&&t._playliveurl()}),(()=>{t._withoutLive()}))}_playliveurl(){const t=this,e=uu.getCid();qt.get(Ot.kaiheiLive(e)).then((e=>{if(0==e.error&&e.data&&e.data.url_fhd){const n=e.data.url_fhd;t.initPlayLive(n)}}))}_withoutLive(){window.$(".chat-center-match .chat-center-match-have").css("display","flex"),window.$(".chat-center-match-video-main").append('\n                <div class="lol-match-guodu" style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:538px; background:url(https://res.tuwan.com/templet/play/chat/kaihei/images/kaiheiimg.jpg) no-repeat center center;z-index:10000">\n                    <div class="lol-match-live-init" style="color:#fff; font-size:14px; border-radius:32px; border:solid 1px #fff; padding:6px 60px;">暂无比赛</div>\n                </div>\n            ')}checkIsOpenLive(){return new Promise(((t,e)=>{qt.get("https://tv.tuwan.com/api/onlineroom").then((n=>{const i=uu.getRoomId();n.list&&n.list.includes(1*i)?t():e()}))}))}initPlayLive(t){if(!t)return;if(this.playerAli)return void this.playerAli.replay(t);this.playerAli=new $i;const e=this.playerAli.emitter;e.on("ready",(function(t){window.$(".chat-center-match-video-main").find(".lol-match-guodu").remove(),"chrome"==Ct.is360Browser()&&window.$(".chat-center-match-video-main").append('\n            \t\t<div style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:100%; background:rgba(0,0,0,0.3); z-index:98">\n            \t\t\t<div class="lol-match-volume" style="">如果没声音，点击播放声音</div>\n            \t\t</div>\n            \t')})),e.on("play",(function(t){window.$(".chat-center-match-video-main").find(".lol-match-guodu").remove()})),e.on("error",(function(t){console.error("play-error",t);const e=t.paramData.error_code;let n="";4004==e?n="播放地址不存在, 请稍候再试":4003==e?n="地址无效, 请稍候再试":4008==e&&(n="缓冲数据超时，请点击重新播放"),window.$(".chat-center-match-video-main").append('\n\t\t\t\t<div style="position:absolute; left:0;top:0; display:flex; justify-content:center; align-items:center; width:100%;height:404px; background:url(https://res.tuwan.com/templet/play/chat/kaihei/images/kaiheiimg.jpg) no-repeat center center;z-index:10000">\n\t\t\t\t\t<div class="lol-match-replay" style="">'+(n||"点击播放")+"</div>\n\t\t\t\t</div>\n\t\t\t")})),this.playerAli.play({flvurl:t,ele:"J_prismPlayer"})}}class Ww{constructor(){this.emitter=new Ht,this.maskEle=null}init(){window.$("head").append("<style>\n                            .musiclist-mask .musiclist-mask-content{\n                                width: 775px;\n                                height: 436px;\n                                border-radius: 10px;\n                                background: #fff;\n                                padding-bottom: 20px;\n                            }\n                            .musiclist-mask .musiclist-mask-title{\n                                font-size: 24px;\n                                text-align: center;\n                                color: #333;\n                                padding:20px 0\n                                \n                            }\n                            .musiclist-mask .musiclist-mask-count{\n                                font-size: 14px;\n                                color: #999;\n                                text-align: right;\n                                border-bottom: solid 1px rgba(0, 0, 0, 0.1);\n                                padding-right: 20px;\n                                padding-bottom: 13px;\n\n                            }\n                            .musiclist-mask .musiclist-mask-count span{\n                                \n                            }\n                            .musiclist-mask .musiclist-mask-list{\n                                font-size: 14px;\n                                height: 274px;\n                                overflow-y: auto;\n                                padding:0 50px;\n                                color:#666\n                            }\n                            .musiclist-mask .musiclist-mask-list .musiclist-mask-list-item{\n                            padding:18px 0;\n                            border-bottom:solid 1px rgba(0, 0, 0, 0.1);\n                            }\n                            .musiclist-mask .musiclist-mask-list-left>div{\n                                padding:0 5px; \n                                white-space:nowrap;\n                                overflow:hidden;\n                                text-overflow: ellipsis\n                            }\n                            .musiclist-mask .musiclist-mask-list-right{\n                                width: 70px;\n                            }\n                            .musiclist-mask .musiclist-mask-list-right span{\n                                border: solid 2px #FF6691;\n                                border-radius: 28px;\n                                padding:2px 10px;\n                                cursor: pointer;\n                                color: #FF6691;\n                                position: relative;\n\n                            }\n                            .musiclist-mask .musiclist-mask-list-right .musiclist-mask-singerlist-parent{\n                                width: 124px;\n                                max-height: 160px;\n                                position: absolute;\n                                top: 20px;\n                                z-index: 1;\n                                left: 50%;\n                                transform: translateX(-50%);\n                                display:none;\n                                padding-top:10px\n                                \n                            }\n                            .musiclist-mask .musiclist-mask-list-right .musiclist-mask-singerlist{\n                                list-style: none;\n                                box-shadow: 0 0 5px #ddd;\n                                color: #666;\n                                overflow-y: auto;\n                                background: #fff;\n                                padding:5px 0;\n\n                            }\n                            .musiclist-mask .musiclist-mask-list-right .musiclist-mask-singerlist .singerlist-item{\n                            padding:5px 0;\n                            text-align: center;\n                            cursor: pointer;\n                            }\n                            .musiclist-mask .musiclist-mask-list-right .musiclist-mask-singerlist .singerlist-item:hover{\n                            color: #FF6691;\n                            }\n\n\n                            .musiclist-mask .musiclist-mask-list-right span:hover{\n                                background: #FF6691;\n                                color: #fff;\n\n                            }\n                            .musiclist-mask .musiclist-mask-list-content{\n                                box-sizing: border-box;\n                                flex:1;\n                                overflow: hidden;\n\n                            }\n                            .musiclist-mask .musiclist-mask-list-title{\n                                padding:18px 50px;\n                            }\n                        </style>"),window.$("body").append('<div class="mask musiclist-mask">\n                        <div class="flex flex-dir-col mask-content musiclist-mask-content">\n                            <p class="musiclist-mask-title">热门歌曲</p>\n                            <p class="musiclist-mask-count">共<span class="musiclist-mask-sing-count">0</span>首</p>\n                            <div class="flex flex-dir-col musiclist-mask-list-content">\n                                <div class="flex musiclist-mask-list-title">\n                                    <div class="flex-1 flex musiclist-mask-list-left">\n                                        <div class="flex-1">歌名</div>\n                                        <div class="flex-1">歌手</div>\n                                    </div>                    \n                                    <div class="musiclist-mask-list-right">\n                                        \n                                    </div>                    \n                                </div>\n                                <div style="margin:0 50px;height:1px; background:rgba(0, 0, 0, 0.1);"></div>\n\n                                <div class="flex-1 scroll musiclist-mask-list">\n                                    \n                                </div>\n\n                            </div>\n                            <div class="mask-close"></div>\n                        </div>\n                    </div>')}initEvent(){const t=this;this.maskEle.on("click",".mask-close",(function(){t.hide()})),this.maskEle.on("mouseenter",".musiclist-mask-clickmusic",(function(t){t.stopPropagation();if(this.dataset.singercount>1){window.$(this).parents(".musiclist-mask-list").find(".musiclist-mask-singerlist-parent").hide();window.$(this).parent().find(".musiclist-mask-singerlist-parent").show()}})),this.maskEle.on("mouseleave",".musiclist-mask-clickmusic",(function(t){t.stopPropagation();if(this.dataset.singercount>1){window.$(this).parent().find(".musiclist-mask-singerlist-parent").hide()}})),this.maskEle.on("click",".musiclist-mask-clickmusic",(function(e){e.stopPropagation();if(1==this.dataset.singercount){const e=this.dataset.songid,n=this.dataset.uid;t.emitter.emit("clickmusic",n,e),t.hide()}})),this.maskEle.on("click",".singerlist-item",(function(e){e.stopPropagation();const n=this.dataset.songid,i=this.dataset.uid;t.emitter.emit("clickmusic",i,n),t.hide()}))}show(t){this.maskEle||(this.init(),this.maskEle=window.$(".musiclist-mask"),this.initEvent()),this.maskEle.show(),this.getMusicList(t)}hide(){this.maskEle.hide()}getMusicList(t){qt.get(Ot.songAll(t)).then((t=>{if(0==t.error){const e=t.data.song_list;if(e.length>0){let t=[];for(let n=0;n<e.length;n++)t.push(this._getSingItemHtml(e[n]));this.maskEle.find(".musiclist-mask-list").html(t.join("")),this.maskEle.find(".musiclist-mask-sing-count").html(e.length)}else this.maskEle.find(".musiclist-mask-list").html('<div style="color:#999;text-align:center;margin-top:100px">热门歌曲准备中^_^</div>'),this.maskEle.find(".musiclist-mask-sing-count").html(0)}else Vt(t.error_msg)}))}_getSingItemHtml(t){const e=t.song_id,n=t.name,i=t.singer_list;let o=[],s=[];for(let a=0;a<i.length;a++){const t=i[a].name;o.push('<li class="singerlist-item" data-songid="'+e+'" data-uid="'+i[a].uid+'">'+t+"</li>"),s.push(t)}return'<div class="flex musiclist-mask-list-item">\n                    <div class="flex-1 flex musiclist-mask-list-left" style="overflow:hidden;">\n                        <div class="flex-1">'+n+'</div>\n                        <div class="flex-1">'+s.join("，")+'</div>\n                    </div>                    \n                    <div class="flex flex-ac flex-jc musiclist-mask-list-right">\n                        <span class="musiclist-mask-clickmusic" data-songid="'+e+'" data-uid="'+(1==i.length?i[0].uid:0)+'" data-singercount="'+i.length+'">\n                        点歌\n                        <div class="musiclist-mask-singerlist-parent">\n                        <ul class="scroll musiclist-mask-singerlist">\n                            '+o.join("")+"\n                        </ul>\n                        </div>\n                        </span>\n                        \n                    </div>\n                </div>"}}class Kw{constructor(){}static getInstance(){return this.instance||(this.instance=new Kw),this.instance}onReset(){he.setLeftSearchInputCurrentCid(!1)}checkShowSearchBar(){uu.isAnchor(uu.getMeid())?qt.get(Ot.getCanSearchCidList()).then((t=>{(t.data.list||[]).findIndex((t=>t==uu.getCid()))>=0?he.setLeftSearchInputCurrentCid(!0):he.setLeftSearchInputCurrentCid(!1)})):he.setLeftSearchInputCurrentCid(!1)}}class Yw{constructor(t,e){this.instance=null,this.buildTypeInfos=null,this.roomInfo=null,this.chooseRoom=null,this.goTuwanGame=e,this.pay=t}static getInstance(t,e){return this.instance||(this.instance=new Yw(t,e)),this.instance}initTemplate(){0==window.$(".create_self_room_mask_new").length?(this.initCss(),this.initHtml()):this.initModalData()}initCss(){window.$("head").append("<style>\n                        .self_flex_c{\n                            display:flex;\n                            align-items:center;\n                            justify-content:center;\n                        }\n\n                        .create_self_room_mask_new{\n                            display:none;\n                            justify-content:center;\n                            align-items:center;\n                            width: 100%;\n                            height: 100%;\n                            background: rgba(0, 0, 0, 0.6);\n                            top: 0;\n                            left: 0;\n                            z-index: 2000;\n                            position: fixed;\n                        }\n\n                        .create_self_room_common_content_new{\n                            display:block;\n                            position: relative;\n                            width: 300px;\n                            background: #fff;\n                            border-radius: 10px;\n                            padding: 0 32px;\n                            padding-bottom: 10px;\n                        }\n\n                        .create_self_room_close_new{\n                            position: absolute;\n                            width: 40px;\n                            height: 40px;\n                            background: url(https://res.tuwan.com/templet/play/chat/images/carautocloseicon.png) no-repeat center center;\n                            right: 0;\n                            top: 0;\n                            cursor: pointer;\n                        }\n\n                        .self_room_title_new{\n                            font-size: 22px;\n                            color: #333;\n                            text-align: center;\n                            padding: 20px 0;\n                        }\n\n                        .self_room_type_list_new{\n                            margin-bottom:20px;\n                        }\n\n                        .luxury_room_rule {\n                            position: absolute;\n                            right: -20px;\n                            top: 4px;\n                            width: 24px;\n                            height: 24px;\n                            cursor: pointer;\n                        }\n\n                        .self_room_type_item_new{\n                            width:130px;\n                            height:30px;\n                            border-radius:5px;\n                            border:1px solid #ccc;\n                            background:#fff;\n                            color:#999;\n                            font-size:16px;\n                            text-align:center;\n                            line-height:30px;\n                            margin:0 10px;\n                            cursor: pointer;\n                        }\n\n                        .self_room_type_item_new.actived{\n                            border:1px solid #f66692;\n                            color:#f66692;\n                        }\n\n                        .choose_self_room_type_btn_new, .create_self_room_type_btn_new{\n                            width: 200px;\n                            height: 40px;\n                            background: #ff5588;\n                            border-radius: 8px;\n                            color: #fff;\n                            font-size: 18px;\n                            cursor: pointer;\n                            text-align:center;\n                            line-height:40px;\n                            margin:20px auto 4px;\n                        }\n\n                        .choose_self_room_type_desc_new {\n                            margin-top: 20px;\n                        }\n                        .choose_self_room_type_desc_new p{\n                            font-size:14px;\n                            color:#999;\n                            text-align:center\n                        }\n                        .choose_self_room_type_desc_new img{\n                            width: 22px;\n                            height: 22px;\n                            margin-right: 4px;\n                        }\n\n                        .create_input_content_new {\n                            position: relative;\n                            display: flex;\n                            align-items: center;\n                            margin-bottom: 20px;\n                            color:#999\n                        }\n\n                        .create_common_input_new{\n                            width: 210px;\n                            height: 40px;\n                            line-height: 40px;\n                            background-color: #f4f4f6;\n                            border-radius: 5px;\n                            border: none;\n                            outline: none;\n                            margin-left: 20px;\n                            font-size: 14px;\n                            color: #999;\n                            padding-left: 10px;\n                            box-sizing:border-box;\n                        }\n\n                        .create_self_room_mask_new .room_bg_content_new .room_bg_item img {\n                            border-radius: 10px;\n                            overflow: hidden;\n                        }\n                        .create_self_room_mask_new .room_bg_content_new .room_bg_item.selected img {\n                            border:1px solid #f66692;\n                        }\n                    }\n                    $('.').html(roomBgHtml)\n\n                    </style>")}initHtml(){window.$("body").append('<div class="create_self_room_mask_new">\n                        <div class="create_self_room_content create_self_room_common_content_new">\n                            <div class="create_self_room_close_new" data-type="1"></div>\n                            <div class="create_self_room_title self_room_title_new">创建房间</div>\n                            <div class="self_room_type_row" style="position: relative;">\n                                <div class="self_room_type_list_new self_flex_c"></div>\n                                <img class="luxury_room_rule" src="https://asset.tuwan.com/chatroom/images/learnMore_2x.png"/>\n                            </div>\n                            <div class="create_input_content_new">\n                                房间名称:<input class="wolf_room_name create_common_input_new" type="text" maxlength="13">\n                            </div>\n  \n                            <div class="create_input_content_new">\n                                <span>游戏类型:</span>\n                                <select class="wolf_game_select_type create_common_input_new" autocomplete="off"></select>\n                            </div>\n                            <div class="create_input_content_new">\n                                <span>场景主题</span>\n                            </div>\n                            <div class="room_bg_content_new scroll-horizontal flex" style="overflow-x: scroll;"></div>\n                            <div class="choose_self_room_type_desc_new flex flex-ac flex-jc">\n                                <img src=""/>\n                                <p></p>\n                            </div>\n                            <div class="create_self_room_type_btn_new">创建</div>\n                        </div>\n                    </div>'),this.initEvent(),this.initModalData()}isRealKiller(){return 15==uu.getRoomInfo().gameid}initModalData(){function t(t,e){return t.data.data[e].data[0]}function e(e,n){return t(e,n).buildTypeInfos}function n(e,n){return t(e,n).roomInfo.roomTypes}function i(e,n){return t(e,n).gameType}qt.get(this.isRealKiller()?Ot.getCreateSelfWolfRoomInfo():Ot.getCreateSpyRoomInfoV2(uu.getCid()),this.isRealKiller()?"json":void 0).then((t=>{if(0==t.code||0==t.error){const o=this.isRealKiller()?t.data:{buildTypeInfos:[l(c({},e(t,0)),{roomTypes:n(t,0),gameType:i(t,0)}),l(c({},e(t,1)),{roomTypes:n(t,1),gameType:i(t,1)})],roomInfo:t.data.data[0].data[0].roomInfo},{buildTypeInfos:s,roomInfo:a}=o;this.buildTypeInfos=s,this.roomInfo=a,window.$(".create_self_room_mask_new").css("display","flex");let r="";for(let t=0,e=s.length;t<e;t++){const e=s[t];r+=`<div class="self_room_type_item_new ${0==t?"actived":""}" data-type="${e.typeId}">${e.typeName}</div>`}window.$(".self_room_type_list_new").html(r),this.chooseRoom=s[0],this.updateChooseRoomInfo()}else Vt(t.message)}))}updateChooseRoomInfo(){const t=this;window.$(".create_self_room_content").show(),window.$(".wolf_room_name").val(t.roomInfo.roomName);let e=t.chooseRoom.roomTypes,n="";for(let s=0,a=e.length;s<a;s++){const t=e[s];n+=`<option value='${t.id}'>${t.name}</option>`}window.$(".wolf_game_select_type").html(n);-1===t.chooseRoom.imageAttachments.findIndex((e=>e.id==t.roomInfo.roomBgImg))&&(t.roomInfo.roomBgImg=t.chooseRoom.imageAttachments[0].id);let i="";for(let s=0,a=t.chooseRoom.imageAttachments.length;s<a;s++){const e=t.chooseRoom.imageAttachments[s];i+=`<div class="room_bg_item ${e.id==t.roomInfo.roomBgImg?"selected":""}" style="margin-right: 10px;" data-id="${e.id}">\n                                <img src="${e.fileName}" style="width: 100px; height: 217px;">\n                                <div class="room_bg_select_doit"></div>\n                            </div>`}window.$(".room_bg_content_new").html(i);const o=this.isRealKiller()?t.chooseRoom.costInfo:[t.chooseRoom.costInfo];3==t.chooseRoom.typeId||2==t.chooseRoom.typeId?(window.$(".choose_self_room_type_desc_new img").attr("src","https://asset.tuwan.com/chatroom/game/diamond.png"),window.$(".choose_self_room_type_desc_new p").html(o[0].costNum)):(window.$(".choose_self_room_type_desc_new img").attr("src",this.isRealKiller()?"https://asset.tuwan.com/chatroom/game/gold.png":"https://asset.tuwan.com/chatroom/images/icon_leyuansha_gold.png"),window.$(".choose_self_room_type_desc_new p").html(o[0].costNum))}initEvent(){let t=this;window.$(".create_self_room_mask_new").on("click",".create_self_room_close_new",(function(){window.$(".create_self_room_mask_new").hide()})),window.$(".create_self_room_mask_new").on("click",".self_room_type_item_new",(function(){let e=window.$(this).index();t.chooseRoom=t.buildTypeInfos[e],window.$(".self_room_type_item_new").removeClass("actived"),window.$(".self_room_type_item_new").eq(e).addClass("actived"),t.updateChooseRoomInfo()})),window.$(".create_self_room_mask_new").on("click",".create_self_room_type_btn_new",(function(){const e={buildTypeId:t.chooseRoom.typeId,roomInfo:{cid:uu.getCid(),roomName:window.$(".create_self_room_mask_new .wolf_room_name").val(),roomType:window.$(".create_self_room_mask_new .wolf_game_select_type").val(),roomBgImg:window.$(".create_self_room_mask_new .room_bg_content_new .room_bg_item.selected").data("id")}};t.isRealKiller()||(e.roomInfo.gameType=t.chooseRoom.gameType),qt.post(t.isRealKiller()?Ot.postCreateSelfWolfRoom():Ot.postCreateSpyRoom(uu.getCid()),JSON.stringify(e),"application/json").then((e=>{if(0==e.code||0==e.error)Vt("创建成功"),window.$(".create_self_room_mask_new").hide(),t.goTuwanGame(e.data.roomId,t.isRealKiller()?"1":"2");else if(-2==e.code||-2==e.error){const n=e.data.rechargeDiamonds;t.pay.payQRCodeWithDiamond((n/10).toFixed(1),(()=>{}),(()=>'<p class="pay-title">还需要支付<span id="pay-needmoney">'+n+"</span> 钻石</p>"),(()=>""))}else e.error_msg?Vt(e.error_msg):Vt(e.message)})).catch((t=>{Vt("网络错误,请稍后再试..")}))})),window.$(".create_self_room_mask_new").on("click",".room_bg_content_new .room_bg_item",(function(){window.$(".room_bg_content_new .room_bg_item").removeClass("selected"),window.$(this).addClass("selected")})),window.$(".create_self_room_mask_new").on("click",".luxury_room_rule",(function(){ze.show({title:"豪华房说明",desc:"• 房间创建后365天有效，到期可续费。</br></br>• 贡献金币和游戏可增加房间积分，从而提升房间星级。</br></br>• 提升星级可解锁更多权益，包括任命房管、自由调整发言时长、设置进房段位、开放金币桌等。</br></br>• 房间星级可以彰显拥有者的财富和游戏水平。<br/>",infoStyle:"max-width: 400px;"})}))}}var Jw=8;function Qw(t){return function(t){for(var e="0123456789abcdef",n="",i=0;i<4*t.length;i++)n+=e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15);return n}(function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n=1732584193,i=-271733879,o=-1732584194,s=271733878,a=0;a<t.length;a+=16){var r=n,c=i,l=o,d=s;n=Zw(n,i,o,s,t[a+0],7,-680876936),s=Zw(s,n,i,o,t[a+1],12,-389564586),o=Zw(o,s,n,i,t[a+2],17,606105819),i=Zw(i,o,s,n,t[a+3],22,-1044525330),n=Zw(n,i,o,s,t[a+4],7,-176418897),s=Zw(s,n,i,o,t[a+5],12,1200080426),o=Zw(o,s,n,i,t[a+6],17,-1473231341),i=Zw(i,o,s,n,t[a+7],22,-45705983),n=Zw(n,i,o,s,t[a+8],7,1770035416),s=Zw(s,n,i,o,t[a+9],12,-1958414417),o=Zw(o,s,n,i,t[a+10],17,-42063),i=Zw(i,o,s,n,t[a+11],22,-1990404162),n=Zw(n,i,o,s,t[a+12],7,1804603682),s=Zw(s,n,i,o,t[a+13],12,-40341101),o=Zw(o,s,n,i,t[a+14],17,-1502002290),n=tv(n,i=Zw(i,o,s,n,t[a+15],22,1236535329),o,s,t[a+1],5,-165796510),s=tv(s,n,i,o,t[a+6],9,-1069501632),o=tv(o,s,n,i,t[a+11],14,643717713),i=tv(i,o,s,n,t[a+0],20,-373897302),n=tv(n,i,o,s,t[a+5],5,-701558691),s=tv(s,n,i,o,t[a+10],9,38016083),o=tv(o,s,n,i,t[a+15],14,-660478335),i=tv(i,o,s,n,t[a+4],20,-405537848),n=tv(n,i,o,s,t[a+9],5,568446438),s=tv(s,n,i,o,t[a+14],9,-1019803690),o=tv(o,s,n,i,t[a+3],14,-187363961),i=tv(i,o,s,n,t[a+8],20,1163531501),n=tv(n,i,o,s,t[a+13],5,-1444681467),s=tv(s,n,i,o,t[a+2],9,-51403784),o=tv(o,s,n,i,t[a+7],14,1735328473),n=ev(n,i=tv(i,o,s,n,t[a+12],20,-1926607734),o,s,t[a+5],4,-378558),s=ev(s,n,i,o,t[a+8],11,-2022574463),o=ev(o,s,n,i,t[a+11],16,1839030562),i=ev(i,o,s,n,t[a+14],23,-35309556),n=ev(n,i,o,s,t[a+1],4,-1530992060),s=ev(s,n,i,o,t[a+4],11,1272893353),o=ev(o,s,n,i,t[a+7],16,-155497632),i=ev(i,o,s,n,t[a+10],23,-1094730640),n=ev(n,i,o,s,t[a+13],4,681279174),s=ev(s,n,i,o,t[a+0],11,-358537222),o=ev(o,s,n,i,t[a+3],16,-722521979),i=ev(i,o,s,n,t[a+6],23,76029189),n=ev(n,i,o,s,t[a+9],4,-640364487),s=ev(s,n,i,o,t[a+12],11,-421815835),o=ev(o,s,n,i,t[a+15],16,530742520),n=nv(n,i=ev(i,o,s,n,t[a+2],23,-995338651),o,s,t[a+0],6,-198630844),s=nv(s,n,i,o,t[a+7],10,1126891415),o=nv(o,s,n,i,t[a+14],15,-1416354905),i=nv(i,o,s,n,t[a+5],21,-57434055),n=nv(n,i,o,s,t[a+12],6,1700485571),s=nv(s,n,i,o,t[a+3],10,-1894986606),o=nv(o,s,n,i,t[a+10],15,-1051523),i=nv(i,o,s,n,t[a+1],21,-2054922799),n=nv(n,i,o,s,t[a+8],6,1873313359),s=nv(s,n,i,o,t[a+15],10,-30611744),o=nv(o,s,n,i,t[a+6],15,-1560198380),i=nv(i,o,s,n,t[a+13],21,1309151649),n=nv(n,i,o,s,t[a+4],6,-145523070),s=nv(s,n,i,o,t[a+11],10,-1120210379),o=nv(o,s,n,i,t[a+2],15,718787259),i=nv(i,o,s,n,t[a+9],21,-343485551),n=iv(n,r),i=iv(i,c),o=iv(o,l),s=iv(s,d)}return Array(n,i,o,s)}(function(t){for(var e=Array(),n=(1<<Jw)-1,i=0;i<t.length*Jw;i+=Jw)e[i>>5]|=(t.charCodeAt(i/Jw)&n)<<i%32;return e}(t),t.length*Jw))}function Xw(t,e,n,i,o,s){return iv((a=iv(iv(e,t),iv(i,s)))<<(r=o)|a>>>32-r,n);var a,r}function Zw(t,e,n,i,o,s,a){return Xw(e&n|~e&i,t,e,o,s,a)}function tv(t,e,n,i,o,s,a){return Xw(e&i|n&~i,t,e,o,s,a)}function ev(t,e,n,i,o,s,a){return Xw(e^n^i,t,e,o,s,a)}function nv(t,e,n,i,o,s,a){return Xw(n^(e|~i),t,e,o,s,a)}function iv(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}class ov{constructor(){this.initStyled=!1,this.visibilitychange=this.visibilitychange.bind(this)}static getInstance(){return this.instance||(this.instance=new ov,this.instance.onEventListener()),this.instance}onReset(){window.$("#send_game_role").remove(),this.removeVisibilitychange()}show(){this.initStyle(),this.initHtml(),this.addVisibilitychange(),this.requestList()}requestList(){window.$("#send_game_role").length&&qt.get(Ot.getUserGameAllList()).then((t=>{0==t.error&&(t.data&&t.data.length?window.$("#send_game_role .send_game_scroll_list").html(t.data.map((t=>this.getItemHtml(t))).join("")):window.$("#send_game_role .send_game_scroll_list").html(this.getEmptyHtml()))}))}visibilitychange(){document.hidden||this.requestList()}addVisibilitychange(){this.removeVisibilitychange(),document.addEventListener("visibilitychange",this.visibilitychange)}removeVisibilitychange(){document.removeEventListener("visibilitychange",this.visibilitychange)}onEventListener(){window.$(document).on("click","#send_game_role",(function(t){t.stopPropagation(),window.$("#send_game_role").remove()})),window.$(document).on("click","#send_game_role .send_game_role-body",(function(t){t.stopPropagation()}));const t=Ct.preventQuickClick(500);window.$(document).on("click","#send_game_role .send_game_scroll_list .game_item .send_btn",(function(e){e.stopPropagation(),t((()=>{qt.get(Ot.sendUserGame(Qw(`${uu.getMeid()}${e.target.dataset.id}${uu.getCid()}9rPCYNACaZ3GDetaGdqsO6KZwAwYUL8W`),e.target.dataset.id,uu.getCid())).then((t=>{}))})),window.$("#send_game_role").remove()})),window.$(document).on("click","#send_game_role .send_game_scroll_list .bind_btn",(function(t){t.stopPropagation(),window.open(Mt.domain+"/home/commongames")}))}initStyle(){if(!this.initStyled){this.initStyled=!0;const t="\n                <style>\n                    .send_game_role {\n                        position: fixed;\n                        left: 0;\n                        right: 0;\n                        top: 0;\n                        bottom: 0;\n                        background-color: rgba(0, 0, 0, 0.5);\n                        z-index: 999;\n                    }\n\n                    .send_game_role-body {\n                        width: 375px;\n                        height: 307px;\n                        border-radius: 10px;\n                        padding: 10px 0;\n                        background-color: white;\n                    }\n                </style>\n            ";window.$("head").append(t)}}initHtml(){window.$("body").append('\n            <div id="send_game_role" class="send_game_role flex flex-jc flex-ac">\n                <div class="send_game_role-body flex flex-dir-col">\n                    <p style="line-height: 20px; font-size: 17px; text-align: center; font-weight: bold; color: #333333;">常玩游戏</p>\n                    <div class="send_game_scroll_list scroll flex-1" style="overflow: scroll; margin-top: 10px;">\n                    </div>\n                </div>\n            </div>\n        ')}getItemHtml(t){return`\n            <div class="game_item flex flex-ac" style="height: 68px;">\n                <img src=${t.icon} style="width: 45px; height: 45px; margin-left: 18px;"/>\n                <div style="width: 216px; margin-left: 7px;">\n                    <p style="font-size: 15px; font-weight: 500; color: #1A1A1A; line-height: 17px;">${t.title}</p>\n                    <p style="font-size: 12px; font-weight: 500; color: #999999; line-height: 17px; height: 17px; margin-top: 5px; overflow: hidden;">${t.desc}</p>\n                </div>\n                <p class="send_btn" style="margin-left: 10px; width: 59px; line-height: 30px; background: #FF6691; border-radius: 30px; border: 1px solid #FA7399; font-size: 12px; font-weight: bold; color: #FFFFFF; text-align: center; cursor: pointer;" data-id="${t.id}">发送</p>\n            </div>\n        `}getEmptyHtml(){return'\n            <div class="flex flex-dir-col flex-ac">\n                <img style="margin-left: -30px; width: 117.5px; height: 107.5px; margin-top: 50px;" src="https://res.tuwan.com/chatroom/images/send_game_empty.png"/>\n                <p style="font-size: 15px; font-weight: 500; color: #999999; line-height: 21px; margin-top: 8.5px;">暂无游戏账号，快去绑定吧</p>\n                <p class="bind_btn" style="margin-top: 15px; width: 105px; line-height: 35px; background: #FF6691; border-radius: 35px; font-size: 15px; font-weight: 500; color: #FFFFFF; text-align: center; cursor: pointer;">绑定游戏</p>\n            </div>\n        '}}class sv{constructor(){this.initStyled=!1,this.emitter=new Ht,this.init(),this.yearCelebrationObj=null}static getInstance(){return this.instance||(this.instance=new sv),this.instance}init(){this.showed=!1,this.stageData=null,this.seatsData=null,this.countdownTimer=null,this.state_2_1_isInited=!1}onReset(){this.clearCountdownTimer(),this.clearFlyTimer(),window.$(".truth-room-content").remove(),this.init(),this.yearCelebrationObj=null}initTemplate(t){this.initStyled||(this.initStyle(),this.initStyled=!0),this.showed||(this.initHtml(t),this.showed=!0),uu.isTruthSmallRoom()&&uu.isRoomManage(uu.getMeid())&&window.$(".truth-room-content .song-but-setting").removeClass("hide")}dispatchNewMsg(t){vt.provider.emit("msg",t)}async sendGift(t,e,n,i=1,o){const s=(await qt.get(Pt+`/Teacher/getGift?id=${t}`)).data;this.emitter.emit("sendGift",s,e,n,i,(t=>{}),o)}clearCountdownTimer(){this.countdownTimer&&(window.clearInterval(this.countdownTimer),this.countdownTimer=null)}clearFlyTimer(){this.flyTimer&&(window.clearInterval(this.flyTimer),this.flyTimer=null)}getEleCenter(t){const e=t.width(),n=t.height();return{x:t.offset().left+e/2,y:t.offset().top+n/2,width:e,height:n}}onFlyAnim(t,e,n){const i=this,o=[].shift.call(e);if(null!=o){const s=window.$(".seat-item-empty[data-uid="+o.dataset.uid+"]")[0];if(Zt.getInstance().playLoop({ele:window.$(o)[0],path:"https://asset.tuwan.com/chatroom/images/icon_ball.svga"}),s){const a=i.getEleCenter(window.$(s)),r=i.getEleCenter(window.$(o)),c=a.x-r.x+(s.dataset.aposition>=8?-20:20),l=a.y-r.y+3;window.$(o).snabbt({position:[c,l,0],scale:[.25,.25],duration:n.is_halfway&&n.countdown-n.wait_countdown<n.wait_countdown?0:400,start:()=>{setTimeout((()=>i.onFlyAnim(t,e,n)),200)},complete:()=>{}})}}}initHtml(t){const e=`\n            <div class="truth-room-anchor-container">\n                ${Fi._initSeatData(2,158,135,90,90,uu.isTruthSmallRoom()?"房主":"主持",!1,!1,"add")}\n                <p class="select-game-desc" style="display: none; line-height: 19px; font-size: 14px; text-align: center; color: rgba(255, 255, 255, 0.6);">请至少选择一个游戏</p>\n            </div>\n        `,n=new Array(10).fill(0).map(((t,e)=>Fi._getOtherAnchorSeatHtml({position:3+e,userinfo:null,iscar:!1,isshouhu:!1,defaultbg:"add",shouhutype:1,headsvga:"",role:"嘉宾",index:e+1||1,pwidth:80,pheight:98,width:64,height:64,isrightline:!1,isshowmeili:!1}))).map(((t,e)=>`\n            <div class="truth-content-item" data-seat="${e+3}">\n                ${t}\n            </div>\n        `));console.log("jiabinsHtml----"),console.log(n);let i=`\n            <div class="truth-room-content flex" style="justify-content: center;">\n                <div id="truth-room-svgaBg" style="position: absolute; width: 100%; height: 100%; top:0;z-index: -1"></div>\n                <div class="truth-room__wrapper flex flex-1" style="justify-content: center; margin-left: -100px;">\n                    <div class="truth-anchor__container">\n                        <div class="truth-anchor__wrapper flex">\n                            ${e}\n                        </div>\n                        <p class="end-game-btn end-game-handle common-btn" style="display: none; margin-top: 20px; margin-left: 30px;">结束游戏</p>\n                    </div>\n                    <div class="truth-content__container yearCelebrationCtnFlag flex flex-jb">\n                        ${`\n            <div class="truth-content-left">${n.slice(0,5).join("")}</div>\n        `}\n                        \n            <div id="yearCelebrationParentCtn" style="width: 750px;height: 800px;transform: scale(0.66);transform-origin: top;position: absolute;top: -10px;left: -95px; z-index:99">\n            </div>\n        \n                        ${`\n            <div class="truth-content-right">${n.slice(5,10).join("")}</div>\n        `}\n                    </div>\n                </div>\n            </div>\n        `;window.$(".room-seats-main").html(i),setTimeout((()=>{this.yearCelebrationObj||this.createInnerInstance()}),10);let o=""!=t.skin?t.skin:""!=t.skin_active?t.skin_active:"";if(""!=o)if(-1!=o.indexOf(".svga")){const t=Zt.getInstance();t.loadParser("#truth-room-svgaBg",o,0,!1).then((e=>{const{videoItem:n,player:i}=e;i.setVideoItem(n),i.startAnimation(),i.setContentMode("AspectFill"),t.playersMap.set("truth-room-svgaBg",i)}),(t=>{}))}else window.$(".truth-room-content").css("background",'rgba(0, 0, 0, 0) url("'+o+'") no-repeat scroll 50% 50% / 100% 100% padding-box border-box')}createInnerInstance(){uu.isSeventhMonth()?this.yearCelebrationObj=vt.open({},document.getElementById("yearCelebrationParentCtn")):this.yearCelebrationObj=new _t({target:$("#yearCelebrationParentCtn")[0],outerCid:uu.getCid()})}initStyle(){window.$("head").append('\n            <style>\n                /* 公共功能 */\n                .truth-room-content {\n                    position: relative;\n                    height: 540px;\n                }\n                .truth-room__wrapper {\n                    padding-top: 30px;\n                }\n                .truth-anchor__wrapper {\n                    margin-top: 130px;\n                    width: 255px;\n                }\n                .truth-content__container {\n                    width: 560px;\n                    position: relative;\n                }\n                .yearCelebrationCtnFlag .truth-content-left {\n                    position: absolute;\n                    left: 0;\n                    z-index: 100;\n                }\n                .yearCelebrationCtnFlag .truth-content-right {\n                    position: absolute;\n                    right: 0;\n                    z-index: 100;\n                }\n                .truth-content-center_stage p {\n                    position: relative;\n                    width: 84px;\n                    line-height: 30px;\n                    text-align: center;\n                    border-radius: 30px;\n                    background-color: rgba(255, 255, 255, 0.2);\n                    color: rgba(255, 255, 255, 0.6);\n                    font-size: 16px;\n                }\n                .truth-content-center_stage p:nth-child(1)::after, .truth-content-center_stage p:nth-child(2)::after {\n                    content: "";\n                    height: 6px;\n                    width: 6px;\n                    top: 10px;\n                    right: -14px;\n                    border-width: 2px 2px 0 0;\n                    border-color: rgba(255, 255, 255, 0.6);\n                    border-style: solid;\n                    transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);\n                    position: absolute;\n                }\n                .truth-content-center_stage p.current:nth-child(1)::after, .truth-content-center_stage p.current:nth-child(2)::after {\n                    border-color: white;\n                }\n                .truth-content-center_stage p.current {\n                    background-color: rgba(255, 255, 255, 0.5);\n                    color: white;\n                }\n                .truth-content-center_stage_desc {\n                    font-size: 16px;\n                    color: rgba(255, 255, 255, 0.6);\n                    text-align: center;\n                    margin-top: 15px;\n                    height: 22px;\n                }\n                .truth-content-center_game {\n                    width: 300px;\n                    height: 400px;\n                    background: #A257FF;\n                    border-radius: 10px;\n                    margin: auto;\n                    margin-top: 15px;\n                    text-align: center;\n                    border: 1px solid rgba(255, 255, 255, 0.2);\n                }\n                .truth-content-center_game .logo {\n                    margin-top: 30px;\n                    height: 39px;\n                }\n                .truth-room-content .seat-item p.seat-user-name {\n                    font-size: 12px;\n                }\n                .truth-room-content .truth-room-anchor-container .seat-item p.seat-user-name {\n                    font-size: 16px;\n                }\n\n                /* 样式覆盖 */\n                .truth-content-center_game .seat-item {\n                    height: auto;\n                }\n\n                /* 公共样式 */\n                .truth-room-content .common-btn {\n                    margin: auto;\n                    width: 100px;\n                    line-height: 35px;\n                    border-radius: 35px;\n                    color: rgba(255, 255, 255, 1);\n                    font-size: 16px;\n                    text-align: center;\n                    font-weight: bold;\n                    border: 1px solid #F3A4C0;\n                    cursor: pointer;\n                    background: linear-gradient(to bottom,#FB789D, #E85B83);\n                    cursor: pointer;\n                    user-select: none;\n                }\n                .truth-room-content .common-btn.disable {\n                    opacity: 0.6;\n                }\n                .truth-room-content .common-btn.blue {\n                    background: linear-gradient(to bottom,#6676FF, #4B32DF);\n                    border: 1px solid #939DFE;\n                }\n                .truth-content-center_game .body .common-title {\n                    margin-top: 8px;\n                    font-size: 18px;\n                    color: #FFFFFF;\n                    font-weight: bold;\n                    line-height: 24px;\n                }\n                .truth-content-center_game .body .common-desc {\n                    margin-top: 18px;\n                    font-size: 12px;\n                    color: rgba(255, 255, 255, 0.6);\n                    line-height: 16px;\n                }\n                .truth-content-center_game .body .singleLogo {\n                    width: 167px;\n                    height: 167px;\n                    margin-top: 16px;\n                }\n\n                /* 准备阶段 */\n                .truth-content-center_game .body .prepare {\n                    width: 260px;\n                    margin: auto;\n                }\n                .truth-content-center_game .body .prepare .gameLogo {\n                    width: 90px;\n                    height: 90px;\n                    margin-top: 30px;\n                    cursor: pointer;\n                }\n                .truth-content-center_game .body .prepare .gameLogo:nth-child(odd) {\n                    margin-right: 36px;\n                }\n                .truth-content-center_game .body .prepare .prepareBtn {\n                    margin-top: 21px;\n                }\n\n                /* 抢红包游戏 */\n                .truth-content-center_game .body .rob-red-package .countdown {\n                    margin-top: 2px;\n                    font-size: 50px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    line-height: 66px;\n                }\n                .truth-content-center_game .body .rob-red-package .desc {\n                    margin-top: 12px;\n                    font-size: 18px;\n                    color: rgba(255, 255, 255, 0.8);\n                    line-height: 22px;\n                }\n\n                /* 比大小游戏 */\n                .truth-content-center_game .body .compare_number p {\n                    color: white;\n                }\n\n                /* 猜成语游戏 */\n                .truth-content-center_game .body .guess-string {\n                    width: 200px;\n                    margin: auto;\n                }\n                .truth-content-center_game .body .guess-string p {\n                    color: white;\n                }\n\n                /* 被惩罚人公布的样式展示 */\n                .truth-content-center_game .body .punished-publish .seat-item {\n                    margin-top: 30px;\n                }\n                .truth-content-center_game .body .punished-publish .desc {\n                    margin-top: 28px;\n                    line-height: 20px;\n                    font-size: 14px;\n                    color: rgba(255, 255, 255, 0.6);\n                }\n                .truth-content-center_game .body .punished-publish .desc span {\n                    color: rgba(255, 255, 255);\n                }\n                .truth-content-center_game .body .punished-publish .countdown {\n                    margin-top: 29px;\n                    font-size: 50px;\n                    font-weight: bold;\n                    color: #FFFFFF;\n                    line-height: 66px;\n                }\n\n                /* 抢惩罚位置 */\n                .truth-content-center_game .body .rob-punished .fail {\n                    margin-top: 30px;\n                }\n                .truth-content-center_game .body .rob-punished .users {\n                    margin-top: 10px;\n                    width: 266px;\n                }\n                .truth-content-center_game .body .rob-punished .countdown {\n                    position: absolute;\n                    top: 8px;\n                    right: -50px;\n                    width: 50px;\n                    text-align: right;\n                    font-size: 18px;\n                    color: #FFFFFF;\n                    font-weight: bold;\n                }\n                .truth-room-content .rob-punished .seat-item p.seat-user-name {\n                    font-size: 14px;\n                }\n\n                /* 问答环节 */\n                .truth-room-content .punisher-ask .seat-item p.seat-user-name {\n                    font-size: 14px;\n                }\n    \t\t</style>\n        ')}}class av{constructor(){this.instance=null,this.avatar=[],this.timer=null,this.zindex=100}static getInstance(){return this.instance||(this.instance=new av),this.instance}initTemplate(){0==window.$(".user-watch-wrapper").children().length&&window.$(".user-watch-wrapper").html('\n           <div class="user-watch-wrapper-container" data-move="0">\n                <div class="user-watch-avatar-first">\n                    <div class="user-watch-avatar-mime-item hide"></div>\n                </div>\n                <div class="user-watch-avatar-context flex" data-move="8">\n                </div>\n           </div>')}getOnlineUser(t){const e=this;e.avatar=[],e.avatar.map(((n,i)=>{null==t.find((t=>null!=t&&null!=n&&t.uid==n.uid))&&(e.avatar[i]=null)})),t.map((t=>{null==e.avatar.find((e=>null!=e&&e.uid==t.uid))&&t.uid!=uu.getMeid()&&this.avatar.push(t)})),t.find((t=>t.uid==uu.getMeid()))||(this.avatar[0]=null),window.$(".user-watch-avatar-mime-item").empty(),window.$(".user-watch-avatar-mime-item").addClass("hide");const n=e.avatar.filter((t=>null!=t));if(n.length<4){let i="";0!=t.length&&(i=t.find((t=>t.uid==uu.getMeid()))?t.find((t=>t.uid==uu.getMeid())).avatar:t[0].avatar),""!=i&&(window.$(".user-watch-avatar-mime-item").removeClass("hide"),window.$(".user-watch-avatar-mime-item").html('<img src="'+i+'"/>')),window.$(".user-watch-avatar-context").empty(),window.$(".user-watch-wrapper-container").attr("data-move",1),window.$(".user-watch-avatar-context").css("left","24px"),e.timer&&(clearInterval(e.timer),e.timer=null),n.map((t=>{0==window.$(".watch-avatar-item[data-uid="+t.uid+"]").length&&(window.$(".user-watch-avatar-context").children().length>3&&window.$(".user-watch-avatar-context").children().last().remove(),window.$(".user-watch-avatar-context").prepend("<div data-src='"+t.avatar+"' data-zindex='"+e.zindex+"' data-uid='"+t.uid+'\' class="user-watch-avatar-item" style="z-index: '+e.zindex+'"><img src="'+t.avatar+'"/></div>'),e.zindex++)}))}else{window.$(".user-watch-avatar-context").css("left","-8px"),window.$(".user-watch-wrapper-container").attr("data-move",0),window.$(".user-watch-avatar-mime-item").removeClass("hide");let i="";i=t.find((t=>t.uid==uu.getMeid()))?t.find((t=>t.uid==uu.getMeid())).avatar:t[0].avatar,window.$(".user-watch-avatar-mime-item").html('<img src="'+i+'"/>'),null==e.timer&&(e.timer=setInterval((()=>{if(window.$(".user-watch-avatar-context").children().length<4){const t=5-window.$(".user-watch-avatar-context").children().length;for(let i=0;i<t;i++){let t=-1,i=!1;if(null!=window.$(".user-watch-avatar-item")[0]){const e=window.$(".user-watch-avatar-item")[0].dataset.uid;n.forEach(((n,o)=>{i&&(t=o,i=!1),n.uid==e&&(i=!0)}))}-1==t&&(t=0);const o=n[t];window.$(".user-watch-avatar-context").prepend("<div data-zindex='"+this.zindex+"' data-uid='"+o.uid+"' data-src='"+o.avatar+'\' class="user-watch-avatar-item" style="z-index: '+e.zindex+'"><img src="'+o.avatar+'"/></div>'),e.zindex++}}else{const t=window.$(".user-watch-avatar-item")[0].dataset.uid;let i=-1,o=!1;n.forEach(((e,n)=>{o&&(i=n,o=!1),e.uid==t&&(o=!0)})),-1==i&&(i=0);const s=n[i];window.$(".user-watch-avatar-context").children().last().remove();const a=window.$(".user-watch-avatar-context").children();window.$(".user-watch-avatar-context").children().remove(),a.map(((t,e)=>{const n=e.dataset.uid,i=e.dataset.src,o=e.dataset.zindex;window.$(".user-watch-avatar-context").append("<div data-src='"+i+"' data-uid='"+n+"' data-zindex=\""+o+'" class="user-watch-avatar-item" style="z-index: '+o+'"><img src="'+i+'"/></div>')})),window.$(".user-watch-avatar-context").prepend("<div data-src='"+s.avatar+"' data-uid='"+s.uid+"' data-zindex=\""+e.zindex+'" class="user-watch-avatar-item" style="z-index: '+e.zindex+'"><img src="'+s.avatar+'"/></div>'),setTimeout((()=>{window.$(".user-watch-avatar-item").addClass("user-watch-transition");const t=window.$(".user-watch-avatar-context").children();window.$(".user-watch-avatar-context").children().last().addClass("user-watch-opacity"),t.map(((t,e)=>{window.$(e).css({transform:"translate(16px,0)"})}))}),100),e.zindex++}}),3e3))}}onCheck(t){this.getOnlineUser(t)}onReset(){this.timer||clearInterval(this.timer),this.timer=null,this.avatar=[]}}function rv(t,e,n){if(t)if(2==e){let t="";t=uu.isCanChoiceCreateCarTempRoom()?0==uu.roomInfo.game_type||7==uu.roomInfo.live?"关闭车队":"关闭歌房":uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype&&7!=uu.roomInfo.live?"关闭歌房":"",ci.show(1,ci.type.closeteam,t)}else uu.isLoveTempRoom()?ci.show(1,ci.type.exittempteam,"离开"):(ci.show(1,ci.type.exittempteam),(uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype||uu.isSameMusicTempRoom())&&(uu.isDrawTempRoom()||uu.isSoloTempRoom()||ci.show(3,ci.type.baodang)));else ci.show(1,ci.type.exittempteam);window.$(".seat-item-empty").removeClass("newUser"),!(uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype||uu.isSameMusicTempRoom()||uu.isShengyouFreeRoom()||uu.isKtvSmallRoom())||uu.isAdmin_spe_user(n)||uu.isAdminUids(n)||1==uu.roomInfo.is_patrol||uu.anchorUsers.has(n)||uu.isPListType2()||uu.isDrawTempRoom()||uu.isVideoTempRoom()||30==uu.roomInfo.ptype||cu(n)}let cv=!0;function lv(t){const e=window.$(".common-queuelist"),n=e.attr("data-type");if(""==n&&!uu.isTakeMeRoom()&&!uu.isMarryRoom()&&!uu.isSongPkRoom())return;let i=e.find(".channel-queuelist-content"),o=e.find(".channel-selfqueue-content"),s=uu.getAnchoringUserId(),a="";uu.getChannel();let r=uu.getMeid(),c=uu.getQueueList(),l=c.get(r),d=Array.from(c.keys()).findIndex((t=>t==r)),m=[];if(uu.isTakeMeRoom()){if(s!=r)if(d>2){let t=0;for(let[e,n]of c){if(t>=3)break;m.push("<li>\n                            "+mv(n,t,"取消",e==r,!1,"queue")+"\n                        </li>"),t++}a=mv(l,d,"",!0,!1,"queue"),o.html(a),o.css("display","flex")}else{let t=0;for(let[e,n]of c)m.push('<li class="'+(e==r?"self-queue-item":"")+'">\n                            '+mv(n,t,"取消",e==r,!1,"queue")+"\n                        </li>"),t++;o.hide()}else{let t=0;for(let[e,n]of c)m.push("<li>\n                        "+mv(n,t,"取消",e!=r,!0,"queue")+"\n                    </li>"),t++;o.hide()}window.$(".takeme-common-queuelist .channel-queuelist-content").html(m.join(""))}else if(uu.isMarryRoom()){if(s!=r){let t=0;for(let[e,n]of c)m.push('<li class="'+(e==r?"self-queue-item":"")+'">\n                        '+mv(n,t,"取消",e==r,!1,"queue")+"\n                    </li>"),t++;o.hide()}else{let t=0;for(let[e,n]of c)m.push("<li>\n                        "+mv(n,t,"取消",e!=r,!0,"queue")+"\n                    </li>"),t++;o.hide()}window.$(".marry-common-queuelist .channel-queuelist-content").html(m.join(""))}else if(uu.isJingPaiRoom()||uu.isSongPkRoom()){if(s!=r)if(d>2){let t=0;for(let[e,n]of c){if(t>=3)break;m.push("<li>\n                            "+mv(n,t,"取消",e==r,!1,"queue")+"\n                        </li>"),t++}a=mv(l,d,"取消",!0,!1,"queue"),o.html(a),o.css("display","flex")}else{let t=0;for(let[e,n]of c)m.push('<li class="'+(e==r?"self-queue-item":"")+'">\n                            '+mv(n,t,"取消",e==r,!1,"queue")+"\n                        </li>"),t++;o.hide()}else{let t=0;for(let[e,n]of c)m.push("<li>\n                        "+mv(n,t,"取消",e!=r,!0,"queue")+"\n                    </li>"),t++;o.hide()}i.html(m.join(""))}else{if("diandanself"==n)if(d>2&&!uu.isKtvRoom()){let t=0;for(let[e,n]of c)m.push("<li>\n                                    "+dv(n,t,"取消",e==r)+"\n                                </li>");a=dv(l,d,"取消",!0),o.html(a),o.css("display","flex")}else{let t=0;for(let[e,n]of c)m.push('<li class="'+(e==r?"self-queue-item":"")+'">\n                                    '+dv(n,t,"取消",e==r)+"\n                                </li>"),t++;o.hide()}else if("paidankefu"==n){let t=0;for(let[e,n]of c)m.push("<li>\n                                "+dv(n,t,"点击抱走",e!=r)+"\n                            </li>"),t++;o.hide()}i.html(m.join(""))}if(uu.isKtvRoom()&&t>0){let e=$(`<div class="buttonTipsCtn"> 当前处于队长队列第 <span>${t||0}</span> 位 </div>`);$(".captionListShowerCtn").html(e)}}function dv(t,e,n,i){let o="";const s=t.uid;return i&&(o=`<div class="channel-queuelist-item-btn queuelist-item-btn" data-uid="${s}">${n}</div>`),`<div class="channel-queuelist-rank-index">${e+1}</div>\n                    <div class="channel-queuelist-rank-info">\n                        <img class="queuelist-item-head" src="${t.avatar}">\n                        <img src="${t.vipicon}">\n                        <div class="queuelist-item-name text-over">${t.name}</div>\n                        <div class="queuelist-item-sex">${1==t.sex?"<img src='https://asset.tuwan.com/chartRoom/man_icon.png' />":"<img src='https://asset.tuwan.com/chartRoom/woman_icon.png' />"}</div>\n                    </div>\n                    `+o}function mv(t,e,n,i,o,s){let a="";const r=Object.assign(t),c=r.uid;i&&(o&&(a=`<div class="channel-queuelist-item-btn queuelist-item-btn" data-uid="${c}">上麦</div>`),a="取消"==n?`<div class="channel-queuelist-item-btn queuelist-item-btn cancle" data-uid="${c}">${n}</div>`+a:`<div class="channel-queuelist-item-btn queuelist-item-btn" data-uid="${c}">${n}</div>`+a);let l=`<img src="${r.vipicon}">`,d=` <div class="queuelist-item-sex">${1==r.sex?"<img src='https://asset.tuwan.com/chartRoom/man_icon.png' />":"<img src='https://asset.tuwan.com/chartRoom/woman_icon.png' />"}</div>`,m=` <img class="queuelist-item-head" src="${r.avatar}">`,h=`<div class="queuelist-item-name text-over">${r.name}</div>`;if(uu.isTakeMeRoom()&&"queue"==s){if(0==i&&0==o){let t="神秘人"+(e+1);m=` <img class="queuelist-item-head" src="${1==r.sex?"https://res.tuwan.com/play/img/smr1.png":"https://res.tuwan.com/play/img/smr2.png"}">`,h=`<div class="queuelist-item-name text-over">${t}</div>`,l="",d=""}}else if(uu.isSpecialTakeMeRoom()&&"order"==s&&0==i&&0==o){let t="嘉宾"+(e+1);m=` <img class="queuelist-item-head" src="${1==r.sex?"https://res.tuwan.com/play/img/smr1.png":"https://res.tuwan.com/play/img/smr2.png"}">`,h=`<div class="queuelist-item-name text-over">${t}</div>`,l="",d=""}return`<div class="channel-queuelist-rank-index">${e+1}</div>\n                    <div class="channel-queuelist-rank-info">\n                        `+m+l+h+d+"\n                    </div>\n                    "+a}function hv(t){const e=window.$(".common-orderlist");let n=e.find(".channel-queuelist-content.list1"),i=e.find(".channel-selfqueue-content"),o=uu.getAnchoringUserId(),s="",a=uu.getMeid(),r=uu.getOrderList(),c=r.get(a),l=Array.from(r.keys()).findIndex((t=>t==a)),d=[];const m="取消";if(o!=a)if(l>2&&!uu.isKtvRoom()){let t=0;for(let[e,n]of r){if(t>=3)break;d.push("<li>\n                                    "+mv(n,t,m,e==a,"order")+"\n                                </li>"),t++}s=mv(c,l,m,!0,!1,"order"),i.html(s),i.css("display","flex")}else{let t=0;for(let[e,n]of r)d.push('<li class="'+(e==a?"self-queue-item":"")+'">\n                                    '+mv(n,t,m,e==a,!1,"order")+"\n                                </li>"),t++;i.hide()}else{let t=0;for(let[e,n]of r)d.push("<li>\n                                "+mv(n,t,"取消",e!=a,!0,"order")+"\n                            </li>"),t++;i.hide()}if(uu.isTakeMeRoom()?window.$(".takeme-common-orderlist .channel-queuelist-content").html(d.join("")):uu.isMarryRoom()?window.$(".marry-common-orderlist .channel-queuelist-content").html(d.join("")):n.html(d.join("")),uu.isKtvRoom()&&t>0){let e=$(`<div class="buttonTipsCtn"> 当前处于老板队列第 <span>${t}</span> 位 </div>`);window.$(".BoseListShowerCtn").html(e)}}function uv(){const t=window.$(".common-orderlist");let e=t.find(".channel-queuelist-content.list1"),n=t.find(".channel-selfqueue-content"),i=uu.getAnchoringUserId(),o="",s=uu.getMeid(),a=uu.getOrderList(),r=a.get(s),c=Array.from(a.keys()).findIndex((t=>t==s)),l=[];const d="取消";if(i!=s)if(c>2&&!uu.isKtvRoom()){let t=0;for(let[e,n]of a){if(t>=3)break;l.push("<li>\n                                        "+mv(n,t,d,e==s,"order")+"\n                                    </li>"),t++}o=mv(r,c,d,!0,!1,"order"),n.html(o),n.css("display","flex")}else{let t=0;for(let[e,n]of a)l.push('<li class="'+(e==s?"self-queue-item":"")+'">\n                                        '+mv(n,t,d,e==s,!1,"order")+"\n                                    </li>"),t++;n.hide()}else{cv&&setTimeout((()=>{cv=!1}),10),cv||0!=$(".channel-queuelist-content.list1 li").length||0==a.size||(window.$(".new_msg_tips")[0].pause(),window.$(".new_msg_tips")[0].currentTime=0,window.$(".new_msg_tips")[0].play(),cv=!1);let t=0;for(let[e,n]of a)l.push("<li>\n                                    "+mv(n,t,"取消",e!=s,!0,"order")+"\n                                </li>"),t++;n.hide()}e.html(l.join(""))}function pv(){const t=window.$(".common-orderlist");let e=t.find(".channel-queuelist-content.list2"),n=t.find(".channel-selfqueue-content"),i=uu.getAnchoringUserId(),o="",s=uu.getMeid(),a=uu.getQueueList(),r=a.get(s),c=Array.from(a.keys()).findIndex((t=>t==s)),l=[];const d="取消";if(i!=s)if(c>2&&!uu.isKtvRoom()){let t=0;for(let[e,n]of a){if(t>=3)break;l.push("<li>\n                                        "+mv(n,t,d,e==s,"order")+"\n                                    </li>"),t++}o=mv(r,c,d,!0,!1,"order"),n.html(o),n.css("display","flex")}else{let t=0;for(let[e,n]of a)l.push('<li class="'+(e==s?"self-queue-item":"")+'">\n                                        '+mv(n,t,d,e==s,!1,"order")+"\n                                    </li>"),t++;n.hide()}else{let t=0;for(let[e,n]of a)l.push("<li>\n                                    "+mv(n,t,"取消",e!=s,!0,"order")+"\n                                </li>"),t++;n.hide()}e.html(l.join("")),uu.isAnchors2(uu.getMeid())&&$('.seat-item[data-aposition="2"]').attr("data-uid")==s&&setTimeout((()=>{let t=$(".channel-queuelist.sp .channel-queuelist-content.list1 li").length+$(".channel-queuelist.sp .channel-queuelist-content.list2 li").length;t>0&&ci.show(2,ci.type.ktvdiandannum,t+"")}),500)}function gv(t){const e=window.$(".common-orderlist");let n=0,i=uu.getOrderList();for(let[o,s]of i)if(n++,o==t)break;n?hv(n):hv(),"none"==e.css("display")?e.css("display","flex"):e.hide()}let fv=null;let wv=null;async function vv(t){wv=await Cu();const e=1*t.typeid,n=Date.now(),i=new Map([[0,_v],[1,yv],[2,xv],[3,bv],[5,$v],[6,kv],[10,Cv],[11,Iv],[12,Sv],[13,Tv],[16,Rv],[17,Mv],[18,Av],[19,Pv],[20,jv],[22,Dv],[34,Ev],[39,Bv],[40,Fv],[53,Uv],[54,zv]]).get(e);i&&i(t);const o=Date.now();o-n>10&&console.log(`newSocketMessage ${i.name} exec>10ms:`,o-n,t)}function _v(){zh(function(){let t=[];return uu.isSongTempRoom()?t=["wheatlist","getSongLrc"]:uu.isVideoTempRoom()||uu.isLiveTempRoom()?t=["wheatlist","publishList"]:uu.isKillerFreeRoom()||uu.isSpyRoom()?t=["wheatlist","fleetScoreList"]:uu.isShengyouFreeRoom()?t=["wheatlist","publishList","fleetScoreList"]:uu.isShengyouRoom()||uu.isHuodongRoom()||uu.isTempCarteamRoom()&&!uu.isDrawTempRoom()?t=["wheatlist"]:uu.isAutoRoom()?t=["wheatlist","publishList","fleetScoreList"]:uu.isKtvRoom()?t=["wheatlist"]:uu.isLOLMatchRoom()?t=["wheatlist","fleetlist"]:uu.isJiamianRoom()||uu.isHunLiRoom()?t=["wheatlist"]:uu.isGameRoom()?t=["wheatlist","fleetScoreList"]:uu.isJingPaiRoom()?t=["wheatlist","orderlist","queuelist"]:uu.isBattleRoom()?t=["wheatlist","fleetlist","publishList","fleetScoreList"]:uu.isLiveRoom()?t=["wheatlist","publishList"]:uu.isTakeMeRoom()?t=["wheatlist","publishList","orderlist","queuelist"]:uu.isDrawRoom()||uu.isDrawTempRoom()||uu.isMarryRoom()||uu.isTruthRoom()?t=["wheatlist"]:uu.isSongPkRoom()?t=["wheatlist","queuelist","getSongLrc"]:uu.isSquidGame()?t=["wheatlist","queuelist"]:uu.isH5ActiveRoom()?t=["wheatlist"]:uu.isSpyActiveRoom()?(t=["wheatlist"],uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid,passport:Ct.readCookie("Tuwan_Passport")})):uu.isCocosH5Room()?(t=["wheatlist"],_s.getInstance().sendGetSubscribeList()):(uu.isGameRace()||uu.isSpecialSongRoom()||uu.isLangrenSmallRoom())&&(t=["wheatlist"]),!uu.isShengyouFreeRoomWithPType()&&!uu.isAutoRoomWithPType()||t.includes("publishList")||t.push("publishList"),t}())}function yv(t){if(16==uu.getRoomInfo().live&&1!=uu.getRoomInfo().team_stage)return;15!=uu.roomInfo.gameid&&21!=uu.roomInfo.gameid||uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid,passport:Ct.readCookie("Tuwan_Passport")}),Uh();const e=t.data;uu.anchorUsers.clear();const n=uu.getMeid(),i=window.$(".chat-center-main");if(uu.isKtvSmallRoom())for(const r of e)1!=r.position&&r.position++;uu.isKtvSmallRoom()&&ad.getInstance().setSpecialSeats(e),uu.isSongPkRoom()||uu.isKtvSmallRoom()?function(t=[],e){for(let n of t){const t=fm.anchorSeatsHistory.find((t=>t.position==n.position&&t.uid==n.uid));if(t)Ct.diffObjectIsChanged(t,n)&&Fi.setAnchorSeat(n,uu.getMeid(),!1,!1,!1);else{Fi.setAnchorSeat(n,uu.getMeid(),!1,!1,!1);const t=fm.anchorSeatsHistory.find((t=>t.position==n.position));if(t&&t.uid!=n.uid){const e=window.$(".chat-center-main").find(".seat-item-empty[data-aposition="+t.position+"]");e.removeClass("speaking"),Ei.getInstance().removeWaveSvgaByDom(e)}}}for(let n of fm.anchorSeatsHistory)t.find((t=>t.position==n.position))||Fi.clearAnchorSeat(n.position,!1,!1,!1);uu.isSongPkRoom()&&mu.getInstance().setSeatData(t),uu.setAnchorsMap(t),fm.anchorSeatsHistory=t}(e):uu.isTruthRoom()?function(t=[],e){Fi.updateAnchorSpecialSeat(t.filter((t=>t.position<2))),t=t.filter((t=>t.position>=2)),uu.setAnchorsMap(t);const{nowMap:n,preMap:i,diffMap:o}=Ct.diffArrayForKey(fm.anchorSeatsHistory,t);if(o.size>0)for(let[s,a]of o)n.has(s)?(i.has(s)&&n.get(s).position!=i.get(s).position&&window.$(`.seat-item-empty[data-aposition=${i.get(s).position}]`).data().uid==s&&Fi.clearAnchorSeat(i.get(s).position,!1,!1,!1),Fi.setAnchorSeat(a,e,!1,!1,!1)):Fi.clearAnchorSeat(a.position,!1,!1,!1);fm.anchorSeatsHistory=t}(e,n):function(t,e){const n=uu.isHunLiRoom(),i=uu.isShengyouRoom(),o=uu.isJingPaiRoom();if(uu.setAnchorsMap(t),o){if(o){const e=fm.anchorSeatsHistory.find((t=>3==t.position)),n=t.find((t=>3==t.position));if(e&&n&&e.uid!=n.uid){const t=window.$(".chat-center-main").find(".seat-item-empty[data-aposition=3]");t.removeClass("speaking"),Ei.getInstance().removeWaveSvgaByDom(t)}}Fi.setAnchorsSeat(uu.getRoomInfo().seats,e,t)}else{const{nowMap:s,preMap:a,diffMap:r}=Ct.diffArrayForKey(fm.anchorSeatsHistory,t);if(uu.isKingTeamRoom()&&r.get(e)&&r.get(e).position&&r.get(e).position>=10)for(let[t,e]of r)e.position<10?e.position=e.position+8:e.position=e.position-8;if(r.size>0)for(let[t,c]of r)s.has(t)?((uu.isTakeMeRoom()||uu.isMarryRoom())&&a.has(t)&&s.get(t).position!=a.get(t).position&&Fi.clearAnchorSeat(a.get(t).position,i,n,o),15!=uu.roomInfo.live&&16!=uu.roomInfo.live||c.uid!=e||(2!=c.position&&10!=c.position||1!=uu.roomInfo.team_stage?ci.hide(-5):(ci.show(-5,ci.type.pipei),15==uu.roomInfo.live?Gw.getInstance().countdown():16==uu.roomInfo.live&&gw.getInstance().countdown()),2!=c.position&&10!=c.position&&(2==uu.roomInfo.team_stage&&$(".kingTeamWaitToStartTimerCtn .title").hide(),3==uu.roomInfo.team_stage&&$(".kingTeamWaitToStartTimerCtnFlexCtn .leaveBtn").hide())),Fi.setAnchorSeat(c,e,i,n,o)):(uu.isLiveRoom()&&Mi.getInstance().clearAnchorSeat(c.position),Fi.clearAnchorSeat(c.position,i,n,o))}fm.anchorSeatsHistory=t,Mi.getInstance().checkSeat(t)}(e,n),Kw.getInstance().checkShowSearchBar(),vw.getInstance().updateThresholdValidValue();const o=uu.getAnchorKengUser(n);if(o||Pd.getInstance().closeTip(),Mu.checkVisible(),uu.isLoveTempRoom()&&(e.length<2||!o))return void cu(n);if(uu.isWerewolfTeamRoom()&&e.length<2&&24!=uu.roomInfo.pgameid)return void cu(n);uu.isTruthRoom()&&Gi.getInstance().updateStatus(e||[]);const s=o?o.position:-1;if(uu.isAnchoringUser(n)||uu.isKtvSmallRoom()&&ad.getInstance().mineIsOwner()?(window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show(),uu.isHuodongRoom()?window.$(".chatroom-redjilu").css("display","block"):uu.isJingPaiRoom()&&he&&he.setLeftSearchInput(!0)):s>0&&window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+n+"']").find(".seat-close").show(),uu.isTempCarteamRoom()&&(uu.isSongTempRoom()||uu.isTruthSmallRoom()||uu.isNewDrawTempRoom()||uu.isLangrenSmallRoom()||uu.isKtvSmallRoom())&&Aw.getInstance().update(),wv.getInstance().updateSeats(),uu.isShengyouRoom()||uu.isJiamianRoom()||uu.isHunLiRoom()||uu.isKtvRoom())if(uu.isShengyouFreeRoom())uu.isAnchoringUser(n)&&(uu.isLiveRoom()?(Bh(),Mi.getInstance().showManagementBar()):Bh()),(uu.isKillerFreeRoom()||uu.isSpyRoom())&&(uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid,passport:Ct.readCookie("Tuwan_Passport")}),Zm.getInstance().onCheckGameJumpStatus());else{if(o)if((uu.isJiamianRoom()||uu.isHunLiRoom())&&ci.timing&&ci.clearTime(),uu.isKtvRoom()){const t=uu.getAnchorKengUser(n);if(uu.isAnchors2(uu.getMeid()))if(t&&$('.seat-item[data-aposition="2"]').attr("data-uid")==n){let t=uu.getOrderList().size+uu.getQueueList().size;ci.show(2,ci.type.ktvdiandannum,t+""),qd("setqueue",-1,n)}else ci.hide(2);1==uu.getSelfInfo().teacher&&ci.show(1,ci.type.xiamai),ci.hide(-2),ci.hide(1),setTimeout((()=>{ci.show(1,ci.type.xiamai)}),10)}else ci.show(1,ci.type.xiamai);else if(ci.hide(1),uu.isKtvRoom()){uu.getSelfInfo().teacher,uu.isAnchors2(uu.getMeid())&&ci.hide(2),uu.isAnchors2(uu.getMeid())&&window.$(".channel-queuelist.sp").hide()}if(uu.isKtvRoom()){rm.exec().then((()=>{uu.globalDDSocket.send("orderlist",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid}),uu.isKtvRoom()&&uu.globalDDSocket.send("queuelist",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid})})).catch((()=>{}));let t=!1,i=uu.getOrderList(),o=uu.getQueueList(),s=uu.getMeid();for(let[e,n]of i)s==e&&(t=!0);for(let[e,n]of o)s==e&&(t=!0);if(e.forEach((e=>{e.uid==s&&(t=!0)})),t){ci.hide(1),ci.hide(-2);uu.getAnchorKengUser(n)&&ci.show(1,ci.type.xiamai)}else{1==uu.getSelfInfo().teacher?(ci.show(-2,ci.type.zhaoren,"找人"),ci.show(1,ci.type.shangmai,"上麦")):ci.show(-2,ci.type.zhaoren,"找人")}}}else if(uu.isVideoTempRoom()){if(null==uu.getAnchoringUser())return void cu(uu.getMeid());if(Ti.getInstance().getCaptainGear(),2==s){let t="";t=uu.isCanChoiceCreateCarTempRoom()?0==uu.roomInfo.game_type||7==uu.roomInfo.live?"关闭车队":"关闭歌房":uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype?"关闭歌房":"",ci.show(1,ci.type.closeteam,t)}else ci.show(1,ci.type.exittempteam)}else if(uu.isSongTempRoom())1==t.invite&&1==uu.roomInfo.is_hall_captain?ci.show(2,ci.type.inviteByChatRoom):ci.hide(2),le.getInstance().onUpdateIdentity(),le.getInstance().onCheckRecommendSeat();else if(uu.isSongPkRoom())mu.getInstance().seatsUpdate();else if(uu.isSquidGame())bw.getInstance().seatsUpdate(),uu.isPtype5()&&ci.show(1,ci.type.closeteam,"关闭车队");else if(uu.isTruthRoom())uu.isPtype5()&&(uu.isAnchoringUser(uu.getMeid())?ci.show(1,ci.type.closeteam,"关闭车队"):ci.show(3,ci.type.exittempteam,"离开"));else if(uu.isH5ActiveRoom())bw.getInstance().seatsUpdate();else if(uu.isChorusRoom())nw.getInstance().updateSeats(),uu.isPtype5()&&(uu.isAnchoringUser(uu.getMeid())?ci.show(1,ci.type.closeteam,"关闭车队"):ci.show(3,ci.type.exittempteam,"离开"));else if(uu.isKtvSmallRoom())ad.getInstance().updateSeats(),1==t.invite&&1==uu.roomInfo.is_hall_captain?ci.show(2,ci.type.inviteByChatRoom):ci.hide(2);else if(uu.isCocosH5Room())uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid,passport:Ct.readCookie("Tuwan_Passport")}),_s.getInstance().updateSeats(e);else if(uu.isNewDrawTempRoom())1==t.invite&&uu.isAnchoringUser(uu.getMeid())?ci.show(2,ci.type.inviteByChatRoom):ci.hide(2),ci.show(3,ci.type.exittempteam);else if(uu.isTempCarteamRoom())if(uu.isLangrenSmallRoom());else if(uu.isWerewolfTeamRoom())uu.isAnchoringUser(uu.getMeid())?(ci.show(1,ci.type.werewolfMatch),0===window.$("#free-team-container").length&&$u.getInstance().initTemplate(uu.getRoomInfo()),Qm.getInstance().addRefreshBtn(),Qm.getInstance().updateCarList()):(ci.hide(1),Qm.getInstance().removeRefreshBtn());else if(uu.isTruthSmallRoom()){if(null==uu.getAnchoringUser())return void cu(uu.getMeid());ci.show(3,ci.type.exittempteam,"离开"),1==t.invite&&1==uu.roomInfo.is_hall_captain?ci.show(2,ci.type.inviteByChatRoom):ci.hide(2)}else if(uu.isLive18());else if(16==uu.getRoomInfo().live&&1!=uu.getRoomInfo().team_stage);else{if(null==uu.getAnchoringUser()&&!uu.isLoveTempRoom()&&!uu.isNewDrawTempRoom()&&!uu.isSongTempRoom())return void cu(uu.getMeid());uu.isLiveTempRoom()&&(a=uu.getCid(),uu.globalDDSocket.send("getLiveUsers",{cid:a})),1==uu.roomInfo.fleet_type?o&&2==s?(1==t.invite&&ci.show(0,ci.type.inviteByChatRoom),ci.show(2,ci.type.newCarModeGo),ci.show(3,ci.type.newCarModeBack)):ci.show(1,ci.type.newCarModeLeave):(1==t.invite&&uu.isDrawTempRoom()&&!uu.isGameTempRoom()&&2==s&&ci.show(0,ci.type.inviteByChatRoom),Am(),rv(o,s,n))}else if(uu.isAutoRoom()){if(2==s){const t=i.find(".autoroom-team-item[data-state!='1']");t.find(".autocarteam-li-close").show(),t.find(".autocarteam-li-top").show()}}else if(uu.isGameRoom())uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid}),Zm.getInstance().onCheckGameJumpStatus();else if(uu.isLOLMatchRoom())e.length>0&&Fi._lolMatchHostInfo(e),2!=s&&3!=s||window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show();else if(uu.isJingPaiRoom()){s>0&&(2==s||1==s)||ci.show(2,ci.type.jingpai),uu.isAnchoringUser(uu.getMeid())?(ci.show(1,ci.type.paidankefu,uu.getQueueList().size+""),clearInterval(ci.timing),ci.timing=null):uu.isInAnchors(uu.getMeid())?(clearInterval(ci.timing),ci.timing=null,ci.hide(1)):ci.show(1,ci.type.shangmai);0==uu.getBossUid()&&window.$(".jingpai-content").html("")}else uu.isTakeMeRoom()?(uu.globalDDSocket.send("getBlindStage",{cid:uu.getCid()}),uu.isInAnchors(uu.getMeid())?(uu.getOrderList().size||uu.getQueueList().size)&&ci.show(2,ci.type.takemenum,uu.getOrderList().size+uu.getQueueList().size+""):(uu.getOrderList().has(uu.getMeid())||uu.getQueueList().has(uu.getMeid()))&&ci.show(2,ci.type.takemeOrder),Ai.getInstance().onCheckState(t.data,t.stage,t.desc)):uu.isDrawRoom()?(Le.getInstance().onCheck(t.currSignal,t),uu.isAnchoringUser(uu.getMeid())&&1e3!=Le.getInstance().currSignal?ci.show(3,ci.type.drawForceQuit):ci.hide(3),uu.isPtype5()&&(uu.isAnchoringUser(uu.getMeid())?ci.show(1,ci.type.closeteam,"关闭车队"):ci.show(3,ci.type.exittempteam,"离开"))):uu.isBattleRoom()&&(uu.isBattleMainSeatNotPromise()&&Si.getInstance()._setNarrator(),uu.isKillerBattleRoom()&&uu.globalDDSocket.publishList({cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().ptype}));var a;if((uu.isDrawTempRoom()||uu.isDrawRoom())&&Le.getInstance().onCheck(t.currSignal,t),uu.isSpecialTakeMeRoom())for(let[r,c]of pm)uu.isInAnchors(r)||(uu.globalRtcClient.unsubscribe(c),pm.delete(r));if(5!=uu.getRoomInfo().gameid)for(let[r,c]of pm)if(!uu.isInAnchors(r)){let t=uu.getMeid();r!=t&&(uu.inInNotStartedCar(r)&&uu.inInNotStartedCar(t)||uu.globalRtcClient.unsubscribe(c))}uu.isMarryRoom()&&(Ym.getInstance().initMarryStageSocket(),uu.getAnchoringUserId()==uu.getMeid()?window.$(".marry_host_btn").css("display","flex"):window.$(".marry_host_btn").hide(),uu.isInAnchors(uu.getMeid())?(uu.getOrderList().size||uu.getQueueList().size)&&ci.show(2,ci.type.marryBtn):(uu.getOrderList().has(uu.getMeid())||uu.getQueueList().has(uu.getMeid()))&&ci.show(2,ci.type.marryBtn)),uw()}function xv(t){if(0!=t.error)return void Vt(t.error_msg);const e=t.position;if(uu.isJingPaiRoom()&&e>3)return;const n=uu.getMeid();2==e&&(uu.getCid(),uu.isHuodongRoom()?window.$(".chatroom-redjilu").css("display","block"):uu.isKtvRoom()&&(qd("setorder",-1,n),uu.globalDDSocket.send("orderlist",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid})))}function bv(t){if(4==t.error&&(uu.isDrawTempRoom()||uu.isDrawRoom()))return void Vt(t.error_msg);window.$(".yaoqing-shangmai").empty();const e=uu.getMeid();uu.isKtvSmallRoom()&&uu.isInAnchors(e)||(bm(0),window.$(".chat-huatong").addClass("chat-huatong-jin"));const n=window.$(".chat-center-main");if(window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").hide(),uu.isShengyouRoom())window.$(".chat-shangmai-btn").text("上麦");else if(uu.isHuodongRoom())window.$(".chatroom-redjilu").css("display","none");else if(uu.isAutoRoom())n.find(".autocarteam-li-close").hide(),n.find(".autocarteam-li-top").hide();else if(uu.isDrawTempRoom());else if(uu.isKtvRoom()){const t=uu.getOrderList();if(t.has(e)){const n=Array.from(t.keys()).findIndex((t=>t==e));ci.show(2,ci.type.ktvdiandannum,n+1)}else ci.show(2,ci.type.ktvdiandan)}else uu.isMusicTempRoom()||uu.isSameMusicTempRoom()?uu.isSongTempRoom()||cu(uu.getMeid()):uu.isJingPaiRoom()&&he.setLeftSearchInput(!1)}function $v(t){if(uu.isKtvRoom()){const e=uu.getMeid(),n=t.data;if(uu.seOrderList(n),uu.isAnchoringUser(e)&&$('.seat-item[data-aposition="2"]').attr("data-uid")==e){const t=uu.getQueueList().size+n.length;uu.getAnchorKengUser(e)?ci.show(2,ci.type.ktvdiandannum,t+""):ci.hide(2),uv(),pv()}else{const t=n.findIndex((t=>t.uid==e));if(t>-1)ci.show(2,ci.type.ktvdiandannum,t+1),ci.hide(-2),ci.hide(1);else{if($(".channel-queuelist.sp").hide(),$(".seat-item-empty[data-aposition=1]")[0]&&"0"!=$(".seat-item-empty[data-aposition=1]").attr("data-uid")&&$(".seat-item-empty[data-aposition=1]").attr("data-uid")==e)ci.hide(-2);else{const n=uu.getAnchorKengUser(e),i=uu.getQueueList();let o=!1;for(let[t,s]of i)t==e&&(o=!0);!n&&t<0&&!o&&ci.show(-2,ci.type.zhaoren,"找人");1==uu.getSelfInfo().teacher&&!n&&t<0&&!o&&ci.show(1,ci.type.shangmai,"上麦")}ci.hide(2)}}let i;n.forEach(((t,n)=>{t.uid==e&&(i=n+1)})),hv(i)}else if(uu.isJingPaiRoom()){Fi.setJingpaiWaiters(t.data);const e=uu.getMeid();uu.isAnchoringUser(e)&&window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show()}else if(uu.isTakeMeRoom()){const e=uu.getMeid(),n=t.data;if(uu.seOrderList(n),uu.isAnchoringUser(e))ci.show(2,ci.type.takemenum,uu.getOrderList().size+uu.getQueueList().size+"");else{n.findIndex((t=>t.uid==e))>-1?ci.show(2,ci.type.takemeOrder):ci.hide(2)}hv()}else if(uu.isMarryRoom()){const e=uu.getMeid(),n=uu.getQueueList(),i=t.data;if(uu.seOrderList(i),uu.isAnchoringUser(e))ci.show(2,ci.type.marryBtn);else{const t=i.findIndex((t=>t.uid==e)),o=n.get(e);t>-1||o?ci.show(2,ci.type.marryBtn):ci.hide(2)}hv()}}function kv(t){0!=t.error&&Vt(t.error_msg)}function Cv(t){if(0!=t.error){return void Rd(t.error_msg)}const e=uu.getMeid(),n=t.position,i=t.fid;if(uu.isInAnchors(e),uu.isAutoRoom()||uu.isShengyouFreeRoom()||uu.isAutoRoomWithPType()||uu.isShengyouFreeRoomWithPType()){1==n&&nm(bs.createAutoCarDataGloab,i);window.$(".autocarteam-right-list").find(".carteamauto-item[data-fid='"+i+"']").find(".carauto-team-right-join").text("已加入").addClass("joined");window.$(".chat-center-message").find(".carteamauto-item-message[fid='"+i+"']").find(".carauto-team-right-join").text("已加入").addClass("joined")}else uu.isBattleRoom()&&1==n&&nm(bs.createAutoCarDataGloab,i);Xm.track(uu.getAnalyticsData("on_car"))}function Iv(t){const e=uu.getMeid();uu.isInAnchors(e)||(bm(0),window.$(".chat-huatong").addClass("chat-huatong-jin"));const n=uu.getMycarData();if(n){const t=n.fid;if(uu.isAutoRoom()||uu.isAutoRoomWithPType()){const e="加入车队";window.$(".autocarteam-right-list").find(".carteamauto-item[data-fid='"+t+"']").find(".carauto-team-right-join").text(e).removeClass("joined");window.$(".chat-center-message").find(".carteamauto-item-message[fid='"+t+"']").find(".carauto-team-right-join").text(e).removeClass("joined"),Fi.updateAutoroomTeamInNum(t,null,!1)}else if(uu.isShengyouFreeRoom()||uu.isShengyouFreeRoomWithPType()){const e=uu.isShengyouFreeRoom()?"加入":"加入车队";window.$(".autocarteam-right-list").find(".carteamauto-item[data-fid='"+t+"']").find(".carauto-team-right-join").text(e).removeClass("joined");window.$(".chat-center-message").find(".carteamauto-item-message[fid='"+t+"']").find(".carauto-team-right-join").text(e).removeClass("joined"),Fi.updateAutoroomTeamInNum(t,null,!1)}}if(uu.clearMycarTeam(),window.$(".new-kaihei-teams").find(".seat-close").hide(),uu.isBattleRoom()&&(ci.hide(2),ci.hide(3),ci.getButtons(1)!=ci.type.myteam.tag)){const t="创建"+uu.getCarButtonStr();ci.show(1,ci.type.creatteam,t)}}function Sv(t){const e=uu.getMeid(),n=t.fid,i=t.data,o=Fi.updateKaiheiItemData(n,i,e);if(1==uu.roomInfo.at&&(o?uu.updateInAllCar(i):uu.updateInAllCar([]),fe.getInstance().onActionTeamUpdate()),uu.isLOLMatchRoom())return Fi._lolMatchTeamItem(i,n),Fh(),void uu.updateInCarTeamUser(n,i);if(o){const s=o.position,a=window.$(".new-kaihei-teams").find(".kaihei-team-item[data-fid='"+n+"']");1==s?a.find(".seat-item-empty[data-uid!='0']").find(".seat-close").show():a.find(".seat-item-empty[data-uid='"+e+"']").find(".seat-close").show(),(uu.isAutoRoom()||uu.isShengyouFreeRoom())&&Fi.updateAutoroomTeamInNum(n,i.length,!0),$u.getInstance().showContent(null,t.data)}else(uu.isAutoRoom()||uu.isShengyouFreeRoom())&&0==uu.getInCarTeamUsers().size&&(uu.globalDDSocket.send("fleetScoreList",{cid:uu.getCid(),uid:e}),uu.isShengyouFreeRoom()&&$u.getInstance().hideContent());if(uu.isAutoRoom()){const t=uu.getInCarTeamUsers();if(t&&t.size>0){n==Array.from(t.keys())[0]&&uu.updateInCarTeamUser(n,i)}}const s=uu.getMycarData(),a=uu.getMycarDuizhangUid();if(s&&s.fid==n&&0==i.length&&(e==a&&im(e),window.$(".carauto-create").removeClass("carauto-exitcar"),window.$(".carauto-create").css("display","flex"),window.$(".carauto-share").css("display","none"),window.$(".carauto-duizhang-exitcar").css("display","none"),window.$(".yaoqing-float").css("display","none"),uu.clearMycarTeam(),ci.hide(2),ci.hide(3),uu.isShengyouFreeRoom()&&($u.getInstance().hideContent(),Fi.updateAutoroomTeamInNum(n,i.length,!1)),ci.getButtons(1)!=ci.type.myteam.tag)){const t="创建"+uu.getCarButtonStr();ci.show(1,ci.type.creatteam,t)}}function Tv(t){const e=t.data;as.getInstance().setTeamData(e,t.time)}function Rv(t){if(!uu.isLOLMatchRoom())return;const e=uu.getMeid(),n=t.data;if(uu.isLOLMatchRoom()?uu.setInCarTeamUsers(n):uu.isAutoRoom(),uu.isLOLMatchRoom()){const e=t.data;if(e.length>0)return Fi._lolMatchTeamInfo(e),void Fh()}else Fi.setKaiheiTeams(n,e);const i=uu.getMycarData();if(i){const t=i.persons,n=t.get(e).position,o=i.fid,s=window.$(".new-kaihei-teams").find(".kaihei-team-item[data-fid='"+o+"']");1==n?(s.find(".seat-item-empty[data-uid!='0']").find(".seat-close").show(),function(t,e){let n=Ct.readCookie("user_xuanyan_"+t);n||(n=Mt.xuanyanDefaultText),Fi.showXuanyanText(e,n)}(e,o),ci.show(1,ci.type.startteam,"开车")):s.find(".seat-item-empty[data-uid='"+e+"']").find(".seat-close").show(),Ov(Array.from(t.keys()))}else window.$(".new-kaihei-teams").find(".seat-close").hide();uu.isAnchoringUser(e)&&window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show()}function Mv(t){const e=t.data,n=uu.getMeid();if(e.length&&e[0].mode&&e[0].mode>0&&setTimeout((()=>{window.$(".welcomeTeamTipCtn").show()}),10),uu.isGameRoom()||uu.isKillerFreeRoom()||uu.isSpyRoom()||uu.isKillerBattleRoom()){if(!uu.isGameRoom()&&e.length>0){const e=t.data[0];Fi.setGameroomTuijianData(e,n)}uu.setInCarTeamUsers(e)}else if(uu.isBattleRoom()||uu.isAutoRoom()||uu.isShengyouFreeRoom()){if(e.length>0){const e=t.data[0],i=e.fid,o=e.data;e.title;const s=e.invite;if(1==e.self){Ei.getInstance().setMyCarteamData(o);const t=o.filter((t=>t.uid==n));t&&t.length>0&&1==t[0].position?(window.$(".carauto-duizhang-exitcar").css("display","flex"),window.$(".kaihei-team-item").find(".seat-close").show(),uu.isAutoRoom()?1==s?ci.shows([1,2,3],[ci.type.inviteByChatRoom,ci.type.startteam,ci.type.jiesanteam]):ci.shows([1,2,3],[ci.type.yaoqing,ci.type.startteam,ci.type.jiesanteam]):(1==s?ci.shows([1,3],[ci.type.inviteByChatRoom,ci.type.jiesanteam]):ci.shows([1,3],[ci.type.yaoqing,ci.type.jiesanteam]),ci.show(2,ci.type.startteam,"Go"))):(window.$(".carauto-create").addClass("carauto-exitcar"),ci.shows([1,2],[ci.type.yaoqing,ci.type.exitteam])),0==s&&(window.$(".carauto-create-yao").css("display","flex"),window.$(".carauto-share").css("display","flex"));if(Ov(o.map((t=>t.uid))),uu.isAutoRoom())ji.getInstance().setShow(o);else if(uu.isShengyouFreeRoom())$u.getInstance().showContent(e);else{window.$(".autoroom-team-item[data-fid='"+i+"']").addClass("hide");const t=Fi._getAutoroomTuijianSeatsHtml(e,{width:54,height:54,pwidth:60,pheight:80});as.getInstance().updateNewCarTeamInfoHtml(as.getTabKeys().newcarteam,t,e)}}else{Ei.getInstance().setMyCarteamData(null),uu.isBattleRoom()?(window.$(".autoroom-team-item").removeClass("hide"),window.$("#right-team-mime-container").empty()):uu.isAutoRoom()?ji.getInstance().setHide():$u.getInstance().hideContent(),window.$(".carauto-create").removeClass("carauto-exitcar"),window.$(".carauto-create").text("创建"+uu.getCarButtonStr()),window.$(".carauto-create").css("display","flex"),window.$(".carauto-share").css("display","none"),window.$(".carauto-duizhang-exitcar").css("display","none"),window.$(".yaoqing-float").css("display","none"),uu.clearMycarTeam(),ci.hide(2),ci.hide(3);const t=window.$(".room-buttons .opbutton[data-num='1']")[0];if(t&&"myteam"!=window.$(t).data().type){const t="创建"+uu.getCarButtonStr();ci.show(1,ci.type.creatteam,t)}}Fi.setAutoroomTuijianData(e,n)}else uu.clearMycarTeam(),Fi.clearAutoroomTuijianSeats(),setTimeout((()=>{const t=window.$(".room-buttons .opbutton[data-num='1']")[0];if(t&&(window.$(t).data().type&&"myteam"!=window.$(t).data().type||"none"==$(t).css("display"))){const t="创建"+uu.getCarButtonStr();ci.show(1,ci.type.creatteam,t)}}),500),ci.hide(2),ci.hide(3),window.$(".yaoqing-float").css("display","none"),uu.isAutoRoom()?ji.getInstance().setHide():$u.getInstance().hideContent();uu.setInCarTeamUsers(e),uu.isBattleRoom()||uu.isAnchoringUser(n)&&window.$(".chat-center-main").find(".seat-item-empty[data-uid!=0]").find(".seat-close").show()}}function Av(t){const e=uu.getMeid(),n=uu.getRoomInfo().ptype,i=t.data,o=t.tabs,s=as.getInstance();let a=0;o&&o.length&&(a=o[0].id);let r=[];if(i.forEach((t=>{t.mode&&t.mode>0?uu.getRoomInfo().show_welcome_fleet&&r.push(t):r.push(t)})),1==uu.roomInfo.at&&(uu.isGameRoom()||uu.isKillerFreeRoom()||uu.isSpyRoom()||uu.isWerewolfTeamRoom()||uu.isKillerBattleRoom()||(uu.setInAllCar(fe.getInstance().makeTeamData(r)),fe.getInstance().onActionTeamUpdate())),uu.isBattleRoom(n)||uu.isKillerFreeRoom(n)&&uu.isBattleRoom())if(uu.isKillerBattleRoom()){const t=Fi.setGameTeams(r,0,!0);s.setNewcarteamHtml(as.getTabKeys().newcarteam,t)}else{const t=Fi.setAutoRoomTeamList(r,e,0);s.setNewcarteamHtml(as.getTabKeys().newcarteam,t)}else if(uu.isGameRoom(n)||uu.isKillerFreeRoom(n)||uu.isSpyRoom(n)||uu.isWerewolfTeamRoom(n)){const t=Fi.setGameTeams(r,0,!0);s.setGameTeamData(t)}else(uu.isSongRoom(n)||uu.isAutoRoom(n)||uu.isShengyouFreeRoom(n))&&(uu.isSongRoom(n)||s.setAutoTeamData(r,e));if(uu.isBattleRoom());else{let t={slidesPerView:4,slidesPerColumn:1,slidesPerGroup:4};if(Fi.setAutoTeamTabs(o,a),uu.isGameRoom()||uu.isKillerFreeRoom()||uu.isSpyRoom()||uu.isWerewolfTeamRoom())uu.isGameRoom()?t={slidesPerView:3,slidesPerColumn:2,slidesPerGroup:3}:xu.getInstance().checkSkinColorMapWithStyle(),r.length>0?Fi.setGameTeams(r):window.$(".autoroom-allteams .autoroom-teamlist").html(Fi.setGameRoomEmptyTeam());else if(uu.isSongRoom()||uu.isAutoRoom()||uu.isShengyouFreeRoom()){uu.isAutoRoom()?t={slidesPerView:3,slidesPerColumn:2,slidesPerGroup:3}:xu.getInstance().checkSkinColorMapWithStyle();let n=[];r.length>0&&(n=uu.isSongRoom()?Fi.setSongRoomTeamList(r,e):Fi.setAutoRoomTeamList(r,e,a)),0==n.length?uu.isSongRoom()?window.$(".autoroom-allteams .autoroom-teamlist").html(Fi.setGameRoomEmptyTeam("暂无歌房")):(window.$(".autoroom-allteams .autoroom-teamlist").html(Fi.setAutoRoomEmptyTeam()),Fi.clearAutoroomTuijianSeats()):window.$(".autoroom-allteams .autoroom-teamlist").html(n),uu.isAutoRoom()||(window.$(".autoroom-allteams").removeClass("hide"),window.$(".autoroom-allteams").css("overflow","unset")),uu.isSongRoom()?uu.setMusicCarList(r):(uu.setMusicCarList(r),uu.isAnchoringUser(e)&&Bh())}Td.create(t)}}function Pv(t){-2==t.error?Md("您的钻石和余额不足，请充值",(function(){window.open(Ot.getRechargeUrl())}),"充值"):2==t.error?Rd(t.error_msg):5==t.error||6==t.error?(window.$(".yaoqing-float").css("display","none"),Rd(t.error_msg)):(t.error,Vt(t.error_msg))}function jv(t){const e=t.fid,n=t.data,i=n.num,o=n.pic,s=n.operate;if(uu.isKillerFreeRoom()||uu.isSpyRoom())Fi.updateGameroomTeamInNum(e,i,o,s),Fi.updateKillerBattleTeamInNum(e,i,o,s);else if(uu.isGameRoom())Fi.updateGameroomTeamInNum(e,i,o,s);else if(uu.isKillerBattleRoom())Fi.updateKillerBattleTeamInNum(e,i,o,s);else if(uu.isAutoRoom()||uu.isShengyouFreeRoom()||uu.isAutoRoomWithPType()||uu.isShengyouFreeRoomWithPType()){Fi.updateAutoroomTeamInNum(e,i,null);window.$(".autocarteam-right-list").find(".carteamauto-item[data-fid='"+e+"']").find(".autocar-team-list-info-1 font").text(i);window.$(".chat-center-message").find(".carteamauto-item-message[fid='"+e+"']").find(".autocar-team-list-info-1 font").text(i)}else if(uu.isBattleRoom()){Fi.updateBattleroomTeamInNum(e,i,o);window.$(".chat-center-message").find(".carteamauto-item-message[fid='"+e+"']").find(".autocar-team-list-info-1 font").text(i)}}function Dv(t){if(0==t.error){const t=uu.getMeid();window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),window.$(".carauto-create").text("创建车队"),uu.isInAnchors(t)||(bm(0),window.$(".chat-huatong").addClass("chat-huatong-jin")),ci.hide(1),Rd("车队已解散")}}let Lv=!0;function Ev(t){const e=uu.getMeid();let n,i=t.data;if(uu.setQueueList(i),uu.isTakeMeRoom()){const e=uu.getMeid(),n=t.data;if(uu.isAnchoringUser(e)){const t=uu.getOrderList().size+n.length;ci.show(2,ci.type.takemenum,t+"")}else{n.findIndex((t=>t.uid==e))>-1?ci.show(2,ci.type.takemeOrder):ci.hide(2)}}else if(uu.isMarryRoom()){const e=uu.getMeid(),n=uu.getOrderList(),i=t.data;if(uu.isAnchoringUser(e))ci.show(2,ci.type.marryBtn);else{const t=i.findIndex((t=>t.uid==e)),o=n.get(e);t>-1||o?ci.show(2,ci.type.marryBtn):ci.hide(2)}}else if(uu.isJingPaiRoom())uu.isAnchoringUser(e)&&ci.show(1,ci.type.paidankefu,i.length);else if(uu.isKtvRoom()){const t=uu.getAnchorKengUser(e);let n=i.findIndex((t=>t.uid==e));if(i.length>0){if(uu.isPaidan2(e));else if(uu.isAnchors2(uu.getMeid())&&$('.seat-item[data-aposition="2"]').attr("data-uid")==e){const e=uu.getOrderList().size+i.length;t?ci.show(2,ci.type.ktvdiandannum,e+""):ci.hide(2)}}else if(uu.isPaidan2(e),uu.isAnchors2(uu.getMeid())&&$('.seat-item[data-aposition="2"]').attr("data-uid")==e){const t=uu.getOrderList().size+i.length;ci.show(2,ci.type.ktvdiandannum,t+"")}if(uv(),pv(),n>=0)ci.show(-3,ci.type.diandanself,n+1),ci.hide(1),ci.hide(-2);else{if($(".common-queuelist").hide(),ci.hide(-3),!Lv){const e=uu.getMeid(),n=uu.getOrderList();let i=!1;for(let[t,o]of n)t==e&&(i=!0);i||t||ci.show(-2,ci.type.zhaoren,"找人")}1==uu.getSelfInfo().teacher&&(Lv||ci.show(1,ci.type.shangmai,"上麦")),Lv=!1}}i.forEach(((t,i)=>{t.uid==e&&(n=i+1)})),lv(n)}function Bv(t){av.getInstance().onCheck(t.data)}function Fv(t){fm.globalUid&&fm.globalOrderType&&qd(fm.globalOrderType,-1,fm.globalUid)}function Uv(t){2e3==t.data.type?kd.appendMessage('<div class="chatroom-draw-message"><span style="color:#EF823A">小法官:</span> '+t.data.msg+"</div>"):Le.getInstance().onGameMessage(t)}function zv(t){bm(0),window.$(".chat-huatong").addClass("chat-huatong-jin")}function Ov(t){setTimeout((function(){const e=uu.getMeid();for(let n=0;n<t.length;n++){const i=1*t[n],o=pm.get(i);i!=e&&o&&Pm(i,o)}}),500)}class Nv{constructor(){this.finished=!0,this.intervalId=null}reset(t,e){this.intervalId&&clearInterval(this.intervalId),this.finished=!1,e(t),this.intervalId=setInterval((()=>{if(0===t)return e(t),this.finished=!0,void clearInterval(this.intervalId);t--,e(t)}),1e3)}stop(){this.finished=!0,this.intervalId&&clearInterval(this.intervalId)}}const qv="https://res.tuwan.com/templet/play/chat/v2/images/empty.png",Gv="https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamMatchSucess.svga",Vv="https://asset.tuwan.com/chartRoom/peaceteam/peaceTeamStartGame.svga",Hv=t=>{let e=Math.floor(t/60),n=t%60;return`${e>9?e:"0"+e}:${n>9?n:"0"+n}`};class Wv{constructor(){this.team_stage=1,this.htmlDom=null,this.counttime=0,this.countdown=new Nv,this.listenEvent()}static getInstance(){return this.instance||(this.instance=new Wv),this.instance}onReset(){this.htmlDom&&this.htmlDom.remove(),this.htmlDom=null,ci.hide(-8),this.countdown.stop()}subscribe(t){if(uu.isJinChanchanRoom()){if(console.log("jinchanchan subscribe===",t),1===t.typeid){const e=uu.getMeid(),n=t.data||[];n.forEach((t=>{t.uid===e&&(2!==t.position&&ci.hide(-8),t.position%2==0&&($("#jcc_leave").show(),$("#jcc_prepare").show())),Fi.setAnchorSeat(t,uu.getMeid(),!1,!1,!1,"","用户")})),uu.anchorUsers.clear(),uu.setAnchorsMap(n)}var e;if(33===t.typeid)if(132===t.type){const n=t.data.cid;3===this.team_stage&&1===t.data.team_stage?(e=()=>ou(n),setTimeout((()=>{$("#jccVSLogoCtn").removeClass("hide"),Zt.getInstance().playEver("#jccVSLogoCtn",Vv,"jccVSLog")}),10),setTimeout((()=>{$("#jccVSLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("jccVSLog"),e()}),1600)):(1===this.team_stage&&t.data.team_stage,ou(n))}else if(138===t.type)this.updateRoomStatus();else if(139===t.type){const e=t.data;return void window.$.DialogByZ.Alert({Title:"提示",Content:e.button_title,BtnL:"确定",FunL:function(){window.$.DialogByZ.Close(),window.open(e.url||location.href,"_blank")}})}}}loadRoomStage(t){if(uu.isJinChanchanRoom()&&21===t.live){if(Zt.getInstance().clearPlayer("jccVSLog"),Zt.getInstance().preload(Gv),Zt.getInstance().preload(Vv),this.team_stage=t.team_stage,1===t.team_stage){this.showButton(t);const e=t.skin_active?qv:t.skin;window.$(".room-seats-main").html(Fi.init1vs7TempSeats(t)),window.$(".room-seats-main").css("background","none"),""!=e&&e!=qv?window.$(".chat-center-left").css({background:"url("+e+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=t.img_wheat_pc&&window.$(".troom1v7-container").css({background:"url("+t.img_wheat_pc+") no-repeat","background-size":"cover"})}2!==t.team_stage&&3!==t.team_stage||(this.initTemplate(t),this.updateRoomStatus())}}resetTeamInnerTimer(t){this.countdown.reset(t,(t=>{2===this.team_stage?($(".jinchanchan-timer").text("等待倒计时："+Hv(t)),$(".jinchanchan-timer").addClass("matching")):3===this.team_stage&&($(".jinchanchan-timer").removeClass("matching"),$(".jinchanchan-timer").text("比赛倒计时："+Hv(t)))}))}toMatch(){qt.get(Ot.goldenStart(uu.getCid())).then((t=>{0===t.error||Vt(t.error_msg)}))}toLeave(){Ct.Confirm("您当前已进入匹配页面，如退出，需要十分钟后才能进行再次匹配。",this.leave)}toPrepare(){const t=this;window.$.DialogByZ.Confirm({Title:"提示",Content:"请确认是否已添加剩余小队游戏账号，并进入到游戏内匹配房间",BtnL:"去添加",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){t.prepare(),window.$.DialogByZ.Close()}})}leave(){qt.get(Ot.goldenLeave(uu.getCid())).then((t=>{0===t.error||Vt(t.error_msg)}))}prepare(){qt.get(Ot.goldenPrepare(uu.getCid())).then((t=>{0===t.error||Vt(t.error_msg)}))}getWheats(){return qt.get(Ot.goldenGetWheat(uu.getCid()))}showButton(t){if(t.team_cd_countdown>0){let e=t.team_cd_countdown;this.countdown.reset(e,(t=>{t<=0?ci.show(-8,{},"匹配"):ci.show(-8,{},Hv(t))}))}else ci.show(-8,{},"匹配")}listenEvent(){const t=this;$(document).on("click",".jcc-leave,.jcc-prepare",(function(e){const n=$(this).attr("key");console.log("key==",n),"leave"===n?t.toLeave():t.toPrepare()}))}async updateRoomStatus(){console.log("initWheatFromJsonp=== updateWheat");const t=await this.getWheats();if(0!==t.error)return void Vt(t.error_msg);const e=t.data,n=e.list,i=e.pretotal,o=e.team_countdown;2===this.team_stage&&3===e.team_stage&&(setTimeout((()=>{$("#jccVSLogoCtn").removeClass("hide"),Zt.getInstance().playEver("#jccVSLogoCtn",Gv,"jccVSLog")}),10),setTimeout((()=>{$("#jccVSLogoCtn").addClass("hide"),Zt.getInstance().clearPlayer("jccVSLog")}),1510)),this.team_stage=e.team_stage;const s=e.total;console.log("getWheats===res",t),n.forEach(((t,e)=>{t.is_pre&&$(`#jinchanchan-team_${e+1}`).addClass("is-pre")})),$(".jcc-prestatus").text(`已准备  (${i}/${s})`),this.resetTeamInnerTimer(o),setTimeout((()=>{const t=uu.getRoomInfo();uw(t.uid,t.channelKey)}),100)}async initTemplate(t){window.$(".room-seats-main").html(this.genRoomHtml(t))}genRoomHtml(t){const e=t.seats-1,n=[];let i=2,o=0;for(let s=0;s<e;s++){let t=Fi._getOtherAnchorSeatHtml({position:i++,defaultbg:"add",userinfo:null,iscar:!1,index:0,role:"用户",pwidth:150,pheight:144,width:100,height:100,isrightline:!1});s%2==0&&(o++,n.push(`<div id="jinchanchan-team_${o}" class="jinchanchan-team" team-index="${o}">`)),n.push(t),s%2==1&&n.push("</div>")}return'\n        <div class="flex flex-jc chat-center-banner-main" style="position:relative;">\n            <div class="jinchanchan-container">\n                <div class="jinchanchan-mask"></div>\n                <div class="jinchanchan-box flex">'+n.join("")+'</div> \n                <div class="jinchanchan-timer">倒计时：05:00</div>\n                <div id="jccVSLogoCtn" class="jccVSLogoCtn hide"></div>\n                <div class="jcc-prestatus"></div>\n                <div class="jinchanchan-btns">\n                    <div id="jcc_leave" class="jcc-leave" key="leave"></div>\n                    <div id="jcc_prepare" class="jcc-prepare" key="prepare"></div>\n                </div>\n               \n            </div>\n        </div>'}}let Kv=null,Yv=null;async function Jv(t){Kv=await Cu(),console.time("loadedRoomInfo"),1==$(".common_iframe iframe").length&&$(".common_iframe iframe")[0].src.indexOf("cake")>-1&&($(".common_iframe").empty(),$(".common_iframe").hide());let e=1*t.uid;t.channelKey;let n=t.naming;t.token;let i=t.access,o=t.desc,s=t.cid;t.tag;let a=t.ptype,r=t.typeid,c=t.channel,l=t.gift_hide,d=t.hat;t.fleetnum;let m=t.skin_active,h=m?iw:t.skin;t.first;let u=t.anchor_ids.map((t=>1*t)),p=t.waiter_ids.map((t=>1*t));t.socketDomain,t.socketPort,t.wheat_bgs;let g=""==t.manage_uid?"136438,107833":t.manage_uid+",136438,107833";t.cap_role,t.fleet_name,t.more_name,t.create_name,t.area_name,t.title;let f=t.is_user_game,w=t.order_song||0,v=t.party_set.listshow,_=t.speaking,y=t.wolf_user_level;t.team_stage,t.team_countdown,t.team_cd_countdown,t.entrance_open;let x=t.is_warband_game_fleet;t.match_mode,t.max_member,t.min_member,t.live;let b=t.img_wheat_pc;t.cap_role="队长",window.$("#bannerSvga").html(""),window.$(".channel-queuelist").hide(),x?$("#mainPageCarTeamSettingBt").show():$("#mainPageCarTeamSettingBt").hide(),1==Rt&&(window.$(".chat-rooms-all").css("paddingTop","0"),window.$(".room-item[channel='"+c+"']").removeClass("hide")),Td.drop(),vi&&vi.destroy(),uu.clearIncarTeamUsers(),fm.mycarteamChannel="",fm.isChangeRoomUseRequest||fe.getInstance().initComponent(),$u.getInstance().onReset(),Wv.getInstance().onReset(),Si.getInstance().onReset(),li.getInstance().onReset(),li.getInstance().setCallBackFn(Rh,Th,qd,gv,du),Mi.getInstance().onReset(),Ti.getInstance().onReset(),Le.getInstance().onReset(),Ti.getInstance().setCallBackFn(ou,Hd,kd),Le.getInstance().setCallBackFn(ou),Ai.getInstance().onReset(),Gi.getInstance().onReset(),sv.getInstance().onReset(),ph.getInstance().onReset(),ov.getInstance().onReset(),Mw.getInstance().onReset(),Aw.getInstance().onReset(),bw.getInstance().onReset(),_u.getInstance().onReset(),Wu.getInstance().onReset(),Hu.getInstance().onReset(),_s.getInstance().onReset(),Pi.getInstance().onReset(),Zm.getInstance().joinGameFn=qh,th.getInstance().joinGameFn=qh,fu.getInstance().onReset(),hw.getInstance().onReset(),Pd.getInstance().onReset(),Ei.getInstance().onReset(),nw.getInstance().onReset(),Vw.getInstance().onReset(),Kv.getInstance().onReset(),ad.getInstance().onReset(),uh.getInstance().onReset(),Kw.getInstance().onReset(),Wt.getInstance().onReset(),vw.getInstance().onReset(),Ym.getInstance().onReset(),gw.getInstance().onReset(),Gw.getInstance().onReset(),window.kingTeamJumpToRoom=function(t){ou(t),$("#kingTeamParent").hide()};let k=Wo.getInstance();k.onReset(),Jm.hide();const C=Qm.getInstance();C.onReset(),C.goTuwanGame=Ch,uu.isTempCarteamRoom()||fm.isChangeRoomUseRequest||C.checkJoinedMineRoomOrGame(),Td.drop(),Ph&&Ph.destroy(),fm.giftToTeacher={},ci.clear(),pm.clear(),fm.anchorSeatsHistory.length=0,uu.anchorUsers.clear(),rm.setFlag(!1);const I=g.split(",").map((t=>parseInt(t)));he&&0==v&&I.includes(1*e)?he.setLeftSearchInput(!0):he.setLeftSearchInput(!1),Yv&&(clearInterval(Yv),Yv=null),fm.isWithoutChange||cm.setFlag(!1),2==r?window.$(".personvoiceroom").removeClass("hide"):window.$(".personvoiceroom").addClass("hide"),window.$(".invite-modal").addClass("hide"),window.$("#nowsubs").html(""),fm.isChangeRoomUseRequest||window.$(".inithide").hide(),window.$(".carauto-create").removeClass("carauto-exitcar"),window.$(".chat-center-left").removeClass("troom1v7-default-bg"),window.$("#dd_kefu_chat").css("display","flex"),window.$(".right-order-tab >div").removeClass("current"),window.$(".right-order-tab >div").eq(0).addClass("current"),window.$(".room-seats-main").css("background","none"),window.$(".chat-center-left").css("background","none"),xt.getInstance().getGiftEffectSwithState()?window.$(".chat-function-noani").addClass("chat-function-noani-x"):window.$(".chat-function-noani").removeClass("chat-function-noani-x");window.$("#newBannerSvga").css("background-color",uu.isDefaultColorRooms()?"#451d89":"transparent"),setTimeout((()=>{if(h.indexOf(".mp4")>-1){$("#mainPageVideoBgCtn").show();let t=h;window.$(".room-seats-main").css("background","none"),$("#mainPageVideoBgCtn").html(`<video id="videoCtn" autoplay="" loop="" muted="" playsinline="" style="width: 100%; height: 100%; object-fit: fill;">\n                <source src="${t}" type="video/mp4">\n            </video>`)}else $("#mainPageVideoBgCtn").hide(),$("#mainPageVideoBgCtn").html("")}),0),Mt.isUpScroll=!1,window.$("#chatNewmessage").hide(),window.$(".chat-center-window-main").scrollTop(999999),n&&(window.$(".right_chatroom_guanming").show(),window.$(".right_chatroom_guanming").attr("title",n),window.$(".right_chatroom_guanming").html(n));const S=window.$(".right-carteam-tab").find("div[type='tehui']");if(S.length>0&&(S.remove(),window.$(".right-tehui-list").remove()),fm.isChangeRoomUseRequest||window.$(".channel_task_star").hide(),window.$("#jiamianSvgaBg").hide(),t.seats,window.$(".jingjia-gift-info").hide(),window.$(".room-seats-main").html(""),uu.isShengyouFreeRoom()&&xu.getInstance().readResourceColor(m||h),uu.isTempCarteamRoom()&&1==f&&(17==uu.getRoomInfo().live||18==uu.getRoomInfo().live||ci.show(-1,ci.type.sendGameRole)),1==uu.getRoomInfo().party_set.listshow&&Om(uu.getCid()),Kv.getInstance().checkShowBgm(),uh.getInstance().checkDanmuNoticeVisible(),ww.getInstance().checkVisible(),uu.isShengyouRoom()||uu.isHuodongRoom()||uu.isTempCarteamRoom()&&!uu.isTruthSmallRoom()&&!uu.isLangrenSmallRoom()&&!uu.isKtvSmallRoom()){if(uu.isDrawTempRoom()){const e=Le.getInstance();e.initTemplate(),e.setRoomSeats(Fi.initDrawTempRoomSeats(t)),uu.isAnchors2(uu.getMeid())||Um(s),uu.isNewDrawTempRoom()&&(uu.isRoomManage(uu.getMeid())?window.$(".song-but-setting").removeClass("hide"):window.$(".song-but-setting").addClass("hide"))}else if(uu.isVideoTempRoom())uu.isAnchors2(uu.getMeid())||Um(s),window.$(".room-seats-main").html(Fi.initVideoTempSeats(t)),Ti.getInstance().initTemplate();else if(uu.isLiveTempRoom())av.getInstance().initTemplate(),window.$(".room-seats-main").html(Fi.initSelfLiveSeats(t));else if(uu.isGameTempRoom())Am(),window.$(".room-seats-main").html(Fi.initGameTempSeats(t));else if(uu.is1v7TempRoom())window.$(".room-seats-main").html(Fi.init1vs7TempSeats(t)),window.$(".room-seats-main").css("background","none"),""!=h&&h!=iw?window.$(".chat-center-left").css({background:"url("+h+") no-repeat","background-size":"cover"}):window.$(".chat-center-left").addClass("troom1v7-default-bg"),""!=b&&window.$(".troom1v7-container").css({background:"url("+b+") no-repeat","background-size":"cover"});else if(uu.isKingTeamRoom())Gw.getInstance().loadRoomStage(t);else if(uu.isPeaceTeamRoom())gw.getInstance().loadRoomStage(t);else if(uu.isSongTempRoom())window.$(".room-seats-main").html(Fi.initSongTempRoomSeats(t));else if(uu.isSoloTempRoom())window.$(".room-seats-main").html(Fi.initSoloTempRoomSeats(t));else if(uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype)uu.getRoomInfo().ptype,uu.isLiveTempRoom()?window.$(".room-seats-main").html(Fi.initSelfLiveSeats(t)):(window.$(".room-seats-main").html(Fi.initMusicTempSeats(t)),""==b?window.$(".music-temp").css({background:"url(https://asset.tuwan.com/chatroom/images/chatroom_temp_bg.jpg) no-repeat","background-size":"cover"}):window.$(".music-temp").css({background:"url("+b+") no-repeat","background-size":"cover"}));else if(24==uu.roomInfo.ptype&&1==uu.roomInfo.live)uu.getRoomInfo().ptype,uu.isLiveTempRoom()?window.$(".room-seats-main").html(Fi.initSelfLiveSeats(t)):(window.$(".room-seats-main").html(Fi.initMusicTempSeats(t)),""==b?window.$(".music-temp").css({background:"url(https://asset.tuwan.com/chatroom/images/chatroom_temp_bg.jpg) no-repeat","background-size":"cover"}):window.$(".music-temp").css({background:"url("+b+") no-repeat","background-size":"cover"}));else if(uu.isLoveTempRoom())window.$(".room-seats-main").html(Fi.initSelfLoveRoomSeats(t));else if(uu.isWerewolfTeamRoom()){const e=Qm.getInstance();e.initTemplate(t),e.on("updatecar",(function(t){vv(t)}))}else if(uu.isTempCarteamRoom()){if(window.$(".room-seats-main").html(Fi.initMusicTempSeats(t)),""==b?window.$(".music-temp").css({background:"url(https://asset.tuwan.com/chatroom/images/chatroom_temp_bg.jpg) no-repeat","background-size":"cover"}):window.$(".music-temp").css({background:"url("+b+") no-repeat","background-size":"cover"}),window.$(".chat-center-left").addClass("troom1v7-default-bg"),window.$(".room-seats-main").css("background","none"),uu.isSubRoomGameType())_s.getInstance().setRole=bm,_s.getInstance().muteLocalAudio=$m,_s.getInstance().rtcClient=uu.globalRtcClient,_s.getInstance().initTemplate(t),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"});else if(19==t.live){const e=bw.getInstance();e.unsubscribeRobot=Qv,e.globalAgoraClient=uu.globalRtcClient,e.showLoginWindow=du,e.initTemplate(t)}else if(20==t.live){const e=nw.getInstance();e.setRole=bm,e.showLoginWindow=du,e.initTemplate(t),wm.getInstance().clear()}}else window.$(".room-seats-main").html(Fi.initMainSeats(t)),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"}),uu.isShengyouFreeRoom()&&$u.getInstance().initTemplate(t);window.$(".room-seats-content").show(),uu.isShengyouRoom()?Um(s):uu.isHuodongRoom()?(window.$(".chat-diandan-btn").hide(),window.$(".chat-paidan-btn").hide(),window.$(".diandanroom-btns").css("display","none")):uu.isTempCarteamRoom()&&1!=uu.roomInfo.live&&!uu.isDrawTempRoom()&&(qt.get(Ot.getFleetReward(uu.getCid())).then((t=>{if(0==t.error){const e=t.data,n=e.fid,i=e.money,o=e.users||[];i>0&&(fm.isHaveShangGift=!0);let s=[];for(let t=0;t<o.length;t++){const e=o[t].uid,n=o[t].avatar;s.push('<li class="selected" account="'+e+'">\n                                    <div>\n                                        <img onerror="this.src=\'https://uc.tuwan.com/images/noavatar_1.jpg\'" src="'+n+'">\n                                    </div>\n                                </li>')}window.$(".temp-autocar-shang-content ul").html(s.join("")),window.$(".temp-autocar-shang-content button").attr("fid",n)}})),uu.isAdminUids(e)&&ci.hide()),(new Image).src=Pt+"/odds/addOddsmac"}else if(uu.isAutoRoom())window.$(".room-seats-main").html(Fi.initCarTeamSeats(t)),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"}),Um(s);else if(uu.isKtvRoom())Um(s),window.$(".room-seats-main").html(Fi.initPaidanSeats(t,300)),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"}),window.$(".room-seats-content").show();else if(uu.isJiamianRoom()){window.$(".room-seats-main").html(Fi.initJiamianRoomSeats(t)),""!=m?(Zt.getInstance().playEver("#jiamianSvgaBg",m,"svga_banner"),window.$("#jiamianSvgaBg").show()):(window.$(".chat-center-left").css("background","url("+h+") no-repeat 0 0").css("background-size","100% 100%"),window.$("#jiamianSvgaBg").hide());const e=t.img_head;if(""!=e){"png"==Ct.getExtension(e)?(window.$(".jiamian-room-seats").find(".jiamian-hat").attr("src",e),window.$("#bossSvgaBackground").css({background:"url("+e+") no-repeat 0 0","background-size":"100% 100%"})):Zt.getInstance().playEver("#bossSvgaBackground",e,"svga_header_king_hat")}window.$(".room-seats-main").css("background","none"),Um(s)}else if(uu.isLOLMatchRoom())window.$(".room-seats-main").html(Fi.initLOLmatchRoomSeats(t)),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"}),Hw.getInstance().initLolMatchStart();else if(uu.isHunLiRoom())window.$(".room-seats-main").html(Fi.initHunLiRoomSeats(t)),""!=m?(Zt.getInstance().playEver("#jiamianSvgaBg",m,"svga_banner"),window.$("#jiamianSvgaBg").show()):(window.$(".chat-center-left").css("background","url("+h+") no-repeat 0 0 #ccc").css("background-size","100% 100%"),window.$("#jiamianSvgaBg").hide()),window.$(".room-seats-main").css("background","none"),Um(s),""!=t.img_head&&setTimeout((function(){window.$(".room-seats-main").find(".seat-svga").each((function(){const t=window.$(this).attr("id");this.dataset.svga.endsWith(".svga")&&Zt.getInstance().playEver("#"+t,this.dataset.svga,"svga_lang_niang")}))}),300),ci.show(5,ci.type.heart),qt.get(Ot.getBlessProgress(s)).then((t=>{if(0==t.error){Sm(t.data)}})),Yv=setInterval((function(){const t=Math.floor(1e3*Math.random())%4;let e=[];for(let n=0;n<t;n++){const t=Math.floor(2*Math.random())+4,i='<img onanimationend="this.remove()" class="flyheart_'+Math.floor(1e3*Math.random())%3+" d"+t+'" style="transition-delay: '+200*n+'ms" src="https://asset.tuwan.com/chatroom/images/default_heart.png" />';e.push(i)}window.$(".room-buttons .opbutton-heart-up").append(e.join(""))}),8e3);else if(uu.isGameRoom())11435==s&&(h="https://asset.tuwan.com/chatroom/images/langrenbg.jpg?v=1"),window.$(".room-seats-main").html(Fi.initGameRoomSeats(t)),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"}),window.$(".room-seats-content").show(),Um(s);else if(uu.isJingPaiRoom())Um(s),window.$(".room-seats-main").html(Fi.initJingPaiRoomSeats(t)),window.$(".room-seats-main").css({background:"url(https://img6.tuwandata.com/uploads/jingpaibg.jpg?x-oss-process=image/format,webp/ignore-error,1) no-repeat","background-size":"cover"});else if(uu.isBattleRoom())window.$(".room-seats-main").html(Fi.initBattleRoomSeats(t)),window.$(".battle-room-content").css({background:"url("+h+") no-repeat","background-size":"cover"}),Si.getInstance().initTemplate(((t,e,n)=>{fm.giftToTeacher={uid:t,nickname:e,color:n}})),Um(s);else if(uu.isTakeMeRoom())window.$(".room-seats-main").html(Fi.initTakeMeRoomSeats(t)),Ai.getInstance().initTemplate(t),Ai.getInstance().setContext(this),Ai.getInstance().setSendGiftCb(((t,e,n,i)=>{qt.get(Ot.getGiftLists(s,this.currentTab)).then((o=>{if(0==o.error){const s=o.data.find((t=>t.price==i));window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='3']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id='3']").addClass("gift-selected"),k.currentGiftId=s.id,Km(t,e,n,1,k.currentGiftId,0)}else Vt(o.error_msg)}))})),Fi.initMainSeats(t),Um(s);else if(uu.isDrawRoom()){Um(s);const e=Le.getInstance();e.initTemplate(),e.setRoomSeats(Fi.initDrawRoomSeats(t))}else if(uu.isMarryRoom())Um(s),Ym.getInstance().loadRoomStage(t);else if(uu.isTruthRoom()){Gi.getInstance().initTemplate(t)}else if(uu.isYearCelebration())Um(s),sv.getInstance().initTemplate(t);else if(uu.isSongPkRoom())Um(s),mu.getInstance().initTemplate(t);else if(uu.isSquidGame()){Um(s);const e=bw.getInstance();e.unsubscribeRobot=Qv,e.globalAgoraClient=uu.globalRtcClient,e.showLoginWindow=du,e.initTemplate(t)}else if(uu.isGameRace())window.$(".chatroom-guanzhu").hide(),hw.getInstance().initTemplate(t);else if(uu.isH5ActiveRoom())fm.isChangeRoomUseRequest||Um(s),-1!==uu.getRoomInfo().game_custom.h5_url.indexOf("qixi2023m")&&fu.getInstance().initTemplate(t);else if(uu.isSpyActiveRoom()||uu.isCocosH5Room()||uu.isSubRoomGameType())Um(s),_s.getInstance().setRole=bm,_s.getInstance().muteLocalAudio=$m,_s.getInstance().rtcClient=uu.globalRtcClient,_s.getInstance().initTemplate(t),uu.isLive18()&&ci.show(3,ci.type.exittempteam,"离开"),window.$(".room-seats-main").css({background:"url("+h+") no-repeat","background-size":"cover"});else if(uu.isChorusRoom()){Um(s);const e=nw.getInstance();e.setRole=bm,e.showLoginWindow=du,e.initTemplate(t),wm.getInstance().clear()}else if(uu.isLangrenSmallRoom())Vw.getInstance().initTemplate(t),Vw.getInstance().leaveTempTeam=cu;else if(uu.isKtvSmallRoom()){const e=ad.getInstance();e.setRole=bm,e.showLoginWindow=du,e.initTemplate(t)}if(0==_||0==i?window.$(".chat-input-text textarea").attr("disabled",!0):window.$(".chat-input-text textarea").attr("disabled",!1),uu.isTempCarteamRoom()&&(uu.isMusicTempRoom()&&24!=uu.roomInfo.ptype||uu.isSameMusicTempRoom()||uu.isShengyouFreeRoom())&&qt.get(Ot.getTempChannelTime(uu.getCid())).then((t=>{if(0==t.error&&t.data){const e=t.data,{time:n}=e;0!=n&&ci.show(2,ci.type.countdown,n)}})),Wv.getInstance().loadRoomStage(t),0==i)return void Rd("您被禁止进入此房间",(()=>{window.location.href="https://y.tuwan.com/"}));function T(){const t=uu.getSelfInfo();(uu.isKillerFreeRoom()||uu.isKillerBattleRoom()||uu.isSpyRoom())&&(21==uu.getRoomInfo().gameid||t.vip>=y)&&ci.show(1,ci.type.createSelfWolfRoom)}window.$(".chedui-title").css("display","block"),fm.isWithoutChange?(window.$(".chat-center-message .carteamauto-item-message").css({border:"none",height:"auto",padding:"0",fontSize:"12px",color:"#999"}).text("车队已解散"),window.$(".carauto-create-mask").hide()):(window.$(".chat-center-message").html(function(t){let e=t.replace(/\r\n/g,"<br>");return e=e.replace(/\n/g,"<br>"),'<div class="chatroom-gonggao" style="color:'+(uu.isMusicTempRoom()&&24!=uu.ptype&&!uu.isLiveTempRoom()?"#ccc":"#999")+'">'+e+"</div>"}(o)),window.$(".chat-center-message").show()),e<Mt.maxUID?(window.$(".chat-input-chat-textarea textarea").attr("placeholder","说点什么..."),window.$(".chat-input-chat-textarea p").hide(),window.$("#uploadForm").removeClass("hide"),fm.isWithoutChange?(Nh(s,e,r),T()):qt.getUserInfo(e,"selflogin",!0).then((t=>{window.ysf&&qt.get(Ot.getYsfUserInfo()).then((t=>{const e=t.data;window.ysf("config",{uid:e.uid,name:e.nickname,level:e.vip,mobile:e.mobile,data:JSON.stringify([{key:"real_name",value:e.nickname,label:"名称"},{key:"user_id",value:e.uid,label:"用户UserId"},{key:"avatar",value:e.avatar,label:"头像"},{key:"identity",value:e.identity||"",label:"身份"},{key:"peerages",value:e.vipStr||"",label:"爵位"},{key:"mobile",value:e.mobile||"",label:"用户手机号"}]),language:"zh-cn"})})),bt.setSelfUser(t),fm.gloabIsBindPhone=t.mobile,window.$("#divLogin").show(),window.$("#divNoLogin").hide(),kd.loginNickname2(e,t.nickname,t.avatar,t.teacher),xm(),Dm(),jm(),function(){let t=uu.getCid();const e=uu.getSelfInfo();um.initData({channelRoomId:t,roomTypeId:zd(),nickname:e.nickname,avatar:e.avatar,sendPacketCB:function(t){var n=t.money;e.money>n&&Oh(0,n)}})}(),(t.vip>=5||136438==t.uid||$w.getInstance().inWhiteList())&&window.$(".chat-function-noani").css("display","flex"),(t.vip>0||I.includes(1*e)||u.includes(1*e)||p.includes(1*e))&&window.$(".chat-center-redpacket").css("display","flex"),1==l?window.$(".chat-center-gift").css("display","none"):window.$(".chat-center-gift").css("display","flex"),T()}))):(window.$(".chat-input-chat-textarea textarea").attr("placeholder",""),window.$(".chat-input-chat-textarea p").show(),fm.isWithoutChange?Nh(s,e,r):qt.getUserInfo(e,"selfnologin").then((t=>{bt.setSelfUser(t),window.$("#divNoLogin").show(),window.$("#divLogin").hide(),kd.loginNickname2(e),xm(),jm()}))),uu.isJiamianRoom()||uu.isHunLiRoom()||uu.isVideoTempRoom()||uu.isTakeMeRoom()?uu.isTakeMeRoom()&&(window.$(".chat-center-window").removeClass("jiamianstyle"),window.$(".chat-center-left").css("background","#fff"),window.$(".other-room-seats").css("display","block"),window.$(".jiamian-room-seats").css("display","none"),m&&Rm(m)):uu.isDrawRoom()?(h="https://asset.tuwan.com/chatroom/images/draw_room_bg.png",window.$(".room-seats-main").css("background","transparent"),window.$(".chat-center-left").css({background:"url("+h+") no-repeat 0 0 #fff","background-size":"cover"})):uu.isDrawTempRoom()?(""!=h||(h="https://img3.tuwandata.com/uploads/repayment/20210529/20210529_1622261207_19456.png"),window.$(".chat-center-left").css({background:"url("+h+") no-repeat 0 0 #fff","background-size":"cover"}),window.$(".room-seats-main").css("background","transparent")):uu.isGameTempRoom()?(""!=h&&window.$(".chat-center-left").css({background:"url("+h+") no-repeat 0 0 #fff","background-size":"cover"}),window.$(".room-seats-main").css("background","transparent")):uu.isSongTempRoom()?(window.$(".room-seats-main").css("background","none"),window.$(".chat-center-left").css({background:"url("+h+") no-repeat","background-size":"cover"}),ci.show(1,ci.type.songLeave),uu.isRoomManage(uu.getMeid())?window.$(".song-but-setting").removeClass("hide"):window.$(".song-but-setting").addClass("hide")):24!=uu.roomInfo.ptype&&(uu.isAutoRoom()||uu.isShengyouRoom()||uu.isHuodongRoom()||uu.isTempCarteamRoom()||uu.isSpyActiveRoom()||uu.isCocosH5Room())?(window.$(".other-room-seats").css("display","none"),""!=m?m.endsWith(".svga")?(Rm(m),(uu.isAutoRoom()||uu.isShengyouFreeRoom())&&window.$(".chat-center-left").css("background","#fff")):window.$(".chat-center-left").css("background","url("+m+") no-repeat 0 0 #ccc").css("background-size","100% 100%"):!uu.isMusicTempRoom()&&!uu.is1v7TempRoom()||24==uu.ptype||uu.isLiveTempRoom()?window.$(".chat-center-left").css("background","#fff"):(window.$(".room-seats-main").css("background","none"),window.$(".chat-center-left").css({background:"url("+h+") no-repeat","background-size":"cover"})),window.$(".chat-center-window").removeClass("jiamianstyle"),window.$(".jiamian-room-seats").css("display","none")):uu.isMarryRoom()?(window.$(".room-seats-main").css("background","none"),window.$(".chat-center-left").css({background:"url("+h+") no-repeat","background-size":"cover"}),m&&Rm(m)):(window.$(".chat-center-window").removeClass("jiamianstyle"),uu.is1v7TempRoom()||window.$(".chat-center-left").css("background","#fff"),window.$(".other-room-seats").css("display","block"),window.$(".jiamian-room-seats").css("display","none"),m&&Rm(m)),fm.isChangeRoomUseRequest||(Ju.getInstance().initChannelStar(s,c),Id.getInstance().initBannerList(s,(function(t){new Pw({id:t}),window.$("#active_banner").show()})),uu.isTempCarteamRoom()||ph.getInstance().initCaptain(s,e),Ld());var R;Ct.getQueryString("from")&&(R=Lt+"/mobileplay/?data=relog&uid="+e+"&format=json",(new Image).src=R);let M=r;5!=M&&null!=a&&null!=a&&(M=a);let A=as.getInstance();fm.isChangeRoomUseRequest||A.init(s,M),uu.isBattleRoom()&&A.initNewCarTeamHtml(as.getTabKeys().newcarteam),fm.isChangeRoomUseRequest||async function(){const t=kd.Type,e=uu.getCid();qt.get(Pt+"/chat/getChatv2?cid="+e+"&limit=20").then((e=>{if(0==e.error){const n=e.data;for(let e=0;e<n.length;e++){const i=n[e],o=i.uid;1==i.typeid?i.type=t.text:2==i.typeid&&(i.type=t.image),i.isRecord=!0,kd.showMessage(o,0,i,Tm())}}})).catch((t=>{}))}(),0!=fm.intervalWave&&clearInterval(fm.intervalWave);let P,j=window.$(".chat-center-main").find(".seat-item-empty[data-aposition='2'] .seat-svga");d?Zt.getInstance(window.SVGA).playLoop({ele:j[0],path:d}):j.html(""),1!=w||uu.isDrawRoom()||uu.isDrawTempRoom()||(fm.g_musiclist||(fm.g_musiclist=new Ww,fm.g_musiclist.emitter.on("clickmusic",Xv)),uu.isLive18()||ci.show(4,ci.type.musiclist)),1==r&&he&&he.swiper&&he.swiper.slideTo(2,300),async function(){const t=bt.getVoiceLog();if(t){let e=0;for(let n=0;n<t.length;n++){const{cid:i,uid:o,timer:s,time:a}=t[n];await Ed(i,o,s,a).then((t=>{"fail"==t&&e++}))}0==e&&bt.removeVoiceLog()}}(),5!=r?Xm.track(uu.getAnalyticsData("enter_room")):Xm.track(uu.getAnalyticsData("car_success")),fm.isChangeRoomUseRequest||(window.$(".chat-function-welcome").addClass("hide"),window.$(".chat-dd-welcome .chat-function-text").text(""),qt.get(Ot.checkTipsQueue(uu.getCid(),uu.roomInfo.typeid)).then((t=>{0==t.error&&(window.$(".chat-function-welcome").removeClass("hide"),1==t.data.status?window.$(".chat-dd-welcome .chat-function-text").text("迎新"):2==t.data.status&&window.$(".chat-dd-welcome .chat-function-text").text("迎新中"))}))),1==uu.roomInfo.allow_solo_fleet||9==uu.roomInfo.live?(window.$(".solo-car-tips").removeClass("hide"),9==uu.roomInfo.live&&window.$(".solo-car-tips").click()):window.$(".solo-car-tips").addClass("hide"),fm.isChangeRoomUseRequest||(Tw.getInstance().getBirthInfo(),Wi.getInstance().checkIsNew(s),uu.showBackGiftModal()),setTimeout((()=>{fm.isChangeRoomUseRequest=!1}),1e3),Zt.getInstance().preload("https://asset.tuwan.com/cphead/exploding_point_1228_new.svga"),Zt.getInstance().preload("https://activity-static.tuwan.com/static/svga/202401/08/8b1879fa4ea70171284a19b50d319444.svga"),3==uu.getRoomInfo().gameid?P=0:4==uu.getRoomInfo().gameid&&(P=1),qt.get(Ot.getKingTeamTab(s,P)).then((t=>{if(0==t.error){const{is_show:e,team_id:n}=t.data;let i=$(".zhanduiEnterBtn");i.attr("data-teamId",n),1==e?i.show():i.hide()}})),qt.get(Ot.handleReconnect(uu.getMeid())).then((t=>{if(0==t.error&&t.data&&t.data.length){const e=t.data[0],{title:n,game_position:i,cid:o}=e;2==i&&o!=uu.getCid()&&window.$.DialogByZ.Confirm({Title:"提示",Content:n,BtnL:"取消",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){window.$.DialogByZ.Close(),ou(o)}})}})),console.timeEnd("loadedRoomInfo")}function Qv(t=[]){t.forEach((t=>{pm.get(t)&&(uu.globalRtcClient.unsubscribe(pm.get(t)),pm.delete(t))}))}function Xv(t,e){const n=1*localStorage.getItem("musiclist_click")||0,i=(new Date).getTime();n?i-n>6e4?Gm(t,e,i):Vt("请"+(60-Math.ceil((i-n)/1e3))+"秒后再次点歌"):Gm(t,e,i)}let Zv,t_={5:[],6:[],7:[]};function e_(t,e){t_[t].push(e)}function n_(){let t,e,n,i=t_[5],o=t_[6],s=t_[7];if(i.length)t=i.shift(),e=5;else if(o.length)t=o.shift(),e=6;else{if(!s.length)return e="",clearInterval(Zv),void(Zv="");t=s.shift(),e=7}if(t.switch||(clearInterval(Zv),Zv="",$(".publishNoticeIcon").hide()),5==e)n=$(".noticeInitFlag.type5").clone(),n.removeClass("noticeInitFlag");else if(6==e)n=$(".noticeInitFlag.type6").clone(),n.removeClass("noticeInitFlag");else{if(7!=e)return;n=$(".noticeInitFlag.type7").clone(),n.removeClass("noticeInitFlag")}let a=document.querySelector(".chat-center-window").getBoundingClientRect(),r=a.width,c=a.y;window.$("#noticeShowContainer").css("width",`${r}px`),window.$("#noticeShowContainer").css("top",c-55+"px");const l=t.trumpet_style||"";let d="",m="",h="";l&&"object"==typeof l&&(d=l.web_background,m=l.web_head,h=l.web_tail),n.find(".title").html(t.nickname),n.find(".wordContent").html(t.content),n.find(".headerCtn .img").attr("src",t.avatar),n.addClass("animate__bounceInRight"),n.removeClass("hide"),5!=e&&6!=e||!h||n.find(".rightSmallImg").attr("src",h),d&&n.css("background-image",`url(${d})`),n.css("background-repeat","no-repeat"),n.css("background-size","100% 100%"),window.$("#noticeShowContainer").html(n),setTimeout((()=>{n.removeClass("init")}),500),Zt.getInstance().clearPlayer("notice_gold_star"),Zt.getInstance().clearPlayer("notice_head_circle"),5==e&&(Zt.getInstance().playLoop({ele:n.find(".headerSvgaCtn")[0],path:m||"https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_1.svga"},"notice_head_circle"),setTimeout((()=>{Zt.getInstance().playLoop({ele:n.find(".centerSvgaCtn")[0],path:"https://asset.tuwan.com/chartRoom/notice/sao_jin.svga"},"notice_gold_sao")}),1e3),setTimeout((()=>{Zt.getInstance().clearPlayer("notice_gold_sao")}),2300),Zt.getInstance().playLoop({ele:n.find(".rightStarSvgaCtn")[0],path:"https://asset.tuwan.com/chartRoom/notice/star_jin.svga"},"notice_gold_star")),6==e&&(Zt.getInstance().playLoop({ele:n.find(".headerSvgaCtn")[0],path:m||"https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_2.svga"},"notice_head_circle"),setTimeout((()=>{Zt.getInstance().playLoop({ele:n.find(".centerSvgaCtn")[0],path:"https://asset.tuwan.com/chartRoom/notice/sao_yin.svga"},"notice_silver_sao")}),1e3),setTimeout((()=>{Zt.getInstance().clearPlayer("notice_silver_sao")}),2300),Zt.getInstance().playLoop({ele:n.find(".rightStarSvgaCtn")[0],path:"https://asset.tuwan.com/chartRoom/notice/star_yin.svga"},"notice_silver_star")),7==e&&Zt.getInstance().playLoop({ele:n.find(".headerSvgaCtn")[0],path:m||"https://asset.tuwan.com/chartRoom/notice/noticeHeadCircle_3.svga"},"notice_head_circle"),setTimeout((()=>{n.removeClass("animate__bounceInRight"),n.addClass("animate__fadeOutLeft"),setTimeout((()=>{n.addClass("hide"),n.removeClass("animate__fadeOutLeft")}),500)}),6e3)}let i_=null;function o_(){return uu.getRoomInfo().typeid}async function s_(t){i_=await Cu();let e=Date.now();const n=kd.Type,i=_u.getInstance();sv.getInstance().dispatchNewMsg(t),Wv.getInstance().subscribe(t),Nw.getInstance().subscribe(t),Ud("info","getSocketMessage",t);const o=t.typeid;if(38==o)return uu.isSongTempRoom()&&uu.isInAnchors(uu.getMeid())?(Hd(uu.getMeid(),uu.getCid(),-1),le.getInstance().onInterruptSinging()):uu.isLiveRoom()&&uu.isAnchors2(uu.getMeid())?Hd(uu.getMeid(),uu.getCid(),-1):uu.isSongPkRoom()&&mu.getInstance().onInterruptSinging(),uu.isChorusRoom()&&(nw.getInstance().leaveSubChannel(),nw.getInstance().leaveSubChannelBgm()),uu.isKtvSmallRoom()&&ad.getInstance().onReset(!1),window.$(".chat-center-gift-content").hide(),uu.globalRtcClient.leave(),uu.globalDDSocket.leave(),uu.globalDDSocket.close(),uu.globalRtcClient.emitter.emit("unpublishSuccess",!0),i_.getInstance().destroyMusic(),window.$.DialogByZ.Confirm({Title:"提示",Content:"您的帐号在别处登录",BtnL:"1"==Rt?"退出房间":"回到首页",BtnR:"重新连接",FunL:function(){"1"!=Rt?window.location.href="/":window.open("tap-main-index")},FunR:function(){he.requestRoomInfo(uu.getCid()),window.$.DialogByZ.Close(),fm.isWithoutChange=!1,fm.isChangeRoomUseRequest=!1,xh(),Td.drop(),window.$(".autoroom-swiper-container").empty()}}),void Ai.getInstance().onInterrupt();const s=uu.getCid();if(33==o){const e=t.type;if(1==e){const e=t.data,n=e.uid;e.position;const i=e.charm;window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+n+"']").find(".seat-meili-num").text(i)}else if(2==e){if(uu.isH5ActiveRoom()||uu.isGameRace())return;1==t.data.is_update&&Id.getInstance().updateData(t.data)}else if(3==e){if(uu.isPartyGame())return;let e=0;const n=uu.getRoomInfo().party_set;if(n){const t=n.gif_uids.map((t=>1*t)),i=uu.getMeid();if(t.includes(1*i))return;e=n.gif_treasure}const i=t.data.cid;if(1==e){if(i!=s)return}else if(2==e){if(i!=s)return void vm(t)}else if(3==e)return;vm(t)}else if(4==e){const e=t.cid;if(s!=e)return;_s.getInstance().notInGame().then((()=>{ym(t)})).catch((()=>{}))}else if(5==e)_s.getInstance().notInGame().then((()=>{const e=t.data;if((uu.isH5ActiveRoom()||uu.isGameRace())&&e.teacherid!=uu.getMeid()&&e.uid!=uu.getMeid())return;if(uu.isTempCarteamRoom()&&1==e.is_gift&&e.teacherid!=uu.getMeid()&&e.uid!=uu.getMeid())return;try{uu.isQueQiaoRoom()&&null==e.is_gift&&462==e.giftid&&gu(19,{teacherid:e.teacherid,uid:e.uid})}catch(o){}let n=0;const i=uu.getRoomInfo().party_set;if(i){const t=i.gif_uids.map((t=>1*t)),e=uu.getMeid();if(t.includes(1*e))return;n=i.gif_gift}if(xt.getInstance().getGiftEffectSwithState()&&1==t.data.is_gift){if((uu.getSelfInfo().vip>=12||$w.getInstance().inWhiteList())&&![t.data.uid,t.data.teacherid].includes(uu.getMeid()))return}if(0==n)Cw(t);else if(1==n){t.data.cid==s&&Cw(t)}})).catch((()=>{}));else if(7==e);else if(8==e);else if(9==e);else if(10==e);else if(11==e)!async function(t,e){const n=uu.getChannel();uu.isTempCarteamRoom()||he.removeChannelUser(n,t);window.$(".boss-will .boss_"+t).remove(),window.$(".chat-center-message .boss_"+t).remove()}(t.data.uid);else if(12==e);else if(14==e){const e=t.data,n=e.uid,i=e.avatar;window.$(".seat-item-empty[data-uid='"+n+"']").find("img.seat-head-img").attr("src",i)}else if(15==e)kd.appendMessageTouzi(t);else if(20==e){let e=t.data||[];Array.isArray(e)||(e=[e]),as.getInstance().insertBiaobai(e);for(let i of e)i.type=n.gaobaiCard,kd.showMessage(i.byUid,0,i,o_(),t.cid)}else if(21==e){$(".chat-center-gift-content").hide();const e=t.cid;if(s!=e)return;const n=t.data;if(n&&1==n.change_voice_type)return void Fm(n.channel).then((t=>{ou(t,null,!1,!0)}));if(Zt.getInstance().clearPlayer("svga_banner"),fm.isWithoutChange=!0,uu.isJingPaiRoom(t.typeid)?window.$("#yaoqingsm").html(""):uu.isDrawRoom()&&(si.hide(".draw_game_modal"),si.hide(".draw_result_modal")),uu.isH5ActiveRoom()&&fu.getInstance().iframeId&&Ct.destroyIframe(fu.getInstance().iframeId),!uu.isLangrenSmallRoom(n.typeid,n.live)&&!uu.isGameRace(n.typeid)||window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin")||bm(0),0==n.request_webinfo){fm.isChangeRoomUseRequest=!0,uu.isH5ActiveRoom(n.typeid)&&!window.$(".chat-function-huatong").find(".chat-huatong").hasClass("chat-huatong-jin")&&bm(0);const t=c(c({},uu.getRoomInfo()),n.webinfo);uu.setRoomInfo(t),Jv(t)}else n&&n.typeid&&(uu.isSpecialSongRoom(n.typeid)||uu.isSpecialSongRoom()||uu.isCocosH5Room(n.typeid)||uu.isCocosH5Room())?ou(e):he.requestRoomInfo(e)}else if(22==e);else if(23==e){const e=t.data;let n=uu.getSelfInfo();for(let t in e)n[t]=e[t];if("nickname"in e){const t=e.nickname;window.$("#chatHeadNickname").text(e.nickname);const n=uu.getMeid();window.$(".chat-center-main").find(".seat-item-empty[data-uid='"+n+"']").find(".seat-user-name").text(t)}bt.setSelfUser(n),bs.g_isUpdateSelfInfo=!0,he.updateChannelUserInfo(uu.getChannel(),uu.getMeid(),n)}else if(25==e){if(uu.getMeid()>Mt.maxUID)return;const{h5_popup_type:e,pc_url_new:n}=t.data;if(Ju.getInstance().updateChannelStar(t.data,"push"),2==e){const t={url:n,iframeWidth:"100%",iframeHeight:"100%"};Ct.createIframe(t).then((t=>{Ju.getInstance().taskFrameId&&(window.$(`#${Ju.getInstance().taskFrameId}`).attr("src","about:blank"),window.$(`#${Ju.getInstance().taskFrameId}`).remove()),Ju.getInstance().taskFrameId=t,window.$(".common_iframe").css("display","flex")}))}}else if(26==e){const e=t.data,n=e.userInfo.uid;kd.showMessage(n,0,e)}else if(27==e){if(uu.isPartyGame())return;vm(t)}else if(28==e){const e=t.data;0!=e.stage&&i.updateStage(e),e.pre_answer_time&&(i.beginAnswer(e),gu(6,e)),i.loadSoundStageHtml(e)}else if(29==e){const e=["team","text","answer","toast","new_team","online","team_success","refresh_recommend"],n=t.data,o=n.mark;if(e.find((t=>t==o))){const t=n.status;"team"==o?(fu.getInstance().pushTeamData(n),1==t?(i.updateStage0(),gu(0,n)):gu(1,n)):"text"==o?(i.updateText(n),gu(2,n)):"answer"==o?i.updateAnsModal(n):"toast"==o?Vt(n.content):"new_team"==o?(i.activeRunningTeamedStatus(n),gu(4)):"online"==o?i.recommendOnline(n):"team_success"==o?i.recommendTeamSuccess(n):"refresh_recommend"==o&&i.refreshRecommend()}else{const e=t.data;Ko.getInstance().actSocketData(e)}}else if(30==e){const e=["start_game","team_progress","self_data","rank_data","teammate_volume_push"],n=t.data,o=n.mark;if(e.find((t=>t==o)))if("team_progress"==o)i.updateBridgeInfo(n.list);else if("rank_data"==o){const t=n.rank_list||[];i.updateRankList(t.slice(0,3))}else"self_data"==o?i.updateRankMine(n.self_data):"teammate_volume_push"==o&&i.updateVolumeProgress(n.teammate_volume,!1)}else if(31==e);else if(32==e)ph.getInstance().renderNewBossInfo(t);else if(34==e)Rd(t.data.activemsg);else if(35==e){const e=t.data;e.type=1e4,kd.showMessage(0,0,e)}else if(36==e)!function(t){const e=t.data;e.to;const n=e.thumb,i=e.image,o=e.nickname,s='<div class="flex flex-dir-col game-result-message" style="margin:10px 0;">\n                                        <div>\n                                            <span>\n                                                <img src="'+e.medal+'" style="height:20px" />\n                                            </span>\n                                            <span style="font-size:14px;color:#999">'+o+'</span>\n                                        </div>\n                                        <div style="margin-top:10px">\n                                            <img class="chat-message-image" image="'+i+'" src="'+n+'" style="height:200px" />\n                                        </div>\n\t\t\t\t\t\t\t\t\t</div>';kd.appendMessage(s)}(t);else if(37==e){const e=t.data;uu.roomInfo.party_set=e}else{if(39==e)return void async function(t){if(t.cid==uu.getCid()){const e=t.data.userinfo,n=t.data.singer_nickname,i='<div class="flex message-musicorder">\n                            <div class="message-musicorder-bg">\n                                我想听'+(""==n?"":'<span class="message-singer-nickname">'+n+"</span>的")+'<span class="message-song-name">['+t.data.song_name+"]</span>\n                            </div>\n                        </div>",o=kd._messageHtml(e,i,e.uid,0,"",0);kd.appendMessage(o)}}(t);if(40==e)!function(t){um.setHunliRed(t.cid,t.data)}(t);else if(41==e)!function(t){kd.appendHunliRedPackMessage(t.data)}(t);else if(42==e)Sm(t.data);else if(45==e)ph.getInstance().showSignModal(t.data.msg);else if(46==e)ph.getInstance().loadCaptainTask(0);else if(47==e){if("theme"==t.data.type){const e=t.data.attr.pc_img;if(uu.isHunLiRoom()||uu.isMarryRoom())return window.$(".room-seats-main").css("background","none"),void window.$(".chat-center-left").css({background:"url("+e+") no-repeat","background-size":"cover"});e.endsWith(".svga")?(window.$(".room-seats-main").css({background:"url("+iw+") no-repeat","background-size":"cover"}),Rm(e)):window.$(".room-seats-main").css("background","url("+e+") no-repeat 0 0 #ccc").css("background-size","100% 100%"),xu.getInstance().readResourceColor(e)}}else if(48==e)fh.getInstance().openAnsModal(t.data);else if(49==e)1==t.data.no_popup?Ko.getInstance().initAct(t.data.act_id):2==t.data.type&&Ku.getInstance().openBindCp(t.data);else if(51==e)Rd(t.data.message,(()=>{window.open("https://y.tuwan.com/","_self")}));else if(52==e){const{nickname:e,vip_tilte:n,user_color:i,color:o}=t.data,s=`<div class="chat-text-content">\n                            <div class="chat-center-talktext" style="color:#666;font-size:14px">\n                               恭喜 <span style="color: #FF9900">${e}</span> 晋升 <span style="color:${o}">${n}</span>\n                            </div>\n                        </div>`;kd.appendMessage(s),t.data.uid!==uu.getMeid()&&nh.getInstance().showModal(t.data,0)}else if(54==e)ci.show(2,ci.type.countdown,t.data.time);else if(55==e)cu(uu.getMeid());else if(56==e){let n=t.data;n.type=e,kd.showMessage(0,0,n),2==t.data.times&&Vt(t.data.msg)}else if(57==e)Vt(t.data.title);else if(58==e){const{content:e,jump_url:n}=t.data,i=`<div class="chat-text-content">\n                            <div>\n                                <span style="font-size:14px;color:#999">系统提示</span>\n                            </div>\n                            <div class="chat-center-talktext " style="color:#666;font-size:14px">\n                                ${e}${""==n?"":`<a style="text-decoration: none;" target="_blank" href="${n}">点击参与~</a>`}\n                            </div>\n                        </div>`;kd.appendMessage(i)}else if(60==e){if(uu.isPartyGame())return;t.data.self=100,vm(t)}else if(61==e)Rd(t.data.msg),ji.getInstance().setHide();else if(64==e){if(uu.isPartyGame())return;const{cid:e,data:n}=t,i=n.state;fm.gloabJingpaiState=i;const o=uu.getMeid(),s=window.$(".seat-item-empty[data-aposition=1]"),a=s.find(".seat-head-img");0==i?(uu.isAnchoringUser(o)&&ci.show(2,ci.type.endjingpai),window.$(".jingjia-gift-info").css("display","flex")):1==i||2==i?(uu.isAnchoringUser(o)&&ci.hide(2),window.$(".jingjia-gift-info").hide()):3==i?(uu.isAnchoringUser(o)&&ci.show(2,ci.type.endjingpai),window.$(".jingjia-gift-info").css("display","flex"),a.hide(),new Promise(((t,e)=>{let n=3;const i=window.$(".seat-item-empty[data-aposition=1]").find(".seat-hat");i.text(n).addClass("time");let o=setInterval((()=>{n--,0==n?(clearInterval(o),t()):i.text(n)}),1e3)})).then((()=>{s.find(".seat-hat").text("敬请期待").removeClass("time"),a.show()}))):(uu.isAnchoringUser(o)&&ci.hide(2),window.$(".jingjia-gift-info").hide())}else if(65==e){const e=uu.getMeid(),{content:n,id:i,uid:o,url:s,money:a}=t.data;if(window.$(".jingpai-yugao").attr("data-url",s),""==n)return;let r="",c="";uu.getBossUid()==e?(r="编辑",c="edit"):(r="查看详情",c="detail"),window.$(".chat-center-jingpai").find(".jingpai-content").html('\n            <div class="flex jingpai-ztext">\n                <p>\n                    <b>拍卖内容：</b>\n                    <span class="jingpai-text">'+n+'</span>\n                </p>\n            </div>\n            <div class="flex flex-ac jingpai-dijia"><b>拍卖底价：</b>'+a+'<img src="'+Mt.rose+'" /></div>\n            <div class="jingpai-detail" data-url="'+s+'" data-id="'+i+'" data-content="'+n+'" data-type="'+c+'">'+r+"></div>")}else if(66==e){const e='<img src="'+Mt.rose+'" />',n=t.data,i=uu.getMeid(),{state:o,msg:s,uids:a,max_num:r,less_num:c,max_uid:l,max_msg:d}=n;let m="";const h=a.find(((t,e,n)=>t.uid==i));if(0==o)m="无人出价，再送<span>"+(h?c-h.num:c)+"</span>"+e;else if(1==o)if(l==i)m=d;else{const t=h?h.num:0;m="已送<span>"+t+"</span>"+e+"，再送<span>"+(r-t+1)+"</span>"+e+"竞拍"}window.$(".jingjia-gift-info").html(m)}else if(67==e){const{cid:e,data:n}=t;uu.isBattleRoom()?Si.getInstance().playVideo(n.data.stream.url_recommend):uu.isVideoTempRoom()&&e==uu.getCid()&&(1==n.state?(Ti.getInstance().livePushState=1,Ti.getInstance().playVideo(n.stream.url_recommend)):(Ti.getInstance().livePushState=-1,Ti.getInstance().closeLive(),bm(1),window.$(".chat-huatong").removeClass("chat-huatong-jin")))}else if(68==e){const{typeid:e,defult:n,game:i,teamlist:o}=t.data;Si.getInstance()._renderBg(n),1==e||3==e?(window.$(".army_container").removeClass("hide"),window.$(".battle_container").empty(),window.$(".new-video-container").addClass("hide")):2==e&&(Si.getInstance()._renderGame(i),Si.getInstance().loadTvRoomInfo()),Si.getInstance()._renderTeamBodyHtml(o,e),Si.getInstance()._setNarrator(n,e,(()=>{fm.giftToTeacher={uid:n.narrator_uid,nickname:n.narrator_name,color:n.narrator_color}})),Si.getInstance()._setNowBattle(n)}else if(69==e)Si.getInstance()._renderGameList(t.data);else if(70==e)if(fm.isNewUser=!0,t.data.pc_url&&""!=t.data.pc_url){const e={url:t.data.pc_url,iframeWidth:t.data.iframeWidth?t.data.iframeWidth:"100%",iframeHeight:t.data.iframeHeight?t.data.iframeHeight:"100%"};Ct.createIframe(e)}else fm.isNewUser=!0,uu.showNewUserGiftModal((t=>{Wo.getInstance().getGiftTabs(uu.getCid()).then((()=>{window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='3']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id='3']").addClass("gift-selected");const t=uu.getMycarInfoForUid(uu.getMycarDuizhangUid());Km(t.uid,t.nickname,t.color,3,0,0);const e=[{id:484,title:"爱情鸟",pic:"https://img3.tuwandata.com/uploads/play2/gift/1007201630136515.png",gifpic:"https://img3.tuwandata.com/uploads/play2/gift/2741591630136515.svga",price:520,svga:"",intro:"爱你爱你\n获得52贡献值<br/>价值52钻",type:0,box_name:"",box_num:1,isShow:1,charm_score:"",uids:[{num:1}],diamond:0,attr:""}];Xe([{id:375,title:"红玫瑰",pic:"https://img3.tuwandata.com/uploads/play/1374021603954759.png",gifpic:"https://img3.tuwandata.com/uploads/play/1479051603954759.svga",price:100,svga:"",intro:"送给最爱的你\n获得10贡献值<br/>价值10钻",type:0,box_name:"",box_num:1,isShow:1,charm_score:"",uids:[{num:5}],diamond:0,attr:""}],!1),setTimeout((()=>{Xe(e,!1)}),1e3)}),(t=>{Vt(t)}))})),Xm.track(uu.getAnalyticsData("get_mengxin_gift"));else if(71==e)window.$(".new_msg_tips")[0].pause(),window.$(".new_msg_tips")[0].currentTime=0,window.$(".new_msg_tips")[0].play();else if(72==e){const e=t.data;kd.showMessage(uu.getMeid(),0,{type:58,captain_name:e.captain_name,user_name:e.user_name},o_())}else if(73==e){let e=t.data;e.type=59,kd.showMessage(uu.getMeid(),0,e,o_())}else if(74==e){let e=t.data;Ai.getInstance().onNotify(e,ou)}else if(75==e)ph.getInstance().captainGiftModal();else if(76==e){let{typeid:e,cid:n,uid:i,data:o}=t;Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",uu.roomInfo.channel),Hd(uu.getMeid(),uu.getCid(),-1),ou(o.cid),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),window.$(".yaoqing-float").css("display","none")}else if(77==e)ze.show({title:t.data.title,desc:t.data.desc.replace(/\/r\/n/g,"<br />").replace(/\r\n/g,"<br />").replace(/\n/g,"<br />")}),window.$(".chat-function-welcome").addClass("hide");else if(78==e)ou(t.cid);else if(79==e)Ym.getInstance().renderStageData(t.data);else if(80==e)uu.isSongTempRoom()?le.getInstance().setLyrics(t.data):uu.isSongPkRoom()&&mu.getInstance().setLyrics(t.data);else if(81==e)Ym.getInstance().renderSuccessModal(t.data);else if(82==e)a=t.data,Gi.getInstance().updateStatus(a);else if(83==e)!function(t){if(document.hidden)return;const e=t.data,n=e.uid,i=Ct.UUIDNOCA();let o=null,s=null;e.video_pc_url||(o=`svga_${i}`,window.$("body").append('<div id="'+o+'" class="seats-container-svga" data-type="socket33_83"></div>')),s=document.querySelector("#"+o),fv||(fv=new Zt(window.SVGA),fv.emitter.on("onplayfinished",(t=>{window.Howler&&window.Howler.unload(),window.snabbt(t.svgaele,{fromOpacity:1,opacity:0,duration:200,complete:function(){t.svgaele.remove()}})})));fv.addComin({uid:n,svgaele:s,path:e.svga_pc,attrs:e.attr,clearsAfterStop:!1})}(t);else if(84==e)!function(t){const e=kd.Type,n=t.data;n&&(n.type=e.sendGameRole,kd.showMessage(n.uid,0,n,o_(),t.cid))}(t);else if(85==e){const{content:e}=t.data,n='<div  class="chat-center-vip"> '+e+" </div>";kd.appendMessage(n)}else if(86==e){const e={url:t.data.pc_url,iframeWidth:t.data.iframeWidth?t.data.iframeWidth:"100%",iframeHeight:t.data.iframeHeight?t.data.iframeHeight:"100%"};setTimeout((()=>{Ct.createIframe(e).then((t=>{uu.isH5ActiveRoom()&&(fu.getInstance().iframeId=t)}))}),t.data.countdown)}else if(87==e)Wu.getInstance().push(t.data);else if(88==e)Vt(t.data.msg);else if(89==e)Ch(t.data.roomId,t.data.gameType);else if(90==e)mu.getInstance().updateData(t.data);else if(92==e)Sh.showInviteModal(t.data,Ch);else if(93==e)bw.getInstance().updateData(t.data);else if(102==e)bw.getInstance().gameGuessElementHtml(t.data);else if(103==e)bw.getInstance().updateElementGuessImgState(t.data);else if(94==e)Hu.getInstance().push(t.data);else if(95==e){const e=t.data;e&&e.cid==uu.getCid()&&(e.type=n.commonContent,kd.showMessage(e.uid,0,e,o_(),t.cid))}else if(96==e)t.cid==uu.getCid()&&Md("主持邀请您上麦",(()=>{Hd(uu.getMeid(),uu.getCid(),0)}),"同意","提示","拒绝");else if(98==e)bw.getInstance().updateMineData(t.data);else if(97==e)for(const e of t.data.uid_list){const n=c({},t.data);n.uid=e,Pi.getInstance().addData(n)}else if(99==e){if(t.cid==uu.getCid()){const e=t.data;if(Pd.getInstance().showMessage(e),1==e.window&&uu.getAnchoringUserId()==uu.getMeid()&&Pd.getInstance().showInstructionModal(Mm),e.chat_msg&&e.chat_msg.length){const i=uu.getRoomInfo(),o=String(uu.getMeid()),s=i.anchor_ids||[],a=i.waiter_ids||[],r=i.admin_user||[],c=i.admin_spe_user||[],l=i.manage_user||[];let d=!1;d=uu.isTempCarteamRoom()?[...r,...c,...l].map((t=>String(t))).includes(o)||1==i.is_hall_captain:[...s,...a,...r,...c,...l].map((t=>String(t))).includes(o),d&&(e.type=n.volumnRemind,kd.showMessage(e.uid,0,e,o_(),t.cid))}}}else if(100==e)as.getInstance().setV1Html(as.getTabKeys().v1team);else if(101==e){if(!window.$(".float_window_modal").is(":hidden")){let e=[];const n=uu.getMeid();window.$(".wolf_item").map(((t,n)=>{e.push(n.dataset.uid)}));const i=t.data;i.add_list.map((t=>{e.find((e=>e==t.user_info.uid))||(t.user_info.uid==n?window.$(".wolf_content").prepend(`<div class="wolf_item" data-uid="${t.user_info.uid}" >\n                         <div class="wolf_header">\n                            <img src="${t.user_info.avatar}" />\n                            <div class="mine"></div>\n                        </div>\n                         <div class="wolf_name">${t.user_info.nickname}</div></div>`):window.$(".wolf_content").append(`<div class="wolf_item" data-uid="${t.user_info.uid}" >\n                         <div class="wolf_header">\n                            <img src="${t.user_info.avatar}" />\n                        </div>\n                         <div class="wolf_name">${t.user_info.nickname}</div></div>`))})),i.remove_list.map((t=>{const e=t.user_info.uid;window.$(`.wolf_item[data-uid="${e}"]`).remove()}))}}else if(104==e){const e=t.data;hw.getInstance().update(e)}else if(108==e){const e=t.data;nw.getInstance().updateSocketData(e)}else if(106==e){let e=t.data;e.type=kd.Type.readpacket,kd.showMessage(0,0,e,o_())}else if(107==e){let e=t.data;e.redtype=0,1==e.best?e.type=kd.Type.getredmoneywang:e.type=kd.Type.getredmoney,kd.showMessage(0,0,e,o_())}else if(115==e){const e=t.data;if(e&&1==e.type_id){if(!e.is_single&&_s.getInstance().inCocosSeats(uu.getMeid()))return;_s.getInstance().updateCocosSubscribes(e.subscribe_list)}else e&&2==e.type_id&&(t.data.type=2e3,t.data.msg=e.message,function(t){2e3==t.data.type?kd.appendMessage('<div class="chatroom-draw-message"><span style="color:#EF823A">小法官:</span> '+t.data.msg+"</div>"):Le.getInstance().onGameMessage(t)}(t))}else if(117==e)ad.getInstance().updateSocketData(t.data);else if(118==e)Vt(t.data.content);else if(119==e){const e=t.data;"wheat_text_emote"==e.type&&Mu.showTextFace(e)}else if(123==e){uu.getRoomInfo().is_redpacket=t.data.show,vw.getInstance().updateThresholdValidValue()}else if(126==e)!function(t){const e=t.data,n='<div class="flex flex-dir-col game-result-message" style="margin:10px 0;">\n                                        <div>\n                                            <span style="font-size:14px;color:#999">'+e[0].text+'</span>\n                                            <span style="font-size:14px;color: '+e[1].color+'">'+e[1].text+'</span>\n                                            <span style="font-size:14px;color:#999">'+e[2].text+"</span>\n                                        </div>\n\t\t\t\t\t\t\t\t\t</div>";kd.appendMessage(n)}(t);else if(127==e)ww.getInstance().update(t.data);else if(124==e){let e=t.data.uids,n=t.data.type,i=t.data.icon||"",o=t.data.svga||"";if(i&&$(".cpContainer .cpImg")[0].src!=i){let t=new Promise(((t,e)=>{let n=new Image;n.src=i,n.onload=function(){t(1)},n.onerror=function(){t(1)}})),e=new Promise(((t,e)=>{setTimeout((()=>{t(2)}),1e3)}));await Promise.all([t,e]),Array.prototype.forEach.call($(".cpContainer .cpImg"),(t=>{t.src=i}))}await new Promise(((t,e)=>{setTimeout((()=>{t(1)}),1e3)}));let s=[],a=[];if(e&&Array.isArray(e))if(2==e.length)s=[e[0]],a=[e[1]];else if(e.length>2){let t=e.slice(0,1),i=e.slice(1);1==n?(s=i,a=t):2==n&&(s=t,a=i)}dw.triggerCpHead(s,a,o)}else if(130==e)Tu.initFn(t.data);else if(131==e)!function(t){const e=t.data;e.to;const n=e.thumb,i=e.image,o=e.nickname,s=e.medal,a=e.fid,r='<div class="flex flex-dir-col game-result-message" style="margin:10px 0;">\n                                        <div>\n                                            <span>\n                                                <img src="'+s+'" style="height:20px" />\n                                            </span>\n                                            <span style="font-size:14px;color:#999">'+o+'</span>\n                                        </div>\n                                        <div style="margin-top:10px">\n                                            <img class="chat-message-btn-image" image="'+i+'" fid='+a+' src="'+n+'" style="height:200px; cursor: pointer;" />\n                                        </div>\n\t\t\t\t\t\t\t\t\t</div>';kd.appendMessage(r)}(t);else if(134==e)!function(t){const e=t.data,n=e.content,i=e.nickname,o=e.medal,s='<div class="flex flex-dir-col game-result-message" style="margin:10px 0;">\n                                        <div>\n                                            <span>\n                                                <img src="'+o+'" style="height:20px" />\n                                            </span>\n                                            <span style="font-size:14px;color:#999">'+i+'</span>\n                                        </div>\n                                        <div style="margin-top:10px;color: #333;font-size: 14px;">\n                                           '+n+"\n                                        </div>\n\t\t\t\t\t\t\t\t\t</div>";kd.appendMessage(s)}(t);else if(132==e)console.log("132"),gw.getInstance().subscribe(t),Gw.getInstance().subscribe(t);else if(135==e){if([7,30,32,39].indexOf(uu.getRoomInfo().typeid)<0)return;!function(t){let e=t.data;if(!e.switch)return Zv&&clearInterval(Zv),Zv="",void $(".publishNoticeIcon").hide();const{trumpet_type:n}=e;e_(n,e),Zv||(Zv=setInterval((()=>{n_()}),7e3),n_())}(t)}else if(136==e){let e=$("#wishEnterCtn");5==uu.getRoomInfo().typeid?e.hide():("none"==e.css("display")&&e.show(),0==t.data.list.length&&0==t.data.prizes.length?e.attr("data-nodata",1):e.attr("data-nodata",0),e.attr("data-uid",t.data.uid),e.attr("data-cid",t.cid),bs.wishListEnterObj||(bs.wishListEnterObj=new zu({target:e[0]})),bs.wishListEnterObj.open(t.data.list,t.data.rotation_time))}}}var a;if(0!=o&&37!=o){const e=t.cid;if(s!=e)return}if(32==o){const e=t.data,n=t.uid;1==e.type&&n==uu.getMeid()&&Dm()}if(35==o)!async function(t){const e=t.data,n=e.error;if(0!=n){Rd(e.message)}}(t);else if(36==o)a_(t);else if(37==o)a_(t);else{if(8==o)return;50==o?Vt(t.data.msg):51==o?Ai.getInstance().onChangeLevel(t.data):52==o&&Ai.getInstance().onSound(t.data.typeid)}vv(t);let r=Date.now();r-e>10&&console.log("getSocketMessage exec:",r-e,t)}async function a_(t){var e,n;let i=(null==(n=null==(e=t.data)?void 0:e.teaminfo)?void 0:n.mode)||0;if(i=parseInt(i),i>0&&!uu.getRoomInfo().show_welcome_fleet)return;const o=t.uid,s=t.data;function a(){const e=kd.Type;s.to&&(!uu.isCocosH5Room()||s.type!=e.text&&s.type!=e.image)?(1==uu.roomInfo.at&&null!=s.userinfo&&(fe.getInstance().atMeUser.push({uid:s.userinfo.uid,avatar:s.userinfo.avatar,name:s.userinfo.nickname}),fe.getInstance().onActionAt2Me()),function(t,e){const n=kd.Type;Ud("info","messageInstantReceiveCB-1",e);const i=uu.getMeid(),o=uu.getCid();if(e.type==n.xiamai)Rd(e.message);else if(e.type==n.notalk)window.$(".chat-huatong").addClass("chat-huatong-jin"),bm(0),window.$(".chat-input-text textarea").attr("disabled",!0),Rd(e.message);else if(e.type==n.tiren){const t=e.pcid&&0!=e.pcid?e.pcid:o;if(null!=uu.getMycarData()){const t=null!=uu.getMycarData()&&uu.getMycarData().persons.get(i);null!=t&&1==t.position&&Bm()}ou(t,(function(){Rd(e.message)}))}else if(e.type==n.yongfeng)ou(o,(function(){Rd(e.message,(()=>{}))}));else if(e.type==n.zhiling);else if(e.type==n.zhilingcb);else if(e.type==n.baoboss);else if(e.type==n.jiebaoboss){const t=e.account;if(e.result){Cm(t,e.userinfo.platforms||1)}else Rd("老板已有其它派单服务")}else if(e.type==n.gochat)if(uu.isDrawTempRoom()||uu.isSongTempRoom()||uu.isKtvSmallRoom()){e.account;const t=e.channel,n=e.cid;uu.isAutoRoom()&&(Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",uu.getChannel())),n?ou(n):Fm(t).then((t=>{ou(t)}))}else if(uu.isTempCarteamRoom()){const t=uu.getMeid(),e=uu.getAnchorKengUser(t),n=e?e.position:-1;ci.hide(1),rv(e,n,t)}else{e.account;const t=e.channel,n=e.cid;uu.isAutoRoom()&&(Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",uu.getChannel())),n?ou(n):Fm(t).then((t=>{ou(t)}))}else if(e.type==n.norecshangmaiuids);else if(e.type==n.xiamaikeng);else if(e.type==n.paidancompleteboss);else if(e.type==n.paidancompletepeipei);else if(e.type==n.requestshangmai){if(uu.isJingPaiRoom()||uu.isMarryRoom()||uu.isSongPkRoom())return;if(vw.getInstance().anchorThresholdValid&&"1"==xt.getInstance().getUpSeatSwitch())return;var s=e.userinfo;let i=t,o=e.position,a=e.tonickname;if(e.touid&&e.touid>0&&(i=e.touid),o||(o=3),"isupdate"in s)if(uu.isHuodongRoom())km(a,i,o);else{if($("#yaoqingsm_new .limitCtn .checkCtn").hasClass("active")&&e.userinfo&&e.userinfo.vipicon&&e.userinfo.vipicon.indexOf("/0.png")>-1){let t=i;Qd(t+"",kd.messageFormat(n.responseshangmai,"0")),qd("setorder",-1,t)}else km(s.nickname,i,o)}else qt.getUserInfo(i,"requestshangmai").then((t=>{if($("#yaoqingsm_new .limitCtn .checkCtn").hasClass("active")&&t.vipicon&&t.vipicon.indexOf("/0.png")>-1){let e=kd.messageFormat(n.responseshangmai,"0"),i=t.uid;Qd(i+"",e),qd("setorder",-1,i)}else km(t.nickname,t.uid,o)}))}else if(e.type==n.responseshangmai){if(e.to==uu.getCid())1==e.result?Hd(i,uu.getCid(),0):(Rd(" 当前主持拒绝了您的上麦请求"),uu.isJiamianRoom()&&ci.timing&&ci.clearTime(),window.$(".chat-shangmai-btn").text("上麦"))}else if(e.type==n.voicechange);else if(e.type==n.agree){const t=e.url;window.location.href=t}else if(e.type==n.carteamxuanyan){const t=e.fid,n=e.text;Fi.showXuanyanText_all(t,n)}else if(e.type==n.jiesanteam){const n=e.fid,o=e.cid;tm(window.$(".carauto-teams-persons .carauto-person-item[account='"+i+"']").attr("position"),i,o,n,1),window.$(".carauto-teams-persons").attr("fid","0"),window.$(".carauto-yaoqiu-shang").text(""),window.$(".carauto-yaoqiu p").text(""),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),!function(t){return window.$(".carteam-zhuci-header[account='"+t+"']").length>0}(t)?(window.$(".yaoqing-float").css("display","none"),Rd("抱歉~  队长已解散车队")):Rd("车队已被管理员解散")}}(o,s)):kd.showMessage(o,0,s,o_(),t.cid)}s.version,uu.isTakeMeRoom()&&28==s.type||(101!=s.type||!uu.isH5ActiveRoom()&&!uu.isGameRace()||s.from==uu.getMeid()||s.touserinfo.find((t=>t.userid==uu.getMeid())))&&(_u.getInstance().pushBarrage(s),101==s.type?_s.getInstance().notInGame().then((()=>{a()})).catch((()=>{})):a())}class r_{constructor(){this.requesting=!1}static getInstance(){return this.instance||(this.instance=new r_),this.instance}onReset(){this.requesting=!1}showCreateModal(){const t=this;this.requesting=!1;const e=window.$(`\n            <div class="flex create_spy_room_mask">\n                <div class="create_spy_room_content create_spy_room_common_content">\n                    <div class="create_spy_room_close" data-type="1"></div>\n                    <div class="create_spy_room_title spy_room_title">创建房间</div>\n                    <div class="create_spy_input_content">\n                        房间名称:<input class="spy_room_name create_spy_common_input" type="text" maxlength="13" value="${uu.getSelfInfo().nickname}的专属房间"/>\n                    </div>\n                    <div class="create_spy_input_content">\n                        <span>游戏模式:</span>\n                        <select class="spy_room_mode create_spy_common_input" autocomplete="off"></select>\n                    </div>\n                    <div class="create_spy_input_content">\n                        <span>游戏人数:</span>\n                        <select class="spy_room_peoples create_spy_common_input" autocomplete="off"></select>\n                    </div>\n                    <div class="create_spy_input_content">\n                        <span>游戏门票:</span>\n                        <select class="spy_room_price create_spy_common_input" autocomplete="off"></select>\n                    </div>\n                    <div class="create_spy_room_type_btn">创建</div>\n                </div>\n            </div>\n        `);window.$("body").append(e),qt.get(Ot.getPublishUcInfo(uu.getCid())).then((n=>{if(0==n.error){let i=function(t,e){let n=null,i="";for(let o=0,s=e.length;o<s;o++){const t=e[o];1==t.selected&&(n=t.id),i+=`<option value='${t.id}'>${t.value}</option>`}t.html(i),n&&t.val(n)};const o=n.data;i(e.find(".spy_room_mode"),o.gameMode),i(e.find(".spy_room_peoples"),o.num),i(e.find(".spy_room_price"),o.gold);const s=Ct.preventQuickClick(2e3);e.on("click",".create_spy_room_type_btn",(function(n){if(n.stopPropagation(),t.requesting)return;const i=e.find(".spy_room_name").val();0!=i.length?(t.requesting=!0,s((()=>{const t=Ct.readCookie("Tuwan_Passport");uu.globalDDSocket.send("publishUc",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid,desc:i,gameMode:Number(e.find(".spy_room_mode").val()),num:Number(e.find(".spy_room_peoples").val()),gold:Number(e.find(".spy_room_price").val()),passport:t})}))):Vt("请输入房间名")}))}}))}removeCreateModal(){this.requesting=!1,window.$(".create_spy_room_mask").remove()}clearRequestingStatus(){this.requesting=!1}}const c_={1:"第一天",2:"第二天",3:"第三天",4:"第四天",5:"第五天",6:"第六天",7:"连续七天领"},l_="https://res.tuwan.com/chatroom/images/icon_wolf_signin_reward_bg.png";class d_{static getStyle(){return"\n            <style>\n                .wolfSignInModal_days .wolfSignInModal_day:nth-child(3n) {\n                    margin-right: 0 !important;\n                }\n                .wolfSignInModal_days .wolfSignInModal_day:last-child {\n                    width: 292px !important;\n                }\n                .wolfSignInModal_days .wolfSignInModal_day:nth-child(3), .wolfSignInModal_days .wolfSignInModal_day:nth-child(7) {\n                    background: #FFF5DE !important;\n                    border: 1px solid #F8D2A5 !important;\n                }\n                .wolfSignInModal_days .wolfSignInModal_day:nth-child(3) .wolfSignInModal_day_title, .wolfSignInModal_days .wolfSignInModal_day:nth-child(7) .wolfSignInModal_day_title {\n                    background: #F8D2A5 !important;\n                }\n                .wolfSignInModal_days .wolfSignInModal_day.canReceive  {\n                    background: #ED9114 !important;\n                }\n                .wolfSignInModal_days .wolfSignInModal_day.canReceive .wolfSignInModal_reward_number  {\n                    color: white !important;\n                }\n\n                .wolfSignInModal .wolfSignInModal_btn.btnDisabled {\n                    color: #957E40 !important;\n                }\n\n\n                .wolfSignInModal_rewards .wolfSignInModal_reward {\n                    margin-right: 12px;\n                }\n                .wolfSignInModal_rewards .wolfSignInModal_reward:last-child {\n                    margin-right: 0;\n                }\n                .wolfSignInModal .wolfSignInModal_days .wolfSignInModal_day:last-child .wolfSignInModal_rewards .wolfSignInModal_reward {\n                    margin-right: 30px;\n                }\n                .wolfSignInModal .wolfSignInModal_days .wolfSignInModal_day:last-child .wolfSignInModal_rewards .wolfSignInModal_reward:last-child {\n                    margin-right: 0;\n                }\n\n                .wolfSignInModal_received_rewards.scale_in {\n                    animation: common_scale_in 0.2s 1;\n                    animation-fill-mode: forwards;\n                }\n                .wolfSignInModal_received_rewards_title.scale_small {\n                    transform: scale(1) !important;\n                    transition: transform 0.2s;\n                }\n                .wolfSignInModal_received_rewards.fade_out {\n                    animation: common_fade_out 0.2s 1;\n                    animation-fill-mode: forwards;\n                }\n            </style>\n        "}static renderRewardHtml(t){return`\n            <div class="wolfSignInModal_reward" style="margin-top: 6px;">\n                <div style="width: 32px; height: 32px; background-color: #FFF5DE; border-radius: 6px; border: 1px solid #EAA26C; background-image: url('${t.icon_url}'); background-size: cover; background-repeat: no-repeat; background-position: center center;"/>\n                <p class="wolfSignInModal_reward_number" style="font-weight: 800; color: #BD4C03; line-height: 17px; font-size: 12px; text-align: center;">${t.count}</p>\n            </div>\n        `}static renderDayHtml(t){return`\n            <div class="wolfSignInModal_day day_${t.day} ${2==t.status?"canReceive":""}" style="position: relative; width: 92px; height: 80px; margin-right: 6px; margin-bottom: 6px; background: #FFECC0; border-radius: 8px; border: 1px solid #F0D699; overflow: hidden;">\n                <p class="wolfSignInModal_day_title" style="width: 100%; line-height: 22px; background: #F0D699; text-align: center; font-size: 12px; color: #B25C25;">${c_[t.day]}</p>\n                ${2==t.status?'<img style="width: 78px; height: 78px; position: absolute; left: 50%; top: 10px; transform: translate(-50%, 0);" src="https://res.tuwan.com/chatroom/images/icon_wolf_signin_light.png"/>':""}\n                <div class="wolfSignInModal_rewards flex flex-jc">\n                    ${t.gift_list.map((t=>this.renderRewardHtml(t))).join("")}\n                </div>\n                <div class="wolfSignInModal_day_received" style="display: ${1==t.status?"block":"none"}; position: absolute; left: 0; top: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.6);">\n                    <img style="position: absolute; right: 2px; bottom: 2px; width: 22px; height: 22px;" src="https://res.tuwan.com/chatroom/images/icon_wolf_signin_selected.png"/>\n                </div>\n            </div>\n        `}static checkShow(){if(uu.isKillerFreeRoom()){ci.show(4,ci.type.wolfSignIn);var t=new Date;const n=`wolf_signin_showed_${t.getFullYear()}${t.getMonth()+1}${t.getDate()}`;try{window.localStorage.getItem(n)||(this.showModal(),window.localStorage.setItem(n,1))}catch(e){}}}static showModal(){qt.get(Ot.getWolfSignInData(),"json").then((t=>{if(0==t.code){const e=t.data;if(this.html)return;const n=e.find((t=>2==t.status)),i=window.$(`\n                    <div class="wolfSignInModal flex flex-ac flex-jc" style="position: fixed; left: 0; top: 0; right: 0; bottom: 0; z-index: 99; background-color: rgba(0, 0, 0, 0.6);">\n                        ${this.getStyle()}\n                        <div style="position: relative; width: 311px; height: 386px; background-image: url('https://res.tuwan.com/chatroom/images/icon_wolf_signin_bg.png'); background-size: 100%;">\n                            <img style="position: absolute; left: 0; right: 0; top: -150px; height: 173px; z-index: -1;" src="https://res.tuwan.com/chatroom/images/icon_wolf_signin_logo.png"/>\n                            <p style="width: 174px; font-size: 20px; font-weight: 800; color: #955125; line-height: 30px; margin: auto; margin-top: 20px; text-align: center;">七日签到</p>\n                            <div class="wolfSignInModal_days flex" style="flex-wrap: wrap; padding-left: 9px; margin-top: 6px;">\n                                ${e.map((t=>this.renderDayHtml(t))).join("")}\n                            </div>\n                            <p class="wolfSignInModal_btn ${n?"":"btnDisabled"}" data-type="${n?1:0}" style="display: block; cursor: pointer; margin: auto; margin-top: 10px; width: 114px; height: 26px; line-height: 26px; background: #FFE9C9; border-radius: 4px; border: 1px solid #BFAC82; font-size: 13px; color: #725714; text-align: center;">${n?"领取":"已领取"}</p>\n                            <img class="wolfSignInModal_close" style="position: absolute; right: 15px; top: 20px; width: 16px;" src="https://res.tuwan.com/chatroom/images/icon_wolf_signin_close.png"/>\n                        </div>\n                    </div>\n                `);window.$("body").append(i),this.html=i;const o=this;i.on("click",".wolfSignInModal_close",(function(t){o.html=null,i.remove()})),i.on("click",".wolfSignInModal_btn",(function(t){1==this.dataset.type?qt.post(Ot.getWolfSignInGiftGive()).then((t=>{0==t.code?o.showReceiveRewards(t.data):Vt(t.message)})):Vt("暂没有可领取的奖励")}))}else Vt(t.message)}))}static renderReceiveRewardHtml(t,e,n){let i="0",o="0";return 4===e?([0,2].includes(n)&&(i="20px"),[2,3].includes(n)&&(o="20px")):3==e?(0===n&&(i="20px"),[0,1].includes(n)&&(o="20px")):2==e&&0===n&&(i="20px"),`\n            <div style="position: relative; margin-right: ${i}; margin-top: ${o}; width: 75px; height: 75px;">\n                <div id="wolfSignInModal_reward_svga_light_${n}" style="position: absolute; left: -15px; top: -30px; width: 100px; height: 100px;"/>\n                <p class="wolfSignInModal_reward_number wolfSignInModal_reward_number_${n}" style="display: none; margin: auto; margin-top: 55px; font-weight: 800; color: white; width: 46px; line-height: 20px; background-color: rgba(0, 0, 0, 0.3); border-radius: 20px; font-size: 14px; text-align: center;">${t.count}</p>\n            </div>\n        `}static preloadImage(t){return new Promise((function(e,n){const i=new Image;i.src=t,i.onload=e,i.onerror=n}))}static showReceiveRewards(t){this.preloadImage(l_).then((()=>{const e=window.$(`\n                <div class="wolfSignInModal_received_rewards flex flex-ac flex-jc" style="position: fixed; left: 0; top: 0; right: 0; bottom: 0; z-index: 100; display: none;">\n                    <div style="position: relative; width: 238px; height: 244px; padding: 20px 20px 0px 20px; background-image: url('${l_}'); background-size: 100%;">\n                        <p class="wolfSignInModal_received_rewards_title" style="font-size: 20px; font-weight: 600; color: #FFFFFF; text-align: center; transform: scale(1.4);">恭喜获得</p>\n                        <div class="flex flex-jc flex-ac" style="position: absolute; left: 0; top: 40px; right: 0; bottom: 0;">\n                            <div class="flex flex-jc flex-ac" style="width: 200px; flex-wrap: ${3===t.gift_list.length?"wrap-reverse":"wrap"};">\n                                ${t.gift_list.map(((e,n)=>this.renderReceiveRewardHtml(e,t.gift_list.length,n))).join("")}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `);window.$("body").append(e),Promise.all(t.gift_list.map(((t,e)=>Zt.getInstance().loadParser(`#wolfSignInModal_reward_svga_light_${e}`,t.svga_url+`?timestamp=${(new Date).valueOf()}`,1,!1,"Forward",!1)))).then((n=>{t.give_days.forEach((t=>{window.$(`.wolfSignInModal_day.day_${t}`).removeClass("canReceive"),window.$(`.wolfSignInModal_day.day_${t} .wolfSignInModal_day_received`).show()})),window.$(".wolfSignInModal .wolfSignInModal_btn").data("type",0).addClass("btnDisabled").text("已领取"),e.addClass("scale_in").show(),setTimeout((()=>{e.find(".wolfSignInModal_received_rewards_title").addClass("scale_small")}),200),n.forEach(((t,e)=>t.index=e)),3===n.length&&n.unshift(n.pop()),n.forEach((({player:t,index:n},i)=>{setTimeout((()=>{setTimeout((()=>{e.find(`.wolfSignInModal_reward_number_${n}`).show()}),100),t.startAnimation()}),100*i)})),setTimeout((()=>{e.addClass("fade_out"),setTimeout((()=>{e.remove()}),200)}),1700)}))}))}}const{console:m_}=et,h_="src/js/components/common/imgShower.svelte";function u_(t){let e,n,i,o,s,a,r,c,l,d;const m={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),s.textContent="房间对局码",a=T(),r=_("img"),y(n,"class","bgCover s-s_2nGUvIxnAy"),y(n,"role","presentation"),x(n,h_,15,8,313),y(s,"class","title s-s_2nGUvIxnAy"),x(s,h_,17,12,427),y(r,"class","codeImg s-s_2nGUvIxnAy"),y(r,"alt",""),L(r.src,c=t[0])||y(r,"src",c),y(r,"role","presentation"),x(r,h_,18,12,470),y(o,"class","imgParentCtn s-s_2nGUvIxnAy"),x(o,h_,16,8,388),y(e,"class","imgShowerSvelteCtn s-s_2nGUvIxnAy"),x(e,h_,14,4,272)},m:function(c,m){b(c,e,m),I(e,n),I(e,i),I(e,o),I(o,s),I(o,a),I(o,r),l||(d=E(n,"click",t[2],!1,!1,!1,!1),l=!0)},p:function(t,e){1&e&&!L(r.src,c=t[0])&&y(r,"src",c)},d:function(t){t&&C(e),l=!1,d()}};return p("SvelteRegisterBlock",{block:m,id:u_.name,type:"if",source:"(14:0) {#if visible && !!imgUrl}",ctx:t}),m}function p_(t){let e,n=t[1]&&!!t[0]&&u_(t);const i={c:function(){n&&n.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){n&&n.m(t,i),b(t,e,i)},p:function(t,[i]){t[1]&&t[0]?n?n.p(t,i):(n=u_(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){n&&n.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:p_.name,type:"component",source:"",ctx:t}),i}function g_(t,e,n){let{$$slots:i={},$$scope:o}=e;f("ImgShower",i,[]);let{imgUrl:s}=e;const a=t=>{console.log(t),n(0,s=t),n(1,c=!0)};let r=()=>{n(1,c=!1)},c=!1;t.$$.on_mount.push((function(){void 0!==s||"imgUrl"in e||t.$$.bound[t.$$.props.imgUrl]||m_.warn("<ImgShower> was created without expected prop 'imgUrl'")}));const l=["imgUrl"];return Object.keys(e).forEach((t=>{~l.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||m_.warn(`<ImgShower> was created with unknown prop '${t}'`)})),t.$$set=t=>{"imgUrl"in t&&n(0,s=t.imgUrl)},t.$capture_state=()=>({imgUrl:s,open:a,closeFn:r,visible:c}),t.$inject_state=t=>{"imgUrl"in t&&n(0,s=t.imgUrl),"closeFn"in t&&n(2,r=t.closeFn),"visible"in t&&n(1,c=t.visible)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[s,c,r,a]}class f_ extends h{constructor(t){super(t),u(this,t,g_,p_,g,{imgUrl:0,open:3}),p("SvelteRegisterComponent",{component:this,tagName:"ImgShower",options:t,id:p_.name})}get imgUrl(){throw new Error("<ImgShower>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set imgUrl(t){throw new Error("<ImgShower>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get open(){return this.$$.ctx[3]}set open(t){throw new Error("<ImgShower>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}let w_;function v_(){window.$(".room-buttons").on("click",".opbutton",(function(t){if(t.stopPropagation(),$(t.target).hasClass("disable"))return;const e=uu.getMeid();if(e>Mt.maxUID)return void du();const n=Wo.getInstance();switch(this.dataset.type){case"shangmai":case"shiyin":if(uu.isKtvRoom()){if(!uu.getAnchoringUserId())return void Vt("暂无主持人");Gd("setqueue",0,e),Vt("已加入队长队列"),uu.isKtvRoom()&&setTimeout((()=>{$(".opbutton.show[data-type=diandanself]").trigger("click")}),600)}else!function(t){if(uu.isInAnchors(t))return void Rd("您已经在麦上");if(uu.isJingPaiRoom())return void(ci.timing||(em(0,uu.getCid(),uu.getMeid()),ci.show(1,ci.type.daotime,"30秒")));if(uu.getAnchorKengUsers().size==uu.getRoomInfo().seats)return void Rd("当前房间麦位已满，请稍后再尝试");if(uu.isAnchors2(t)){Hd(t,uu.getCid(),0)}else{const e=uu.getAnchoringUser();if(e){const n=e.uid,i=kd.Type;Qd(n+"",kd.messageFormat(i.requestshangmai,"")),Vt("上麦请求已发送"),uu.isKtvRoom()||qd("setorder",0,t),(uu.isJiamianRoom()||uu.isHunLiRoom())&&ci.show(1,ci.type.daotime,"30秒")}else Rd("请主持上麦后再申请")}}(e);break;case"zhaoren":if(!uu.getAnchoringUserId())return void Vt("暂无主持人");qd("setorder",0,e),Vt("已加入点单队列"),uu.isKtvRoom()&&setTimeout((()=>{$(".opbutton.show[data-type=ktvdiandannum]").trigger("click")}),600);break;case"xiamai":!function(t){Hd(t,uu.getCid(),-1)}(e);break;case"diandan":!function(t){if(uu.getAnchorKengUser(t))return void Rd("请下麦位后再点单");Ct.readCookie("diandan_IsFirst")?y_():window.$.DialogByZ.Confirm({Title:"提示",Content:"您是否确定要点单？",BtnL:"考虑一下",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){y_(),Ct.setCookie("diandan_IsFirst",1),window.$.DialogByZ.Close()}})}(e);break;case"ktvdiandan":!function(t){if(uu.isInAnchors(t))return void Rd("请下麦后再点单");qd("setorder",0,t)}(e);break;case"baodang":const t=uu.getAnchoringUser();n.currentTab=0,window.$(".chat-center-gift .chat-center-gift-content").css("left","10px"),Km(t.uid,t.nickname,"#666",0,0,17);break;case"wolfSignIn":d_.showModal();break;case"ktvdiandannum":uu.isKtvRoom()&&uu.isAnchors2(e)&&$('.seat-item[data-aposition="2"]').attr("data-uid")==e?(!function(t){window.$(".channel-queuelist.sp .tabCtn.tab1").addClass("active"),window.$(".channel-queuelist.sp .tabCtn.tab2").removeClass("active"),window.$(".channel-queuelist.sp .channel-queuelist-content.list1").removeClass("hide"),window.$(".channel-queuelist.sp .channel-queuelist-content.list2").addClass("hide"),$(".channel-queuelist.sp .tabContainer").removeClass("hide");const e=window.$(".common-orderlist");uv(),pv(),"none"==e.css("display")?e.css("display","flex"):e.hide()}(),$(".BoseListShowerCtn").hide()):(gv(e),$(".channel-queuelist.sp .tabContainer").addClass("hide"));break;case"inshouhunum":gv(e);break;case"paidan":break;case"paidanover":!function(t){const e=uu.getAnchorKengUsers(),n=Array.from(e.keys());i=n.join(","),o=uu.getCid(),s={uid:i,position:-1,cid:o,state:-1,typeid:zd()},(uu.isDrawTempRoom()||uu.isDrawRoom())&&(s.subType=1),uu.globalDDSocket.send("setwheat",s);var i,o,s;let a=0,r=0;for(let c of e.values()){const t=c.position;1==t?a=c.uid:2==t&&(r=c.uid)}(new Image).src=Pt+"/Chatroom/order?format=json&uid="+a+"&hostuid="+r+"&teacherids="+n.join(",")}();break;case"creatteam":Jh(e);break;case"yaoqing":!function(t){const e=window.$(".yaoqing-float");"none"==e.css("display")?e.css("display","flex"):e.css("display","none")}();break;case"myteam":Nm(e);break;case"startteam":rv();break;case"werewolfMatch":Jm.show();break;case"jiesanteam":uu.isDrawTempRoom()&&1e3!=Le.getInstance().currSignal?Le.getInstance().showLeaveRoomConfirmModal((()=>{x_()}),"您确定要解散嘛？当前游戏尚未结束","解散"):x_();break;case"exitteam":uu.isDrawTempRoom()&&1e3!=Le.getInstance().currSignal?Le.getInstance().showLeaveRoomConfirmModal((()=>{Kh()}),"您确定要离开嘛？当前游戏尚未结束","离开"):Kh(e);break;case"exittempteam":uu.isDrawTempRoom()?1e3!=Le.getInstance().currSignal?Le.getInstance().showLeaveRoomConfirmModal((()=>{cu(uu.getMeid())}),"您确定要离开嘛？当前游戏尚未结束","离开"):null!=uu.getAnchorKengUser(uu.getMeid())&&1==uu.getAnchorKengUser(uu.getMeid()).setout?Vt("请先取消准备!"):cu(uu.getMeid()):uu.isKingTeamRoom()&&(2==uu.roomInfo.team_stage||3==uu.roomInfo.team_stage)?Vt("匹配过程中，不能离开"):cu(e);break;case"closeteam":uu.isDrawTempRoom()&&1e3!=Le.getInstance().currSignal?Le.getInstance().showLeaveRoomConfirmModal((()=>{Gh()}),"您确定要解散嘛？当前游戏尚未结束","解散"):Gh();break;case"pipei":uu.isPeaceTeamRoom()?gw.getInstance().toMatch():uu.isKingTeamRoom()&&Gw.getInstance().toMatch();break;case"peaceTeamBtn":window.$(".zhanduiEnterBtn").trigger("click");break;case"matchCodeImg":w_||(w_=new f_({target:$("#rootImgShowerCtn")[0]})),w_.open(uu.getRoomInfo().match_code);case"drawForceQuit":uu.isDrawRoom()&&1e3!=Le.getInstance().currSignal&&Le.getInstance().showLeaveRoomConfirmModal((()=>{qt.get(Ot.endGameClient(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))}),"您确定要强制结束游戏嘛？","结束");break;case"paidankefu":!function(t){const e=window.$(".common-queuelist");e.get(0).dataset.type="paidankefu",lv(),"none"==e.css("display")?e.css("display","flex"):e.hide()}();break;case"diandanself":!function(t){const e=window.$(".common-queuelist");e.get(0).dataset.type="diandanself";const n=uu.getQueueList();let i=0;for(let[o,s]of n)if(i++,o==t)break;lv(i),"none"==e.css("display")?e.css("display","flex"):e.hide()}(e);break;case"queueListManager":!function(){const t=window.$(".common-queuelist");lv(),"none"==t.css("display")?t.css("display","flex"):t.hide()}();break;case"diandananchor":break;case"daotime":!function(){if(ci.timing);}();break;case"musiclist":fm.g_musiclist&&fm.g_musiclist.show(uu.getCid());break;case"heart":!function(){window.localStorage.getItem("bossid_"+uu.roomInfo.boss_ids.join("_"))?Vt("祝福成功"):qt.get(Ot.bless(uu.getCid())).then((t=>{0==t.error&&(window.localStorage.setItem("bossid_"+uu.roomInfo.boss_ids.join("_"),"1"),Vt(t.error_msg))}));const t=Math.floor(1e3*Math.random())%3,e=window.$('<img onanimationend="this.remove()" class="flyheart_'+t+'" src="https://asset.tuwan.com/chatroom/images/default_heart.png" />');window.$(".room-buttons .opbutton-heart-up").append(e)}();break;case"jingpai":!function(){const t=uu.getAnchorKengUser(uu.getMeid());if(null!=t&&0==t.position)return void Rd("请下麦后再参与竞拍");if(0!=fm.gloabJingpaiState&&3!=fm.gloabJingpaiState)return void Rd("竞拍还未开始");const e=uu.getBossInfo();if(!e)return void Rd("竞拍人还未入座");const n=e.uid,i=e.nickname,o=e.color;fm.giftToTeacher.uid=n,fm.giftToTeacher.nickname=i,fm.giftToTeacher.color=o;const s=Wo.getInstance();uu.isJingPaiRoom()?qt.get(Ot.getPackageNum(uu.getCid())).then((t=>{const{error:e,data:a,error_msg:r}=t;if(0==e){if(a.num>0){if(window.$(".chat-center-gift-list .gifttab[data-id='3']").length>0){window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='3']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id='3']").addClass("gift-selected"),Km(n,i,o,3,s.currentGiftId,0)}else s.getGiftTabs(uu.getCid()).then((()=>{window.$(".chat-center-gift-list .gifttab").addClass("hide");window.$(".chat-center-gift-list .gifttab[data-id='3']").removeClass("hide"),window.$(".chat-center-gift-tab > div").removeClass("gift-selected"),window.$(".chat-center-gift-tab > div[data-id='3']").addClass("gift-selected"),Km(n,i,o,3,s.currentGiftId,0)}),(t=>{Vt(t)}))}else Km(n,i,o,s.currentTab,s.currentGiftId,0)}else Km(n,i,o,s.currentTab,s.currentGiftId,0)})):Km(n,i,o,s.currentTab,s.currentGiftId,0)}();break;case"endjingpai":!function(){const t=uu.getCid();qt.get(Ot.auctionEnd(t)).then((t=>{0==t.error||Rd(t.error_msg)}))}();break;case"endLive":Si.getInstance().updateLive(2);break;case"startLive":Si.getInstance().updateLive(1);break;case"shouhu":li.getInstance().joinTalk();break;case"takeme":qd("setorder",0,uu.getMeid());break;case"takemeOrder":!function(t,e=0){let n=uu.isTakeMeRoom()?"takeme":"marry";const i=window.$(`.${n}-queuelist`);hv(),lv(),window.$(`.${n}-common-orderlist`).addClass("hide"),window.$(`.${n}-queue-tab`).removeClass("active"),"none"==i.css("display")?(i.css("display","flex"),window.$(`.${n}-common-queuelist`).removeClass("hide"),window.$(`.${n}-queue-tab:eq(${e})`).addClass("active")):i.hide()}();break;case"takemenum":__();break;case"newCarModeBack":Qh();break;case"newCarModeGo":!function(){const t=uu.getMeid(),e=uu.getAnchorKengUser(t),n=e?e.position:-1;!function(t=!1,e=null){const n=uu.getMeid(),i=uu.getCid(),o=uu.getChannel();if(uu.isMyCarDuiZhang(n)||uu.isTempCarteamRoom()&&2==uu.getAnchorKengUser(uu.getMeid()).position){const s=uu.getRoomInfo().socketPort,a=t?0:uu.getMycarData().fid;qt.get(Ot.runFleet(i,a,s)).then((s=>{const a=s.error;if(0==a){const a=s.data,r=a.channel,c=a.cid;a.name;const l=a.fleetUids,d=a.live;a.typeid,1!=uu.roomInfo.new_chat_mode&&(Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",o));for(let t=0;t<l.length;t++){const e=l[t];if(e!=n){const t=kd.Type;Qd(e,kd.messageFormat(t.gochat,e,r,5,c,d))}}t?(uu.roomInfo.fleet_type=0,e.call()):(Hd(n,i,-1),ou(c),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-share").hide(),window.$(".yaoqing-float").css("display","none"))}else if(1==a)Rd("还没有队员哦"),window.$(".carauto-duizhang-exitcar").css("display","flex");else{Rd(s.error_msg)}}))}else""!=fm.mycarteamChannel?qm(0,((t,e,i)=>{t.includes(n+"")?(Ct.delCookieChannel("preCarteamChannel"),Ct.setCookie("preCarteamChannel",o),ou(i)):(fm.mycarteamChannel="",window.$(".chat-diandan-btn").hide(),Rd("您的小队已经解散"))})):Rd("抱歉,只有队长才能开车")}(!0,(()=>{uu.isGameTempRoom()&&ci.hide(0),ci.hide(2),ci.hide(3),Am(),rv(e,n,t)}))}();break;case"newCarModeLeave":cu(e);break;case"inviteByChatRoom":!function(){const t=uu.getCid();if(uu.isTempCarteamRoom())if(uu.isDrawTempRoom())Vm();else if(uu.roomInfo.seats==uu.getAnchorKengUsers().size){if(1==uu.roomInfo.fleet_type)return uu.isGameTempRoom()?void Vt("车队内队员已满"):void Vt("车队已满员，发车后再邀请吧~");if(0==uu.roomInfo.fleet_type&&uu.isGameTempRoom())return void Vt("车队内队员已满");qt.get(Ot.isVipFleet(t)).then((t=>{if(0==t.error){if(1==t.data.state)return void Vt("vip房不可邀请..");Vm()}else Vt(t.error_msg)}))}else 1==uu.roomInfo.fleet_type?Vm():qt.get(Ot.isVipFleet(t)).then((t=>{if(0==t.error){if(1==t.data.state)return void Vt("vip房不可邀请..");if(uu.isGameTempRoom())return void Vt("车队已开车..");Vm()}else Vt(t.error_msg)}));else Vm()}();break;case"catGameCreate":!function(){const t=uu.getCid();qt.get(Ot.getPublishBombCatInfo(t)).then((t=>{if(0==t.error){si.show(".catgame-create-mask","block"),window.$(".catgame-choice-mode-container").empty(),window.$(".catgame-choice-gold-container").empty();const e=t.data.gameMode,n=t.data.gold;e.map(((t,e)=>{const n=0==e?"current":"";window.$(".catgame-choice-mode-container").append('<div class="catgame-choice-item '+n+'" data-mode="'+t.id+'">'+t.value+"</div>")})),n.map(((t,e)=>{const n=0==e?"current":"";window.$(".catgame-choice-gold-container").append('<div class="catgame-choice-item '+n+'" data-gold="'+t.id+'">'+t.value+"</div>")}))}else Vt(t.error_msg)})).catch((t=>{Vt("网络错误,请稍后再试..")}))}();break;case"queueList":uu.isInAnchors(uu.getMeid())||em(0,uu.getCid(),uu.getMeid());break;case"songLeave":!function(t){null!=uu.getAnchorKengUser(t)&&1==uu.getAnchorKengUser(t).live_rec?de.getInstance().show("提示","您正在歌手位置上,您确定要离开?",!1,"取消","确认",(()=>{Aw.getInstance().onLevelSeatRecordUpload(),cu(t)})):cu(t)}(e);break;case"smallKtvLeave":!function(t){ad.getInstance().mineIsMainSong()?de.getInstance().show("提示","您正在演唱位置上，确定要离开吗？",!1,"取消","确认",(()=>{Aw.getInstance().onLevelSeatRecordUpload(),cu(t)})):cu(t)}(e);break;case"leaveConfirm":de.getInstance().show("提示","确认离开队伍?",!1,"取消","确认",(()=>{uu.isAnchoringUser(uu.getMeid())?Vd(uu.getMeid(),uu.getCid(),-1):Hd(uu.getMeid(),uu.getCid(),-1)}));break;case"marryBtn":__();break;case"sendGameRole":ov.getInstance().show();break;case"changeTemplate":Mw.getInstance().show();break;case"createSelfWolfRoom":(uu.isSpyRoom()?Sh:Yw).getInstance(Hi,Ch).initTemplate();break;case"createSpyRoom":r_.getInstance().showCreateModal();break;case"jinchanchan":Wv.getInstance().toMatch();break;case"smobaicon":Nw.getInstance().handleAction()}}))}function __(t){let e=uu.isTakeMeRoom()?"takeme":"marry";const n=window.$(`.${e}-queuelist`);hv(),lv(),window.$(`.${e}-common-orderlist`).addClass("hide"),window.$(`.${e}-queue-tab`).removeClass("active"),"none"==n.css("display")?(n.css("display","flex"),window.$(`.${e}-common-queuelist`).removeClass("hide"),window.$(`.${e}-queue-tab:eq(0)`).addClass("active")):n.hide()}function y_(){const t=uu.getSelfInfo(),e=t.nickname,n=uu.getMeid(),i=t.avatar,o=t.vipicon,s=kd.Type;Zd(kd.messageFormat(s.diandan,e,n,i,o)),window.$(".common-queuelist").attr("data-type","diandanself").css("display","flex"),em(0,uu.getCid(),n)}function x_(){Yh()}let b_=null;async function $_(t,e,n=null){let i=null,o=window.$("#selectGiftTeacher").attr("uid"),s=window.$("#selectGiftTeacher").text();const a=window.$("#selectGiftTeacher").attr("color");fm.giftToTeacher={uid:o,nickname:s,color:a};const r=uu.getMeid();if(r>Mt.maxUID)return void du();const l=Wo.getInstance(),d=window.$(".chat-center-gift-tab").find(".gift-selected").get(0).dataset.id,m=window.$(".chat-center-gift-list .gifttab[data-id='"+d+"']").find(".current");if(0==m.length)return void Rd("请选择一个礼物");const h=m.get(0).dataset;let u=h.diamond,p=h.price,g=h.id,f=h.show_type,w=h.title,v=h.pic,_=h.app_gif,y=h.worth||0,x=h.type,b=h.giftime,$=h.type,k=h.tips_type,C=h.to_uid,I=h.gifpic,S=h.video_pc_url,T=h.video_app_url,R=h.video_sound,M=h.video_type,A=1*h.question_gift;if(o==r&&(3!=d||7!=$)&&383!=g)return void Rd("自己不能送给自己礼物");if(!g)return;if(866==g&&n&&"1"==n.buttonMode)return void Vo.initFn(1);if(873==g)return void Vo.initFn(2);if("383"==g)return void l.showGoldBox();if("368"==g)return void l.showBaBaBox();if("389"==g)return void l.showPowerPack();if(16==$&&0==C)return void Vi.getInstance().showOwnerBox(g);var P=window.$("#inputGiftCount").val();if(""==P)return alert("请输入赠送的数量"),!1;if(!/(^[1-9]\d*$)/.test(P))return alert("请输入正整数"),!1;const j=uu.getSelfInfo();var D=j.diamond,L=j.number,E=j.money;let B=[],F=0,U=new Map;if(0==o){F=1;let t=[];const e=await function(){let t=[],e=new Map;if(uu.isSpyActiveRoom())return new Promise(((t,e)=>{let n=new Map;for(let[i,o]of uu.anchorUsers)n.set(i,o);_s.getInstance().getGameUsersWithUids().then((e=>{for(const t of e)n.set(t,{});t(n)})).catch((e=>{t(n)}))}));if(uu.isCocosH5Room()){let t=new Map;for(let[e,n]of uu.anchorUsers)t.set(e,n);for(const e of _s.getInstance().getCocosUsers())t.set(e,{});return t}if(uu.isKillerFreeRoom()){let t=new Map;for(let[e,n]of uu.anchorUsers)t.set(e,n);return t}if(uu.isSongPkRoom()){let t=new Map;for(var n of mu.getInstance().seatData||[])t.set(n.uid,n);return t}if(uu.isSpyRoom()||uu.isGameRace()||uu.isKtvSmallRoom())return uu.anchorUsers;if(uu.isChorusRoom()){let t=new Map;for(let[e,n]of uu.anchorUsers)2!=n.position&&3!=n.position||t.set(e,n);for(const e of nw.getInstance().getSeats())t.set(e.uid,e);return t}if(uu.isShengyouRoom()&&!uu.isShengyouFreeRoom()&&!uu.isKillerFreeRoom()&&!uu.isSpyRoom()||uu.isHuodongRoom()||uu.isTempCarteamRoom()||uu.isJiamianRoom()||uu.isHunLiRoom()||uu.isKtvRoom()||uu.isTakeMeRoom()||uu.isTruthRoom())return uu.anchorUsers;if(uu.isDrawTempRoom()||uu.isDrawRoom()||uu.isMarryRoom()||uu.isSquidGame()||uu.isH5ActiveRoom())return uu.anchorUsers;if(uu.isJingPaiRoom()){let t=new Map;for(let[e,n]of uu.anchorUsers){const i=n.position;0!=i&&1!=i&&2!=i||t.set(e,n)}return t}if(uu.isAutoRoom()||uu.isLOLMatchRoom()||uu.isGameRoom()){let t=new Map;for(let[n,i]of uu.anchorUsers)t.set(n,i);const e=uu.getInCarTeamUsers();for(let n of e.values())for(let e=0;e<n.length;e++){const i=n[e];t.set(i.uid,i)}return t}if(uu.isShengyouFreeRoom()){if(uu.getMycarData()){let t=new Map;for(let[n,i]of uu.anchorUsers)t.set(n,i);const e=uu.getMycarData();for(let n of e.persons.values())t.set(n.uid,n);return t}return uu.anchorUsers}if(uu.isYearCelebration()){let t=new Map;for(let[e,n]of uu.anchorUsers)t.set(e,n);return t}if(uu.isJiamianRoom());else if(uu.isBattleRoom()){if(uu.isBattleMainSeatNotPromise())return uu.anchorUsers;t.push(Si.getInstance().narratorUid),e.set(Si.getInstance().narratorUid,Si.getInstance().narratorName)}else if(uu.anchorUsers&&uu.anchorUsers.size>0)try{uu.anchorUsers.forEach((t=>{e.set(t.uid,t)}))}catch(i){console.log(i)}return e}();if(0==e.size&&!(3==d&&7==$||7==d&&7==$))return void Rd("现麦上无人");for(let[n,i]of e)if(n!=r){U.set(n,n),t.push(n);let e=i.color;B.push({lastGiftNum:0,lastGiftTime:"",userid:n,username:i.nickname,color:e})}if(0==B.length&&0!=e.size&&(3!=d||7!=$))return void Rd("自己不能送给自己礼物");o=t.join(",")}else U.set(o,o),B.push({lastGiftNum:0,lastGiftTime:"",userid:o,username:s,color:a});if(B.length>1){if(37==g)return void Rd("日冠不能全麦送");if(9==g)return void Rd("周冠不能全麦送");if(10==g)return void Rd("月冠不能全麦送");if(55==g)return void Rd("年冠不能全麦送")}const z=kd.Type,O={count:P,currentGiftTime:Ct.dateFormat(new Date,"-"),from:r,giftid:g,giftname:w,giftpic:v,pathpic:v,gifsrc:I,pathsvga:_,platforms:1,showtype:f,touserinfo:B,tipstype:k,gifttype:x,giftime:b,lovetypeid:-1,guardtype:-1,boxname:"",boxnum:0,type:z.giftall,price:p,video_pc_url:S,video_app_url:T,video_sound:R,video_type:M};let N=fh.getInstance();const q=uu.getCid();if(uu.getCid(),3==d||7==d){let i=function(m=0,h=!0){if(7==$){let t="";t=n&&"1"==n.buttonMode?r:o,a=!0;let e={giftid:g,num:P,cid:q,uids:t,pay_confirm:1,pay_sure:n&&n.paySure?n.paySure:0};h||(e.remind=m),l=Hi.payBoxBaoguo(e)}else{a=!1;let n={giftid:g,teacherid:o,is_whole_wheat:F,num:P,cid:q,worth:y,question_gift:A,question:e||"",open:t||0};h||(n.remind=m),l=Hi.payGiftBaoguo(n)}l.then((t=>{let e=-1;if(a?e=t.error:t.hasOwnProperty("code")?e=t.code:t.hasOwnProperty("error")&&(e=t.error),0==e){if(a){const e=p/10;7==d&&L>=e*P?Oh(0,0,e*P):D>=e*P?Oh(e*P,0):E>=p/100*P&&Oh(0,p/100*P),C_(t.data,d)}else if(7==d){const t=window.$(".chat-center-gift-list").find('.chat-center-gift-list-single[data-id="7"]').find(".chat-center-gift-item[data-id='"+g+"']");if(t.length>0){let e=t.get(0).dataset.num-P*U.size;e<=0&&866!=g?(e=0,t.remove()):(t.get(0).dataset.num=e,t.find(".baoguo-num").text("x"+e))}}else{const e=window.$(".chat-center-gift-list").find('.chat-center-gift-list-single[data-id="3"]').find(".chat-center-gift-item[data-id='"+g+"']");if(e.length>0){let t=e.get(0).dataset.num-P*U.size;t<=0?(t=0,e.remove()):(e.get(0).dataset.num=t,e.find(".baoguo-num").text("x"+t))}const n=1*t.giftinfo.is_show;O.isshow=n,Rh(z.giftall,O)}N.resetTrue()}else if(199==e);else if(-2==e&&a)Md("您的钻石和余额不足，请充值",(function(){window.open(Ot.getRechargeUrl())}),"充值");else if(-1100==e){if(n&&"2"==n.buttonMode)return void de.getInstance().show("温馨提示",t.data[0].tips,!1,"取消","确认",(()=>{$_(null,null,c({paySure:de.getInstance().choiceStatus?2:1},n))}),(()=>{}),{desAlign:"center",choiceText:t.data[0].remark,choice:"show"})}else if(-1101==e){if(n&&"2"==n.buttonMode)return void de.getInstance().show("温馨提示",`确认赠送${0==o?"给麦上所有人":" "+s+" "}吗？ `,!1,"取消","确认",(()=>{$_(null,null,c({paySure:0},n))}),(()=>{}),{desAlign:"center"})}else-1007==e&&h?de.getInstance().show("温馨提示",`${t.error_msg}?`,!1,"取消","确认",(()=>{let t=de.getInstance().choiceStatus?2:1;i(t,!1)}),(()=>{}),{desAlign:"center",choiceText:"今日不再提示",choice:"show"}):Rd(t.error_msg)}))},a=!1,l=null;i(0,!0)}else{let n=function(t,e=!1){let a=null;7==$?(s=!0,a=Hi.payBoxGift(t)):(s=!1,a=Hi.payGift(t)),a.then((t=>{const a=t.error;if(0==a){if(D>=u*P?Oh(u*P*U.size,0):E>=p/100*P&&Oh(0,p/100*P*U.size),s)C_(t.data);else{const e=1*t.giftinfo.is_show;O.isshow=e,Rh(z.giftall,O)}N.resetTrue()}else-2==a?s?Md("您的钻石和余额不足，请充值",(function(){window.open(Ot.getRechargeUrl())}),"充值"):b_||(b_=setTimeout((()=>{clearTimeout(b_),b_=null}),500),Th(o,P,g,p*U.size,O)):199==a||(-1007==a&&e?de.getInstance().show("温馨提示",`${t.error_msg}?`,!1,"取消","确认",(()=>{i.remind=de.getInstance().choiceStatus?2:1,n(i,!1)}),(()=>{}),{desAlign:"center",choiceText:"今日不再提示",choice:"show"}):Rd(t.error_msg))}))},s=!1;i={giftid:g,id:g,num:P,is_whole_wheat:F,uids:o,cid:q,question_gift:A,question:e||"",open:t||0},n(i,!0)}}function k_(t,e,n,i,o,s){const a=uu.getMeid(),r=kd.Type,c=uu.getSelfInfo();let l=c.diamond,d=c.money,m=[{lastGiftNum:0,lastGiftTime:"",userid:e,username:n,color:"#666"}];const h={count:i,currentGiftTime:Ct.dateFormat(new Date,"-"),from:a,giftid:t.id,giftname:t.title,giftpic:t.pic,pathpic:t.pic,gifsrc:t.gifpic,pathsvga:t.app_gif,platforms:1,showtype:0,touserinfo:m,tipstype:0,gifttype:t.type,giftime:t.giftime,lovetypeid:-1,guardtype:-1,boxname:"",boxnum:0,type:r.giftall,price:t.price,video_pc_url:t.video_pc_url,video_app_url:t.video_app_url,video_sound:t.video_sound,video_type:t.video_type},u=uu.getCid();let p=s||{giftid:t.id,id:t.id,num:i,uids:e,cid:u,question_gift:0,question:"",open:0};Hi.payGift(p).then((n=>{const s=n.error;if(0==s){l>=t.diamond*i?Oh(t.diamond*i*1,0):d>=t.price/100*i&&Oh(0,t.price/100*i*1);const e=1*n.giftinfo.is_show;h.isshow=e,Rh(r.giftall,h)}else-2==s?b_||(b_=setTimeout((()=>{clearTimeout(b_),b_=null}),500),Th(e,i,t.id,1*t.price,h)):Rd(n.error_msg);o&&o(n)}))}async function C_(t,e=3){if(t.length>0){1==t[0].self?function(t,e=3){Xe(t,!1,e)}(t,e):async function(t){const e=kd.Type,n=uu.getMeid();for(let i=0;i<t.length;i++){const o=t[i],s=1*o.id,a=o.title,r=o.pic,c=o.gifpic;o.price;const l=o.app_gif;o.intro;const d=o.type,m=o.show_type;o.charm_score;const h=o.uids,u=o.box_num,p=o.box_name,g=o.giftime;o.diamond;const f=o.tips_type;let w={currentGiftTime:g,giftime:g,from:n,giftid:s,giftname:a,giftpic:r,pathpic:r,gifsrc:c,pathsvga:l,platforms:"0",boxname:p,gifttype:d,lovetypeid:-1,guardtype:-1,boxnum:u,showtype:m,type:e.giftall,tipstype:f};for(let t=0;t<h.length;t++){w.count=h[t].num;let n=S_(h[t].uid);w.touserinfo=[{lastGiftNum:0,lastGiftTime:"",userid:h[t].uid,username:h[t].nickname,color:n}],Rh(e.giftall,w)}await I_(g,h.length)}}(t)}}function I_(t,e){return new Promise(((e,n)=>{setTimeout((()=>{e()}),t+300)}))}function S_(t){let e="#666";const n=bt.getUserInfo(1*t);return n&&(e=n.color||"#666"),e}let T_=[],R_=null;const M_={record(t){const e=uu.getMeid(),n=uu.getCid();if(uu.getAnchoringUserId()!==e)return void(T_=[]);let i=0;R_&&(i=R_.getVolumeLevel?R_.getVolumeLevel():100);for(var o=0;o<t.length;o++){let e=(s=t[o].level)<1?100*s:s;e>i&&(i=e)}var s;T_.push(Math.round(i)),T_.length>=5&&function(t,e){const n=T_.splice(0,5);(new Image).src=Ot.getReportVolumeV2(t,e,JSON.stringify(n))}(n,e)},setLocalAudio(t){R_=t}};let A_=[];function P_(t){const e=t.emitter;e.on("rtcInitSuccess",(function(){const e=uu.getRoomInfo(),n=e.channel,i=e.channelKey,o=e.uid,s=n;t.joinChat(i,n,o,!0,!1,s)})),e.on("initStreamed",(function(e){const n=e.id;nw.getInstance().mineIsChorus()||window.$(".chat-huatong").addClass("chat-huatong-jin");uu.isTempCarteamRoom()?uu.isLiveTempRoom()&&uu.isAnchoringUser(uu.getMeid())?(window.$(".chat-function-camera").removeClass("hide"),Mi.getInstance().checkCameraStatus(),1==uu.getAnchorKengUser(uu.getMeid()).live&&t.publishVideo()):0==uu.roomInfo.game_type&&!uu.isAdminUids(n)&&uu.isInAnchors(n)&&(window.$(".chat-huatong").removeClass("chat-huatong-jin"),bm(1)):uu.isLiveRoom()?(uu.isInAnchors(uu.getMeid())&&(1==uu.getAnchorKengUser(uu.getMeid()).live?uu.isVeRtc()?t.publishVideo():null!=t.localVideo&&t.localVideo.isPlaying||t.publishVideo():t.unpublishVideo(0)),window.$(".chat-function-camera").css("display","flex"),Mi.getInstance().checkCameraStatus()):uu.isJingPaiRoom();const i=window.localStorage.getItem("device-id");null!=i&&t.setAudioDevice(i)})),e.on("volumeIndicator",(function(t){uu.getRoomInfo();let e=[],i={},o=uu.isZegoRTC()||uu.isTRTC()?.1:25;if(M_.record(t),t.forEach((function(t,n){let s=t.uid,a=t.level;s!=uu.getMeid()&&window.$(".seat-item-empty[data-uid="+s+"]").removeClass("newUser").attr("data-speak",1),t.level>=o&&(e.push(1*s),i[1*s]=a)})),uu.isLive16AndStageNot1()){let t=$(".peaceTeam-main-container .peaceTeamListCtn .peaceListItem").length;if(t>1)for(let e=1;e<t;e++)$(`.peaceTeamListCtn .peaceListItem[data-index="${e}"]`).find(".seat-wave").hide(),$(`.peaceTeamListCtn .peaceListItem[data-index="${e}"]`).find(".seat-wave-svga").hide()}!function(t,e){const i=new Set(t),o=new Set(A_);uu.getMeid();const s=Array.from([...i,...o]).filter((t=>!i.has(t)||!o.has(t)));s.length>0&&s.forEach(((t,e,o)=>{i.has(t)||(n.find(".seat-item-empty[data-uid='"+t+"']").removeClass("speaking"),n.find(".seat-item-empty[data-player-uid='"+t+"']").removeClass("speaking"),Ei.getInstance().removeWaveSvga(t))}));uu.isSongTempRoom()&&window.$(".song-seat-songer-wrapper").removeClass("speaking");t.forEach((t=>{if(Ei.getInstance().getWaveSvgaUrl(t))n.find(".seat-item-empty[data-uid='"+t+"']").removeClass("speaking"),Ei.getInstance().addWaveSvga(t,(()=>A_.includes(t)>=0));else{Ei.getInstance().removeWaveSvga(t);const i=n.find(".seat-item-empty[data-uid='"+t+"']").addClass("speaking").removeClass("alpha20").removeClass("alpha40");if(uu.isAgoraRTC()){const n=e[1*t];n<=50?i.addClass("alpha20"):n<=60&&i.addClass("alpha40")}}if(n.find(".seat-item-empty[data-player-uid='"+t+"']").addClass("speaking"),uu.isSongTempRoom()){const e=uu.getAnchorKengUser(t);e&&1==e.live_rec&&(Ei.getInstance().getWaveSvgaUrl(t)?Ei.getInstance().addWaveSvga(t,(()=>A_.includes(t)>=0),1):window.$(".song-seat-songer-wrapper[data-uid='"+t+"']").addClass("speaking"))}})),A_=t}(e,i)})),e.on("volumeIndicatorDetection",(function(t){Pd.getInstance().onCheck(t)})),e.on("streamPublished",(function(t){const e=uu.getMeid();let i=n.find(".seat-item-empty[data-uid="+e+"]");const o=n.find(".seat-item-empty[data-player-uid="+e+"]"),s=uu.isSongPkRoom();M_.setLocalAudio(t),a=t,0!=fm.intervalWave&&(clearInterval(fm.intervalWave),fm.intervalWave=0),fm.intervalWave=setInterval((function(){(a&&a.getVolumeLevel?a.getVolumeLevel():100)>0?(s&&(i=n.find(".seat-item-empty[data-uid="+e+"]")),window.$(".chat-function-huatong .chat-huatong-jin").length?(i.removeClass("speaking"),o.removeClass("speaking")):(uu.isVeRtc()&&(Ei.getInstance().getWaveSvgaUrl()?Ei.getInstance().addWaveSvga(uu.getMeid(),(()=>0==window.$(".chat-function-huatong .chat-huatong-jin").length)):i.addClass("speaking")),uu.isTRTC()&&(Ei.getInstance().getWaveSvgaUrl(e)?Ei.getInstance().addWaveSvga(uu.getMeid(),(()=>0==window.$(".chat-function-huatong .chat-huatong-jin").length)):i.addClass("speaking")),o.addClass("speaking"),async function(t){jd||(Pd.getInstance().captainCollectStart(),jd=setInterval((function(){Ld()}),1e4),Ld())}())):uu.isKtvSmallRoom()||(i.removeClass("speaking"),o.removeClass("speaking"))}),1e3);var a})),e.on("unpublishError",(function(t){})),e.on("unpublishSuccess",(function(e){M_.setLocalAudio(null),clearInterval(fm.intervalWave),(uu.isVeRtc()||uu.isTRTC())&&(Ei.getInstance().removeWaveSvga(uu.getMeid()),window.$(".seat-item-empty[data-uid="+uu.getMeid()+"]").removeClass("speaking"),window.$(".seat-item-empty[data-player-uid="+uu.getMeid()+"]").removeClass("speaking"));Ld(),Bd(),ad.getInstance().reportMicrophoneState(2),window.$(".chat-huatong").addClass("chat-huatong-jin");for(let[n,i]of pm)uu.isInAnchors(n)||uu.isSquidGame()||(t.unsubscribe(i),pm.delete(n));for(let[n,i]of gm)uu.isInAnchors(n)||(t.unsubscribe(i),gm.delete(n))})),e.on("userPublished",(function(e,n){let o;o="string"==typeof e?parseInt(e):1*e.uid;if(5!=uu.getRoomInfo().typeid&&uu.isNormalRoom()&&!uu.isInAnchors(o)){if(0==$(`#free-team-container .seat-item-empty[data-uid="${o}"]`).length)return;{let t=$("#free-team-container .seat-item-empty");if(t&&t.length){let e=[];if(Array.prototype.forEach.call(t,(t=>{e.push($(t).data().uid)})),!(o==uu.getMeid()||e.includes(o)&&e.includes(uu.getMeid())))return}}}"1"==i&&async function(t){const e=window.$("#nowsubs");qt.getUserInfo(t,"addsub").then((t=>{const n=new Date,i=Ct.dateFormat(n,"-");e.append('<div data-account="'+t.uid+'" class="divNowC" style="margin:10px 0">\n            <div>'+i+':</div>\n            <span style="color:yellow;">'+t.uid+":"+t.nickname+'</span>\n            <button data-account="'+t.uid+'">下麦</button>\n        </div>')}))}(o);if("audio"==n){if(uu.isSpecialSongRoom()||uu.isCocosH5Room())return;if(uu.isJinChanchanRoom()&&(pm.get(o)||(pm.set(o,e),t.subscribe(e))),uu.isH5ActiveRoom()&&Number(o)>1e8)return void(uu.isTRTC()?t.subscribe("string"==typeof e?e:e.remoteStream):t.subscribe(e));if(uu.isAutoRoom()||uu.isGameRoom()||uu.isLiveRoom()||uu.isShengyouFreeRoom()||uu.isBattleRoom())Ud("info","test-auto-shangmai-4-"+o,(new Date).getTime()),uu.isInAnchors(o)?uu.isBattleRoom()?(uu.isNarratorAnchor(uu.getMeid())||uu.isBattleMainSeatNotPromise())&&(uu.isTRTC()?t.subscribe("string"==typeof e?e:e.remoteStream):t.subscribe(e)):uu.isTRTC()?t.subscribe("string"==typeof e?e:e.remoteStream):t.subscribe(e):Pm(o,e),pm.set(o,e);else{let n=function(){uu.isTRTC()?t.subscribe("string"==typeof e?e:e.remoteStream):t.subscribe(e),pm.set(o,e)};if(uu.isInAnchors(o)||bw.getInstance().isRobot(o)||Gi.getInstance().checkIsTruthRoomZeroSeat(o)||uu.isLive16AndStageNot1())if(uu.isLive16AndStageNot1()){let t=$(`.seat-item-empty[data-uid="${o}"]`).parents(".peaceListItem").data(),e=$(`.seat-item-empty[data-uid="${uu.getMeid()}"]`).parents(".peaceListItem").data();if(t&&t&&t.index==e.index){n();let t=$(".peaceTeam-main-container .peaceTeamListCtn .peaceListItem").length;if(t>1)for(let e=1;e<t;e++)$(`.peaceTeamListCtn .peaceListItem[data-index="${e}"]`).find(".seat-wave").hide(),$(`.peaceTeamListCtn .peaceListItem[data-index="${e}"]`).find(".seat-wave-svga").hide()}}else n();else if(uu.isSpyActiveRoom()){const t=uu.getRoomInfo().game_info;t&&qt.get(Ot.getGameUserList(t.fleetid)).then((t=>{0==t.error&&t.data.uids.map((t=>String(t))).includes(String(o))&&n()}))}}}else(uu.isLiveRoom()||uu.isLiveTempRoom())&&(uu.isInAnchors(o)&&t.subscribeVideo(e),gm.set(o,e))})),e.on("userUnpublished",(function(t,e){if(uu.isSpecialSongRoom()||uu.isCocosH5Room())return;uu.isTRTC()&&(Ei.getInstance().removeWaveSvga(t),window.$(".seat-item-empty[data-uid="+t+"]").removeClass("speaking"),window.$(".seat-item-empty[data-player-uid="+t+"]").removeClass("speaking"));const n=1*t.uid;uu.isLiveRoom()||(pm.delete(n),uu.isKtvRoom()?window.$(".chat-keng-teacher[account='"+n+"']").removeClass(".chat-keng-teacher-speaking"):uu.isAutoRoom()&&1==i&&window.$(".divNowC[data-account='"+n+"']").remove())})),e.on("firstaudioframedecode",(function(t){})),e.on("unmuteAudio",(function(e){if(uu.isInAnchors(e)||uu.getMycarInfoForUid(e)){const n=pm.get(1*e);n&&t.subscribe(n)}})),e.on("streamSubscribedError",(function(t){console.error("streamSubscribedErrorCallback",t)})),e.on("connectionStateChange",(function(e){if("DISCONNECTED"===e.curState&&null==t.leaveData)return})),e.on("peerLeave",(function(t){const e=t.uid;"1"==i&&window.$(".divNowC[data-account='"+e+"']").remove()}));const n=window.$(".chat-center-main"),i=Ct.getQueryString("log")}class j_{constructor(t){this.socket=null,this.urlMap=t,this.emitter=new Ht}connect(t,e,n,i){this.socket=window.io(t,{transports:["websocket","polling"]}),this.init(e,n,i)}valueType(t){return Object.prototype.toString.call(t)}init(t,e,n){let i={room:1,uid:t,time:e,token:n,ver:1,data_statistics:{platform:0}};this.socket.on("connect",(()=>{this.socket.emit("login",i)})),this.socket.on("new_msg",(t=>{const e=this.valueType(t);let n="";"[object Object]"===e?n=JSON.stringify(t):"[object String]"===e&&(n=t);let i=n;for(let[s,a]of this.urlMap)i=i.replace(new RegExp(s,"g"),a);const o=JSON.parse(i);this.emitter.emit("message",o)}))}send(t,e){e?this.socket.emit(t,e):this.socket.emit(t)}close(){this.socket.close()}leave(){this.socket.emit("disconnect",{close:1})}publishList(t){Object.prototype.hasOwnProperty.call(t,"gameid")||(t.gameid=uu.roomInfo.gameid),this.socket.emit("publishList",t)}}function D_(){F_(uu.getMycarData().fid,(t=>{const e=t.pic,n=t.title,i=t.content;!function(t){let e=[];for(let i in t)e.push(i+"="+encodeURIComponent(t[i]||""));const n="http://v.t.sina.com.cn/share/share.php?"+e.join("&");window.open(n)}({url:t.weibourl,desc:i,title:n,pic:e})}));B_(Pt+"/Report/shareClick?type=weibo")}function L_(){F_(uu.getMycarData().fid,(t=>{const e=t.pic,n=t.title,i=t.content;t.qzoneurl;!function(t){let e=[];for(let i in t)e.push(i+"="+encodeURIComponent(t[i]||""));const n="http://connect.qq.com/widget/shareqq/index.html?"+e.join("&");window.open(n)}({url:t.qqurl,desc:i,title:n,summary:i,pics:e,flash:"",site:"点点开黑官方聊天室"})}));B_(Pt+"/Report/shareClick?type=qq")}function E_(){F_(uu.getMycarData().fid,(t=>{const e=t.pic,n=t.title,i=t.content,o=t.qzoneurl;t.qqurl;!function(t){let e=[];for(let i in t)e.push(i+"="+encodeURIComponent(t[i]||""));const n="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+e.join("&");window.open(n)}({url:o,showcount:"0",desc:i,summary:i,title:n,site:"点点开黑官方聊天室",pics:e,style:"101",width:199,height:30})}));B_(Pt+"/Report/shareClick?type=qzone")}function B_(t){(new Image).src=t}function F_(t,e){qt.get(Pt+"/Chatroom/getShareInfo?format=jsonp&fid="+t).then((t=>{0==t.error&&e(t.data)}))}const{console:U_}=et,z_="src/js/components/models/carTeamSetting.svelte";function O_(t,e,n){const i=t.slice();return i[11]=e[n],i[13]=n,i}function N_(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,$,k,A,P,j,D,B=t[2];v(B);let F=[];for(let p=0;p<B.length;p+=1)F[p]=G_(O_(t,B,p));const U={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),a=M("车队设置\n            "),r=_("img"),l=T(),d=_("div"),d.textContent="车队标题",m=T(),h=_("textarea"),u=T(),g=_("div"),g.textContent="小游戏",f=T(),w=_("div");for(let t=0;t<F.length;t+=1)F[t].c();$=T(),k=_("div"),A=M("确定"),y(n,"class","bg s-fiB7aMrmuFYj"),x(n,z_,74,4,1980),y(r,"class","closeIcon s-fiB7aMrmuFYj"),L(r.src,c="https://asset.tuwan.com/chatroom/images/closeIcon_x2.png")||y(r,"src","https://asset.tuwan.com/chatroom/images/closeIcon_x2.png"),y(r,"alt",""),y(r,"role","presentation"),x(r,z_,78,12,2091),y(s,"class","title s-fiB7aMrmuFYj"),x(s,z_,76,8,2042),y(d,"class","subTitle s-fiB7aMrmuFYj"),x(d,z_,86,8,2339),y(h,"class","textCtn s-fiB7aMrmuFYj"),y(h,"placeholder","限3-15字"),x(h,z_,87,8,2380),y(g,"class","subTitle s-fiB7aMrmuFYj"),x(g,z_,88,8,2471),y(w,"class","gameList"),x(w,z_,89,8,2511),y(k,"class",P=R("confirmBtn "+(0==t[3]||t[3]?"":"disable"))+" s-fiB7aMrmuFYj"),y(k,"role","presentation"),x(k,z_,106,8,3193),y(o,"class","setContainer s-fiB7aMrmuFYj"),x(o,z_,75,4,2007),x(e,z_,73,0,1970)},m:function(c,p){b(c,e,p),I(e,n),I(e,i),I(e,o),I(o,s),I(s,a),I(s,r),I(o,l),I(o,d),I(o,m),I(o,h),J(h,t[4]),I(o,u),I(o,g),I(o,f),I(o,w);for(let t=0;t<F.length;t+=1)F[t]&&F[t].m(w,null);I(o,$),I(o,k),I(k,A),j||(D=[E(r,"click",t[0],!1,!1,!1,!1),E(h,"input",t[8]),E(k,"click",t[6],!1,!1,!1,!1)],j=!0)},p:function(t,e){if(16&e&&J(h,t[4]),44&e){let n;for(B=t[2],v(B),n=0;n<B.length;n+=1){const i=O_(t,B,n);F[n]?F[n].p(i,e):(F[n]=G_(i),F[n].c(),F[n].m(w,null))}for(;n<F.length;n+=1)F[n].d(1);F.length=B.length}8&e&&P!==(P=R("confirmBtn "+(0==t[3]||t[3]?"":"disable"))+" s-fiB7aMrmuFYj")&&y(k,"class",P)},d:function(t){t&&C(e),S(F,t),j=!1,V(D)}};return p("SvelteRegisterBlock",{block:U,id:N_.name,type:"if",source:"(73:0) {#if visible}",ctx:t}),U}function q_(t){let e;const n={c:function(){e=_("span"),e.textContent="五星",y(e,"class","star s-fiB7aMrmuFYj"),x(e,z_,97,24,2896)},m:function(t,n){b(t,e,n)},d:function(t){t&&C(e)}};return p("SvelteRegisterBlock",{block:n,id:q_.name,type:"if",source:"(97:20) {#if !item.is_unlock}",ctx:t}),n}function G_(t){let e,n,i,o,s,a,r,c=t[11].name+"",l=!t[11].is_unlock&&q_(t);function d(){return t[9](t[13])}const m={c:function(){e=_("div"),l&&l.c(),n=T(),i=M(c),o=T(),y(e,"class",s=R(`listItem ${t[11].is_unlock?"":"disable"} ${t[3]==t[13]?"active":""}`)+" s-fiB7aMrmuFYj"),y(e,"role","presentation"),x(e,z_,91,16,2594)},m:function(t,s){b(t,e,s),l&&l.m(e,null),I(e,n),I(e,i),I(e,o),a||(r=E(e,"click",d,!1,!1,!1,!1),a=!0)},p:function(o,a){(t=o)[11].is_unlock?l&&(l.d(1),l=null):l||(l=q_(t),l.c(),l.m(e,n)),4&a&&c!==(c=t[11].name+"")&&P(i,c),12&a&&s!==(s=R(`listItem ${t[11].is_unlock?"":"disable"} ${t[3]==t[13]?"active":""}`)+" s-fiB7aMrmuFYj")&&y(e,"class",s)},d:function(t){t&&C(e),l&&l.d(),a=!1,r()}};return p("SvelteRegisterBlock",{block:m,id:G_.name,type:"each",source:"(91:12) {#each listData as item, index}",ctx:t}),m}function V_(t){let e,n=t[1]&&N_(t);const i={c:function(){n&&n.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){n&&n.m(t,i),b(t,e,i)},p:function(t,[i]){t[1]?n?n.p(t,i):(n=N_(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){n&&n.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:V_.name,type:"component",source:"",ctx:t}),i}function H_(t,e,n){let{$$slots:i={},$$scope:o}=e;f("CarTeamSetting",i,[]);const s=()=>{n(1,m=!0),n(4,u=uu.getRoomInfo().title)},a=()=>{n(1,m=!1),n(3,d=null)},r=async()=>{const t=await qt.get(Ot.getSongFleetInfoNew(uu.getCid()));0==t.error&&t.data.live_list&&Array.isArray(t.data.live_list)&&n(2,h=t.data.live_list),console.log(t)};w((()=>{r()}));const c=t=>{t!=d?h[t].is_unlock&&n(3,d=t):n(3,d=null)},l=async()=>{if(!u)return void Vt("请填写车队标题");if(u.length<3||u.length>15)return void Vt("标题字数限制在3-15之间");const t={cid:uu.getCid(),room_title:u,room_live:h[d].live||"",room_live_game:h[d].live_game||""},e=await qt.post(Pt+"/chatroom/setSongFleetInfo",t);Vt(e.error_msg),0==e.error&&a(),console.log(e)};let d,m=!0,h=[],u="";const p=[];Object.keys(e).forEach((t=>{~p.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||U_.warn(`<CarTeamSetting> was created with unknown prop '${t}'`)}));return t.$capture_state=()=>({onMount:w,showTips:Vt,common:uu,request:qt,ChatUrls:Ot,yapiDomain:Pt,Utils:Ct,open:s,close:a,initListFn:r,setSelect:c,handleConfirm:l,visible:m,listData:h,currentIndex:d,titleValue:u}),t.$inject_state=t=>{"visible"in t&&n(1,m=t.visible),"listData"in t&&n(2,h=t.listData),"currentIndex"in t&&n(3,d=t.currentIndex),"titleValue"in t&&n(4,u=t.titleValue)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[a,m,h,d,u,c,l,s,function(){u=this.value,n(4,u)},t=>{c(t)}]}class W_ extends h{constructor(t){super(t),u(this,t,H_,V_,g,{open:7,close:0}),p("SvelteRegisterComponent",{component:this,tagName:"CarTeamSetting",options:t,id:V_.name})}get open(){return this.$$.ctx[7]}set open(t){throw new Error("<CarTeamSetting>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get close(){return this.$$.ctx[0]}set close(t){throw new Error("<CarTeamSetting>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const K_=function(){$("#yaoqingsm_new .limitCtn").on("click",(function(t){$(this).find(".checkCtn").hasClass("active")?$(this).find(".checkCtn").removeClass("active"):$(this).find(".checkCtn").addClass("active")})),$("#yaoqingsm_new .allClearBtn").on("click",(function(t){t.stopPropagation(),de.getInstance().show("提示","是否拒绝当前全部申请?",!1,"取消","确定",(()=>{const t=$("#yaoqingsm_new .listCtn .item");Array.prototype.forEach.call(t,(function(t){$(t).find(".reject").trigger("click")}))}),(()=>{de.getInstance().hide()}))}));let t=document.querySelector("#yaoqingsm_new .title"),e=document.querySelector("#yaoqingsm_new");t.addEventListener("mousedown",(function(t){let n=t.pageX-e.offsetLeft,i=t.pageY-e.offsetTop;function o(t){let o=t.pageX-n,s=window.innerHeight-(t.pageY-i)-e.offsetHeight,a=window.innerWidth-parseInt($("#yaoqingsm_new").css("width")),r=window.innerHeight-parseInt($("#yaoqingsm_new").css("height"));o=o<0?0:o,o=o>=a?a:o,s=s<0?0:s,s=s>=r?r:s,e.style.left=o+"px",e.style.bottom=s+"px"}document.addEventListener("mousemove",o),document.addEventListener("mouseup",(function(t){document.removeEventListener("mousemove",o)}))}))},Y_=function(){$("#partyGameSwitchBtn").on("click",(function(t){let e=$(t.currentTarget);"收起"==e.html()?($("#squidActiveIframe").hide(),e.html("展开")):"展开"==e.html()&&($(".canvassvga-fullscreen").length?($(".canvassvga-fullscreen").remove(),setTimeout((()=>{$(".canvassvga-fullscreen").remove()}),10),setTimeout((()=>{$(".canvassvga-fullscreen").remove(),$("#squidActiveIframe").show()}),600),setTimeout((()=>{$(".canvassvga-fullscreen").remove()}),800),setTimeout((()=>{$(".canvassvga-fullscreen").remove()}),1e3)):($(".canvassvga-fullscreen").remove(),$("#squidActiveIframe").show()),e.html("收起"))}))};let J_,Q_;function X_(){J_=null,Q_=null,K_(),Y_(),$(document).on("click",(function(t){t.target.className.indexOf("web_bg")>-1&&t.target.className.indexOf("svelte")>-1&&$("#wishListRootCtn").hide()})),$("#wishEnterCtn").on("click",(function(t){if(uu.getMeid()>Mt.maxUID)return;const{uid:e,cid:n,nodata:i}=t.currentTarget.dataset;let o=!1;if(e==uu.getMeid())o=!0;else{if(1==i)return void Vt("暂无心愿单");o=!1}$("#wishListRootCtn").show(),J_?(J_.$$set({isHost:o,isWeb:!0,originUid:e,originCid:n,originPlatform:0}),setTimeout((()=>{J_.open(o)}),0)):(J_=new yt({target:$("#wishListRootCtn")[0]}),J_.$$set({isHost:o,isWeb:!0,originUid:e,originCid:n,originPlatform:0}),setTimeout((()=>{J_.open(o)}),0))})),$("#mainPageCarTeamSettingBt").on("click",(function(t){$("#mainPageCarTeamSetContainer").show(),Q_||(Q_=new W_({target:$("#mainPageCarTeamSetContainer")[0]})),Q_.open()}))}function Z_(t){const e=uu.getMeid(),n=uu.getAnchoringUserId(),i=window.$(".boss-border").attr("account"),o=uu.getCid();e==n?Vd(e,o,-1):e==i?Nd(e,o,-1):uu.getAnchorKengUser(e)&&Hd(e,o,-1),xh(),window.$(".bangmask_recharge_little").css("display","none"),window.$(".yaoqing-float").css("display","none"),window.$(".carauto-share").hide(),window.$(".carauto-duizhang-exitcar").hide(),window.$(".carauto-create").text("创建车队"),window.$(".custom_emoji_list").html('<img class="empty_emoji" src="https://res.tuwan.com/templet/play/chat/chatv2/images/emptyEmoji.png">');em(-1,uu.getCid(),e),window.$.ajax({url:Bt+"/api/method/logout",dataType:"jsonp",success:function(e){Ct.delCookie("Tuwan_Passport"),Ct.delCookie("isLimited"),window.$(".captain_task").remove(),window.$("#divLogin").hide(),window.$("#divNoLogin").show(),uu.globalRtcClient.leave().then((()=>{t&&t()}))}})}const ty="src/js/components/models/noticePublish.svelte";function ey(t,e,n){const i=t.slice();return i[16]=e[n],i[18]=n,i}function ny(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f,w,$,k,R,A=(t[4][t[2]]&&t[4][t[2]].name)+"",j=t[4][t[2]].balance>0?"确认":`${t[4][t[2]].price}${t[4][t[2]].payName}`,D=t[4];v(D);let B=[];for(let p=0;p<D.length;p+=1)B[p]=iy(ey(t,D,p));const F={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=_("div"),a=M(A),r=T(),c=_("img"),d=T(),m=_("textarea"),u=T(),g=_("div");for(let t=0;t<B.length;t+=1)B[t].c();f=T(),w=_("div"),$=M(j),y(n,"class","bg s-WfdY3e_pmlT6"),y(n,"role","presentation"),x(n,ty,172,8,5659),y(c,"role","presentation"),y(c,"class","imgClose s-WfdY3e_pmlT6"),L(c.src,l="https://asset.tuwan.com/chatroom/images/learn_more_laba.png")||y(c,"src","https://asset.tuwan.com/chatroom/images/learn_more_laba.png"),y(c,"alt",""),x(c,ty,176,16,5891),y(s,"class","headerCtn s-WfdY3e_pmlT6"),x(s,ty,174,12,5771),y(m,"class","textAreaCtn scroll s-WfdY3e_pmlT6"),y(m,"placeholder",h=t[5][t[3]]),x(m,ty,191,12,6462),y(g,"class","listCtn s-WfdY3e_pmlT6"),x(g,ty,196,12,6708),y(w,"class","confirmBtn s-WfdY3e_pmlT6"),y(w,"role","presentation"),x(w,ty,205,12,7236),y(o,"class","container s-WfdY3e_pmlT6"),x(o,ty,173,8,5735),y(e,"id","noticePublishModel"),y(e,"class","s-WfdY3e_pmlT6"),x(e,ty,171,4,5621)},m:function(l,h){b(l,e,h),I(e,n),I(e,i),I(e,o),I(o,s),I(s,a),I(s,r),I(s,c),I(o,d),I(o,m),J(m,t[1]),I(o,u),I(o,g);for(let t=0;t<B.length;t+=1)B[t]&&B[t].m(g,null);I(o,f),I(o,w),I(w,$),k||(R=[E(n,"click",t[6],!1,!1,!1,!1),E(c,"click",sy,!1,!1,!1,!1),E(m,"input",t[10]),E(w,"click",t[7],!1,!1,!1,!1)],k=!0)},p:function(t,e){if(20&e&&A!==(A=(t[4][t[2]]&&t[4][t[2]].name)+"")&&P(a,A),8&e&&h!==(h=t[5][t[3]])&&y(m,"placeholder",h),2&e&&J(m,t[1]),30&e){let n;for(D=t[4],v(D),n=0;n<D.length;n+=1){const i=ey(t,D,n);B[n]?B[n].p(i,e):(B[n]=iy(i),B[n].c(),B[n].m(g,null))}for(;n<B.length;n+=1)B[n].d(1);B.length=D.length}20&e&&j!==(j=t[4][t[2]].balance>0?"确认":`${t[4][t[2]].price}${t[4][t[2]].payName}`)&&P($,j)},d:function(t){t&&C(e),S(B,t),k=!1,V(R)}};return p("SvelteRegisterBlock",{block:F,id:ny.name,type:"if",source:"(171:0) {#if visible}",ctx:t}),F}function iy(t){let e,n,i,o,s,a,r,c,l,d,m,h,u,g,f=t[16].name+"",w=t[16].balance+"";function v(){return t[11](t[18],t[16])}const $={c:function(){e=_("div"),n=_("div"),i=T(),o=_("div"),s=M(f),a=T(),r=_("div"),c=M("剩余("),l=M(w),d=M(")"),m=T(),y(n,"class","circleCtn s-WfdY3e_pmlT6"),x(n,ty,199,20,6999),y(o,"class","titleCtn s-WfdY3e_pmlT6"),x(o,ty,200,20,7049),y(r,"class","lastNumCtn"),x(r,ty,201,20,7109),y(e,"class",h=R("item "+(t[2]==t[18]?"active":""))+" s-WfdY3e_pmlT6"),y(e,"role","presentation"),x(e,ty,198,16,6801)},m:function(t,h){b(t,e,h),I(e,n),I(e,i),I(e,o),I(o,s),I(e,a),I(e,r),I(r,c),I(r,l),I(r,d),I(e,m),u||(g=E(e,"click",v,!1,!1,!1,!1),u=!0)},p:function(n,i){t=n,16&i&&f!==(f=t[16].name+"")&&P(s,f),16&i&&w!==(w=t[16].balance+"")&&P(l,w),4&i&&h!==(h=R("item "+(t[2]==t[18]?"active":""))+" s-WfdY3e_pmlT6")&&y(e,"class",h)},d:function(t){t&&C(e),u=!1,g()}};return p("SvelteRegisterBlock",{block:$,id:iy.name,type:"each",source:"(198:16) {#each trumpetListData as item, index}",ctx:t}),$}function oy(t){let e,n=t[0]&&ny(t);const i={c:function(){n&&n.c(),e=ht()},l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(t,i){n&&n.m(t,i),b(t,e,i)},p:function(t,[i]){t[0]?n?n.p(t,i):(n=ny(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:k,o:k,d:function(t){n&&n.d(t),t&&C(e)}};return p("SvelteRegisterBlock",{block:i,id:oy.name,type:"component",source:"",ctx:t}),i}function sy(){window.$.DialogByZ.Alert({Title:"提示",Content:"使用金、银喇叭时，将会由人工审核。审核未通过时，退回喇叭数量",BtnL:"确定",FunL(){window.$.DialogByZ.Close(),callback&&callback()}})}function ay(t,e,n){let{$$slots:i={},$$scope:o}=e;f("NoticePublish",i,[]),w((()=>{v()}));let{visible:s=!1}=e;function a(){n(0,s=!0)}function r(){n(0,s=!1)}const c={5:"请输入内容，所有人可见（最多30字）",6:"请输入内容，本组可见（最多30字）",7:"请输入内容，本厅可见（最多30字）"};let l,d,m,h=5,u=[],p=0,g=!1;const v=async()=>{const t=Ct.readCookie("Tuwan_Passport"),e=await qt.get(Ot.getAllBalance(t,uu.getCid()));if(0==e.error){let t=e.data.trumpet,i={};t.forEach((t=>{i[t.trumpet_type]=t})),n(4,u=[i[5],i[6],i[7]]),m=e.data.number,u.forEach(((t,e)=>{5==t.trumpet_type&&n(2,l=e)}))}else Vt(e.error_msg);n(0,s=!0),p++};function _(){n(0,s=!1)}const y=async()=>{if(g)return;if(g=!0,!d||"string"==typeof d&&!d.trim())return Vt("请填写喇叭内容"),void(g=!1);if(null==l)return Vt("请选择喇叭"),void(g=!1);const t=Ct.readCookie("Tuwan_Passport"),e=u[l].trumpet_type;if(u[l].balance>0||m>=u[l].price){let t;t=u[l].balance>0?0:4;const n=await qt.get(Ot.buyTrumpetAndPostMessage(e,t,d,uu.getCid()));return 0==n.error?(window.$.DialogByZ.Close(),r()):-2==n.error?setTimeout((()=>{window.open("https://y.tuwan.com/activity/408C813c6b#/")}),1500):v(),Vt(n.error_msg),void(g=!1)}const n=await qt.get(Ot.getPayType(t,e));g=!1,0==n.error?window.$.DialogByZ.Confirm({Title:"温馨提示",Content:`${n.data.tips}`,BtnL:"取消",BtnR:"确定",FunL(){window.$.DialogByZ.Close()},async FunR(){if(g)return;g=!0;const t=n.data.payType,i=await qt.get(Ot.buyTrumpetAndPostMessage(e,t,d,uu.getCid()));g=!1,0==i.error?(window.$.DialogByZ.Close(),r()):-2==i.error?setTimeout((()=>{window.open("https://y.tuwan.com/activity/408C813c6b#/")}),1500):v(),Vt(i.error_msg)}}):Vt(n.error_msg)},x=["visible"];Object.keys(e).forEach((t=>{~x.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<NoticePublish> was created with unknown prop '${t}'`)}));return t.$$set=t=>{"visible"in t&&n(0,s=t.visible)},t.$capture_state=()=>({onMount:w,showTips:Vt,common:uu,request:qt,ChatUrls:Ot,Utils:Ct,visible:s,open:a,close:r,tipsObj:c,itemIndex:l,placeholderIndex:h,trumpetListData:u,textAreaValue:d,forceUpdate:p,money:m,loading:g,initFn:v,handleClickBg:_,showTipsCtn:sy,handleConfirm:y}),t.$inject_state=t=>{"visible"in t&&n(0,s=t.visible),"itemIndex"in t&&n(2,l=t.itemIndex),"placeholderIndex"in t&&n(3,h=t.placeholderIndex),"trumpetListData"in t&&n(4,u=t.trumpetListData),"textAreaValue"in t&&n(1,d=t.textAreaValue),"forceUpdate"in t&&(p=t.forceUpdate),"money"in t&&(m=t.money),"loading"in t&&(g=t.loading)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{if(2&t.$$.dirty&&null!=d&&d.trim().length>30){Vt("最多输入30个字~");let t=d.trim();n(1,d=t.substr(0,30))}},[s,d,l,h,u,c,_,y,a,r,function(){d=this.value,n(1,d)},(t,e)=>{n(2,l=t),n(1,d=""),n(3,h=e.trumpet_type)}]}class ry extends h{constructor(t){super(t),u(this,t,ay,oy,g,{visible:0,open:8,close:9}),p("SvelteRegisterComponent",{component:this,tagName:"NoticePublish",options:t,id:oy.name})}get visible(){throw new Error("<NoticePublish>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set visible(t){throw new Error("<NoticePublish>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get open(){return this.$$.ctx[8]}set open(t){throw new Error("<NoticePublish>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get close(){return this.$$.ctx[9]}set close(t){throw new Error("<NoticePublish>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}let cy,ly,dy=null;async function my(){dy=await Cu(),X_();const t=document.getElementsByTagName("body")[0],e=Wo.getInstance();function n(t){var e=window.$.trim(window.$("#"+t).val());""!=e?window.open(Mt.domain+"/search/?kw="+e):alert("搜索关键字不能为空")}let i;$(".common_iframe").on("click",(function(t){t.target===this?(console.log("Clicked on #common_iframe itself"),$(".common_iframe").html(""),$(".common_iframe").css("display","none")):console.log("Clicked on a child element of #common_iframe")})),t.addEventListener("paste",(function(t){if(uu.getMeid()>Mt.maxUID)return void du();if(0==fm.gloabIsBindPhone)return fm.gloabBindPhone||(fm.gloabBindPhone=BindPhone.getInstance(window.jQuery,qt),fm.gloabBindPhone.emitter.on("success",(function(){Vt("手机绑定成功"),fm.gloabIsBindPhone=1}))),void fm.gloabBindPhone.show();const e=t.clipboardData,n=Array.from(e.items).find((t=>t.type.match(/image/)));if(n){var i=n.getAsFile(),o=new FileReader;o.addEventListener("loadend",(function(t){s(t.target.result)})),o.readAsDataURL(i)}})),window.$(".chat-center-window-main").on("mousewheel",(function(t){if(t.originalEvent.wheelDelta>0){const t=window.$(this).height(),e=this.scrollHeight;this.scrollTop+t>=e||(Mt.isUpScroll=!0)}})),window.$(".chat-center-window-main").on("scroll",(function(){const t=window.$(this).height(),e=this.scrollHeight;this.scrollTop+t>=e&&(Mt.isUpScroll=!1,window.$("#chatNewmessage").hide())})),window.$(".chat-center").on("click",".solo-car-tips",(function(t){RuleModal.show({title:"提示",desc:'\n                <p style="line-height: 20px;">1、Solo车队需要下载安装<a style="color: #3485FF" href="https://apk.tuwan.com/app/game/release/GameDataCapture.exe" target="_blank">LOL助手软件</a>，未使用者不计胜负</p>\n                <p style="line-height: 20px;">2、先拿到一血或一塔或补一百兵者胜</p>\n                <p style="line-height: 20px;">3、LOL助手自动判断胜负</p>\n                <p style="line-height: 20px;">4、胜者将获得100贡献值、负者获得50贡献值，每人限900贡献值/天</p>\n                <p style="line-height: 20px;">5、每自然周末0点清除排名，重新计胜负数</p>\n                <p style="line-height: 20px;">6、相同两人Solo，贡献值和胜负数每日只计前3场</p>\n            '})})),window.$(".publishNoticeIcon").on("click",(function(){if(uu.getMeid()>Mt.maxUID)return void du();const t=$("#noticePublishContainer")[0];new ry({target:t})})),window.$(".room-seats-content").on("click",".kingTeamWaitToStartTimerCtnFlexCtn .leaveBtn",(function(t){t.stopPropagation(),window.$.DialogByZ.Confirm({Title:"温馨提示",Content:"\n                <div>\n                    强行离开会影响匹配时间，您确定要离开吗?\n                </div>\n            ",BtnL:"取消",BtnR:"确定退出",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){qt.get(Ot.ChartRoomUnMatch(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg),window.$.DialogByZ.Close()})).catch((t=>{Vt("网络错误请稍后再试..")}))}})})),window.$(".room-seats-content").on("click",".kingTeamWaitToStartTimerCtnFlexCtn .title",(function(t){t.stopPropagation(),qt.get(Ot.ChartRoomStartGame(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))})),window.$(".room-seats-content").on("click",".kingTeamWaitToStartTimerCtn .title",(function(t){t.stopPropagation(),qt.get(Ot.ChartRoomUnMatch(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))})),window.$(".room-seats-content").on("click",".peaceTeam-main-container .leaveBtn",(function(t){t.stopPropagation(),window.$.DialogByZ.Confirm({Title:"温馨提示",Content:"\n                <div>\n                    您确定要离开吗?\n                </div>\n            ",BtnL:"取消",BtnR:"确定离开",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){qt.get(Ot.PeaceTeamLeaveTeam(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg),window.$.DialogByZ.Close()})).catch((t=>{Vt("网络错误请稍后再试..")}))}})})),window.$(".room-seats-content").on("click",".peaceTeam-main-container .readyStatusBtn",(function(t){$(".peaceTeamMatchBottomCtn .leftBtn").removeClass("leaveBtn"),$(".peaceTeamMatchBottomCtn .leftBtn").addClass("opt5"),t.stopPropagation(),qt.get(Ot.PeaceTeamPrepare(uu.getCid())).then((t=>{0!=t.error&&Vt(t.error_msg)})).catch((t=>{Vt("网络错误请稍后再试..")}))})),window.$(".chat-dd-kefu").on("click",(function(t){t.stopPropagation(),Mm()})),window.$(".chat-function-huatong").on("click",(async function(){const t=window.$(this).find(".chat-huatong"),e=t.hasClass("chat-huatong-jin");this.dataset.init;const n=uu.getMeid();if(uu.isLive16AndStageNot1())e?(t.removeClass("chat-huatong-jin"),bm(1)):(t.addClass("chat-huatong-jin"),bm(0));else if(n>Mt.maxUID&&(uu.isShengyouRoom()||uu.isHuodongRoom()||uu.isTruthRoom()))du();else if(!nw.getInstance().huatongCheckChorus())if(uu.isInAnchors(n)||uu.myCarInfo||Gi.getInstance().checkIsTruthRoomZeroSeat()||uu.isCocosH5Room()&&_s.getInstance().inCocosGame())if(uu.isInAnchors(n)&&uu.isTakeMeRoom()&&-1==uu.getAnchorKengUser(n).light)Vt("灭灯后不能再开麦哦..");else if(e){if(dy.getInstance().publishTracks(!0),uu.isVideoTempRoom()&&1==Ti.getInstance().livePushState)return;if(window.$(".seat-item-empty[data-uid="+n+"]").removeClass("newUser"),t.removeClass("chat-huatong-jin"),ad.getInstance().reportMicrophoneState(1),uu.isInAnchors(n)||uu.myCarInfo||Gi.getInstance().checkIsTruthRoomZeroSeat()||uu.isCocosH5Room()&&_s.getInstance().inCocosGame()){if(Cd.getInstance().needUnMuteCustomTrack())return;nw.getInstance().checkAnchorCanDisposeMicrophone(!0)||ad.getInstance().checkAnchorCanDisposeMicrophone(!0)||(bm(1),ad.getInstance().setLoadVolemeValue())}}else{if(dy.getInstance().unpublishTracks(),Ld(),Bd(),t.addClass("chat-huatong-jin"),ad.getInstance().reportMicrophoneState(2),Cd.getInstance().needMuteCustomTrack())return;nw.getInstance().checkAnchorCanDisposeMicrophone(!1)||ad.getInstance().checkAnchorCanDisposeMicrophone(!1)||bm(0),Pd.getInstance().closeTip()}else Vt("请上麦后再开麦")})),Ye.publishBombCat=Wd,document.querySelector(".chat-center-window-main").oncontextmenu=function(t){t.preventDefault()},window.$(".chat-input-btn-send").on("click",(function(){window.$("#at-user-container").hide(),Lh()})),window.$(".chat-center").bind("keyup",".chat-input-text .full-input-text textarea",(function(t){"13"==t.keyCode&&(Ti.getInstance().getFullScreenStatus()||Si.getInstance().getFullScreenStatus()||Mi.getInstance().getFullScreenStatus())&&Lh()})),window.$(".chat-input-text textarea").bind("keyup",(function(t){const e=fe.getInstance();t.keyCode,1==uu.roomInfo.at&&window.$(".chat-input-text textarea").is(":focus")&&e.onInputLinster(t,this.value),"13"==t.keyCode&&window.$("#at-user-container").is(":hidden")&&(Lh(),e.clearAtUser())})),window.$(".chat-input-camer").on("change","input[type='file']",(function(){if(!(uu.getMeid()>Mt.maxUID))return 0==fm.gloabIsBindPhone?(fm.gloabBindPhone||(fm.gloabBindPhone=BindPhone.getInstance(window.jQuery,qt),fm.gloabBindPhone.emitter.on("success",(function(){Vt("手机绑定成功"),fm.gloabIsBindPhone=1}))),void fm.gloabBindPhone.show()):void(0!=uu.getRoomInfo().speaking&&0!=uu.getRoomInfo().access&&Ct.uploadImage(document.getElementById("chatFileUploadImage"),(function(t){s(t)})));du()})),window.$(".chat-center-message").on("click",".chat-message-image",(function(){!function(t){window.$.fancybox.open([{src:t}],{loop:!1,toolbar:"auto",buttons:["close"],image:{preload:!0},defaultType:"fade",type:"image"}),1==_client&&window.$(".fancybox-toolbar").css({top:"50px",right:"30px"})}(window.$(this).attr("image"))})),window.$(".chat-center-message").on("click",".chat-message-btn-image",(function(){qh(window.$(this).attr("fid"),1)})),window.$(".chat-center-message").on("mousedown",".chat-center-talktext",(function(t){const e=uu.getMeid(),n=this.dataset.uid||-1,i=this.dataset.type,o=this.dataset;let s="";if(Object.hasOwnProperty.call(o,"uniqid")&&(s=o.uniqid),2==t.button){let o=$(".context_menu_btn");0!==o.length&&o.remove();const a=t.offsetX;let r=t.offsetY+5;$(this).parent().parent().children().length==$(this).parent().index()+1&&(r=-12);const c=$(this).attr("id"),l=decodeURIComponent($(this).text());let d=1==i?`<div  class="copymsg" data-text=${l}> 复制消息</div>`:"";if(uu.isAnchors2(e)||uu.isManagers(e)||e==n||uu.isAdminUids(e)){const t=this.dataset.deleted;if(c&&!t){const t=1==e[0].dataset.ispay,e=$(this).find(".chat-message-image");let n='<div class="context_menu_btn" style="top:'+r+"px; left:"+(a+10)+`px;">\n                                        ${d}\n                                        <div data-msgid="`+c+'" data-uniqid="'+s+`" class="deletemsg" >撤回消息</div>\n                                        ${e.length&&t?"":`<div class="add_custom" style="display:${2==i?"block":"none"}">添加表情</div>`}\n                                    </div>`;$(this).append(n)}}else{if(0==e||e>Mt.maxUID)return;if(2==i){const t=$(this).find(".chat-message-image");if(t.length&&1==t[0].dataset.ispay)return;let e='<div class="context_menu_btn" style="top:'+r+"px; left:"+(a+10)+`px;">\n                                        ${d}\n                                        <div class="add_custom">添加表情</div>\n                                    </div>`;$(this).append(e)}}if(1==i&&0==$(".context_menu_btn").length){let t='<div class="context_menu_btn" style="top:'+r+"px; left:"+(a+10)+`px;">\n                                    ${d}\n                                </div>`;$(this).append(t)}}})),window.$(".chat-center-message").on("click","div.deletemsg",(function(t){const e=this.dataset.msgid,n=this.dataset;let i="";Object.hasOwnProperty.call(n,"uniqid")&&(i=n.uniqid);Md("是否要将 "+window.$(this).parent().parent().attr("data-nickname")+" 发的消息撤回？",(function(){Qd("",kd.messageFormat($d.deleteMsg,e,"","","","",i))}),"","撤回消息")})),$(".chat-center-message").on("click","div.copymsg",(function(t){const e=$(this)[0].dataset.text;if(e){var n=document.createElement("input");n.setAttribute("id","copy"),n.value=e,document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("copy").select(),document.execCommand("copy"),document.getElementById("copy").remove(),Vt("复制成功")}$(".context_menu_btn").remove()})),window.$(".chat-center-message").on("click","div.add_custom",(function(t){const e=window.$(this).parent().parent().find("img").attr("src");Pe.addToCustom(e),window.$(".context_menu_btn").remove()})),window.$(".chat-input-smile").on("click",(function(t){t.stopPropagation(),uu.getMeid()>Mt.maxUID?du():"none"!==window.$(".chat-emoji-list").css("display")?window.$(".chat-emoji-list").hide():(Pe.initEmojiHtml(),window.$(".chat-emoji-list").show(),window.$(".emoji_list_menu").hide(),window.$(".chat-center-gift-content").hide())})),window.$("#chatNewmessage").on("click",(function(){window.$(this).hide(),window.$(".chat-center-window-main").scrollTop(999999),Mt.isUpScroll=!1})),window.$("#wishEnterCtn").on("click",(function(t){uu.getMeid()>Mt.maxUID&&du()})),window.$(".chat-center-gift-show").on("click",(function(t){if(uu.getMeid()>Mt.maxUID)return void du();if(t.stopPropagation(),Mi.getInstance().getFullScreenStatus()){const t=window.$("#new-live-controller .chat-center-gift").offset().left-310;window.$(".chat-center-gift .chat-center-gift-content").css("left",t+"px")}else if(Si.getInstance().getFullScreenStatus()){const t=window.$("#new-video-controller .chat-center-gift").offset().left-310;window.$(".chat-center-gift .chat-center-gift-content").css("left",t+"px")}else if(Ti.getInstance().getFullScreenStatus()){const t=window.$("#new-video-temp-controller .chat-center-gift").offset().left-310;window.$(".chat-center-gift .chat-center-gift-content").css("left",t+"px")}else window.$(".chat-center-gift .chat-center-gift-content").css("left","10px");let n=0,i="送麦上所有人",o="#666";fm.giftToTeacher.uid&&fm.giftToTeacher.nickname&&(uu.isBattleRoom()?uu.isBattleMainSeatNotPromise()||(n=Si.getInstance().narratorUid,i=Si.getInstance().narratorName,o=fm.giftToTeacher.color):uu.isVideoTempRoom()?null!=uu.getAnchoringUser()&&(n=uu.getAnchoringUser().uid,i=uu.getAnchoringUser().nickname,o=uu.getAnchoringUser().color):(n=fm.giftToTeacher.uid,i=fm.giftToTeacher.nickname,o=fm.giftToTeacher.color)),fm.isNewUser&&uu.isAutoRoom()?qt.get(Ot.getPackageNum(uu.getCid())).then((t=>{const{error:s,data:a,error_msg:r}=t;if(0==s){a.num>0?Km(n,i,o,3,0,0):Km(n,i,o,e.currentTab,e.currentGiftId,0)}})).catch((t=>{Km(n,i,o,e.currentTab,e.currentGiftId,0)})):Km(n,i,o,e.currentTab,e.currentGiftId,0)})),window.$(".chat-center-message").on("click",".chat-message-in-nickname",(function(t){t.stopPropagation();const e=window.$(this).offset();window.$(this).css("width").replace("px","");const n=window.$(this).attr("account");(uu.isTakeMeRoom()||uu.isSpecialTakeMeRoom())&&uu.isInAnchors(n)&&1==uu.getAnchorKengUser(n).face||kd.showUserFloatInfo({account:n,roomChannel:uu.getChannel()}).then((t=>{t.css({top:e.top-200,left:e.left-60}),t.show()}))})),window.$(".chat-center-message").on("click",".welcome-get-message",(function(t){t.stopPropagation();const e=window.$(this).offset();window.$(this).css("width").replace("px","");const n=window.$(this).attr("account");(uu.isTakeMeRoom()||uu.isSpecialTakeMeRoom())&&uu.isInAnchors(n)&&1==uu.getAnchorKengUser(n).face||kd.showUserFloatInfo({account:n,roomChannel:uu.getChannel()}).then((t=>{t.css({top:e.top-200,left:e.left-60}),t.show()}))})),window.$(".chat-center-gift-content").on("click",(function(t){t.stopPropagation(),window.$("#giftCountList").hide(),window.$(".gift-send-teacher-list").hide()})),window.$("#spanShowGiftCount").on("click",(function(t){t.stopPropagation(),"none"==window.$("#giftCountList").css("display")?(window.$("#giftCountList").show(),window.$(".gift-send-teacher-list").hide()):window.$("#giftCountList").hide()})),window.$("#giftCountList").on("click","span",(function(t){t.stopPropagation();var e=window.$(this).text();window.$("#giftCountList span").removeClass("current"),window.$(this).addClass("current"),window.$("#inputGiftCount").val(e)})),window.$("#selectGiftTeacher, #spanTeacherShow").on("click",(function(t){t.stopPropagation(),"none"==window.$(".gift-send-teacher-list").css("display")?(window.$(".gift-send-teacher-list").show(),window.$("#giftCountList").hide()):window.$(".gift-send-teacher-list").hide()})),window.$(".gift-send-btn,.gift-use-btn,.gift-open-btn").on("click",(function(t){t.stopPropagation(),window.$("#giftCountList").hide();const e=window.$(".chat-center-gift-tab").find(".gift-selected").get(0).dataset.id;1==window.$(".chat-center-gift-list .gifttab[data-id='"+e+"']").find(".current").get(0).dataset.question_gift?fh.getInstance().openQueModal(0):$_(null,null,{buttonMode:t.currentTarget.dataset.type})})),window.$("body").on("mouseenter",".chat-huiyuan-info",(function(){window.$(this).show()})),window.$("body").on("mouseleave",".chat-huiyuan-info",(function(){window.$(this).hide()})),window.$("body").on("mouseenter",".chat-function-camera",(function(){0!=window.$(".chat-camera-ban").length&&(window.$(".chat-camera-devices").removeClass("hide"),window.AgoraRTC.getCameras().then((t=>{window.$(".chat-camera-devices ul").empty(),t.map((t=>{window.$(".chat-camera-devices ul").append('<li data-deviceId="'+t.deviceId+'" >'+t.label+"</li>")}))})))})),window.$("body").on("mouseleave",".chat-function-camera",(function(){window.$(".chat-camera-devices").addClass("hide")})),window.$("body").on("click",".chat-camera-devices ul li",(function(t){t.stopPropagation(),""!=this.dataset.deviceid&&uu.globalRtcClient.setVideoDevice(this.dataset.deviceid)})),kd.emitter.on("registryEvents",(function(t){t.on("click",".guanliyuan-guanli span",(function(t){t.stopPropagation();const e=window.$(this).attr("type"),n=window.$(this).attr("account"),i=uu.getCid();if(e==$d.xiamai){if((uu.isDrawTempRoom()||uu.isDrawRoom())&&1e3!=Le.getInstance().currSignal)return void Vt("游戏已开始不能下麦..");if(uu.isSpyActiveRoom()||uu.isCocosH5Room()||uu.isLive18()){if("1"==window.$(this).attr("iscocosgame")&&uu.isPartyGame())return void _s.getInstance().downWheat(n);if(!uu.getAnchorKengUser(n))return void _s.getInstance().downWheat(n)}const t=window.$(this).attr("tposition"),o=window.$(this).attr("fid");if(t>0)1==t?Mh(i,o,2,n):tm(t,n,i,o,1);else{const t=window.$(this).attr("aposition");if(uu.isJingPaiRoom()&&-1==t)qd("setorder",-1,n);else{const i=kd.messageFormat(e,"您已下麦");Qd(n,i),uu.isSongPkRoom()?Od(n,uu.getCid(),t,-1):Hd(n,uu.getCid(),-1)}}}else if(e==$d.notalk)Md("确定要禁言吗？",(()=>{Lm(e,n,"您已被禁言")}));else if(e==$d.tiren)Md("确定要踢出吗？",(()=>{Em(e,n,"您已被踢出房间")}));else if(e==$d.koukuan){const t=window.$(this).attr("nickname");uu.showDeductModal(i,t,n)}else if(e==$d.yongfeng){Md("确定要对“"+window.$(this).attr("nickname")+"”永封吗？",(()=>{!function(t,e,n){qt.get(Ot.kickingForever(uu.getChannel(),e)).then((i=>{if(0==i.error){Vt(i.error_msg);const o=kd.messageFormat(t,n);Qd(e,o),Hd(e,uu.getCid(),-1)}else Rd(i.error_msg)}))}(e,n,"您已被封号")}))}else if(e==$d.zhiling)getLarenList(1).then((t=>{window.$.DialogByZ.Confirm({Title:"请选择要加入的房间",Content:'\n                        <div>\n                            <select id="selectChannelJoin">\n                                '+t+"\n                            </select>\n                        </div>\n                        ",BtnL:"取消",BtnR:"确定",FunL:function(){window.$.DialogByZ.Close()},FunR:function(){const t=window.$("#selectChannelJoin option:selected");if(t.length>0){const e=t.get(0).dataset,i=e.channel,o=e.cid,s=1,a=kd.messageFormat($d.gochat,n,i,s,o);Qd(n,a),window.$.DialogByZ.Close(),Hd(n,uu.getCid(),-1)}}})}));else if(e==$d.shangwei){window.$(".jingpai-waiters").find(">div[data-uid='"+n+"']").length>0?(Nd(n,i,0),qd("setorder",-1,n)):qd("setorder",0,n)}else if("manage_host_level"==e){const t=window.$(this).attr("manage");Md(1==t?`确定将UID:${n}设为金牌主持？`:`确定取消UID:${n}金牌主持权限？`,(()=>{!function(t,e){qt.get(Pt+"/Chatroompreside/editGoldpreside?uid="+e+"&type="+t).then((t=>{Vt(t.msg)}))}(t,n)}))}else"invite-shangmai"==e&&(0==uu.roomInfo.party_set.listshow?Hd(n,i,0):qt.get(Ot.getSendWheatInvite(uu.getCid(),n)).then((t=>{0!=t.error&&Vt(t.error_msg)})))})),t.on("click","button.float-yqsm",(function(t){t.stopPropagation();const e=this.dataset.uid,n=this.dataset.nickname,i=this.dataset.position||3,o=uu.getAnchoringUserId();if(0==o)Vt("当前没有主持，主持上麦后再申请");else if(uu.isJingPaiRoom()){let t={uid:e,position:0,cid:uu.getCid(),state:0,typeid:Tm()};uu.globalDDSocket.send("setwheat",t)}else{Qd(o+"",kd.messageFormat($d.requestshangmai,e,i,n)),qd("setorder",0,e)}}))})),window.$(".chat-btnlogin").on("click",(function(){du()})),window.$(".chat-btnoutlogin").on("click",(function(){Z_((function(){ou(uu.getCid())}))})),window.$("div.chat-voice-volume").on("click",(function(t){t.stopPropagation()})),window.$(".chat-function-yinliang").on("click",(function(t){t.stopPropagation(),"none"!=window.$("div.chat-voice-volume").css("display")?window.$("div.chat-voice-volume").hide():window.$("div.chat-voice-volume").show()})),window.$(".chat-function-noani").on("click",(function(t){t.stopPropagation();const e=window.$(this);e.hasClass("chat-function-noani-x")?(e.removeClass("chat-function-noani-x"),xt.getInstance().setGiftEffectSwithState(!1)):(e.addClass("chat-function-noani-x"),xt.getInstance().setGiftEffectSwithState(!0))})),window.$(".chat-function-report").on("click",(function(t){if(uu.getMeid()>Mt.maxUID)return void du();t.stopPropagation();const e={vid:uu.getCid(),title:uu.getRoomInfo().title};xs.getInstance().showReportModal(1,e)})),window.$(".chat-function-welcome").on("click",(function(t){t.stopPropagation(),qt.get(Ot.addTipsQueue(uu.getCid(),uu.roomInfo.typeid)).then((t=>{0==t.error?window.$(".chat-dd-welcome .chat-function-text").text("迎新中"):Vt(t.error_msg)})).catch((t=>{Vt("网络错误")}))})),window.$(".chat-voice-volume input[type='range']").on("input",(function(){var t=window.$(this).val();xt.getInstance().setMainVolume(t),hw.getInstance().setVolume(1*t),uu.isChorusRoom()?(nw.getInstance().setVolume(1*t),nw.getInstance().updatePreviousVolume(1*t)):uu.isKtvSmallRoom()&&(ad.getInstance().setVolume(1*t),ad.getInstance().updatePreviousVolume(1*t)),eu(t),0==t?$(".chat-function-yinliang").addClass("noSound"):$(".chat-function-yinliang").removeClass("noSound")})),window.$("#divTeacherList").on("click","p",(function(){const t=window.$(this).attr("uid"),n=window.$(this).attr("color"),i=window.$(this).attr("name");window.$("#selectGiftTeacher").attr("uid",t).attr("title",i).attr("color",n);let o="";if(i.indexOf("♕")>-1){o=i.split("♕")[1]||""}if(i.indexOf("♚")>-1){o=i.split("♚")[1]||""}if(i.indexOf("♔")>-1){o=i.split("♔")[1]||""}if(i.indexOf("☬")>-1){o=i.split("☬")[1]||""}window.$("#selectGiftTeacher").text(o||i),fm.giftToTeacher={uid:t,nickname:i,color:n},e.resetInputGiftCount()})),window.$(".right-info-content").on("click",".biaobai-title p",(function(t){t.stopPropagation(),qt.get(Ot.getGiftLists(uu.getCid(),0)).then((t=>{if(0==t.error){const e=t.data.find((t=>2==t.tips_type));Km(0,"送麦上所有人","#666",0,e?e.id:148,0)}}))})),window.$("body").on("click",".chat-personroom-chat-btn",(function(t){t.stopPropagation();const e=this.dataset.openclient;Ct.loadScript("https://asset1.tuwan.com/script/protocolcheck.js").then((()=>{window.protocolCheck(e,(()=>{Md("还没安装客户，请下载",(()=>{window.location.href="https://apk.tuwan.com/app/ddclient/upgrade/exe/diandiankaihei_setup.exe"}),"下载","提示")}))}))})),window.$(".user-own-message").on("click",(function(){if(uu.getMeid()>Mt.maxUID)return void du();bh(vh,0,yh),window.$(this).find("em").hide()})),window.$(document).on("click",(function(t){if(window.$(".chat-emoji-list").hide(),window.$(".chat-center-gift-content").hide(),window.$(".tooltip-top").remove(),window.$("#giftCountList").hide(),window.$(".gift-send-teacher-list").hide(),window.$("div.chat-voice-volume").hide(),window.$(".chat-diandan-list").hide(),window.$(".chat-huiyuan-info").hide(),window.$("button.deletemsg").remove(),window.$(".context_menu_btn").remove(),window.$(".emoji_list_menu").hide(),window.$(".invite-modal").addClass("hide"),dy.getInstance().hideQuickBgmModalComp(),Jm.hide(),0==window.$(t.target).parents(".seat-item-empty").length){if(null!=window.$(t.target).attr("class")&&-1!=window.$(t.target).attr("class").indexOf("takeme-queue-tab"))return;if(null!=uu.roomInfo&&uu.isSongTempRoom()&&0!=window.$(".song-queuelist").find(t.target).length)return;window.$(".channel-queuelist").hide()}})),window.$(".channel-queuelist").on("click",".queuelist-item-btn",(function(t){t.stopPropagation();const e=this.dataset.uid,n=uu.getCid(),i=window.$(this).text(),o=uu.getMeid();if("点击抱走"==i){if(uu.isInAnchors(e))return void Vt("请老板下麦后再抱走");if(o==e)return void Rd("客服不能抱走自己噢！");Cm(e,1)}else"取消点单"==i||"取消"==i?uu.isAnchoringUser(o)?Md("确定要取消吗？",(function(){uu.isKtvRoom()?"2"==$(".channel-queuelist.sp .tabContainer .tabCtn.active").attr("data-index")?em(-1,n,e):qd("setorder",-1,e):uu.isTakeMeRoom()?1==window.$(".takeme-queue-tab.active")[0].dataset.tab?em(-1,n,e):qd("setorder",-1,e):uu.isMarryRoom()?1==window.$(".marry-queue-tab.active")[0].dataset.tab?em(-1,n,e):qd("setorder",-1,e):em(-1,n,e)})):e==o&&(uu.isKtvRoom()?"2"==$(".opbutton.show[data-type=ktvdiandannum]").attr("data-num")?qd("setorder",-1,e):(qd("setqueue",-1,e),uu.globalDDSocket.send("queuelist",{cid:uu.getCid(),uid:uu.getMeid(),typeid:uu.getRoomInfo().typeid})):uu.isTakeMeRoom()||uu.isMarryRoom()?(qd("setorder",-1,e),em(-1,n,e)):em(-1,n,e),window.$(".channel-queuelist").hide()):"上麦"==i&&(uu.isTakeMeRoom()?1==window.$(".takeme-queue-tab.active")[0].dataset.tab?(Nd(e,n,0),em(-1,n,e)):(Hd(e,n,0),setTimeout((()=>{qd("setorder",-1,e)}),2e3)):uu.isMarryRoom()?1==window.$(".marry-queue-tab.active")[0].dataset.tab?(Od(e,n,3,0),em(-1,n,e),qd("setorder",-1,e)):(Od(e,n,7,0),qd("setorder",-1,e),em(-1,n,e)):uu.isJingPaiRoom()?(!function(t,e,n){var i={uid:t,position:0,cid:e,state:n,typeid:zd()};uu.globalDDSocket.send("setwheat",i)}(e,n,0),window.$(".channel-queuelist").css("display","none"),em(-1,n,e)):uu.isSongPkRoom()?(Nd(e,n,0),window.$(".channel-queuelist").css("display","none"),em(-1,n,e)):uu.isKtvRoom()?"2"==$(".channel-queuelist.sp .tabContainer .tabCtn.active").attr("data-index")?(Od(e,n,3,0),fm.globalUid=e,fm.globalOrderType="setqueue"):(Nd(e,n,0),fm.globalUid=e,fm.globalOrderType="setorder"):(Nd(e,n,0),window.$(".channel-queuelist").css("display","none"),qd("setorder",-1,e)))})),window.$(".channel-queuelist.sp .tabCtn").on("click",(function(t){t.stopPropagation();let e=$(t.currentTarget).attr("data-index");"1"==e?(window.$(".channel-queuelist.sp .tabCtn.tab1").addClass("active"),window.$(".channel-queuelist.sp .tabCtn.tab2").removeClass("active"),window.$(".channel-queuelist.sp .channel-queuelist-content.list1").removeClass("hide"),window.$(".channel-queuelist.sp .channel-queuelist-content.list2").addClass("hide")):"2"==e&&(window.$(".channel-queuelist.sp .tabCtn.tab2").addClass("active"),window.$(".channel-queuelist.sp .tabCtn.tab1").removeClass("active"),window.$(".channel-queuelist.sp .channel-queuelist-content.list2").removeClass("hide"),window.$(".channel-queuelist.sp .channel-queuelist-content.list1").addClass("hide"))})),window.$("#inputSearchKeywords1").on("keyup",(function(t){"13"==t.keyCode&&n("inputSearchKeywords1")})),window.$("#btnSearchTeacher1").on("click",(function(){n("inputSearchKeywords1")})),window.$(".invite-modal").on("click",(function(t){t.stopPropagation()})),window.$(".invite-modal").on("click",".invite-modal-invite-button",(function(t){if(1==t.currentTarget.dataset.invite)return void Vt("已经邀请过该用户了哦..");const e=t.currentTarget.dataset.uid,n=uu.getCid(),i=5==uu.roomInfo.typeid?0:uu.getMycarData().fid;qt.get(Ot.sendInvite(i,n,e)).then((t=>{0==t.error?(Vt(t.error_msg),window.$(".invite-modal-invite-button[data-uid="+e+"]").attr("data-invite",1)):Vt(t.error_msg)}))})),window.$("#yaoqingsm_new").on("click",".agree",(function(){var t=window.$(this).attr("account"),e=window.$(this).attr("position"),n=window.$(this).parents(".yqshangmai-item");function i(){const i=uu.getCid();e>=3?Hd(t,i,0):1==e&&Nd(t,i,0),n.remove(),0!=$("#yaoqingsm_new .listCtn .item").length||$("#yaoqingsm_new .checkCtn").hasClass("active")||$("#yaoqingsm_new").hide()}uu.isSpyActiveRoom()?_s.getInstance().getGameUsersWithUids().then((e=>{e.map((t=>String(t))).includes(String(t))?(Vt("请点击游戏下麦后再申请嘉宾位哦~"),n.remove()):i()})).catch((t=>{})):uu.isCocosH5Room()?_s.getInstance().notInGame(String(t)).then((t=>{i()})).catch((t=>{Vt("请点击游戏下麦后再申请嘉宾位哦~"),n.remove()})):i()})),window.$("#yaoqingsm").on("click",".btnagree",(function(){var t=window.$(this).attr("account"),e=window.$(this).attr("position"),n=window.$(this).parents(".yqshangmai-item");function i(){const i=uu.getCid();e>=3?Hd(t,i,0):1==e&&Nd(t,i,0),n.remove()}uu.isSpyActiveRoom()?_s.getInstance().getGameUsersWithUids().then((e=>{e.map((t=>String(t))).includes(String(t))?(Vt("请点击游戏下麦后再申请嘉宾位哦~"),n.remove()):i()})).catch((t=>{})):uu.isCocosH5Room()?_s.getInstance().notInGame(String(t)).then((t=>{i()})).catch((t=>{Vt("请点击游戏下麦后再申请嘉宾位哦~"),n.remove()})):i()})),window.$("#yaoqingsm_new").on("click",".reject",(function(){var t=kd.messageFormat($d.responseshangmai,"0"),e=window.$(this).attr("account");Qd(e+"",t),window.$(this).parents(".yqshangmai-item").remove(),0!=$("#yaoqingsm_new .listCtn .item").length||$("#yaoqingsm_new .checkCtn").hasClass("active")||$("#yaoqingsm_new").hide(),qd("setorder",-1,e)})),window.$("#yaoqingsm").on("click",".btnrejust",(function(){var t=kd.messageFormat($d.responseshangmai,"0"),e=window.$(this).attr("account");Qd(e+"",t),window.$(this).parents(".yqshangmai-item").remove(),qd("setorder",-1,e)})),window.$(".chat-center-message").on("click",".carteamauto-item-message .carauto-team-right-join",(function(t){t.stopPropagation();const e=uu.getMeid(),n=window.$(this).attr("fid"),i=uu.getCid(),o=window.$(this).attr("live"),s=window.$(this).attr("autouid");if(2==o){let t=window.$(this).attr("tcid");return uu.isAnchoringUser(e)?void Rd("主持不能加入车队"):void ou(t)}if(s==e)return;if(uu.isAnchoringUser(e))return;if(uu.isBattleRoom()){if(0==window.$("#new-right-team-content .autoroom-team-item[data-fid='"+n+"']").length)return void Rd("车队已解散，请选择其它车队")}else if(0==window.$(".autoroom-allteams .autoroom-team-item[data-fid='"+n+"']").length)return void Rd("车队已解散，请选择其它车队");const a=uu.getMycarData();if(a){Rd(a.fid==n?"您已经在此车队中了":"请下车队后再加入此车队")}else Kd(2,e,i,n,1)})),window.$(".right-main").on("click",".right-tehui-voice",(function(t){if(t.stopPropagation(),window.$(this).hasClass("disable"))window.$(this).find(".right-tehui-noplay").css("display","flex"),window.$(this).find(".right-tehui-play").hide(),window.$(this).removeClass("disable"),window.$("#audioPlayRight")[0].pause();else{const t=this.dataset.mp3;window.$("#audioPlayRight").attr("src",t),window.$("#audioPlayRight")[0].volume=1,window.$("#audioPlayRight")[0].play(),window.$(".right-tehui-list").find(".right-tehui-voice").removeClass("disable"),window.$(".right-tehui-list").find(".right-tehui-noplay").css("display","flex"),window.$(".right-tehui-list").find(".right-tehui-play").hide(),window.$(this).find(".right-tehui-noplay").hide(),window.$(this).find(".right-tehui-play").css("display","flex"),window.$(this).addClass("disable"),window.$("#audioPlayRight")[0].onplay=function(){},window.$("#audioPlayRight")[0].onended=function(){window.$(".right-tehui-list").find(".right-tehui-noplay").css("display","flex"),window.$(".right-tehui-list").find(".right-tehui-play").hide(),window.$(".right-tehui-list").find(".right-tehui-voice").removeClass("disable")}}})),window.$(".right-info-content").on("mouseenter",".right-paihang-item,.right-solo-item",(function(t){const e=this.dataset.uid,n="solo"==this.dataset.type;if(0!=e){const t=window.$(this).offset(),i=window.$(this).width(),o=window.$(this).height();fm.kapianInterval=setTimeout((function(){kd.showUserFloatInfo({account:e,roomChannel:uu.getChannel()}).then((e=>{e.css({top:t.top-(194-o)/2+(n?-30:0),left:t.left-i-20+(n?15:0)}),e.show(),clearInterval(fm.kapianInterval),fm.kapianInterval=null}))}),500)}})),window.$(".right-info-content").on("mouseleave",".right-paihang-item,.right-solo-item",(function(t){fm.kapianInterval&&(clearInterval(fm.kapianInterval),fm.kapianInterval=null);const e=this.dataset.uid;window.$("#user_"+e).hide()})),window.$(".carauto-yaoqiu").on("click","p",(function(){const t=uu.getMeid();var e;e=t,window.$(".carauto-teams-persons .carauto-person-duizhang[account='"+e+"']").length>0&&Hh().showTeamInfo(2)})),window.$(".carauto-share").on("click",(function(){const t=window.$(".yaoqing-float");"none"==t.css("display")?t.css("display","flex"):t.css("display","none")})),window.$(".yaoqing-float").on("click",".yaoqing-close",(function(t){t.stopPropagation(),window.$(".yaoqing-float").hide()})),window.$(".yaoqing-float").on("click",".qqshare",(function(){L_()})),window.$(".yaoqing-float").on("click",".qqquanshare",(function(){E_()})),window.$(".yaoqing-float").on("click",".weiboshare",(function(){D_()})),We.disposeResponse=function(t){0==t.error?(Ct.readCookie("preCarteamChannel"),si.hide(".temp-autocar-shang-mask"),Bm(uu.getMeid())):Rd(t.error_msg)},window.$(".div-futext").on("click","button",(function(){const t=window.$(".div-futext select").val(),e=window.$(".div-futext input").val();if(""==e)return;const n=$d.text3d,i={text:e,type:n,texttype:t},o=kd.messageFormat(n,i);Ud("info",o),Zd(o)})),window.$("#nowsubs").on("click",".divNowC button",(function(){Hd(this.dataset.account,uu.getCid(),-1)})),window.$(".chatroom-guanzhu").on("click",(function(){uu.getMeid()>Mt.maxUID?du():window.$(this).hasClass("current")?qt.get(Pt+"/Chatroom/cancelCollect?cid="+uu.getCid()).then((t=>{0==t.error&&(window.$(".chatroom-guanzhu .textCtn").text("关注"),window.$(".chatroom-guanzhu").removeClass("current"),he&&he.removeAttent(uu.getChannel()))})):qt.get(Pt+"/Chatroom/addCollect?cid="+uu.getCid()).then((t=>{0==t.error?(window.$(".chatroom-guanzhu .textCtn").text("已关注"),window.$(".chatroom-guanzhu").addClass("current"),he&&he.addAttent(uu.getChannel())):Rd(t.error_msg)}))}));let o="";function s(t){qt.post(Ot.uploadImage(),{img:t}).then((t=>{0==t.error?Ah(t.data.thumb,t.data.image,t.data.ratio):Rd(t.msg);window.$("#uploadForm").get(0).reset()}))}window.$(".zhanduiEnterBtn").on("click",(async function(t){let e=$(t)[0].currentTarget.dataset.teamid;$("#kingTeamParent").show();const n=$("#kingTeam")[0];if(!i||o!=e){$("#kingTeam").html(""),i=new ss({target:n}),o=e;let t=uu.getRoomInfo().gameid;i.$set({team_id:e,iframeHeight:parseInt($("#kingTeam").css("height"))-50,widthPx:"450px",gameId:t})}})),window.$("#kingTeamBg").on("click",(function(){$("#kingTeamParent").hide()})),window.$(".chatroom-redjilu").on("click",(function(){window.$(".redpacket-jilu-content").css("display","block"),window.$(".redpacket-jilu-content ul").html('<li style="text-align:center; color:#999; font-size:14px;">数据加载中...</li>'),zm()})),window.$(".redpacket-jilu-content").on("click",".redpacket-jilu-resfest",(function(){if("刷新"==window.$(this).text()){const t=window.$(this);t.text("刷新中..."),zm((()=>{t.text("刷新")}))}})),window.$("#imgshoucong").on("click",(function(){window.$(".bangmask_recharge").css("display","flex")})),window.$("#level_up").on("click",(function(){iu()})),window.$(".gift-go-congzi").on("click","a",(function(){})),window.$(".chat-center-main").on("click",".play-again-conatiner",(function(){const t=uu.getCid();qt.get(Ot.runFleetAgain(t)).then((t=>{Vt(t.error_msg)}))}))}function hy(){console.log("bindEvent2...."),window.$(".chat-input-chat-textarea p").on("click",(function(){du()})),window.$(document).on("click",".lol-match-volume",(function(){vi&&(vi.setVolume(1),window.$(this).parent().remove())})),window.$(".chat-center-main").on("click",".seat-item-empty",(function(){if(this.dataset.uid>0)return;const t=uu.getMeid();if(t>Mt.maxUID)du();else if(uu.isTruthSmallRoom())uy(this);else if(uu.isTruthRoom())Gi.getInstance().interceptSeatCheck()||function(t){const e=t.dataset.uid||0;if(e>0)return;const n=t.dataset.aposition,i=uu.getCid(),o=uu.getMeid();if(n){if(uu.isInAnchors(o))return void Rd("您已经在麦上");if(2==n)uu.isAnchors2(o)?0==e&&Vd(o,i,0):Rd("非主播请上嘉宾位");else{const t=uu.getAnchoringUser();if(t){Qd(t.uid+"",kd.messageFormat($d.requestshangmai,"")),Vt("上麦请求已发送"),qd("setorder",0,o)}else Rd("请主持上麦后再申请")}}}(this);else if(uu.isHuodongRoom()||uu.isKtvRoom()||uu.isDrawRoom()||uu.isGameRace())uy(this);else if(uu.isBattleRoom())(uu.roomInfo.narrator_ids.find((t=>t==uu.getMeid()))||uu.isBattleMainSeatNotPromise())&&uy(this);else if(uu.isSquidGame())uy(this);else if(uu.isChorusRoom()||uu.isKtvSmallRoom())uy(this);else if(uu.isH5ActiveRoom())uy(this);else if(uu.isCocosH5Room())_s.getInstance().getCocosUsers().map((t=>String(t))).includes(String(uu.getMeid()))?Vt("请点击游戏下麦后再申请嘉宾位哦~"):uy(this);else if(uu.isSpyActiveRoom())_s.getInstance().getGameUsersWithUids().then((t=>{t&&t.map((t=>String(t))).includes(String(uu.getMeid()))?Vt("请点击游戏下麦后再申请嘉宾位哦~"):uy(this)})).catch((t=>{}));else if(uu.isDrawTempRoom())uy(this);else if(uu.isSongTempRoom())uy(this);else if(uu.isShengyouRoom()){if(this.dataset.aposition)uy(this);else{gy(this,this.dataset.tposition)}}else if(uu.isTakeMeRoom()){const e=this.dataset.aposition;1==e?em(0,uu.getCid(),t):2==e?uu.isAnchors2(t)?Vd(t,uu.getCid(),0):Vt("只有主持才能上主持位"):qd("setorder",0,t)}else if(uu.isAutoRoom()){const t=this.dataset.aposition;if(t)py(this,t);else{gy(this,this.dataset.tposition)}}else if(uu.isGameRoom()){const t=this.dataset.aposition;t&&py(this,t)}else if(uu.isJiamianRoom()){!function(t,e,n){if(1==e){uu.getJiamianRoomBossUids().includes(1*n)?Nd(n,uu.getCid(),0):Vt("当前是活动位，无法上麦")}else if(2==e)uu.isAnchors2(n)?Vd(n,uu.getCid(),0):Vt("只有主持才能上主持位");else if(uu.isInAnchors(n))Vt("你已经在麦上");else{const t=uu.getAnchoringUserId();t>0?function(t){if(!ci.timing){Qd(t+"",kd.messageFormat($d.requestshangmai,"")),ci.show(1,ci.type.daotime,"30秒"),Vt("上麦请求已发送"),qd("setorder",0,uu.getMeid())}}(t):Vt("请主持上麦后再申请")}}(0,this.dataset.aposition,t)}else if(uu.isHunLiRoom()){!function(t,e,n){if(1==e||0==e){uu.getBossUids().includes(1*n)?Nd(n,uu.getCid(),0):Vt("当前是活动位，无法上麦")}else if(2==e)uu.isAnchors2(n)?Vd(n,uu.getCid(),0):Vt("只有主持才能上主持位");else if(uu.isInAnchors(n))Vt("你已经在麦上");else{const t=uu.getAnchoringUserId();t>0?function(t){if(!ci.timing){Qd(t+"",kd.messageFormat($d.requestshangmai,"")),ci.show(1,ci.type.daotime,"30秒"),Vt("上麦请求已发送")}}(t):Vt("请主持上麦后再申请")}}(0,this.dataset.aposition,t)}else if(uu.isLOLMatchRoom()){const e=this.dataset.aposition;if(e)py(this,e);else{!function(t,e,n){if(uu.isInAnchors(n))return void Rd("主持不能加入车队");const i=uu.getCid(),o=t.dataset.uid,s=window.$(t).parents(".chat_center_match_list").get(0).dataset.fid;0==o&&Kd(e,n,i,s)}(this,this.dataset.tposition,t)}}else if(uu.isJingPaiRoom()){const e=this.dataset.aposition;0==e?em(0,uu.getCid(),t):2==e&&(py(this,e),em(-1,uu.getCid(),t))}else if(uu.isMarryRoom()){!function(t,e,n){if(0==e||1==e)Od(n,uu.getCid(),e,0);else if(2==e)uu.isAnchors2(n)?Vd(n,uu.getCid(),0):Vt("只有主持才能上主持位");else if(e>2&&e<7){if(!uu.getAnchoringUserId())return void Vt("暂无主持人");em(0,uu.getCid(),n),setTimeout((()=>{const t=window.$(".marry-queuelist");window.$(".marry-common-orderlist").addClass("hide"),window.$(".marry-queue-tab").removeClass("active"),"none"==t.css("display")?(t.css("display","flex"),window.$(".marry-common-queuelist").removeClass("hide"),window.$(".marry-queue-tab:eq(0)").addClass("active")):t.hide()}),500)}else{if(!uu.getAnchoringUserId())return void Vt("暂无主持人");qd("setorder",0,n),setTimeout((()=>{const t=window.$(".marry-queuelist");window.$(".marry-common-queuelist").addClass("hide"),window.$(".marry-queue-tab").removeClass("active"),"none"==t.css("display")?(t.css("display","flex"),window.$(".marry-common-orderlist").removeClass("hide"),window.$(".marry-queue-tab:eq(1)").addClass("active")):t.hide()}),500)}}(0,this.dataset.aposition,t)}else if(uu.isSongPkRoom())!function(t,e=!1){const n=uu.getMeid(),i=t.dataset.aposition;1==i?(em(0,uu.getCid(),n),Vt("上麦请求已发送")):2==i?uu.isAnchors2(n)?Vd(n,uu.getCid(),0):Vt("只有主持才能上主持位"):e?Od(n,uu.getCid(),i,0):Hd(n,uu.getCid(),0)}(this,!0);else if(uu.isPListType2()){if(this.dataset.aposition)uy(this);else{gy(this,this.dataset.tposition)}}else 19==uu.getRoomInfo().live||uu.getRoomInfo().live,uy(this)})),window.$(".chat-center-main").on("mouseenter",".seat-item-empty,.live-video-info",(function(t){console.time("mouseenter3");cy=setTimeout((()=>{wy.call(this,t)}),300),console.timeEnd("mouseenter3")})),window.$(".chat-center-main").on("mouseleave",".seat-item-empty,.live-video-info",(function(){cy&&clearTimeout(cy),fm.kapianInterval&&(clearInterval(fm.kapianInterval),fm.kapianInterval=null);const t=this.dataset.uid;window.$("#user_"+t).hide()})),window.$(".chat-center-main").on("click",".seat-close",(function(){uu.isKtvRoom()&&(fm.globalUid="",fm.globalOrderType="");const t=window.$(this).parents(".seat-item-empty");if(t.length>0){const e=t.get(0),n=uu.getMeid(),i=e.dataset.uid,o=e.dataset.aposition,s=uu.getCid();if(o){if(n==i||uu.isAnchoringUser(n)||uu.isKtvSmallRoom()&&Ktv.getInstance().mineIsOwner()){if((uu.isMusicTempRoom()||uu.isSameMusicTempRoom())&&uu.isAnchors2(n)&&n==i){if(1==uu.roomInfo.fleet_type&&1==uu.roomInfo.new_chat_mode)return void Qh();uu.isSongTempRoom()||Gh()}if(uu.isSongPkRoom())Vd(i,s,-1,o);else{if(uu.isJingPaiRoom()){if(window.$(".jingpai-waiters").find(">div[data-uid='"+i+"']").length>0)return void qd("setorder",-1,i)}Vd(i,s,-1)}}}else{const t=e.dataset.tposition,o=uu.getMycarDuizhangUid();let a=null;a=uu.isLOLMatchRoom()?window.$(this).parents(".chat_center_match_list"):window.$(this).parents(".kaihei-team-item");const r=a.attr("data-fid");(uu.isAutoRoom()||uu.isShengyouFreeRoom())&&(uu.isAnchoringUser(n)||n==o)&&1==t?Mh(s,r,2,o):tm(t,i,s,r,1)}}})),window.$(".room-seats-all-room").on("click",".new-xuanyan",(function(){const t=window.$(this).parents(".kaihei-team-item");if(t.length>0){const e=uu.getMeid();t.get(0);const n=uu.getMycarData();if(n){n.fid;const t=n.persons.get(e);if(t&&1==t.position){si.show(".carteam-xuanyan-mask","block");const t=Ct.readCookie("user_xuanyan_"+e);t&&t!=Mt.xuanyanDefaultText&&window.$(".carteam-xuanyan-mask-content textarea").val(t)}}}})),window.$(".room-seats-all-room").on("click",".autoroom-teams-tabs>div",(function(){window.$(".autoroom-teams-tabs>div").removeClass("current"),window.$(this).addClass("current");const t=this.dataset.id;0==t||1e3==t?window.$(".autoroom-teamlist>div.autoroom-team-item").show():(window.$(".autoroom-teamlist>div.autoroom-team-item[data-areaid!='"+t+"']").hide(),window.$(".autoroom-teamlist>div.autoroom-team-item[data-areaid='"+t+"']").show()),Td.update(),ji.getInstance().clickTab()})),window.$(document).on("click",".autoroom-team-item,.carteamauto-item",(function(){const t=uu.getMeid();if(t>Mt.maxUID)return void du();const e=uu.getRoomInfo().ptype,n=this.dataset,i=n.state,o=n.tcid,s=n.live,a=n.gametypetmp,r=n.fid;if(17!=s&&18!=s)if(a>0)Ch(r,a);else if(!uu.isSongRoom(e)||5!=s&&6!=s&&13!=s){if(-1==i){if(uu.isGameRoom(e)||uu.isKillerFreeRoom(e)||uu.isSpyRoom(e))return;if(uu.isAnchoringUser(t))return void Rd("主持不能创建车队");Hh().showTeamInfo(1)}else if(2==s){if(uu.isAnchoringUser(t))return void Rd("主持不能加入车队");const e=n.tcid;n.fid,uu.getCid(),ou(e)}else if(0==i){if(uu.isAdminUids(t))return void fy(i,o);if(uu.isAnchoringUser(t))return void Rd("主持不能加入车队");if(t==1*n.uid)return;const e=n.fid,s=uu.getCid(),a=uu.getMycarData();if(a){Rd(a.fid==e?"您已经在此车队中了":"请下车队后再加入此车队")}else{const n=uu.getMusicCarList().get(e);if(null!=n&&9==n.live&&n.num>=n.total)return void Rd("当前车队已满员");Kd(2,t,s,e,1)}}else if(1==i){if(uu.isAdminUids(t)||1==uu.roomInfo.is_patrol)return void fy(i,o);if(uu.isSameMusicRoom(e)){1==1*this.dataset.vip&&Rd("vip房已开")}const n=this.dataset;if(n.live&&4==n.live){const e=uu.getCid(),i=n.tcid;return Hd(t,e,-1),void ou(i)}if(uu.isShengyouFreeRoom(e)||uu.isShengyouFreeRoomWithPType()||uu.isPListType2()||uu.isBattleRoom(e)){if(uu.isAnchoringUser(t))return void Rd("主持不能加入车队");const e=n.tcid,i=n.fid,o=uu.getCid(),s=uu.getMusicCarList().get(i);if(s){if(1==s.vip)return void Rd("vip房已开");if(!(s.num!=s.total||uu.isPListType2()||uu.isShengyouFreeRoom()||uu.isShengyouFreeRoomWithPType()))return void Rd("当前房间已满员");if(window.$(this).find(".carauto-item-btn.joined").length&&"已开车"==window.$(this).find(".carauto-item-btn.joined").text()||window.$(this).find(".carauto-team-right-join.joined").length&&"已开车"==window.$(this).find(".carauto-team-right-join.joined").text())return void Vt("已开车");uu.globalDDSocket.send("publishList",{cid:o,gameid:uu.roomInfo.gameid}),Hd(t,o,-1),ou(e)}}}}else qt.get(Ot.checkSongRoom(uu.getCid(),o)).then((t=>{0==t.error?ou(o):Vt(t.error_msg)}));else o&&parseInt(o)&&ou(o)})),window.$(".room-seats-all-room").on("click",".autocarteam-li-top",(function(t){t.stopPropagation();const e=window.$(this).parents(".autoroom-team-item").get(0),n=e.dataset.state;e.dataset.uid;const i=e.dataset.fid;if(1==n)return void Rd("不能置顶已经开车的车队");const o=uu.getMeid(),s=this.dataset.rec;if(uu.getAnchoringUserId()!=o)return;const a=uu.getCid();0==s?(this.dataset.rec=1,Mh(a,i,1)):(this.dataset.rec=0,Mh(a,i,3))})),window.$(".room-seats-all-room").on("click",".autocarteam-li-close",(function(t){t.stopPropagation();const e=window.$(this).parents(".autoroom-team-item").get(0),n=e.dataset.state,i=e.dataset.fid;if(1==n)return void Rd("不能关闭已经开车的车队");const o=uu.getMeid();if(uu.getAnchoringUserId()!=o)return;Mh(uu.getCid(),i,2,e.dataset.uid)})),window.$(document).on("click",".seats-game-caritem",(function(t){t.stopPropagation();const{fid:e,type:n,roomtype:i="",live:o="",cid:s}=this.dataset;18!=o?qh(e,n,0,i):ou(s)})),window.$(document).on("click",".meeting_action_ringup",(t=>{const{id:e,cid:n}=t.currentTarget.dataset;let i="接听新语音后，会退出当前大厅",o=0;"none"!=$(".game-mask").css("display")?(i="接听新语音后，会退出当前游戏",o=1):"none"!=$(".meeting-mask").css("display")?(i="接听新语音后，会退出当前会议",o=2):uu.isInAnchors(uu.getMeid())&&(i+="并下麦！"),de.getInstance().show("提示",i,!1,"取消","确认",(()=>{if($(".meeting_modal_mask").hide(),1==o){const t=window.$(".meeting-mask");t.find("iframe").attr("src",""),t.css("display","none")}else if(2==o){const t=window.$(".game-mask");t.find("iframe").attr("src",""),t.css("display","none")}else uu.isDrawRoom()||uu.isDrawTempRoom()||uu.isSquidGame()||uu.isJingPaiRoom()||(uu.isAnchoringUser(uu.getMeid())?Vd(uu.getMeid(),uu.getCid(),-1):Hd(uu.getMeid(),uu.getCid(),-1));Hm(e,n)}))})),window.$(".game-mask").on("click",".game-mask-close",(function(t){t.stopPropagation(),Xh(),uu.isBattleRoom()&&Si.getInstance().resumePlayer()})),window.$(".room-seats-all-room").on("click",".jingpai-detail",(function(){const t=this.dataset,{type:e,content:n,id:i,url:o}=t;"edit"==e?uu.showEditJingpaiContent(i,uu.getCid(),n):"detail"==e&&uu.showIframe(o+"&uid="+uu.getBossUid())})),window.$(".room-seats-all-room").on("click",".jingpai-yugao",(function(){const t=this.dataset.url;t&&uu.showIframe(t)}))}function uy(t){const e=t.dataset.uid||0;if(e>0)return;const n=t.dataset.aposition,i=uu.getCid(),o=uu.getMeid();if(n){if(18==uu.getRoomInfo().live){let t=document.getElementById("squidActiveIframe"),e=[];try{e=t.contenWindow.cocosGetGamingUsers()}catch(s){console.log(s)}if(e.includes(uu.getMeid()))return void Vt("您正在游戏中，无法上麦哦~");if(uu.isInAnchors(o))return void Rd("您已经在麦上");if(2!=n)return void(uu.getAnchoringUserId()?Hd(o,i,0):Vt("暂无主持人"))}if(1==n&&uu.isKtvSmallRoom())return;if(uu.isInAnchors(o))return void Rd("您已经在麦上");if(uu.isKtvRoom()&&1!=n&&2!=n&&!uu.isAnchors2(o)&&0==uu.getTeacherValue())return void Rd("您还不是队长");if(uu.isKtvRoom()&&1==uu.getTeacherValue()&&1!=n&&2!=n)return uu.getAnchoringUserId()?(Gd("setqueue",0,o),Vt("已加入队长队列"),void setTimeout((()=>{$(".opbutton.show[data-type=diandanself]").trigger("click")}),600)):void Vt("暂无主持人");if(1==n){if(uu.isKtvRoom()&&!uu.getAnchoringUserId())return void Vt("暂无主持人");qd("setorder",0,o),Vt("已加入点单队列"),uu.isKtvRoom()&&setTimeout((()=>{$(".opbutton.show[data-type=ktvdiandannum]").trigger("click")}),600)}else if(2==n)uu.isAnchors2(o)||uu.isDrawTempRoom()||uu.isNewDrawTempRoom()||uu.isSongTempRoom()||uu.isBattleRoom()?0==e&&Vd(o,i,0):0!=uu.getRoomInfo().is_hall_captain?Vd(o,i,0):Rd("非主播请上嘉宾位");else{if(uu.isHuodongRoom())return;if(uu.isLive19And20()||uu.isTruthSmallRoom())if(uu.isAnchors2(o))Hd(o,i,0);else{const t=uu.getAnchoringUser();if(t){Qd(t.uid+"",kd.messageFormat($d.requestshangmai,"")),Vt("上麦请求已发送"),uu.isKtvRoom()||qd("setorder",0,o)}else Rd("请主持上麦后再申请")}else if(uu.isAnchors2(o)||uu.isPaidan2(o))Hd(o,i,0);else{const t=uu.getAnchoringUser();if(t){Qd(t.uid+"",kd.messageFormat($d.requestshangmai,"")),Vt("上麦请求已发送"),uu.isKtvRoom()||qd("setorder",0,o)}else Rd("请主持上麦后再申请")}}}}function py(t,e){const n=1*t.dataset.uid;if(n>0)return;const i=uu.getMeid();if(uu.isInAnchors(i))return void Rd("你已经在麦上了");const o=uu.getCid();if(2==e||3==e&&uu.isLOLMatchRoom()){if(uu.getMycarData())return void Rd("请下车队后再上主持位");uu.isAnchors2(i)?0==n&&Vd(i,o,0,e):Rd("非主持请上嘉宾位")}else{const t=uu.getAnchoringUser();if(t){Qd(t.uid+"",kd.messageFormat($d.requestshangmai,"")),Vt("上麦请求已发送"),qd("setorder",0,i)}else Rd("请主持上麦后再申请")}}function gy(t,e){const n=uu.getMeid();if(uu.isAnchoringUser(n))return void Rd("请下主持位后再开车");if(!uu.isPaidan2(n)&&1==e){if(uu.getSelfInfo().vip<4)return void Rd("VIP4级以上才可以成为队长哦")}const i=uu.getMycarData(),o=window.$(t).parents(".kaihei-team-item").attr("data-fid");if(i){return void Rd(i.fid==o?"你已经在此车队中了":"请离开原来的车队后再加入此车队")}const s=uu.getCid();0!=o?0!=o&&Kd(e,n,s,o,1):Hh().showTeamInfo(1)}function fy(t,e){1==t&&e>0?ou(e):Rd("巡查号不允许进入小队")}function wy(t){if(console.log("overSeat===="),window.$(this).hasClass("forbidFloat")||$(t.target).hasClass("all_faces"))return;const e=this.dataset.uid;if(0==e)return;const n=window.$(this).hasClass("live-video-info")?window.$(this):uu.isTakeMeRoom()?window.$(this).find(".seat-user-head"):window.$(this).find(".seat-user-name"),i=(uu.isDrawTempRoom()||uu.isDrawRoom())&&0!=window.$(this).find(".seat-user-name.hide").length?window.$(this).find(".seat-user-score-container"):n,o=i.offset(),s=i.width(),a=i.height(),r=uu.getChannel(),c=this.dataset.aposition||-1;let l=0,d=0;-1==c&&(l=1*this.dataset.tposition,l>0&&(d=1*window.$(".kaihei-team-item").attr("data-fid"))),kd.showUserFloatInfo({account:e,roomChannel:r,tposition:l,fid:d,aposition:c}).then((t=>{if(uu.isTakeMeRoom()?t.css({top:o.top-50,left:o.left+s+10}):t.css({top:o.top+a-4,left:o.left-(304-s)/2}),null!=uu.getBossInfo()&&uu.getBossInfo().uid==e&&1==uu.getBossInfo().face)window.$(".chat-huiyuan-info .takeme-hide-tag").hide(),window.$(".chat-huiyuan-info .huiyuan-head img").attr("src",uu.getBossInfo().avatar),window.$(".chat-huiyuan-info .chat-huiyuan-sentgift-btn").attr("nickname","神秘人"),window.$(".chat-huiyuan-info .huiyuan-head-right-nickname").html("<span>"+uu.getBossInfo().nickname+"</span>");else if(uu.isSpecialTakeMeRoom()&&uu.isInAnchors(e)&&1==uu.getAnchorKengUser(e).face){let t=uu.getSelfInfo().uid==e?uu.getSelfInfo().nickname:"嘉宾"+(uu.getAnchorKengUser(e).position-2);window.$(".chat-huiyuan-info .takeme-hide-tag").hide(),window.$(".chat-huiyuan-info .huiyuan-head img").attr("src",uu.getAnchorKengUser(e).avatar),window.$(".chat-huiyuan-info .chat-huiyuan-sentgift-btn").attr("nickname",t),window.$(".chat-huiyuan-info .huiyuan-head-right-nickname").html("<span>"+t+"</span>")}else window.$(".chat-huiyuan-info .takeme-hide-tag").show();t.show()}))}function vy(t){const e=t.error,n=t.error_msg||"";if(-1006!=e){if(1==_client)return Vt(n),void setTimeout((()=>{window.open("client-room-close")}),1500);if(1===e){const t={Title:"提示",Content:n+"，点击确定回到首页。",BtnL:"回到首页",FunL:function(){window.$.DialogByZ.Close(),window.location.href=It?"https://y-test.tuwan.com/":"https://y.tuwan.com/"}},e=window.$(".chat-room-list ul li:not(.hide) .room-item");return e.length>0&&(t.BtnR="为您推荐",t.FunR=function(){window.$.DialogByZ.Close(),ou(window.$(e[0]).find(".room-item-name").data().cid)}),void window.$.DialogByZ.Confirm(t)}if(3===e&&t.pcid){const e={Title:"提示",Content:n+"，点击确定回到首页。",BtnL:"知道了",FunL:function(){window.$.DialogByZ.Close(),ou(t.pcid,null,!1,!0)}};window.$.DialogByZ.Alert(e)}else Rd(n,(()=>{window.location.href=It?"https://y-test.tuwan.com/":"https://y.tuwan.com/"}))}else yu.getInstance().show()}let _y=null,yy=null;function xy(t){const e={c:k,l:function(t){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:k,p:k,i:k,o:k,d:k};return p("SvelteRegisterBlock",{block:e,id:xy.name,type:"component",source:"",ctx:t}),e}function by(t,e){let{$$slots:n={},$$scope:i}=e;f("App",n,[]);const o=[];return Object.keys(e).forEach((t=>{~o.indexOf(t)||"$$"===t.slice(0,2)||"slot"===t||console.warn(`<App> was created with unknown prop '${t}'`)})),[]}window.$(document).ready((function(){console.time("pagev9init"),$u.getInstance().on("update",(()=>Td.update())),fh.getInstance().emitter.on("sendGift",$_),ph.getInstance().emitter.on("creatTeam",Jh);let t=Wo.getInstance();t.emitter.on("playBaobox",C_),t.emitter.on("jisuanMoney",Oh),t.emitter.on("showLoginWindow",du),Jt.emitter.on("volumeFade",tu),Jt.emitter.on("onloadfail",Sw),gh.getInstance(),Pe.emitter.on("sendCustomEmoji",Ah),kd.emitter.on("notalk",Lm),kd.emitter.on("kick",Em),kd.emitter.on("showGiftWindow",Km),kd.emitter.on("showLoginWindow",du),kd.emitter.on("setChatIframe",bh);let e=_u.getInstance();e.emitter.on("sendGift",$_),e.emitter.on("showGiftWindow",Km),e.emitter.on("showLoginWindow",du);let n=Id.getInstance();n.emitter.on("showLoginWindow",du),n.emitter.on("sendGift",k_);let i=Le.getInstance();function o(t,e){e==uu.getCid()&&(window.$(".chatroom-guanzhu").addClass("current"),window.$(".chatroom-guanzhu .textCtn").text("已关注"))}function s(t){t.forEach((t=>{e_(t.trumpet_type,t)})),n_()}function a(t,e,n){console.log("mouseoverPerson===="),ly&&clearTimeout(ly);ly=setTimeout((()=>{const i=window.$(n).offset(),o=window.$(n).outerWidth(),s=window.$(n).parents(".room-item-perons")[0];let a;s&&s.dataset.cid!=uu.getCid()&&(a=s.dataset.cid),kd.showUserFloatInfo({account:t,roomChannel:e,cid:a}).then((t=>{uu.roomInfo.channel!=e&&t.find(".chat-huiyuan-buttons .chat-huiyuan-chat-btn, .chat-huiyuan-buttons .chat-huiyuan-sentgift-btn").css("display","none"),uu.roomInfo.channel!=e&&uu.roomInfo.pcid!=a||t.find(".chat-huiyuan-buttons .chartOne2One").css("display","block");const n=window.$(t).outerHeight(),s=window.$(document.body).height();let r=i.left+o-10,c=i.top-56;s-n<c&&(c=s-190),t.css({top:c,left:r}),t.show()}))}),300)}function r(t,e,n){ly&&clearTimeout(ly)}function c(t){Om(t)}function l(t,e){if(t==uu.getChannel())return void he.ocRoomUsers(t);const n=Pt+"/Chatroom/getChatUserList?cid="+e+"&format=jsonp&uid=0";Promise.all([qt.get(Ot.getPcInfo(e)),qt.get(n)]).then((e=>{const n=e[0],i=e[1];if(0==n.error&&0==i.error){const e=n.data;he.addChannelUsers(i.data,t,e.anchor_ids,e.waiter_ids,e.cap_role),he.ocRoomUsers(t)}}))}function d(t,e,n){su(n)}function m(){Cd.getInstance().onReset(),le.getInstance().onReset(),mu.getInstance().onReset()}i.emitter.on("sendGift",k_),i.emitter.on("leaveTempTeam",(()=>cu(uu.getMeid()))),Gi.getInstance().emitter.on("sendGift",k_),Me.getInstance().showLoginWindow=du,Me.getInstance().showLevelModal=iu,my(),hy(),v_(),function(){const t=xt.getInstance().getMainVolume();window.$(".chat-voice-volume input[type='range']").val(t),0==t?$(".chat-function-yinliang").addClass("noSound"):$(".chat-function-yinliang").removeClass("noSound"),window.SVGA.volume=t/100}(),window.exitGamePage=Xh,window.exitMeetingPage=Zh,window.joinMeeting=Hm,qt.get(Ot.getBaseUrl()).then((t=>{if(0==t.error){const e=t.data,{ver:n,list:i}=e,o=bt.getBaseUrl();o?n>1*o.ver&&bt.setBaseUrl(e):bt.setBaseUrl(e)}})).catch((t=>null)).then((()=>{const t=bt.getBaseUrl().list;!function(t){_y=new j_(t),uu.setGlobalDdSocket(_y);_y.emitter.on("message",s_),yy=new fs,uu.setCommonRtc(yy),Mi.getInstance().bindAgoraClient(yy),Mi.getInstance().bindSocket(_y),le.getInstance().bindSocket(_y),an.getInstance().bindRctClient(yy),Cd.getInstance().bindSocket(_y),Cd.getInstance().bindAgoraClient(yy),ku.getInstance().register((()=>{yy.leave(),yy.emitter.emit("unpublishSuccess",!0)})),wm.getInstance().init(),P_(yy)}(new Map(t)),he.init("chat-left"),he.emitter.on("loadedRoomList",d),he.emitter.on("previousClearData",m),he.emitter.on("loadedRoomInfo",Jv),he.emitter.on("loadedRoomInfoError",vy),he.emitter.on("changeRoom",lu),he.emitter.on("loadroomusers",c),he.emitter.on("ocRoomUsers",l),he.emitter.on("mouseoverPerson",a),he.emitter.on("mouseLeavePerson",r),he.emitter.on("nologin",du),he.emitter.on("addattent",o),he.emitter.on("handleSetGlobalNoticeArr",s),as.getInstance()})),console.timeEnd("pagev9init")})),qt.get(Ot.regUserinfo()).then((t=>{if(0==t.code){const e=t.data,{uid:n,regtype:i,createtime:o,lastlogintime:s,timestamp:a}=e;if(a-o<3){const t={user_id:n,register_mode:i,register_type:"web",page_name:"register",web_domain:window.location.hostname,page:"chatroom"};Xm.track(t)}}})),(()=>{const t=window.location.href.substring(window.location.href.lastIndexOf("/")+1,-1==window.location.href.indexOf("?")?window.location.href.length:window.location.href.lastIndexOf("?"));t&&async function(t){Ct.readCookie("tgid")||window.$.ajax({url:`https://yapi${It?"-test":""}.`+window.MAIN_DOMAIN+"/Report/tg?cid="+t,dataType:"jsonp",type:"GET",success:function(t){0==t.error&&Ct.setCookie("tgid",t.data.tgid,30,"."+window.MAIN_DOMAIN)}})}(t)})(),window.$(document).ready((function(){Ct.readCookie("Tuwan_Passport")?hn.getInstance().setSrc():window.$.ajax({url:`https://user${It?"-test":""}.`+window.MAIN_DOMAIN+"/api/method/cookieinfo",dataType:"jsonp",type:"GET",success:function(t){if(0==t.code){const e=t.data;Ct.setCookie("Tuwan_Passport",e,90)}}})})),function(t,e,n){(t.ActiveXObject||"ActiveXObject"in t)&&e(".preinfotips").show();n.checkSystemRequirements()||"chrome"==Ct.is360Browser()||e(".preinfotips").show()}(window,window.jQuery,window.AgoraRTC),window.$(document).ready((function(){window.$(".pretipsinfo").on("mouseenter",(function(){window.$(this).find(".downloadhead").attr("src","https://res.tuwan.com/templet/play/chat/wave/images/downloadhead.gif"),window.$(this).find("#downloadmp3")[0].play()})),window.$(".pretipsinfo").on("mouseleave",(function(){window.$(this).find(".downloadhead").attr("src","https://res.tuwan.com/templet/play/chat/wave/images/downloadhead.png?v=1"),window.$(this).find("#downloadmp3")[0].pause()}))}));new class extends h{constructor(t){super(t),u(this,t,by,xy,g,{}),p("SvelteRegisterComponent",{component:this,tagName:"App",options:t,id:xy.name})}}({target:document.getElementById("app")});export{Xm as A,Ot as C,Ht as E,ye as I,tw as L,Na as M,Hs as P,Va as S,Vt as a,Xs as b,uu as c,Qs as d,Ws as e,Ks as f,Ys as g,Js as h,va as i,od as j,vc as k,Ea as l,Uc as m,Cu as n,xt as o,Co as p,qt as r,we as s};
//# sourceMappingURL=index.1725411945463.96b7844b.js.map
