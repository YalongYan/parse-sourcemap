{"version":3,"file":"main-08e2031d.js","sources":["../../src/js/components/fixedPopupContainer.svelte","../../src/js/bgm/setting/volumeSlider.svelte","../../src/js/bgm/setting/index.svelte","../../src/js/bgm/emitter.js","../../src/js/bgm/playingControl/index.svelte","../../src/js/chorusRoom/load_TRTC_Muisc.js","../../src/js/bgm/player.js","../../src/js/bgm/components/music.svelte","../../src/js/bgm/components/musics.svelte","../../src/js/bgm/library/const.js","../../src/js/bgm/library/page.svelte","../../src/js/bgm/quickBgmModal/index.svelte","../../src/js/bgm/library/index.svelte","../../src/js/bgm/popup/const.js","../../src/js/bgm/components/editItem.svelte","../../src/js/bgm/components/line.svelte","../../src/js/bgm/popup/editSongPopup.svelte","../../src/js/bgm/popup/editGroupPopup.svelte","../../src/js/bgm/editGroupModal/item.svelte","../../src/js/bgm/editGroupModal/index.svelte","../../src/js/bgm/popup/editMenuPopup.svelte","../../src/js/components/tagSelect.svelte","../../src/js/bgm/playingListModal/item.svelte","../../src/js/bgm/playingListModal/index.svelte","../../src/js/bgm/main.js"],"sourcesContent":["<script>\n    import { onMount } from 'svelte'\n\n    export const POSITION_TOP = 0\n    export const POSITION_BOTTOM = 1\n    \n    export let closeModal = null\n    export let handle = null\n    export let offsetX = 0\n    export let offsetY = 0\n    export let position = POSITION_TOP\n\n    let top = 0\n    let left = 0\n    let transformY = '0px'\n\n    onMount(() => {\n        const rect = handle.getBoundingClientRect()\n\n        left = rect.left + rect.width / 2 + offsetX\n        top = rect.top + offsetY\n\n        transformY = position == POSITION_BOTTOM ? `${rect.height + 10}px` : `calc(-100% - 10px)`\n    });\n</script>\n\n<div class=\"fixedPopupContainer\" on:click|stopPropagation={closeModal}>\n    <div \n        class=\"body\" \n        style=\"left: {left}px; top: {top}px; transform: translate(-50%, {transformY});\"\n        on:click|stopPropagation\n    >\n        <slot></slot>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .fixedPopupContainer {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 10000;\n\n        .body {\n            position: absolute;\n        }\n    }\n</style>","<script>\n    import FixedPopupContainer from '@/js/components/fixedPopupContainer.svelte';\n\n    import Bgm from '../main'\n\n    export let handle = null\n    export let closeModal = null\n\n    const instance = Bgm.getInstance()\n\n    let value = instance.volume\n\n    $: {\n        instance.volume = value\n        if (instance.currentPlayer) {\n            instance.currentPlayer.changeVolume(value)\n        }\n    }\n</script>\n\n<FixedPopupContainer {handle} offsetY={-55} {closeModal}>\n    <div class=\"slider\">\n        <input bind:value={value} min=\"0\" max=\"100\" step=\"1\" type=\"range\" name=\"\">\n    </div>\n</FixedPopupContainer>\n\n<style lang=\"scss\">\n    .slider {\n        background: #f0f0f0;\n        transform: rotate(-90deg);\n        padding: 5px 10px;\n        padding-bottom: 2px;\n        border: solid 1px #ddd;\n\n        input {\n            outline: 0;\n        }\n    }\n</style>","<script>\n    import Img from '@/js/components/img.svelte'\n\n    import showSvelteModal from '@/js/utils/showSvelteModal'\n    import Bgm from '../main'\n    import showTips from '@/js/showTip';\n    import VolumeSlider from './volumeSlider.svelte'\n\n    const instance = Bgm.getInstance()\n\n    let opened = instance.original // 默认伴奏\n\n    function setClick() {\n        instance.hideQuickBgmModalComp()\n        instance.showLibraryComp()\n    }\n\n    function showSlider() {\n        showSvelteModal(VolumeSlider, { handle: this })\n    }\n\n    function changeOpened() {\n        const player = instance.currentPlayer\n        if (player && player.playing == false) {\n            showTips('歌曲暂停期间，暂时不能切换伴奏')\n            return\n        }\n\n        opened = !opened\n        \n        instance.original = opened\n        if (instance.currentPlayer) {\n            instance.currentPlayer.changeTrack()\n        }\n    }\n\n    function playingListClick() {\n        instance.showPlayingListModal(this)\n    }\n</script>\n\n<div class=\"bgm_setting flex flex-ac\">\n    <p class=\"control\" on:click|stopPropagation={changeOpened}>原声：{opened ? '开' : '关'}</p>\n    <div class=\"flex flex-ac\">\n        <Img on:click={playingListClick} src=\"https://dynamics-share.tuwan.com/activity/23a35f206d2327f3b039442e15690596.png\"/>\n        <Img src=\"https://dynamics-share.tuwan.com/activity/ed99bd59128982af9e3921a505eaf8a3.png\" on:click={showSlider}/>\n        <Img on:click={setClick} src=\"https://dynamics-share.tuwan.com/activity/1ff779250dcb14daa877c5c75dbff9ea.png\"/>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .bgm_setting {\n        padding: 0 20px;\n        height: 48px;\n        justify-content: space-between;\n        box-shadow: 0px -2px 3px 0px rgba(0, 0, 0, 0.05);\n\n        .control {\n            font-size: 14px;\n            color: #999999;\n        }\n        \n        :global(img) {\n            width: 20px;\n            margin-left: 20px;\n        }\n    }\n</style>","import EventEmitter from '@/js/eventemitter'\n\nexport const emitter = new EventEmitter();\n\nexport const EMITTER_KEY_ADD_GROUP = 'EMITTER_KEY_ADD_GROUP' // 添加分组\nexport const EMITTER_KEY_ADD_SONG_TO_GROUP = 'EMITTER_KEY_ADD_SONG_TO_GROUP' // 添加歌曲至分组\nexport const EMITTER_KEY_DELETE_GROUP = 'EMITTER_KEY_DELETE_GROUP' // 删除分组\nexport const EMITTER_KEY_RENAME_GROUP = 'EMITTER_KEY_RENAME_GROUP' // 重命名\nexport const EMITTER_KEY_DELETE_SONG = 'EMITTER_KEY_DELETE_SONG' // 从分组删除歌曲\nexport const EMITTER_KEY_SET_WORK_SONG = 'EMITTER_KEY_SET_WORK_SONG' // 设置上档歌曲成功\nexport const EMITTER_KEY_PLAY_SONG = 'EMITTER_KEY_PLAY_SONG' // 播放歌曲\nexport const EMITTER_KEY_PAUSE_SONG = 'EMITTER_KEY_PAUSE_SONG' // 暂停歌曲\nexport const EMITTER_KEY_RESUME_SONG = 'EMITTER_KEY_RESUME_SONG' // 恢复歌曲\nexport const EMITTER_KEY_DESTROY_SONG = 'EMITTER_KEY_DESTROY_SONG' // 销毁歌曲\nexport const EMITTER_KEY_UPDATE_RECOMMEND = 'EMITTER_KEY_UPDATE_RECOMMEND' // 刷新系统推荐列表","<script>\n    import { onMount } from 'svelte'\n\n    import Img from '@/js/components/img.svelte'\n\n    import { EMITTER_KEY_PLAY_SONG, EMITTER_KEY_DESTROY_SONG, EMITTER_KEY_PAUSE_SONG, EMITTER_KEY_RESUME_SONG, emitter } from '../emitter'\n    import Bgm from '../main'\n\n    export function forceUpdate() {\n        forceUpdateIndex = forceUpdateIndex + 1\n    }\n\n    export let showPlaying = false\n\n    const instance = Bgm.getInstance()\n\n    let forceUpdateIndex = 0\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_PLAY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_PLAY_SONG, forceUpdate)\n    })\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n    })\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_RESUME_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_RESUME_SONG, forceUpdate)\n    })\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_PAUSE_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_PAUSE_SONG, forceUpdate)\n    })\n\n    let song = instance.currentPlayer\n\n    $: {\n        if (forceUpdateIndex)\n\n        song = instance.currentPlayer\n    }\n\n    function checkCanClick() {\n        return !!instance.currentPlayer\n    }\n\n    // 向前\n    function preClick() {\n        if (checkCanClick()) {\n            instance.playWithDirection(false, song.data, song.groupId)\n        }\n    }\n\n    // 暂停或者开始\n    function controlClick() {\n        if (checkCanClick()) {\n            if (song.playing) {\n                song.pause()\n            } else {\n                song.resume()\n            }\n\n            if (song.playing) {\n                emitter.emit(EMITTER_KEY_RESUME_SONG)\n            } else {\n                emitter.emit(EMITTER_KEY_PAUSE_SONG)\n            }\n        }\n    }\n\n    // 向后\n    function nextClick() {\n        if (checkCanClick()) {\n            instance.playWithDirection(true, song.data, song.groupId)\n        }\n    }\n\n    function playingListClick() {\n        instance.showPlayingListModal(this)\n    }\n</script>\n\n<div class=\"playing_control flex flex-ac\">\n    <div class=\"flex flex-ac\">\n        <Img class=\"logo\" src=\"https://dynamics-share.tuwan.com/activity/f5b61acd565c9d11a7b948a57defe23b.png\"/>\n        <div class=\"\">\n            <p class=\"name\">{song ? song.data.name : '暂无歌曲'}</p>\n            {#if song}\n                <p class=\"singer\">{song.data.singer}</p>\n            {/if}\n        </div>\n    </div>\n    <div class=\"flex flex-ac\">\n        {#if showPlaying}\n            <Img class=\"playing_list\" on:click={playingListClick} src=\"https://dynamics-share.tuwan.com/activity/23a35f206d2327f3b039442e15690596.png\"/>\n        {/if}\n        <Img class=\"pre\" src=\"https://dynamics-share.tuwan.com/activity/c587af81c834316d8d7729a319d61b84.png\" on:click={preClick}/>\n        <Img class=\"play_or_pause\" src=\"{song && song.playing ? 'https://dynamics-share.tuwan.com/activity/ad8e6b31a46278dda045cfca72f4c7be.png' : 'https://dynamics-share.tuwan.com/activity/d7822b441212cd079464037fba5e1f5d.png'}\" on:click={controlClick}/>\n        <Img class=\"next\" src=\"https://dynamics-share.tuwan.com/activity/568443023cdf42e6ac35e7018e737bbe.png\" on:click={nextClick}/>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .playing_control {\n        padding: 0 20px;\n        height: 60px;\n        box-shadow: 0px -2px 3px 0px rgba(0, 0, 0, 0.05);\n        justify-content: space-between;\n\n        :global(.logo) {\n            width: 46px;\n        }\n\n        .name, .singer {\n            margin-left: 10px;\n            width: 98px;\n            white-space: nowrap;\n            overflow: hidden;\n        }\n        .name {\n            font-size: 14px;\n            color: #999999;\n        }\n\n        .singer {\n            font-size: 12px;\n            color: #CDCDCD;\n        }\n\n        :global(.playing_list) {\n            width: 20px;\n            margin-right: 14px;\n            cursor: pointer;\n        }\n\n        :global(.pre) {\n            width: 15px;\n            cursor: pointer;\n        }\n\n        :global(.next) {\n            width: 15px;\n            cursor: pointer;\n        }\n\n        :global(.play_or_pause) {\n            margin: 0 14px;\n            width: 22px;\n            cursor: pointer;\n        }\n    }\n</style>","import { PLAY_STATUS_NORMAL, PLAY_STATUS_REQUEST_INFO, PLAY_STATUS_DONWLOADING, PLAY_STATUS_DONWLOAD_DONE, PLAY_STATUS_WORKER_DECODE, PLAY_STATUS_LOAD_TRACKS, PLAY_STATUS_PLAY_TRACK, PLAY_STATUS_PLAYING, PLAY_STATUS_STOP } from './loadMusicConst'\nimport { fetchRequest } from '@/js/utils/downloadRequest'\n;\nimport { common } from '@/js/common';\n/**\n * 这个对象负责用来下载音乐，播放音乐，并且回调各个时机，还能控制取消\n * 说白了这个类就是个加载播放音乐的一个流程控制类\n * 但是这个类是完全给chorusRoom定值的业务类\n */\n// export default class LoadMuiscZego {\nexport default class LoadMuiscTRTC {\n    constructor(engine) {\n        this._status = PLAY_STATUS_NORMAL // 当前歌曲的状态\n        this.statusChangeCb = null // 监听status发生变化的话，把函数传进来即可\n        this.playMusicTickCb = null // 播放每秒进行一次回调\n        this.downloadTickCb = null // 下载进度回调\n        this.downloadMuiscErrorCb = null // 下载歌曲失败\n        this.playendCb = null // 播放歌曲完成\n        this.code = null // 当前歌曲的code码\n        this.defaultGain = 0; // 0 伴奏 1 原唱\n        this.autoPlay = false // 是否下载完自动播放\n        this.isSeeked = false // 同步进度\n        this.volumeValue = 100\n        this.volumeMultiple = 1 // 声音放大的倍数\n        this.zcm = null\n        this.tickTime = 20\n        this.originalTrack = new Audio()\n        this.accompaniedTrack = new Audio()\n        this.resource_id = null\n        this.engine = engine;\n    }\n\n    static _decodeAudio = null\n\n    destroy() {\n        console.log('44444 : ');\n        if (this.status != PLAY_STATUS_STOP) {\n            console.log('55555 : ');\n            this.onStopLocalAudioMixin()\n        }\n    }\n\n    set status(value) {\n        this.statusChangeCb && this.statusChangeCb(value)\n\n        this._status = value\n    }\n\n    get status() {\n        return this._status\n    }\n\n    get isOriginalBgmStart() {\n        return this?.originalTrack?.getCurrentTime() > 0\n    }\n    \n    get isAccompanyBgmStart() {\n        return this?.accompaniedTrack?.getCurrentTime() > 0\n    }\n\n    preloadUrl(code) {\n        this.autoPlay = false\n        this.extractAudio(code);\n    }\n\n    // playWithUrl(code) {\n    //     this.autoPlay = true\n    //     this.extractAudio(code);\n    // }\n    playWithUrl(url) {\n        this.autoPlay = true\n        if (common.getRoomInfo().yjx_song_switch == 3) {\n            this.extractAudioNew();\n        } else {\n            this.extractAudio(url);\n        }\n    }\n\n     /**\n     * 音速达的\n     * @returns \n     */\n     async extractAudioNew() {\n        // this.status = PLAY_STATUS_DONWLOADING\n\n        // 数组的第0个是原唱 1是伴奏\n        await this.createCustomAudioTrackNew();\n                \n        if (this.autoPlay && this.status != PLAY_STATUS_PLAYING) {\n            await this.startPlay()\n        }\n    }\n\n    // 让worker去下载歌曲并解码\n    async extractAudio(code) {\n        this.status = PLAY_STATUS_DONWLOADING\n        \n        code = String(code)\n\n        // 加载歌曲目前还可能支持mp3格式，不用即构的下载功能了\n        if (code.indexOf('.mp3') >= 0) {\n            let urls = code.split('|')\n\n            try {\n                if (this.status == PLAY_STATUS_STOP) return\n                this.status = PLAY_STATUS_DONWLOAD_DONE\n                const res = await this.createCustomAudioTrack([urls[0], urls[1]]);\n                if (this.autoPlay && this.status != PLAY_STATUS_PLAYING) {\n                    await this.startPlay()\n                }\n            } catch (error) {\n                console.log(error);\n                this.downloadMuiscErrorCb && this.downloadMuiscErrorCb(error)\n            }\n        } else {\n            try {\n                const res = await this.zcm.requestResource({ songID: code, vendorID: 2 }, 1);\n                if (res.errorCode === 0 && res.resource.code === 0) {\n                    const resource_id = res.resource.data.resources[0].resource_id\n                    this.resource_id = resource_id\n                    const { errorCode, urls } = await this.zcm.download(resource_id);\n    \n                    if (errorCode === 0) {\n                        if (this.status == PLAY_STATUS_STOP) return\n\n                        this.status = PLAY_STATUS_DONWLOAD_DONE\n                        // 数组的第0个是原唱 1是伴奏\n                        const res = await this.createCustomAudioTrack(urls);\n                        if (this.autoPlay) {\n                            await this.startPlay()\n                        }\n                    } else {\n                        this.downloadMuiscErrorCb && this.downloadMuiscErrorCb()\n                        return\n                    }\n                } else {\n                    this.downloadMuiscErrorCb && this.downloadMuiscErrorCb()\n                    return\n                }\n            } catch (error) {\n                this.downloadMuiscErrorCb && this.downloadMuiscErrorCb(error)\n            }\n        }\n    }\n\n    async startPlay() {\n        if (this.status == PLAY_STATUS_STOP) return\n\n        this.autoPlay = true\n        // 状态必须是已经准备好才行\n        if (this.status == PLAY_STATUS_LOAD_TRACKS) {\n            await this.playCustomAudioTrack();\n            this.status = PLAY_STATUS_PLAYING\n            this.startReportTimer()\n        } else {\n            throw new Error('startPlay失败，因为歌曲没加载好了')\n        }\n    }\n\n    /**\n     * 换成音速达的了，声网封装的音速达，自己会创建好track\n     * @returns \n     */\n    async createCustomAudioTrackNew() {\n        this.originalTrack = this.engine.originalBgmTrack;\n        this.originalTrack.setVolume(this.volumeValue * this.volumeMultiple);\n\n        this.accompaniedTrack = this.engine.accompanyBgmTrack;\n        this.accompaniedTrack.setVolume(this.volumeValue * this.volumeMultiple);\n        this.status = PLAY_STATUS_LOAD_TRACKS\n    }\n\n    async createCustomAudioTrack(arr) {\n        let value = 0;\n        const that = this;\n        return new Promise((resolve, reject) => {\n            function fn () {\n                value++;\n                if (value == 2) {\n                    that.status = PLAY_STATUS_LOAD_TRACKS;\n                    resolve(1);\n                }\n            }PLAY_STATUS_LOAD_TRACKS\n            if (this.status == PLAY_STATUS_STOP) return\n\n            const [music1, music2] = arr;\n            \n            this.originalTrack.crossOrigin = 'anonymous'\n            this.originalTrack.src = music1\n            this.originalTrack.volume = this.volumeValue / 100;\n\n            this.accompaniedTrack.crossOrigin = 'anonymous'\n            this.accompaniedTrack.src = music2\n            this.accompaniedTrack.volume = this.volumeValue / 100;\n\n            // 没有这个 获取audio trick的时候报错\n            this.originalTrack.removeEventListener('canplay', fn);\n            this.accompaniedTrack.removeEventListener('canplay', fn);\n\n            this.originalTrack.addEventListener('canplay', fn);\n            this.accompaniedTrack.addEventListener('canplay', fn);\n        })\n    }\n\n    async playCustomAudioTrack() {\n        if (common.getRoomInfo().yjx_song_switch == 3) { // 音速达的区分下\n            if (this.status == PLAY_STATUS_STOP) return\n        \n            this.status = PLAY_STATUS_PLAY_TRACK\n            if (this.defaultGain == 1) {\n                if (this.originalTrack) {\n                    let time = this.originalTrack.getCurrentTime();\n                    this.originalTrack.play();\n                    this.originalTrack.startProcessAudioBuffer();\n                    this.originalTrack.seekAudioBuffer(time);\n                    if (this._pause) {\n                        this.originalTrack.pauseProcessAudioBuffer();\n                    }\n                }\n            } else {\n                if (this.accompaniedTrack) {\n                    let time = this.accompaniedTrack.getCurrentTime();\n                    this.accompaniedTrack.play();\n                    this.accompaniedTrack.startProcessAudioBuffer();\n                    this.accompaniedTrack.seekAudioBuffer(time);\n                    if (this._pause) {\n                        this.accompaniedTrack.pauseProcessAudioBuffer();\n                    }\n                }\n            }\n        } else {\n            if (this.status == PLAY_STATUS_STOP) return\n    \n            this.status = PLAY_STATUS_PLAY_TRACK\n    \n            this.originalTrack.muted = this.defaultGain == 0;\n            this.accompaniedTrack.muted = this.defaultGain == 1;\n            \n            this.originalTrack.play();\n            this.accompaniedTrack.play();\n        }\n    }\n\n    onTaggerGain() {\n        if (common.getRoomInfo().yjx_song_switch == 3) { // 音速达\n            if (this.status == PLAY_STATUS_STOP) return\n            // this.engine.toggleBgmTrack();\n            if(this.defaultGain == 1){\n                if (this.originalTrack) {\n                    if (common.getRoomInfo().yjx_song_switch == 3) {\n                        let time1 = this.originalTrack.getCurrentTime();\n                        let time2 = this.accompaniedTrack.getCurrentTime();\n                        let time = time1 > time2 ? time1 : time2;\n                        this.accompaniedTrack?.pauseProcessAudioBuffer();\n                        // switch to original\n                        if (this.isOriginalBgmStart) {\n                            this.originalTrack?.seekAudioBuffer(time)\n                            if (!this._pause) {\n                            this.originalTrack?.resumeProcessAudioBuffer()\n                            }\n                        } else {\n                            if (!this._pause) {\n                            this.originalTrack?.startProcessAudioBuffer();\n                            this.originalTrack?.seekAudioBuffer(time)\n                            this.originalTrack?.play()\n                            } else {\n                            this.originalTrack?.seekAudioBuffer(time)\n                            }\n                        }\n                    } else {\n                        this.accompaniedTrack.stop();\n                        let time = this.accompaniedTrack.getCurrentTime();\n                        this.accompaniedTrack.stopProcessAudioBuffer();\n                        if (!this._pause) {\n                            this.originalTrack.play();\n                        }\n                        this.originalTrack.startProcessAudioBuffer();\n                        this.originalTrack.seekAudioBuffer(time);\n                    }\n                }\n    \n            }else{\n                if (this.originalTrack) {\n                    if (common.getRoomInfo().yjx_song_switch == 3) {\n                        let time1 = this.originalTrack.getCurrentTime();\n                        let time2 = this.accompaniedTrack.getCurrentTime();\n                        let time = time1 > time2 ? time1 : time2;\n                        this.originalTrack?.pauseProcessAudioBuffer();\n                        // switch to accompany\n                        if (this.isAccompanyBgmStart) {\n                            this.accompaniedTrack?.seekAudioBuffer(time)\n                            // if (this.bgmStatus == BgmStatus.PLAYING) {\n                            if (!this._pause) {\n                                this.accompaniedTrack?.resumeProcessAudioBuffer()\n                            }\n                        } else {\n                            if (!this._pause) {\n                                this.accompaniedTrack?.startProcessAudioBuffer();\n                                this.accompaniedTrack?.seekAudioBuffer(time)\n                                this.accompaniedTrack?.play()\n                            } else {\n                                this.accompaniedTrack?.seekAudioBuffer(time)\n                            }\n                        }\n                    } else {\n                        this.originalTrack.stop();\n                        let time = this.originalTrack.getCurrentTime();\n                        this.originalTrack.stopProcessAudioBuffer();\n                        if (!this._pause) {\n                            this.accompaniedTrack.play();\n                        }\n                        this.accompaniedTrack.startProcessAudioBuffer();\n                        this.accompaniedTrack.seekAudioBuffer(time);\n                    }\n                }\n            }\n        } else { // 音集协\n            if (this.status == PLAY_STATUS_STOP) return\n    \n            if(this.defaultGain == 1){\n                if (this.originalTrack) {\n                    this.accompaniedTrack.muted = true;\n                    this.originalTrack.muted = false;\n                }\n            }else{\n                if (this.originalTrack) {\n                    this.accompaniedTrack.muted = false;\n                    this.originalTrack.muted = true;\n                }\n            }\n        }\n    }\n   \n\n    progressTick(one, two) {\n        this.downloadTickCb && this.downloadTickCb(one * 0.5 + two * 0.5)\n    }\n\n    seekOnce(time) {\n        if (this.status != PLAY_STATUS_LOAD_TRACKS) return\n\n        if (!this.originalTrack || !this.accompaniedTrack) {\n            return;\n        }\n        \n        if (this.isSeeked) {\n            return\n        }\n        this.isSeeked = true\n        this.seek(time)\n        return true\n    }\n\n    seek(time) {\n        if (this.status == PLAY_STATUS_STOP) return\n\n        if (!this.originalTrack || !this.accompaniedTrack) {\n            return;\n        }\n        \n        this.originalTrack.currentTime = time;\n        this.accompaniedTrack.currentTime = time;\n    }\n\n    pause() {\n        this.originalTrack && this.originalTrack.pause()\n        this.accompaniedTrack && this.accompaniedTrack.pause()\n    }\n\n    resume() {\n        this.originalTrack && this.originalTrack.play()\n        this.accompaniedTrack && this.accompaniedTrack.play()\n    }\n\n    currentTrack() {\n        return this.defaultGain == 1 ? this.originalTrack : this.accompaniedTrack\n    }\n\n    startReportTimer() {\n        const duration = this.accompaniedTrack.duration\n\n        this.reportTimer = setInterval(() => {\n            let time = 0;\n            if (this.originalTrack && this.defaultGain == 1) {\n                time = this.originalTrack.currentTime;\n            } else if (this.accompaniedTrack && this.defaultGain == 0) {\n                time = this.accompaniedTrack.currentTime;\n            }\n\n            this.playMusicTick(time, duration)\n        }, this.tickTime);\n    }\n\n    playMusicTick(ct, duration) {\n        // ct有可能出现等于0的时候\n        if (ct > 0) {\n            this.playMusicTickCb && this.playMusicTickCb(ct, duration)\n        }\n        \n        if (ct >= duration) { // ct == 0 || \n            this.onStopLocalAudioMixin();\n            this.playendCb && this.playendCb()\n        }\n    }\n\n    changeVolume(value) {\n        this.originalTrack && (this.originalTrack.volume = value / 100);\n        this.accompaniedTrack && (this.accompaniedTrack.volume = value / 100);\n    }\n    \n    onStopLocalAudioMixin(){\n        this.status = PLAY_STATUS_STOP\n\n        this.clearReportTimer()\n        this.destoryAudioTrack()\n    }\n    \n    clearReportTimer() {\n        if (this.reportTimer) {\n            window.clearInterval(this.reportTimer)\n            this.reportTimer = null\n        }\n    }\n\n    destoryAudioTrack() {\n        if (this.originalTrack) {\n            this.originalTrack.pause();\n            this.originalTrack = null\n        }\n        if (this.accompaniedTrack) {\n            this.accompaniedTrack.pause();\n            this.accompaniedTrack = null\n        }\n    }\n}",";\nimport { common } from '@/js/common';\nimport { request } from '@/utils/request';\nimport { ChatUrls } from '@/js/config'\nimport showTips from '@/js/showTip'\nimport LoadMuisc from '../chorusRoom/loadMuisc';\nimport Load_TRTC_Muisc from '../chorusRoom/load_TRTC_Muisc';\nimport Bgm from './main';\nimport { PLAY_STATUS_LOAD_TRACKS } from '../chorusRoom/loadMusicConst'\nimport LoadMuiscZego from '../chorusRoom/loadMuiscZego'\nimport { Engine } from '@/js/sdk/yinsuda/engine2/index';\n\n\n\nexport default class Player {\n    constructor(data, groupId) {\n        this.endCb = null\n        this.errorCb = null\n        this.data = data\n        this.groupId = groupId\n        this.timer = null\n        this.playing = true\n        this.original = false // 默认伴奏\n        this.destroyed = false\n        this.loadMuisc = null\n        this.publishSteam = false\n        this.lyric = null;\n        this.pitchData = null;\n        this.bgmType = 1; // bgmType === 1 ? \"原唱\" : \"伴奏\" \n        // this.isLoadingBgm = false; // 正在加载的过程中就不让点击其他歌曲了\n    }\n\n    // 挂载到 static上 不用每次new的时候都创建新的对象，节省点内存\n    static engine = new Engine();\n    static isLoadingBgm = false; // 因为音速达加载比较慢，加这个是为了 快速点击切换歌曲的时候 会导致 多个歌曲同时播放\n\n    destroy() {\n        this.clearTimer()\n        this.unpublishTracks()\n        this.destroyed = true\n        this.loadMuisc && this.loadMuisc.destroy()\n    }\n\n    clearTimer() {\n        window.clearInterval(this.timer)\n    }\n\n    async play() {\n        // 3 是音速达\n        if (common.getRoomInfo().yjx_song_switch == 3) {\n            // alert(this.isLoadingBgm)\n            // if (Player.isLoadingBgm) {\n            //     showTips('正在加载上一首歌曲,请稍等...');\n            //     // return;\n            // }\n\n            Player.isLoadingBgm = true;\n\n            showTips('正在加载歌曲...');\n        \n            try {\n                if (this.destroyed) return;\n                const song_code = this.data.song_code + ''; // 必须是字符串格式\n                // const song_code = '40289835'; // 这个是歌曲十年的code\n                // const song_code = '32131416'; // 这个是歌曲  一千年以后 的code\n                await Player.engine.setUser(common.getMeid());\n                this.lyric = await Player.engine.getLyric(song_code, true);\n                // this.lyric = await Player.engine.getLyric(song_code, true);\n                this.pitchData = await Player.engine.getPitchData(song_code);\n\n                Player.engine.prepare();\n                await Player.engine.genBgmTracks(song_code, true);\n                // await Player.engine.playBgm(this.bgmType);\n                \n                this.createLoadMuisc(this.data);\n                this.loadMuisc.playWithUrl();\n\n                this.playing = true;\n                Player.isLoadingBgm = false;\n                \n            } catch (error) {\n                console.log('error---')\n                console.log(error)\n                showTips(\"网络错误,请稍后再试..\")\n                Player.isLoadingBgm = false;\n            }\n        } else {\n            this.playing = true\n            request.get(ChatUrls.getSongInfo(this.data.song_code, this.data.token, 1)).then(res=>{\n                if (this.destroyed) return\n    \n                if (res.error == 0) {\n                    const songUrl = res.data.playUrl\n    \n                    if (!songUrl || songUrl == '') {\n                        showTips('歌曲链接为空，请手动切换歌曲')\n                        return\n                    }\n    \n                    if (!songUrl) {\n                        showTips('歌曲有问题，链接为空，请手动切换歌曲')\n                        return\n                    }\n    \n                    let urls = songUrl.split('|')\n                    if (urls.length != 2) {\n                        showTips('歌曲有问题，缺少原唱或者伴奏，请手动切换歌曲')\n                        return\n                    }\n    \n                    if (urls[0].indexOf('.mp3') < 0 || urls[1].indexOf('.mp3') < 0) {\n                        showTips('歌曲类型有问题，返回了不是mp3的链接，请手动切换歌曲')\n                        return\n                    }\n                    \n                    this.createLoadMuisc(res.data)\n                    this.loadMuisc.playWithUrl(songUrl)\n                } else {\n                    showTips(res.error_msg)\n                }\n            }).catch(err=>{\n                console.log('error---')\n                console.log(error)\n                showTips(\"网络错误,请稍后再试..\")\n            })\n        }\n        \n    }\n\n    createLoadMuisc(data) {\n        let RealLoadMusic = common.isZegoRTC() ? LoadMuiscZego : LoadMuisc;\n        if (common.isTRTC()) {\n            RealLoadMusic = Load_TRTC_Muisc;\n        }\n        this.loadMuisc = new RealLoadMusic(Player.engine);\n        this.loadMuisc.tickTime = 200\n        this.loadMuisc.volumeMultiple = 1\n        this.loadMuisc.volumeValue = Bgm.getInstance().volume\n        this.loadMuisc.defaultGain = Bgm.getInstance().original ? 1 : 0\n        this.loadMuisc.code = data.song_code\n        this.loadMuisc.statusChangeCb = this.musicStateChange.bind(this)\n        this.loadMuisc.playendCb = this.endCb ? this.endCb.bind(this) : null\n        this.loadMuisc.downloadMuiscErrorCb = this.errorCb ? this.errorCb.bind(this) : null\n    }\n\n    unpublishTracks() {\n        console.log('player 触发 unpublishTracks')\n        if (this.loadMuisc && this.loadMuisc.originalTrack && this.loadMuisc.accompaniedTrack) {\n            if (common.isTRTC()) {\n                if (common.getRoomInfo().yjx_song_switch == 3) {\n                    common.globalRtcClient.unpublishCustomAudioTrack(Player.engine.originalBgmTrack, Player.engine.accompanyBgmTrack);\n                } else {\n                    common.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.originalTrack, this.loadMuisc.accompaniedTrack);\n                }\n            } else {\n                if (common.getRoomInfo().yjx_song_switch == 3) {\n                    common.globalRtcClient.unpublishCustomAudioTrack(Player.engine.originalBgmTrack)\n                    common.globalRtcClient.unpublishCustomAudioTrack(Player.engine.accompanyBgmTrack)\n                } else {\n                    common.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.originalTrack)\n                    common.globalRtcClient.unpublishCustomAudioTrack(this.loadMuisc.accompaniedTrack)\n                }\n            }\n        }\n    }\n\n    // 把 bgm 的轨迹推送到远端\n    publishTracks() {\n        console.log('player 触发 publishTracks')\n        if (common.getRoomInfo().yjx_song_switch == 3) { // 音速达\n            if (Player.engine && Player.engine.originalBgmTrack && Player.engine.accompanyBgmTrack) {\n                if (common.isTRTC()) {\n                    common.globalRtcClient.publishCustomAudioTrack(Player.engine.originalBgmTrack, Player.engine.accompanyBgmTrack);\n                } else {\n                    common.globalRtcClient.publishCustomAudioTrack(Player.engine.originalBgmTrack);\n                    common.globalRtcClient.publishCustomAudioTrack(Player.engine.accompanyBgmTrack);\n                }\n            }\n        } else { // 音集协\n            if (common.globalRtcClient.localAudio && this.loadMuisc && this.loadMuisc.originalTrack && this.loadMuisc.accompaniedTrack) {\n                if (common.isTRTC()) {\n                    common.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.originalTrack, this.loadMuisc.accompaniedTrack)\n                } else {\n                    common.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.originalTrack)\n                    common.globalRtcClient.publishCustomAudioTrack(this.loadMuisc.accompaniedTrack)\n                }\n            }\n        }\n    }\n    \n    musicStateChange(state) {\n        console.log('触发 musicStateChange');\n        if (state == PLAY_STATUS_LOAD_TRACKS && this.publishSteam) {\n            if (common.globalRtcClient.localAudio) {\n                Bgm.getInstance().publishTracks()\n            } else {\n                this.timer = setInterval(() => {\n                    this.clearTimer()\n    \n                    // 这边可能比链接声网还快了\n                    if (common.globalRtcClient.localAudio) {\n                        this.musicStateChange(PLAY_STATUS_LOAD_TRACKS)\n                    }\n                }, 200);\n            }\n        }\n    }\n\n    resume() {\n        this.playing = true\n\n        this.loadMuisc && this.loadMuisc.resume()\n    }\n\n    pause() {\n        this.playing = false\n\n        this.loadMuisc && this.loadMuisc.pause()\n    }\n\n    // 切换声道，原生或者伴奏\n    changeTrack() {\n        if (this.loadMuisc) {\n            this.loadMuisc.defaultGain = Bgm.getInstance().original ? 1 : 0\n            this.loadMuisc && this.loadMuisc.onTaggerGain()\n        }\n    }\n\n    changeVolume(value) {\n        this.loadMuisc && this.loadMuisc.changeVolume(value)\n    }\n}","<script>\n    import Img from '@/js/components/img.svelte'\n    import Player from '../player';\n    import showTips from '@/js/showTip';\n\n    export let data = {}\n    export let cls = ''\n    export let bodyClick\n    export let addClick\n    export let showAdd = true\n    export let showDang = false\n\n    function formatTime(seconds) {\n        return String(parseInt(String(seconds / 60))).padStart(2, '0') + ':' + String(seconds % 60).padStart(2, '0')\n    }\n\n    function _addClick() {\n        addClick && addClick(data, this)\n    }\n\n    function _bodyClick() {\n        if (Player.isLoadingBgm){\n            showTips('上一首歌曲正在加载中，请稍后~')\n            return;\n        }\n        // 如果已经播放中了\n        if (cls.indexOf('playing') >= 0) return\n\n        bodyClick && bodyClick(data)\n    }\n</script>\n\n<div class=\"music {cls}\" on:click|stopPropagation={_bodyClick}>\n    <div class=\"\">\n        <div class=\"flex flex-ac\">\n            <p class=\"name\">{data.name}</p>\n            {#if showDang}\n                <Img class=\"dang\" src=\"https://dynamics-share.tuwan.com/activity/0d99c971361c9fb6ace81b5a6db492eb.png\"/>\n            {/if}\n            <Img class=\"effect\" src=\"https://res.tuwan.com/chatroom/images/icon_song_playing.gif\"/>\n        </div>\n        <div class=\"flex flex-ac\">\n            <p class=\"singer\">{data.singer}</p>\n            <p class=\"time\">{formatTime(data.duration)}</p>\n        </div>\n    </div>\n    {#if showAdd}\n        <Img class=\"add\" src=\"https://dynamics-share.tuwan.com/activity/9313d29d6b6d44cc94570e72962d9124.png\" on:click={_addClick}/>\n    {/if}\n</div>\n\n<style lang=\"scss\">\n    .music {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        height: 60px;\n        cursor: pointer;\n\n        &.playing {\n            :global(.effect) {\n                display: block;\n            }\n\n            .name {\n                color: #7D4BF5;\n            }\n        }\n\n        .name {\n            font-size: 16px;\n            font-weight: bold;\n            color: #333333;\n        }\n\n        .singer {\n            margin-top: 3px;\n            font-size: 13px;\n            line-height: 15px;\n            color: #C5C5C5;\n        }\n\n        .time {\n            margin-left: 10px;\n            margin-top: 3px;\n            font-size: 12px;\n            color: #CDCDCD;\n            line-height: 15px;\n        }\n\n        :global(.dang) {\n            margin-left: 7px;\n            width: 15px;\n        }\n\n        :global(.effect) {\n            margin-left: 7px;\n            width: 13px;\n            display: none;\n        }\n\n        :global(.add) {\n            width: 23px;\n            cursor: pointer;\n        }\n\n        :global(.btn) {\n            font-size: 16px;\n            font-weight: 500;\n            color: #FFFFFF;\n            width: 80px;\n            line-height: 40px;\n            border-radius: 40px;\n            text-align: center;\n            background: linear-gradient(to bottom, #6478FF, #8E47FC);\n            cursor: pointer;\n        }\n\n        :global(.btn.disable) {\n            background: #D3D4FF;\n        }\n    }\n</style>","<script>\n    import Music from './music.svelte'\n    import ScrollView from '@/js/components/scrollView.svelte'\n\n    export let data\n    export let clickMuiscCb\n    export let addMuiscCb\n    export let scrollBottomCb\n    export let showAdd = true\n    export let playingCode\n    export let dangCode\n</script>\n\n<ScrollView class=\"musics\" {scrollBottomCb}>\n    {#each data as item}\n        <Music data={item} cls={`${playingCode == item.song_code ? 'playing' : ''}`} showDang={dangCode == item.song_code} showAdd={showAdd} bodyClick={clickMuiscCb} addClick={addMuiscCb}/>\n    {/each}\n</ScrollView>\n\n<style lang=\"scss\">\n</style>","export const MENU_TYPE_QUKU = 0 // 推荐\nexport const MENU_TYPE_MINE = 1 // 我的歌单\nexport const TYPE_SEARCH = 2 // 搜索\nexport const MENU_TYPE_QUICK = 3 // 快捷歌单弹窗\n\nexport const GROUP_TYPE_0 = 0 // 系统分类\nexport const GROUP_TYPE_1 = 1 // 我的分类\n\nexport const DEFAULT_CATETORY_TYPE = -1 // 快捷歌单的默认第一个分类是猜你喜欢\n\nexport const SUBTYPE_RECOMMEND = 'recommend'\nexport const SUBTYPE_MINE = 'mine'\nexport const SUBTYPE_QUKU = 'quku'\n\nexport const SUBTYPE_RECOMMEND_1 = 1 // 推荐分类里面的默认推荐","<script>\n    import { onMount } from 'svelte'\n\n    import { ChatUrls } from '@/js/config';\n    import { common } from '@/js/common';\n    import { request } from '@/utils/request';\n    import Bgm from '../main'\n\n    import Category from '@/js/components/category.svelte'\n    import Empty from '@/js/components/empty.svelte'\n    import Musics from '../components/musics.svelte'\n    import Search from '@/js/components/search.svelte'\n    import Img from '@/js/components/img.svelte'\n\n    import Analytics from '@/js/analytics'\n\n    import { MENU_TYPE_QUKU, MENU_TYPE_MINE, MENU_TYPE_QUICK, DEFAULT_CATETORY_TYPE, SUBTYPE_RECOMMEND, SUBTYPE_MINE, SUBTYPE_QUKU, SUBTYPE_RECOMMEND_1 } from './const'\n    import { EMITTER_KEY_DELETE_GROUP, EMITTER_KEY_ADD_GROUP, EMITTER_KEY_RENAME_GROUP, EMITTER_KEY_DELETE_SONG, EMITTER_KEY_ADD_SONG_TO_GROUP, EMITTER_KEY_PLAY_SONG, EMITTER_KEY_DESTROY_SONG, EMITTER_KEY_SET_WORK_SONG, EMITTER_KEY_UPDATE_RECOMMEND, emitter } from '../emitter'\n    \n    // 菜单分类，是快捷菜单，还是曲库，还是我的歌单\n    export let menuType\n    // 默认只是加载数据，但是不渲染，因为某些地方需要用到数据\n    export let show = false\n    // 强制刷新\n    export function forceUpdate() {\n        forceUpdateIndex = forceUpdateIndex + 1\n    }\n\n    const instance = Bgm.getInstance()\n\n    let forceUpdateIndex = 0\n\n    // 存放当前所有分类的数据\n    let data = {}\n    // 存放搜索的数据\n    let searchData = null\n\n    // 正在播放的歌曲\n    let playingCode = ''\n\n    // 上档歌曲\n    let dangCode = ''\n\n    // 歌曲列表\n    let realMusicList = null\n\n    // 搜索框文字\n    let searchText = '' \n\n    // 分类远端数据\n    let categoryData = null\n    let categoryIndex = -1 // 分类列表默认还没有数据，所以是-1\n    let categoryChange = idx => categoryIndex = idx\n\n    // 请求曲库下面的分类，再通过第一个分类去请求列表\n    onMount(() => {\n        requestCategoryData()\n\t});\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DELETE_GROUP, reloadCategroy)\n        return ()=> emitter.off(EMITTER_KEY_DELETE_GROUP, reloadCategroy)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_ADD_GROUP, reloadCategroy)\n        return ()=> emitter.off(EMITTER_KEY_ADD_GROUP, reloadCategroy)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_RENAME_GROUP, reloadCategroy)\n        return ()=> emitter.off(EMITTER_KEY_RENAME_GROUP, reloadCategroy)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DELETE_SONG, deleteSong)\n        return ()=> emitter.off(EMITTER_KEY_DELETE_SONG, deleteSong)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_ADD_SONG_TO_GROUP, moveToGroup)\n        return ()=> emitter.off(EMITTER_KEY_ADD_SONG_TO_GROUP, moveToGroup)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_PLAY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_PLAY_SONG, forceUpdate)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_SET_WORK_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_SET_WORK_SONG, forceUpdate)\n    })\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_UPDATE_RECOMMEND, refreshMineLike)\n        return ()=> emitter.off(EMITTER_KEY_UPDATE_RECOMMEND, refreshMineLike)\n    })\n\n    // 搜索歌曲\n    function requestSearchList() {\n        request.get(ChatUrls.getBgmSearchBgm(searchText)).then(res=>{\n            if (res.error == 0) {\n                searchData = res.data.list || []\n            }\n        })\n    }\n\n    // 刷新猜你喜欢\n    function refreshMineLike() {\n        if (menuType == MENU_TYPE_QUKU) {\n            categoryIndex != -1 && requestMuiscList(true, 0)\n        }\n    }\n\n    // 刷新推荐\n    export function refreshRecommend() {\n        if (menuType == MENU_TYPE_QUICK) {\n            if (categoryIndex != -1) {\n                let cacheList = getMusicList(0)\n                if (!cacheList || cacheList.length == 0) {\n                    requestMuiscList(true, 0)\n                }\n            }\n        }\n    }\n    \n    function requestCategoryData(refresh = false) {\n        let promiseall = []\n\n        if ( menuType == MENU_TYPE_QUICK) {\n            promiseall = [request.get(ChatUrls.getBgmRecommendAndCustomTabs()), request.get(ChatUrls.getBgmMineGroup())]\n        } else if (menuType == MENU_TYPE_QUKU) {\n            promiseall = [request.get(ChatUrls.getBgmCategroy())]\n        } else if (menuType == MENU_TYPE_MINE) {\n            promiseall = [request.get(ChatUrls.getBgmMineGroup())]\n        }\n        \n        Promise.all(promiseall).then(ret =>{\n            const previousId = categoryIndex != -1 ? categoryData[categoryIndex].id : null\n\n            if ( menuType == MENU_TYPE_QUICK) {\n                if (ret[0].error == 0 && ret[1].error == 0) {\n                    categoryData = [\n                        ...ret[0].data.map(item => ({...item, type: item.tabId, __from: SUBTYPE_RECOMMEND})), \n                        ...ret[1].data.map(item => ({...item, type: item.id, __from: SUBTYPE_MINE}))\n                    ]\n                } else {\n                    // 接口出错了，先不容错了，以后再说\n                }\n            } else if (menuType == MENU_TYPE_QUKU) {\n                categoryData = ret[0].data.map(item => ({...item, __from: SUBTYPE_QUKU}))\n            } else if (menuType == MENU_TYPE_MINE) {\n                categoryData = ret[0].data.map(item => ({...item, type: item.id, __from: SUBTYPE_MINE}))\n            }\n            \n            if (refresh) {\n                // 删掉的可能正好是之前选中的那个标签，然后默认选到0\n                if (categoryData.findIndex(item => item.id == previousId) < 0) {\n                    categoryIndex = 0\n                }\n            } else {\n                if (categoryData?.length) {\n                    categoryIndex = 0\n                }\n            }\n        })\n    }\n\n    // 刷新分类\n    function reloadCategroy() {\n        if (menuType == MENU_TYPE_MINE || menuType == MENU_TYPE_QUICK) {\n            requestCategoryData(true)\n        }\n    }\n    \n    // 删除歌曲\n    function deleteSong(code) {\n        if (menuType != MENU_TYPE_QUKU) {\n            for (const key in data) {\n                if (parseInt(key, 10) != DEFAULT_CATETORY_TYPE) {\n                    let list = data[key] || []\n                    const idx = list.findIndex(item => item.song_code == code)\n                    if (idx >= 0) {\n                        list.splice(idx, 1)\n                        list = [...list]\n                    }\n                    data = {...data, [key]: list}\n                }\n            }\n        }\n    }\n\n    // 移动歌曲至分组\n    function moveToGroup(code, groupId) {\n        deleteSong(code)\n\n        if (menuType != MENU_TYPE_QUKU) {\n            requestMuiscList(true, categoryData.findIndex(item => item.type == groupId))\n        }\n    }\n    \n    // 请求分类下面的歌曲列表，多判断了下缓存\n    function requestMuiscList(force = false, _categoryIndex = categoryIndex) {\n        if (_categoryIndex == -1) {\n        } else {\n            let cacheList = getMusicList(_categoryIndex)\n\n            if (cacheList && cacheList.length > 0 && force == false) {\n            } else {\n                requestList(categoryData[_categoryIndex])\n            }\n        }\n    }\n\n    // 请求分类下面的歌曲列表\n    function requestList(subData, id) {\n        let url = ''\n\n        if (menuType == MENU_TYPE_QUKU) {\n            url = ChatUrls.getBgmListWithCategroyType(subData.type, id, 50)\n        } else if (menuType == MENU_TYPE_MINE) {\n            url = ChatUrls.getBgmListWithGroupId(subData.type, id)\n        } else if (menuType == MENU_TYPE_QUICK) {\n            // 快捷菜单里面不是推荐就是我自己\n            if (subData.__from == SUBTYPE_RECOMMEND) {\n                // 必须是推荐\n                if (subData.type == SUBTYPE_RECOMMEND_1 && Bgm.getInstance().recommendList.length) {\n                    const key = getSubdataKey(subData)\n                    data[key] = Bgm.getInstance().recommendList\n                    data = data\n                    return\n                }\n\n                url = ChatUrls.getBgmRecommendAndCustomTabSongs(common.getCid(), subData.type)\n            } else {\n                url = ChatUrls.getBgmListWithGroupId(subData.type, id)\n            }\n        }\n\n        request.get(url).then(res => {\n            if (res.error == 0) {\n                const list = res.data || []\n\n                // 快捷窗口里面的都是一页，歌单弹窗里面的曲库只有系统默认是一页，我的歌单也是一页\n                const key = getSubdataKey(subData)\n\n                if (onlyOnePage(subData.type)) {\n                    data[key] = list\n                } else {\n                    const oldList = data[key] || []\n                    data[key] = oldList.concat(list)\n                }\n                \n                data = data\n\n                // 如果是推荐的话，就赋值\n                if (subData.__from == SUBTYPE_RECOMMEND && subData.type == SUBTYPE_RECOMMEND_1) {\n                    if (list.length) {\n                        Bgm.getInstance().recommendList = list\n                    }\n                }\n            }\n        })\n    }\n\n    // 因为快捷惨淡的列表数据以type为key可能是重复\n    function getSubdataKey(data) {\n        return `${data.__from}_${data.type}`\n    }\n\n    function onlyOnePage(subtype) {\n        return menuType == MENU_TYPE_QUICK || menuType == MENU_TYPE_MINE || (menuType == MENU_TYPE_QUKU && subtype == DEFAULT_CATETORY_TYPE)\n    }\n\n    // 返回分类的缓存数据\n    function getMusicList(_categoryIndex = categoryIndex) {\n        let ret = null\n\n        if (menuType == MENU_TYPE_QUKU && searchText.length > 0) {\n            ret = searchData\n        } else {\n            if (_categoryIndex != -1) {\n                ret = data[getSubdataKey(categoryData[_categoryIndex])]\n            }\n        }\n\n        return ret\n    }\n\n    // 点击了歌曲，目前是播放逻辑\n    function clickMuiscWithData(_data) {\n        // 搜索只能添加歌曲，不能播放\n        if (menuType == MENU_TYPE_QUKU && searchText.length) {\n            return\n        }\n        // 如果是系统推荐或者是快捷歌单的猜你喜欢，类型都是GROUP_TYPE_0否则是GROUP_TYPE_1\n        const subType = categoryData[categoryIndex].type\n\n        Analytics.track3(\"music_play\", { action: 'play', song_code: _data.song_code, music_name: _data.name, type: subType, singer: _data.singer, online_songs: 'yes', position: 'network', cid: common.getCid() })\n\n        instance.playingList = data[getSubdataKey(categoryData[categoryIndex])]\n        instance.playingGroupId = subType\n        instance.playMuisc(_data, subType)\n    }\n\n    // 点击了歌曲的加号，算是编辑弹窗吧\n    function addMuiscWithData(data, event) {\n        const rect = event.getBoundingClientRect()\n\n        const isMine = menuType === MENU_TYPE_MINE\n\n        instance.showEditSongPopupComp({\n            isMine, \n            code: data.song_code,\n            data: data,\n            groupId: isMine ? categoryData[categoryIndex].id : '', \n            style: `left: ${rect.left}px; top: ${rect.top}px;`,\n            top: rect.top,\n        })\n    }\n\n    // 这个名字没起好，是弹出处理组的弹窗\n    function showMenu() {\n        const rect = this.getBoundingClientRect()\n        \n        instance.showEditMenuPopupComp({style: `left: ${rect.left}px; top: ${rect.top}px; transform: translate(calc(-100% + 25px), 25px);` })\n    }\n\n    // 兴趣标签选择弹窗\n    function showTagSelect() {\n        instance.showTagSelectComp()\n    }\n    \n    // 上啦刷新\n    function scrollBottomCb() {\n        if (searchText.length == 0) {\n            const item = categoryData[categoryIndex]\n\n            const type = item.type\n            if (onlyOnePage(type)) {\n            } else {\n                const list = data[getSubdataKey(item)]\n                requestList(item, list[list.length - 1].id)\n            }\n        }\n    }\n\n    // 能触发到这里，必然是刷新按钮\n    export function _refreshMineLike() {\n        request.get(ChatUrls.getBgmListWithCategroyType(DEFAULT_CATETORY_TYPE, '', 50, 1)).then(res => {\n            if (res.error == 0) {\n                emitter.emit(EMITTER_KEY_UPDATE_RECOMMEND)\n            }\n        })\n    }\n\n    function gotoLibraryModal() {\n        instance.hideQuickBgmModalComp()\n        instance.showLibraryComp()\n    }\n\n    $: {\n        // 不是我不愿意requestSearchList放到这个block块里面，是不能放会死循环，原因是allData发生了改变导致的，你可以看看我下面另外一个类似的更详细的讲解\n        if (searchText.length) {\n            requestSearchList()\n        }\n    }\n\n    $: {\n        if (categoryIndex == -1) {\n        } else {\n            requestMuiscList()\n        }\n    }\n\n    $: {\n        if (searchData || data || categoryIndex || forceUpdateIndex) {\n        }\n        \n        realMusicList = getMusicList()\n    }\n\n    $: {\n        if (forceUpdateIndex) {}\n\n        playingCode = instance.currentPlayer ? instance.currentPlayer.data.song_code : ''\n        dangCode = instance.dangSong ? instance.dangSong.song_code : ''\n    }\n\n    $: category = categoryData ? categoryData.map(item => {\n        if (menuType != MENU_TYPE_MINE && item.type == DEFAULT_CATETORY_TYPE) {\n            return {name: item.name, logo: 'https://dynamics-share.tuwan.com/activity/13e48efb8b10a292839fe2216c158753.png'}\n        }\n\n        return item.name\n    }) : null\n</script>\n\n{#if show}\n    {#if menuType == MENU_TYPE_QUKU}\n        <div class=\"flex flex-ac\">\n            <Search bind:value={searchText}/>\n            {#if menuType == MENU_TYPE_QUKU}\n                <Img class=\"edit_tags_icon\" src=\"https://dynamics-share.tuwan.com/activity/7e1995bcdba84826a78720a64bfb0e0c.png\" on:click={showTagSelect}/>\n            {/if}\n        </div>\n    {/if}\n    {#if category && searchText.length == 0}\n        <div class=\"flex flex-ac\">\n            <Category data={category} selectedIndex={categoryIndex} changeCb={categoryChange} logoCb={_refreshMineLike}/>\n            {#if menuType == MENU_TYPE_MINE}\n                <Img class=\"edit_song_icon\" src=\"https://dynamics-share.tuwan.com/activity/caa60cf7f9d818f7963b3336ed8c56b0.png\" on:click={showMenu}/>\n            {/if}\n        </div>\n    {/if}\n    {#if realMusicList == null}\n        <Musics data={[]}/>\n    {:else if realMusicList?.length > 0}\n        <Musics showAdd={menuType != MENU_TYPE_QUICK} playingCode={playingCode} dangCode={dangCode} data={realMusicList} clickMuiscCb={clickMuiscWithData} addMuiscCb={addMuiscWithData} {scrollBottomCb}/>\n    {:else if realMusicList?.length == 0}\n        {#if menuType == MENU_TYPE_QUICK && categoryIndex == 0}\n            <Empty showBtn={true} desc='添加歌曲' btnCb={gotoLibraryModal}/>\n        {:else}\n            <Empty desc={searchText ? '没有搜到该歌曲呢' : \"暂无歌曲内容\"}/>\n        {/if}\n        \n    {/if}\n{/if}\n\n<style lang=\"scss\">\n    :global(.category .item_con .logo) {\n        width: 18px;\n        margin-left: -16px;\n        margin-right: 20px;\n    }\n</style>","<script>\n    import Setting from '../setting/index.svelte'\n    import PlayingControl from '../playingControl/index.svelte'\n    import Page from '../library/page.svelte'\n\n    import { MENU_TYPE_QUICK } from '../library/const'\n    \n    export function show() {\n        visible = true\n\n        pageRef && pageRef.refreshRecommend()\n    }\n    export function hide() {\n        visible = false\n    }\n\n    let visible = false\n    let pageRef\n</script>\n\n<div class=\"quick_bgm_modal {visible ? '' : 'hide'}\">\n    <Page bind:this={pageRef} menuType={MENU_TYPE_QUICK} show/>\n    <PlayingControl/>\n    <Setting/>\n</div>\n\n<style lang=\"scss\">\n    .quick_bgm_modal {\n        position: absolute;\n        left: 50%;\n        top: -20px;\n        transform: translate(-50%, -100%);\n        width: 300px;\n        height: 380px;\n        background-color: white;\n        box-shadow: 0px 0px 6px 0px rgba(0, 0, 0, 0.1);\n        border-radius: 6px;\n        z-index: 101;\n        display: flex;\n        flex-direction: column;\n\n        :global(.category) {\n            margin: 20px 0 10px 0;\n        }\n\n        :global(.category .item) {\n            background-color: white;\n            font-size: 16px;\n            color: #999999;\n            border-radius: 0;\n            line-height: 20px;\n            padding: 0;\n            margin-right: 20px;\n        }\n\n        :global(.category .swiper-slide:first-child) {\n            margin-left: 20px;\n        }\n\n        :global(.category .item.selected) {\n            background-color: white;\n            font-size: 18px;\n            color: #333333;\n        }\n\n        :global(.musics) {\n            padding-left: 20px;\n            margin-bottom: 0;\n        }\n\n        :global(.empty img) {\n            width: 120px;\n        }\n    }\n</style>","<script>\n    import Bgm from '../index'\n\n    import Img from '@/js/components/img.svelte'\n    import Menus from '@/js/components/menus.svelte'\n    import PlayingControl from '../playingControl/index.svelte'\n    import Page from './page.svelte'\n    \n    import { MENU_TYPE_QUKU, MENU_TYPE_MINE, GROUP_TYPE_0, GROUP_TYPE_1 } from './const'\n    \n    export let closeModal\n    export function show() {\n        visible = true\n    }\n    export function hide() {\n        visible = false\n    }\n    export function refreshMineLike() {\n        qukuRef && qukuRef._refreshMineLike()\n    }\n    \n    let visible = false\n    // 菜单\n    let menus = ['推荐', '我的歌单']\n    let menusIndex = 0\n    let menusChange = idx => menusIndex = idx\n\n    let qukuRef\n    let mineRef\n</script>\n\n<div class=\"bgm_library\" style=\"display: {visible ? 'flex' : 'none'}\">\n    <div class=\"body\">\n        <Menus data={menus} selectedIndex={menusIndex} changeCb={menusChange}/>\n        <Img class=\"close_btn\" on:click={closeModal} src=\"https://asset.tuwan.com/chatroom/chorus/close_gray.png\"/>\n        <Page bind:this={qukuRef} menuType={MENU_TYPE_QUKU} show={menusIndex == MENU_TYPE_QUKU}/>\n        <Page bind:this={mineRef} menuType={MENU_TYPE_MINE} show={menusIndex == MENU_TYPE_MINE}/>\n        <PlayingControl showPlaying={true}/>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .bgm_library {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0, 0, 0, 0.6);\n        z-index: 9999;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        .body {\n            display: flex;\n            flex-direction: column;\n            position: relative;\n            width: 400px;\n            height: 700px;\n            background-color: white;\n            border-radius: 10px;\n            padding: 0 20px;\n\n            :global(.close_btn) {\n                position: absolute;\n                right: 35px;\n                top: 37px;\n                width: 25px;\n                height: 25px;\n            }\n\n            :global(.search_bar) {\n                flex: 1;\n                background-color: #F8F9FD;\n                border-radius: 6px;\n            }\n\n            :global(.category) {\n                margin: 15px 0;\n                flex: 1;\n            }\n\n            :global(.category .item) {\n                background-color: white;\n                font-size: 16px;\n                color: #999999;\n                border-radius: 0;\n                line-height: 20px;\n                padding: 0;\n                margin-right: 20px;\n                margin-left: 0 !important;\n            }\n\n            :global(.category .item.selected) {\n                background-color: white;\n                font-size: 18px;\n                color: #333333;\n            }\n\n            :global(.edit_song_icon) {\n                width: 18px;\n                margin-left: 10px;\n                cursor: pointer;\n            }\n\n            :global(.edit_tags_icon) {\n                width: 22px;\n                margin-left: 10px;\n                cursor: pointer;\n            }\n\n            :global(.musics) {\n                margin-bottom: 0;\n            }\n\n            :global(.playing_control) {\n                margin: 0 -20px;\n            }\n        }\n    }\n</style>","export const TYPE_ADD = 0 // 添加歌曲\nexport const TYPE_GROUP = 1 // 歌曲组名称\nexport const TYPE_RENAME = 2 // 重命名\nexport const TYPE_DELETE = 3 // 删除歌单\nexport const TYPE_WORK_BGM = 4 // 设为上档bgm\nexport const TYPE_DELETE_SONG = 5 // 设为上档bgm\nexport const TYPE_EDIT_GROUP = 6 // 编辑歌单\nexport const TYPE_ADD_PLAYING_LIST = 7 // 加入播放列表","<script>\n    import Img from '@/js/components/img.svelte'\n    import { TYPE_ADD, TYPE_GROUP, TYPE_RENAME, TYPE_DELETE, TYPE_WORK_BGM, TYPE_DELETE_SONG, TYPE_ADD_PLAYING_LIST, TYPE_EDIT_GROUP } from '../popup/const'\n    import Bgm from '../index'\n\n    import { ChatUrls } from '@/js/config'\n    import { request } from '@/utils/request';\n    import showTips from '@/js/showTip';\n    import { EMITTER_KEY_DELETE_GROUP, EMITTER_KEY_RENAME_GROUP, EMITTER_KEY_DELETE_SONG, EMITTER_KEY_ADD_SONG_TO_GROUP, EMITTER_KEY_ADD_GROUP, emitter } from '../emitter'\n\n    export let type = TYPE_ADD\n    export let isSelected = false\n    export let title = ''\n    export let groupId = ''\n    export let code = ''\n    export let callback\n    export let active = true\n    export let data = {}\n\n    function click() {\n        if (type == TYPE_ADD) {\n            Bgm.getInstance().showAlert({\n                title: '新建歌单',\n                placeholder: '最多5个字',\n                maxLength: 5,\n                confirmCb: (text)=> {\n                    if (text && text.length > 0) {\n                        request.get(ChatUrls.getBgmAddGroup(text)).then(res=>{\n                            if (res.error == 0) {\n                                showTips('新建歌单成功')\n                                callback && callback(type)\n                                emitter.emit(EMITTER_KEY_ADD_GROUP)\n                            } else {\n                                showTips(res.error_msg)\n                            }\n                        })\n                    } else {\n                        showTips('请填写组名称')\n                    }\n                }\n            })\n        } else if (type == TYPE_GROUP) {\n            if (!active) return \n            \n            request.get(ChatUrls.getBgmAddSongToGroup(groupId, code)).then(res=>{\n                if (res.error == 0) {\n                    showTips('加入歌单成功')\n                    callback && callback(type)\n                    emitter.emit(EMITTER_KEY_ADD_SONG_TO_GROUP, code, groupId)\n                } else {\n                    showTips(res.error_msg)\n                }\n            })\n        } else if (type == TYPE_DELETE) {\n            window.$.DialogByZ.Confirm({\n                Title: \"提示\",\n                Content: \"您确定要删除此歌单吗？\",\n                BtnL: \"取消\",\n                BtnR: \"确定\",\n                FunL: function() {\n                    window.$.DialogByZ.Close();\n                },\n                FunR: function() {\n                    window.$.DialogByZ.Close();\n\n                    request.get(ChatUrls.getBgmDeleteGroup(groupId)).then(res=>{\n                        if (res.error == 0) {\n                            showTips('删除成功')\n                            callback && callback(type)\n                            emitter.emit(EMITTER_KEY_DELETE_GROUP)\n                        } else {\n                            showTips(res.error_msg)\n                        }\n                    })\n                }\n            })\n        } else if (type == TYPE_RENAME) {\n            Bgm.getInstance().showAlert({\n                title: '重命名',\n                placeholder: '最多5个字',\n                maxLength: 5,\n                confirmCb: (text)=> {\n                    request.get(ChatUrls.getBgmRenameGroup(text, groupId)).then(res=>{\n                        if (res.error == 0) {\n                            showTips('修改成功')\n                            callback && callback(type)\n                            emitter.emit(EMITTER_KEY_RENAME_GROUP)\n                        } else {\n                            showTips(res.error_msg)\n                        }\n                    })\n                }\n            })\n        } else if (type == TYPE_WORK_BGM) {\n            request.get(ChatUrls.getBgmSetWorkBgm(groupId, code)).then(res=>{\n                if (res.error == 0) {\n                    showTips('设置上档歌曲成功')\n                    callback && callback(type)\n                    Bgm.getInstance().updateDangSong()\n                } else {\n                    showTips(res.error_msg)\n                }\n            })\n        } else if (type == TYPE_DELETE_SONG) {\n            request.get(ChatUrls.getBgmDeleteSongToGroup(groupId, code)).then(res=>{\n                if (res.error == 0) {\n                    showTips('删除歌曲成功')\n                    callback && callback(type)\n                    emitter.emit(EMITTER_KEY_DELETE_SONG, code, groupId)\n                } else {\n                    showTips(res.error_msg)\n                }\n            })\n        } else if (type == TYPE_ADD_PLAYING_LIST) {\n            const playingList = Bgm.getInstance().playingList\n            if (playingList.findIndex(item => item.song_code == code) == -1) {\n                playingList.push(data)\n            }\n            callback && callback(type)\n        } else if (type == TYPE_EDIT_GROUP) {\n            Bgm.getInstance().showEditGroupComp()\n            callback && callback(type)\n        }\n    }\n\n    let url = ''\n    let name = ''\n\n    $: {\n        if (type == TYPE_ADD) {\n            url = 'https://dynamics-share.tuwan.com/activity/61e226a39da0983fb4fbd1dcf912e640.png'\n        } else if (type == TYPE_GROUP && isSelected) {\n            url = 'https://dynamics-share.tuwan.com/activity/964e72b762f81a6bb6255fc1292afa1e.png'\n        } else if (type == TYPE_RENAME) {\n            url = 'https://dynamics-share.tuwan.com/activity/92ab79cbef327aa6ae8535cd0e3629eb.png'\n        } else if (type == TYPE_DELETE) {\n            url = 'https://dynamics-share.tuwan.com/activity/a40ffccc94e601ef80690bc9cb84a568.png'\n        } else if (type == TYPE_WORK_BGM) {\n            url = ''\n        } else if (type == TYPE_DELETE_SONG) {\n            url = 'https://dynamics-share.tuwan.com/activity/a40ffccc94e601ef80690bc9cb84a568.png'\n        } else if (type == TYPE_ADD_PLAYING_LIST) {\n            url = 'https://dynamics-share.tuwan.com/activity/1d53f9bf7e650677bdcae0c3e3072a80.png'\n        } else if (type == TYPE_EDIT_GROUP) {\n            url = 'https://dynamics-share.tuwan.com/activity/b9f801144ae7dc1193d68c209d4bdd06.png'\n        }\n    }\n\n    $: {\n        if (type == TYPE_ADD) {\n            name = '新建歌单'\n        } else if (type == TYPE_GROUP) {\n            name = title\n        } else if (type == TYPE_RENAME) {\n            name = '重命名'\n        } else if (type == TYPE_DELETE) {\n            name = '删除歌单'\n        } else if (type == TYPE_WORK_BGM) {\n            name = '设为上档BGM'\n        } else if (type == TYPE_DELETE_SONG) {\n            name = '删除歌曲'\n        } else if (type == TYPE_ADD_PLAYING_LIST) {\n            name = '加入播放列表'\n        } else if (type == TYPE_EDIT_GROUP) {\n            name = '编辑歌单'\n        }\n    }\n</script>\n\n<div class:disable={!active} class=\"bgm_edit_popup-item {isSelected && 'selected'} type_{type}\" on:click|stopPropagation={click}>\n    <div class=\"icon\">\n        {#if url && url.length}\n            <Img src={url}/>\n        {/if}\n    </div>\n    <p>{name}</p>\n</div>\n\n<style lang=\"scss\">\n    .bgm_edit_popup-item {\n        display: flex;\n        align-items: center;\n        height: 37px;\n        cursor: pointer;\n\n        &.disable {\n            opacity: 0.3;\n        }\n\n        .icon {\n            width: 32px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n\n            :global(img) {\n                width: 14px;\n            }\n        }\n\n        p {\n            width: 90px;\n            white-space: nowrap;\n            overflow: hidden;\n            color: #333333;\n        }\n\n        &.selected, &.type_4 {\n            p { \n                color: #FF6691;\n            }\n        }\n    }\n</style>","<div class=\"line\"></div>\n\n<style lang=\"scss\">\n    .line {\n        background-color: #D8D8D8;\n        height: 1px;\n    }\n</style>","<script>\n    import { onMount } from 'svelte'\n\n    import { ChatUrls } from '@/js/config'\n    ;\nimport { common } from '@/js/common';\nimport { request } from '@/utils/request';\n\n    import Item from '../components/editItem.svelte'\n    import Line from '../components/line.svelte'\n    import { TYPE_ADD, TYPE_GROUP, TYPE_WORK_BGM, TYPE_DELETE_SONG, TYPE_ADD_PLAYING_LIST } from './const'\n    import { EMITTER_KEY_ADD_GROUP, emitter} from '../emitter'\n    \n    export let closeModal\n    export let isMine = true\n    export let code = ''\n    export let data = {}\n    export let groupId = ''\n    export let style\n    export let top = 0\n\n    let groups = []\n    let bodyRef\n    let show = false\n    let transformY = '25px'\n\n    onMount(()=> {\n        loadData()\n    });\n\n    function itemCallback(type) {\n        if (type == TYPE_GROUP) {\n            loadData()\n            closeModal()\n        } else if (type == TYPE_DELETE_SONG || type == TYPE_ADD_PLAYING_LIST) {\n            closeModal()\n        }\n    }\n\n    function loadData() {\n        request.get(ChatUrls.getBgmGroups(code, common.getCid())).then(res=>{\n            if (res.error == 0) {\n                groups = []\n                \n                setTimeout(() => {\n                    groups = res.data\n                }, 0);\n            }\n        })\n    }\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_ADD_GROUP, loadData)\n        return ()=> emitter.off(EMITTER_KEY_ADD_GROUP, loadData)\n    })\n\n    $: {\n        if (groups && groups.length && bodyRef) {\n            // 25是在不设置的情况，往下偏移量25,10是随便加的，可能存在像素差，直接狠点来个10像素\n            if (document.documentElement.clientHeight - (top + 25 + 10) < window.$(bodyRef).height()) {\n                transformY = '-100%'\n            }\n\n            show = true\n        }\n    }\n</script>\n\n{#if groups && groups.length}\n    <div class=\"bgm_edit_popup\" class:show={show} on:click|stopPropagation={closeModal}>\n        <div class=\"body\" bind:this={bodyRef} on:click|stopPropagation style=\"{style} transform: translate(calc(-100% + 25px), {transformY})\">\n            <Item type={TYPE_ADD} callback={itemCallback}/>\n            {#if isMine}\n                <Item type={TYPE_WORK_BGM} {groupId} {code} callback={itemCallback}/>\n            {/if}\n            <Line/>\n            {#each groups as group}\n                <Item active={group.canAdd} type={TYPE_GROUP} isSelected={group.isIn == true} title={group.name} groupId={group.id} {code} callback={itemCallback}/>\n            {/each}\n            <Line/>\n            <Item type={TYPE_ADD_PLAYING_LIST} {groupId} {code} {data} callback={itemCallback}/>\n            {#if isMine}\n                <Line/>\n                <Item type={TYPE_DELETE_SONG} {groupId} {code} callback={itemCallback}/>\n            {/if}\n        </div>\n    </div>\n{/if}\n\n<style lang=\"scss\">\n    .bgm_edit_popup {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 10000;\n        opacity: 0;\n\n        &.show {\n            opacity: 1;\n        }\n\n        .body {\n            position: absolute;\n            width: 130px;\n            background: #F5F5F8;\n            border-radius: 5px;\n        }\n    }\n</style>","<script>\n    import Item from '../components/editItem.svelte'\n\n    import { TYPE_RENAME, TYPE_DELETE } from './const'\n\n    export let id\n</script>\n\n<div class=\"bgm_edit_group_popup\">\n    <Item type={TYPE_RENAME} groupId={id}/>\n    <Item type={TYPE_DELETE} groupId={id}/>\n</div>\n\n<style lang=\"scss\">\n    .bgm_edit_group_popup {\n        position: absolute;\n        right: 0;\n        top: 30px;\n        width: 130px;\n        background: #F5F5F8;\n        border-radius: 5px;\n        z-index: 1;\n    }\n</style>","<script>\n    import Img from '@/js/components/img.svelte'\n    import EditGroupPopup from '../popup/editGroupPopup.svelte';\n\n    export let data = {}\n    export let editVisible = false\n    export let editClick\n</script>\n\n<div class=\"edit_song_item\">\n    <div>\n        <p class=\"name\">{data.name}</p>\n        <p class=\"count\">{data.count}首歌曲</p>\n    </div>\n    <div class=\"edit_con\" on:click|stopPropagation={editClick.bind(null, data)}>\n        {#if editVisible}\n            <EditGroupPopup id={data.id}/>\n        {/if}\n        {#if data.default == 0}\n            <Img class=\"edit\" src=\"https://dynamics-share.tuwan.com/activity/defac4fe92a2b277a79018f61937f90c.png\" on:click={editClick.bind(null, data)}/>\n        {/if}\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .edit_song_item {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        height: 60px;\n\n        .name {\n            font-size: 16px;\n            color: #333333;\n            line-height: 22px;\n        }\n\n        .count {\n            font-size: 12px;\n            color: #BABABA;\n            line-height: 20px;\n        }\n\n        .edit_con {\n            padding: 10px 0;\n            position: relative;\n            cursor: pointer;\n        }\n\n        :global(.edit) {\n            width: 21px;\n        }\n    }\n</style>","<script>\n    import { onMount } from 'svelte'\n    \n    import Img from '@/js/components/img.svelte'\n    import Item from './item.svelte'\n\n    import { ChatUrls } from '@/js/config'\n    import { request } from '@/utils/request';\n\n    import { EMITTER_KEY_DELETE_GROUP, EMITTER_KEY_RENAME_GROUP, emitter } from '../emitter'\n    \n    export let closeModal\n\n    let list = []\n    let showEditId = ''\n\n    onMount(() => {\n        loadData()\n    });\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DELETE_GROUP, loadData)\n        \n        return ()=> emitter.off(EMITTER_KEY_DELETE_GROUP, loadData)\n    })\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_RENAME_GROUP, loadData)\n        \n        return ()=> emitter.off(EMITTER_KEY_RENAME_GROUP, loadData)\n    })\n\n    function loadData() {\n        request.get(ChatUrls.getBgmMineGroup()).then(res=>{\n            if (res.error == 0) {\n                list = res.data\n            }\n        })\n    }\n\n    function bodyClick() {\n        showEditId = ''\n    }\n\n    function editClick(data) {\n        if (data.id == showEditId) {\n            showEditId = ''\n        } else {\n            showEditId = data.id\n        }\n    }\n</script>\n\n<div class=\"bgm_edit_group_modal flex flex-ac\" on:click|stopPropagation={closeModal}>\n    <div class=\"body\" on:click|stopPropagation={bodyClick}>\n        <Img class=\"close_btn\" on:click={closeModal} src=\"https://asset.tuwan.com/chatroom/chorus/close_gray.png\"/>\n        <p class=\"title\">编辑歌单</p>\n        {#each list as item}\n            <Item data={item} editVisible={showEditId == item.id} editClick={editClick}/>\n        {/each}\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .bgm_edit_group_modal {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0, 0, 0, 0.6);\n        z-index: 9999;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        .body {\n            display: flex;\n            flex-direction: column;\n            position: relative;\n            width: 400px;\n            height: 700px;\n            background-color: white;\n            border-radius: 10px;\n            padding: 0 20px;\n\n            :global(.close_btn) {\n                position: absolute;\n                right: 35px;\n                top: 37px;\n                width: 25px;\n                height: 25px;\n            }\n\n            .title {\n                margin-top: 20px;\n                margin-bottom: 20px;\n                text-align: center;\n                font-size: 16px;\n                color: #333333;\n                line-height: 30px;\n            }\n        }\n    }\n</style>","<script>\n    /**\n     * 我的歌单点击分类最右侧的那个按钮：新建歌单和编辑歌单\n    */\n    import Item from '../components/editItem.svelte'\n    import { TYPE_ADD, TYPE_EDIT_GROUP } from './const'\n    \n    export let closeModal\n    export let style\n\n    function itemCallback(type) {\n        if (type == TYPE_ADD) {\n            closeModal && closeModal()\n        } else if (type == TYPE_EDIT_GROUP) {\n            closeModal && closeModal()\n        }\n    }\n</script>\n\n<div class=\"bgm_edit_menu_modal\" on:click|stopPropagation={closeModal}>\n    <div class=\"body\" on:click|stopPropagation style=\"{style}\">\n        <Item type={TYPE_ADD} callback={itemCallback}/>\n        <Item type={TYPE_EDIT_GROUP} callback={itemCallback}/>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .bgm_edit_menu_modal {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 10000;\n\n        .body {\n            position: absolute;\n            width: 130px;\n            background: #F5F5F8;\n            border-radius: 5px;\n        }\n    }\n</style>","<script>\n    /**\n     * 标签选择器\n    */\n    import ScrollView from '@/js/components/scrollView.svelte'\n    import showTips from '@/js/showTip'\n\n    export let closeModal\n    export let max = 3\n    export let multiple = true\n    export let cb\n    export let data = []\n\n    function tagClick(groupIndex, index) {\n        let selecedCount = 0\n        let selectGroupCount = 0\n        \n        renderData.forEach((group, _groupIndex) => {\n            group.list.forEach((item, _index) => {\n                if (item.selected && (groupIndex != _groupIndex || _index != index)) {\n                    selecedCount++\n                }\n\n                if (groupIndex == _groupIndex && item.selected && _index != index) {\n                    selectGroupCount++\n                }\n            });\n        });\n\n        if (!multiple && selectGroupCount >= 1) {\n            showTips('同一个分类只能选择一个标签')\n            return\n        }\n\n        if (selecedCount >= max) {\n            showTips(`已经超过最大选择数量${max}个`)\n            return\n        }\n\n        const item = renderData[groupIndex].list[index]\n        item.selected = !!!item.selected\n        renderData = renderData\n    }\n\n    function confirmClick() {\n        const ret = getSelects()\n\n        // 说明没有变化\n        if (initSelects.join(',') == ret.join(',')) {\n        } else {\n            cb && cb(ret)\n        }\n        \n        closeModal && closeModal()\n    }\n\n    function getSelects() {\n        let ret = []\n\n        renderData.forEach(group => group.list.forEach(item => {\n            if (item.selected) {\n                ret.push(item)\n            }\n        }));\n\n        return ret\n    }\n\n    let renderData = data\n    let initSelects = getSelects()\n</script>\n\n<div class=\"tag_select\">\n    <div class=\"body\">\n        <p class=\"title\">选择标签</p>\n        <p class=\"close\" on:click|stopPropagation={closeModal}>跳过</p>\n        <ScrollView class=\"tags\">\n            {#each renderData as group, groupIndex}\n                <div class=\"group\">\n                    <p class=\"group_title\">{group.tagCategoryName}</p>\n                    <div class=\"group_items\">\n                        {#each group.list as item, index}\n                            <p class:seleced={item.selected} on:click={tagClick.bind(null, groupIndex, index)}>{item.tagName}</p>\n                        {/each}\n                    </div>\n                </div>\n            {/each}\n        </ScrollView>\n        <p class=\"btn\" on:click|stopPropagation={confirmClick}>确定</p>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .tag_select {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-color: rgba(0, 0, 0, 0.6);\n        z-index: 9999;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        .body {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            position: relative;\n            width: 400px;\n            height: 600px;\n            background-color: white;\n            border-radius: 10px;\n            padding: 20px;\n            padding-bottom: 30px;\n\n            .title {\n                font-size: 24px;\n                font-weight: 500;\n                color: #333333;\n                line-height: 28px;\n                text-align: center;\n                margin-bottom: 20px;\n            }\n\n            .close {\n                position: absolute;\n                right: 20px;\n                top: 20px;\n                font-size: 20px;\n                font-weight: 400;\n                color: #C0C0C0;\n                cursor: pointer;\n            }\n\n            .group {\n                margin-bottom: 15px;\n\n                .group_title {\n                    font-size: 20px;\n                    font-weight: 400;\n                    color: #C0C0C0;\n                    line-height: 20px;\n                    margin-bottom: 10px;\n                }\n\n                .group_items {\n                    display: flex;\n                    flex-wrap: wrap;\n\n                    p {\n                        font-size: 16px;\n                        padding: 0 15px;\n                        line-height: 35px;\n                        color: #666666;\n                        background: #F5F7F8;\n                        border-radius: 6px;\n                        margin-right: 13px;\n                        margin-bottom: 10px;\n                        cursor: pointer;\n\n                        &.seleced {\n                            background: #FF6691;\n                            color: white;\n                        }\n                    }\n                }\n            }\n\n            .btn {\n                margin-top: 20px;\n                width: 240px;\n                line-height: 44px;\n                background: #FF6691;\n                border-radius: 40px;\n                font-size: 24px;\n                font-weight: 500;\n                color: #FFFFFF;\n                text-align: center;\n                cursor: pointer;\n            }\n        }\n    }\n</style>","<script>\n    import Img from '@/js/components/img.svelte'\n\n    export let data = {}\n    export let cls = ''\n    export let bodyClick\n\n    function _bodyClick() {\n        // 如果已经播放中了\n        if (cls.indexOf('playing') >= 0) return\n\n        bodyClick && bodyClick(data)\n    }\n</script>\n\n<div class=\"playing_music {cls}\" on:click|stopPropagation={_bodyClick}>\n    <p class=\"name\">{data.name}</p>\n    <Img class=\"effect\" src=\"https://res.tuwan.com/chatroom/images/icon_song_playing.gif\"/>\n</div>\n\n<style lang=\"scss\">\n    .playing_music {\n        display: flex;\n        align-items: center;\n        height: 31px;\n        cursor: pointer;\n\n        &.playing {\n            :global(.effect) {\n                display: block;\n            }\n\n            .name {\n                color: #7D4BF5;\n            }\n        }\n\n        .name {\n            font-size: 14px;\n            color: #666666;\n            max-width: 130px;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n        }\n\n        :global(.effect) {\n            margin-left: 7px;\n            width: 13px;\n            display: none;\n        }\n    }\n</style>","<script>\n    import { onMount } from 'svelte'\n\n    import Item from './item.svelte'\n    import Bgm from '../main'\n    import ScrollView from '@/js/components/scrollView.svelte'\n    import Empty from '@/js/components/empty.svelte'\n    import Analytics from '@/js/analytics'\n    import { common } from '@/js/common';\n\n    import { EMITTER_KEY_PLAY_SONG, EMITTER_KEY_DESTROY_SONG, EMITTER_KEY_PAUSE_SONG, EMITTER_KEY_RESUME_SONG, emitter } from '../emitter'\n\n    export let closeModal\n    export let style\n\n    export function forceUpdate() {\n        forceUpdateIndex = forceUpdateIndex + 1\n    }\n\n    let forceUpdateIndex = 0\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_PLAY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_PLAY_SONG, forceUpdate)\n    })\n\n    onMount(()=> {\n        emitter.on(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n        return ()=> emitter.off(EMITTER_KEY_DESTROY_SONG, forceUpdate)\n    })\n\n    const instance = Bgm.getInstance()\n\n    let list = instance.playingList\n    \n    let playingCode = instance.currentPlayer ? instance.currentPlayer.data.song_code : ''\n\n    $: {\n        if (forceUpdateIndex)\n\n        playingCode = instance.currentPlayer ? instance.currentPlayer.data.song_code : ''\n    }\n\n    function muiscClick(data) {\n        Analytics.track3(\"music_play\", { action: 'play', song_code: data.song_code, music_name: data.name, type: instance.playingGroupId, singer: data.singer, online_songs: 'yes', position: 'network', cid: common.getCid() })\n        instance.playMuisc(data, instance.playingGroupId)\n    }\n</script>\n\n<div class=\"playing_list_modal\" on:click|stopPropagation={closeModal}>\n    <div class=\"body\" on:click|stopPropagation style=\"{style}\">\n        <p class=\"title\">播放列表<span>({list.length}首歌)</span></p>\n        <ScrollView>\n            {#each list as item}\n                <Item data={item} bodyClick={muiscClick} cls={`${playingCode == item.song_code ? 'playing' : ''}`}/>\n            {/each}\n            {#if list.length == 0}\n                <Empty desc='暂无播放歌曲'/>\n            {/if}\n        </ScrollView>\n    </div>\n</div>\n\n<style lang=\"scss\">\n    .playing_list_modal {\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        z-index: 10000;\n\n        .body {\n            position: absolute;\n            width: 140px;\n            padding: 10px 15px;\n            padding-right: 5px;\n            background: white;\n            border-radius: 5px;\n            box-shadow: 0px 0px 4px 1px rgba(0,0,0,0.08);\n            transform: translate(-50%, -100%);\n\n            .title {\n                font-size: 16px;\n                color: #333333;\n                line-height: 21px;\n                font-weight: 500;\n                margin-bottom: 6px;\n\n                span {\n                    font-size: 14px;\n                    color: #999999;\n                }\n            }\n\n            :global(.common_scroll_view) {\n                height: 160px;\n            }\n\n            :global(.empty) {\n                margin-top: 20px;\n            }\n\n            :global(.empty img) {\n                width: 100px;\n            }\n        }\n    }\n</style>","import QuickBgmModal from './quickBgmModal/index.svelte'\nimport LibraryModal from './library/index.svelte'\nimport EditSongPopup from './popup/editSongPopup.svelte'\nimport Alert from './components/alert.svelte'\nimport EditGoup from './editGroupModal/index.svelte'\nimport EditMenuGoup from './popup/editMenuPopup.svelte'\nimport TagSelect from '@/js/components/tagSelect.svelte'\nimport PlayingListModal from './playingListModal/index.svelte'\n\nimport Player from './player'\nimport { ChatUrls } from '@/js/config'\n;\nimport { common } from '@/js/common';\nimport { request } from '@/utils/request';\nimport showTips from '@/js/showTip'\nimport Analytics from '@/js/analytics'\nimport SessionStorage from '@/utils/sessionstore';\nimport showSvelteModal from '@/js/utils/showSvelteModal'\n\nimport { EMITTER_KEY_PLAY_SONG, EMITTER_KEY_SET_WORK_SONG, EMITTER_KEY_DESTROY_SONG, emitter } from './emitter'\n\nexport default class Bgm {\n    constructor() {\n        this.bgmDom = window.$(\".chat-function-bgm\")\n        this.quickBgmModalComp = null\n        this.libraryModalComp = null\n        this.currentPlayer = null\n        this.dangSong = null\n        this.isAnchor = false\n        this.original = false // 默认伴奏\n        this.volume = 100 // 默认音量100\n        this.playingList = []\n        this.playingGroupId = ''\n        this.recommendList = []\n    }\n\n    static getInstance() {\n        if (!this.instance) {\n            this.instance = new Bgm();\n            this.instance.registEvents()\n        }\n        return this.instance;\n    }\n\n    onReset() {\n        if (this.quickBgmModalComp) {\n            this.quickBgmModalComp.$destroy()\n            this.quickBgmModalComp = null\n        }\n\n        if (this.libraryModalComp) {\n            this.libraryModalComp.$destroy()\n            this.libraryModalComp = null\n        }\n\n        this.destroyMusic()\n        this.playingList = []\n        this.playingGroupId = ''\n        this.dangSong = null\n        this.recommendList = []\n    }\n\n    registEvents() {\n        const that = this\n        this.bgmDom.on(\"click\", function (e) {\n            e.stopPropagation();\n\n            if (SessionStorage.getInstance().getBgmFirstShow()) {\n                that.showCuickBgmModalComp()\n            } else {\n                that.loadQuickBgmModalComp()\n                that.showLibraryComp()\n                that.showTagSelectComp()\n                SessionStorage.getInstance().setBgmFirstShow()\n            }\n        })\n    }\n\n    ablePlayBgm() {\n        // 即构不可以用\n        return common.getRoomInfo().bgm_switch && !(common.isSpecialSongRoom() && common.getRoomInfo().voice_type != 0)\n    }\n\n    checkShowBgm() {\n        // 用到 !common.isChorusRoom() 是因为 大合唱厅 就不展示bgm了\n        if (this.ablePlayBgm() && common.isAnchor(common.getMeid()) && !common.isChorusRoom()) {  \n            this.bgmDom.show()\n        } else {\n            this.destroyMusic()\n            this.bgmDom.hide()\n        }\n    }\n\n    updateSeats() {\n        // 在麦上\n        if (common.getAnchorKengUser(common.getMeid())) {\n            // 从观众到嘉宾位\n            if (this.isAnchor == false) {\n                // 如果我是主持\n                if (common.getAnchoringUserId() == common.getMeid()) {\n                    // 自动播放上档\n                    if (this.currentPlayer) {\n                        this.publishTracks()\n                    } else {\n                        this.updateDangSong().then(()=> {\n                            if (this.dangSong) {\n                                if (this.ablePlayBgm()) {\n                                    this.playMuisc(this.dangSong, this.dangSong.playlistId, true)\n\n                                    if (this.recommendList.length) {\n                                        this.playingList = this.recommendList\n                                    } else {\n                                        // 当上档歌曲播放的时候，播放列表默认推荐\n                                        request.get(ChatUrls.getBgmRecommendAndCustomTabSongs(common.getCid(), 1)).then(res => {\n                                            if (res.error == 0) {\n                                                const list = res.data || []\n                                                this.recommendList = list\n                                                this.playingList = list\n                                            }\n                                        })\n                                    }\n                                }\n                            }\n                        })\n                    }\n                } else {\n                    // 我是嘉宾\n                    // 如果在麦下就开始播放bgm了，那么就开始推流\n                    this.publishTracks()\n                }\n            }\n            this.isAnchor = true\n        } else {\n            // 在麦下\n            if (this.currentPlayer && this.isAnchor) {\n                // 之前是主持位，突然下麦了，就需要把歌曲停掉\n                this.destroyMusic()\n            }\n            this.isAnchor = false\n        }\n    }\n\n    publishTracks(force = false) {\n        if (force || !window.$(\".chat-function-huatong\").find(\".chat-huatong\").hasClass(\"chat-huatong-jin\")) {\n            this.currentPlayer && this.currentPlayer.publishTracks()\n        }\n    }\n\n    unpublishTracks() {\n        this.currentPlayer && this.currentPlayer.unpublishTracks()\n    }\n\n    async updateDangSong() {\n        return new Promise((resolve, reject) => {\n            request.get(ChatUrls.getBgmGetWorkBgm()).then(res => {\n                if (res.error == 0) {\n                    this.dangSong = res.data\n                    emitter.emit(EMITTER_KEY_SET_WORK_SONG)\n                    resolve()\n                }\n            })\n        })\n    }\n\n    destroyMusic() {\n        if (this.currentPlayer) {\n            this.currentPlayer.destroy()\n            this.currentPlayer = null\n\n            // 为了让页面刷新\n            emitter.emit(EMITTER_KEY_DESTROY_SONG)\n        }\n    }\n\n    playWithDirection(next = true, data, groupId) {\n        if (Player.isLoadingBgm){\n            showTips('上一首歌曲正在加载中，请稍后~')\n            return;\n        }\n        this.destroyMusic()\n\n        let findFunc\n\n        if (next) {\n            findFunc = this.findNext.bind(this)\n        } else {\n            findFunc = this.findPre.bind(this)\n        }\n\n        let findSong = findFunc(data.song_code)\n        \n        // 找到了继续按这个分组去播放\n        if (findSong) {\n            this.playMuisc(findSong, groupId, false, true)\n        } else {\n            if (this.playingList.length) {\n                this.playMuisc(this.playingList[0], groupId, false, true)\n            } else {\n                console.log('没有可循环的歌曲');\n            }\n        }\n    }\n\n    playMuisc(data, groupId, publishSteam = false, isAuto = false) {\n        if (isAuto) {\n            // 上报埋点\n            Analytics.track3(\"music_play\", { action: 'auto_play', music_name: data.name, type: groupId, singer: data.singer, online_songs: 'yes', position: 'network', cid: common.getCid() })\n        }\n        \n        // 如果我在主持位的话，也是需要推流的\n        if (!publishSteam && common.getAnchorKengUser(common.getMeid())) {\n            publishSteam = true\n        }\n\n        this.destroyMusic()\n\n        this.currentPlayer = new Player(data, groupId)\n        this.currentPlayer.publishSteam = !!publishSteam\n        this.currentPlayer.endCb = () => {\n            this.playWithDirection(true, data, groupId)\n        }\n        this.currentPlayer.errorCb = () => {\n            showTips('歌曲加载失败，请手动切换歌曲')\n            this.destroyMusic()\n        }\n        this.currentPlayer.play()\n\n        emitter.emit(EMITTER_KEY_PLAY_SONG)\n    }\n\n    // 查找下一首歌\n    findNext(code) {\n        return this.findMusic(true, code)\n    }\n    // 查找上一首歌\n    findPre(code) {\n        return this.findMusic(false, code)\n    }\n\n    // 查找歌曲，从前或者后\n    findMusic(next, code) {\n        const list = this.playingList\n        if (list) {\n            let idx = list.findIndex(item => item.song_code == code)\n            if (idx >= 0) {\n                if (next) {\n                    if (idx + 1 >= list.length) {\n                        idx = 0\n                    } else {\n                        idx = idx + 1\n                    }\n                } else {\n                    if (idx == 0) {\n                        idx = list.length - 1\n                    } else {\n                        idx = idx - 1\n                    }\n                }\n                \n                return list[idx]\n            }\n        }\n\n        return null\n    }\n\n    loadQuickBgmModalComp() {\n        this.updateDangSong()\n        if (!this.quickBgmModalComp) {\n            this.quickBgmModalComp = new QuickBgmModal({ target: this.bgmDom[0] })\n        }\n    }\n\n    showCuickBgmModalComp() {\n        this.loadQuickBgmModalComp()\n        this.quickBgmModalComp.show()\n    }\n\n    hideQuickBgmModalComp() {\n        this.quickBgmModalComp && this.quickBgmModalComp.hide()\n    }\n\n    // 歌曲管理库弹窗\n    showLibraryComp() {\n        if (!this.libraryModalComp) {\n            this.libraryModalComp = new LibraryModal({\n                target: document.body, \n                props: {\n                    closeModal: () => {\n                        this.libraryModalComp.hide()\n                    }\n                }\n            })\n        }\n\n        this.libraryModalComp.show()\n    }\n\n    // 兴趣标签选择弹窗\n    showTagSelectComp() {\n        request.get(ChatUrls.getBgmTags()).then(res=>{\n            if (res.error == 0 && res.data && res.data.length > 0) {\n                if (!this.tagSelectComp) {\n                    this.tagSelectComp = new TagSelect({\n                        target: document.body, \n                        props: {\n                            closeModal: () => {\n                                this.tagSelectComp.$destroy()\n                                this.tagSelectComp = null\n                            },\n                            data: res.data,\n                            cb: (tags)=> {\n                                request.get(ChatUrls.setBgmTags(tags.map(item => item.tagId))).then(res=>{\n                                    if (res.error == 0) {\n                                        this.libraryModalComp && this.libraryModalComp.refreshMineLike()\n                                    } else {\n                                        showTips(res.error_msg)\n                                    }\n                                })\n                            }\n                        }\n                    })\n                }\n            }\n        })\n    }\n\n    showPlayingListModal(event) {\n        const rect = event.getBoundingClientRect()\n    \n        showSvelteModal(PlayingListModal, { style: `left: ${rect.left + 10}px; top: ${rect.top - 10}px;` })\n    }\n\n    showEditSongPopupComp(props) {\n        showSvelteModal(EditSongPopup, props)\n    }\n\n    showEditMenuPopupComp(props) {\n        showSvelteModal(EditMenuGoup, props)\n    }\n\n    showAlert(props) {\n        showSvelteModal(Alert, props)\n    }\n\n    showEditGroupComp() {\n        showSvelteModal(EditGoup)\n    }\n}"],"names":["ctx","insert_dev","target","div1","anchor","append_dev","div0","is_function","apply","this","arguments","POSITION_TOP","closeModal","$$props","handle","offsetX","offsetY","position","top","left","transformY","onMount","rect","getBoundingClientRect","width","$$invalidate","height","div","input","instance","Bgm","getInstance","value","volume","currentPlayer","changeVolume","to_number","p","set_data_dev","t1","t1_value","opened","original","setClick","hideQuickBgmModalComp","showLibraryComp","showSlider","showSvelteModal","VolumeSlider","changeOpened","player","playing","showTips","changeTrack","playingListClick","showPlayingListModal","emitter","EventEmitter","EMITTER_KEY_ADD_GROUP","EMITTER_KEY_ADD_SONG_TO_GROUP","EMITTER_KEY_DELETE_GROUP","EMITTER_KEY_RENAME_GROUP","EMITTER_KEY_DELETE_SONG","EMITTER_KEY_SET_WORK_SONG","EMITTER_KEY_PLAY_SONG","EMITTER_KEY_PAUSE_SONG","EMITTER_KEY_RESUME_SONG","EMITTER_KEY_DESTROY_SONG","EMITTER_KEY_UPDATE_RECOMMEND","data","singer","t","t_value","create_if_block_1","create_if_block","div3","div2","current","dirty","forceUpdate","forceUpdateIndex","showPlaying","on","off","song","checkCanClick","preClick","playWithDirection","groupId","controlClick","pause","resume","emit","nextClick","LoadMuiscTRTC","constructor","engine","_status","PLAY_STATUS_NORMAL","statusChangeCb","playMusicTickCb","downloadTickCb","downloadMuiscErrorCb","playendCb","code","defaultGain","autoPlay","isSeeked","volumeValue","volumeMultiple","zcm","tickTime","originalTrack","Audio","accompaniedTrack","resource_id","destroy","console","log","status","PLAY_STATUS_STOP","onStopLocalAudioMixin","isOriginalBgmStart","_a","getCurrentTime","isAccompanyBgmStart","preloadUrl","extractAudio","playWithUrl","url","common","getRoomInfo","yjx_song_switch","extractAudioNew","createCustomAudioTrackNew","PLAY_STATUS_PLAYING","startPlay","PLAY_STATUS_DONWLOADING","String","indexOf","urls","split","PLAY_STATUS_DONWLOAD_DONE","createCustomAudioTrack","error","res","requestResource","songID","vendorID","errorCode","resource","resources","download","PLAY_STATUS_LOAD_TRACKS","Error","playCustomAudioTrack","startReportTimer","originalBgmTrack","setVolume","accompanyBgmTrack","arr","that","Promise","resolve","reject","fn","music1","music2","crossOrigin","src","removeEventListener","addEventListener","PLAY_STATUS_PLAY_TRACK","time","play","startProcessAudioBuffer","seekAudioBuffer","_pause","pauseProcessAudioBuffer","muted","onTaggerGain","time1","time2","_b","_c","resumeProcessAudioBuffer","_g","_d","_e","_f","stop","stopProcessAudioBuffer","_h","_i","_j","_n","_k","_l","_m","progressTick","one","two","seekOnce","seek","currentTime","currentTrack","duration","reportTimer","setInterval","playMusicTick","ct","clearReportTimer","destoryAudioTrack","window","clearInterval","__publicField","_Player","endCb","errorCb","timer","destroyed","loadMuisc","publishSteam","lyric","pitchData","bgmType","clearTimer","unpublishTracks","isLoadingBgm","song_code","setUser","getMeid","getLyric","getPitchData","prepare","genBgmTracks","createLoadMuisc","request","get","ChatUrls","getSongInfo","token","then","songUrl","playUrl","length","error_msg","catch","err","RealLoadMusic","isZegoRTC","LoadMuiscZego","LoadMuisc","isTRTC","Load_TRTC_Muisc","musicStateChange","bind","globalRtcClient","unpublishCustomAudioTrack","publishTracks","publishCustomAudioTrack","localAudio","state","Player","Engine","t0_value","name","t4_value","formatTime","p0","p1","p2","t0","t4","t6","t6_value","seconds","parseInt","padStart","cls","bodyClick","addClick","showAdd","showDang","_addClick","_bodyClick","i","each_blocks","clickMuiscCb","addMuiscCb","scrollBottomCb","playingCode","dangCode","MENU_TYPE_QUKU","MENU_TYPE_MINE","MENU_TYPE_QUICK","SUBTYPE_RECOMMEND","SUBTYPE_MINE","SUBTYPE_QUKU","if_block0","create_if_block_7","if_block1","create_if_block_5","if_block","create_if_block_8","create_if_block_6","musics_changes","getSubdataKey","__from","type","menuType","show","searchData","realMusicList","searchText","categoryData","categoryIndex","categoryChange","idx","requestSearchList","getBgmSearchBgm","list","refreshMineLike","requestMuiscList","refreshRecommend","cacheList","getMusicList","requestCategoryData","refresh","promiseall","getBgmRecommendAndCustomTabs","getBgmMineGroup","getBgmCategroy","all","ret","previousId","id","map","item","__spreadProps","tabId","__spreadValues","findIndex","reloadCategroy","deleteSong","key","splice","moveToGroup","force","_categoryIndex","requestList","subData","getBgmListWithCategroyType","getBgmListWithGroupId","recommendList","getBgmRecommendAndCustomTabSongs","getCid","onlyOnePage","oldList","concat","subtype","clickMuiscWithData","_data","subType","Analytics","track3","action","music_name","online_songs","cid","playingList","playingGroupId","playMuisc","addMuiscWithData","event","isMine","showEditSongPopupComp","style","showMenu","showEditMenuPopupComp","showTagSelect","showTagSelectComp","_refreshMineLike","gotoLibraryModal","dangSong","category","logo","visible","pageRef","hide","$$value","page0_changes","page1_changes","qukuRef","mineRef","menus","menusIndex","menusChange","TYPE_ADD","TYPE_GROUP","TYPE_WORK_BGM","TYPE_DELETE_SONG","TYPE_ADD_PLAYING_LIST","isSelected","title","callback","active","click","loadMyClass","showAlert","placeholder","maxLength","confirmCb","text","getBgmAddGroup","getBgmAddSongToGroup","$","DialogByZ","Confirm","Title","Content","BtnL","BtnR","FunL","Close","FunR","getBgmDeleteGroup","getBgmRenameGroup","getBgmSetWorkBgm","updateDangSong","getBgmDeleteSongToGroup","push","showEditGroupComp","create_if_block_2","attr_dev","div0_style_value","isIn","item_changes","canAdd","bodyRef","groups","itemCallback","loadData","getBgmGroups","setTimeout","document","documentElement","clientHeight","props","editgrouppopup_changes","t2_value","count","default","t2","editVisible","editClick","showEditId","tagName","toggle_class","selected","dispose","listen_dev","tagCategoryName","each_value_1","max","multiple","cb","tagClick","groupIndex","index","selecedCount","selectGroupCount","renderData","forEach","group","_groupIndex","_index","confirmClick","getSelects","initSelects","join","span","textContent","muiscClick","bgmDom","quickBgmModalComp","libraryModalComp","isAnchor","registEvents","onReset","$destroy","destroyMusic","e","stopPropagation","SessionStorage","getBgmFirstShow","showCuickBgmModalComp","loadQuickBgmModalComp","setBgmFirstShow","ablePlayBgm","bgm_switch","isSpecialSongRoom","voice_type","checkShowBgm","isChorusRoom","updateSeats","getAnchorKengUser","getAnchoringUserId","playlistId","find","hasClass","getBgmGetWorkBgm","next","findFunc","findNext","findPre","findSong","isAuto","findMusic","QuickBgmModal","LibraryModal","body","getBgmTags","tagSelectComp","TagSelect","tags","setBgmTags","tagId","PlayingListModal","EditSongPopup","EditMenuGoup","Alert","EditGoup"],"mappings":"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"}